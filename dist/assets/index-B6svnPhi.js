var S$=(rt,_)=>()=>(_||rt((_={exports:{}}).exports,_),_.exports);var E$=S$((exports,module)=>{function _mergeNamespaces(rt,_){for(var ut=0;ut<_.length;ut++){const mt=_[ut];if(typeof mt!="string"&&!Array.isArray(mt)){for(const bt in mt)if(bt!=="default"&&!(bt in rt)){const St=Object.getOwnPropertyDescriptor(mt,bt);St&&Object.defineProperty(rt,bt,St.get?St:{enumerable:!0,get:()=>mt[bt]})}}}return Object.freeze(Object.defineProperty(rt,Symbol.toStringTag,{value:"Module"}))}(function(){const _=document.createElement("link").relList;if(_&&_.supports&&_.supports("modulepreload"))return;for(const bt of document.querySelectorAll('link[rel="modulepreload"]'))mt(bt);new MutationObserver(bt=>{for(const St of bt)if(St.type==="childList")for(const Mt of St.addedNodes)Mt.tagName==="LINK"&&Mt.rel==="modulepreload"&&mt(Mt)}).observe(document,{childList:!0,subtree:!0});function ut(bt){const St={};return bt.integrity&&(St.integrity=bt.integrity),bt.referrerPolicy&&(St.referrerPolicy=bt.referrerPolicy),bt.crossOrigin==="use-credentials"?St.credentials="include":bt.crossOrigin==="anonymous"?St.credentials="omit":St.credentials="same-origin",St}function mt(bt){if(bt.ep)return;bt.ep=!0;const St=ut(bt);fetch(bt.href,St)}})();function getDefaultExportFromCjs(rt){return rt&&rt.__esModule&&Object.prototype.hasOwnProperty.call(rt,"default")?rt.default:rt}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$3=Symbol.for("react.element"),n$3=Symbol.for("react.portal"),p$6=Symbol.for("react.fragment"),q$3=Symbol.for("react.strict_mode"),r$2=Symbol.for("react.profiler"),t$2=Symbol.for("react.provider"),u$3=Symbol.for("react.context"),v$4=Symbol.for("react.forward_ref"),w$2=Symbol.for("react.suspense"),x$3=Symbol.for("react.memo"),y$3=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$2(rt){return rt===null||typeof rt!="object"?null:(rt=z$2&&rt[z$2]||rt["@@iterator"],typeof rt=="function"?rt:null)}var B$2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$3(rt,_,ut){this.props=rt,this.context=_,this.refs=D$2,this.updater=ut||B$2}E$3.prototype.isReactComponent={};E$3.prototype.setState=function(rt,_){if(typeof rt!="object"&&typeof rt!="function"&&rt!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,rt,_,"setState")};E$3.prototype.forceUpdate=function(rt){this.updater.enqueueForceUpdate(this,rt,"forceUpdate")};function F$2(){}F$2.prototype=E$3.prototype;function G$2(rt,_,ut){this.props=rt,this.context=_,this.refs=D$2,this.updater=ut||B$2}var H$3=G$2.prototype=new F$2;H$3.constructor=G$2;C$2(H$3,E$3.prototype);H$3.isPureReactComponent=!0;var I$4=Array.isArray,J$3=Object.prototype.hasOwnProperty,K$2={current:null},L$4={key:!0,ref:!0,__self:!0,__source:!0};function M$3(rt,_,ut){var mt,bt={},St=null,Mt=null;if(_!=null)for(mt in _.ref!==void 0&&(Mt=_.ref),_.key!==void 0&&(St=""+_.key),_)J$3.call(_,mt)&&!L$4.hasOwnProperty(mt)&&(bt[mt]=_[mt]);var Bt=arguments.length-2;if(Bt===1)bt.children=ut;else if(1<Bt){for(var Ut=Array(Bt),Ht=0;Ht<Bt;Ht++)Ut[Ht]=arguments[Ht+2];bt.children=Ut}if(rt&&rt.defaultProps)for(mt in Bt=rt.defaultProps,Bt)bt[mt]===void 0&&(bt[mt]=Bt[mt]);return{$$typeof:l$3,type:rt,key:St,ref:Mt,props:bt,_owner:K$2.current}}function N$3(rt,_){return{$$typeof:l$3,type:rt.type,key:_,ref:rt.ref,props:rt.props,_owner:rt._owner}}function O$2(rt){return typeof rt=="object"&&rt!==null&&rt.$$typeof===l$3}function escape$1(rt){var _={"=":"=0",":":"=2"};return"$"+rt.replace(/[=:]/g,function(ut){return _[ut]})}var P$2=/\/+/g;function Q$2(rt,_){return typeof rt=="object"&&rt!==null&&rt.key!=null?escape$1(""+rt.key):_.toString(36)}function R$2(rt,_,ut,mt,bt){var St=typeof rt;(St==="undefined"||St==="boolean")&&(rt=null);var Mt=!1;if(rt===null)Mt=!0;else switch(St){case"string":case"number":Mt=!0;break;case"object":switch(rt.$$typeof){case l$3:case n$3:Mt=!0}}if(Mt)return Mt=rt,bt=bt(Mt),rt=mt===""?"."+Q$2(Mt,0):mt,I$4(bt)?(ut="",rt!=null&&(ut=rt.replace(P$2,"$&/")+"/"),R$2(bt,_,ut,"",function(Ht){return Ht})):bt!=null&&(O$2(bt)&&(bt=N$3(bt,ut+(!bt.key||Mt&&Mt.key===bt.key?"":(""+bt.key).replace(P$2,"$&/")+"/")+rt)),_.push(bt)),1;if(Mt=0,mt=mt===""?".":mt+":",I$4(rt))for(var Bt=0;Bt<rt.length;Bt++){St=rt[Bt];var Ut=mt+Q$2(St,Bt);Mt+=R$2(St,_,ut,Ut,bt)}else if(Ut=A$2(rt),typeof Ut=="function")for(rt=Ut.call(rt),Bt=0;!(St=rt.next()).done;)St=St.value,Ut=mt+Q$2(St,Bt++),Mt+=R$2(St,_,ut,Ut,bt);else if(St==="object")throw _=String(rt),Error("Objects are not valid as a React child (found: "+(_==="[object Object]"?"object with keys {"+Object.keys(rt).join(", ")+"}":_)+"). If you meant to render a collection of children, use an array instead.");return Mt}function S$4(rt,_,ut){if(rt==null)return rt;var mt=[],bt=0;return R$2(rt,mt,"","",function(St){return _.call(ut,St,bt++)}),mt}function T$3(rt){if(rt._status===-1){var _=rt._result;_=_(),_.then(function(ut){(rt._status===0||rt._status===-1)&&(rt._status=1,rt._result=ut)},function(ut){(rt._status===0||rt._status===-1)&&(rt._status=2,rt._result=ut)}),rt._status===-1&&(rt._status=0,rt._result=_)}if(rt._status===1)return rt._result.default;throw rt._result}var U$3={current:null},V$4={transition:null},W$2={ReactCurrentDispatcher:U$3,ReactCurrentBatchConfig:V$4,ReactCurrentOwner:K$2};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$4,forEach:function(rt,_,ut){S$4(rt,function(){_.apply(this,arguments)},ut)},count:function(rt){var _=0;return S$4(rt,function(){_++}),_},toArray:function(rt){return S$4(rt,function(_){return _})||[]},only:function(rt){if(!O$2(rt))throw Error("React.Children.only expected to receive a single React element child.");return rt}};react_production_min.Component=E$3;react_production_min.Fragment=p$6;react_production_min.Profiler=r$2;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$3;react_production_min.Suspense=w$2;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.act=X$1;react_production_min.cloneElement=function(rt,_,ut){if(rt==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+rt+".");var mt=C$2({},rt.props),bt=rt.key,St=rt.ref,Mt=rt._owner;if(_!=null){if(_.ref!==void 0&&(St=_.ref,Mt=K$2.current),_.key!==void 0&&(bt=""+_.key),rt.type&&rt.type.defaultProps)var Bt=rt.type.defaultProps;for(Ut in _)J$3.call(_,Ut)&&!L$4.hasOwnProperty(Ut)&&(mt[Ut]=_[Ut]===void 0&&Bt!==void 0?Bt[Ut]:_[Ut])}var Ut=arguments.length-2;if(Ut===1)mt.children=ut;else if(1<Ut){Bt=Array(Ut);for(var Ht=0;Ht<Ut;Ht++)Bt[Ht]=arguments[Ht+2];mt.children=Bt}return{$$typeof:l$3,type:rt.type,key:bt,ref:St,props:mt,_owner:Mt}};react_production_min.createContext=function(rt){return rt={$$typeof:u$3,_currentValue:rt,_currentValue2:rt,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},rt.Provider={$$typeof:t$2,_context:rt},rt.Consumer=rt};react_production_min.createElement=M$3;react_production_min.createFactory=function(rt){var _=M$3.bind(null,rt);return _.type=rt,_};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(rt){return{$$typeof:v$4,render:rt}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(rt){return{$$typeof:y$3,_payload:{_status:-1,_result:rt},_init:T$3}};react_production_min.memo=function(rt,_){return{$$typeof:x$3,type:rt,compare:_===void 0?null:_}};react_production_min.startTransition=function(rt){var _=V$4.transition;V$4.transition={};try{rt()}finally{V$4.transition=_}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(rt,_){return U$3.current.useCallback(rt,_)};react_production_min.useContext=function(rt){return U$3.current.useContext(rt)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(rt){return U$3.current.useDeferredValue(rt)};react_production_min.useEffect=function(rt,_){return U$3.current.useEffect(rt,_)};react_production_min.useId=function(){return U$3.current.useId()};react_production_min.useImperativeHandle=function(rt,_,ut){return U$3.current.useImperativeHandle(rt,_,ut)};react_production_min.useInsertionEffect=function(rt,_){return U$3.current.useInsertionEffect(rt,_)};react_production_min.useLayoutEffect=function(rt,_){return U$3.current.useLayoutEffect(rt,_)};react_production_min.useMemo=function(rt,_){return U$3.current.useMemo(rt,_)};react_production_min.useReducer=function(rt,_,ut){return U$3.current.useReducer(rt,_,ut)};react_production_min.useRef=function(rt){return U$3.current.useRef(rt)};react_production_min.useState=function(rt){return U$3.current.useState(rt)};react_production_min.useSyncExternalStore=function(rt,_,ut){return U$3.current.useSyncExternalStore(rt,_,ut)};react_production_min.useTransition=function(){return U$3.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),$2AODx$react=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$3=reactExports,k$3=Symbol.for("react.element"),l$2=Symbol.for("react.fragment"),m$4=Object.prototype.hasOwnProperty,n$2=f$3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$5={key:!0,ref:!0,__self:!0,__source:!0};function q$2(rt,_,ut){var mt,bt={},St=null,Mt=null;ut!==void 0&&(St=""+ut),_.key!==void 0&&(St=""+_.key),_.ref!==void 0&&(Mt=_.ref);for(mt in _)m$4.call(_,mt)&&!p$5.hasOwnProperty(mt)&&(bt[mt]=_[mt]);if(rt&&rt.defaultProps)for(mt in _=rt.defaultProps,_)bt[mt]===void 0&&(bt[mt]=_[mt]);return{$$typeof:k$3,type:rt,key:St,ref:Mt,props:bt,_owner:n$2.current}}reactJsxRuntime_production_min.Fragment=l$2;reactJsxRuntime_production_min.jsx=q$2;reactJsxRuntime_production_min.jsxs=q$2;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler$1={exports:{}},scheduler_production_min$1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(rt){function _(Ss,eo){var Ao=Ss.length;Ss.push(eo);e:for(;0<Ao;){var Oo=Ao-1>>>1,uo=Ss[Oo];if(0<bt(uo,eo))Ss[Oo]=eo,Ss[Ao]=uo,Ao=Oo;else break e}}function ut(Ss){return Ss.length===0?null:Ss[0]}function mt(Ss){if(Ss.length===0)return null;var eo=Ss[0],Ao=Ss.pop();if(Ao!==eo){Ss[0]=Ao;e:for(var Oo=0,uo=Ss.length,uu=uo>>>1;Oo<uu;){var cu=2*(Oo+1)-1,Jl=Ss[cu],mu=cu+1,pu=Ss[mu];if(0>bt(Jl,Ao))mu<uo&&0>bt(pu,Jl)?(Ss[Oo]=pu,Ss[mu]=Ao,Oo=mu):(Ss[Oo]=Jl,Ss[cu]=Ao,Oo=cu);else if(mu<uo&&0>bt(pu,Ao))Ss[Oo]=pu,Ss[mu]=Ao,Oo=mu;else break e}}return eo}function bt(Ss,eo){var Ao=Ss.sortIndex-eo.sortIndex;return Ao!==0?Ao:Ss.id-eo.id}if(typeof performance=="object"&&typeof performance.now=="function"){var St=performance;rt.unstable_now=function(){return St.now()}}else{var Mt=Date,Bt=Mt.now();rt.unstable_now=function(){return Mt.now()-Bt}}var Ut=[],Ht=[],tr=1,rr=null,sr=3,ar=!1,cr=!1,Ar=!1,_r=typeof setTimeout=="function"?setTimeout:null,Dr=typeof clearTimeout=="function"?clearTimeout:null,$r=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Br(Ss){for(var eo=ut(Ht);eo!==null;){if(eo.callback===null)mt(Ht);else if(eo.startTime<=Ss)mt(Ht),eo.sortIndex=eo.expirationTime,_(Ut,eo);else break;eo=ut(Ht)}}function Jr(Ss){if(Ar=!1,Br(Ss),!cr)if(ut(Ut)!==null)cr=!0,_o(mn);else{var eo=ut(Ht);eo!==null&&qs(Jr,eo.startTime-Ss)}}function mn(Ss,eo){cr=!1,Ar&&(Ar=!1,Dr(en),en=-1),ar=!0;var Ao=sr;try{for(Br(eo),rr=ut(Ut);rr!==null&&(!(rr.expirationTime>eo)||Ss&&!qn());){var Oo=rr.callback;if(typeof Oo=="function"){rr.callback=null,sr=rr.priorityLevel;var uo=Oo(rr.expirationTime<=eo);eo=rt.unstable_now(),typeof uo=="function"?rr.callback=uo:rr===ut(Ut)&&mt(Ut),Br(eo)}else mt(Ut);rr=ut(Ut)}if(rr!==null)var uu=!0;else{var cu=ut(Ht);cu!==null&&qs(Jr,cu.startTime-eo),uu=!1}return uu}finally{rr=null,sr=Ao,ar=!1}}var Mn=!1,$n=null,en=-1,In=5,Rn=-1;function qn(){return!(rt.unstable_now()-Rn<In)}function Qn(){if($n!==null){var Ss=rt.unstable_now();Rn=Ss;var eo=!0;try{eo=$n(!0,Ss)}finally{eo?xs():(Mn=!1,$n=null)}}else Mn=!1}var xs;if(typeof $r=="function")xs=function(){$r(Qn)};else if(typeof MessageChannel<"u"){var cs=new MessageChannel,ks=cs.port2;cs.port1.onmessage=Qn,xs=function(){ks.postMessage(null)}}else xs=function(){_r(Qn,0)};function _o(Ss){$n=Ss,Mn||(Mn=!0,xs())}function qs(Ss,eo){en=_r(function(){Ss(rt.unstable_now())},eo)}rt.unstable_IdlePriority=5,rt.unstable_ImmediatePriority=1,rt.unstable_LowPriority=4,rt.unstable_NormalPriority=3,rt.unstable_Profiling=null,rt.unstable_UserBlockingPriority=2,rt.unstable_cancelCallback=function(Ss){Ss.callback=null},rt.unstable_continueExecution=function(){cr||ar||(cr=!0,_o(mn))},rt.unstable_forceFrameRate=function(Ss){0>Ss||125<Ss?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):In=0<Ss?Math.floor(1e3/Ss):5},rt.unstable_getCurrentPriorityLevel=function(){return sr},rt.unstable_getFirstCallbackNode=function(){return ut(Ut)},rt.unstable_next=function(Ss){switch(sr){case 1:case 2:case 3:var eo=3;break;default:eo=sr}var Ao=sr;sr=eo;try{return Ss()}finally{sr=Ao}},rt.unstable_pauseExecution=function(){},rt.unstable_requestPaint=function(){},rt.unstable_runWithPriority=function(Ss,eo){switch(Ss){case 1:case 2:case 3:case 4:case 5:break;default:Ss=3}var Ao=sr;sr=Ss;try{return eo()}finally{sr=Ao}},rt.unstable_scheduleCallback=function(Ss,eo,Ao){var Oo=rt.unstable_now();switch(typeof Ao=="object"&&Ao!==null?(Ao=Ao.delay,Ao=typeof Ao=="number"&&0<Ao?Oo+Ao:Oo):Ao=Oo,Ss){case 1:var uo=-1;break;case 2:uo=250;break;case 5:uo=1073741823;break;case 4:uo=1e4;break;default:uo=5e3}return uo=Ao+uo,Ss={id:tr++,callback:eo,priorityLevel:Ss,startTime:Ao,expirationTime:uo,sortIndex:-1},Ao>Oo?(Ss.sortIndex=Ao,_(Ht,Ss),ut(Ut)===null&&Ss===ut(Ht)&&(Ar?(Dr(en),en=-1):Ar=!0,qs(Jr,Ao-Oo))):(Ss.sortIndex=uo,_(Ut,Ss),cr||ar||(cr=!0,_o(mn))),Ss},rt.unstable_shouldYield=qn,rt.unstable_wrapCallback=function(Ss){var eo=sr;return function(){var Ao=sr;sr=eo;try{return Ss.apply(this,arguments)}finally{sr=Ao}}}})(scheduler_production_min$1);scheduler$1.exports=scheduler_production_min$1;var schedulerExports$1=scheduler$1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa$1=reactExports,ca$1=schedulerExports$1;function p$4(rt){for(var _="https://reactjs.org/docs/error-decoder.html?invariant="+rt,ut=1;ut<arguments.length;ut++)_+="&args[]="+encodeURIComponent(arguments[ut]);return"Minified React error #"+rt+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da$1=new Set,ea={};function fa$1(rt,_){ha$1(rt,_),ha$1(rt+"Capture",_)}function ha$1(rt,_){for(ea[rt]=_,rt=0;rt<_.length;rt++)da$1.add(_[rt])}var ia$1=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja$1=Object.prototype.hasOwnProperty,ka$1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la$1={},ma$1={};function oa$1(rt){return ja$1.call(ma$1,rt)?!0:ja$1.call(la$1,rt)?!1:ka$1.test(rt)?ma$1[rt]=!0:(la$1[rt]=!0,!1)}function pa$1(rt,_,ut,mt){if(ut!==null&&ut.type===0)return!1;switch(typeof _){case"function":case"symbol":return!0;case"boolean":return mt?!1:ut!==null?!ut.acceptsBooleans:(rt=rt.toLowerCase().slice(0,5),rt!=="data-"&&rt!=="aria-");default:return!1}}function qa$1(rt,_,ut,mt){if(_===null||typeof _>"u"||pa$1(rt,_,ut,mt))return!0;if(mt)return!1;if(ut!==null)switch(ut.type){case 3:return!_;case 4:return _===!1;case 5:return isNaN(_);case 6:return isNaN(_)||1>_}return!1}function v$3(rt,_,ut,mt,bt,St,Mt){this.acceptsBooleans=_===2||_===3||_===4,this.attributeName=mt,this.attributeNamespace=bt,this.mustUseProperty=ut,this.propertyName=rt,this.type=_,this.sanitizeURL=St,this.removeEmptyString=Mt}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(rt){z$1[rt]=new v$3(rt,0,!1,rt,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(rt){var _=rt[0];z$1[_]=new v$3(_,1,!1,rt[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(rt){z$1[rt]=new v$3(rt,2,!1,rt.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(rt){z$1[rt]=new v$3(rt,2,!1,rt,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(rt){z$1[rt]=new v$3(rt,3,!1,rt.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(rt){z$1[rt]=new v$3(rt,3,!0,rt,null,!1,!1)});["capture","download"].forEach(function(rt){z$1[rt]=new v$3(rt,4,!1,rt,null,!1,!1)});["cols","rows","size","span"].forEach(function(rt){z$1[rt]=new v$3(rt,6,!1,rt,null,!1,!1)});["rowSpan","start"].forEach(function(rt){z$1[rt]=new v$3(rt,5,!1,rt.toLowerCase(),null,!1,!1)});var ra$1=/[\-:]([a-z])/g;function sa$1(rt){return rt[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(rt){var _=rt.replace(ra$1,sa$1);z$1[_]=new v$3(_,1,!1,rt,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(rt){var _=rt.replace(ra$1,sa$1);z$1[_]=new v$3(_,1,!1,rt,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(rt){var _=rt.replace(ra$1,sa$1);z$1[_]=new v$3(_,1,!1,rt,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(rt){z$1[rt]=new v$3(rt,1,!1,rt.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v$3("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(rt){z$1[rt]=new v$3(rt,1,!1,rt.toLowerCase(),null,!0,!0)});function ta$1(rt,_,ut,mt){var bt=z$1.hasOwnProperty(_)?z$1[_]:null;(bt!==null?bt.type!==0:mt||!(2<_.length)||_[0]!=="o"&&_[0]!=="O"||_[1]!=="n"&&_[1]!=="N")&&(qa$1(_,ut,bt,mt)&&(ut=null),mt||bt===null?oa$1(_)&&(ut===null?rt.removeAttribute(_):rt.setAttribute(_,""+ut)):bt.mustUseProperty?rt[bt.propertyName]=ut===null?bt.type===3?!1:"":ut:(_=bt.attributeName,mt=bt.attributeNamespace,ut===null?rt.removeAttribute(_):(bt=bt.type,ut=bt===3||bt===4&&ut===!0?"":""+ut,mt?rt.setAttributeNS(mt,_,ut):rt.setAttribute(_,ut))))}var ua$1=aa$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va$1=Symbol.for("react.element"),wa$1=Symbol.for("react.portal"),ya$1=Symbol.for("react.fragment"),za$1=Symbol.for("react.strict_mode"),Aa$1=Symbol.for("react.profiler"),Ba$1=Symbol.for("react.provider"),Ca$1=Symbol.for("react.context"),Da$1=Symbol.for("react.forward_ref"),Ea$1=Symbol.for("react.suspense"),Fa$1=Symbol.for("react.suspense_list"),Ga$1=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia$1=Symbol.for("react.offscreen"),Ja$1=Symbol.iterator;function Ka$1(rt){return rt===null||typeof rt!="object"?null:(rt=Ja$1&&rt[Ja$1]||rt["@@iterator"],typeof rt=="function"?rt:null)}var A$1=Object.assign,La$1;function Ma$1(rt){if(La$1===void 0)try{throw Error()}catch(ut){var _=ut.stack.trim().match(/\n( *(at )?)/);La$1=_&&_[1]||""}return`
`+La$1+rt}var Na$1=!1;function Oa$1(rt,_){if(!rt||Na$1)return"";Na$1=!0;var ut=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(_)if(_=function(){throw Error()},Object.defineProperty(_.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_,[])}catch(Ht){var mt=Ht}Reflect.construct(rt,[],_)}else{try{_.call()}catch(Ht){mt=Ht}rt.call(_.prototype)}else{try{throw Error()}catch(Ht){mt=Ht}rt()}}catch(Ht){if(Ht&&mt&&typeof Ht.stack=="string"){for(var bt=Ht.stack.split(`
`),St=mt.stack.split(`
`),Mt=bt.length-1,Bt=St.length-1;1<=Mt&&0<=Bt&&bt[Mt]!==St[Bt];)Bt--;for(;1<=Mt&&0<=Bt;Mt--,Bt--)if(bt[Mt]!==St[Bt]){if(Mt!==1||Bt!==1)do if(Mt--,Bt--,0>Bt||bt[Mt]!==St[Bt]){var Ut=`
`+bt[Mt].replace(" at new "," at ");return rt.displayName&&Ut.includes("<anonymous>")&&(Ut=Ut.replace("<anonymous>",rt.displayName)),Ut}while(1<=Mt&&0<=Bt);break}}}finally{Na$1=!1,Error.prepareStackTrace=ut}return(rt=rt?rt.displayName||rt.name:"")?Ma$1(rt):""}function Pa(rt){switch(rt.tag){case 5:return Ma$1(rt.type);case 16:return Ma$1("Lazy");case 13:return Ma$1("Suspense");case 19:return Ma$1("SuspenseList");case 0:case 2:case 15:return rt=Oa$1(rt.type,!1),rt;case 11:return rt=Oa$1(rt.type.render,!1),rt;case 1:return rt=Oa$1(rt.type,!0),rt;default:return""}}function Qa$1(rt){if(rt==null)return null;if(typeof rt=="function")return rt.displayName||rt.name||null;if(typeof rt=="string")return rt;switch(rt){case ya$1:return"Fragment";case wa$1:return"Portal";case Aa$1:return"Profiler";case za$1:return"StrictMode";case Ea$1:return"Suspense";case Fa$1:return"SuspenseList"}if(typeof rt=="object")switch(rt.$$typeof){case Ca$1:return(rt.displayName||"Context")+".Consumer";case Ba$1:return(rt._context.displayName||"Context")+".Provider";case Da$1:var _=rt.render;return rt=rt.displayName,rt||(rt=_.displayName||_.name||"",rt=rt!==""?"ForwardRef("+rt+")":"ForwardRef"),rt;case Ga$1:return _=rt.displayName||null,_!==null?_:Qa$1(rt.type)||"Memo";case Ha:_=rt._payload,rt=rt._init;try{return Qa$1(rt(_))}catch{}}return null}function Ra$1(rt){var _=rt.type;switch(rt.tag){case 24:return"Cache";case 9:return(_.displayName||"Context")+".Consumer";case 10:return(_._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return rt=_.render,rt=rt.displayName||rt.name||"",_.displayName||(rt!==""?"ForwardRef("+rt+")":"ForwardRef");case 7:return"Fragment";case 5:return _;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa$1(_);case 8:return _===za$1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _}return null}function Sa$1(rt){switch(typeof rt){case"boolean":case"number":case"string":case"undefined":return rt;case"object":return rt;default:return""}}function Ta$1(rt){var _=rt.type;return(rt=rt.nodeName)&&rt.toLowerCase()==="input"&&(_==="checkbox"||_==="radio")}function Ua$1(rt){var _=Ta$1(rt)?"checked":"value",ut=Object.getOwnPropertyDescriptor(rt.constructor.prototype,_),mt=""+rt[_];if(!rt.hasOwnProperty(_)&&typeof ut<"u"&&typeof ut.get=="function"&&typeof ut.set=="function"){var bt=ut.get,St=ut.set;return Object.defineProperty(rt,_,{configurable:!0,get:function(){return bt.call(this)},set:function(Mt){mt=""+Mt,St.call(this,Mt)}}),Object.defineProperty(rt,_,{enumerable:ut.enumerable}),{getValue:function(){return mt},setValue:function(Mt){mt=""+Mt},stopTracking:function(){rt._valueTracker=null,delete rt[_]}}}}function Va$1(rt){rt._valueTracker||(rt._valueTracker=Ua$1(rt))}function Wa$1(rt){if(!rt)return!1;var _=rt._valueTracker;if(!_)return!0;var ut=_.getValue(),mt="";return rt&&(mt=Ta$1(rt)?rt.checked?"true":"false":rt.value),rt=mt,rt!==ut?(_.setValue(rt),!0):!1}function Xa$1(rt){if(rt=rt||(typeof document<"u"?document:void 0),typeof rt>"u")return null;try{return rt.activeElement||rt.body}catch{return rt.body}}function Ya$1(rt,_){var ut=_.checked;return A$1({},_,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:ut??rt._wrapperState.initialChecked})}function Za$1(rt,_){var ut=_.defaultValue==null?"":_.defaultValue,mt=_.checked!=null?_.checked:_.defaultChecked;ut=Sa$1(_.value!=null?_.value:ut),rt._wrapperState={initialChecked:mt,initialValue:ut,controlled:_.type==="checkbox"||_.type==="radio"?_.checked!=null:_.value!=null}}function ab$1(rt,_){_=_.checked,_!=null&&ta$1(rt,"checked",_,!1)}function bb$1(rt,_){ab$1(rt,_);var ut=Sa$1(_.value),mt=_.type;if(ut!=null)mt==="number"?(ut===0&&rt.value===""||rt.value!=ut)&&(rt.value=""+ut):rt.value!==""+ut&&(rt.value=""+ut);else if(mt==="submit"||mt==="reset"){rt.removeAttribute("value");return}_.hasOwnProperty("value")?cb$1(rt,_.type,ut):_.hasOwnProperty("defaultValue")&&cb$1(rt,_.type,Sa$1(_.defaultValue)),_.checked==null&&_.defaultChecked!=null&&(rt.defaultChecked=!!_.defaultChecked)}function db$1(rt,_,ut){if(_.hasOwnProperty("value")||_.hasOwnProperty("defaultValue")){var mt=_.type;if(!(mt!=="submit"&&mt!=="reset"||_.value!==void 0&&_.value!==null))return;_=""+rt._wrapperState.initialValue,ut||_===rt.value||(rt.value=_),rt.defaultValue=_}ut=rt.name,ut!==""&&(rt.name=""),rt.defaultChecked=!!rt._wrapperState.initialChecked,ut!==""&&(rt.name=ut)}function cb$1(rt,_,ut){(_!=="number"||Xa$1(rt.ownerDocument)!==rt)&&(ut==null?rt.defaultValue=""+rt._wrapperState.initialValue:rt.defaultValue!==""+ut&&(rt.defaultValue=""+ut))}var eb$1=Array.isArray;function fb$1(rt,_,ut,mt){if(rt=rt.options,_){_={};for(var bt=0;bt<ut.length;bt++)_["$"+ut[bt]]=!0;for(ut=0;ut<rt.length;ut++)bt=_.hasOwnProperty("$"+rt[ut].value),rt[ut].selected!==bt&&(rt[ut].selected=bt),bt&&mt&&(rt[ut].defaultSelected=!0)}else{for(ut=""+Sa$1(ut),_=null,bt=0;bt<rt.length;bt++){if(rt[bt].value===ut){rt[bt].selected=!0,mt&&(rt[bt].defaultSelected=!0);return}_!==null||rt[bt].disabled||(_=rt[bt])}_!==null&&(_.selected=!0)}}function gb$1(rt,_){if(_.dangerouslySetInnerHTML!=null)throw Error(p$4(91));return A$1({},_,{value:void 0,defaultValue:void 0,children:""+rt._wrapperState.initialValue})}function hb$1(rt,_){var ut=_.value;if(ut==null){if(ut=_.children,_=_.defaultValue,ut!=null){if(_!=null)throw Error(p$4(92));if(eb$1(ut)){if(1<ut.length)throw Error(p$4(93));ut=ut[0]}_=ut}_==null&&(_=""),ut=_}rt._wrapperState={initialValue:Sa$1(ut)}}function ib$1(rt,_){var ut=Sa$1(_.value),mt=Sa$1(_.defaultValue);ut!=null&&(ut=""+ut,ut!==rt.value&&(rt.value=ut),_.defaultValue==null&&rt.defaultValue!==ut&&(rt.defaultValue=ut)),mt!=null&&(rt.defaultValue=""+mt)}function jb$1(rt){var _=rt.textContent;_===rt._wrapperState.initialValue&&_!==""&&_!==null&&(rt.value=_)}function kb$1(rt){switch(rt){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb$1(rt,_){return rt==null||rt==="http://www.w3.org/1999/xhtml"?kb$1(_):rt==="http://www.w3.org/2000/svg"&&_==="foreignObject"?"http://www.w3.org/1999/xhtml":rt}var mb$1,nb$1=function(rt){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(_,ut,mt,bt){MSApp.execUnsafeLocalFunction(function(){return rt(_,ut,mt,bt)})}:rt}(function(rt,_){if(rt.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in rt)rt.innerHTML=_;else{for(mb$1=mb$1||document.createElement("div"),mb$1.innerHTML="<svg>"+_.valueOf().toString()+"</svg>",_=mb$1.firstChild;rt.firstChild;)rt.removeChild(rt.firstChild);for(;_.firstChild;)rt.appendChild(_.firstChild)}});function ob$1(rt,_){if(_){var ut=rt.firstChild;if(ut&&ut===rt.lastChild&&ut.nodeType===3){ut.nodeValue=_;return}}rt.textContent=_}var pb$1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb$1=["Webkit","ms","Moz","O"];Object.keys(pb$1).forEach(function(rt){qb$1.forEach(function(_){_=_+rt.charAt(0).toUpperCase()+rt.substring(1),pb$1[_]=pb$1[rt]})});function rb$1(rt,_,ut){return _==null||typeof _=="boolean"||_===""?"":ut||typeof _!="number"||_===0||pb$1.hasOwnProperty(rt)&&pb$1[rt]?(""+_).trim():_+"px"}function sb$1(rt,_){rt=rt.style;for(var ut in _)if(_.hasOwnProperty(ut)){var mt=ut.indexOf("--")===0,bt=rb$1(ut,_[ut],mt);ut==="float"&&(ut="cssFloat"),mt?rt.setProperty(ut,bt):rt[ut]=bt}}var tb$1=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub$1(rt,_){if(_){if(tb$1[rt]&&(_.children!=null||_.dangerouslySetInnerHTML!=null))throw Error(p$4(137,rt));if(_.dangerouslySetInnerHTML!=null){if(_.children!=null)throw Error(p$4(60));if(typeof _.dangerouslySetInnerHTML!="object"||!("__html"in _.dangerouslySetInnerHTML))throw Error(p$4(61))}if(_.style!=null&&typeof _.style!="object")throw Error(p$4(62))}}function vb$1(rt,_){if(rt.indexOf("-")===-1)return typeof _.is=="string";switch(rt){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb$1=null;function xb$1(rt){return rt=rt.target||rt.srcElement||window,rt.correspondingUseElement&&(rt=rt.correspondingUseElement),rt.nodeType===3?rt.parentNode:rt}var yb$1=null,zb$1=null,Ab$1=null;function Bb$1(rt){if(rt=Cb$1(rt)){if(typeof yb$1!="function")throw Error(p$4(280));var _=rt.stateNode;_&&(_=Db$1(_),yb$1(rt.stateNode,rt.type,_))}}function Eb$1(rt){zb$1?Ab$1?Ab$1.push(rt):Ab$1=[rt]:zb$1=rt}function Fb$1(){if(zb$1){var rt=zb$1,_=Ab$1;if(Ab$1=zb$1=null,Bb$1(rt),_)for(rt=0;rt<_.length;rt++)Bb$1(_[rt])}}function Gb$1(rt,_){return rt(_)}function Hb$1(){}var Ib$1=!1;function Jb$1(rt,_,ut){if(Ib$1)return rt(_,ut);Ib$1=!0;try{return Gb$1(rt,_,ut)}finally{Ib$1=!1,(zb$1!==null||Ab$1!==null)&&(Hb$1(),Fb$1())}}function Kb$1(rt,_){var ut=rt.stateNode;if(ut===null)return null;var mt=Db$1(ut);if(mt===null)return null;ut=mt[_];e:switch(_){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(mt=!mt.disabled)||(rt=rt.type,mt=!(rt==="button"||rt==="input"||rt==="select"||rt==="textarea")),rt=!mt;break e;default:rt=!1}if(rt)return null;if(ut&&typeof ut!="function")throw Error(p$4(231,_,typeof ut));return ut}var Lb$1=!1;if(ia$1)try{var Mb$1={};Object.defineProperty(Mb$1,"passive",{get:function(){Lb$1=!0}}),window.addEventListener("test",Mb$1,Mb$1),window.removeEventListener("test",Mb$1,Mb$1)}catch{Lb$1=!1}function Nb$1(rt,_,ut,mt,bt,St,Mt,Bt,Ut){var Ht=Array.prototype.slice.call(arguments,3);try{_.apply(ut,Ht)}catch(tr){this.onError(tr)}}var Ob$1=!1,Pb$1=null,Qb$1=!1,Rb$1=null,Sb$1={onError:function(rt){Ob$1=!0,Pb$1=rt}};function Tb$1(rt,_,ut,mt,bt,St,Mt,Bt,Ut){Ob$1=!1,Pb$1=null,Nb$1.apply(Sb$1,arguments)}function Ub$1(rt,_,ut,mt,bt,St,Mt,Bt,Ut){if(Tb$1.apply(this,arguments),Ob$1){if(Ob$1){var Ht=Pb$1;Ob$1=!1,Pb$1=null}else throw Error(p$4(198));Qb$1||(Qb$1=!0,Rb$1=Ht)}}function Vb$1(rt){var _=rt,ut=rt;if(rt.alternate)for(;_.return;)_=_.return;else{rt=_;do _=rt,_.flags&4098&&(ut=_.return),rt=_.return;while(rt)}return _.tag===3?ut:null}function Wb$1(rt){if(rt.tag===13){var _=rt.memoizedState;if(_===null&&(rt=rt.alternate,rt!==null&&(_=rt.memoizedState)),_!==null)return _.dehydrated}return null}function Xb$1(rt){if(Vb$1(rt)!==rt)throw Error(p$4(188))}function Yb$1(rt){var _=rt.alternate;if(!_){if(_=Vb$1(rt),_===null)throw Error(p$4(188));return _!==rt?null:rt}for(var ut=rt,mt=_;;){var bt=ut.return;if(bt===null)break;var St=bt.alternate;if(St===null){if(mt=bt.return,mt!==null){ut=mt;continue}break}if(bt.child===St.child){for(St=bt.child;St;){if(St===ut)return Xb$1(bt),rt;if(St===mt)return Xb$1(bt),_;St=St.sibling}throw Error(p$4(188))}if(ut.return!==mt.return)ut=bt,mt=St;else{for(var Mt=!1,Bt=bt.child;Bt;){if(Bt===ut){Mt=!0,ut=bt,mt=St;break}if(Bt===mt){Mt=!0,mt=bt,ut=St;break}Bt=Bt.sibling}if(!Mt){for(Bt=St.child;Bt;){if(Bt===ut){Mt=!0,ut=St,mt=bt;break}if(Bt===mt){Mt=!0,mt=St,ut=bt;break}Bt=Bt.sibling}if(!Mt)throw Error(p$4(189))}}if(ut.alternate!==mt)throw Error(p$4(190))}if(ut.tag!==3)throw Error(p$4(188));return ut.stateNode.current===ut?rt:_}function Zb$1(rt){return rt=Yb$1(rt),rt!==null?$b$1(rt):null}function $b$1(rt){if(rt.tag===5||rt.tag===6)return rt;for(rt=rt.child;rt!==null;){var _=$b$1(rt);if(_!==null)return _;rt=rt.sibling}return null}var ac=ca$1.unstable_scheduleCallback,bc$1=ca$1.unstable_cancelCallback,cc=ca$1.unstable_shouldYield,dc=ca$1.unstable_requestPaint,B$1=ca$1.unstable_now,ec$1=ca$1.unstable_getCurrentPriorityLevel,fc$1=ca$1.unstable_ImmediatePriority,gc$1=ca$1.unstable_UserBlockingPriority,hc=ca$1.unstable_NormalPriority,ic=ca$1.unstable_LowPriority,jc=ca$1.unstable_IdlePriority,kc$1=null,lc=null;function mc(rt){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc$1,rt,void 0,(rt.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc$1,pc$1=Math.log,qc$1=Math.LN2;function nc$1(rt){return rt>>>=0,rt===0?32:31-(pc$1(rt)/qc$1|0)|0}var rc$1=64,sc=4194304;function tc$1(rt){switch(rt&-rt){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return rt&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return rt&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return rt}}function uc$1(rt,_){var ut=rt.pendingLanes;if(ut===0)return 0;var mt=0,bt=rt.suspendedLanes,St=rt.pingedLanes,Mt=ut&268435455;if(Mt!==0){var Bt=Mt&~bt;Bt!==0?mt=tc$1(Bt):(St&=Mt,St!==0&&(mt=tc$1(St)))}else Mt=ut&~bt,Mt!==0?mt=tc$1(Mt):St!==0&&(mt=tc$1(St));if(mt===0)return 0;if(_!==0&&_!==mt&&!(_&bt)&&(bt=mt&-mt,St=_&-_,bt>=St||bt===16&&(St&4194240)!==0))return _;if(mt&4&&(mt|=ut&16),_=rt.entangledLanes,_!==0)for(rt=rt.entanglements,_&=mt;0<_;)ut=31-oc(_),bt=1<<ut,mt|=rt[ut],_&=~bt;return mt}function vc$1(rt,_){switch(rt){case 1:case 2:case 4:return _+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc$1(rt,_){for(var ut=rt.suspendedLanes,mt=rt.pingedLanes,bt=rt.expirationTimes,St=rt.pendingLanes;0<St;){var Mt=31-oc(St),Bt=1<<Mt,Ut=bt[Mt];Ut===-1?(!(Bt&ut)||Bt&mt)&&(bt[Mt]=vc$1(Bt,_)):Ut<=_&&(rt.expiredLanes|=Bt),St&=~Bt}}function xc$1(rt){return rt=rt.pendingLanes&-1073741825,rt!==0?rt:rt&1073741824?1073741824:0}function yc(){var rt=rc$1;return rc$1<<=1,!(rc$1&4194240)&&(rc$1=64),rt}function zc(rt){for(var _=[],ut=0;31>ut;ut++)_.push(rt);return _}function Ac$1(rt,_,ut){rt.pendingLanes|=_,_!==536870912&&(rt.suspendedLanes=0,rt.pingedLanes=0),rt=rt.eventTimes,_=31-oc(_),rt[_]=ut}function Bc$1(rt,_){var ut=rt.pendingLanes&~_;rt.pendingLanes=_,rt.suspendedLanes=0,rt.pingedLanes=0,rt.expiredLanes&=_,rt.mutableReadLanes&=_,rt.entangledLanes&=_,_=rt.entanglements;var mt=rt.eventTimes;for(rt=rt.expirationTimes;0<ut;){var bt=31-oc(ut),St=1<<bt;_[bt]=0,mt[bt]=-1,rt[bt]=-1,ut&=~St}}function Cc(rt,_){var ut=rt.entangledLanes|=_;for(rt=rt.entanglements;ut;){var mt=31-oc(ut),bt=1<<mt;bt&_|rt[mt]&_&&(rt[mt]|=_),ut&=~bt}}var C$1=0;function Dc$1(rt){return rt&=-rt,1<rt?4<rt?rt&268435455?16:536870912:4:1}var Ec$1,Fc$1,Gc$1,Hc$1,Ic$1,Jc$1=!1,Kc$1=[],Lc$1=null,Mc$1=null,Nc$1=null,Oc$1=new Map,Pc$1=new Map,Qc$1=[],Rc$1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc$1(rt,_){switch(rt){case"focusin":case"focusout":Lc$1=null;break;case"dragenter":case"dragleave":Mc$1=null;break;case"mouseover":case"mouseout":Nc$1=null;break;case"pointerover":case"pointerout":Oc$1.delete(_.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc$1.delete(_.pointerId)}}function Tc$1(rt,_,ut,mt,bt,St){return rt===null||rt.nativeEvent!==St?(rt={blockedOn:_,domEventName:ut,eventSystemFlags:mt,nativeEvent:St,targetContainers:[bt]},_!==null&&(_=Cb$1(_),_!==null&&Fc$1(_)),rt):(rt.eventSystemFlags|=mt,_=rt.targetContainers,bt!==null&&_.indexOf(bt)===-1&&_.push(bt),rt)}function Uc$1(rt,_,ut,mt,bt){switch(_){case"focusin":return Lc$1=Tc$1(Lc$1,rt,_,ut,mt,bt),!0;case"dragenter":return Mc$1=Tc$1(Mc$1,rt,_,ut,mt,bt),!0;case"mouseover":return Nc$1=Tc$1(Nc$1,rt,_,ut,mt,bt),!0;case"pointerover":var St=bt.pointerId;return Oc$1.set(St,Tc$1(Oc$1.get(St)||null,rt,_,ut,mt,bt)),!0;case"gotpointercapture":return St=bt.pointerId,Pc$1.set(St,Tc$1(Pc$1.get(St)||null,rt,_,ut,mt,bt)),!0}return!1}function Vc$1(rt){var _=Wc$1(rt.target);if(_!==null){var ut=Vb$1(_);if(ut!==null){if(_=ut.tag,_===13){if(_=Wb$1(ut),_!==null){rt.blockedOn=_,Ic$1(rt.priority,function(){Gc$1(ut)});return}}else if(_===3&&ut.stateNode.current.memoizedState.isDehydrated){rt.blockedOn=ut.tag===3?ut.stateNode.containerInfo:null;return}}}rt.blockedOn=null}function Xc$1(rt){if(rt.blockedOn!==null)return!1;for(var _=rt.targetContainers;0<_.length;){var ut=Yc$1(rt.domEventName,rt.eventSystemFlags,_[0],rt.nativeEvent);if(ut===null){ut=rt.nativeEvent;var mt=new ut.constructor(ut.type,ut);wb$1=mt,ut.target.dispatchEvent(mt),wb$1=null}else return _=Cb$1(ut),_!==null&&Fc$1(_),rt.blockedOn=ut,!1;_.shift()}return!0}function Zc$1(rt,_,ut){Xc$1(rt)&&ut.delete(_)}function $c$1(){Jc$1=!1,Lc$1!==null&&Xc$1(Lc$1)&&(Lc$1=null),Mc$1!==null&&Xc$1(Mc$1)&&(Mc$1=null),Nc$1!==null&&Xc$1(Nc$1)&&(Nc$1=null),Oc$1.forEach(Zc$1),Pc$1.forEach(Zc$1)}function ad$1(rt,_){rt.blockedOn===_&&(rt.blockedOn=null,Jc$1||(Jc$1=!0,ca$1.unstable_scheduleCallback(ca$1.unstable_NormalPriority,$c$1)))}function bd(rt){function _(bt){return ad$1(bt,rt)}if(0<Kc$1.length){ad$1(Kc$1[0],rt);for(var ut=1;ut<Kc$1.length;ut++){var mt=Kc$1[ut];mt.blockedOn===rt&&(mt.blockedOn=null)}}for(Lc$1!==null&&ad$1(Lc$1,rt),Mc$1!==null&&ad$1(Mc$1,rt),Nc$1!==null&&ad$1(Nc$1,rt),Oc$1.forEach(_),Pc$1.forEach(_),ut=0;ut<Qc$1.length;ut++)mt=Qc$1[ut],mt.blockedOn===rt&&(mt.blockedOn=null);for(;0<Qc$1.length&&(ut=Qc$1[0],ut.blockedOn===null);)Vc$1(ut),ut.blockedOn===null&&Qc$1.shift()}var cd$1=ua$1.ReactCurrentBatchConfig,dd=!0;function ed$1(rt,_,ut,mt){var bt=C$1,St=cd$1.transition;cd$1.transition=null;try{C$1=1,fd$2(rt,_,ut,mt)}finally{C$1=bt,cd$1.transition=St}}function gd$1(rt,_,ut,mt){var bt=C$1,St=cd$1.transition;cd$1.transition=null;try{C$1=4,fd$2(rt,_,ut,mt)}finally{C$1=bt,cd$1.transition=St}}function fd$2(rt,_,ut,mt){if(dd){var bt=Yc$1(rt,_,ut,mt);if(bt===null)hd(rt,_,mt,id$4,ut),Sc$1(rt,mt);else if(Uc$1(bt,rt,_,ut,mt))mt.stopPropagation();else if(Sc$1(rt,mt),_&4&&-1<Rc$1.indexOf(rt)){for(;bt!==null;){var St=Cb$1(bt);if(St!==null&&Ec$1(St),St=Yc$1(rt,_,ut,mt),St===null&&hd(rt,_,mt,id$4,ut),St===bt)break;bt=St}bt!==null&&mt.stopPropagation()}else hd(rt,_,mt,null,ut)}}var id$4=null;function Yc$1(rt,_,ut,mt){if(id$4=null,rt=xb$1(mt),rt=Wc$1(rt),rt!==null)if(_=Vb$1(rt),_===null)rt=null;else if(ut=_.tag,ut===13){if(rt=Wb$1(_),rt!==null)return rt;rt=null}else if(ut===3){if(_.stateNode.current.memoizedState.isDehydrated)return _.tag===3?_.stateNode.containerInfo:null;rt=null}else _!==rt&&(rt=null);return id$4=rt,null}function jd$1(rt){switch(rt){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec$1()){case fc$1:return 1;case gc$1:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md$1=null;function nd$1(){if(md$1)return md$1;var rt,_=ld,ut=_.length,mt,bt="value"in kd?kd.value:kd.textContent,St=bt.length;for(rt=0;rt<ut&&_[rt]===bt[rt];rt++);var Mt=ut-rt;for(mt=1;mt<=Mt&&_[ut-mt]===bt[St-mt];mt++);return md$1=bt.slice(rt,1<mt?1-mt:void 0)}function od$1(rt){var _=rt.keyCode;return"charCode"in rt?(rt=rt.charCode,rt===0&&_===13&&(rt=13)):rt=_,rt===10&&(rt=13),32<=rt||rt===13?rt:0}function pd(){return!0}function qd$1(){return!1}function rd(rt){function _(ut,mt,bt,St,Mt){this._reactName=ut,this._targetInst=bt,this.type=mt,this.nativeEvent=St,this.target=Mt,this.currentTarget=null;for(var Bt in rt)rt.hasOwnProperty(Bt)&&(ut=rt[Bt],this[Bt]=ut?ut(St):St[Bt]);return this.isDefaultPrevented=(St.defaultPrevented!=null?St.defaultPrevented:St.returnValue===!1)?pd:qd$1,this.isPropagationStopped=qd$1,this}return A$1(_.prototype,{preventDefault:function(){this.defaultPrevented=!0;var ut=this.nativeEvent;ut&&(ut.preventDefault?ut.preventDefault():typeof ut.returnValue!="unknown"&&(ut.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var ut=this.nativeEvent;ut&&(ut.stopPropagation?ut.stopPropagation():typeof ut.cancelBubble!="unknown"&&(ut.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),_}var sd$1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(rt){return rt.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$1=rd(sd$1),ud$1=A$1({},sd$1,{view:0,detail:0}),vd=rd(ud$1),wd$1,xd$1,yd$1,Ad$1=A$1({},ud$1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd$1,button:0,buttons:0,relatedTarget:function(rt){return rt.relatedTarget===void 0?rt.fromElement===rt.srcElement?rt.toElement:rt.fromElement:rt.relatedTarget},movementX:function(rt){return"movementX"in rt?rt.movementX:(rt!==yd$1&&(yd$1&&rt.type==="mousemove"?(wd$1=rt.screenX-yd$1.screenX,xd$1=rt.screenY-yd$1.screenY):xd$1=wd$1=0,yd$1=rt),wd$1)},movementY:function(rt){return"movementY"in rt?rt.movementY:xd$1}}),Bd$1=rd(Ad$1),Cd=A$1({},Ad$1,{dataTransfer:0}),Dd$1=rd(Cd),Ed=A$1({},ud$1,{relatedTarget:0}),Fd$1=rd(Ed),Gd$1=A$1({},sd$1,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd$1=rd(Gd$1),Id$1=A$1({},sd$1,{clipboardData:function(rt){return"clipboardData"in rt?rt.clipboardData:window.clipboardData}}),Jd$1=rd(Id$1),Kd=A$1({},sd$1,{data:0}),Ld$1=rd(Kd),Md$1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od$1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(rt){var _=this.nativeEvent;return _.getModifierState?_.getModifierState(rt):(rt=Od$1[rt])?!!_[rt]:!1}function zd$1(){return Pd}var Qd$1=A$1({},ud$1,{key:function(rt){if(rt.key){var _=Md$1[rt.key]||rt.key;if(_!=="Unidentified")return _}return rt.type==="keypress"?(rt=od$1(rt),rt===13?"Enter":String.fromCharCode(rt)):rt.type==="keydown"||rt.type==="keyup"?Nd[rt.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd$1,charCode:function(rt){return rt.type==="keypress"?od$1(rt):0},keyCode:function(rt){return rt.type==="keydown"||rt.type==="keyup"?rt.keyCode:0},which:function(rt){return rt.type==="keypress"?od$1(rt):rt.type==="keydown"||rt.type==="keyup"?rt.keyCode:0}}),Rd=rd(Qd$1),Sd$1=A$1({},Ad$1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd$1),Ud=A$1({},ud$1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd$1}),Vd=rd(Ud),Wd=A$1({},sd$1,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad$1,{deltaX:function(rt){return"deltaX"in rt?rt.deltaX:"wheelDeltaX"in rt?-rt.wheelDeltaX:0},deltaY:function(rt){return"deltaY"in rt?rt.deltaY:"wheelDeltaY"in rt?-rt.wheelDeltaY:"wheelDelta"in rt?-rt.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd$1=rd(Yd),$d$1=[9,13,27,32],ae$1=ia$1&&"CompositionEvent"in window,be$1=null;ia$1&&"documentMode"in document&&(be$1=document.documentMode);var ce$1=ia$1&&"TextEvent"in window&&!be$1,de=ia$1&&(!ae$1||be$1&&8<be$1&&11>=be$1),ee$1=" ",fe$1=!1;function ge(rt,_){switch(rt){case"keyup":return $d$1.indexOf(_.keyCode)!==-1;case"keydown":return _.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(rt){return rt=rt.detail,typeof rt=="object"&&"data"in rt?rt.data:null}var ie=!1;function je$1(rt,_){switch(rt){case"compositionend":return he$1(_);case"keypress":return _.which!==32?null:(fe$1=!0,ee$1);case"textInput":return rt=_.data,rt===ee$1&&fe$1?null:rt;default:return null}}function ke$1(rt,_){if(ie)return rt==="compositionend"||!ae$1&&ge(rt,_)?(rt=nd$1(),md$1=ld=kd=null,ie=!1,rt):null;switch(rt){case"paste":return null;case"keypress":if(!(_.ctrlKey||_.altKey||_.metaKey)||_.ctrlKey&&_.altKey){if(_.char&&1<_.char.length)return _.char;if(_.which)return String.fromCharCode(_.which)}return null;case"compositionend":return de&&_.locale!=="ko"?null:_.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$1(rt){var _=rt&&rt.nodeName&&rt.nodeName.toLowerCase();return _==="input"?!!le[rt.type]:_==="textarea"}function ne(rt,_,ut,mt){Eb$1(mt),_=oe(_,"onChange"),0<_.length&&(ut=new td$1("onChange","change",null,ut,mt),rt.push({event:ut,listeners:_}))}var pe$1=null,qe$1=null;function re$3(rt){se(rt,0)}function te(rt){var _=ue(rt);if(Wa$1(_))return rt}function ve$1(rt,_){if(rt==="change")return _}var we$1=!1;if(ia$1){var xe$2;if(ia$1){var ye$1="oninput"in document;if(!ye$1){var ze$1=document.createElement("div");ze$1.setAttribute("oninput","return;"),ye$1=typeof ze$1.oninput=="function"}xe$2=ye$1}else xe$2=!1;we$1=xe$2&&(!document.documentMode||9<document.documentMode)}function Ae$1(){pe$1&&(pe$1.detachEvent("onpropertychange",Be$1),qe$1=pe$1=null)}function Be$1(rt){if(rt.propertyName==="value"&&te(qe$1)){var _=[];ne(_,qe$1,rt,xb$1(rt)),Jb$1(re$3,_)}}function Ce$2(rt,_,ut){rt==="focusin"?(Ae$1(),pe$1=_,qe$1=ut,pe$1.attachEvent("onpropertychange",Be$1)):rt==="focusout"&&Ae$1()}function De$1(rt){if(rt==="selectionchange"||rt==="keyup"||rt==="keydown")return te(qe$1)}function Ee$1(rt,_){if(rt==="click")return te(_)}function Fe$1(rt,_){if(rt==="input"||rt==="change")return te(_)}function Ge(rt,_){return rt===_&&(rt!==0||1/rt===1/_)||rt!==rt&&_!==_}var He=typeof Object.is=="function"?Object.is:Ge;function Ie$1(rt,_){if(He(rt,_))return!0;if(typeof rt!="object"||rt===null||typeof _!="object"||_===null)return!1;var ut=Object.keys(rt),mt=Object.keys(_);if(ut.length!==mt.length)return!1;for(mt=0;mt<ut.length;mt++){var bt=ut[mt];if(!ja$1.call(_,bt)||!He(rt[bt],_[bt]))return!1}return!0}function Je$1(rt){for(;rt&&rt.firstChild;)rt=rt.firstChild;return rt}function Ke$1(rt,_){var ut=Je$1(rt);rt=0;for(var mt;ut;){if(ut.nodeType===3){if(mt=rt+ut.textContent.length,rt<=_&&mt>=_)return{node:ut,offset:_-rt};rt=mt}e:{for(;ut;){if(ut.nextSibling){ut=ut.nextSibling;break e}ut=ut.parentNode}ut=void 0}ut=Je$1(ut)}}function Le$1(rt,_){return rt&&_?rt===_?!0:rt&&rt.nodeType===3?!1:_&&_.nodeType===3?Le$1(rt,_.parentNode):"contains"in rt?rt.contains(_):rt.compareDocumentPosition?!!(rt.compareDocumentPosition(_)&16):!1:!1}function Me$1(){for(var rt=window,_=Xa$1();_ instanceof rt.HTMLIFrameElement;){try{var ut=typeof _.contentWindow.location.href=="string"}catch{ut=!1}if(ut)rt=_.contentWindow;else break;_=Xa$1(rt.document)}return _}function Ne$2(rt){var _=rt&&rt.nodeName&&rt.nodeName.toLowerCase();return _&&(_==="input"&&(rt.type==="text"||rt.type==="search"||rt.type==="tel"||rt.type==="url"||rt.type==="password")||_==="textarea"||rt.contentEditable==="true")}function Oe(rt){var _=Me$1(),ut=rt.focusedElem,mt=rt.selectionRange;if(_!==ut&&ut&&ut.ownerDocument&&Le$1(ut.ownerDocument.documentElement,ut)){if(mt!==null&&Ne$2(ut)){if(_=mt.start,rt=mt.end,rt===void 0&&(rt=_),"selectionStart"in ut)ut.selectionStart=_,ut.selectionEnd=Math.min(rt,ut.value.length);else if(rt=(_=ut.ownerDocument||document)&&_.defaultView||window,rt.getSelection){rt=rt.getSelection();var bt=ut.textContent.length,St=Math.min(mt.start,bt);mt=mt.end===void 0?St:Math.min(mt.end,bt),!rt.extend&&St>mt&&(bt=mt,mt=St,St=bt),bt=Ke$1(ut,St);var Mt=Ke$1(ut,mt);bt&&Mt&&(rt.rangeCount!==1||rt.anchorNode!==bt.node||rt.anchorOffset!==bt.offset||rt.focusNode!==Mt.node||rt.focusOffset!==Mt.offset)&&(_=_.createRange(),_.setStart(bt.node,bt.offset),rt.removeAllRanges(),St>mt?(rt.addRange(_),rt.extend(Mt.node,Mt.offset)):(_.setEnd(Mt.node,Mt.offset),rt.addRange(_)))}}for(_=[],rt=ut;rt=rt.parentNode;)rt.nodeType===1&&_.push({element:rt,left:rt.scrollLeft,top:rt.scrollTop});for(typeof ut.focus=="function"&&ut.focus(),ut=0;ut<_.length;ut++)rt=_[ut],rt.element.scrollLeft=rt.left,rt.element.scrollTop=rt.top}}var Pe$1=ia$1&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re$1=null,Se=null,Te=!1;function Ue$1(rt,_,ut){var mt=ut.window===ut?ut.document:ut.nodeType===9?ut:ut.ownerDocument;Te||Qe==null||Qe!==Xa$1(mt)||(mt=Qe,"selectionStart"in mt&&Ne$2(mt)?mt={start:mt.selectionStart,end:mt.selectionEnd}:(mt=(mt.ownerDocument&&mt.ownerDocument.defaultView||window).getSelection(),mt={anchorNode:mt.anchorNode,anchorOffset:mt.anchorOffset,focusNode:mt.focusNode,focusOffset:mt.focusOffset}),Se&&Ie$1(Se,mt)||(Se=mt,mt=oe(Re$1,"onSelect"),0<mt.length&&(_=new td$1("onSelect","select",null,_,ut),rt.push({event:_,listeners:mt}),_.target=Qe)))}function Ve$1(rt,_){var ut={};return ut[rt.toLowerCase()]=_.toLowerCase(),ut["Webkit"+rt]="webkit"+_,ut["Moz"+rt]="moz"+_,ut}var We$1={animationend:Ve$1("Animation","AnimationEnd"),animationiteration:Ve$1("Animation","AnimationIteration"),animationstart:Ve$1("Animation","AnimationStart"),transitionend:Ve$1("Transition","TransitionEnd")},Xe$1={},Ye$1={};ia$1&&(Ye$1=document.createElement("div").style,"AnimationEvent"in window||(delete We$1.animationend.animation,delete We$1.animationiteration.animation,delete We$1.animationstart.animation),"TransitionEvent"in window||delete We$1.transitionend.transition);function Ze$1(rt){if(Xe$1[rt])return Xe$1[rt];if(!We$1[rt])return rt;var _=We$1[rt],ut;for(ut in _)if(_.hasOwnProperty(ut)&&ut in Ye$1)return Xe$1[rt]=_[ut];return rt}var $e$1=Ze$1("animationend"),af$1=Ze$1("animationiteration"),bf$1=Ze$1("animationstart"),cf$1=Ze$1("transitionend"),df$1=new Map,ef$1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff$1(rt,_){df$1.set(rt,_),fa$1(_,[rt])}for(var gf$1=0;gf$1<ef$1.length;gf$1++){var hf$1=ef$1[gf$1],jf$1=hf$1.toLowerCase(),kf$1=hf$1[0].toUpperCase()+hf$1.slice(1);ff$1(jf$1,"on"+kf$1)}ff$1($e$1,"onAnimationEnd");ff$1(af$1,"onAnimationIteration");ff$1(bf$1,"onAnimationStart");ff$1("dblclick","onDoubleClick");ff$1("focusin","onFocus");ff$1("focusout","onBlur");ff$1(cf$1,"onTransitionEnd");ha$1("onMouseEnter",["mouseout","mouseover"]);ha$1("onMouseLeave",["mouseout","mouseover"]);ha$1("onPointerEnter",["pointerout","pointerover"]);ha$1("onPointerLeave",["pointerout","pointerover"]);fa$1("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa$1("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa$1("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa$1("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa$1("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa$1("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf$1="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf$1=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf$1));function nf$1(rt,_,ut){var mt=rt.type||"unknown-event";rt.currentTarget=ut,Ub$1(mt,_,void 0,rt),rt.currentTarget=null}function se(rt,_){_=(_&4)!==0;for(var ut=0;ut<rt.length;ut++){var mt=rt[ut],bt=mt.event;mt=mt.listeners;e:{var St=void 0;if(_)for(var Mt=mt.length-1;0<=Mt;Mt--){var Bt=mt[Mt],Ut=Bt.instance,Ht=Bt.currentTarget;if(Bt=Bt.listener,Ut!==St&&bt.isPropagationStopped())break e;nf$1(bt,Bt,Ht),St=Ut}else for(Mt=0;Mt<mt.length;Mt++){if(Bt=mt[Mt],Ut=Bt.instance,Ht=Bt.currentTarget,Bt=Bt.listener,Ut!==St&&bt.isPropagationStopped())break e;nf$1(bt,Bt,Ht),St=Ut}}}if(Qb$1)throw rt=Rb$1,Qb$1=!1,Rb$1=null,rt}function D$1(rt,_){var ut=_[of$1];ut===void 0&&(ut=_[of$1]=new Set);var mt=rt+"__bubble";ut.has(mt)||(pf$1(_,rt,2,!1),ut.add(mt))}function qf$1(rt,_,ut){var mt=0;_&&(mt|=4),pf$1(ut,rt,mt,_)}var rf$1="_reactListening"+Math.random().toString(36).slice(2);function sf$1(rt){if(!rt[rf$1]){rt[rf$1]=!0,da$1.forEach(function(ut){ut!=="selectionchange"&&(mf$1.has(ut)||qf$1(ut,!1,rt),qf$1(ut,!0,rt))});var _=rt.nodeType===9?rt:rt.ownerDocument;_===null||_[rf$1]||(_[rf$1]=!0,qf$1("selectionchange",!1,_))}}function pf$1(rt,_,ut,mt){switch(jd$1(_)){case 1:var bt=ed$1;break;case 4:bt=gd$1;break;default:bt=fd$2}ut=bt.bind(null,_,ut,rt),bt=void 0,!Lb$1||_!=="touchstart"&&_!=="touchmove"&&_!=="wheel"||(bt=!0),mt?bt!==void 0?rt.addEventListener(_,ut,{capture:!0,passive:bt}):rt.addEventListener(_,ut,!0):bt!==void 0?rt.addEventListener(_,ut,{passive:bt}):rt.addEventListener(_,ut,!1)}function hd(rt,_,ut,mt,bt){var St=mt;if(!(_&1)&&!(_&2)&&mt!==null)e:for(;;){if(mt===null)return;var Mt=mt.tag;if(Mt===3||Mt===4){var Bt=mt.stateNode.containerInfo;if(Bt===bt||Bt.nodeType===8&&Bt.parentNode===bt)break;if(Mt===4)for(Mt=mt.return;Mt!==null;){var Ut=Mt.tag;if((Ut===3||Ut===4)&&(Ut=Mt.stateNode.containerInfo,Ut===bt||Ut.nodeType===8&&Ut.parentNode===bt))return;Mt=Mt.return}for(;Bt!==null;){if(Mt=Wc$1(Bt),Mt===null)return;if(Ut=Mt.tag,Ut===5||Ut===6){mt=St=Mt;continue e}Bt=Bt.parentNode}}mt=mt.return}Jb$1(function(){var Ht=St,tr=xb$1(ut),rr=[];e:{var sr=df$1.get(rt);if(sr!==void 0){var ar=td$1,cr=rt;switch(rt){case"keypress":if(od$1(ut)===0)break e;case"keydown":case"keyup":ar=Rd;break;case"focusin":cr="focus",ar=Fd$1;break;case"focusout":cr="blur",ar=Fd$1;break;case"beforeblur":case"afterblur":ar=Fd$1;break;case"click":if(ut.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ar=Bd$1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ar=Dd$1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ar=Vd;break;case $e$1:case af$1:case bf$1:ar=Hd$1;break;case cf$1:ar=Xd;break;case"scroll":ar=vd;break;case"wheel":ar=Zd$1;break;case"copy":case"cut":case"paste":ar=Jd$1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ar=Td}var Ar=(_&4)!==0,_r=!Ar&&rt==="scroll",Dr=Ar?sr!==null?sr+"Capture":null:sr;Ar=[];for(var $r=Ht,Br;$r!==null;){Br=$r;var Jr=Br.stateNode;if(Br.tag===5&&Jr!==null&&(Br=Jr,Dr!==null&&(Jr=Kb$1($r,Dr),Jr!=null&&Ar.push(tf$1($r,Jr,Br)))),_r)break;$r=$r.return}0<Ar.length&&(sr=new ar(sr,cr,null,ut,tr),rr.push({event:sr,listeners:Ar}))}}if(!(_&7)){e:{if(sr=rt==="mouseover"||rt==="pointerover",ar=rt==="mouseout"||rt==="pointerout",sr&&ut!==wb$1&&(cr=ut.relatedTarget||ut.fromElement)&&(Wc$1(cr)||cr[uf$1]))break e;if((ar||sr)&&(sr=tr.window===tr?tr:(sr=tr.ownerDocument)?sr.defaultView||sr.parentWindow:window,ar?(cr=ut.relatedTarget||ut.toElement,ar=Ht,cr=cr?Wc$1(cr):null,cr!==null&&(_r=Vb$1(cr),cr!==_r||cr.tag!==5&&cr.tag!==6)&&(cr=null)):(ar=null,cr=Ht),ar!==cr)){if(Ar=Bd$1,Jr="onMouseLeave",Dr="onMouseEnter",$r="mouse",(rt==="pointerout"||rt==="pointerover")&&(Ar=Td,Jr="onPointerLeave",Dr="onPointerEnter",$r="pointer"),_r=ar==null?sr:ue(ar),Br=cr==null?sr:ue(cr),sr=new Ar(Jr,$r+"leave",ar,ut,tr),sr.target=_r,sr.relatedTarget=Br,Jr=null,Wc$1(tr)===Ht&&(Ar=new Ar(Dr,$r+"enter",cr,ut,tr),Ar.target=Br,Ar.relatedTarget=_r,Jr=Ar),_r=Jr,ar&&cr)t:{for(Ar=ar,Dr=cr,$r=0,Br=Ar;Br;Br=vf$1(Br))$r++;for(Br=0,Jr=Dr;Jr;Jr=vf$1(Jr))Br++;for(;0<$r-Br;)Ar=vf$1(Ar),$r--;for(;0<Br-$r;)Dr=vf$1(Dr),Br--;for(;$r--;){if(Ar===Dr||Dr!==null&&Ar===Dr.alternate)break t;Ar=vf$1(Ar),Dr=vf$1(Dr)}Ar=null}else Ar=null;ar!==null&&wf$1(rr,sr,ar,Ar,!1),cr!==null&&_r!==null&&wf$1(rr,_r,cr,Ar,!0)}}e:{if(sr=Ht?ue(Ht):window,ar=sr.nodeName&&sr.nodeName.toLowerCase(),ar==="select"||ar==="input"&&sr.type==="file")var mn=ve$1;else if(me$1(sr))if(we$1)mn=Fe$1;else{mn=De$1;var Mn=Ce$2}else(ar=sr.nodeName)&&ar.toLowerCase()==="input"&&(sr.type==="checkbox"||sr.type==="radio")&&(mn=Ee$1);if(mn&&(mn=mn(rt,Ht))){ne(rr,mn,ut,tr);break e}Mn&&Mn(rt,sr,Ht),rt==="focusout"&&(Mn=sr._wrapperState)&&Mn.controlled&&sr.type==="number"&&cb$1(sr,"number",sr.value)}switch(Mn=Ht?ue(Ht):window,rt){case"focusin":(me$1(Mn)||Mn.contentEditable==="true")&&(Qe=Mn,Re$1=Ht,Se=null);break;case"focusout":Se=Re$1=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue$1(rr,ut,tr);break;case"selectionchange":if(Pe$1)break;case"keydown":case"keyup":Ue$1(rr,ut,tr)}var $n;if(ae$1)e:{switch(rt){case"compositionstart":var en="onCompositionStart";break e;case"compositionend":en="onCompositionEnd";break e;case"compositionupdate":en="onCompositionUpdate";break e}en=void 0}else ie?ge(rt,ut)&&(en="onCompositionEnd"):rt==="keydown"&&ut.keyCode===229&&(en="onCompositionStart");en&&(de&&ut.locale!=="ko"&&(ie||en!=="onCompositionStart"?en==="onCompositionEnd"&&ie&&($n=nd$1()):(kd=tr,ld="value"in kd?kd.value:kd.textContent,ie=!0)),Mn=oe(Ht,en),0<Mn.length&&(en=new Ld$1(en,rt,null,ut,tr),rr.push({event:en,listeners:Mn}),$n?en.data=$n:($n=he$1(ut),$n!==null&&(en.data=$n)))),($n=ce$1?je$1(rt,ut):ke$1(rt,ut))&&(Ht=oe(Ht,"onBeforeInput"),0<Ht.length&&(tr=new Ld$1("onBeforeInput","beforeinput",null,ut,tr),rr.push({event:tr,listeners:Ht}),tr.data=$n))}se(rr,_)})}function tf$1(rt,_,ut){return{instance:rt,listener:_,currentTarget:ut}}function oe(rt,_){for(var ut=_+"Capture",mt=[];rt!==null;){var bt=rt,St=bt.stateNode;bt.tag===5&&St!==null&&(bt=St,St=Kb$1(rt,ut),St!=null&&mt.unshift(tf$1(rt,St,bt)),St=Kb$1(rt,_),St!=null&&mt.push(tf$1(rt,St,bt))),rt=rt.return}return mt}function vf$1(rt){if(rt===null)return null;do rt=rt.return;while(rt&&rt.tag!==5);return rt||null}function wf$1(rt,_,ut,mt,bt){for(var St=_._reactName,Mt=[];ut!==null&&ut!==mt;){var Bt=ut,Ut=Bt.alternate,Ht=Bt.stateNode;if(Ut!==null&&Ut===mt)break;Bt.tag===5&&Ht!==null&&(Bt=Ht,bt?(Ut=Kb$1(ut,St),Ut!=null&&Mt.unshift(tf$1(ut,Ut,Bt))):bt||(Ut=Kb$1(ut,St),Ut!=null&&Mt.push(tf$1(ut,Ut,Bt)))),ut=ut.return}Mt.length!==0&&rt.push({event:_,listeners:Mt})}var xf$1=/\r\n?/g,yf$1=/\u0000|\uFFFD/g;function zf$1(rt){return(typeof rt=="string"?rt:""+rt).replace(xf$1,`
`).replace(yf$1,"")}function Af$1(rt,_,ut){if(_=zf$1(_),zf$1(rt)!==_&&ut)throw Error(p$4(425))}function Bf$1(){}var Cf$1=null,Df$1=null;function Ef$1(rt,_){return rt==="textarea"||rt==="noscript"||typeof _.children=="string"||typeof _.children=="number"||typeof _.dangerouslySetInnerHTML=="object"&&_.dangerouslySetInnerHTML!==null&&_.dangerouslySetInnerHTML.__html!=null}var Ff$1=typeof setTimeout=="function"?setTimeout:void 0,Gf$1=typeof clearTimeout=="function"?clearTimeout:void 0,Hf$1=typeof Promise=="function"?Promise:void 0,Jf$1=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf$1<"u"?function(rt){return Hf$1.resolve(null).then(rt).catch(If$1)}:Ff$1;function If$1(rt){setTimeout(function(){throw rt})}function Kf$1(rt,_){var ut=_,mt=0;do{var bt=ut.nextSibling;if(rt.removeChild(ut),bt&&bt.nodeType===8)if(ut=bt.data,ut==="/$"){if(mt===0){rt.removeChild(bt),bd(_);return}mt--}else ut!=="$"&&ut!=="$?"&&ut!=="$!"||mt++;ut=bt}while(ut);bd(_)}function Lf$1(rt){for(;rt!=null;rt=rt.nextSibling){var _=rt.nodeType;if(_===1||_===3)break;if(_===8){if(_=rt.data,_==="$"||_==="$!"||_==="$?")break;if(_==="/$")return null}}return rt}function Mf$1(rt){rt=rt.previousSibling;for(var _=0;rt;){if(rt.nodeType===8){var ut=rt.data;if(ut==="$"||ut==="$!"||ut==="$?"){if(_===0)return rt;_--}else ut==="/$"&&_++}rt=rt.previousSibling}return null}var Nf$1=Math.random().toString(36).slice(2),Of$1="__reactFiber$"+Nf$1,Pf$1="__reactProps$"+Nf$1,uf$1="__reactContainer$"+Nf$1,of$1="__reactEvents$"+Nf$1,Qf$1="__reactListeners$"+Nf$1,Rf$1="__reactHandles$"+Nf$1;function Wc$1(rt){var _=rt[Of$1];if(_)return _;for(var ut=rt.parentNode;ut;){if(_=ut[uf$1]||ut[Of$1]){if(ut=_.alternate,_.child!==null||ut!==null&&ut.child!==null)for(rt=Mf$1(rt);rt!==null;){if(ut=rt[Of$1])return ut;rt=Mf$1(rt)}return _}rt=ut,ut=rt.parentNode}return null}function Cb$1(rt){return rt=rt[Of$1]||rt[uf$1],!rt||rt.tag!==5&&rt.tag!==6&&rt.tag!==13&&rt.tag!==3?null:rt}function ue(rt){if(rt.tag===5||rt.tag===6)return rt.stateNode;throw Error(p$4(33))}function Db$1(rt){return rt[Pf$1]||null}var Sf$1=[],Tf$1=-1;function Uf$1(rt){return{current:rt}}function E$2(rt){0>Tf$1||(rt.current=Sf$1[Tf$1],Sf$1[Tf$1]=null,Tf$1--)}function G$1(rt,_){Tf$1++,Sf$1[Tf$1]=rt.current,rt.current=_}var Vf$1={},H$2=Uf$1(Vf$1),Wf$1=Uf$1(!1),Xf$1=Vf$1;function Yf$1(rt,_){var ut=rt.type.contextTypes;if(!ut)return Vf$1;var mt=rt.stateNode;if(mt&&mt.__reactInternalMemoizedUnmaskedChildContext===_)return mt.__reactInternalMemoizedMaskedChildContext;var bt={},St;for(St in ut)bt[St]=_[St];return mt&&(rt=rt.stateNode,rt.__reactInternalMemoizedUnmaskedChildContext=_,rt.__reactInternalMemoizedMaskedChildContext=bt),bt}function Zf$1(rt){return rt=rt.childContextTypes,rt!=null}function $f$1(){E$2(Wf$1),E$2(H$2)}function ag$1(rt,_,ut){if(H$2.current!==Vf$1)throw Error(p$4(168));G$1(H$2,_),G$1(Wf$1,ut)}function bg$1(rt,_,ut){var mt=rt.stateNode;if(_=_.childContextTypes,typeof mt.getChildContext!="function")return ut;mt=mt.getChildContext();for(var bt in mt)if(!(bt in _))throw Error(p$4(108,Ra$1(rt)||"Unknown",bt));return A$1({},ut,mt)}function cg$1(rt){return rt=(rt=rt.stateNode)&&rt.__reactInternalMemoizedMergedChildContext||Vf$1,Xf$1=H$2.current,G$1(H$2,rt),G$1(Wf$1,Wf$1.current),!0}function dg(rt,_,ut){var mt=rt.stateNode;if(!mt)throw Error(p$4(169));ut?(rt=bg$1(rt,_,Xf$1),mt.__reactInternalMemoizedMergedChildContext=rt,E$2(Wf$1),E$2(H$2),G$1(H$2,rt)):E$2(Wf$1),G$1(Wf$1,ut)}var eg$1=null,fg$1=!1,gg$1=!1;function hg$1(rt){eg$1===null?eg$1=[rt]:eg$1.push(rt)}function ig$1(rt){fg$1=!0,hg$1(rt)}function jg$1(){if(!gg$1&&eg$1!==null){gg$1=!0;var rt=0,_=C$1;try{var ut=eg$1;for(C$1=1;rt<ut.length;rt++){var mt=ut[rt];do mt=mt(!0);while(mt!==null)}eg$1=null,fg$1=!1}catch(bt){throw eg$1!==null&&(eg$1=eg$1.slice(rt+1)),ac(fc$1,jg$1),bt}finally{C$1=_,gg$1=!1}}return null}var kg=[],lg$1=0,mg$1=null,ng$1=0,og$1=[],pg$1=0,qg$1=null,rg$1=1,sg$1="";function tg$1(rt,_){kg[lg$1++]=ng$1,kg[lg$1++]=mg$1,mg$1=rt,ng$1=_}function ug(rt,_,ut){og$1[pg$1++]=rg$1,og$1[pg$1++]=sg$1,og$1[pg$1++]=qg$1,qg$1=rt;var mt=rg$1;rt=sg$1;var bt=32-oc(mt)-1;mt&=~(1<<bt),ut+=1;var St=32-oc(_)+bt;if(30<St){var Mt=bt-bt%5;St=(mt&(1<<Mt)-1).toString(32),mt>>=Mt,bt-=Mt,rg$1=1<<32-oc(_)+bt|ut<<bt|mt,sg$1=St+rt}else rg$1=1<<St|ut<<bt|mt,sg$1=rt}function vg(rt){rt.return!==null&&(tg$1(rt,1),ug(rt,1,0))}function wg$1(rt){for(;rt===mg$1;)mg$1=kg[--lg$1],kg[lg$1]=null,ng$1=kg[--lg$1],kg[lg$1]=null;for(;rt===qg$1;)qg$1=og$1[--pg$1],og$1[pg$1]=null,sg$1=og$1[--pg$1],og$1[pg$1]=null,rg$1=og$1[--pg$1],og$1[pg$1]=null}var xg$1=null,yg$1=null,I$3=!1,zg=null;function Ag$1(rt,_){var ut=Bg$1(5,null,null,0);ut.elementType="DELETED",ut.stateNode=_,ut.return=rt,_=rt.deletions,_===null?(rt.deletions=[ut],rt.flags|=16):_.push(ut)}function Cg$1(rt,_){switch(rt.tag){case 5:var ut=rt.type;return _=_.nodeType!==1||ut.toLowerCase()!==_.nodeName.toLowerCase()?null:_,_!==null?(rt.stateNode=_,xg$1=rt,yg$1=Lf$1(_.firstChild),!0):!1;case 6:return _=rt.pendingProps===""||_.nodeType!==3?null:_,_!==null?(rt.stateNode=_,xg$1=rt,yg$1=null,!0):!1;case 13:return _=_.nodeType!==8?null:_,_!==null?(ut=qg$1!==null?{id:rg$1,overflow:sg$1}:null,rt.memoizedState={dehydrated:_,treeContext:ut,retryLane:1073741824},ut=Bg$1(18,null,null,0),ut.stateNode=_,ut.return=rt,rt.child=ut,xg$1=rt,yg$1=null,!0):!1;default:return!1}}function Dg(rt){return(rt.mode&1)!==0&&(rt.flags&128)===0}function Eg(rt){if(I$3){var _=yg$1;if(_){var ut=_;if(!Cg$1(rt,_)){if(Dg(rt))throw Error(p$4(418));_=Lf$1(ut.nextSibling);var mt=xg$1;_&&Cg$1(rt,_)?Ag$1(mt,ut):(rt.flags=rt.flags&-4097|2,I$3=!1,xg$1=rt)}}else{if(Dg(rt))throw Error(p$4(418));rt.flags=rt.flags&-4097|2,I$3=!1,xg$1=rt}}}function Fg$1(rt){for(rt=rt.return;rt!==null&&rt.tag!==5&&rt.tag!==3&&rt.tag!==13;)rt=rt.return;xg$1=rt}function Gg(rt){if(rt!==xg$1)return!1;if(!I$3)return Fg$1(rt),I$3=!0,!1;var _;if((_=rt.tag!==3)&&!(_=rt.tag!==5)&&(_=rt.type,_=_!=="head"&&_!=="body"&&!Ef$1(rt.type,rt.memoizedProps)),_&&(_=yg$1)){if(Dg(rt))throw Hg$1(),Error(p$4(418));for(;_;)Ag$1(rt,_),_=Lf$1(_.nextSibling)}if(Fg$1(rt),rt.tag===13){if(rt=rt.memoizedState,rt=rt!==null?rt.dehydrated:null,!rt)throw Error(p$4(317));e:{for(rt=rt.nextSibling,_=0;rt;){if(rt.nodeType===8){var ut=rt.data;if(ut==="/$"){if(_===0){yg$1=Lf$1(rt.nextSibling);break e}_--}else ut!=="$"&&ut!=="$!"&&ut!=="$?"||_++}rt=rt.nextSibling}yg$1=null}}else yg$1=xg$1?Lf$1(rt.stateNode.nextSibling):null;return!0}function Hg$1(){for(var rt=yg$1;rt;)rt=Lf$1(rt.nextSibling)}function Ig$1(){yg$1=xg$1=null,I$3=!1}function Jg(rt){zg===null?zg=[rt]:zg.push(rt)}var Kg$1=ua$1.ReactCurrentBatchConfig;function Lg$1(rt,_,ut){if(rt=ut.ref,rt!==null&&typeof rt!="function"&&typeof rt!="object"){if(ut._owner){if(ut=ut._owner,ut){if(ut.tag!==1)throw Error(p$4(309));var mt=ut.stateNode}if(!mt)throw Error(p$4(147,rt));var bt=mt,St=""+rt;return _!==null&&_.ref!==null&&typeof _.ref=="function"&&_.ref._stringRef===St?_.ref:(_=function(Mt){var Bt=bt.refs;Mt===null?delete Bt[St]:Bt[St]=Mt},_._stringRef=St,_)}if(typeof rt!="string")throw Error(p$4(284));if(!ut._owner)throw Error(p$4(290,rt))}return rt}function Mg$1(rt,_){throw rt=Object.prototype.toString.call(_),Error(p$4(31,rt==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":rt))}function Ng$1(rt){var _=rt._init;return _(rt._payload)}function Og(rt){function _(Dr,$r){if(rt){var Br=Dr.deletions;Br===null?(Dr.deletions=[$r],Dr.flags|=16):Br.push($r)}}function ut(Dr,$r){if(!rt)return null;for(;$r!==null;)_(Dr,$r),$r=$r.sibling;return null}function mt(Dr,$r){for(Dr=new Map;$r!==null;)$r.key!==null?Dr.set($r.key,$r):Dr.set($r.index,$r),$r=$r.sibling;return Dr}function bt(Dr,$r){return Dr=Pg$1(Dr,$r),Dr.index=0,Dr.sibling=null,Dr}function St(Dr,$r,Br){return Dr.index=Br,rt?(Br=Dr.alternate,Br!==null?(Br=Br.index,Br<$r?(Dr.flags|=2,$r):Br):(Dr.flags|=2,$r)):(Dr.flags|=1048576,$r)}function Mt(Dr){return rt&&Dr.alternate===null&&(Dr.flags|=2),Dr}function Bt(Dr,$r,Br,Jr){return $r===null||$r.tag!==6?($r=Qg$1(Br,Dr.mode,Jr),$r.return=Dr,$r):($r=bt($r,Br),$r.return=Dr,$r)}function Ut(Dr,$r,Br,Jr){var mn=Br.type;return mn===ya$1?tr(Dr,$r,Br.props.children,Jr,Br.key):$r!==null&&($r.elementType===mn||typeof mn=="object"&&mn!==null&&mn.$$typeof===Ha&&Ng$1(mn)===$r.type)?(Jr=bt($r,Br.props),Jr.ref=Lg$1(Dr,$r,Br),Jr.return=Dr,Jr):(Jr=Rg$1(Br.type,Br.key,Br.props,null,Dr.mode,Jr),Jr.ref=Lg$1(Dr,$r,Br),Jr.return=Dr,Jr)}function Ht(Dr,$r,Br,Jr){return $r===null||$r.tag!==4||$r.stateNode.containerInfo!==Br.containerInfo||$r.stateNode.implementation!==Br.implementation?($r=Sg$1(Br,Dr.mode,Jr),$r.return=Dr,$r):($r=bt($r,Br.children||[]),$r.return=Dr,$r)}function tr(Dr,$r,Br,Jr,mn){return $r===null||$r.tag!==7?($r=Tg$1(Br,Dr.mode,Jr,mn),$r.return=Dr,$r):($r=bt($r,Br),$r.return=Dr,$r)}function rr(Dr,$r,Br){if(typeof $r=="string"&&$r!==""||typeof $r=="number")return $r=Qg$1(""+$r,Dr.mode,Br),$r.return=Dr,$r;if(typeof $r=="object"&&$r!==null){switch($r.$$typeof){case va$1:return Br=Rg$1($r.type,$r.key,$r.props,null,Dr.mode,Br),Br.ref=Lg$1(Dr,null,$r),Br.return=Dr,Br;case wa$1:return $r=Sg$1($r,Dr.mode,Br),$r.return=Dr,$r;case Ha:var Jr=$r._init;return rr(Dr,Jr($r._payload),Br)}if(eb$1($r)||Ka$1($r))return $r=Tg$1($r,Dr.mode,Br,null),$r.return=Dr,$r;Mg$1(Dr,$r)}return null}function sr(Dr,$r,Br,Jr){var mn=$r!==null?$r.key:null;if(typeof Br=="string"&&Br!==""||typeof Br=="number")return mn!==null?null:Bt(Dr,$r,""+Br,Jr);if(typeof Br=="object"&&Br!==null){switch(Br.$$typeof){case va$1:return Br.key===mn?Ut(Dr,$r,Br,Jr):null;case wa$1:return Br.key===mn?Ht(Dr,$r,Br,Jr):null;case Ha:return mn=Br._init,sr(Dr,$r,mn(Br._payload),Jr)}if(eb$1(Br)||Ka$1(Br))return mn!==null?null:tr(Dr,$r,Br,Jr,null);Mg$1(Dr,Br)}return null}function ar(Dr,$r,Br,Jr,mn){if(typeof Jr=="string"&&Jr!==""||typeof Jr=="number")return Dr=Dr.get(Br)||null,Bt($r,Dr,""+Jr,mn);if(typeof Jr=="object"&&Jr!==null){switch(Jr.$$typeof){case va$1:return Dr=Dr.get(Jr.key===null?Br:Jr.key)||null,Ut($r,Dr,Jr,mn);case wa$1:return Dr=Dr.get(Jr.key===null?Br:Jr.key)||null,Ht($r,Dr,Jr,mn);case Ha:var Mn=Jr._init;return ar(Dr,$r,Br,Mn(Jr._payload),mn)}if(eb$1(Jr)||Ka$1(Jr))return Dr=Dr.get(Br)||null,tr($r,Dr,Jr,mn,null);Mg$1($r,Jr)}return null}function cr(Dr,$r,Br,Jr){for(var mn=null,Mn=null,$n=$r,en=$r=0,In=null;$n!==null&&en<Br.length;en++){$n.index>en?(In=$n,$n=null):In=$n.sibling;var Rn=sr(Dr,$n,Br[en],Jr);if(Rn===null){$n===null&&($n=In);break}rt&&$n&&Rn.alternate===null&&_(Dr,$n),$r=St(Rn,$r,en),Mn===null?mn=Rn:Mn.sibling=Rn,Mn=Rn,$n=In}if(en===Br.length)return ut(Dr,$n),I$3&&tg$1(Dr,en),mn;if($n===null){for(;en<Br.length;en++)$n=rr(Dr,Br[en],Jr),$n!==null&&($r=St($n,$r,en),Mn===null?mn=$n:Mn.sibling=$n,Mn=$n);return I$3&&tg$1(Dr,en),mn}for($n=mt(Dr,$n);en<Br.length;en++)In=ar($n,Dr,en,Br[en],Jr),In!==null&&(rt&&In.alternate!==null&&$n.delete(In.key===null?en:In.key),$r=St(In,$r,en),Mn===null?mn=In:Mn.sibling=In,Mn=In);return rt&&$n.forEach(function(qn){return _(Dr,qn)}),I$3&&tg$1(Dr,en),mn}function Ar(Dr,$r,Br,Jr){var mn=Ka$1(Br);if(typeof mn!="function")throw Error(p$4(150));if(Br=mn.call(Br),Br==null)throw Error(p$4(151));for(var Mn=mn=null,$n=$r,en=$r=0,In=null,Rn=Br.next();$n!==null&&!Rn.done;en++,Rn=Br.next()){$n.index>en?(In=$n,$n=null):In=$n.sibling;var qn=sr(Dr,$n,Rn.value,Jr);if(qn===null){$n===null&&($n=In);break}rt&&$n&&qn.alternate===null&&_(Dr,$n),$r=St(qn,$r,en),Mn===null?mn=qn:Mn.sibling=qn,Mn=qn,$n=In}if(Rn.done)return ut(Dr,$n),I$3&&tg$1(Dr,en),mn;if($n===null){for(;!Rn.done;en++,Rn=Br.next())Rn=rr(Dr,Rn.value,Jr),Rn!==null&&($r=St(Rn,$r,en),Mn===null?mn=Rn:Mn.sibling=Rn,Mn=Rn);return I$3&&tg$1(Dr,en),mn}for($n=mt(Dr,$n);!Rn.done;en++,Rn=Br.next())Rn=ar($n,Dr,en,Rn.value,Jr),Rn!==null&&(rt&&Rn.alternate!==null&&$n.delete(Rn.key===null?en:Rn.key),$r=St(Rn,$r,en),Mn===null?mn=Rn:Mn.sibling=Rn,Mn=Rn);return rt&&$n.forEach(function(Qn){return _(Dr,Qn)}),I$3&&tg$1(Dr,en),mn}function _r(Dr,$r,Br,Jr){if(typeof Br=="object"&&Br!==null&&Br.type===ya$1&&Br.key===null&&(Br=Br.props.children),typeof Br=="object"&&Br!==null){switch(Br.$$typeof){case va$1:e:{for(var mn=Br.key,Mn=$r;Mn!==null;){if(Mn.key===mn){if(mn=Br.type,mn===ya$1){if(Mn.tag===7){ut(Dr,Mn.sibling),$r=bt(Mn,Br.props.children),$r.return=Dr,Dr=$r;break e}}else if(Mn.elementType===mn||typeof mn=="object"&&mn!==null&&mn.$$typeof===Ha&&Ng$1(mn)===Mn.type){ut(Dr,Mn.sibling),$r=bt(Mn,Br.props),$r.ref=Lg$1(Dr,Mn,Br),$r.return=Dr,Dr=$r;break e}ut(Dr,Mn);break}else _(Dr,Mn);Mn=Mn.sibling}Br.type===ya$1?($r=Tg$1(Br.props.children,Dr.mode,Jr,Br.key),$r.return=Dr,Dr=$r):(Jr=Rg$1(Br.type,Br.key,Br.props,null,Dr.mode,Jr),Jr.ref=Lg$1(Dr,$r,Br),Jr.return=Dr,Dr=Jr)}return Mt(Dr);case wa$1:e:{for(Mn=Br.key;$r!==null;){if($r.key===Mn)if($r.tag===4&&$r.stateNode.containerInfo===Br.containerInfo&&$r.stateNode.implementation===Br.implementation){ut(Dr,$r.sibling),$r=bt($r,Br.children||[]),$r.return=Dr,Dr=$r;break e}else{ut(Dr,$r);break}else _(Dr,$r);$r=$r.sibling}$r=Sg$1(Br,Dr.mode,Jr),$r.return=Dr,Dr=$r}return Mt(Dr);case Ha:return Mn=Br._init,_r(Dr,$r,Mn(Br._payload),Jr)}if(eb$1(Br))return cr(Dr,$r,Br,Jr);if(Ka$1(Br))return Ar(Dr,$r,Br,Jr);Mg$1(Dr,Br)}return typeof Br=="string"&&Br!==""||typeof Br=="number"?(Br=""+Br,$r!==null&&$r.tag===6?(ut(Dr,$r.sibling),$r=bt($r,Br),$r.return=Dr,Dr=$r):(ut(Dr,$r),$r=Qg$1(Br,Dr.mode,Jr),$r.return=Dr,Dr=$r),Mt(Dr)):ut(Dr,$r)}return _r}var Ug=Og(!0),Vg=Og(!1),Wg$1=Uf$1(null),Xg$1=null,Yg$1=null,Zg=null;function $g$1(){Zg=Yg$1=Xg$1=null}function ah$1(rt){var _=Wg$1.current;E$2(Wg$1),rt._currentValue=_}function bh$1(rt,_,ut){for(;rt!==null;){var mt=rt.alternate;if((rt.childLanes&_)!==_?(rt.childLanes|=_,mt!==null&&(mt.childLanes|=_)):mt!==null&&(mt.childLanes&_)!==_&&(mt.childLanes|=_),rt===ut)break;rt=rt.return}}function ch$1(rt,_){Xg$1=rt,Zg=Yg$1=null,rt=rt.dependencies,rt!==null&&rt.firstContext!==null&&(rt.lanes&_&&(dh$1=!0),rt.firstContext=null)}function eh$1(rt){var _=rt._currentValue;if(Zg!==rt)if(rt={context:rt,memoizedValue:_,next:null},Yg$1===null){if(Xg$1===null)throw Error(p$4(308));Yg$1=rt,Xg$1.dependencies={lanes:0,firstContext:rt}}else Yg$1=Yg$1.next=rt;return _}var fh$1=null;function gh$1(rt){fh$1===null?fh$1=[rt]:fh$1.push(rt)}function hh$1(rt,_,ut,mt){var bt=_.interleaved;return bt===null?(ut.next=ut,gh$1(_)):(ut.next=bt.next,bt.next=ut),_.interleaved=ut,ih$1(rt,mt)}function ih$1(rt,_){rt.lanes|=_;var ut=rt.alternate;for(ut!==null&&(ut.lanes|=_),ut=rt,rt=rt.return;rt!==null;)rt.childLanes|=_,ut=rt.alternate,ut!==null&&(ut.childLanes|=_),ut=rt,rt=rt.return;return ut.tag===3?ut.stateNode:null}var jh$1=!1;function kh$1(rt){rt.updateQueue={baseState:rt.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh$1(rt,_){rt=rt.updateQueue,_.updateQueue===rt&&(_.updateQueue={baseState:rt.baseState,firstBaseUpdate:rt.firstBaseUpdate,lastBaseUpdate:rt.lastBaseUpdate,shared:rt.shared,effects:rt.effects})}function mh$1(rt,_){return{eventTime:rt,lane:_,tag:0,payload:null,callback:null,next:null}}function nh$1(rt,_,ut){var mt=rt.updateQueue;if(mt===null)return null;if(mt=mt.shared,K$1&2){var bt=mt.pending;return bt===null?_.next=_:(_.next=bt.next,bt.next=_),mt.pending=_,ih$1(rt,ut)}return bt=mt.interleaved,bt===null?(_.next=_,gh$1(mt)):(_.next=bt.next,bt.next=_),mt.interleaved=_,ih$1(rt,ut)}function oh$1(rt,_,ut){if(_=_.updateQueue,_!==null&&(_=_.shared,(ut&4194240)!==0)){var mt=_.lanes;mt&=rt.pendingLanes,ut|=mt,_.lanes=ut,Cc(rt,ut)}}function ph$1(rt,_){var ut=rt.updateQueue,mt=rt.alternate;if(mt!==null&&(mt=mt.updateQueue,ut===mt)){var bt=null,St=null;if(ut=ut.firstBaseUpdate,ut!==null){do{var Mt={eventTime:ut.eventTime,lane:ut.lane,tag:ut.tag,payload:ut.payload,callback:ut.callback,next:null};St===null?bt=St=Mt:St=St.next=Mt,ut=ut.next}while(ut!==null);St===null?bt=St=_:St=St.next=_}else bt=St=_;ut={baseState:mt.baseState,firstBaseUpdate:bt,lastBaseUpdate:St,shared:mt.shared,effects:mt.effects},rt.updateQueue=ut;return}rt=ut.lastBaseUpdate,rt===null?ut.firstBaseUpdate=_:rt.next=_,ut.lastBaseUpdate=_}function qh$1(rt,_,ut,mt){var bt=rt.updateQueue;jh$1=!1;var St=bt.firstBaseUpdate,Mt=bt.lastBaseUpdate,Bt=bt.shared.pending;if(Bt!==null){bt.shared.pending=null;var Ut=Bt,Ht=Ut.next;Ut.next=null,Mt===null?St=Ht:Mt.next=Ht,Mt=Ut;var tr=rt.alternate;tr!==null&&(tr=tr.updateQueue,Bt=tr.lastBaseUpdate,Bt!==Mt&&(Bt===null?tr.firstBaseUpdate=Ht:Bt.next=Ht,tr.lastBaseUpdate=Ut))}if(St!==null){var rr=bt.baseState;Mt=0,tr=Ht=Ut=null,Bt=St;do{var sr=Bt.lane,ar=Bt.eventTime;if((mt&sr)===sr){tr!==null&&(tr=tr.next={eventTime:ar,lane:0,tag:Bt.tag,payload:Bt.payload,callback:Bt.callback,next:null});e:{var cr=rt,Ar=Bt;switch(sr=_,ar=ut,Ar.tag){case 1:if(cr=Ar.payload,typeof cr=="function"){rr=cr.call(ar,rr,sr);break e}rr=cr;break e;case 3:cr.flags=cr.flags&-65537|128;case 0:if(cr=Ar.payload,sr=typeof cr=="function"?cr.call(ar,rr,sr):cr,sr==null)break e;rr=A$1({},rr,sr);break e;case 2:jh$1=!0}}Bt.callback!==null&&Bt.lane!==0&&(rt.flags|=64,sr=bt.effects,sr===null?bt.effects=[Bt]:sr.push(Bt))}else ar={eventTime:ar,lane:sr,tag:Bt.tag,payload:Bt.payload,callback:Bt.callback,next:null},tr===null?(Ht=tr=ar,Ut=rr):tr=tr.next=ar,Mt|=sr;if(Bt=Bt.next,Bt===null){if(Bt=bt.shared.pending,Bt===null)break;sr=Bt,Bt=sr.next,sr.next=null,bt.lastBaseUpdate=sr,bt.shared.pending=null}}while(!0);if(tr===null&&(Ut=rr),bt.baseState=Ut,bt.firstBaseUpdate=Ht,bt.lastBaseUpdate=tr,_=bt.shared.interleaved,_!==null){bt=_;do Mt|=bt.lane,bt=bt.next;while(bt!==_)}else St===null&&(bt.shared.lanes=0);rh$1|=Mt,rt.lanes=Mt,rt.memoizedState=rr}}function sh$1(rt,_,ut){if(rt=_.effects,_.effects=null,rt!==null)for(_=0;_<rt.length;_++){var mt=rt[_],bt=mt.callback;if(bt!==null){if(mt.callback=null,mt=ut,typeof bt!="function")throw Error(p$4(191,bt));bt.call(mt)}}}var th$1={},uh$1=Uf$1(th$1),vh$2=Uf$1(th$1),wh$1=Uf$1(th$1);function xh$1(rt){if(rt===th$1)throw Error(p$4(174));return rt}function yh$1(rt,_){switch(G$1(wh$1,_),G$1(vh$2,rt),G$1(uh$1,th$1),rt=_.nodeType,rt){case 9:case 11:_=(_=_.documentElement)?_.namespaceURI:lb$1(null,"");break;default:rt=rt===8?_.parentNode:_,_=rt.namespaceURI||null,rt=rt.tagName,_=lb$1(_,rt)}E$2(uh$1),G$1(uh$1,_)}function zh$1(){E$2(uh$1),E$2(vh$2),E$2(wh$1)}function Ah$1(rt){xh$1(wh$1.current);var _=xh$1(uh$1.current),ut=lb$1(_,rt.type);_!==ut&&(G$1(vh$2,rt),G$1(uh$1,ut))}function Bh$1(rt){vh$2.current===rt&&(E$2(uh$1),E$2(vh$2))}var L$3=Uf$1(0);function Ch$1(rt){for(var _=rt;_!==null;){if(_.tag===13){var ut=_.memoizedState;if(ut!==null&&(ut=ut.dehydrated,ut===null||ut.data==="$?"||ut.data==="$!"))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if(_.flags&128)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===rt)break;for(;_.sibling===null;){if(_.return===null||_.return===rt)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}var Dh$1=[];function Eh$1(){for(var rt=0;rt<Dh$1.length;rt++)Dh$1[rt]._workInProgressVersionPrimary=null;Dh$1.length=0}var Fh$1=ua$1.ReactCurrentDispatcher,Gh$1=ua$1.ReactCurrentBatchConfig,Hh$1=0,M$2=null,N$2=null,O$1=null,Ih$1=!1,Jh$1=!1,Kh$1=0,Lh$1=0;function P$1(){throw Error(p$4(321))}function Mh$1(rt,_){if(_===null)return!1;for(var ut=0;ut<_.length&&ut<rt.length;ut++)if(!He(rt[ut],_[ut]))return!1;return!0}function Nh$1(rt,_,ut,mt,bt,St){if(Hh$1=St,M$2=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,Fh$1.current=rt===null||rt.memoizedState===null?Oh$1:Ph$1,rt=ut(mt,bt),Jh$1){St=0;do{if(Jh$1=!1,Kh$1=0,25<=St)throw Error(p$4(301));St+=1,O$1=N$2=null,_.updateQueue=null,Fh$1.current=Qh$1,rt=ut(mt,bt)}while(Jh$1)}if(Fh$1.current=Rh$1,_=N$2!==null&&N$2.next!==null,Hh$1=0,O$1=N$2=M$2=null,Ih$1=!1,_)throw Error(p$4(300));return rt}function Sh$1(){var rt=Kh$1!==0;return Kh$1=0,rt}function Th$1(){var rt={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O$1===null?M$2.memoizedState=O$1=rt:O$1=O$1.next=rt,O$1}function Uh$1(){if(N$2===null){var rt=M$2.alternate;rt=rt!==null?rt.memoizedState:null}else rt=N$2.next;var _=O$1===null?M$2.memoizedState:O$1.next;if(_!==null)O$1=_,N$2=rt;else{if(rt===null)throw Error(p$4(310));N$2=rt,rt={memoizedState:N$2.memoizedState,baseState:N$2.baseState,baseQueue:N$2.baseQueue,queue:N$2.queue,next:null},O$1===null?M$2.memoizedState=O$1=rt:O$1=O$1.next=rt}return O$1}function Vh$1(rt,_){return typeof _=="function"?_(rt):_}function Wh$1(rt){var _=Uh$1(),ut=_.queue;if(ut===null)throw Error(p$4(311));ut.lastRenderedReducer=rt;var mt=N$2,bt=mt.baseQueue,St=ut.pending;if(St!==null){if(bt!==null){var Mt=bt.next;bt.next=St.next,St.next=Mt}mt.baseQueue=bt=St,ut.pending=null}if(bt!==null){St=bt.next,mt=mt.baseState;var Bt=Mt=null,Ut=null,Ht=St;do{var tr=Ht.lane;if((Hh$1&tr)===tr)Ut!==null&&(Ut=Ut.next={lane:0,action:Ht.action,hasEagerState:Ht.hasEagerState,eagerState:Ht.eagerState,next:null}),mt=Ht.hasEagerState?Ht.eagerState:rt(mt,Ht.action);else{var rr={lane:tr,action:Ht.action,hasEagerState:Ht.hasEagerState,eagerState:Ht.eagerState,next:null};Ut===null?(Bt=Ut=rr,Mt=mt):Ut=Ut.next=rr,M$2.lanes|=tr,rh$1|=tr}Ht=Ht.next}while(Ht!==null&&Ht!==St);Ut===null?Mt=mt:Ut.next=Bt,He(mt,_.memoizedState)||(dh$1=!0),_.memoizedState=mt,_.baseState=Mt,_.baseQueue=Ut,ut.lastRenderedState=mt}if(rt=ut.interleaved,rt!==null){bt=rt;do St=bt.lane,M$2.lanes|=St,rh$1|=St,bt=bt.next;while(bt!==rt)}else bt===null&&(ut.lanes=0);return[_.memoizedState,ut.dispatch]}function Xh$1(rt){var _=Uh$1(),ut=_.queue;if(ut===null)throw Error(p$4(311));ut.lastRenderedReducer=rt;var mt=ut.dispatch,bt=ut.pending,St=_.memoizedState;if(bt!==null){ut.pending=null;var Mt=bt=bt.next;do St=rt(St,Mt.action),Mt=Mt.next;while(Mt!==bt);He(St,_.memoizedState)||(dh$1=!0),_.memoizedState=St,_.baseQueue===null&&(_.baseState=St),ut.lastRenderedState=St}return[St,mt]}function Yh$1(){}function Zh$1(rt,_){var ut=M$2,mt=Uh$1(),bt=_(),St=!He(mt.memoizedState,bt);if(St&&(mt.memoizedState=bt,dh$1=!0),mt=mt.queue,$h$1(ai$1.bind(null,ut,mt,rt),[rt]),mt.getSnapshot!==_||St||O$1!==null&&O$1.memoizedState.tag&1){if(ut.flags|=2048,bi$1(9,ci$1.bind(null,ut,mt,bt,_),void 0,null),Q$1===null)throw Error(p$4(349));Hh$1&30||di$1(ut,_,bt)}return bt}function di$1(rt,_,ut){rt.flags|=16384,rt={getSnapshot:_,value:ut},_=M$2.updateQueue,_===null?(_={lastEffect:null,stores:null},M$2.updateQueue=_,_.stores=[rt]):(ut=_.stores,ut===null?_.stores=[rt]:ut.push(rt))}function ci$1(rt,_,ut,mt){_.value=ut,_.getSnapshot=mt,ei$1(_)&&fi$1(rt)}function ai$1(rt,_,ut){return ut(function(){ei$1(_)&&fi$1(rt)})}function ei$1(rt){var _=rt.getSnapshot;rt=rt.value;try{var ut=_();return!He(rt,ut)}catch{return!0}}function fi$1(rt){var _=ih$1(rt,1);_!==null&&gi$1(_,rt,1,-1)}function hi$1(rt){var _=Th$1();return typeof rt=="function"&&(rt=rt()),_.memoizedState=_.baseState=rt,rt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh$1,lastRenderedState:rt},_.queue=rt,rt=rt.dispatch=ii$1.bind(null,M$2,rt),[_.memoizedState,rt]}function bi$1(rt,_,ut,mt){return rt={tag:rt,create:_,destroy:ut,deps:mt,next:null},_=M$2.updateQueue,_===null?(_={lastEffect:null,stores:null},M$2.updateQueue=_,_.lastEffect=rt.next=rt):(ut=_.lastEffect,ut===null?_.lastEffect=rt.next=rt:(mt=ut.next,ut.next=rt,rt.next=mt,_.lastEffect=rt)),rt}function ji$1(){return Uh$1().memoizedState}function ki$1(rt,_,ut,mt){var bt=Th$1();M$2.flags|=rt,bt.memoizedState=bi$1(1|_,ut,void 0,mt===void 0?null:mt)}function li$1(rt,_,ut,mt){var bt=Uh$1();mt=mt===void 0?null:mt;var St=void 0;if(N$2!==null){var Mt=N$2.memoizedState;if(St=Mt.destroy,mt!==null&&Mh$1(mt,Mt.deps)){bt.memoizedState=bi$1(_,ut,St,mt);return}}M$2.flags|=rt,bt.memoizedState=bi$1(1|_,ut,St,mt)}function mi$1(rt,_){return ki$1(8390656,8,rt,_)}function $h$1(rt,_){return li$1(2048,8,rt,_)}function ni$1(rt,_){return li$1(4,2,rt,_)}function oi$1(rt,_){return li$1(4,4,rt,_)}function pi$1(rt,_){if(typeof _=="function")return rt=rt(),_(rt),function(){_(null)};if(_!=null)return rt=rt(),_.current=rt,function(){_.current=null}}function qi$1(rt,_,ut){return ut=ut!=null?ut.concat([rt]):null,li$1(4,4,pi$1.bind(null,_,rt),ut)}function ri$1(){}function si$1(rt,_){var ut=Uh$1();_=_===void 0?null:_;var mt=ut.memoizedState;return mt!==null&&_!==null&&Mh$1(_,mt[1])?mt[0]:(ut.memoizedState=[rt,_],rt)}function ti$1(rt,_){var ut=Uh$1();_=_===void 0?null:_;var mt=ut.memoizedState;return mt!==null&&_!==null&&Mh$1(_,mt[1])?mt[0]:(rt=rt(),ut.memoizedState=[rt,_],rt)}function ui$1(rt,_,ut){return Hh$1&21?(He(ut,_)||(ut=yc(),M$2.lanes|=ut,rh$1|=ut,rt.baseState=!0),_):(rt.baseState&&(rt.baseState=!1,dh$1=!0),rt.memoizedState=ut)}function vi$1(rt,_){var ut=C$1;C$1=ut!==0&&4>ut?ut:4,rt(!0);var mt=Gh$1.transition;Gh$1.transition={};try{rt(!1),_()}finally{C$1=ut,Gh$1.transition=mt}}function wi$1(){return Uh$1().memoizedState}function xi$1(rt,_,ut){var mt=yi$1(rt);if(ut={lane:mt,action:ut,hasEagerState:!1,eagerState:null,next:null},zi$1(rt))Ai$1(_,ut);else if(ut=hh$1(rt,_,ut,mt),ut!==null){var bt=R$1();gi$1(ut,rt,mt,bt),Bi$1(ut,_,mt)}}function ii$1(rt,_,ut){var mt=yi$1(rt),bt={lane:mt,action:ut,hasEagerState:!1,eagerState:null,next:null};if(zi$1(rt))Ai$1(_,bt);else{var St=rt.alternate;if(rt.lanes===0&&(St===null||St.lanes===0)&&(St=_.lastRenderedReducer,St!==null))try{var Mt=_.lastRenderedState,Bt=St(Mt,ut);if(bt.hasEagerState=!0,bt.eagerState=Bt,He(Bt,Mt)){var Ut=_.interleaved;Ut===null?(bt.next=bt,gh$1(_)):(bt.next=Ut.next,Ut.next=bt),_.interleaved=bt;return}}catch{}finally{}ut=hh$1(rt,_,bt,mt),ut!==null&&(bt=R$1(),gi$1(ut,rt,mt,bt),Bi$1(ut,_,mt))}}function zi$1(rt){var _=rt.alternate;return rt===M$2||_!==null&&_===M$2}function Ai$1(rt,_){Jh$1=Ih$1=!0;var ut=rt.pending;ut===null?_.next=_:(_.next=ut.next,ut.next=_),rt.pending=_}function Bi$1(rt,_,ut){if(ut&4194240){var mt=_.lanes;mt&=rt.pendingLanes,ut|=mt,_.lanes=ut,Cc(rt,ut)}}var Rh$1={readContext:eh$1,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh$1={readContext:eh$1,useCallback:function(rt,_){return Th$1().memoizedState=[rt,_===void 0?null:_],rt},useContext:eh$1,useEffect:mi$1,useImperativeHandle:function(rt,_,ut){return ut=ut!=null?ut.concat([rt]):null,ki$1(4194308,4,pi$1.bind(null,_,rt),ut)},useLayoutEffect:function(rt,_){return ki$1(4194308,4,rt,_)},useInsertionEffect:function(rt,_){return ki$1(4,2,rt,_)},useMemo:function(rt,_){var ut=Th$1();return _=_===void 0?null:_,rt=rt(),ut.memoizedState=[rt,_],rt},useReducer:function(rt,_,ut){var mt=Th$1();return _=ut!==void 0?ut(_):_,mt.memoizedState=mt.baseState=_,rt={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rt,lastRenderedState:_},mt.queue=rt,rt=rt.dispatch=xi$1.bind(null,M$2,rt),[mt.memoizedState,rt]},useRef:function(rt){var _=Th$1();return rt={current:rt},_.memoizedState=rt},useState:hi$1,useDebugValue:ri$1,useDeferredValue:function(rt){return Th$1().memoizedState=rt},useTransition:function(){var rt=hi$1(!1),_=rt[0];return rt=vi$1.bind(null,rt[1]),Th$1().memoizedState=rt,[_,rt]},useMutableSource:function(){},useSyncExternalStore:function(rt,_,ut){var mt=M$2,bt=Th$1();if(I$3){if(ut===void 0)throw Error(p$4(407));ut=ut()}else{if(ut=_(),Q$1===null)throw Error(p$4(349));Hh$1&30||di$1(mt,_,ut)}bt.memoizedState=ut;var St={value:ut,getSnapshot:_};return bt.queue=St,mi$1(ai$1.bind(null,mt,St,rt),[rt]),mt.flags|=2048,bi$1(9,ci$1.bind(null,mt,St,ut,_),void 0,null),ut},useId:function(){var rt=Th$1(),_=Q$1.identifierPrefix;if(I$3){var ut=sg$1,mt=rg$1;ut=(mt&~(1<<32-oc(mt)-1)).toString(32)+ut,_=":"+_+"R"+ut,ut=Kh$1++,0<ut&&(_+="H"+ut.toString(32)),_+=":"}else ut=Lh$1++,_=":"+_+"r"+ut.toString(32)+":";return rt.memoizedState=_},unstable_isNewReconciler:!1},Ph$1={readContext:eh$1,useCallback:si$1,useContext:eh$1,useEffect:$h$1,useImperativeHandle:qi$1,useInsertionEffect:ni$1,useLayoutEffect:oi$1,useMemo:ti$1,useReducer:Wh$1,useRef:ji$1,useState:function(){return Wh$1(Vh$1)},useDebugValue:ri$1,useDeferredValue:function(rt){var _=Uh$1();return ui$1(_,N$2.memoizedState,rt)},useTransition:function(){var rt=Wh$1(Vh$1)[0],_=Uh$1().memoizedState;return[rt,_]},useMutableSource:Yh$1,useSyncExternalStore:Zh$1,useId:wi$1,unstable_isNewReconciler:!1},Qh$1={readContext:eh$1,useCallback:si$1,useContext:eh$1,useEffect:$h$1,useImperativeHandle:qi$1,useInsertionEffect:ni$1,useLayoutEffect:oi$1,useMemo:ti$1,useReducer:Xh$1,useRef:ji$1,useState:function(){return Xh$1(Vh$1)},useDebugValue:ri$1,useDeferredValue:function(rt){var _=Uh$1();return N$2===null?_.memoizedState=rt:ui$1(_,N$2.memoizedState,rt)},useTransition:function(){var rt=Xh$1(Vh$1)[0],_=Uh$1().memoizedState;return[rt,_]},useMutableSource:Yh$1,useSyncExternalStore:Zh$1,useId:wi$1,unstable_isNewReconciler:!1};function Ci$1(rt,_){if(rt&&rt.defaultProps){_=A$1({},_),rt=rt.defaultProps;for(var ut in rt)_[ut]===void 0&&(_[ut]=rt[ut]);return _}return _}function Di$1(rt,_,ut,mt){_=rt.memoizedState,ut=ut(mt,_),ut=ut==null?_:A$1({},_,ut),rt.memoizedState=ut,rt.lanes===0&&(rt.updateQueue.baseState=ut)}var Ei={isMounted:function(rt){return(rt=rt._reactInternals)?Vb$1(rt)===rt:!1},enqueueSetState:function(rt,_,ut){rt=rt._reactInternals;var mt=R$1(),bt=yi$1(rt),St=mh$1(mt,bt);St.payload=_,ut!=null&&(St.callback=ut),_=nh$1(rt,St,bt),_!==null&&(gi$1(_,rt,bt,mt),oh$1(_,rt,bt))},enqueueReplaceState:function(rt,_,ut){rt=rt._reactInternals;var mt=R$1(),bt=yi$1(rt),St=mh$1(mt,bt);St.tag=1,St.payload=_,ut!=null&&(St.callback=ut),_=nh$1(rt,St,bt),_!==null&&(gi$1(_,rt,bt,mt),oh$1(_,rt,bt))},enqueueForceUpdate:function(rt,_){rt=rt._reactInternals;var ut=R$1(),mt=yi$1(rt),bt=mh$1(ut,mt);bt.tag=2,_!=null&&(bt.callback=_),_=nh$1(rt,bt,mt),_!==null&&(gi$1(_,rt,mt,ut),oh$1(_,rt,mt))}};function Fi$1(rt,_,ut,mt,bt,St,Mt){return rt=rt.stateNode,typeof rt.shouldComponentUpdate=="function"?rt.shouldComponentUpdate(mt,St,Mt):_.prototype&&_.prototype.isPureReactComponent?!Ie$1(ut,mt)||!Ie$1(bt,St):!0}function Gi$1(rt,_,ut){var mt=!1,bt=Vf$1,St=_.contextType;return typeof St=="object"&&St!==null?St=eh$1(St):(bt=Zf$1(_)?Xf$1:H$2.current,mt=_.contextTypes,St=(mt=mt!=null)?Yf$1(rt,bt):Vf$1),_=new _(ut,St),rt.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Ei,rt.stateNode=_,_._reactInternals=rt,mt&&(rt=rt.stateNode,rt.__reactInternalMemoizedUnmaskedChildContext=bt,rt.__reactInternalMemoizedMaskedChildContext=St),_}function Hi$1(rt,_,ut,mt){rt=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(ut,mt),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(ut,mt),_.state!==rt&&Ei.enqueueReplaceState(_,_.state,null)}function Ii$1(rt,_,ut,mt){var bt=rt.stateNode;bt.props=ut,bt.state=rt.memoizedState,bt.refs={},kh$1(rt);var St=_.contextType;typeof St=="object"&&St!==null?bt.context=eh$1(St):(St=Zf$1(_)?Xf$1:H$2.current,bt.context=Yf$1(rt,St)),bt.state=rt.memoizedState,St=_.getDerivedStateFromProps,typeof St=="function"&&(Di$1(rt,_,St,ut),bt.state=rt.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof bt.getSnapshotBeforeUpdate=="function"||typeof bt.UNSAFE_componentWillMount!="function"&&typeof bt.componentWillMount!="function"||(_=bt.state,typeof bt.componentWillMount=="function"&&bt.componentWillMount(),typeof bt.UNSAFE_componentWillMount=="function"&&bt.UNSAFE_componentWillMount(),_!==bt.state&&Ei.enqueueReplaceState(bt,bt.state,null),qh$1(rt,ut,bt,mt),bt.state=rt.memoizedState),typeof bt.componentDidMount=="function"&&(rt.flags|=4194308)}function Ji$1(rt,_){try{var ut="",mt=_;do ut+=Pa(mt),mt=mt.return;while(mt);var bt=ut}catch(St){bt=`
Error generating stack: `+St.message+`
`+St.stack}return{value:rt,source:_,stack:bt,digest:null}}function Ki$1(rt,_,ut){return{value:rt,source:null,stack:ut??null,digest:_??null}}function Li$1(rt,_){try{console.error(_.value)}catch(ut){setTimeout(function(){throw ut})}}var Mi$1=typeof WeakMap=="function"?WeakMap:Map;function Ni$1(rt,_,ut){ut=mh$1(-1,ut),ut.tag=3,ut.payload={element:null};var mt=_.value;return ut.callback=function(){Oi$1||(Oi$1=!0,Pi$1=mt),Li$1(rt,_)},ut}function Qi(rt,_,ut){ut=mh$1(-1,ut),ut.tag=3;var mt=rt.type.getDerivedStateFromError;if(typeof mt=="function"){var bt=_.value;ut.payload=function(){return mt(bt)},ut.callback=function(){Li$1(rt,_)}}var St=rt.stateNode;return St!==null&&typeof St.componentDidCatch=="function"&&(ut.callback=function(){Li$1(rt,_),typeof mt!="function"&&(Ri$1===null?Ri$1=new Set([this]):Ri$1.add(this));var Mt=_.stack;this.componentDidCatch(_.value,{componentStack:Mt!==null?Mt:""})}),ut}function Si$1(rt,_,ut){var mt=rt.pingCache;if(mt===null){mt=rt.pingCache=new Mi$1;var bt=new Set;mt.set(_,bt)}else bt=mt.get(_),bt===void 0&&(bt=new Set,mt.set(_,bt));bt.has(ut)||(bt.add(ut),rt=Ti$1.bind(null,rt,_,ut),_.then(rt,rt))}function Ui$1(rt){do{var _;if((_=rt.tag===13)&&(_=rt.memoizedState,_=_!==null?_.dehydrated!==null:!0),_)return rt;rt=rt.return}while(rt!==null);return null}function Vi$1(rt,_,ut,mt,bt){return rt.mode&1?(rt.flags|=65536,rt.lanes=bt,rt):(rt===_?rt.flags|=65536:(rt.flags|=128,ut.flags|=131072,ut.flags&=-52805,ut.tag===1&&(ut.alternate===null?ut.tag=17:(_=mh$1(-1,1),_.tag=2,nh$1(ut,_,1))),ut.lanes|=1),rt)}var Wi$1=ua$1.ReactCurrentOwner,dh$1=!1;function Xi$1(rt,_,ut,mt){_.child=rt===null?Vg(_,null,ut,mt):Ug(_,rt.child,ut,mt)}function Yi$1(rt,_,ut,mt,bt){ut=ut.render;var St=_.ref;return ch$1(_,bt),mt=Nh$1(rt,_,ut,mt,St,bt),ut=Sh$1(),rt!==null&&!dh$1?(_.updateQueue=rt.updateQueue,_.flags&=-2053,rt.lanes&=~bt,Zi$1(rt,_,bt)):(I$3&&ut&&vg(_),_.flags|=1,Xi$1(rt,_,mt,bt),_.child)}function $i$1(rt,_,ut,mt,bt){if(rt===null){var St=ut.type;return typeof St=="function"&&!aj(St)&&St.defaultProps===void 0&&ut.compare===null&&ut.defaultProps===void 0?(_.tag=15,_.type=St,bj(rt,_,St,mt,bt)):(rt=Rg$1(ut.type,null,mt,_,_.mode,bt),rt.ref=_.ref,rt.return=_,_.child=rt)}if(St=rt.child,!(rt.lanes&bt)){var Mt=St.memoizedProps;if(ut=ut.compare,ut=ut!==null?ut:Ie$1,ut(Mt,mt)&&rt.ref===_.ref)return Zi$1(rt,_,bt)}return _.flags|=1,rt=Pg$1(St,mt),rt.ref=_.ref,rt.return=_,_.child=rt}function bj(rt,_,ut,mt,bt){if(rt!==null){var St=rt.memoizedProps;if(Ie$1(St,mt)&&rt.ref===_.ref)if(dh$1=!1,_.pendingProps=mt=St,(rt.lanes&bt)!==0)rt.flags&131072&&(dh$1=!0);else return _.lanes=rt.lanes,Zi$1(rt,_,bt)}return cj(rt,_,ut,mt,bt)}function dj(rt,_,ut){var mt=_.pendingProps,bt=mt.children,St=rt!==null?rt.memoizedState:null;if(mt.mode==="hidden")if(!(_.mode&1))_.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(ej,fj),fj|=ut;else{if(!(ut&1073741824))return rt=St!==null?St.baseLanes|ut:ut,_.lanes=_.childLanes=1073741824,_.memoizedState={baseLanes:rt,cachePool:null,transitions:null},_.updateQueue=null,G$1(ej,fj),fj|=rt,null;_.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt=St!==null?St.baseLanes:ut,G$1(ej,fj),fj|=mt}else St!==null?(mt=St.baseLanes|ut,_.memoizedState=null):mt=ut,G$1(ej,fj),fj|=mt;return Xi$1(rt,_,bt,ut),_.child}function gj(rt,_){var ut=_.ref;(rt===null&&ut!==null||rt!==null&&rt.ref!==ut)&&(_.flags|=512,_.flags|=2097152)}function cj(rt,_,ut,mt,bt){var St=Zf$1(ut)?Xf$1:H$2.current;return St=Yf$1(_,St),ch$1(_,bt),ut=Nh$1(rt,_,ut,mt,St,bt),mt=Sh$1(),rt!==null&&!dh$1?(_.updateQueue=rt.updateQueue,_.flags&=-2053,rt.lanes&=~bt,Zi$1(rt,_,bt)):(I$3&&mt&&vg(_),_.flags|=1,Xi$1(rt,_,ut,bt),_.child)}function hj(rt,_,ut,mt,bt){if(Zf$1(ut)){var St=!0;cg$1(_)}else St=!1;if(ch$1(_,bt),_.stateNode===null)ij(rt,_),Gi$1(_,ut,mt),Ii$1(_,ut,mt,bt),mt=!0;else if(rt===null){var Mt=_.stateNode,Bt=_.memoizedProps;Mt.props=Bt;var Ut=Mt.context,Ht=ut.contextType;typeof Ht=="object"&&Ht!==null?Ht=eh$1(Ht):(Ht=Zf$1(ut)?Xf$1:H$2.current,Ht=Yf$1(_,Ht));var tr=ut.getDerivedStateFromProps,rr=typeof tr=="function"||typeof Mt.getSnapshotBeforeUpdate=="function";rr||typeof Mt.UNSAFE_componentWillReceiveProps!="function"&&typeof Mt.componentWillReceiveProps!="function"||(Bt!==mt||Ut!==Ht)&&Hi$1(_,Mt,mt,Ht),jh$1=!1;var sr=_.memoizedState;Mt.state=sr,qh$1(_,mt,Mt,bt),Ut=_.memoizedState,Bt!==mt||sr!==Ut||Wf$1.current||jh$1?(typeof tr=="function"&&(Di$1(_,ut,tr,mt),Ut=_.memoizedState),(Bt=jh$1||Fi$1(_,ut,Bt,mt,sr,Ut,Ht))?(rr||typeof Mt.UNSAFE_componentWillMount!="function"&&typeof Mt.componentWillMount!="function"||(typeof Mt.componentWillMount=="function"&&Mt.componentWillMount(),typeof Mt.UNSAFE_componentWillMount=="function"&&Mt.UNSAFE_componentWillMount()),typeof Mt.componentDidMount=="function"&&(_.flags|=4194308)):(typeof Mt.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=mt,_.memoizedState=Ut),Mt.props=mt,Mt.state=Ut,Mt.context=Ht,mt=Bt):(typeof Mt.componentDidMount=="function"&&(_.flags|=4194308),mt=!1)}else{Mt=_.stateNode,lh$1(rt,_),Bt=_.memoizedProps,Ht=_.type===_.elementType?Bt:Ci$1(_.type,Bt),Mt.props=Ht,rr=_.pendingProps,sr=Mt.context,Ut=ut.contextType,typeof Ut=="object"&&Ut!==null?Ut=eh$1(Ut):(Ut=Zf$1(ut)?Xf$1:H$2.current,Ut=Yf$1(_,Ut));var ar=ut.getDerivedStateFromProps;(tr=typeof ar=="function"||typeof Mt.getSnapshotBeforeUpdate=="function")||typeof Mt.UNSAFE_componentWillReceiveProps!="function"&&typeof Mt.componentWillReceiveProps!="function"||(Bt!==rr||sr!==Ut)&&Hi$1(_,Mt,mt,Ut),jh$1=!1,sr=_.memoizedState,Mt.state=sr,qh$1(_,mt,Mt,bt);var cr=_.memoizedState;Bt!==rr||sr!==cr||Wf$1.current||jh$1?(typeof ar=="function"&&(Di$1(_,ut,ar,mt),cr=_.memoizedState),(Ht=jh$1||Fi$1(_,ut,Ht,mt,sr,cr,Ut)||!1)?(tr||typeof Mt.UNSAFE_componentWillUpdate!="function"&&typeof Mt.componentWillUpdate!="function"||(typeof Mt.componentWillUpdate=="function"&&Mt.componentWillUpdate(mt,cr,Ut),typeof Mt.UNSAFE_componentWillUpdate=="function"&&Mt.UNSAFE_componentWillUpdate(mt,cr,Ut)),typeof Mt.componentDidUpdate=="function"&&(_.flags|=4),typeof Mt.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof Mt.componentDidUpdate!="function"||Bt===rt.memoizedProps&&sr===rt.memoizedState||(_.flags|=4),typeof Mt.getSnapshotBeforeUpdate!="function"||Bt===rt.memoizedProps&&sr===rt.memoizedState||(_.flags|=1024),_.memoizedProps=mt,_.memoizedState=cr),Mt.props=mt,Mt.state=cr,Mt.context=Ut,mt=Ht):(typeof Mt.componentDidUpdate!="function"||Bt===rt.memoizedProps&&sr===rt.memoizedState||(_.flags|=4),typeof Mt.getSnapshotBeforeUpdate!="function"||Bt===rt.memoizedProps&&sr===rt.memoizedState||(_.flags|=1024),mt=!1)}return jj(rt,_,ut,mt,St,bt)}function jj(rt,_,ut,mt,bt,St){gj(rt,_);var Mt=(_.flags&128)!==0;if(!mt&&!Mt)return bt&&dg(_,ut,!1),Zi$1(rt,_,St);mt=_.stateNode,Wi$1.current=_;var Bt=Mt&&typeof ut.getDerivedStateFromError!="function"?null:mt.render();return _.flags|=1,rt!==null&&Mt?(_.child=Ug(_,rt.child,null,St),_.child=Ug(_,null,Bt,St)):Xi$1(rt,_,Bt,St),_.memoizedState=mt.state,bt&&dg(_,ut,!0),_.child}function kj(rt){var _=rt.stateNode;_.pendingContext?ag$1(rt,_.pendingContext,_.pendingContext!==_.context):_.context&&ag$1(rt,_.context,!1),yh$1(rt,_.containerInfo)}function lj(rt,_,ut,mt,bt){return Ig$1(),Jg(bt),_.flags|=256,Xi$1(rt,_,ut,mt),_.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(rt){return{baseLanes:rt,cachePool:null,transitions:null}}function oj(rt,_,ut){var mt=_.pendingProps,bt=L$3.current,St=!1,Mt=(_.flags&128)!==0,Bt;if((Bt=Mt)||(Bt=rt!==null&&rt.memoizedState===null?!1:(bt&2)!==0),Bt?(St=!0,_.flags&=-129):(rt===null||rt.memoizedState!==null)&&(bt|=1),G$1(L$3,bt&1),rt===null)return Eg(_),rt=_.memoizedState,rt!==null&&(rt=rt.dehydrated,rt!==null)?(_.mode&1?rt.data==="$!"?_.lanes=8:_.lanes=1073741824:_.lanes=1,null):(Mt=mt.children,rt=mt.fallback,St?(mt=_.mode,St=_.child,Mt={mode:"hidden",children:Mt},!(mt&1)&&St!==null?(St.childLanes=0,St.pendingProps=Mt):St=pj(Mt,mt,0,null),rt=Tg$1(rt,mt,ut,null),St.return=_,rt.return=_,St.sibling=rt,_.child=St,_.child.memoizedState=nj(ut),_.memoizedState=mj,rt):qj(_,Mt));if(bt=rt.memoizedState,bt!==null&&(Bt=bt.dehydrated,Bt!==null))return rj(rt,_,Mt,mt,Bt,bt,ut);if(St){St=mt.fallback,Mt=_.mode,bt=rt.child,Bt=bt.sibling;var Ut={mode:"hidden",children:mt.children};return!(Mt&1)&&_.child!==bt?(mt=_.child,mt.childLanes=0,mt.pendingProps=Ut,_.deletions=null):(mt=Pg$1(bt,Ut),mt.subtreeFlags=bt.subtreeFlags&14680064),Bt!==null?St=Pg$1(Bt,St):(St=Tg$1(St,Mt,ut,null),St.flags|=2),St.return=_,mt.return=_,mt.sibling=St,_.child=mt,mt=St,St=_.child,Mt=rt.child.memoizedState,Mt=Mt===null?nj(ut):{baseLanes:Mt.baseLanes|ut,cachePool:null,transitions:Mt.transitions},St.memoizedState=Mt,St.childLanes=rt.childLanes&~ut,_.memoizedState=mj,mt}return St=rt.child,rt=St.sibling,mt=Pg$1(St,{mode:"visible",children:mt.children}),!(_.mode&1)&&(mt.lanes=ut),mt.return=_,mt.sibling=null,rt!==null&&(ut=_.deletions,ut===null?(_.deletions=[rt],_.flags|=16):ut.push(rt)),_.child=mt,_.memoizedState=null,mt}function qj(rt,_){return _=pj({mode:"visible",children:_},rt.mode,0,null),_.return=rt,rt.child=_}function sj(rt,_,ut,mt){return mt!==null&&Jg(mt),Ug(_,rt.child,null,ut),rt=qj(_,_.pendingProps.children),rt.flags|=2,_.memoizedState=null,rt}function rj(rt,_,ut,mt,bt,St,Mt){if(ut)return _.flags&256?(_.flags&=-257,mt=Ki$1(Error(p$4(422))),sj(rt,_,Mt,mt)):_.memoizedState!==null?(_.child=rt.child,_.flags|=128,null):(St=mt.fallback,bt=_.mode,mt=pj({mode:"visible",children:mt.children},bt,0,null),St=Tg$1(St,bt,Mt,null),St.flags|=2,mt.return=_,St.return=_,mt.sibling=St,_.child=mt,_.mode&1&&Ug(_,rt.child,null,Mt),_.child.memoizedState=nj(Mt),_.memoizedState=mj,St);if(!(_.mode&1))return sj(rt,_,Mt,null);if(bt.data==="$!"){if(mt=bt.nextSibling&&bt.nextSibling.dataset,mt)var Bt=mt.dgst;return mt=Bt,St=Error(p$4(419)),mt=Ki$1(St,mt,void 0),sj(rt,_,Mt,mt)}if(Bt=(Mt&rt.childLanes)!==0,dh$1||Bt){if(mt=Q$1,mt!==null){switch(Mt&-Mt){case 4:bt=2;break;case 16:bt=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:bt=32;break;case 536870912:bt=268435456;break;default:bt=0}bt=bt&(mt.suspendedLanes|Mt)?0:bt,bt!==0&&bt!==St.retryLane&&(St.retryLane=bt,ih$1(rt,bt),gi$1(mt,rt,bt,-1))}return tj(),mt=Ki$1(Error(p$4(421))),sj(rt,_,Mt,mt)}return bt.data==="$?"?(_.flags|=128,_.child=rt.child,_=uj.bind(null,rt),bt._reactRetry=_,null):(rt=St.treeContext,yg$1=Lf$1(bt.nextSibling),xg$1=_,I$3=!0,zg=null,rt!==null&&(og$1[pg$1++]=rg$1,og$1[pg$1++]=sg$1,og$1[pg$1++]=qg$1,rg$1=rt.id,sg$1=rt.overflow,qg$1=_),_=qj(_,mt.children),_.flags|=4096,_)}function vj(rt,_,ut){rt.lanes|=_;var mt=rt.alternate;mt!==null&&(mt.lanes|=_),bh$1(rt.return,_,ut)}function wj(rt,_,ut,mt,bt){var St=rt.memoizedState;St===null?rt.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:mt,tail:ut,tailMode:bt}:(St.isBackwards=_,St.rendering=null,St.renderingStartTime=0,St.last=mt,St.tail=ut,St.tailMode=bt)}function xj(rt,_,ut){var mt=_.pendingProps,bt=mt.revealOrder,St=mt.tail;if(Xi$1(rt,_,mt.children,ut),mt=L$3.current,mt&2)mt=mt&1|2,_.flags|=128;else{if(rt!==null&&rt.flags&128)e:for(rt=_.child;rt!==null;){if(rt.tag===13)rt.memoizedState!==null&&vj(rt,ut,_);else if(rt.tag===19)vj(rt,ut,_);else if(rt.child!==null){rt.child.return=rt,rt=rt.child;continue}if(rt===_)break e;for(;rt.sibling===null;){if(rt.return===null||rt.return===_)break e;rt=rt.return}rt.sibling.return=rt.return,rt=rt.sibling}mt&=1}if(G$1(L$3,mt),!(_.mode&1))_.memoizedState=null;else switch(bt){case"forwards":for(ut=_.child,bt=null;ut!==null;)rt=ut.alternate,rt!==null&&Ch$1(rt)===null&&(bt=ut),ut=ut.sibling;ut=bt,ut===null?(bt=_.child,_.child=null):(bt=ut.sibling,ut.sibling=null),wj(_,!1,bt,ut,St);break;case"backwards":for(ut=null,bt=_.child,_.child=null;bt!==null;){if(rt=bt.alternate,rt!==null&&Ch$1(rt)===null){_.child=bt;break}rt=bt.sibling,bt.sibling=ut,ut=bt,bt=rt}wj(_,!0,ut,null,St);break;case"together":wj(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function ij(rt,_){!(_.mode&1)&&rt!==null&&(rt.alternate=null,_.alternate=null,_.flags|=2)}function Zi$1(rt,_,ut){if(rt!==null&&(_.dependencies=rt.dependencies),rh$1|=_.lanes,!(ut&_.childLanes))return null;if(rt!==null&&_.child!==rt.child)throw Error(p$4(153));if(_.child!==null){for(rt=_.child,ut=Pg$1(rt,rt.pendingProps),_.child=ut,ut.return=_;rt.sibling!==null;)rt=rt.sibling,ut=ut.sibling=Pg$1(rt,rt.pendingProps),ut.return=_;ut.sibling=null}return _.child}function yj(rt,_,ut){switch(_.tag){case 3:kj(_),Ig$1();break;case 5:Ah$1(_);break;case 1:Zf$1(_.type)&&cg$1(_);break;case 4:yh$1(_,_.stateNode.containerInfo);break;case 10:var mt=_.type._context,bt=_.memoizedProps.value;G$1(Wg$1,mt._currentValue),mt._currentValue=bt;break;case 13:if(mt=_.memoizedState,mt!==null)return mt.dehydrated!==null?(G$1(L$3,L$3.current&1),_.flags|=128,null):ut&_.child.childLanes?oj(rt,_,ut):(G$1(L$3,L$3.current&1),rt=Zi$1(rt,_,ut),rt!==null?rt.sibling:null);G$1(L$3,L$3.current&1);break;case 19:if(mt=(ut&_.childLanes)!==0,rt.flags&128){if(mt)return xj(rt,_,ut);_.flags|=128}if(bt=_.memoizedState,bt!==null&&(bt.rendering=null,bt.tail=null,bt.lastEffect=null),G$1(L$3,L$3.current),mt)break;return null;case 22:case 23:return _.lanes=0,dj(rt,_,ut)}return Zi$1(rt,_,ut)}var zj,Aj,Bj,Cj;zj=function(rt,_){for(var ut=_.child;ut!==null;){if(ut.tag===5||ut.tag===6)rt.appendChild(ut.stateNode);else if(ut.tag!==4&&ut.child!==null){ut.child.return=ut,ut=ut.child;continue}if(ut===_)break;for(;ut.sibling===null;){if(ut.return===null||ut.return===_)return;ut=ut.return}ut.sibling.return=ut.return,ut=ut.sibling}};Aj=function(){};Bj=function(rt,_,ut,mt){var bt=rt.memoizedProps;if(bt!==mt){rt=_.stateNode,xh$1(uh$1.current);var St=null;switch(ut){case"input":bt=Ya$1(rt,bt),mt=Ya$1(rt,mt),St=[];break;case"select":bt=A$1({},bt,{value:void 0}),mt=A$1({},mt,{value:void 0}),St=[];break;case"textarea":bt=gb$1(rt,bt),mt=gb$1(rt,mt),St=[];break;default:typeof bt.onClick!="function"&&typeof mt.onClick=="function"&&(rt.onclick=Bf$1)}ub$1(ut,mt);var Mt;ut=null;for(Ht in bt)if(!mt.hasOwnProperty(Ht)&&bt.hasOwnProperty(Ht)&&bt[Ht]!=null)if(Ht==="style"){var Bt=bt[Ht];for(Mt in Bt)Bt.hasOwnProperty(Mt)&&(ut||(ut={}),ut[Mt]="")}else Ht!=="dangerouslySetInnerHTML"&&Ht!=="children"&&Ht!=="suppressContentEditableWarning"&&Ht!=="suppressHydrationWarning"&&Ht!=="autoFocus"&&(ea.hasOwnProperty(Ht)?St||(St=[]):(St=St||[]).push(Ht,null));for(Ht in mt){var Ut=mt[Ht];if(Bt=bt!=null?bt[Ht]:void 0,mt.hasOwnProperty(Ht)&&Ut!==Bt&&(Ut!=null||Bt!=null))if(Ht==="style")if(Bt){for(Mt in Bt)!Bt.hasOwnProperty(Mt)||Ut&&Ut.hasOwnProperty(Mt)||(ut||(ut={}),ut[Mt]="");for(Mt in Ut)Ut.hasOwnProperty(Mt)&&Bt[Mt]!==Ut[Mt]&&(ut||(ut={}),ut[Mt]=Ut[Mt])}else ut||(St||(St=[]),St.push(Ht,ut)),ut=Ut;else Ht==="dangerouslySetInnerHTML"?(Ut=Ut?Ut.__html:void 0,Bt=Bt?Bt.__html:void 0,Ut!=null&&Bt!==Ut&&(St=St||[]).push(Ht,Ut)):Ht==="children"?typeof Ut!="string"&&typeof Ut!="number"||(St=St||[]).push(Ht,""+Ut):Ht!=="suppressContentEditableWarning"&&Ht!=="suppressHydrationWarning"&&(ea.hasOwnProperty(Ht)?(Ut!=null&&Ht==="onScroll"&&D$1("scroll",rt),St||Bt===Ut||(St=[])):(St=St||[]).push(Ht,Ut))}ut&&(St=St||[]).push("style",ut);var Ht=St;(_.updateQueue=Ht)&&(_.flags|=4)}};Cj=function(rt,_,ut,mt){ut!==mt&&(_.flags|=4)};function Dj(rt,_){if(!I$3)switch(rt.tailMode){case"hidden":_=rt.tail;for(var ut=null;_!==null;)_.alternate!==null&&(ut=_),_=_.sibling;ut===null?rt.tail=null:ut.sibling=null;break;case"collapsed":ut=rt.tail;for(var mt=null;ut!==null;)ut.alternate!==null&&(mt=ut),ut=ut.sibling;mt===null?_||rt.tail===null?rt.tail=null:rt.tail.sibling=null:mt.sibling=null}}function S$3(rt){var _=rt.alternate!==null&&rt.alternate.child===rt.child,ut=0,mt=0;if(_)for(var bt=rt.child;bt!==null;)ut|=bt.lanes|bt.childLanes,mt|=bt.subtreeFlags&14680064,mt|=bt.flags&14680064,bt.return=rt,bt=bt.sibling;else for(bt=rt.child;bt!==null;)ut|=bt.lanes|bt.childLanes,mt|=bt.subtreeFlags,mt|=bt.flags,bt.return=rt,bt=bt.sibling;return rt.subtreeFlags|=mt,rt.childLanes=ut,_}function Ej(rt,_,ut){var mt=_.pendingProps;switch(wg$1(_),_.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$3(_),null;case 1:return Zf$1(_.type)&&$f$1(),S$3(_),null;case 3:return mt=_.stateNode,zh$1(),E$2(Wf$1),E$2(H$2),Eh$1(),mt.pendingContext&&(mt.context=mt.pendingContext,mt.pendingContext=null),(rt===null||rt.child===null)&&(Gg(_)?_.flags|=4:rt===null||rt.memoizedState.isDehydrated&&!(_.flags&256)||(_.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(rt,_),S$3(_),null;case 5:Bh$1(_);var bt=xh$1(wh$1.current);if(ut=_.type,rt!==null&&_.stateNode!=null)Bj(rt,_,ut,mt,bt),rt.ref!==_.ref&&(_.flags|=512,_.flags|=2097152);else{if(!mt){if(_.stateNode===null)throw Error(p$4(166));return S$3(_),null}if(rt=xh$1(uh$1.current),Gg(_)){mt=_.stateNode,ut=_.type;var St=_.memoizedProps;switch(mt[Of$1]=_,mt[Pf$1]=St,rt=(_.mode&1)!==0,ut){case"dialog":D$1("cancel",mt),D$1("close",mt);break;case"iframe":case"object":case"embed":D$1("load",mt);break;case"video":case"audio":for(bt=0;bt<lf$1.length;bt++)D$1(lf$1[bt],mt);break;case"source":D$1("error",mt);break;case"img":case"image":case"link":D$1("error",mt),D$1("load",mt);break;case"details":D$1("toggle",mt);break;case"input":Za$1(mt,St),D$1("invalid",mt);break;case"select":mt._wrapperState={wasMultiple:!!St.multiple},D$1("invalid",mt);break;case"textarea":hb$1(mt,St),D$1("invalid",mt)}ub$1(ut,St),bt=null;for(var Mt in St)if(St.hasOwnProperty(Mt)){var Bt=St[Mt];Mt==="children"?typeof Bt=="string"?mt.textContent!==Bt&&(St.suppressHydrationWarning!==!0&&Af$1(mt.textContent,Bt,rt),bt=["children",Bt]):typeof Bt=="number"&&mt.textContent!==""+Bt&&(St.suppressHydrationWarning!==!0&&Af$1(mt.textContent,Bt,rt),bt=["children",""+Bt]):ea.hasOwnProperty(Mt)&&Bt!=null&&Mt==="onScroll"&&D$1("scroll",mt)}switch(ut){case"input":Va$1(mt),db$1(mt,St,!0);break;case"textarea":Va$1(mt),jb$1(mt);break;case"select":case"option":break;default:typeof St.onClick=="function"&&(mt.onclick=Bf$1)}mt=bt,_.updateQueue=mt,mt!==null&&(_.flags|=4)}else{Mt=bt.nodeType===9?bt:bt.ownerDocument,rt==="http://www.w3.org/1999/xhtml"&&(rt=kb$1(ut)),rt==="http://www.w3.org/1999/xhtml"?ut==="script"?(rt=Mt.createElement("div"),rt.innerHTML="<script><\/script>",rt=rt.removeChild(rt.firstChild)):typeof mt.is=="string"?rt=Mt.createElement(ut,{is:mt.is}):(rt=Mt.createElement(ut),ut==="select"&&(Mt=rt,mt.multiple?Mt.multiple=!0:mt.size&&(Mt.size=mt.size))):rt=Mt.createElementNS(rt,ut),rt[Of$1]=_,rt[Pf$1]=mt,zj(rt,_,!1,!1),_.stateNode=rt;e:{switch(Mt=vb$1(ut,mt),ut){case"dialog":D$1("cancel",rt),D$1("close",rt),bt=mt;break;case"iframe":case"object":case"embed":D$1("load",rt),bt=mt;break;case"video":case"audio":for(bt=0;bt<lf$1.length;bt++)D$1(lf$1[bt],rt);bt=mt;break;case"source":D$1("error",rt),bt=mt;break;case"img":case"image":case"link":D$1("error",rt),D$1("load",rt),bt=mt;break;case"details":D$1("toggle",rt),bt=mt;break;case"input":Za$1(rt,mt),bt=Ya$1(rt,mt),D$1("invalid",rt);break;case"option":bt=mt;break;case"select":rt._wrapperState={wasMultiple:!!mt.multiple},bt=A$1({},mt,{value:void 0}),D$1("invalid",rt);break;case"textarea":hb$1(rt,mt),bt=gb$1(rt,mt),D$1("invalid",rt);break;default:bt=mt}ub$1(ut,bt),Bt=bt;for(St in Bt)if(Bt.hasOwnProperty(St)){var Ut=Bt[St];St==="style"?sb$1(rt,Ut):St==="dangerouslySetInnerHTML"?(Ut=Ut?Ut.__html:void 0,Ut!=null&&nb$1(rt,Ut)):St==="children"?typeof Ut=="string"?(ut!=="textarea"||Ut!=="")&&ob$1(rt,Ut):typeof Ut=="number"&&ob$1(rt,""+Ut):St!=="suppressContentEditableWarning"&&St!=="suppressHydrationWarning"&&St!=="autoFocus"&&(ea.hasOwnProperty(St)?Ut!=null&&St==="onScroll"&&D$1("scroll",rt):Ut!=null&&ta$1(rt,St,Ut,Mt))}switch(ut){case"input":Va$1(rt),db$1(rt,mt,!1);break;case"textarea":Va$1(rt),jb$1(rt);break;case"option":mt.value!=null&&rt.setAttribute("value",""+Sa$1(mt.value));break;case"select":rt.multiple=!!mt.multiple,St=mt.value,St!=null?fb$1(rt,!!mt.multiple,St,!1):mt.defaultValue!=null&&fb$1(rt,!!mt.multiple,mt.defaultValue,!0);break;default:typeof bt.onClick=="function"&&(rt.onclick=Bf$1)}switch(ut){case"button":case"input":case"select":case"textarea":mt=!!mt.autoFocus;break e;case"img":mt=!0;break e;default:mt=!1}}mt&&(_.flags|=4)}_.ref!==null&&(_.flags|=512,_.flags|=2097152)}return S$3(_),null;case 6:if(rt&&_.stateNode!=null)Cj(rt,_,rt.memoizedProps,mt);else{if(typeof mt!="string"&&_.stateNode===null)throw Error(p$4(166));if(ut=xh$1(wh$1.current),xh$1(uh$1.current),Gg(_)){if(mt=_.stateNode,ut=_.memoizedProps,mt[Of$1]=_,(St=mt.nodeValue!==ut)&&(rt=xg$1,rt!==null))switch(rt.tag){case 3:Af$1(mt.nodeValue,ut,(rt.mode&1)!==0);break;case 5:rt.memoizedProps.suppressHydrationWarning!==!0&&Af$1(mt.nodeValue,ut,(rt.mode&1)!==0)}St&&(_.flags|=4)}else mt=(ut.nodeType===9?ut:ut.ownerDocument).createTextNode(mt),mt[Of$1]=_,_.stateNode=mt}return S$3(_),null;case 13:if(E$2(L$3),mt=_.memoizedState,rt===null||rt.memoizedState!==null&&rt.memoizedState.dehydrated!==null){if(I$3&&yg$1!==null&&_.mode&1&&!(_.flags&128))Hg$1(),Ig$1(),_.flags|=98560,St=!1;else if(St=Gg(_),mt!==null&&mt.dehydrated!==null){if(rt===null){if(!St)throw Error(p$4(318));if(St=_.memoizedState,St=St!==null?St.dehydrated:null,!St)throw Error(p$4(317));St[Of$1]=_}else Ig$1(),!(_.flags&128)&&(_.memoizedState=null),_.flags|=4;S$3(_),St=!1}else zg!==null&&(Fj(zg),zg=null),St=!0;if(!St)return _.flags&65536?_:null}return _.flags&128?(_.lanes=ut,_):(mt=mt!==null,mt!==(rt!==null&&rt.memoizedState!==null)&&mt&&(_.child.flags|=8192,_.mode&1&&(rt===null||L$3.current&1?T$2===0&&(T$2=3):tj())),_.updateQueue!==null&&(_.flags|=4),S$3(_),null);case 4:return zh$1(),Aj(rt,_),rt===null&&sf$1(_.stateNode.containerInfo),S$3(_),null;case 10:return ah$1(_.type._context),S$3(_),null;case 17:return Zf$1(_.type)&&$f$1(),S$3(_),null;case 19:if(E$2(L$3),St=_.memoizedState,St===null)return S$3(_),null;if(mt=(_.flags&128)!==0,Mt=St.rendering,Mt===null)if(mt)Dj(St,!1);else{if(T$2!==0||rt!==null&&rt.flags&128)for(rt=_.child;rt!==null;){if(Mt=Ch$1(rt),Mt!==null){for(_.flags|=128,Dj(St,!1),mt=Mt.updateQueue,mt!==null&&(_.updateQueue=mt,_.flags|=4),_.subtreeFlags=0,mt=ut,ut=_.child;ut!==null;)St=ut,rt=mt,St.flags&=14680066,Mt=St.alternate,Mt===null?(St.childLanes=0,St.lanes=rt,St.child=null,St.subtreeFlags=0,St.memoizedProps=null,St.memoizedState=null,St.updateQueue=null,St.dependencies=null,St.stateNode=null):(St.childLanes=Mt.childLanes,St.lanes=Mt.lanes,St.child=Mt.child,St.subtreeFlags=0,St.deletions=null,St.memoizedProps=Mt.memoizedProps,St.memoizedState=Mt.memoizedState,St.updateQueue=Mt.updateQueue,St.type=Mt.type,rt=Mt.dependencies,St.dependencies=rt===null?null:{lanes:rt.lanes,firstContext:rt.firstContext}),ut=ut.sibling;return G$1(L$3,L$3.current&1|2),_.child}rt=rt.sibling}St.tail!==null&&B$1()>Gj&&(_.flags|=128,mt=!0,Dj(St,!1),_.lanes=4194304)}else{if(!mt)if(rt=Ch$1(Mt),rt!==null){if(_.flags|=128,mt=!0,ut=rt.updateQueue,ut!==null&&(_.updateQueue=ut,_.flags|=4),Dj(St,!0),St.tail===null&&St.tailMode==="hidden"&&!Mt.alternate&&!I$3)return S$3(_),null}else 2*B$1()-St.renderingStartTime>Gj&&ut!==1073741824&&(_.flags|=128,mt=!0,Dj(St,!1),_.lanes=4194304);St.isBackwards?(Mt.sibling=_.child,_.child=Mt):(ut=St.last,ut!==null?ut.sibling=Mt:_.child=Mt,St.last=Mt)}return St.tail!==null?(_=St.tail,St.rendering=_,St.tail=_.sibling,St.renderingStartTime=B$1(),_.sibling=null,ut=L$3.current,G$1(L$3,mt?ut&1|2:ut&1),_):(S$3(_),null);case 22:case 23:return Hj(),mt=_.memoizedState!==null,rt!==null&&rt.memoizedState!==null!==mt&&(_.flags|=8192),mt&&_.mode&1?fj&1073741824&&(S$3(_),_.subtreeFlags&6&&(_.flags|=8192)):S$3(_),null;case 24:return null;case 25:return null}throw Error(p$4(156,_.tag))}function Ij(rt,_){switch(wg$1(_),_.tag){case 1:return Zf$1(_.type)&&$f$1(),rt=_.flags,rt&65536?(_.flags=rt&-65537|128,_):null;case 3:return zh$1(),E$2(Wf$1),E$2(H$2),Eh$1(),rt=_.flags,rt&65536&&!(rt&128)?(_.flags=rt&-65537|128,_):null;case 5:return Bh$1(_),null;case 13:if(E$2(L$3),rt=_.memoizedState,rt!==null&&rt.dehydrated!==null){if(_.alternate===null)throw Error(p$4(340));Ig$1()}return rt=_.flags,rt&65536?(_.flags=rt&-65537|128,_):null;case 19:return E$2(L$3),null;case 4:return zh$1(),null;case 10:return ah$1(_.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U$2=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V$3=null;function Lj(rt,_){var ut=rt.ref;if(ut!==null)if(typeof ut=="function")try{ut(null)}catch(mt){W$1(rt,_,mt)}else ut.current=null}function Mj(rt,_,ut){try{ut()}catch(mt){W$1(rt,_,mt)}}var Nj=!1;function Oj(rt,_){if(Cf$1=dd,rt=Me$1(),Ne$2(rt)){if("selectionStart"in rt)var ut={start:rt.selectionStart,end:rt.selectionEnd};else e:{ut=(ut=rt.ownerDocument)&&ut.defaultView||window;var mt=ut.getSelection&&ut.getSelection();if(mt&&mt.rangeCount!==0){ut=mt.anchorNode;var bt=mt.anchorOffset,St=mt.focusNode;mt=mt.focusOffset;try{ut.nodeType,St.nodeType}catch{ut=null;break e}var Mt=0,Bt=-1,Ut=-1,Ht=0,tr=0,rr=rt,sr=null;t:for(;;){for(var ar;rr!==ut||bt!==0&&rr.nodeType!==3||(Bt=Mt+bt),rr!==St||mt!==0&&rr.nodeType!==3||(Ut=Mt+mt),rr.nodeType===3&&(Mt+=rr.nodeValue.length),(ar=rr.firstChild)!==null;)sr=rr,rr=ar;for(;;){if(rr===rt)break t;if(sr===ut&&++Ht===bt&&(Bt=Mt),sr===St&&++tr===mt&&(Ut=Mt),(ar=rr.nextSibling)!==null)break;rr=sr,sr=rr.parentNode}rr=ar}ut=Bt===-1||Ut===-1?null:{start:Bt,end:Ut}}else ut=null}ut=ut||{start:0,end:0}}else ut=null;for(Df$1={focusedElem:rt,selectionRange:ut},dd=!1,V$3=_;V$3!==null;)if(_=V$3,rt=_.child,(_.subtreeFlags&1028)!==0&&rt!==null)rt.return=_,V$3=rt;else for(;V$3!==null;){_=V$3;try{var cr=_.alternate;if(_.flags&1024)switch(_.tag){case 0:case 11:case 15:break;case 1:if(cr!==null){var Ar=cr.memoizedProps,_r=cr.memoizedState,Dr=_.stateNode,$r=Dr.getSnapshotBeforeUpdate(_.elementType===_.type?Ar:Ci$1(_.type,Ar),_r);Dr.__reactInternalSnapshotBeforeUpdate=$r}break;case 3:var Br=_.stateNode.containerInfo;Br.nodeType===1?Br.textContent="":Br.nodeType===9&&Br.documentElement&&Br.removeChild(Br.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$4(163))}}catch(Jr){W$1(_,_.return,Jr)}if(rt=_.sibling,rt!==null){rt.return=_.return,V$3=rt;break}V$3=_.return}return cr=Nj,Nj=!1,cr}function Pj(rt,_,ut){var mt=_.updateQueue;if(mt=mt!==null?mt.lastEffect:null,mt!==null){var bt=mt=mt.next;do{if((bt.tag&rt)===rt){var St=bt.destroy;bt.destroy=void 0,St!==void 0&&Mj(_,ut,St)}bt=bt.next}while(bt!==mt)}}function Qj(rt,_){if(_=_.updateQueue,_=_!==null?_.lastEffect:null,_!==null){var ut=_=_.next;do{if((ut.tag&rt)===rt){var mt=ut.create;ut.destroy=mt()}ut=ut.next}while(ut!==_)}}function Rj(rt){var _=rt.ref;if(_!==null){var ut=rt.stateNode;switch(rt.tag){case 5:rt=ut;break;default:rt=ut}typeof _=="function"?_(rt):_.current=rt}}function Sj(rt){var _=rt.alternate;_!==null&&(rt.alternate=null,Sj(_)),rt.child=null,rt.deletions=null,rt.sibling=null,rt.tag===5&&(_=rt.stateNode,_!==null&&(delete _[Of$1],delete _[Pf$1],delete _[of$1],delete _[Qf$1],delete _[Rf$1])),rt.stateNode=null,rt.return=null,rt.dependencies=null,rt.memoizedProps=null,rt.memoizedState=null,rt.pendingProps=null,rt.stateNode=null,rt.updateQueue=null}function Tj(rt){return rt.tag===5||rt.tag===3||rt.tag===4}function Uj(rt){e:for(;;){for(;rt.sibling===null;){if(rt.return===null||Tj(rt.return))return null;rt=rt.return}for(rt.sibling.return=rt.return,rt=rt.sibling;rt.tag!==5&&rt.tag!==6&&rt.tag!==18;){if(rt.flags&2||rt.child===null||rt.tag===4)continue e;rt.child.return=rt,rt=rt.child}if(!(rt.flags&2))return rt.stateNode}}function Vj(rt,_,ut){var mt=rt.tag;if(mt===5||mt===6)rt=rt.stateNode,_?ut.nodeType===8?ut.parentNode.insertBefore(rt,_):ut.insertBefore(rt,_):(ut.nodeType===8?(_=ut.parentNode,_.insertBefore(rt,ut)):(_=ut,_.appendChild(rt)),ut=ut._reactRootContainer,ut!=null||_.onclick!==null||(_.onclick=Bf$1));else if(mt!==4&&(rt=rt.child,rt!==null))for(Vj(rt,_,ut),rt=rt.sibling;rt!==null;)Vj(rt,_,ut),rt=rt.sibling}function Wj(rt,_,ut){var mt=rt.tag;if(mt===5||mt===6)rt=rt.stateNode,_?ut.insertBefore(rt,_):ut.appendChild(rt);else if(mt!==4&&(rt=rt.child,rt!==null))for(Wj(rt,_,ut),rt=rt.sibling;rt!==null;)Wj(rt,_,ut),rt=rt.sibling}var X=null,Xj=!1;function Yj(rt,_,ut){for(ut=ut.child;ut!==null;)Zj(rt,_,ut),ut=ut.sibling}function Zj(rt,_,ut){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc$1,ut)}catch{}switch(ut.tag){case 5:U$2||Lj(ut,_);case 6:var mt=X,bt=Xj;X=null,Yj(rt,_,ut),X=mt,Xj=bt,X!==null&&(Xj?(rt=X,ut=ut.stateNode,rt.nodeType===8?rt.parentNode.removeChild(ut):rt.removeChild(ut)):X.removeChild(ut.stateNode));break;case 18:X!==null&&(Xj?(rt=X,ut=ut.stateNode,rt.nodeType===8?Kf$1(rt.parentNode,ut):rt.nodeType===1&&Kf$1(rt,ut),bd(rt)):Kf$1(X,ut.stateNode));break;case 4:mt=X,bt=Xj,X=ut.stateNode.containerInfo,Xj=!0,Yj(rt,_,ut),X=mt,Xj=bt;break;case 0:case 11:case 14:case 15:if(!U$2&&(mt=ut.updateQueue,mt!==null&&(mt=mt.lastEffect,mt!==null))){bt=mt=mt.next;do{var St=bt,Mt=St.destroy;St=St.tag,Mt!==void 0&&(St&2||St&4)&&Mj(ut,_,Mt),bt=bt.next}while(bt!==mt)}Yj(rt,_,ut);break;case 1:if(!U$2&&(Lj(ut,_),mt=ut.stateNode,typeof mt.componentWillUnmount=="function"))try{mt.props=ut.memoizedProps,mt.state=ut.memoizedState,mt.componentWillUnmount()}catch(Bt){W$1(ut,_,Bt)}Yj(rt,_,ut);break;case 21:Yj(rt,_,ut);break;case 22:ut.mode&1?(U$2=(mt=U$2)||ut.memoizedState!==null,Yj(rt,_,ut),U$2=mt):Yj(rt,_,ut);break;default:Yj(rt,_,ut)}}function ak(rt){var _=rt.updateQueue;if(_!==null){rt.updateQueue=null;var ut=rt.stateNode;ut===null&&(ut=rt.stateNode=new Kj),_.forEach(function(mt){var bt=bk.bind(null,rt,mt);ut.has(mt)||(ut.add(mt),mt.then(bt,bt))})}}function ck(rt,_){var ut=_.deletions;if(ut!==null)for(var mt=0;mt<ut.length;mt++){var bt=ut[mt];try{var St=rt,Mt=_,Bt=Mt;e:for(;Bt!==null;){switch(Bt.tag){case 5:X=Bt.stateNode,Xj=!1;break e;case 3:X=Bt.stateNode.containerInfo,Xj=!0;break e;case 4:X=Bt.stateNode.containerInfo,Xj=!0;break e}Bt=Bt.return}if(X===null)throw Error(p$4(160));Zj(St,Mt,bt),X=null,Xj=!1;var Ut=bt.alternate;Ut!==null&&(Ut.return=null),bt.return=null}catch(Ht){W$1(bt,_,Ht)}}if(_.subtreeFlags&12854)for(_=_.child;_!==null;)dk(_,rt),_=_.sibling}function dk(rt,_){var ut=rt.alternate,mt=rt.flags;switch(rt.tag){case 0:case 11:case 14:case 15:if(ck(_,rt),ek(rt),mt&4){try{Pj(3,rt,rt.return),Qj(3,rt)}catch(Ar){W$1(rt,rt.return,Ar)}try{Pj(5,rt,rt.return)}catch(Ar){W$1(rt,rt.return,Ar)}}break;case 1:ck(_,rt),ek(rt),mt&512&&ut!==null&&Lj(ut,ut.return);break;case 5:if(ck(_,rt),ek(rt),mt&512&&ut!==null&&Lj(ut,ut.return),rt.flags&32){var bt=rt.stateNode;try{ob$1(bt,"")}catch(Ar){W$1(rt,rt.return,Ar)}}if(mt&4&&(bt=rt.stateNode,bt!=null)){var St=rt.memoizedProps,Mt=ut!==null?ut.memoizedProps:St,Bt=rt.type,Ut=rt.updateQueue;if(rt.updateQueue=null,Ut!==null)try{Bt==="input"&&St.type==="radio"&&St.name!=null&&ab$1(bt,St),vb$1(Bt,Mt);var Ht=vb$1(Bt,St);for(Mt=0;Mt<Ut.length;Mt+=2){var tr=Ut[Mt],rr=Ut[Mt+1];tr==="style"?sb$1(bt,rr):tr==="dangerouslySetInnerHTML"?nb$1(bt,rr):tr==="children"?ob$1(bt,rr):ta$1(bt,tr,rr,Ht)}switch(Bt){case"input":bb$1(bt,St);break;case"textarea":ib$1(bt,St);break;case"select":var sr=bt._wrapperState.wasMultiple;bt._wrapperState.wasMultiple=!!St.multiple;var ar=St.value;ar!=null?fb$1(bt,!!St.multiple,ar,!1):sr!==!!St.multiple&&(St.defaultValue!=null?fb$1(bt,!!St.multiple,St.defaultValue,!0):fb$1(bt,!!St.multiple,St.multiple?[]:"",!1))}bt[Pf$1]=St}catch(Ar){W$1(rt,rt.return,Ar)}}break;case 6:if(ck(_,rt),ek(rt),mt&4){if(rt.stateNode===null)throw Error(p$4(162));bt=rt.stateNode,St=rt.memoizedProps;try{bt.nodeValue=St}catch(Ar){W$1(rt,rt.return,Ar)}}break;case 3:if(ck(_,rt),ek(rt),mt&4&&ut!==null&&ut.memoizedState.isDehydrated)try{bd(_.containerInfo)}catch(Ar){W$1(rt,rt.return,Ar)}break;case 4:ck(_,rt),ek(rt);break;case 13:ck(_,rt),ek(rt),bt=rt.child,bt.flags&8192&&(St=bt.memoizedState!==null,bt.stateNode.isHidden=St,!St||bt.alternate!==null&&bt.alternate.memoizedState!==null||(fk=B$1())),mt&4&&ak(rt);break;case 22:if(tr=ut!==null&&ut.memoizedState!==null,rt.mode&1?(U$2=(Ht=U$2)||tr,ck(_,rt),U$2=Ht):ck(_,rt),ek(rt),mt&8192){if(Ht=rt.memoizedState!==null,(rt.stateNode.isHidden=Ht)&&!tr&&rt.mode&1)for(V$3=rt,tr=rt.child;tr!==null;){for(rr=V$3=tr;V$3!==null;){switch(sr=V$3,ar=sr.child,sr.tag){case 0:case 11:case 14:case 15:Pj(4,sr,sr.return);break;case 1:Lj(sr,sr.return);var cr=sr.stateNode;if(typeof cr.componentWillUnmount=="function"){mt=sr,ut=sr.return;try{_=mt,cr.props=_.memoizedProps,cr.state=_.memoizedState,cr.componentWillUnmount()}catch(Ar){W$1(mt,ut,Ar)}}break;case 5:Lj(sr,sr.return);break;case 22:if(sr.memoizedState!==null){gk(rr);continue}}ar!==null?(ar.return=sr,V$3=ar):gk(rr)}tr=tr.sibling}e:for(tr=null,rr=rt;;){if(rr.tag===5){if(tr===null){tr=rr;try{bt=rr.stateNode,Ht?(St=bt.style,typeof St.setProperty=="function"?St.setProperty("display","none","important"):St.display="none"):(Bt=rr.stateNode,Ut=rr.memoizedProps.style,Mt=Ut!=null&&Ut.hasOwnProperty("display")?Ut.display:null,Bt.style.display=rb$1("display",Mt))}catch(Ar){W$1(rt,rt.return,Ar)}}}else if(rr.tag===6){if(tr===null)try{rr.stateNode.nodeValue=Ht?"":rr.memoizedProps}catch(Ar){W$1(rt,rt.return,Ar)}}else if((rr.tag!==22&&rr.tag!==23||rr.memoizedState===null||rr===rt)&&rr.child!==null){rr.child.return=rr,rr=rr.child;continue}if(rr===rt)break e;for(;rr.sibling===null;){if(rr.return===null||rr.return===rt)break e;tr===rr&&(tr=null),rr=rr.return}tr===rr&&(tr=null),rr.sibling.return=rr.return,rr=rr.sibling}}break;case 19:ck(_,rt),ek(rt),mt&4&&ak(rt);break;case 21:break;default:ck(_,rt),ek(rt)}}function ek(rt){var _=rt.flags;if(_&2){try{e:{for(var ut=rt.return;ut!==null;){if(Tj(ut)){var mt=ut;break e}ut=ut.return}throw Error(p$4(160))}switch(mt.tag){case 5:var bt=mt.stateNode;mt.flags&32&&(ob$1(bt,""),mt.flags&=-33);var St=Uj(rt);Wj(rt,St,bt);break;case 3:case 4:var Mt=mt.stateNode.containerInfo,Bt=Uj(rt);Vj(rt,Bt,Mt);break;default:throw Error(p$4(161))}}catch(Ut){W$1(rt,rt.return,Ut)}rt.flags&=-3}_&4096&&(rt.flags&=-4097)}function hk(rt,_,ut){V$3=rt,ik(rt)}function ik(rt,_,ut){for(var mt=(rt.mode&1)!==0;V$3!==null;){var bt=V$3,St=bt.child;if(bt.tag===22&&mt){var Mt=bt.memoizedState!==null||Jj;if(!Mt){var Bt=bt.alternate,Ut=Bt!==null&&Bt.memoizedState!==null||U$2;Bt=Jj;var Ht=U$2;if(Jj=Mt,(U$2=Ut)&&!Ht)for(V$3=bt;V$3!==null;)Mt=V$3,Ut=Mt.child,Mt.tag===22&&Mt.memoizedState!==null?jk(bt):Ut!==null?(Ut.return=Mt,V$3=Ut):jk(bt);for(;St!==null;)V$3=St,ik(St),St=St.sibling;V$3=bt,Jj=Bt,U$2=Ht}kk(rt)}else bt.subtreeFlags&8772&&St!==null?(St.return=bt,V$3=St):kk(rt)}}function kk(rt){for(;V$3!==null;){var _=V$3;if(_.flags&8772){var ut=_.alternate;try{if(_.flags&8772)switch(_.tag){case 0:case 11:case 15:U$2||Qj(5,_);break;case 1:var mt=_.stateNode;if(_.flags&4&&!U$2)if(ut===null)mt.componentDidMount();else{var bt=_.elementType===_.type?ut.memoizedProps:Ci$1(_.type,ut.memoizedProps);mt.componentDidUpdate(bt,ut.memoizedState,mt.__reactInternalSnapshotBeforeUpdate)}var St=_.updateQueue;St!==null&&sh$1(_,St,mt);break;case 3:var Mt=_.updateQueue;if(Mt!==null){if(ut=null,_.child!==null)switch(_.child.tag){case 5:ut=_.child.stateNode;break;case 1:ut=_.child.stateNode}sh$1(_,Mt,ut)}break;case 5:var Bt=_.stateNode;if(ut===null&&_.flags&4){ut=Bt;var Ut=_.memoizedProps;switch(_.type){case"button":case"input":case"select":case"textarea":Ut.autoFocus&&ut.focus();break;case"img":Ut.src&&(ut.src=Ut.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(_.memoizedState===null){var Ht=_.alternate;if(Ht!==null){var tr=Ht.memoizedState;if(tr!==null){var rr=tr.dehydrated;rr!==null&&bd(rr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$4(163))}U$2||_.flags&512&&Rj(_)}catch(sr){W$1(_,_.return,sr)}}if(_===rt){V$3=null;break}if(ut=_.sibling,ut!==null){ut.return=_.return,V$3=ut;break}V$3=_.return}}function gk(rt){for(;V$3!==null;){var _=V$3;if(_===rt){V$3=null;break}var ut=_.sibling;if(ut!==null){ut.return=_.return,V$3=ut;break}V$3=_.return}}function jk(rt){for(;V$3!==null;){var _=V$3;try{switch(_.tag){case 0:case 11:case 15:var ut=_.return;try{Qj(4,_)}catch(Ut){W$1(_,ut,Ut)}break;case 1:var mt=_.stateNode;if(typeof mt.componentDidMount=="function"){var bt=_.return;try{mt.componentDidMount()}catch(Ut){W$1(_,bt,Ut)}}var St=_.return;try{Rj(_)}catch(Ut){W$1(_,St,Ut)}break;case 5:var Mt=_.return;try{Rj(_)}catch(Ut){W$1(_,Mt,Ut)}}}catch(Ut){W$1(_,_.return,Ut)}if(_===rt){V$3=null;break}var Bt=_.sibling;if(Bt!==null){Bt.return=_.return,V$3=Bt;break}V$3=_.return}}var lk=Math.ceil,mk=ua$1.ReactCurrentDispatcher,nk=ua$1.ReactCurrentOwner,ok=ua$1.ReactCurrentBatchConfig,K$1=0,Q$1=null,Y$2=null,Z=0,fj=0,ej=Uf$1(0),T$2=0,pk=null,rh$1=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi$1=!1,Pi$1=null,Ri$1=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K$1&6?B$1():Ak!==-1?Ak:Ak=B$1()}function yi$1(rt){return rt.mode&1?K$1&2&&Z!==0?Z&-Z:Kg$1.transition!==null?(Bk===0&&(Bk=yc()),Bk):(rt=C$1,rt!==0||(rt=window.event,rt=rt===void 0?16:jd$1(rt.type)),rt):1}function gi$1(rt,_,ut,mt){if(50<yk)throw yk=0,zk=null,Error(p$4(185));Ac$1(rt,ut,mt),(!(K$1&2)||rt!==Q$1)&&(rt===Q$1&&(!(K$1&2)&&(qk|=ut),T$2===4&&Ck(rt,Z)),Dk(rt,mt),ut===1&&K$1===0&&!(_.mode&1)&&(Gj=B$1()+500,fg$1&&jg$1()))}function Dk(rt,_){var ut=rt.callbackNode;wc$1(rt,_);var mt=uc$1(rt,rt===Q$1?Z:0);if(mt===0)ut!==null&&bc$1(ut),rt.callbackNode=null,rt.callbackPriority=0;else if(_=mt&-mt,rt.callbackPriority!==_){if(ut!=null&&bc$1(ut),_===1)rt.tag===0?ig$1(Ek.bind(null,rt)):hg$1(Ek.bind(null,rt)),Jf$1(function(){!(K$1&6)&&jg$1()}),ut=null;else{switch(Dc$1(mt)){case 1:ut=fc$1;break;case 4:ut=gc$1;break;case 16:ut=hc;break;case 536870912:ut=jc;break;default:ut=hc}ut=Fk(ut,Gk.bind(null,rt))}rt.callbackPriority=_,rt.callbackNode=ut}}function Gk(rt,_){if(Ak=-1,Bk=0,K$1&6)throw Error(p$4(327));var ut=rt.callbackNode;if(Hk()&&rt.callbackNode!==ut)return null;var mt=uc$1(rt,rt===Q$1?Z:0);if(mt===0)return null;if(mt&30||mt&rt.expiredLanes||_)_=Ik(rt,mt);else{_=mt;var bt=K$1;K$1|=2;var St=Jk();(Q$1!==rt||Z!==_)&&(uk=null,Gj=B$1()+500,Kk(rt,_));do try{Lk();break}catch(Bt){Mk(rt,Bt)}while(!0);$g$1(),mk.current=St,K$1=bt,Y$2!==null?_=0:(Q$1=null,Z=0,_=T$2)}if(_!==0){if(_===2&&(bt=xc$1(rt),bt!==0&&(mt=bt,_=Nk(rt,bt))),_===1)throw ut=pk,Kk(rt,0),Ck(rt,mt),Dk(rt,B$1()),ut;if(_===6)Ck(rt,mt);else{if(bt=rt.current.alternate,!(mt&30)&&!Ok(bt)&&(_=Ik(rt,mt),_===2&&(St=xc$1(rt),St!==0&&(mt=St,_=Nk(rt,St))),_===1))throw ut=pk,Kk(rt,0),Ck(rt,mt),Dk(rt,B$1()),ut;switch(rt.finishedWork=bt,rt.finishedLanes=mt,_){case 0:case 1:throw Error(p$4(345));case 2:Pk(rt,tk,uk);break;case 3:if(Ck(rt,mt),(mt&130023424)===mt&&(_=fk+500-B$1(),10<_)){if(uc$1(rt,0)!==0)break;if(bt=rt.suspendedLanes,(bt&mt)!==mt){R$1(),rt.pingedLanes|=rt.suspendedLanes&bt;break}rt.timeoutHandle=Ff$1(Pk.bind(null,rt,tk,uk),_);break}Pk(rt,tk,uk);break;case 4:if(Ck(rt,mt),(mt&4194240)===mt)break;for(_=rt.eventTimes,bt=-1;0<mt;){var Mt=31-oc(mt);St=1<<Mt,Mt=_[Mt],Mt>bt&&(bt=Mt),mt&=~St}if(mt=bt,mt=B$1()-mt,mt=(120>mt?120:480>mt?480:1080>mt?1080:1920>mt?1920:3e3>mt?3e3:4320>mt?4320:1960*lk(mt/1960))-mt,10<mt){rt.timeoutHandle=Ff$1(Pk.bind(null,rt,tk,uk),mt);break}Pk(rt,tk,uk);break;case 5:Pk(rt,tk,uk);break;default:throw Error(p$4(329))}}}return Dk(rt,B$1()),rt.callbackNode===ut?Gk.bind(null,rt):null}function Nk(rt,_){var ut=sk;return rt.current.memoizedState.isDehydrated&&(Kk(rt,_).flags|=256),rt=Ik(rt,_),rt!==2&&(_=tk,tk=ut,_!==null&&Fj(_)),rt}function Fj(rt){tk===null?tk=rt:tk.push.apply(tk,rt)}function Ok(rt){for(var _=rt;;){if(_.flags&16384){var ut=_.updateQueue;if(ut!==null&&(ut=ut.stores,ut!==null))for(var mt=0;mt<ut.length;mt++){var bt=ut[mt],St=bt.getSnapshot;bt=bt.value;try{if(!He(St(),bt))return!1}catch{return!1}}}if(ut=_.child,_.subtreeFlags&16384&&ut!==null)ut.return=_,_=ut;else{if(_===rt)break;for(;_.sibling===null;){if(_.return===null||_.return===rt)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function Ck(rt,_){for(_&=~rk,_&=~qk,rt.suspendedLanes|=_,rt.pingedLanes&=~_,rt=rt.expirationTimes;0<_;){var ut=31-oc(_),mt=1<<ut;rt[ut]=-1,_&=~mt}}function Ek(rt){if(K$1&6)throw Error(p$4(327));Hk();var _=uc$1(rt,0);if(!(_&1))return Dk(rt,B$1()),null;var ut=Ik(rt,_);if(rt.tag!==0&&ut===2){var mt=xc$1(rt);mt!==0&&(_=mt,ut=Nk(rt,mt))}if(ut===1)throw ut=pk,Kk(rt,0),Ck(rt,_),Dk(rt,B$1()),ut;if(ut===6)throw Error(p$4(345));return rt.finishedWork=rt.current.alternate,rt.finishedLanes=_,Pk(rt,tk,uk),Dk(rt,B$1()),null}function Qk(rt,_){var ut=K$1;K$1|=1;try{return rt(_)}finally{K$1=ut,K$1===0&&(Gj=B$1()+500,fg$1&&jg$1())}}function Rk(rt){wk!==null&&wk.tag===0&&!(K$1&6)&&Hk();var _=K$1;K$1|=1;var ut=ok.transition,mt=C$1;try{if(ok.transition=null,C$1=1,rt)return rt()}finally{C$1=mt,ok.transition=ut,K$1=_,!(K$1&6)&&jg$1()}}function Hj(){fj=ej.current,E$2(ej)}function Kk(rt,_){rt.finishedWork=null,rt.finishedLanes=0;var ut=rt.timeoutHandle;if(ut!==-1&&(rt.timeoutHandle=-1,Gf$1(ut)),Y$2!==null)for(ut=Y$2.return;ut!==null;){var mt=ut;switch(wg$1(mt),mt.tag){case 1:mt=mt.type.childContextTypes,mt!=null&&$f$1();break;case 3:zh$1(),E$2(Wf$1),E$2(H$2),Eh$1();break;case 5:Bh$1(mt);break;case 4:zh$1();break;case 13:E$2(L$3);break;case 19:E$2(L$3);break;case 10:ah$1(mt.type._context);break;case 22:case 23:Hj()}ut=ut.return}if(Q$1=rt,Y$2=rt=Pg$1(rt.current,null),Z=fj=_,T$2=0,pk=null,rk=qk=rh$1=0,tk=sk=null,fh$1!==null){for(_=0;_<fh$1.length;_++)if(ut=fh$1[_],mt=ut.interleaved,mt!==null){ut.interleaved=null;var bt=mt.next,St=ut.pending;if(St!==null){var Mt=St.next;St.next=bt,mt.next=Mt}ut.pending=mt}fh$1=null}return rt}function Mk(rt,_){do{var ut=Y$2;try{if($g$1(),Fh$1.current=Rh$1,Ih$1){for(var mt=M$2.memoizedState;mt!==null;){var bt=mt.queue;bt!==null&&(bt.pending=null),mt=mt.next}Ih$1=!1}if(Hh$1=0,O$1=N$2=M$2=null,Jh$1=!1,Kh$1=0,nk.current=null,ut===null||ut.return===null){T$2=1,pk=_,Y$2=null;break}e:{var St=rt,Mt=ut.return,Bt=ut,Ut=_;if(_=Z,Bt.flags|=32768,Ut!==null&&typeof Ut=="object"&&typeof Ut.then=="function"){var Ht=Ut,tr=Bt,rr=tr.tag;if(!(tr.mode&1)&&(rr===0||rr===11||rr===15)){var sr=tr.alternate;sr?(tr.updateQueue=sr.updateQueue,tr.memoizedState=sr.memoizedState,tr.lanes=sr.lanes):(tr.updateQueue=null,tr.memoizedState=null)}var ar=Ui$1(Mt);if(ar!==null){ar.flags&=-257,Vi$1(ar,Mt,Bt,St,_),ar.mode&1&&Si$1(St,Ht,_),_=ar,Ut=Ht;var cr=_.updateQueue;if(cr===null){var Ar=new Set;Ar.add(Ut),_.updateQueue=Ar}else cr.add(Ut);break e}else{if(!(_&1)){Si$1(St,Ht,_),tj();break e}Ut=Error(p$4(426))}}else if(I$3&&Bt.mode&1){var _r=Ui$1(Mt);if(_r!==null){!(_r.flags&65536)&&(_r.flags|=256),Vi$1(_r,Mt,Bt,St,_),Jg(Ji$1(Ut,Bt));break e}}St=Ut=Ji$1(Ut,Bt),T$2!==4&&(T$2=2),sk===null?sk=[St]:sk.push(St),St=Mt;do{switch(St.tag){case 3:St.flags|=65536,_&=-_,St.lanes|=_;var Dr=Ni$1(St,Ut,_);ph$1(St,Dr);break e;case 1:Bt=Ut;var $r=St.type,Br=St.stateNode;if(!(St.flags&128)&&(typeof $r.getDerivedStateFromError=="function"||Br!==null&&typeof Br.componentDidCatch=="function"&&(Ri$1===null||!Ri$1.has(Br)))){St.flags|=65536,_&=-_,St.lanes|=_;var Jr=Qi(St,Bt,_);ph$1(St,Jr);break e}}St=St.return}while(St!==null)}Sk(ut)}catch(mn){_=mn,Y$2===ut&&ut!==null&&(Y$2=ut=ut.return);continue}break}while(!0)}function Jk(){var rt=mk.current;return mk.current=Rh$1,rt===null?Rh$1:rt}function tj(){(T$2===0||T$2===3||T$2===2)&&(T$2=4),Q$1===null||!(rh$1&268435455)&&!(qk&268435455)||Ck(Q$1,Z)}function Ik(rt,_){var ut=K$1;K$1|=2;var mt=Jk();(Q$1!==rt||Z!==_)&&(uk=null,Kk(rt,_));do try{Tk();break}catch(bt){Mk(rt,bt)}while(!0);if($g$1(),K$1=ut,mk.current=mt,Y$2!==null)throw Error(p$4(261));return Q$1=null,Z=0,T$2}function Tk(){for(;Y$2!==null;)Uk(Y$2)}function Lk(){for(;Y$2!==null&&!cc();)Uk(Y$2)}function Uk(rt){var _=Vk(rt.alternate,rt,fj);rt.memoizedProps=rt.pendingProps,_===null?Sk(rt):Y$2=_,nk.current=null}function Sk(rt){var _=rt;do{var ut=_.alternate;if(rt=_.return,_.flags&32768){if(ut=Ij(ut,_),ut!==null){ut.flags&=32767,Y$2=ut;return}if(rt!==null)rt.flags|=32768,rt.subtreeFlags=0,rt.deletions=null;else{T$2=6,Y$2=null;return}}else if(ut=Ej(ut,_,fj),ut!==null){Y$2=ut;return}if(_=_.sibling,_!==null){Y$2=_;return}Y$2=_=rt}while(_!==null);T$2===0&&(T$2=5)}function Pk(rt,_,ut){var mt=C$1,bt=ok.transition;try{ok.transition=null,C$1=1,Wk(rt,_,ut,mt)}finally{ok.transition=bt,C$1=mt}return null}function Wk(rt,_,ut,mt){do Hk();while(wk!==null);if(K$1&6)throw Error(p$4(327));ut=rt.finishedWork;var bt=rt.finishedLanes;if(ut===null)return null;if(rt.finishedWork=null,rt.finishedLanes=0,ut===rt.current)throw Error(p$4(177));rt.callbackNode=null,rt.callbackPriority=0;var St=ut.lanes|ut.childLanes;if(Bc$1(rt,St),rt===Q$1&&(Y$2=Q$1=null,Z=0),!(ut.subtreeFlags&2064)&&!(ut.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),St=(ut.flags&15990)!==0,ut.subtreeFlags&15990||St){St=ok.transition,ok.transition=null;var Mt=C$1;C$1=1;var Bt=K$1;K$1|=4,nk.current=null,Oj(rt,ut),dk(ut,rt),Oe(Df$1),dd=!!Cf$1,Df$1=Cf$1=null,rt.current=ut,hk(ut),dc(),K$1=Bt,C$1=Mt,ok.transition=St}else rt.current=ut;if(vk&&(vk=!1,wk=rt,xk=bt),St=rt.pendingLanes,St===0&&(Ri$1=null),mc(ut.stateNode),Dk(rt,B$1()),_!==null)for(mt=rt.onRecoverableError,ut=0;ut<_.length;ut++)bt=_[ut],mt(bt.value,{componentStack:bt.stack,digest:bt.digest});if(Oi$1)throw Oi$1=!1,rt=Pi$1,Pi$1=null,rt;return xk&1&&rt.tag!==0&&Hk(),St=rt.pendingLanes,St&1?rt===zk?yk++:(yk=0,zk=rt):yk=0,jg$1(),null}function Hk(){if(wk!==null){var rt=Dc$1(xk),_=ok.transition,ut=C$1;try{if(ok.transition=null,C$1=16>rt?16:rt,wk===null)var mt=!1;else{if(rt=wk,wk=null,xk=0,K$1&6)throw Error(p$4(331));var bt=K$1;for(K$1|=4,V$3=rt.current;V$3!==null;){var St=V$3,Mt=St.child;if(V$3.flags&16){var Bt=St.deletions;if(Bt!==null){for(var Ut=0;Ut<Bt.length;Ut++){var Ht=Bt[Ut];for(V$3=Ht;V$3!==null;){var tr=V$3;switch(tr.tag){case 0:case 11:case 15:Pj(8,tr,St)}var rr=tr.child;if(rr!==null)rr.return=tr,V$3=rr;else for(;V$3!==null;){tr=V$3;var sr=tr.sibling,ar=tr.return;if(Sj(tr),tr===Ht){V$3=null;break}if(sr!==null){sr.return=ar,V$3=sr;break}V$3=ar}}}var cr=St.alternate;if(cr!==null){var Ar=cr.child;if(Ar!==null){cr.child=null;do{var _r=Ar.sibling;Ar.sibling=null,Ar=_r}while(Ar!==null)}}V$3=St}}if(St.subtreeFlags&2064&&Mt!==null)Mt.return=St,V$3=Mt;else e:for(;V$3!==null;){if(St=V$3,St.flags&2048)switch(St.tag){case 0:case 11:case 15:Pj(9,St,St.return)}var Dr=St.sibling;if(Dr!==null){Dr.return=St.return,V$3=Dr;break e}V$3=St.return}}var $r=rt.current;for(V$3=$r;V$3!==null;){Mt=V$3;var Br=Mt.child;if(Mt.subtreeFlags&2064&&Br!==null)Br.return=Mt,V$3=Br;else e:for(Mt=$r;V$3!==null;){if(Bt=V$3,Bt.flags&2048)try{switch(Bt.tag){case 0:case 11:case 15:Qj(9,Bt)}}catch(mn){W$1(Bt,Bt.return,mn)}if(Bt===Mt){V$3=null;break e}var Jr=Bt.sibling;if(Jr!==null){Jr.return=Bt.return,V$3=Jr;break e}V$3=Bt.return}}if(K$1=bt,jg$1(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc$1,rt)}catch{}mt=!0}return mt}finally{C$1=ut,ok.transition=_}}return!1}function Xk(rt,_,ut){_=Ji$1(ut,_),_=Ni$1(rt,_,1),rt=nh$1(rt,_,1),_=R$1(),rt!==null&&(Ac$1(rt,1,_),Dk(rt,_))}function W$1(rt,_,ut){if(rt.tag===3)Xk(rt,rt,ut);else for(;_!==null;){if(_.tag===3){Xk(_,rt,ut);break}else if(_.tag===1){var mt=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof mt.componentDidCatch=="function"&&(Ri$1===null||!Ri$1.has(mt))){rt=Ji$1(ut,rt),rt=Qi(_,rt,1),_=nh$1(_,rt,1),rt=R$1(),_!==null&&(Ac$1(_,1,rt),Dk(_,rt));break}}_=_.return}}function Ti$1(rt,_,ut){var mt=rt.pingCache;mt!==null&&mt.delete(_),_=R$1(),rt.pingedLanes|=rt.suspendedLanes&ut,Q$1===rt&&(Z&ut)===ut&&(T$2===4||T$2===3&&(Z&130023424)===Z&&500>B$1()-fk?Kk(rt,0):rk|=ut),Dk(rt,_)}function Yk(rt,_){_===0&&(rt.mode&1?(_=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):_=1);var ut=R$1();rt=ih$1(rt,_),rt!==null&&(Ac$1(rt,_,ut),Dk(rt,ut))}function uj(rt){var _=rt.memoizedState,ut=0;_!==null&&(ut=_.retryLane),Yk(rt,ut)}function bk(rt,_){var ut=0;switch(rt.tag){case 13:var mt=rt.stateNode,bt=rt.memoizedState;bt!==null&&(ut=bt.retryLane);break;case 19:mt=rt.stateNode;break;default:throw Error(p$4(314))}mt!==null&&mt.delete(_),Yk(rt,ut)}var Vk;Vk=function(rt,_,ut){if(rt!==null)if(rt.memoizedProps!==_.pendingProps||Wf$1.current)dh$1=!0;else{if(!(rt.lanes&ut)&&!(_.flags&128))return dh$1=!1,yj(rt,_,ut);dh$1=!!(rt.flags&131072)}else dh$1=!1,I$3&&_.flags&1048576&&ug(_,ng$1,_.index);switch(_.lanes=0,_.tag){case 2:var mt=_.type;ij(rt,_),rt=_.pendingProps;var bt=Yf$1(_,H$2.current);ch$1(_,ut),bt=Nh$1(null,_,mt,rt,bt,ut);var St=Sh$1();return _.flags|=1,typeof bt=="object"&&bt!==null&&typeof bt.render=="function"&&bt.$$typeof===void 0?(_.tag=1,_.memoizedState=null,_.updateQueue=null,Zf$1(mt)?(St=!0,cg$1(_)):St=!1,_.memoizedState=bt.state!==null&&bt.state!==void 0?bt.state:null,kh$1(_),bt.updater=Ei,_.stateNode=bt,bt._reactInternals=_,Ii$1(_,mt,rt,ut),_=jj(null,_,mt,!0,St,ut)):(_.tag=0,I$3&&St&&vg(_),Xi$1(null,_,bt,ut),_=_.child),_;case 16:mt=_.elementType;e:{switch(ij(rt,_),rt=_.pendingProps,bt=mt._init,mt=bt(mt._payload),_.type=mt,bt=_.tag=Zk(mt),rt=Ci$1(mt,rt),bt){case 0:_=cj(null,_,mt,rt,ut);break e;case 1:_=hj(null,_,mt,rt,ut);break e;case 11:_=Yi$1(null,_,mt,rt,ut);break e;case 14:_=$i$1(null,_,mt,Ci$1(mt.type,rt),ut);break e}throw Error(p$4(306,mt,""))}return _;case 0:return mt=_.type,bt=_.pendingProps,bt=_.elementType===mt?bt:Ci$1(mt,bt),cj(rt,_,mt,bt,ut);case 1:return mt=_.type,bt=_.pendingProps,bt=_.elementType===mt?bt:Ci$1(mt,bt),hj(rt,_,mt,bt,ut);case 3:e:{if(kj(_),rt===null)throw Error(p$4(387));mt=_.pendingProps,St=_.memoizedState,bt=St.element,lh$1(rt,_),qh$1(_,mt,null,ut);var Mt=_.memoizedState;if(mt=Mt.element,St.isDehydrated)if(St={element:mt,isDehydrated:!1,cache:Mt.cache,pendingSuspenseBoundaries:Mt.pendingSuspenseBoundaries,transitions:Mt.transitions},_.updateQueue.baseState=St,_.memoizedState=St,_.flags&256){bt=Ji$1(Error(p$4(423)),_),_=lj(rt,_,mt,ut,bt);break e}else if(mt!==bt){bt=Ji$1(Error(p$4(424)),_),_=lj(rt,_,mt,ut,bt);break e}else for(yg$1=Lf$1(_.stateNode.containerInfo.firstChild),xg$1=_,I$3=!0,zg=null,ut=Vg(_,null,mt,ut),_.child=ut;ut;)ut.flags=ut.flags&-3|4096,ut=ut.sibling;else{if(Ig$1(),mt===bt){_=Zi$1(rt,_,ut);break e}Xi$1(rt,_,mt,ut)}_=_.child}return _;case 5:return Ah$1(_),rt===null&&Eg(_),mt=_.type,bt=_.pendingProps,St=rt!==null?rt.memoizedProps:null,Mt=bt.children,Ef$1(mt,bt)?Mt=null:St!==null&&Ef$1(mt,St)&&(_.flags|=32),gj(rt,_),Xi$1(rt,_,Mt,ut),_.child;case 6:return rt===null&&Eg(_),null;case 13:return oj(rt,_,ut);case 4:return yh$1(_,_.stateNode.containerInfo),mt=_.pendingProps,rt===null?_.child=Ug(_,null,mt,ut):Xi$1(rt,_,mt,ut),_.child;case 11:return mt=_.type,bt=_.pendingProps,bt=_.elementType===mt?bt:Ci$1(mt,bt),Yi$1(rt,_,mt,bt,ut);case 7:return Xi$1(rt,_,_.pendingProps,ut),_.child;case 8:return Xi$1(rt,_,_.pendingProps.children,ut),_.child;case 12:return Xi$1(rt,_,_.pendingProps.children,ut),_.child;case 10:e:{if(mt=_.type._context,bt=_.pendingProps,St=_.memoizedProps,Mt=bt.value,G$1(Wg$1,mt._currentValue),mt._currentValue=Mt,St!==null)if(He(St.value,Mt)){if(St.children===bt.children&&!Wf$1.current){_=Zi$1(rt,_,ut);break e}}else for(St=_.child,St!==null&&(St.return=_);St!==null;){var Bt=St.dependencies;if(Bt!==null){Mt=St.child;for(var Ut=Bt.firstContext;Ut!==null;){if(Ut.context===mt){if(St.tag===1){Ut=mh$1(-1,ut&-ut),Ut.tag=2;var Ht=St.updateQueue;if(Ht!==null){Ht=Ht.shared;var tr=Ht.pending;tr===null?Ut.next=Ut:(Ut.next=tr.next,tr.next=Ut),Ht.pending=Ut}}St.lanes|=ut,Ut=St.alternate,Ut!==null&&(Ut.lanes|=ut),bh$1(St.return,ut,_),Bt.lanes|=ut;break}Ut=Ut.next}}else if(St.tag===10)Mt=St.type===_.type?null:St.child;else if(St.tag===18){if(Mt=St.return,Mt===null)throw Error(p$4(341));Mt.lanes|=ut,Bt=Mt.alternate,Bt!==null&&(Bt.lanes|=ut),bh$1(Mt,ut,_),Mt=St.sibling}else Mt=St.child;if(Mt!==null)Mt.return=St;else for(Mt=St;Mt!==null;){if(Mt===_){Mt=null;break}if(St=Mt.sibling,St!==null){St.return=Mt.return,Mt=St;break}Mt=Mt.return}St=Mt}Xi$1(rt,_,bt.children,ut),_=_.child}return _;case 9:return bt=_.type,mt=_.pendingProps.children,ch$1(_,ut),bt=eh$1(bt),mt=mt(bt),_.flags|=1,Xi$1(rt,_,mt,ut),_.child;case 14:return mt=_.type,bt=Ci$1(mt,_.pendingProps),bt=Ci$1(mt.type,bt),$i$1(rt,_,mt,bt,ut);case 15:return bj(rt,_,_.type,_.pendingProps,ut);case 17:return mt=_.type,bt=_.pendingProps,bt=_.elementType===mt?bt:Ci$1(mt,bt),ij(rt,_),_.tag=1,Zf$1(mt)?(rt=!0,cg$1(_)):rt=!1,ch$1(_,ut),Gi$1(_,mt,bt),Ii$1(_,mt,bt,ut),jj(null,_,mt,!0,rt,ut);case 19:return xj(rt,_,ut);case 22:return dj(rt,_,ut)}throw Error(p$4(156,_.tag))};function Fk(rt,_){return ac(rt,_)}function $k(rt,_,ut,mt){this.tag=rt,this.key=ut,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=mt,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg$1(rt,_,ut,mt){return new $k(rt,_,ut,mt)}function aj(rt){return rt=rt.prototype,!(!rt||!rt.isReactComponent)}function Zk(rt){if(typeof rt=="function")return aj(rt)?1:0;if(rt!=null){if(rt=rt.$$typeof,rt===Da$1)return 11;if(rt===Ga$1)return 14}return 2}function Pg$1(rt,_){var ut=rt.alternate;return ut===null?(ut=Bg$1(rt.tag,_,rt.key,rt.mode),ut.elementType=rt.elementType,ut.type=rt.type,ut.stateNode=rt.stateNode,ut.alternate=rt,rt.alternate=ut):(ut.pendingProps=_,ut.type=rt.type,ut.flags=0,ut.subtreeFlags=0,ut.deletions=null),ut.flags=rt.flags&14680064,ut.childLanes=rt.childLanes,ut.lanes=rt.lanes,ut.child=rt.child,ut.memoizedProps=rt.memoizedProps,ut.memoizedState=rt.memoizedState,ut.updateQueue=rt.updateQueue,_=rt.dependencies,ut.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},ut.sibling=rt.sibling,ut.index=rt.index,ut.ref=rt.ref,ut}function Rg$1(rt,_,ut,mt,bt,St){var Mt=2;if(mt=rt,typeof rt=="function")aj(rt)&&(Mt=1);else if(typeof rt=="string")Mt=5;else e:switch(rt){case ya$1:return Tg$1(ut.children,bt,St,_);case za$1:Mt=8,bt|=8;break;case Aa$1:return rt=Bg$1(12,ut,_,bt|2),rt.elementType=Aa$1,rt.lanes=St,rt;case Ea$1:return rt=Bg$1(13,ut,_,bt),rt.elementType=Ea$1,rt.lanes=St,rt;case Fa$1:return rt=Bg$1(19,ut,_,bt),rt.elementType=Fa$1,rt.lanes=St,rt;case Ia$1:return pj(ut,bt,St,_);default:if(typeof rt=="object"&&rt!==null)switch(rt.$$typeof){case Ba$1:Mt=10;break e;case Ca$1:Mt=9;break e;case Da$1:Mt=11;break e;case Ga$1:Mt=14;break e;case Ha:Mt=16,mt=null;break e}throw Error(p$4(130,rt==null?rt:typeof rt,""))}return _=Bg$1(Mt,ut,_,bt),_.elementType=rt,_.type=mt,_.lanes=St,_}function Tg$1(rt,_,ut,mt){return rt=Bg$1(7,rt,mt,_),rt.lanes=ut,rt}function pj(rt,_,ut,mt){return rt=Bg$1(22,rt,mt,_),rt.elementType=Ia$1,rt.lanes=ut,rt.stateNode={isHidden:!1},rt}function Qg$1(rt,_,ut){return rt=Bg$1(6,rt,null,_),rt.lanes=ut,rt}function Sg$1(rt,_,ut){return _=Bg$1(4,rt.children!==null?rt.children:[],rt.key,_),_.lanes=ut,_.stateNode={containerInfo:rt.containerInfo,pendingChildren:null,implementation:rt.implementation},_}function al$1(rt,_,ut,mt,bt){this.tag=_,this.containerInfo=rt,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=mt,this.onRecoverableError=bt,this.mutableSourceEagerHydrationData=null}function bl$1(rt,_,ut,mt,bt,St,Mt,Bt,Ut){return rt=new al$1(rt,_,ut,Bt,Ut),_===1?(_=1,St===!0&&(_|=8)):_=0,St=Bg$1(3,null,null,_),rt.current=St,St.stateNode=rt,St.memoizedState={element:mt,isDehydrated:ut,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh$1(St),rt}function cl$1(rt,_,ut){var mt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa$1,key:mt==null?null:""+mt,children:rt,containerInfo:_,implementation:ut}}function dl$1(rt){if(!rt)return Vf$1;rt=rt._reactInternals;e:{if(Vb$1(rt)!==rt||rt.tag!==1)throw Error(p$4(170));var _=rt;do{switch(_.tag){case 3:_=_.stateNode.context;break e;case 1:if(Zf$1(_.type)){_=_.stateNode.__reactInternalMemoizedMergedChildContext;break e}}_=_.return}while(_!==null);throw Error(p$4(171))}if(rt.tag===1){var ut=rt.type;if(Zf$1(ut))return bg$1(rt,ut,_)}return _}function el$1(rt,_,ut,mt,bt,St,Mt,Bt,Ut){return rt=bl$1(ut,mt,!0,rt,bt,St,Mt,Bt,Ut),rt.context=dl$1(null),ut=rt.current,mt=R$1(),bt=yi$1(ut),St=mh$1(mt,bt),St.callback=_??null,nh$1(ut,St,bt),rt.current.lanes=bt,Ac$1(rt,bt,mt),Dk(rt,mt),rt}function fl$2(rt,_,ut,mt){var bt=_.current,St=R$1(),Mt=yi$1(bt);return ut=dl$1(ut),_.context===null?_.context=ut:_.pendingContext=ut,_=mh$1(St,Mt),_.payload={element:rt},mt=mt===void 0?null:mt,mt!==null&&(_.callback=mt),rt=nh$1(bt,_,Mt),rt!==null&&(gi$1(rt,bt,Mt,St),oh$1(rt,bt,Mt)),Mt}function gl$1(rt){if(rt=rt.current,!rt.child)return null;switch(rt.child.tag){case 5:return rt.child.stateNode;default:return rt.child.stateNode}}function hl$1(rt,_){if(rt=rt.memoizedState,rt!==null&&rt.dehydrated!==null){var ut=rt.retryLane;rt.retryLane=ut!==0&&ut<_?ut:_}}function il$1(rt,_){hl$1(rt,_),(rt=rt.alternate)&&hl$1(rt,_)}function jl$1(){return null}var kl$1=typeof reportError=="function"?reportError:function(rt){console.error(rt)};function ll$1(rt){this._internalRoot=rt}ml$1.prototype.render=ll$1.prototype.render=function(rt){var _=this._internalRoot;if(_===null)throw Error(p$4(409));fl$2(rt,_,null,null)};ml$1.prototype.unmount=ll$1.prototype.unmount=function(){var rt=this._internalRoot;if(rt!==null){this._internalRoot=null;var _=rt.containerInfo;Rk(function(){fl$2(null,rt,null,null)}),_[uf$1]=null}};function ml$1(rt){this._internalRoot=rt}ml$1.prototype.unstable_scheduleHydration=function(rt){if(rt){var _=Hc$1();rt={blockedOn:null,target:rt,priority:_};for(var ut=0;ut<Qc$1.length&&_!==0&&_<Qc$1[ut].priority;ut++);Qc$1.splice(ut,0,rt),ut===0&&Vc$1(rt)}};function nl$1(rt){return!(!rt||rt.nodeType!==1&&rt.nodeType!==9&&rt.nodeType!==11)}function ol$1(rt){return!(!rt||rt.nodeType!==1&&rt.nodeType!==9&&rt.nodeType!==11&&(rt.nodeType!==8||rt.nodeValue!==" react-mount-point-unstable "))}function pl$1(){}function ql$1(rt,_,ut,mt,bt){if(bt){if(typeof mt=="function"){var St=mt;mt=function(){var Ht=gl$1(Mt);St.call(Ht)}}var Mt=el$1(_,mt,rt,0,null,!1,!1,"",pl$1);return rt._reactRootContainer=Mt,rt[uf$1]=Mt.current,sf$1(rt.nodeType===8?rt.parentNode:rt),Rk(),Mt}for(;bt=rt.lastChild;)rt.removeChild(bt);if(typeof mt=="function"){var Bt=mt;mt=function(){var Ht=gl$1(Ut);Bt.call(Ht)}}var Ut=bl$1(rt,0,!1,null,null,!1,!1,"",pl$1);return rt._reactRootContainer=Ut,rt[uf$1]=Ut.current,sf$1(rt.nodeType===8?rt.parentNode:rt),Rk(function(){fl$2(_,Ut,ut,mt)}),Ut}function rl$1(rt,_,ut,mt,bt){var St=ut._reactRootContainer;if(St){var Mt=St;if(typeof bt=="function"){var Bt=bt;bt=function(){var Ut=gl$1(Mt);Bt.call(Ut)}}fl$2(_,Mt,rt,bt)}else Mt=ql$1(ut,_,rt,bt,mt);return gl$1(Mt)}Ec$1=function(rt){switch(rt.tag){case 3:var _=rt.stateNode;if(_.current.memoizedState.isDehydrated){var ut=tc$1(_.pendingLanes);ut!==0&&(Cc(_,ut|1),Dk(_,B$1()),!(K$1&6)&&(Gj=B$1()+500,jg$1()))}break;case 13:Rk(function(){var mt=ih$1(rt,1);if(mt!==null){var bt=R$1();gi$1(mt,rt,1,bt)}}),il$1(rt,1)}};Fc$1=function(rt){if(rt.tag===13){var _=ih$1(rt,134217728);if(_!==null){var ut=R$1();gi$1(_,rt,134217728,ut)}il$1(rt,134217728)}};Gc$1=function(rt){if(rt.tag===13){var _=yi$1(rt),ut=ih$1(rt,_);if(ut!==null){var mt=R$1();gi$1(ut,rt,_,mt)}il$1(rt,_)}};Hc$1=function(){return C$1};Ic$1=function(rt,_){var ut=C$1;try{return C$1=rt,_()}finally{C$1=ut}};yb$1=function(rt,_,ut){switch(_){case"input":if(bb$1(rt,ut),_=ut.name,ut.type==="radio"&&_!=null){for(ut=rt;ut.parentNode;)ut=ut.parentNode;for(ut=ut.querySelectorAll("input[name="+JSON.stringify(""+_)+'][type="radio"]'),_=0;_<ut.length;_++){var mt=ut[_];if(mt!==rt&&mt.form===rt.form){var bt=Db$1(mt);if(!bt)throw Error(p$4(90));Wa$1(mt),bb$1(mt,bt)}}}break;case"textarea":ib$1(rt,ut);break;case"select":_=ut.value,_!=null&&fb$1(rt,!!ut.multiple,_,!1)}};Gb$1=Qk;Hb$1=Rk;var sl$1={usingClientEntryPoint:!1,Events:[Cb$1,ue,Db$1,Eb$1,Fb$1,Qk]},tl$1={findFiberByHostInstance:Wc$1,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul$1={bundleType:tl$1.bundleType,version:tl$1.version,rendererPackageName:tl$1.rendererPackageName,rendererConfig:tl$1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua$1.ReactCurrentDispatcher,findHostInstanceByFiber:function(rt){return rt=Zb$1(rt),rt===null?null:rt.stateNode},findFiberByHostInstance:tl$1.findFiberByHostInstance||jl$1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl$1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl$1.isDisabled&&vl$1.supportsFiber)try{kc$1=vl$1.inject(ul$1),lc=vl$1}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl$1;reactDom_production_min.createPortal=function(rt,_){var ut=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl$1(_))throw Error(p$4(200));return cl$1(rt,_,null,ut)};reactDom_production_min.createRoot=function(rt,_){if(!nl$1(rt))throw Error(p$4(299));var ut=!1,mt="",bt=kl$1;return _!=null&&(_.unstable_strictMode===!0&&(ut=!0),_.identifierPrefix!==void 0&&(mt=_.identifierPrefix),_.onRecoverableError!==void 0&&(bt=_.onRecoverableError)),_=bl$1(rt,1,!1,null,null,ut,!1,mt,bt),rt[uf$1]=_.current,sf$1(rt.nodeType===8?rt.parentNode:rt),new ll$1(_)};reactDom_production_min.findDOMNode=function(rt){if(rt==null)return null;if(rt.nodeType===1)return rt;var _=rt._reactInternals;if(_===void 0)throw typeof rt.render=="function"?Error(p$4(188)):(rt=Object.keys(rt).join(","),Error(p$4(268,rt)));return rt=Zb$1(_),rt=rt===null?null:rt.stateNode,rt};reactDom_production_min.flushSync=function(rt){return Rk(rt)};reactDom_production_min.hydrate=function(rt,_,ut){if(!ol$1(_))throw Error(p$4(200));return rl$1(null,rt,_,!0,ut)};reactDom_production_min.hydrateRoot=function(rt,_,ut){if(!nl$1(rt))throw Error(p$4(405));var mt=ut!=null&&ut.hydratedSources||null,bt=!1,St="",Mt=kl$1;if(ut!=null&&(ut.unstable_strictMode===!0&&(bt=!0),ut.identifierPrefix!==void 0&&(St=ut.identifierPrefix),ut.onRecoverableError!==void 0&&(Mt=ut.onRecoverableError)),_=el$1(_,null,rt,1,ut??null,bt,!1,St,Mt),rt[uf$1]=_.current,sf$1(rt),mt)for(rt=0;rt<mt.length;rt++)ut=mt[rt],bt=ut._getVersion,bt=bt(ut._source),_.mutableSourceEagerHydrationData==null?_.mutableSourceEagerHydrationData=[ut,bt]:_.mutableSourceEagerHydrationData.push(ut,bt);return new ml$1(_)};reactDom_production_min.render=function(rt,_,ut){if(!ol$1(_))throw Error(p$4(200));return rl$1(null,rt,_,!1,ut)};reactDom_production_min.unmountComponentAtNode=function(rt){if(!ol$1(rt))throw Error(p$4(40));return rt._reactRootContainer?(Rk(function(){rl$1(null,null,rt,!1,function(){rt._reactRootContainer=null,rt[uf$1]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(rt,_,ut,mt){if(!ol$1(ut))throw Error(p$4(200));if(rt==null||rt._reactInternals===void 0)throw Error(p$4(38));return rl$1(rt,_,ut,!1,mt)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(rt){console.error(rt)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs(reactDomExports);var createRoot$1,m$3=reactDomExports;createRoot$1=client.createRoot=m$3.createRoot,client.hydrateRoot=m$3.hydrateRoot;/**
 * @remix-run/router v1.16.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$8(){return _extends$8=Object.assign?Object.assign.bind():function(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_];for(var mt in ut)Object.prototype.hasOwnProperty.call(ut,mt)&&(rt[mt]=ut[mt])}return rt},_extends$8.apply(this,arguments)}var Action;(function(rt){rt.Pop="POP",rt.Push="PUSH",rt.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(rt){rt===void 0&&(rt={});function _(mt,bt){let{pathname:St,search:Mt,hash:Bt}=mt.location;return createLocation("",{pathname:St,search:Mt,hash:Bt},bt.state&&bt.state.usr||null,bt.state&&bt.state.key||"default")}function ut(mt,bt){return typeof bt=="string"?bt:createPath(bt)}return getUrlBasedHistory(_,ut,null,rt)}function invariant$1(rt,_){if(rt===!1||rt===null||typeof rt>"u")throw new Error(_)}function warning(rt,_){if(!rt){typeof console<"u"&&console.warn(_);try{throw new Error(_)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(rt,_){return{usr:rt.state,key:rt.key,idx:_}}function createLocation(rt,_,ut,mt){return ut===void 0&&(ut=null),_extends$8({pathname:typeof rt=="string"?rt:rt.pathname,search:"",hash:""},typeof _=="string"?parsePath(_):_,{state:ut,key:_&&_.key||mt||createKey()})}function createPath(rt){let{pathname:_="/",search:ut="",hash:mt=""}=rt;return ut&&ut!=="?"&&(_+=ut.charAt(0)==="?"?ut:"?"+ut),mt&&mt!=="#"&&(_+=mt.charAt(0)==="#"?mt:"#"+mt),_}function parsePath(rt){let _={};if(rt){let ut=rt.indexOf("#");ut>=0&&(_.hash=rt.substr(ut),rt=rt.substr(0,ut));let mt=rt.indexOf("?");mt>=0&&(_.search=rt.substr(mt),rt=rt.substr(0,mt)),rt&&(_.pathname=rt)}return _}function getUrlBasedHistory(rt,_,ut,mt){mt===void 0&&(mt={});let{window:bt=document.defaultView,v5Compat:St=!1}=mt,Mt=bt.history,Bt=Action.Pop,Ut=null,Ht=tr();Ht==null&&(Ht=0,Mt.replaceState(_extends$8({},Mt.state,{idx:Ht}),""));function tr(){return(Mt.state||{idx:null}).idx}function rr(){Bt=Action.Pop;let _r=tr(),Dr=_r==null?null:_r-Ht;Ht=_r,Ut&&Ut({action:Bt,location:Ar.location,delta:Dr})}function sr(_r,Dr){Bt=Action.Push;let $r=createLocation(Ar.location,_r,Dr);Ht=tr()+1;let Br=getHistoryState($r,Ht),Jr=Ar.createHref($r);try{Mt.pushState(Br,"",Jr)}catch(mn){if(mn instanceof DOMException&&mn.name==="DataCloneError")throw mn;bt.location.assign(Jr)}St&&Ut&&Ut({action:Bt,location:Ar.location,delta:1})}function ar(_r,Dr){Bt=Action.Replace;let $r=createLocation(Ar.location,_r,Dr);Ht=tr();let Br=getHistoryState($r,Ht),Jr=Ar.createHref($r);Mt.replaceState(Br,"",Jr),St&&Ut&&Ut({action:Bt,location:Ar.location,delta:0})}function cr(_r){let Dr=bt.location.origin!=="null"?bt.location.origin:bt.location.href,$r=typeof _r=="string"?_r:createPath(_r);return $r=$r.replace(/ $/,"%20"),invariant$1(Dr,"No window.location.(origin|href) available to create URL for href: "+$r),new URL($r,Dr)}let Ar={get action(){return Bt},get location(){return rt(bt,Mt)},listen(_r){if(Ut)throw new Error("A history only accepts one active listener");return bt.addEventListener(PopStateEventType,rr),Ut=_r,()=>{bt.removeEventListener(PopStateEventType,rr),Ut=null}},createHref(_r){return _(bt,_r)},createURL:cr,encodeLocation(_r){let Dr=cr(_r);return{pathname:Dr.pathname,search:Dr.search,hash:Dr.hash}},push:sr,replace:ar,go(_r){return Mt.go(_r)}};return Ar}var ResultType;(function(rt){rt.data="data",rt.deferred="deferred",rt.redirect="redirect",rt.error="error"})(ResultType||(ResultType={}));function matchRoutes(rt,_,ut){ut===void 0&&(ut="/");let mt=typeof _=="string"?parsePath(_):_,bt=stripBasename(mt.pathname||"/",ut);if(bt==null)return null;let St=flattenRoutes(rt);rankRouteBranches(St);let Mt=null;for(let Bt=0;Mt==null&&Bt<St.length;++Bt){let Ut=decodePath(bt);Mt=matchRouteBranch(St[Bt],Ut)}return Mt}function flattenRoutes(rt,_,ut,mt){_===void 0&&(_=[]),ut===void 0&&(ut=[]),mt===void 0&&(mt="");let bt=(St,Mt,Bt)=>{let Ut={relativePath:Bt===void 0?St.path||"":Bt,caseSensitive:St.caseSensitive===!0,childrenIndex:Mt,route:St};Ut.relativePath.startsWith("/")&&(invariant$1(Ut.relativePath.startsWith(mt),'Absolute route path "'+Ut.relativePath+'" nested under path '+('"'+mt+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),Ut.relativePath=Ut.relativePath.slice(mt.length));let Ht=joinPaths([mt,Ut.relativePath]),tr=ut.concat(Ut);St.children&&St.children.length>0&&(invariant$1(St.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+Ht+'".')),flattenRoutes(St.children,_,tr,Ht)),!(St.path==null&&!St.index)&&_.push({path:Ht,score:computeScore(Ht,St.index),routesMeta:tr})};return rt.forEach((St,Mt)=>{var Bt;if(St.path===""||!((Bt=St.path)!=null&&Bt.includes("?")))bt(St,Mt);else for(let Ut of explodeOptionalSegments(St.path))bt(St,Mt,Ut)}),_}function explodeOptionalSegments(rt){let _=rt.split("/");if(_.length===0)return[];let[ut,...mt]=_,bt=ut.endsWith("?"),St=ut.replace(/\?$/,"");if(mt.length===0)return bt?[St,""]:[St];let Mt=explodeOptionalSegments(mt.join("/")),Bt=[];return Bt.push(...Mt.map(Ut=>Ut===""?St:[St,Ut].join("/"))),bt&&Bt.push(...Mt),Bt.map(Ut=>rt.startsWith("/")&&Ut===""?"/":Ut)}function rankRouteBranches(rt){rt.sort((_,ut)=>_.score!==ut.score?ut.score-_.score:compareIndexes(_.routesMeta.map(mt=>mt.childrenIndex),ut.routesMeta.map(mt=>mt.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=rt=>rt==="*";function computeScore(rt,_){let ut=rt.split("/"),mt=ut.length;return ut.some(isSplat)&&(mt+=splatPenalty),_&&(mt+=indexRouteValue),ut.filter(bt=>!isSplat(bt)).reduce((bt,St)=>bt+(paramRe.test(St)?dynamicSegmentValue:St===""?emptySegmentValue:staticSegmentValue),mt)}function compareIndexes(rt,_){return rt.length===_.length&&rt.slice(0,-1).every((mt,bt)=>mt===_[bt])?rt[rt.length-1]-_[_.length-1]:0}function matchRouteBranch(rt,_){let{routesMeta:ut}=rt,mt={},bt="/",St=[];for(let Mt=0;Mt<ut.length;++Mt){let Bt=ut[Mt],Ut=Mt===ut.length-1,Ht=bt==="/"?_:_.slice(bt.length)||"/",tr=matchPath({path:Bt.relativePath,caseSensitive:Bt.caseSensitive,end:Ut},Ht);if(!tr)return null;Object.assign(mt,tr.params);let rr=Bt.route;St.push({params:mt,pathname:joinPaths([bt,tr.pathname]),pathnameBase:normalizePathname(joinPaths([bt,tr.pathnameBase])),route:rr}),tr.pathnameBase!=="/"&&(bt=joinPaths([bt,tr.pathnameBase]))}return St}function matchPath(rt,_){typeof rt=="string"&&(rt={path:rt,caseSensitive:!1,end:!0});let[ut,mt]=compilePath(rt.path,rt.caseSensitive,rt.end),bt=_.match(ut);if(!bt)return null;let St=bt[0],Mt=St.replace(/(.)\/+$/,"$1"),Bt=bt.slice(1);return{params:mt.reduce((Ht,tr,rr)=>{let{paramName:sr,isOptional:ar}=tr;if(sr==="*"){let Ar=Bt[rr]||"";Mt=St.slice(0,St.length-Ar.length).replace(/(.)\/+$/,"$1")}const cr=Bt[rr];return ar&&!cr?Ht[sr]=void 0:Ht[sr]=(cr||"").replace(/%2F/g,"/"),Ht},{}),pathname:St,pathnameBase:Mt,pattern:rt}}function compilePath(rt,_,ut){_===void 0&&(_=!1),ut===void 0&&(ut=!0),warning(rt==="*"||!rt.endsWith("*")||rt.endsWith("/*"),'Route path "'+rt+'" will be treated as if it were '+('"'+rt.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+rt.replace(/\*$/,"/*")+'".'));let mt=[],bt="^"+rt.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(Mt,Bt,Ut)=>(mt.push({paramName:Bt,isOptional:Ut!=null}),Ut?"/?([^\\/]+)?":"/([^\\/]+)"));return rt.endsWith("*")?(mt.push({paramName:"*"}),bt+=rt==="*"||rt==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):ut?bt+="\\/*$":rt!==""&&rt!=="/"&&(bt+="(?:(?=\\/|$))"),[new RegExp(bt,_?void 0:"i"),mt]}function decodePath(rt){try{return rt.split("/").map(_=>decodeURIComponent(_).replace(/\//g,"%2F")).join("/")}catch(_){return warning(!1,'The URL path "'+rt+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+_+").")),rt}}function stripBasename(rt,_){if(_==="/")return rt;if(!rt.toLowerCase().startsWith(_.toLowerCase()))return null;let ut=_.endsWith("/")?_.length-1:_.length,mt=rt.charAt(ut);return mt&&mt!=="/"?null:rt.slice(ut)||"/"}function resolvePath(rt,_){_===void 0&&(_="/");let{pathname:ut,search:mt="",hash:bt=""}=typeof rt=="string"?parsePath(rt):rt;return{pathname:ut?ut.startsWith("/")?ut:resolvePathname(ut,_):_,search:normalizeSearch(mt),hash:normalizeHash(bt)}}function resolvePathname(rt,_){let ut=_.replace(/\/+$/,"").split("/");return rt.split("/").forEach(bt=>{bt===".."?ut.length>1&&ut.pop():bt!=="."&&ut.push(bt)}),ut.length>1?ut.join("/"):"/"}function getInvalidPathError(rt,_,ut,mt){return"Cannot include a '"+rt+"' character in a manually specified "+("`to."+_+"` field ["+JSON.stringify(mt)+"].  Please separate it out to the ")+("`to."+ut+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(rt){return rt.filter((_,ut)=>ut===0||_.route.path&&_.route.path.length>0)}function getResolveToMatches(rt,_){let ut=getPathContributingMatches(rt);return _?ut.map((mt,bt)=>bt===rt.length-1?mt.pathname:mt.pathnameBase):ut.map(mt=>mt.pathnameBase)}function resolveTo(rt,_,ut,mt){mt===void 0&&(mt=!1);let bt;typeof rt=="string"?bt=parsePath(rt):(bt=_extends$8({},rt),invariant$1(!bt.pathname||!bt.pathname.includes("?"),getInvalidPathError("?","pathname","search",bt)),invariant$1(!bt.pathname||!bt.pathname.includes("#"),getInvalidPathError("#","pathname","hash",bt)),invariant$1(!bt.search||!bt.search.includes("#"),getInvalidPathError("#","search","hash",bt)));let St=rt===""||bt.pathname==="",Mt=St?"/":bt.pathname,Bt;if(Mt==null)Bt=ut;else{let rr=_.length-1;if(!mt&&Mt.startsWith("..")){let sr=Mt.split("/");for(;sr[0]==="..";)sr.shift(),rr-=1;bt.pathname=sr.join("/")}Bt=rr>=0?_[rr]:"/"}let Ut=resolvePath(bt,Bt),Ht=Mt&&Mt!=="/"&&Mt.endsWith("/"),tr=(St||Mt===".")&&ut.endsWith("/");return!Ut.pathname.endsWith("/")&&(Ht||tr)&&(Ut.pathname+="/"),Ut}const joinPaths=rt=>rt.join("/").replace(/\/\/+/g,"/"),normalizePathname=rt=>rt.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=rt=>!rt||rt==="?"?"":rt.startsWith("?")?rt:"?"+rt,normalizeHash=rt=>!rt||rt==="#"?"":rt.startsWith("#")?rt:"#"+rt;function isRouteErrorResponse(rt){return rt!=null&&typeof rt.status=="number"&&typeof rt.statusText=="string"&&typeof rt.internal=="boolean"&&"data"in rt}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$7(){return _extends$7=Object.assign?Object.assign.bind():function(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_];for(var mt in ut)Object.prototype.hasOwnProperty.call(ut,mt)&&(rt[mt]=ut[mt])}return rt},_extends$7.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(rt,_){let{relative:ut}=_===void 0?{}:_;useInRouterContext()||invariant$1(!1);let{basename:mt,navigator:bt}=reactExports.useContext(NavigationContext),{hash:St,pathname:Mt,search:Bt}=useResolvedPath(rt,{relative:ut}),Ut=Mt;return mt!=="/"&&(Ut=Mt==="/"?mt:joinPaths([mt,Mt])),bt.createHref({pathname:Ut,search:Bt,hash:St})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant$1(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect$4(rt){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(rt)}function useNavigate(){let{isDataRoute:rt}=reactExports.useContext(RouteContext);return rt?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant$1(!1);let rt=reactExports.useContext(DataRouterContext),{basename:_,future:ut,navigator:mt}=reactExports.useContext(NavigationContext),{matches:bt}=reactExports.useContext(RouteContext),{pathname:St}=useLocation(),Mt=JSON.stringify(getResolveToMatches(bt,ut.v7_relativeSplatPath)),Bt=reactExports.useRef(!1);return useIsomorphicLayoutEffect$4(()=>{Bt.current=!0}),reactExports.useCallback(function(Ht,tr){if(tr===void 0&&(tr={}),!Bt.current)return;if(typeof Ht=="number"){mt.go(Ht);return}let rr=resolveTo(Ht,JSON.parse(Mt),St,tr.relative==="path");rt==null&&_!=="/"&&(rr.pathname=rr.pathname==="/"?_:joinPaths([_,rr.pathname])),(tr.replace?mt.replace:mt.push)(rr,tr.state,tr)},[_,mt,Mt,St,rt])}const OutletContext=reactExports.createContext(null);function useOutlet(rt){let _=reactExports.useContext(RouteContext).outlet;return _&&reactExports.createElement(OutletContext.Provider,{value:rt},_)}function useResolvedPath(rt,_){let{relative:ut}=_===void 0?{}:_,{future:mt}=reactExports.useContext(NavigationContext),{matches:bt}=reactExports.useContext(RouteContext),{pathname:St}=useLocation(),Mt=JSON.stringify(getResolveToMatches(bt,mt.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(rt,JSON.parse(Mt),St,ut==="path"),[rt,Mt,St,ut])}function useRoutes(rt,_){return useRoutesImpl(rt)}function useRoutesImpl(rt,_,ut,mt){useInRouterContext()||invariant$1(!1);let{navigator:bt}=reactExports.useContext(NavigationContext),{matches:St}=reactExports.useContext(RouteContext),Mt=St[St.length-1],Bt=Mt?Mt.params:{};Mt&&Mt.pathname;let Ut=Mt?Mt.pathnameBase:"/";Mt&&Mt.route;let Ht=useLocation(),tr;tr=Ht;let rr=tr.pathname||"/",sr=rr;if(Ut!=="/"){let Ar=Ut.replace(/^\//,"").split("/");sr="/"+rr.replace(/^\//,"").split("/").slice(Ar.length).join("/")}let ar=matchRoutes(rt,{pathname:sr});return _renderMatches(ar&&ar.map(Ar=>Object.assign({},Ar,{params:Object.assign({},Bt,Ar.params),pathname:joinPaths([Ut,bt.encodeLocation?bt.encodeLocation(Ar.pathname).pathname:Ar.pathname]),pathnameBase:Ar.pathnameBase==="/"?Ut:joinPaths([Ut,bt.encodeLocation?bt.encodeLocation(Ar.pathnameBase).pathname:Ar.pathnameBase])})),St,ut,mt)}function DefaultErrorComponent(){let rt=useRouteError(),_=isRouteErrorResponse(rt)?rt.status+" "+rt.statusText:rt instanceof Error?rt.message:JSON.stringify(rt),ut=rt instanceof Error?rt.stack:null,bt={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},_),ut?reactExports.createElement("pre",{style:bt},ut):null,null)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(_){super(_),this.state={location:_.location,revalidation:_.revalidation,error:_.error}}static getDerivedStateFromError(_){return{error:_}}static getDerivedStateFromProps(_,ut){return ut.location!==_.location||ut.revalidation!=="idle"&&_.revalidation==="idle"?{error:_.error,location:_.location,revalidation:_.revalidation}:{error:_.error!==void 0?_.error:ut.error,location:ut.location,revalidation:_.revalidation||ut.revalidation}}componentDidCatch(_,ut){console.error("React Router caught the following error during render",_,ut)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(rt){let{routeContext:_,match:ut,children:mt}=rt,bt=reactExports.useContext(DataRouterContext);return bt&&bt.static&&bt.staticContext&&(ut.route.errorElement||ut.route.ErrorBoundary)&&(bt.staticContext._deepestRenderedBoundaryId=ut.route.id),reactExports.createElement(RouteContext.Provider,{value:_},mt)}function _renderMatches(rt,_,ut,mt){var bt;if(_===void 0&&(_=[]),ut===void 0&&(ut=null),mt===void 0&&(mt=null),rt==null){var St;if((St=ut)!=null&&St.errors)rt=ut.matches;else return null}let Mt=rt,Bt=(bt=ut)==null?void 0:bt.errors;if(Bt!=null){let tr=Mt.findIndex(rr=>rr.route.id&&(Bt==null?void 0:Bt[rr.route.id])!==void 0);tr>=0||invariant$1(!1),Mt=Mt.slice(0,Math.min(Mt.length,tr+1))}let Ut=!1,Ht=-1;if(ut&&mt&&mt.v7_partialHydration)for(let tr=0;tr<Mt.length;tr++){let rr=Mt[tr];if((rr.route.HydrateFallback||rr.route.hydrateFallbackElement)&&(Ht=tr),rr.route.id){let{loaderData:sr,errors:ar}=ut,cr=rr.route.loader&&sr[rr.route.id]===void 0&&(!ar||ar[rr.route.id]===void 0);if(rr.route.lazy||cr){Ut=!0,Ht>=0?Mt=Mt.slice(0,Ht+1):Mt=[Mt[0]];break}}}return Mt.reduceRight((tr,rr,sr)=>{let ar,cr=!1,Ar=null,_r=null;ut&&(ar=Bt&&rr.route.id?Bt[rr.route.id]:void 0,Ar=rr.route.errorElement||defaultErrorElement,Ut&&(Ht<0&&sr===0?(warningOnce("route-fallback"),cr=!0,_r=null):Ht===sr&&(cr=!0,_r=rr.route.hydrateFallbackElement||null)));let Dr=_.concat(Mt.slice(0,sr+1)),$r=()=>{let Br;return ar?Br=Ar:cr?Br=_r:rr.route.Component?Br=reactExports.createElement(rr.route.Component,null):rr.route.element?Br=rr.route.element:Br=tr,reactExports.createElement(RenderedRoute,{match:rr,routeContext:{outlet:tr,matches:Dr,isDataRoute:ut!=null},children:Br})};return ut&&(rr.route.ErrorBoundary||rr.route.errorElement||sr===0)?reactExports.createElement(RenderErrorBoundary,{location:ut.location,revalidation:ut.revalidation,component:Ar,error:ar,children:$r(),routeContext:{outlet:null,matches:Dr,isDataRoute:!0}}):$r()},null)}var DataRouterHook$1=function(rt){return rt.UseBlocker="useBlocker",rt.UseRevalidator="useRevalidator",rt.UseNavigateStable="useNavigate",rt}(DataRouterHook$1||{}),DataRouterStateHook$1=function(rt){return rt.UseBlocker="useBlocker",rt.UseLoaderData="useLoaderData",rt.UseActionData="useActionData",rt.UseRouteError="useRouteError",rt.UseNavigation="useNavigation",rt.UseRouteLoaderData="useRouteLoaderData",rt.UseMatches="useMatches",rt.UseRevalidator="useRevalidator",rt.UseNavigateStable="useNavigate",rt.UseRouteId="useRouteId",rt}(DataRouterStateHook$1||{});function useDataRouterContext(rt){let _=reactExports.useContext(DataRouterContext);return _||invariant$1(!1),_}function useDataRouterState(rt){let _=reactExports.useContext(DataRouterStateContext);return _||invariant$1(!1),_}function useRouteContext(rt){let _=reactExports.useContext(RouteContext);return _||invariant$1(!1),_}function useCurrentRouteId(rt){let _=useRouteContext(),ut=_.matches[_.matches.length-1];return ut.route.id||invariant$1(!1),ut.route.id}function useRouteError(){var rt;let _=reactExports.useContext(RouteErrorContext),ut=useDataRouterState(DataRouterStateHook$1.UseRouteError),mt=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return _!==void 0?_:(rt=ut.errors)==null?void 0:rt[mt]}function useNavigateStable(){let{router:rt}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),_=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),ut=reactExports.useRef(!1);return useIsomorphicLayoutEffect$4(()=>{ut.current=!0}),reactExports.useCallback(function(bt,St){St===void 0&&(St={}),ut.current&&(typeof bt=="number"?rt.navigate(bt):rt.navigate(bt,_extends$7({fromRouteId:_},St)))},[rt,_])}const alreadyWarned={};function warningOnce(rt,_,ut){alreadyWarned[rt]||(alreadyWarned[rt]=!0)}function Navigate(rt){let{to:_,replace:ut,state:mt,relative:bt}=rt;useInRouterContext()||invariant$1(!1);let{future:St,static:Mt}=reactExports.useContext(NavigationContext),{matches:Bt}=reactExports.useContext(RouteContext),{pathname:Ut}=useLocation(),Ht=useNavigate(),tr=resolveTo(_,getResolveToMatches(Bt,St.v7_relativeSplatPath),Ut,bt==="path"),rr=JSON.stringify(tr);return reactExports.useEffect(()=>Ht(JSON.parse(rr),{replace:ut,state:mt,relative:bt}),[Ht,rr,bt,ut,mt]),null}function Outlet(rt){return useOutlet(rt.context)}function Router(rt){let{basename:_="/",children:ut=null,location:mt,navigationType:bt=Action.Pop,navigator:St,static:Mt=!1,future:Bt}=rt;useInRouterContext()&&invariant$1(!1);let Ut=_.replace(/^\/*/,"/"),Ht=reactExports.useMemo(()=>({basename:Ut,navigator:St,static:Mt,future:_extends$7({v7_relativeSplatPath:!1},Bt)}),[Ut,Bt,St,Mt]);typeof mt=="string"&&(mt=parsePath(mt));let{pathname:tr="/",search:rr="",hash:sr="",state:ar=null,key:cr="default"}=mt,Ar=reactExports.useMemo(()=>{let _r=stripBasename(tr,Ut);return _r==null?null:{location:{pathname:_r,search:rr,hash:sr,state:ar,key:cr},navigationType:bt}},[Ut,tr,rr,sr,ar,cr,bt]);return Ar==null?null:reactExports.createElement(NavigationContext.Provider,{value:Ht},reactExports.createElement(LocationContext.Provider,{children:ut,value:Ar}))}new Promise(()=>{});/**
 * React Router DOM v6.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$6(){return _extends$6=Object.assign?Object.assign.bind():function(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_];for(var mt in ut)Object.prototype.hasOwnProperty.call(ut,mt)&&(rt[mt]=ut[mt])}return rt},_extends$6.apply(this,arguments)}function _objectWithoutPropertiesLoose$5(rt,_){if(rt==null)return{};var ut={},mt=Object.keys(rt),bt,St;for(St=0;St<mt.length;St++)bt=mt[St],!(_.indexOf(bt)>=0)&&(ut[bt]=rt[bt]);return ut}function isModifiedEvent(rt){return!!(rt.metaKey||rt.altKey||rt.ctrlKey||rt.shiftKey)}function shouldProcessLinkClick(rt,_){return rt.button===0&&(!_||_==="_self")&&!isModifiedEvent(rt)}const _excluded$e=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch{}const START_TRANSITION="startTransition",startTransitionImpl=$2AODx$react[START_TRANSITION];function BrowserRouter(rt){let{basename:_,children:ut,future:mt,window:bt}=rt,St=reactExports.useRef();St.current==null&&(St.current=createBrowserHistory({window:bt,v5Compat:!0}));let Mt=St.current,[Bt,Ut]=reactExports.useState({action:Mt.action,location:Mt.location}),{v7_startTransition:Ht}=mt||{},tr=reactExports.useCallback(rr=>{Ht&&startTransitionImpl?startTransitionImpl(()=>Ut(rr)):Ut(rr)},[Ut,Ht]);return reactExports.useLayoutEffect(()=>Mt.listen(tr),[Mt,tr]),reactExports.createElement(Router,{basename:_,children:ut,location:Bt.location,navigationType:Bt.action,navigator:Mt,future:mt})}const isBrowser$2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(_,ut){let{onClick:mt,relative:bt,reloadDocument:St,replace:Mt,state:Bt,target:Ut,to:Ht,preventScrollReset:tr,unstable_viewTransition:rr}=_,sr=_objectWithoutPropertiesLoose$5(_,_excluded$e),{basename:ar}=reactExports.useContext(NavigationContext),cr,Ar=!1;if(typeof Ht=="string"&&ABSOLUTE_URL_REGEX.test(Ht)&&(cr=Ht,isBrowser$2))try{let Br=new URL(window.location.href),Jr=Ht.startsWith("//")?new URL(Br.protocol+Ht):new URL(Ht),mn=stripBasename(Jr.pathname,ar);Jr.origin===Br.origin&&mn!=null?Ht=mn+Jr.search+Jr.hash:Ar=!0}catch{}let _r=useHref(Ht,{relative:bt}),Dr=useLinkClickHandler(Ht,{replace:Mt,state:Bt,target:Ut,preventScrollReset:tr,relative:bt,unstable_viewTransition:rr});function $r(Br){mt&&mt(Br),Br.defaultPrevented||Dr(Br)}return reactExports.createElement("a",_extends$6({},sr,{href:cr||_r,onClick:Ar||St?mt:$r,ref:ut,target:Ut}))});var DataRouterHook;(function(rt){rt.UseScrollRestoration="useScrollRestoration",rt.UseSubmit="useSubmit",rt.UseSubmitFetcher="useSubmitFetcher",rt.UseFetcher="useFetcher",rt.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(rt){rt.UseFetcher="useFetcher",rt.UseFetchers="useFetchers",rt.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(rt,_){let{target:ut,replace:mt,state:bt,preventScrollReset:St,relative:Mt,unstable_viewTransition:Bt}=_===void 0?{}:_,Ut=useNavigate(),Ht=useLocation(),tr=useResolvedPath(rt,{relative:Mt});return reactExports.useCallback(rr=>{if(shouldProcessLinkClick(rr,ut)){rr.preventDefault();let sr=mt!==void 0?mt:createPath(Ht)===createPath(tr);Ut(rt,{replace:sr,state:bt,preventScrollReset:St,relative:Mt,unstable_viewTransition:Bt})}},[Ht,Ut,tr,mt,bt,ut,rt,St,Mt,Bt])}const navContainer="_navContainer_b1qht_2",tabs="_tabs_b1qht_12",tab="_tab_b1qht_12",active="_active_b1qht_30",tabY="_tabY_b1qht_34",optional$1="_optional_b1qht_46",divider="_divider_b1qht_49",styles$3={navContainer,tabs,tab,active,tabY,optional:optional$1,divider};var define_import_meta_env_default$1={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};let keyCount=0;function atom(rt,_){const ut=`atom${++keyCount}`,mt={toString:()=>ut};return typeof rt=="function"?mt.read=rt:(mt.init=rt,mt.read=defaultRead,mt.write=defaultWrite),mt}function defaultRead(rt){return rt(this)}function defaultWrite(rt,_,ut){return _(this,typeof ut=="function"?ut(rt(this)):ut)}const isSelfAtom=(rt,_)=>rt.unstable_is?rt.unstable_is(_):_===rt,hasInitialValue=rt=>"init"in rt,isActuallyWritableAtom=rt=>!!rt.write,cancelPromiseMap=new WeakMap,registerCancelPromise=(rt,_)=>{cancelPromiseMap.set(rt,_),rt.catch(()=>{}).finally(()=>cancelPromiseMap.delete(rt))},cancelPromise=(rt,_)=>{const ut=cancelPromiseMap.get(rt);ut&&(cancelPromiseMap.delete(rt),ut(_))},resolvePromise=(rt,_)=>{rt.status="fulfilled",rt.value=_},rejectPromise=(rt,_)=>{rt.status="rejected",rt.reason=_},isPromiseLike$1=rt=>typeof(rt==null?void 0:rt.then)=="function",isEqualAtomValue=(rt,_)=>!!rt&&"v"in rt&&"v"in _&&Object.is(rt.v,_.v),isEqualAtomError=(rt,_)=>!!rt&&"e"in rt&&"e"in _&&Object.is(rt.e,_.e),hasPromiseAtomValue=rt=>!!rt&&"v"in rt&&rt.v instanceof Promise,isEqualPromiseAtomValue=(rt,_)=>"v"in rt&&"v"in _&&rt.v.orig&&rt.v.orig===_.v.orig,returnAtomValue=rt=>{if("e"in rt)throw rt.e;return rt.v},createStore$1$1=()=>{const rt=new WeakMap,_=new WeakMap,ut=[],mt=new WeakMap;let bt,St;(define_import_meta_env_default$1?"production":void 0)!=="production"&&(bt=new Set,St=new Set);const Mt=en=>rt.get(en),Bt=(en,In)=>{In.d.forEach((Rn,qn)=>{var Qn;if(!mt.has(qn)){const xs=Mt(qn);(Qn=ut[ut.length-1])==null||Qn.add(qn),mt.set(qn,[xs,new Set]),xs&&Bt(qn,xs)}mt.get(qn)[1].add(en)})},Ut=(en,In)=>{var Rn;(define_import_meta_env_default$1?"production":void 0)!=="production"&&Object.freeze(In);const qn=Mt(en);if(rt.set(en,In),mt.has(en)||((Rn=ut[ut.length-1])==null||Rn.add(en),mt.set(en,[qn,new Set]),Bt(en,In)),hasPromiseAtomValue(qn)){const Qn="v"in In?In.v instanceof Promise?In.v:Promise.resolve(In.v):Promise.reject(In.e);qn.v!==Qn&&cancelPromise(qn.v,Qn)}},Ht=(en,In,Rn,qn)=>{const Qn=new Map(qn?In.d:null);let xs=!1;Rn.forEach((cs,ks)=>{!cs&&isSelfAtom(en,ks)&&(cs=In),cs?(Qn.set(ks,cs),In.d.get(ks)!==cs&&(xs=!0)):(define_import_meta_env_default$1?"production":void 0)!=="production"&&console.warn("[Bug] atom state not found")}),(xs||In.d.size!==Qn.size)&&(In.d=Qn)},tr=(en,In,Rn,qn)=>{const Qn=Mt(en),xs={d:(Qn==null?void 0:Qn.d)||new Map,v:In};if(Rn&&Ht(en,xs,Rn,qn),isEqualAtomValue(Qn,xs)&&Qn.d===xs.d)return Qn;if(hasPromiseAtomValue(Qn)&&hasPromiseAtomValue(xs)&&isEqualPromiseAtomValue(Qn,xs)){if(Qn.d===xs.d)return Qn;xs.v=Qn.v}return Ut(en,xs),xs},rr=(en,In,Rn,qn)=>{if(isPromiseLike$1(In)){let Qn;const xs=()=>{const ks=Mt(en);if(!hasPromiseAtomValue(ks)||ks.v!==cs)return;const _o=tr(en,cs,Rn);_.has(en)&&ks.d!==_o.d&&mn(en,_o,ks.d)},cs=new Promise((ks,_o)=>{let qs=!1;In.then(Ss=>{qs||(qs=!0,resolvePromise(cs,Ss),ks(Ss),xs())},Ss=>{qs||(qs=!0,rejectPromise(cs,Ss),_o(Ss),xs())}),Qn=Ss=>{qs||(qs=!0,Ss.then(eo=>resolvePromise(cs,eo),eo=>rejectPromise(cs,eo)),ks(Ss))}});return cs.orig=In,cs.status="pending",registerCancelPromise(cs,ks=>{ks&&Qn(ks),qn==null||qn()}),tr(en,cs,Rn,!0)}return tr(en,In,Rn)},sr=(en,In,Rn)=>{const qn=Mt(en),Qn={d:(qn==null?void 0:qn.d)||new Map,e:In};return Rn&&Ht(en,Qn,Rn),isEqualAtomError(qn,Qn)&&qn.d===Qn.d?qn:(Ut(en,Qn),Qn)},ar=(en,In)=>{const Rn=Mt(en);if(!In&&Rn&&(_.has(en)||Array.from(Rn.d).every(([qs,Ss])=>{if(qs===en)return!0;const eo=ar(qs);return eo===Ss||isEqualAtomValue(eo,Ss)})))return Rn;const qn=new Map;let Qn=!0;const xs=qs=>{if(isSelfAtom(en,qs)){const eo=Mt(qs);if(eo)return qn.set(qs,eo),returnAtomValue(eo);if(hasInitialValue(qs))return qn.set(qs,void 0),qs.init;throw new Error("no atom init")}const Ss=ar(qs);return qn.set(qs,Ss),returnAtomValue(Ss)};let cs,ks;const _o={get signal(){return cs||(cs=new AbortController),cs.signal},get setSelf(){return(define_import_meta_env_default$1?"production":void 0)!=="production"&&!isActuallyWritableAtom(en)&&console.warn("setSelf function cannot be used with read-only atom"),!ks&&isActuallyWritableAtom(en)&&(ks=(...qs)=>{if((define_import_meta_env_default$1?"production":void 0)!=="production"&&Qn&&console.warn("setSelf function cannot be called in sync"),!Qn)return Dr(en,...qs)}),ks}};try{const qs=en.read(xs,_o);return rr(en,qs,qn,()=>cs==null?void 0:cs.abort())}catch(qs){return sr(en,qs,qn)}finally{Qn=!1}},cr=en=>returnAtomValue(ar(en)),Ar=en=>{const In=cs=>{var ks,_o;const qs=new Set((ks=_.get(cs))==null?void 0:ks.t);return(_o=mt.get(cs))==null||_o[1].forEach(Ss=>{qs.add(Ss)}),qs},Rn=new Array,qn=new Set,Qn=cs=>{if(!qn.has(cs)){qn.add(cs);for(const ks of In(cs))cs!==ks&&Qn(ks);Rn.push(cs)}};Qn(en);const xs=new Set([en]);for(let cs=Rn.length-1;cs>=0;--cs){const ks=Rn[cs],_o=Mt(ks);if(!_o)continue;let qs=!1;for(const Ss of _o.d.keys())if(Ss!==ks&&xs.has(Ss)){qs=!0;break}if(qs){const Ss=ar(ks,!0);isEqualAtomValue(_o,Ss)||xs.add(ks)}}},_r=(en,...In)=>{const Rn=xs=>returnAtomValue(ar(xs)),qn=(xs,...cs)=>{const ks=ut.length>0;ks||ut.push(new Set([xs]));let _o;if(isSelfAtom(en,xs)){if(!hasInitialValue(xs))throw new Error("atom not writable");const qs=Mt(xs),Ss=rr(xs,cs[0]);isEqualAtomValue(qs,Ss)||Ar(xs)}else _o=_r(xs,...cs);if(!ks){const qs=Mn(ut.pop());(define_import_meta_env_default$1?"production":void 0)!=="production"&&bt.forEach(Ss=>Ss({type:"async-write",flushed:qs}))}return _o};return en.write(Rn,qn,...In)},Dr=(en,...In)=>{ut.push(new Set([en]));const Rn=_r(en,...In),qn=Mn(ut.pop());return(define_import_meta_env_default$1?"production":void 0)!=="production"&&bt.forEach(Qn=>Qn({type:"write",flushed:qn})),Rn},$r=(en,In,Rn)=>{var qn;const Qn=_.get(en);if(Qn)return In&&Qn.t.add(In),Qn;const xs=Rn||[];(qn=Mt(en))==null||qn.d.forEach((ks,_o)=>{_o!==en&&$r(_o,en,xs)}),ar(en);const cs={t:new Set(In&&[In]),l:new Set};if(_.set(en,cs),(define_import_meta_env_default$1?"production":void 0)!=="production"&&St.add(en),isActuallyWritableAtom(en)&&en.onMount){const{onMount:ks}=en;xs.push(()=>{const _o=ks((...qs)=>Dr(en,...qs));_o&&(cs.u=_o)})}return Rn||xs.forEach(ks=>ks()),cs},Br=(en,In)=>!In.l.size&&(!In.t.size||In.t.size===1&&In.t.has(en)),Jr=(en,In)=>{if(!Br(en,In))return;const Rn=In.u;Rn&&Rn(),_.delete(en),(define_import_meta_env_default$1?"production":void 0)!=="production"&&St.delete(en);const qn=Mt(en);qn?(hasPromiseAtomValue(qn)&&cancelPromise(qn.v),qn.d.forEach((Qn,xs)=>{if(xs!==en){const cs=_.get(xs);cs&&(cs.t.delete(en),Jr(xs,cs))}})):(define_import_meta_env_default$1?"production":void 0)!=="production"&&console.warn("[Bug] could not find atom state to unmount",en)},mn=(en,In,Rn)=>{const qn=new Set(In.d.keys()),Qn=new Set;Rn==null||Rn.forEach((xs,cs)=>{if(qn.has(cs)){qn.delete(cs);return}Qn.add(cs);const ks=_.get(cs);ks&&ks.t.delete(en)}),qn.forEach(xs=>{$r(xs,en)}),Qn.forEach(xs=>{const cs=_.get(xs);cs&&Jr(xs,cs)})},Mn=en=>{let In;(define_import_meta_env_default$1?"production":void 0)!=="production"&&(In=new Set);const Rn=[],qn=Qn=>{var xs;if(!mt.has(Qn))return;const[cs,ks]=mt.get(Qn);mt.delete(Qn),Rn.push([Qn,cs]),ks.forEach(qn),(xs=Mt(Qn))==null||xs.d.forEach((_o,qs)=>qn(qs))};if(en.forEach(qn),Rn.forEach(([Qn,xs])=>{const cs=Mt(Qn);if(!cs){(define_import_meta_env_default$1?"production":void 0)!=="production"&&console.warn("[Bug] no atom state to flush");return}if(cs!==xs){const ks=_.get(Qn);ks&&cs.d!==(xs==null?void 0:xs.d)&&mn(Qn,cs,xs==null?void 0:xs.d),ks&&!(!hasPromiseAtomValue(xs)&&(isEqualAtomValue(xs,cs)||isEqualAtomError(xs,cs)))&&(ks.l.forEach(_o=>_o()),(define_import_meta_env_default$1?"production":void 0)!=="production"&&In.add(Qn))}}),(define_import_meta_env_default$1?"production":void 0)!=="production")return In},$n=(en,In)=>{const Rn=$r(en),qn=Mn([en]),Qn=Rn.l;return Qn.add(In),(define_import_meta_env_default$1?"production":void 0)!=="production"&&bt.forEach(xs=>xs({type:"sub",flushed:qn})),()=>{Qn.delete(In),Jr(en,Rn),(define_import_meta_env_default$1?"production":void 0)!=="production"&&bt.forEach(xs=>xs({type:"unsub"}))}};return(define_import_meta_env_default$1?"production":void 0)!=="production"?{get:cr,set:Dr,sub:$n,dev_subscribe_store:en=>(bt.add(en),()=>{bt.delete(en)}),dev_get_mounted_atoms:()=>St.values(),dev_get_atom_state:en=>rt.get(en),dev_get_mounted:en=>_.get(en),dev_restore_atoms:en=>{ut.push(new Set);for(const[Rn,qn]of en)hasInitialValue(Rn)&&(rr(Rn,qn),Ar(Rn));const In=Mn(ut.pop());bt.forEach(Rn=>Rn({type:"restore",flushed:In}))}}:{get:cr,set:Dr,sub:$n}};let defaultStore;const getDefaultStore$1=()=>(defaultStore||(defaultStore=createStore$1$1(),(define_import_meta_env_default$1?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=defaultStore),globalThis.__JOTAI_DEFAULT_STORE__!==defaultStore&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),defaultStore),getDefaultStore=getDefaultStore$1;var define_import_meta_env_default={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const StoreContext$1=reactExports.createContext(void 0),useStore$1=rt=>reactExports.useContext(StoreContext$1)||getDefaultStore(),isPromiseLike=rt=>typeof(rt==null?void 0:rt.then)=="function",use=React.use||(rt=>{if(rt.status==="pending")throw rt;if(rt.status==="fulfilled")return rt.value;throw rt.status==="rejected"?rt.reason:(rt.status="pending",rt.then(_=>{rt.status="fulfilled",rt.value=_},_=>{rt.status="rejected",rt.reason=_}),rt)});function useAtomValue(rt,_){const ut=useStore$1(),[[mt,bt,St],Mt]=reactExports.useReducer(Ht=>{const tr=ut.get(rt);return Object.is(Ht[0],tr)&&Ht[1]===ut&&Ht[2]===rt?Ht:[tr,ut,rt]},void 0,()=>[ut.get(rt),ut,rt]);let Bt=mt;return(bt!==ut||St!==rt)&&(Mt(),Bt=ut.get(rt)),reactExports.useEffect(()=>{const Ht=ut.sub(rt,()=>{Mt()});return Mt(),Ht},[ut,rt,void 0]),reactExports.useDebugValue(Bt),isPromiseLike(Bt)?use(Bt):Bt}function useSetAtom(rt,_){const ut=useStore$1();return reactExports.useCallback((...bt)=>{if((define_import_meta_env_default?"production":void 0)!=="production"&&!("write"in rt))throw new Error("not writable atom");return ut.set(rt,...bt)},[ut,rt])}function useAtom(rt,_){return[useAtomValue(rt),useSetAtom(rt)]}const setProjectShow=atom(!1),setTab=atom(0),Avatar=()=>jsxRuntimeExports.jsx("div",{style:{marginLeft:"10px",marginRight:"10px",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},children:jsxRuntimeExports.jsxs("svg",{width:"58",height:"17",viewBox:"0 0 58 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M0 13.3077V0.179487H2.88924V11.0192H8.74779V13.3077H0Z",fill:"#ADD8E6"}),jsxRuntimeExports.jsx("path",{d:"M15.9392 13.5962C14.7915 13.5919 13.804 13.3205 12.9766 12.7821C12.1536 12.2436 11.5197 11.4637 11.0749 10.4423C10.6345 9.42094 10.4165 8.19231 10.4209 6.75641C10.4209 5.32479 10.6411 4.1047 11.0815 3.09615C11.5264 2.08761 12.1603 1.32051 12.9832 0.794872C13.8106 0.264957 14.796 0 15.9392 0C17.0824 0 18.0655 0.264957 18.8885 0.794872C19.7159 1.32479 20.352 2.09402 20.7969 3.10256C21.2417 4.10684 21.4619 5.32479 21.4574 6.75641C21.4574 8.19658 21.235 9.42735 20.7902 10.4487C20.3498 11.4701 19.7181 12.25 18.8952 12.7885C18.0722 13.3269 17.0869 13.5962 15.9392 13.5962ZM15.9392 11.2949C16.7221 11.2949 17.3471 10.9167 17.8142 10.1603C18.2813 9.40385 18.5126 8.26923 18.5082 6.75641C18.5082 5.76068 18.4014 4.93162 18.1879 4.26923C17.9788 3.60684 17.6808 3.10897 17.2937 2.77564C16.9112 2.44231 16.4597 2.27564 15.9392 2.27564C15.1607 2.27564 14.538 2.64957 14.0709 3.39744C13.6038 4.1453 13.368 5.26496 13.3636 6.75641C13.3636 7.76496 13.4681 8.60684 13.6772 9.28205C13.8907 9.95299 14.191 10.4573 14.578 10.7949C14.965 11.1282 15.4187 11.2949 15.9392 11.2949Z",fill:"#ADD8E6"}),jsxRuntimeExports.jsx("path",{d:"M28.1751 13.5C27.1386 13.5 26.2423 13.2885 25.486 12.8654C24.7343 12.438 24.1537 11.844 23.7445 11.0833C23.3352 10.3184 23.1306 9.43162 23.1306 8.42308C23.1306 7.40598 23.3352 6.51709 23.7445 5.75641C24.1537 4.99145 24.7343 4.39744 25.486 3.97436C26.2423 3.54701 27.1386 3.33333 28.1751 3.33333C29.2116 3.33333 30.1057 3.54701 30.8575 3.97436C31.6137 4.39744 32.1965 4.99145 32.6057 5.75641C33.015 6.51709 33.2196 7.40598 33.2196 8.42308C33.2196 9.43162 33.015 10.3184 32.6057 11.0833C32.1965 11.844 31.6137 12.438 30.8575 12.8654C30.1057 13.2885 29.2116 13.5 28.1751 13.5ZM28.1884 11.3846C28.66 11.3846 29.0537 11.2564 29.3695 11C29.6853 10.7393 29.9233 10.3846 30.0835 9.9359C30.2481 9.48718 30.3304 8.9765 30.3304 8.40385C30.3304 7.8312 30.2481 7.32051 30.0835 6.8718C29.9233 6.42308 29.6853 6.06838 29.3695 5.80769C29.0537 5.54701 28.66 5.41667 28.1884 5.41667C27.7125 5.41667 27.3121 5.54701 26.9874 5.80769C26.6671 6.06838 26.4247 6.42308 26.2601 6.8718C26.0999 7.32051 26.0198 7.8312 26.0198 8.40385C26.0198 8.9765 26.0999 9.48718 26.2601 9.9359C26.4247 10.3846 26.6671 10.7393 26.9874 11C27.3121 11.2564 27.7125 11.3846 28.1884 11.3846Z",fill:"#ADD8E6"}),jsxRuntimeExports.jsx("path",{d:"M40.3993 13.5962C39.2516 13.5919 38.2641 13.3205 37.4367 12.7821C36.6137 12.2436 35.9798 11.4637 35.535 10.4423C35.0946 9.42094 34.8766 8.19231 34.8811 6.75641C34.8811 5.32479 35.1013 4.1047 35.5417 3.09615C35.9865 2.08761 36.6204 1.32051 37.4434 0.794872C38.2708 0.264957 39.2561 0 40.3993 0C41.5426 0 42.5257 0.264957 43.3486 0.794872C44.176 1.32479 44.8121 2.09402 45.257 3.10256C45.7018 4.10684 45.922 5.32479 45.9176 6.75641C45.9176 8.19658 45.6952 9.42735 45.2503 10.4487C44.8099 11.4701 44.1782 12.25 43.3553 12.7885C42.5323 13.3269 41.547 13.5962 40.3993 13.5962ZM40.3993 11.2949C41.1822 11.2949 41.8072 10.9167 42.2743 10.1603C42.7414 9.40385 42.9727 8.26923 42.9683 6.75641C42.9683 5.76068 42.8615 4.93162 42.648 4.26923C42.4389 3.60684 42.1409 3.10897 41.7539 2.77564C41.3713 2.44231 40.9198 2.27564 40.3993 2.27564C39.6209 2.27564 38.9981 2.64957 38.531 3.39744C38.0639 4.1453 37.8281 5.26496 37.8237 6.75641C37.8237 7.76496 37.9282 8.60684 38.1373 9.28205C38.3508 9.95299 38.6511 10.4573 39.0381 10.7949C39.4251 11.1282 39.8789 11.2949 40.3993 11.2949Z",fill:"#ADD8E6"}),jsxRuntimeExports.jsx("path",{d:"M48.0044 17V3.46154H50.8069V5.11538H50.9337C51.0583 4.85043 51.2384 4.5812 51.4742 4.30769C51.7144 4.02991 52.0258 3.79915 52.4084 3.61538C52.7954 3.42735 53.2758 3.33333 53.8496 3.33333C54.597 3.33333 55.2865 3.52137 55.9181 3.89744C56.5498 4.26923 57.0547 4.8312 57.4328 5.58333C57.8109 6.3312 58 7.26923 58 8.39744C58 9.49573 57.8154 10.4231 57.4462 11.1795C57.0814 11.9316 56.5832 12.5021 55.9515 12.891C55.3243 13.2756 54.6214 13.4679 53.843 13.4679C53.2914 13.4679 52.8221 13.3803 52.435 13.2051C52.0525 13.0299 51.7389 12.8098 51.4942 12.5449C51.2495 12.2756 51.0627 12.0043 50.9337 11.7308H50.847V17H48.0044ZM50.7869 8.38462C50.7869 8.97009 50.8714 9.48077 51.0405 9.91667C51.2095 10.3526 51.4542 10.6923 51.7745 10.9359C52.0947 11.1752 52.484 11.2949 52.9422 11.2949C53.4048 11.2949 53.7963 11.1731 54.1165 10.9295C54.4368 10.6816 54.6793 10.3397 54.8439 9.90385C55.0129 9.46368 55.0974 8.95726 55.0974 8.38462C55.0974 7.81624 55.0151 7.31624 54.8505 6.88462C54.6859 6.45299 54.4435 6.11538 54.1232 5.87179C53.8029 5.62821 53.4092 5.50641 52.9422 5.50641C52.4795 5.50641 52.0881 5.62393 51.7678 5.85897C51.4519 6.09402 51.2095 6.42735 51.0405 6.85897C50.8714 7.2906 50.7869 7.79915 50.7869 8.38462Z",fill:"#ADD8E6"})]})});var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(rt){(function(){var _={}.hasOwnProperty;function ut(){for(var St="",Mt=0;Mt<arguments.length;Mt++){var Bt=arguments[Mt];Bt&&(St=bt(St,mt(Bt)))}return St}function mt(St){if(typeof St=="string"||typeof St=="number")return St;if(typeof St!="object")return"";if(Array.isArray(St))return ut.apply(null,St);if(St.toString!==Object.prototype.toString&&!St.toString.toString().includes("[native code]"))return St.toString();var Mt="";for(var Bt in St)_.call(St,Bt)&&St[Bt]&&(Mt=bt(Mt,Bt));return Mt}function bt(St,Mt){return Mt?St?St+" "+Mt:St+Mt:St}rt.exports?(ut.default=ut,rt.exports=ut):window.classNames=ut})()})(classnames);var classnamesExports=classnames.exports;const cx$1=getDefaultExportFromCjs(classnamesExports),NavBar=()=>{const rt=["Home","Projects","Chat"],_=["Login","Setting"],[ut,mt]=useAtom(setTab),[bt,St]=reactExports.useState(!1),Mt=()=>{St(!bt),console.log(bt)};reactExports.useEffect(()=>{const Ht=localStorage.getItem("activeTabIndex");Ht&&mt(parseInt(Ht))},[]);const[,Bt]=useAtom(setProjectShow),Ut=Ht=>{mt(Ht),localStorage.setItem("activeTabIndex",Ht.toString()),St(!1),console.log("clicked the tab",Ht),setProjectShow&&(Bt(!setProjectShow),console.log("state Changed",setProjectShow))};return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{className:styles$3.navContainer,children:[jsxRuntimeExports.jsxs("div",{className:styles$3.tabs,children:[jsxRuntimeExports.jsx(Avatar,{}),rt.map((Ht,tr)=>jsxRuntimeExports.jsx(Link,{to:`/${Ht.toLowerCase()}`,className:`${styles$3.tab} ${tr===ut?styles$3.active:""}`,onClick:()=>{Ut(tr),Mt()},children:Ht},Ht))]}),jsxRuntimeExports.jsxs("div",{className:cx$1(styles$3.tabs,styles$3.optional),children:[jsxRuntimeExports.jsx("div",{className:styles$3.divider,children:"|"}),jsxRuntimeExports.jsx("div",{className:styles$3.tabs,children:_.map(Ht=>jsxRuntimeExports.jsx("div",{className:styles$3.tabY,children:Ht},Ht))})]})]})})};var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function rt(mt,bt,St,Mt,Bt,Ut){if(Ut!==ReactPropTypesSecret){var Ht=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw Ht.name="Invariant Violation",Ht}}rt.isRequired=rt;function _(){return rt}var ut={array:rt,bigint:rt,bool:rt,func:rt,number:rt,object:rt,string:rt,symbol:rt,any:rt,arrayOf:_,element:rt,elementType:rt,instanceOf:_,node:rt,objectOf:_,oneOf:_,oneOfType:_,shape:_,exact:_,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return ut.PropTypes=ut,ut};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs(propTypesExports);var _excluded$d=["color","size","title","className"];function _extends$5(){return _extends$5=Object.assign||function(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_];for(var mt in ut)Object.prototype.hasOwnProperty.call(ut,mt)&&(rt[mt]=ut[mt])}return rt},_extends$5.apply(this,arguments)}function _objectWithoutProperties$3(rt,_){if(rt==null)return{};var ut=_objectWithoutPropertiesLoose$4(rt,_),mt,bt;if(Object.getOwnPropertySymbols){var St=Object.getOwnPropertySymbols(rt);for(bt=0;bt<St.length;bt++)mt=St[bt],!(_.indexOf(mt)>=0)&&Object.prototype.propertyIsEnumerable.call(rt,mt)&&(ut[mt]=rt[mt])}return ut}function _objectWithoutPropertiesLoose$4(rt,_){if(rt==null)return{};var ut={},mt=Object.keys(rt),bt,St;for(St=0;St<mt.length;St++)bt=mt[St],!(_.indexOf(bt)>=0)&&(ut[bt]=rt[bt]);return ut}var ArrowRightCircle=reactExports.forwardRef(function(rt,_){var ut=rt.color,mt=rt.size,bt=rt.title,St=rt.className,Mt=_objectWithoutProperties$3(rt,_excluded$d);return React.createElement("svg",_extends$5({ref:_,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:mt,height:mt,fill:ut,className:["bi","bi-arrow-right-circle",St].filter(Boolean).join(" ")},Mt),bt?React.createElement("title",null,bt):null,React.createElement("path",{fillRule:"evenodd",d:"M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M4.5 7.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5z"}))});ArrowRightCircle.propTypes={color:PropTypes.string,size:PropTypes.oneOfType([PropTypes.string,PropTypes.number]),title:PropTypes.string,className:PropTypes.string};ArrowRightCircle.defaultProps={color:"currentColor",size:"1em",title:null,className:""};const homeContainer="_homeContainer_luw50_2",textContainer="_textContainer_luw50_9",tagline="_tagline_luw50_17",bigTitle="_bigTitle_luw50_27",description="_description_luw50_36",aniButton="_aniButton_luw50_43",styles$2={homeContainer,textContainer,tagline,bigTitle,description,aniButton};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(rt,_){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ut,mt){ut.__proto__=mt}||function(ut,mt){for(var bt in mt)Object.prototype.hasOwnProperty.call(mt,bt)&&(ut[bt]=mt[bt])})(rt,_)};function __extends(rt,_){if(typeof _!="function"&&_!==null)throw new TypeError("Class extends value "+String(_)+" is not a constructor or null");function ut(){this.constructor=rt}extendStatics(rt,_),rt.prototype=_===null?Object.create(_):(ut.prototype=_.prototype,new ut)}var __assign=function(){return(__assign=Object.assign||function(rt){for(var _,ut=1,mt=arguments.length;ut<mt;ut++)for(var bt in _=arguments[ut])Object.prototype.hasOwnProperty.call(_,bt)&&(rt[bt]=_[bt]);return rt}).apply(this,arguments)};function __awaiter$1(rt,_,ut,mt){return new(ut||(ut=Promise))(function(bt,St){function Mt(Ht){try{Ut(mt.next(Ht))}catch(tr){St(tr)}}function Bt(Ht){try{Ut(mt.throw(Ht))}catch(tr){St(tr)}}function Ut(Ht){var tr;Ht.done?bt(Ht.value):(tr=Ht.value,tr instanceof ut?tr:new ut(function(rr){rr(tr)})).then(Mt,Bt)}Ut((mt=mt.apply(rt,[])).next())})}function __generator$1(rt,_){var ut,mt,bt,St,Mt={label:0,sent:function(){if(1&bt[0])throw bt[1];return bt[1]},trys:[],ops:[]};return St={next:Bt(0),throw:Bt(1),return:Bt(2)},typeof Symbol=="function"&&(St[Symbol.iterator]=function(){return this}),St;function Bt(Ut){return function(Ht){return function(tr){if(ut)throw new TypeError("Generator is already executing.");for(;Mt;)try{if(ut=1,mt&&(bt=2&tr[0]?mt.return:tr[0]?mt.throw||((bt=mt.return)&&bt.call(mt),0):mt.next)&&!(bt=bt.call(mt,tr[1])).done)return bt;switch(mt=0,bt&&(tr=[2&tr[0],bt.value]),tr[0]){case 0:case 1:bt=tr;break;case 4:return Mt.label++,{value:tr[1],done:!1};case 5:Mt.label++,mt=tr[1],tr=[0];continue;case 7:tr=Mt.ops.pop(),Mt.trys.pop();continue;default:if(bt=Mt.trys,!((bt=bt.length>0&&bt[bt.length-1])||tr[0]!==6&&tr[0]!==2)){Mt=0;continue}if(tr[0]===3&&(!bt||tr[1]>bt[0]&&tr[1]<bt[3])){Mt.label=tr[1];break}if(tr[0]===6&&Mt.label<bt[1]){Mt.label=bt[1],bt=tr;break}if(bt&&Mt.label<bt[2]){Mt.label=bt[2],Mt.ops.push(tr);break}bt[2]&&Mt.ops.pop(),Mt.trys.pop();continue}tr=_.call(rt,Mt)}catch(rr){tr=[6,rr],mt=0}finally{ut=bt=0}if(5&tr[0])throw tr[1];return{value:tr[0]?tr[1]:void 0,done:!0}}([Ut,Ht])}}}function createCommonjsModule(rt,_){return rt(_={exports:{}},_.exports),_.exports}var lottie=createCommonjsModule(function(module,exports){typeof navigator<"u"&&function(rt,_){module.exports=_()}(0,function(){var svgNS="http://www.w3.org/2000/svg",locationHref="",_useWebWorker=!1,initialDefaultFrame=-999999,setWebWorker=function(rt){_useWebWorker=!!rt},getWebWorker=function(){return _useWebWorker},setLocationHref=function(rt){locationHref=rt},getLocationHref=function(){return locationHref};function createTag(rt){return document.createElement(rt)}function extendPrototype(rt,_){var ut,mt,bt=rt.length;for(ut=0;ut<bt;ut+=1)for(var St in mt=rt[ut].prototype)Object.prototype.hasOwnProperty.call(mt,St)&&(_.prototype[St]=mt[St])}function getDescriptor(rt,_){return Object.getOwnPropertyDescriptor(rt,_)}function createProxyFunction(rt){function _(){}return _.prototype=rt,_}var audioControllerFactory=function(){function rt(_){this.audios=[],this.audioFactory=_,this._volume=1,this._isMuted=!1}return rt.prototype={addAudio:function(_){this.audios.push(_)},pause:function(){var _,ut=this.audios.length;for(_=0;_<ut;_+=1)this.audios[_].pause()},resume:function(){var _,ut=this.audios.length;for(_=0;_<ut;_+=1)this.audios[_].resume()},setRate:function(_){var ut,mt=this.audios.length;for(ut=0;ut<mt;ut+=1)this.audios[ut].setRate(_)},createAudio:function(_){return this.audioFactory?this.audioFactory(_):window.Howl?new window.Howl({src:[_]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(_){this.audioFactory=_},setVolume:function(_){this._volume=_,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var _,ut=this.audios.length;for(_=0;_<ut;_+=1)this.audios[_].volume(this._volume*(this._isMuted?0:1))}},function(){return new rt}}(),createTypedArray=function(){function rt(_,ut){var mt,bt=0,St=[];switch(_){case"int16":case"uint8c":mt=1;break;default:mt=1.1}for(bt=0;bt<ut;bt+=1)St.push(mt);return St}return typeof Uint8ClampedArray=="function"&&typeof Float32Array=="function"?function(_,ut){return _==="float32"?new Float32Array(ut):_==="int16"?new Int16Array(ut):_==="uint8c"?new Uint8ClampedArray(ut):rt(_,ut)}:rt}();function createSizedArray(rt){return Array.apply(null,{length:rt})}function _typeof$6(rt){return(_typeof$6=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(rt)}var subframeEnabled=!0,expressionsPlugin=null,expressionsInterfaces=null,idPrefix$1="",isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};(function(){var rt,_=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],ut=_.length;for(rt=0;rt<ut;rt+=1)BMMath[_[rt]]=Math[_[rt]]})(),BMMath.random=Math.random,BMMath.abs=function(rt){if(_typeof$6(rt)==="object"&&rt.length){var _,ut=createSizedArray(rt.length),mt=rt.length;for(_=0;_<mt;_+=1)ut[_]=Math.abs(rt[_]);return ut}return Math.abs(rt)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function styleDiv(rt){rt.style.position="absolute",rt.style.top=0,rt.style.left=0,rt.style.display="block",rt.style.transformOrigin="0 0",rt.style.webkitTransformOrigin="0 0",rt.style.backfaceVisibility="visible",rt.style.webkitBackfaceVisibility="visible",rt.style.transformStyle="preserve-3d",rt.style.webkitTransformStyle="preserve-3d",rt.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(rt,_,ut,mt){this.type=rt,this.currentTime=_,this.totalTime=ut,this.direction=mt<0?-1:1}function BMCompleteEvent(rt,_){this.type=rt,this.direction=_<0?-1:1}function BMCompleteLoopEvent(rt,_,ut,mt){this.type=rt,this.currentLoop=ut,this.totalLoops=_,this.direction=mt<0?-1:1}function BMSegmentStartEvent(rt,_,ut){this.type=rt,this.firstFrame=_,this.totalFrames=ut}function BMDestroyEvent(rt,_){this.type=rt,this.target=_}function BMRenderFrameErrorEvent(rt,_){this.type="renderFrameError",this.nativeError=rt,this.currentTime=_}function BMConfigErrorEvent(rt){this.type="configError",this.nativeError=rt}var createElementID=(_count=0,function(){return idPrefix$1+"__lottie_element_"+(_count+=1)}),_count;function HSVtoRGB(rt,_,ut){var mt,bt,St,Mt,Bt,Ut,Ht,tr;switch(Ut=ut*(1-_),Ht=ut*(1-(Bt=6*rt-(Mt=Math.floor(6*rt)))*_),tr=ut*(1-(1-Bt)*_),Mt%6){case 0:mt=ut,bt=tr,St=Ut;break;case 1:mt=Ht,bt=ut,St=Ut;break;case 2:mt=Ut,bt=ut,St=tr;break;case 3:mt=Ut,bt=Ht,St=ut;break;case 4:mt=tr,bt=Ut,St=ut;break;case 5:mt=ut,bt=Ut,St=Ht}return[mt,bt,St]}function RGBtoHSV(rt,_,ut){var mt,bt=Math.max(rt,_,ut),St=Math.min(rt,_,ut),Mt=bt-St,Bt=bt===0?0:Mt/bt,Ut=bt/255;switch(bt){case St:mt=0;break;case rt:mt=_-ut+Mt*(_<ut?6:0),mt/=6*Mt;break;case _:mt=ut-rt+2*Mt,mt/=6*Mt;break;case ut:mt=rt-_+4*Mt,mt/=6*Mt}return[mt,Bt,Ut]}function addSaturationToRGB(rt,_){var ut=RGBtoHSV(255*rt[0],255*rt[1],255*rt[2]);return ut[1]+=_,ut[1]>1?ut[1]=1:ut[1]<=0&&(ut[1]=0),HSVtoRGB(ut[0],ut[1],ut[2])}function addBrightnessToRGB(rt,_){var ut=RGBtoHSV(255*rt[0],255*rt[1],255*rt[2]);return ut[2]+=_,ut[2]>1?ut[2]=1:ut[2]<0&&(ut[2]=0),HSVtoRGB(ut[0],ut[1],ut[2])}function addHueToRGB(rt,_){var ut=RGBtoHSV(255*rt[0],255*rt[1],255*rt[2]);return ut[0]+=_/360,ut[0]>1?ut[0]-=1:ut[0]<0&&(ut[0]+=1),HSVtoRGB(ut[0],ut[1],ut[2])}var rgbToHex=function(){var rt,_,ut=[];for(rt=0;rt<256;rt+=1)_=rt.toString(16),ut[rt]=_.length===1?"0"+_:_;return function(mt,bt,St){return mt<0&&(mt=0),bt<0&&(bt=0),St<0&&(St=0),"#"+ut[mt]+ut[bt]+ut[St]}}(),setSubframeEnabled=function(rt){subframeEnabled=!!rt},getSubframeEnabled=function(){return subframeEnabled},setExpressionsPlugin=function(rt){expressionsPlugin=rt},getExpressionsPlugin=function(){return expressionsPlugin},setExpressionInterfaces=function(rt){expressionsInterfaces=rt},getExpressionInterfaces=function(){return expressionsInterfaces},setDefaultCurveSegments=function(rt){defaultCurveSegments=rt},getDefaultCurveSegments=function(){return defaultCurveSegments},setIdPrefix=function(rt){idPrefix$1=rt};function createNS(rt){return document.createElementNS(svgNS,rt)}function _typeof$5(rt){return(_typeof$5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(rt)}var dataManager=function(){var rt,_,ut=1,mt=[],bt={onmessage:function(){},postMessage:function(Ut){rt({data:Ut})}},St={postMessage:function(Ut){bt.onmessage({data:Ut})}};function Mt(){_||((_=function(Ut){if(window.Worker&&window.Blob&&getWebWorker()){var Ht=new Blob(["var _workerSelf = self; self.onmessage = ",Ut.toString()],{type:"text/javascript"}),tr=URL.createObjectURL(Ht);return new Worker(tr)}return rt=Ut,bt}(function(Ut){if(St.dataManager||(St.dataManager=function(){function tr($n,en){var In,Rn,qn,Qn,xs,cs,ks=$n.length;for(Rn=0;Rn<ks;Rn+=1)if("ks"in(In=$n[Rn])&&!In.completed){if(In.completed=!0,In.hasMask){var _o=In.masksProperties;for(Qn=_o.length,qn=0;qn<Qn;qn+=1)if(_o[qn].pt.k.i)ar(_o[qn].pt.k);else for(cs=_o[qn].pt.k.length,xs=0;xs<cs;xs+=1)_o[qn].pt.k[xs].s&&ar(_o[qn].pt.k[xs].s[0]),_o[qn].pt.k[xs].e&&ar(_o[qn].pt.k[xs].e[0])}In.ty===0?(In.layers=rr(In.refId,en),tr(In.layers,en)):In.ty===4?sr(In.shapes):In.ty===5&&mn(In)}}function rr($n,en){var In=function(Rn,qn){for(var Qn=0,xs=qn.length;Qn<xs;){if(qn[Qn].id===Rn)return qn[Qn];Qn+=1}return null}($n,en);return In?In.layers.__used?JSON.parse(JSON.stringify(In.layers)):(In.layers.__used=!0,In.layers):null}function sr($n){var en,In,Rn;for(en=$n.length-1;en>=0;en-=1)if($n[en].ty==="sh")if($n[en].ks.k.i)ar($n[en].ks.k);else for(Rn=$n[en].ks.k.length,In=0;In<Rn;In+=1)$n[en].ks.k[In].s&&ar($n[en].ks.k[In].s[0]),$n[en].ks.k[In].e&&ar($n[en].ks.k[In].e[0]);else $n[en].ty==="gr"&&sr($n[en].it)}function ar($n){var en,In=$n.i.length;for(en=0;en<In;en+=1)$n.i[en][0]+=$n.v[en][0],$n.i[en][1]+=$n.v[en][1],$n.o[en][0]+=$n.v[en][0],$n.o[en][1]+=$n.v[en][1]}function cr($n,en){var In=en?en.split("."):[100,100,100];return $n[0]>In[0]||!(In[0]>$n[0])&&($n[1]>In[1]||!(In[1]>$n[1])&&($n[2]>In[2]||!(In[2]>$n[2])&&null))}var Ar,_r=function(){var $n=[4,4,14];function en(In){var Rn,qn,Qn,xs=In.length;for(Rn=0;Rn<xs;Rn+=1)In[Rn].ty===5&&(qn=In[Rn],Qn=void 0,Qn=qn.t.d,qn.t.d={k:[{s:Qn,t:0}]})}return function(In){if(cr($n,In.v)&&(en(In.layers),In.assets)){var Rn,qn=In.assets.length;for(Rn=0;Rn<qn;Rn+=1)In.assets[Rn].layers&&en(In.assets[Rn].layers)}}}(),Dr=(Ar=[4,7,99],function($n){if($n.chars&&!cr(Ar,$n.v)){var en,In=$n.chars.length;for(en=0;en<In;en+=1){var Rn=$n.chars[en];Rn.data&&Rn.data.shapes&&(sr(Rn.data.shapes),Rn.data.ip=0,Rn.data.op=99999,Rn.data.st=0,Rn.data.sr=1,Rn.data.ks={p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0}},$n.chars[en].t||(Rn.data.shapes.push({ty:"no"}),Rn.data.shapes[0].it.push({p:{k:[0,0],a:0},s:{k:[100,100],a:0},a:{k:[0,0],a:0},r:{k:0,a:0},o:{k:100,a:0},sk:{k:0,a:0},sa:{k:0,a:0},ty:"tr"})))}}}),$r=function(){var $n=[5,7,15];function en(In){var Rn,qn,Qn,xs=In.length;for(Rn=0;Rn<xs;Rn+=1)In[Rn].ty===5&&(qn=In[Rn],Qn=void 0,typeof(Qn=qn.t.p).a=="number"&&(Qn.a={a:0,k:Qn.a}),typeof Qn.p=="number"&&(Qn.p={a:0,k:Qn.p}),typeof Qn.r=="number"&&(Qn.r={a:0,k:Qn.r}))}return function(In){if(cr($n,In.v)&&(en(In.layers),In.assets)){var Rn,qn=In.assets.length;for(Rn=0;Rn<qn;Rn+=1)In.assets[Rn].layers&&en(In.assets[Rn].layers)}}}(),Br=function(){var $n=[4,1,9];function en(Rn){var qn,Qn,xs,cs=Rn.length;for(qn=0;qn<cs;qn+=1)if(Rn[qn].ty==="gr")en(Rn[qn].it);else if(Rn[qn].ty==="fl"||Rn[qn].ty==="st")if(Rn[qn].c.k&&Rn[qn].c.k[0].i)for(xs=Rn[qn].c.k.length,Qn=0;Qn<xs;Qn+=1)Rn[qn].c.k[Qn].s&&(Rn[qn].c.k[Qn].s[0]/=255,Rn[qn].c.k[Qn].s[1]/=255,Rn[qn].c.k[Qn].s[2]/=255,Rn[qn].c.k[Qn].s[3]/=255),Rn[qn].c.k[Qn].e&&(Rn[qn].c.k[Qn].e[0]/=255,Rn[qn].c.k[Qn].e[1]/=255,Rn[qn].c.k[Qn].e[2]/=255,Rn[qn].c.k[Qn].e[3]/=255);else Rn[qn].c.k[0]/=255,Rn[qn].c.k[1]/=255,Rn[qn].c.k[2]/=255,Rn[qn].c.k[3]/=255}function In(Rn){var qn,Qn=Rn.length;for(qn=0;qn<Qn;qn+=1)Rn[qn].ty===4&&en(Rn[qn].shapes)}return function(Rn){if(cr($n,Rn.v)&&(In(Rn.layers),Rn.assets)){var qn,Qn=Rn.assets.length;for(qn=0;qn<Qn;qn+=1)Rn.assets[qn].layers&&In(Rn.assets[qn].layers)}}}(),Jr=function(){var $n=[4,4,18];function en(Rn){var qn,Qn,xs;for(qn=Rn.length-1;qn>=0;qn-=1)if(Rn[qn].ty==="sh")if(Rn[qn].ks.k.i)Rn[qn].ks.k.c=Rn[qn].closed;else for(xs=Rn[qn].ks.k.length,Qn=0;Qn<xs;Qn+=1)Rn[qn].ks.k[Qn].s&&(Rn[qn].ks.k[Qn].s[0].c=Rn[qn].closed),Rn[qn].ks.k[Qn].e&&(Rn[qn].ks.k[Qn].e[0].c=Rn[qn].closed);else Rn[qn].ty==="gr"&&en(Rn[qn].it)}function In(Rn){var qn,Qn,xs,cs,ks,_o,qs=Rn.length;for(Qn=0;Qn<qs;Qn+=1){if((qn=Rn[Qn]).hasMask){var Ss=qn.masksProperties;for(cs=Ss.length,xs=0;xs<cs;xs+=1)if(Ss[xs].pt.k.i)Ss[xs].pt.k.c=Ss[xs].cl;else for(_o=Ss[xs].pt.k.length,ks=0;ks<_o;ks+=1)Ss[xs].pt.k[ks].s&&(Ss[xs].pt.k[ks].s[0].c=Ss[xs].cl),Ss[xs].pt.k[ks].e&&(Ss[xs].pt.k[ks].e[0].c=Ss[xs].cl)}qn.ty===4&&en(qn.shapes)}}return function(Rn){if(cr($n,Rn.v)&&(In(Rn.layers),Rn.assets)){var qn,Qn=Rn.assets.length;for(qn=0;qn<Qn;qn+=1)Rn.assets[qn].layers&&In(Rn.assets[qn].layers)}}}();function mn($n){$n.t.a.length===0&&$n.t.p}var Mn={completeData:function($n){$n.__complete||(Br($n),_r($n),Dr($n),$r($n),Jr($n),tr($n.layers,$n.assets),function(en,In){if(en){var Rn=0,qn=en.length;for(Rn=0;Rn<qn;Rn+=1)en[Rn].t===1&&(en[Rn].data.layers=rr(en[Rn].data.refId,In),tr(en[Rn].data.layers,In))}}($n.chars,$n.assets),$n.__complete=!0)}};return Mn.checkColors=Br,Mn.checkChars=Dr,Mn.checkPathProperties=$r,Mn.checkShapes=Jr,Mn.completeLayers=tr,Mn}()),St.assetLoader||(St.assetLoader=function(){function tr(rr){var sr=rr.getResponseHeader("content-type");return sr&&rr.responseType==="json"&&sr.indexOf("json")!==-1||rr.response&&_typeof$5(rr.response)==="object"?rr.response:rr.response&&typeof rr.response=="string"?JSON.parse(rr.response):rr.responseText?JSON.parse(rr.responseText):null}return{load:function(rr,sr,ar,cr){var Ar,_r=new XMLHttpRequest;try{_r.responseType="json"}catch{}_r.onreadystatechange=function(){if(_r.readyState===4)if(_r.status===200)Ar=tr(_r),ar(Ar);else try{Ar=tr(_r),ar(Ar)}catch(Dr){cr&&cr(Dr)}};try{_r.open(["G","E","T"].join(""),rr,!0)}catch{_r.open(["G","E","T"].join(""),sr+"/"+rr,!0)}_r.send()}}}()),Ut.data.type==="loadAnimation")St.assetLoader.load(Ut.data.path,Ut.data.fullPath,function(tr){St.dataManager.completeData(tr),St.postMessage({id:Ut.data.id,payload:tr,status:"success"})},function(){St.postMessage({id:Ut.data.id,status:"error"})});else if(Ut.data.type==="complete"){var Ht=Ut.data.animation;St.dataManager.completeData(Ht),St.postMessage({id:Ut.data.id,payload:Ht,status:"success"})}else Ut.data.type==="loadData"&&St.assetLoader.load(Ut.data.path,Ut.data.fullPath,function(tr){St.postMessage({id:Ut.data.id,payload:tr,status:"success"})},function(){St.postMessage({id:Ut.data.id,status:"error"})})})).onmessage=function(Ut){var Ht=Ut.data,tr=Ht.id,rr=mt[tr];mt[tr]=null,Ht.status==="success"?rr.onComplete(Ht.payload):rr.onError&&rr.onError()})}function Bt(Ut,Ht){var tr="processId_"+(ut+=1);return mt[tr]={onComplete:Ut,onError:Ht},tr}return{loadAnimation:function(Ut,Ht,tr){Mt();var rr=Bt(Ht,tr);_.postMessage({type:"loadAnimation",path:Ut,fullPath:window.location.origin+window.location.pathname,id:rr})},loadData:function(Ut,Ht,tr){Mt();var rr=Bt(Ht,tr);_.postMessage({type:"loadData",path:Ut,fullPath:window.location.origin+window.location.pathname,id:rr})},completeAnimation:function(Ut,Ht,tr){Mt();var rr=Bt(Ht,tr);_.postMessage({type:"complete",animation:Ut,id:rr})}}}(),ImagePreloader=function(){var rt=function(){var Bt=createTag("canvas");Bt.width=1,Bt.height=1;var Ut=Bt.getContext("2d");return Ut.fillStyle="rgba(0,0,0,0)",Ut.fillRect(0,0,1,1),Bt}();function _(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function ut(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function mt(Bt,Ut,Ht){var tr="";if(Bt.e)tr=Bt.p;else if(Ut){var rr=Bt.p;rr.indexOf("images/")!==-1&&(rr=rr.split("/")[1]),tr=Ut+rr}else tr=Ht,tr+=Bt.u?Bt.u:"",tr+=Bt.p;return tr}function bt(Bt){var Ut=0,Ht=setInterval((function(){(Bt.getBBox().width||Ut>500)&&(this._imageLoaded(),clearInterval(Ht)),Ut+=1}).bind(this),50)}function St(Bt){var Ut={assetData:Bt},Ht=mt(Bt,this.assetsPath,this.path);return dataManager.loadData(Ht,(function(tr){Ut.img=tr,this._footageLoaded()}).bind(this),(function(){Ut.img={},this._footageLoaded()}).bind(this)),Ut}function Mt(){this._imageLoaded=_.bind(this),this._footageLoaded=ut.bind(this),this.testImageLoaded=bt.bind(this),this.createFootageData=St.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return Mt.prototype={loadAssets:function(Bt,Ut){var Ht;this.imagesLoadedCb=Ut;var tr=Bt.length;for(Ht=0;Ht<tr;Ht+=1)Bt[Ht].layers||(Bt[Ht].t&&Bt[Ht].t!=="seq"?Bt[Ht].t===3&&(this.totalFootages+=1,this.images.push(this.createFootageData(Bt[Ht]))):(this.totalImages+=1,this.images.push(this._createImageData(Bt[Ht]))))},setAssetsPath:function(Bt){this.assetsPath=Bt||""},setPath:function(Bt){this.path=Bt||""},loadedImages:function(){return this.totalImages===this.loadedAssets},loadedFootages:function(){return this.totalFootages===this.loadedFootagesCount},destroy:function(){this.imagesLoadedCb=null,this.images.length=0},getAsset:function(Bt){for(var Ut=0,Ht=this.images.length;Ut<Ht;){if(this.images[Ut].assetData===Bt)return this.images[Ut].img;Ut+=1}return null},createImgData:function(Bt){var Ut=mt(Bt,this.assetsPath,this.path),Ht=createTag("img");Ht.crossOrigin="anonymous",Ht.addEventListener("load",this._imageLoaded,!1),Ht.addEventListener("error",(function(){tr.img=rt,this._imageLoaded()}).bind(this),!1),Ht.src=Ut;var tr={img:Ht,assetData:Bt};return tr},createImageData:function(Bt){var Ut=mt(Bt,this.assetsPath,this.path),Ht=createNS("image");isSafari?this.testImageLoaded(Ht):Ht.addEventListener("load",this._imageLoaded,!1),Ht.addEventListener("error",(function(){tr.img=rt,this._imageLoaded()}).bind(this),!1),Ht.setAttributeNS("http://www.w3.org/1999/xlink","href",Ut),this._elementHelper.append?this._elementHelper.append(Ht):this._elementHelper.appendChild(Ht);var tr={img:Ht,assetData:Bt};return tr},imageLoaded:_,footageLoaded:ut,setCacheType:function(Bt,Ut){Bt==="svg"?(this._elementHelper=Ut,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}},Mt}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(rt,_){if(this._cbs[rt])for(var ut=this._cbs[rt],mt=0;mt<ut.length;mt+=1)ut[mt](_)},addEventListener:function(rt,_){return this._cbs[rt]||(this._cbs[rt]=[]),this._cbs[rt].push(_),(function(){this.removeEventListener(rt,_)}).bind(this)},removeEventListener:function(rt,_){if(_){if(this._cbs[rt]){for(var ut=0,mt=this._cbs[rt].length;ut<mt;)this._cbs[rt][ut]===_&&(this._cbs[rt].splice(ut,1),ut-=1,mt-=1),ut+=1;this._cbs[rt].length||(this._cbs[rt]=null)}}else this._cbs[rt]=null}};var markerParser=function(){function rt(_){for(var ut,mt=_.split(`\r
`),bt={},St=0,Mt=0;Mt<mt.length;Mt+=1)(ut=mt[Mt].split(":")).length===2&&(bt[ut[0]]=ut[1].trim(),St+=1);if(St===0)throw new Error;return bt}return function(_){for(var ut=[],mt=0;mt<_.length;mt+=1){var bt=_[mt],St={time:bt.tm,duration:bt.dr};try{St.payload=JSON.parse(_[mt].cm)}catch{try{St.payload=rt(_[mt].cm)}catch{St.payload={name:_[mt].cm}}}ut.push(St)}return ut}}(),ProjectInterface=function(){function rt(_){this.compositions.push(_)}return function(){function _(ut){for(var mt=0,bt=this.compositions.length;mt<bt;){if(this.compositions[mt].data&&this.compositions[mt].data.nm===ut)return this.compositions[mt].prepareFrame&&this.compositions[mt].data.xt&&this.compositions[mt].prepareFrame(this.currentFrame),this.compositions[mt].compInterface;mt+=1}return null}return _.compositions=[],_.currentFrame=0,_.registerComposition=rt,_}}(),renderers={},registerRenderer=function(rt,_){renderers[rt]=_};function getRenderer(rt){return renderers[rt]}function _typeof$4(rt){return(_typeof$4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(rt)}var AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=getSubframeEnabled(),this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[],this.configAnimation=this.configAnimation.bind(this),this.onSetupError=this.onSetupError.bind(this),this.onSegmentComplete=this.onSegmentComplete.bind(this),this.drawnFrameEvent=new BMEnterFrameEvent("drawnFrame",0,0,0)};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(rt){(rt.wrapper||rt.container)&&(this.wrapper=rt.wrapper||rt.container);var _="svg";rt.animType?_=rt.animType:rt.renderer&&(_=rt.renderer);var ut=getRenderer(_);this.renderer=new ut(this,rt.rendererSettings),this.imagePreloader.setCacheType(_,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=_,rt.loop===""||rt.loop===null||rt.loop===void 0||rt.loop===!0?this.loop=!0:rt.loop===!1?this.loop=!1:this.loop=parseInt(rt.loop,10),this.autoplay=!("autoplay"in rt)||rt.autoplay,this.name=rt.name?rt.name:"",this.autoloadSegments=!Object.prototype.hasOwnProperty.call(rt,"autoloadSegments")||rt.autoloadSegments,this.assetsPath=rt.assetsPath,this.initialSegment=rt.initialSegment,rt.audioFactory&&this.audioController.setAudioFactory(rt.audioFactory),rt.animationData?this.setupAnimation(rt.animationData):rt.path&&(rt.path.lastIndexOf("\\")!==-1?this.path=rt.path.substr(0,rt.path.lastIndexOf("\\")+1):this.path=rt.path.substr(0,rt.path.lastIndexOf("/")+1),this.fileName=rt.path.substr(rt.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),dataManager.loadAnimation(rt.path,this.configAnimation,this.onSetupError))},AnimationItem.prototype.onSetupError=function(){this.trigger("data_failed")},AnimationItem.prototype.setupAnimation=function(rt){dataManager.completeAnimation(rt,this.configAnimation)},AnimationItem.prototype.setData=function(rt,_){_&&_typeof$4(_)!=="object"&&(_=JSON.parse(_));var ut={wrapper:rt,animationData:_},mt=rt.attributes;ut.path=mt.getNamedItem("data-animation-path")?mt.getNamedItem("data-animation-path").value:mt.getNamedItem("data-bm-path")?mt.getNamedItem("data-bm-path").value:mt.getNamedItem("bm-path")?mt.getNamedItem("bm-path").value:"",ut.animType=mt.getNamedItem("data-anim-type")?mt.getNamedItem("data-anim-type").value:mt.getNamedItem("data-bm-type")?mt.getNamedItem("data-bm-type").value:mt.getNamedItem("bm-type")?mt.getNamedItem("bm-type").value:mt.getNamedItem("data-bm-renderer")?mt.getNamedItem("data-bm-renderer").value:mt.getNamedItem("bm-renderer")?mt.getNamedItem("bm-renderer").value:"canvas";var bt=mt.getNamedItem("data-anim-loop")?mt.getNamedItem("data-anim-loop").value:mt.getNamedItem("data-bm-loop")?mt.getNamedItem("data-bm-loop").value:mt.getNamedItem("bm-loop")?mt.getNamedItem("bm-loop").value:"";bt==="false"?ut.loop=!1:bt==="true"?ut.loop=!0:bt!==""&&(ut.loop=parseInt(bt,10));var St=mt.getNamedItem("data-anim-autoplay")?mt.getNamedItem("data-anim-autoplay").value:mt.getNamedItem("data-bm-autoplay")?mt.getNamedItem("data-bm-autoplay").value:!mt.getNamedItem("bm-autoplay")||mt.getNamedItem("bm-autoplay").value;ut.autoplay=St!=="false",ut.name=mt.getNamedItem("data-name")?mt.getNamedItem("data-name").value:mt.getNamedItem("data-bm-name")?mt.getNamedItem("data-bm-name").value:mt.getNamedItem("bm-name")?mt.getNamedItem("bm-name").value:"",(mt.getNamedItem("data-anim-prerender")?mt.getNamedItem("data-anim-prerender").value:mt.getNamedItem("data-bm-prerender")?mt.getNamedItem("data-bm-prerender").value:mt.getNamedItem("bm-prerender")?mt.getNamedItem("bm-prerender").value:"")==="false"&&(ut.prerender=!1),this.setParams(ut)},AnimationItem.prototype.includeLayers=function(rt){rt.op>this.animationData.op&&(this.animationData.op=rt.op,this.totalFrames=Math.floor(rt.op-this.animationData.ip));var _,ut,mt=this.animationData.layers,bt=mt.length,St=rt.layers,Mt=St.length;for(ut=0;ut<Mt;ut+=1)for(_=0;_<bt;){if(mt[_].id===St[ut].id){mt[_]=St[ut];break}_+=1}if((rt.chars||rt.fonts)&&(this.renderer.globalData.fontManager.addChars(rt.chars),this.renderer.globalData.fontManager.addFonts(rt.fonts,this.renderer.globalData.defs)),rt.assets)for(bt=rt.assets.length,_=0;_<bt;_+=1)this.animationData.assets.push(rt.assets[_]);this.animationData.__complete=!1,dataManager.completeAnimation(this.animationData,this.onSegmentComplete)},AnimationItem.prototype.onSegmentComplete=function(rt){this.animationData=rt;var _=getExpressionsPlugin();_&&_.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var rt=this.animationData.segments;if(!rt||rt.length===0||!this.autoloadSegments)return this.trigger("data_ready"),void(this.timeCompleted=this.totalFrames);var _=rt.shift();this.timeCompleted=_.time*this.frameRate;var ut=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,dataManager.loadData(ut,this.includeLayers.bind(this),(function(){this.trigger("data_failed")}).bind(this))},AnimationItem.prototype.loadSegments=function(){this.animationData.segments||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(rt){if(this.renderer)try{this.animationData=rt,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(rt),rt.assets||(rt.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(rt.assets),this.markers=markerParser(rt.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(_){this.triggerConfigError(_)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){if(!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||this.renderer.rendererType!=="canvas")&&this.imagePreloader.loadedFootages()){this.isLoaded=!0;var rt=getExpressionsPlugin();rt&&rt.initExpressions(this),this.renderer.initItems(),setTimeout((function(){this.trigger("DOMLoaded")}).bind(this),0),this.gotoFrame(),this.autoplay&&this.play()}},AnimationItem.prototype.resize=function(rt,_){var ut=typeof rt=="number"?rt:void 0,mt=typeof _=="number"?_:void 0;this.renderer.updateContainerSize(ut,mt)},AnimationItem.prototype.setSubframe=function(rt){this.isSubframeEnabled=!!rt},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame(),this.trigger("drawnFrame")},AnimationItem.prototype.renderFrame=function(){if(this.isLoaded!==!1&&this.renderer)try{this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(rt){this.triggerRenderFrameError(rt)}},AnimationItem.prototype.play=function(rt){rt&&this.name!==rt||this.isPaused===!0&&(this.isPaused=!1,this.trigger("_pause"),this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(rt){rt&&this.name!==rt||this.isPaused===!1&&(this.isPaused=!0,this.trigger("_play"),this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(rt){rt&&this.name!==rt||(this.isPaused===!0?this.play():this.pause())},AnimationItem.prototype.stop=function(rt){rt&&this.name!==rt||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(rt){for(var _,ut=0;ut<this.markers.length;ut+=1)if((_=this.markers[ut]).payload&&_.payload.name===rt)return _;return null},AnimationItem.prototype.goToAndStop=function(rt,_,ut){if(!ut||this.name===ut){var mt=Number(rt);if(isNaN(mt)){var bt=this.getMarkerData(rt);bt&&this.goToAndStop(bt.time,!0)}else _?this.setCurrentRawFrameValue(rt):this.setCurrentRawFrameValue(rt*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(rt,_,ut){if(!ut||this.name===ut){var mt=Number(rt);if(isNaN(mt)){var bt=this.getMarkerData(rt);bt&&(bt.duration?this.playSegments([bt.time,bt.time+bt.duration],!0):this.goToAndStop(bt.time,!0))}else this.goToAndStop(mt,_,ut);this.play()}},AnimationItem.prototype.advanceTime=function(rt){if(this.isPaused!==!0&&this.isLoaded!==!1){var _=this.currentRawFrame+rt*this.frameModifier,ut=!1;_>=this.totalFrames-1&&this.frameModifier>0?this.loop&&this.playCount!==this.loop?_>=this.totalFrames?(this.playCount+=1,this.checkSegments(_%this.totalFrames)||(this.setCurrentRawFrameValue(_%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(_):this.checkSegments(_>this.totalFrames?_%this.totalFrames:0)||(ut=!0,_=this.totalFrames-1):_<0?this.checkSegments(_%this.totalFrames)||(!this.loop||this.playCount--<=0&&this.loop!==!0?(ut=!0,_=0):(this.setCurrentRawFrameValue(this.totalFrames+_%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0)):this.setCurrentRawFrameValue(_),ut&&(this.setCurrentRawFrameValue(_),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(rt,_){this.playCount=0,rt[1]<rt[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=rt[0]-rt[1],this.timeCompleted=this.totalFrames,this.firstFrame=rt[1],this.setCurrentRawFrameValue(this.totalFrames-.001-_)):rt[1]>rt[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=rt[1]-rt[0],this.timeCompleted=this.totalFrames,this.firstFrame=rt[0],this.setCurrentRawFrameValue(.001+_)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(rt,_){var ut=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<rt?ut=rt:this.currentRawFrame+this.firstFrame>_&&(ut=_-rt)),this.firstFrame=rt,this.totalFrames=_-rt,this.timeCompleted=this.totalFrames,ut!==-1&&this.goToAndStop(ut,!0)},AnimationItem.prototype.playSegments=function(rt,_){if(_&&(this.segments.length=0),_typeof$4(rt[0])==="object"){var ut,mt=rt.length;for(ut=0;ut<mt;ut+=1)this.segments.push(rt[ut])}else this.segments.push(rt);this.segments.length&&_&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(rt){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),rt&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(rt){return!!this.segments.length&&(this.adjustSegment(this.segments.shift(),rt),!0)},AnimationItem.prototype.destroy=function(rt){rt&&this.name!==rt||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.renderer=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(rt){this.currentRawFrame=rt,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(rt){this.playSpeed=rt,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(rt){this.playDirection=rt<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setLoop=function(rt){this.loop=rt},AnimationItem.prototype.setVolume=function(rt,_){_&&this.name!==_||this.audioController.setVolume(rt)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(rt){rt&&this.name!==rt||this.audioController.mute()},AnimationItem.prototype.unmute=function(rt){rt&&this.name!==rt||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(rt){var _="";if(rt.e)_=rt.p;else if(this.assetsPath){var ut=rt.p;ut.indexOf("images/")!==-1&&(ut=ut.split("/")[1]),_=this.assetsPath+ut}else _=this.path,_+=rt.u?rt.u:"",_+=rt.p;return _},AnimationItem.prototype.getAssetData=function(rt){for(var _=0,ut=this.assets.length;_<ut;){if(rt===this.assets[_].id)return this.assets[_];_+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(rt){return rt?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.updateDocumentData=function(rt,_,ut){try{this.renderer.getElementByPath(rt).updateDocumentData(_,ut)}catch{}},AnimationItem.prototype.trigger=function(rt){if(this._cbs&&this._cbs[rt])switch(rt){case"enterFrame":this.triggerEvent(rt,new BMEnterFrameEvent(rt,this.currentFrame,this.totalFrames,this.frameModifier));break;case"drawnFrame":this.drawnFrameEvent.currentTime=this.currentFrame,this.drawnFrameEvent.totalTime=this.totalFrames,this.drawnFrameEvent.direction=this.frameModifier,this.triggerEvent(rt,this.drawnFrameEvent);break;case"loopComplete":this.triggerEvent(rt,new BMCompleteLoopEvent(rt,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(rt,new BMCompleteEvent(rt,this.frameMult));break;case"segmentStart":this.triggerEvent(rt,new BMSegmentStartEvent(rt,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(rt,new BMDestroyEvent(rt,this));break;default:this.triggerEvent(rt)}rt==="enterFrame"&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(rt,this.currentFrame,this.totalFrames,this.frameMult)),rt==="loopComplete"&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(rt,this.loop,this.playCount,this.frameMult)),rt==="complete"&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(rt,this.frameMult)),rt==="segmentStart"&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(rt,this.firstFrame,this.totalFrames)),rt==="destroy"&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(rt,this))},AnimationItem.prototype.triggerRenderFrameError=function(rt){var _=new BMRenderFrameErrorEvent(rt,this.currentFrame);this.triggerEvent("error",_),this.onError&&this.onError.call(this,_)},AnimationItem.prototype.triggerConfigError=function(rt){var _=new BMConfigErrorEvent(rt,this.currentFrame);this.triggerEvent("error",_),this.onError&&this.onError.call(this,_)};var animationManager=function(){var rt={},_=[],ut=0,mt=0,bt=0,St=!0,Mt=!1;function Bt(Ar){for(var _r=0,Dr=Ar.target;_r<mt;)_[_r].animation===Dr&&(_.splice(_r,1),_r-=1,mt-=1,Dr.isPaused||tr()),_r+=1}function Ut(Ar,_r){if(!Ar)return null;for(var Dr=0;Dr<mt;){if(_[Dr].elem===Ar&&_[Dr].elem!==null)return _[Dr].animation;Dr+=1}var $r=new AnimationItem;return rr($r,Ar),$r.setData(Ar,_r),$r}function Ht(){bt+=1,cr()}function tr(){bt-=1}function rr(Ar,_r){Ar.addEventListener("destroy",Bt),Ar.addEventListener("_active",Ht),Ar.addEventListener("_idle",tr),_.push({elem:_r,animation:Ar}),mt+=1}function sr(Ar){var _r,Dr=Ar-ut;for(_r=0;_r<mt;_r+=1)_[_r].animation.advanceTime(Dr);ut=Ar,bt&&!Mt?window.requestAnimationFrame(sr):St=!0}function ar(Ar){ut=Ar,window.requestAnimationFrame(sr)}function cr(){!Mt&&bt&&St&&(window.requestAnimationFrame(ar),St=!1)}return rt.registerAnimation=Ut,rt.loadAnimation=function(Ar){var _r=new AnimationItem;return rr(_r,null),_r.setParams(Ar),_r},rt.setSpeed=function(Ar,_r){var Dr;for(Dr=0;Dr<mt;Dr+=1)_[Dr].animation.setSpeed(Ar,_r)},rt.setDirection=function(Ar,_r){var Dr;for(Dr=0;Dr<mt;Dr+=1)_[Dr].animation.setDirection(Ar,_r)},rt.play=function(Ar){var _r;for(_r=0;_r<mt;_r+=1)_[_r].animation.play(Ar)},rt.pause=function(Ar){var _r;for(_r=0;_r<mt;_r+=1)_[_r].animation.pause(Ar)},rt.stop=function(Ar){var _r;for(_r=0;_r<mt;_r+=1)_[_r].animation.stop(Ar)},rt.togglePause=function(Ar){var _r;for(_r=0;_r<mt;_r+=1)_[_r].animation.togglePause(Ar)},rt.searchAnimations=function(Ar,_r,Dr){var $r,Br=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),Jr=Br.length;for($r=0;$r<Jr;$r+=1)Dr&&Br[$r].setAttribute("data-bm-type",Dr),Ut(Br[$r],Ar);if(_r&&Jr===0){Dr||(Dr="svg");var mn=document.getElementsByTagName("body")[0];mn.innerText="";var Mn=createTag("div");Mn.style.width="100%",Mn.style.height="100%",Mn.setAttribute("data-bm-type",Dr),mn.appendChild(Mn),Ut(Mn,Ar)}},rt.resize=function(){var Ar;for(Ar=0;Ar<mt;Ar+=1)_[Ar].animation.resize()},rt.goToAndStop=function(Ar,_r,Dr){var $r;for($r=0;$r<mt;$r+=1)_[$r].animation.goToAndStop(Ar,_r,Dr)},rt.destroy=function(Ar){var _r;for(_r=mt-1;_r>=0;_r-=1)_[_r].animation.destroy(Ar)},rt.freeze=function(){Mt=!0},rt.unfreeze=function(){Mt=!1,cr()},rt.setVolume=function(Ar,_r){var Dr;for(Dr=0;Dr<mt;Dr+=1)_[Dr].animation.setVolume(Ar,_r)},rt.mute=function(Ar){var _r;for(_r=0;_r<mt;_r+=1)_[_r].animation.mute(Ar)},rt.unmute=function(Ar){var _r;for(_r=0;_r<mt;_r+=1)_[_r].animation.unmute(Ar)},rt.getRegisteredAnimations=function(){var Ar,_r=_.length,Dr=[];for(Ar=0;Ar<_r;Ar+=1)Dr.push(_[Ar].animation);return Dr},rt}(),BezierFactory=function(){var rt={getBezierEasing:function(Ht,tr,rr,sr,ar){var cr=ar||("bez_"+Ht+"_"+tr+"_"+rr+"_"+sr).replace(/\./g,"p");if(_[cr])return _[cr];var Ar=new Ut([Ht,tr,rr,sr]);return _[cr]=Ar,Ar}},_={},ut=typeof Float32Array=="function";function mt(Ht,tr){return 1-3*tr+3*Ht}function bt(Ht,tr){return 3*tr-6*Ht}function St(Ht){return 3*Ht}function Mt(Ht,tr,rr){return((mt(tr,rr)*Ht+bt(tr,rr))*Ht+St(tr))*Ht}function Bt(Ht,tr,rr){return 3*mt(tr,rr)*Ht*Ht+2*bt(tr,rr)*Ht+St(tr)}function Ut(Ht){this._p=Ht,this._mSampleValues=ut?new Float32Array(11):new Array(11),this._precomputed=!1,this.get=this.get.bind(this)}return Ut.prototype={get:function(Ht){var tr=this._p[0],rr=this._p[1],sr=this._p[2],ar=this._p[3];return this._precomputed||this._precompute(),tr===rr&&sr===ar?Ht:Ht===0?0:Ht===1?1:Mt(this._getTForX(Ht),rr,ar)},_precompute:function(){var Ht=this._p[0],tr=this._p[1],rr=this._p[2],sr=this._p[3];this._precomputed=!0,Ht===tr&&rr===sr||this._calcSampleValues()},_calcSampleValues:function(){for(var Ht=this._p[0],tr=this._p[2],rr=0;rr<11;++rr)this._mSampleValues[rr]=Mt(.1*rr,Ht,tr)},_getTForX:function(Ht){for(var tr=this._p[0],rr=this._p[2],sr=this._mSampleValues,ar=0,cr=1;cr!==10&&sr[cr]<=Ht;++cr)ar+=.1;var Ar=ar+.1*((Ht-sr[--cr])/(sr[cr+1]-sr[cr])),_r=Bt(Ar,tr,rr);return _r>=.001?function(Dr,$r,Br,Jr){for(var mn=0;mn<4;++mn){var Mn=Bt($r,Br,Jr);if(Mn===0)return $r;$r-=(Mt($r,Br,Jr)-Dr)/Mn}return $r}(Ht,Ar,tr,rr):_r===0?Ar:function(Dr,$r,Br,Jr,mn){var Mn,$n,en=0;do(Mn=Mt($n=$r+(Br-$r)/2,Jr,mn)-Dr)>0?Br=$n:$r=$n;while(Math.abs(Mn)>1e-7&&++en<10);return $n}(Ht,ar,ar+.1,tr,rr)}},rt}(),pooling={double:function(rt){return rt.concat(createSizedArray(rt.length))}},poolFactory=function(rt,_,ut){var mt=0,bt=rt,St=createSizedArray(bt);return{newElement:function(){return mt?St[mt-=1]:_()},release:function(Mt){mt===bt&&(St=pooling.double(St),bt*=2),ut&&ut(Mt),St[mt]=Mt,mt+=1}}},bezierLengthPool=poolFactory(8,function(){return{addedLength:0,percents:createTypedArray("float32",getDefaultCurveSegments()),lengths:createTypedArray("float32",getDefaultCurveSegments())}}),segmentsLengthPool=poolFactory(8,function(){return{lengths:[],totalLength:0}},function(rt){var _,ut=rt.lengths.length;for(_=0;_<ut;_+=1)bezierLengthPool.release(rt.lengths[_]);rt.lengths.length=0});function bezFunction(){var rt=Math;function _(Ht,tr,rr,sr,ar,cr){var Ar=Ht*sr+tr*ar+rr*cr-ar*sr-cr*Ht-rr*tr;return Ar>-.001&&Ar<.001}var ut=function(Ht,tr,rr,sr){var ar,cr,Ar,_r,Dr,$r,Br=getDefaultCurveSegments(),Jr=0,mn=[],Mn=[],$n=bezierLengthPool.newElement();for(Ar=rr.length,ar=0;ar<Br;ar+=1){for(Dr=ar/(Br-1),$r=0,cr=0;cr<Ar;cr+=1)_r=bmPow(1-Dr,3)*Ht[cr]+3*bmPow(1-Dr,2)*Dr*rr[cr]+3*(1-Dr)*bmPow(Dr,2)*sr[cr]+bmPow(Dr,3)*tr[cr],mn[cr]=_r,Mn[cr]!==null&&($r+=bmPow(mn[cr]-Mn[cr],2)),Mn[cr]=mn[cr];$r&&(Jr+=$r=bmSqrt($r)),$n.percents[ar]=Dr,$n.lengths[ar]=Jr}return $n.addedLength=Jr,$n};function mt(Ht){this.segmentLength=0,this.points=new Array(Ht)}function bt(Ht,tr){this.partialLength=Ht,this.point=tr}var St,Mt=(St={},function(Ht,tr,rr,sr){var ar=(Ht[0]+"_"+Ht[1]+"_"+tr[0]+"_"+tr[1]+"_"+rr[0]+"_"+rr[1]+"_"+sr[0]+"_"+sr[1]).replace(/\./g,"p");if(!St[ar]){var cr,Ar,_r,Dr,$r,Br,Jr,mn=getDefaultCurveSegments(),Mn=0,$n=null;Ht.length===2&&(Ht[0]!==tr[0]||Ht[1]!==tr[1])&&_(Ht[0],Ht[1],tr[0],tr[1],Ht[0]+rr[0],Ht[1]+rr[1])&&_(Ht[0],Ht[1],tr[0],tr[1],tr[0]+sr[0],tr[1]+sr[1])&&(mn=2);var en=new mt(mn);for(_r=rr.length,cr=0;cr<mn;cr+=1){for(Jr=createSizedArray(_r),$r=cr/(mn-1),Br=0,Ar=0;Ar<_r;Ar+=1)Dr=bmPow(1-$r,3)*Ht[Ar]+3*bmPow(1-$r,2)*$r*(Ht[Ar]+rr[Ar])+3*(1-$r)*bmPow($r,2)*(tr[Ar]+sr[Ar])+bmPow($r,3)*tr[Ar],Jr[Ar]=Dr,$n!==null&&(Br+=bmPow(Jr[Ar]-$n[Ar],2));Mn+=Br=bmSqrt(Br),en.points[cr]=new bt(Br,Jr),$n=Jr}en.segmentLength=Mn,St[ar]=en}return St[ar]});function Bt(Ht,tr){var rr=tr.percents,sr=tr.lengths,ar=rr.length,cr=bmFloor((ar-1)*Ht),Ar=Ht*tr.addedLength,_r=0;if(cr===ar-1||cr===0||Ar===sr[cr])return rr[cr];for(var Dr=sr[cr]>Ar?-1:1,$r=!0;$r;)if(sr[cr]<=Ar&&sr[cr+1]>Ar?(_r=(Ar-sr[cr])/(sr[cr+1]-sr[cr]),$r=!1):cr+=Dr,cr<0||cr>=ar-1){if(cr===ar-1)return rr[cr];$r=!1}return rr[cr]+(rr[cr+1]-rr[cr])*_r}var Ut=createTypedArray("float32",8);return{getSegmentsLength:function(Ht){var tr,rr=segmentsLengthPool.newElement(),sr=Ht.c,ar=Ht.v,cr=Ht.o,Ar=Ht.i,_r=Ht._length,Dr=rr.lengths,$r=0;for(tr=0;tr<_r-1;tr+=1)Dr[tr]=ut(ar[tr],ar[tr+1],cr[tr],Ar[tr+1]),$r+=Dr[tr].addedLength;return sr&&_r&&(Dr[tr]=ut(ar[tr],ar[0],cr[tr],Ar[0]),$r+=Dr[tr].addedLength),rr.totalLength=$r,rr},getNewSegment:function(Ht,tr,rr,sr,ar,cr,Ar){ar<0?ar=0:ar>1&&(ar=1);var _r,Dr=Bt(ar,Ar),$r=Bt(cr=cr>1?1:cr,Ar),Br=Ht.length,Jr=1-Dr,mn=1-$r,Mn=Jr*Jr*Jr,$n=Dr*Jr*Jr*3,en=Dr*Dr*Jr*3,In=Dr*Dr*Dr,Rn=Jr*Jr*mn,qn=Dr*Jr*mn+Jr*Dr*mn+Jr*Jr*$r,Qn=Dr*Dr*mn+Jr*Dr*$r+Dr*Jr*$r,xs=Dr*Dr*$r,cs=Jr*mn*mn,ks=Dr*mn*mn+Jr*$r*mn+Jr*mn*$r,_o=Dr*$r*mn+Jr*$r*$r+Dr*mn*$r,qs=Dr*$r*$r,Ss=mn*mn*mn,eo=$r*mn*mn+mn*$r*mn+mn*mn*$r,Ao=$r*$r*mn+mn*$r*$r+$r*mn*$r,Oo=$r*$r*$r;for(_r=0;_r<Br;_r+=1)Ut[4*_r]=rt.round(1e3*(Mn*Ht[_r]+$n*rr[_r]+en*sr[_r]+In*tr[_r]))/1e3,Ut[4*_r+1]=rt.round(1e3*(Rn*Ht[_r]+qn*rr[_r]+Qn*sr[_r]+xs*tr[_r]))/1e3,Ut[4*_r+2]=rt.round(1e3*(cs*Ht[_r]+ks*rr[_r]+_o*sr[_r]+qs*tr[_r]))/1e3,Ut[4*_r+3]=rt.round(1e3*(Ss*Ht[_r]+eo*rr[_r]+Ao*sr[_r]+Oo*tr[_r]))/1e3;return Ut},getPointInSegment:function(Ht,tr,rr,sr,ar,cr){var Ar=Bt(ar,cr),_r=1-Ar;return[rt.round(1e3*(_r*_r*_r*Ht[0]+(Ar*_r*_r+_r*Ar*_r+_r*_r*Ar)*rr[0]+(Ar*Ar*_r+_r*Ar*Ar+Ar*_r*Ar)*sr[0]+Ar*Ar*Ar*tr[0]))/1e3,rt.round(1e3*(_r*_r*_r*Ht[1]+(Ar*_r*_r+_r*Ar*_r+_r*_r*Ar)*rr[1]+(Ar*Ar*_r+_r*Ar*Ar+Ar*_r*Ar)*sr[1]+Ar*Ar*Ar*tr[1]))/1e3]},buildBezierData:Mt,pointOnLine2D:_,pointOnLine3D:function(Ht,tr,rr,sr,ar,cr,Ar,_r,Dr){if(rr===0&&cr===0&&Dr===0)return _(Ht,tr,sr,ar,Ar,_r);var $r,Br=rt.sqrt(rt.pow(sr-Ht,2)+rt.pow(ar-tr,2)+rt.pow(cr-rr,2)),Jr=rt.sqrt(rt.pow(Ar-Ht,2)+rt.pow(_r-tr,2)+rt.pow(Dr-rr,2)),mn=rt.sqrt(rt.pow(Ar-sr,2)+rt.pow(_r-ar,2)+rt.pow(Dr-cr,2));return($r=Br>Jr?Br>mn?Br-Jr-mn:mn-Jr-Br:mn>Jr?mn-Jr-Br:Jr-Br-mn)>-1e-4&&$r<1e-4}}}var bez=bezFunction(),PropertyFactory=function(){var rt=initialDefaultFrame,_=Math.abs;function ut(sr,ar){var cr,Ar=this.offsetTime;this.propType==="multidimensional"&&(cr=createTypedArray("float32",this.pv.length));for(var _r,Dr,$r,Br,Jr,mn,Mn,$n,en,In=ar.lastIndex,Rn=In,qn=this.keyframes.length-1,Qn=!0;Qn;){if(_r=this.keyframes[Rn],Dr=this.keyframes[Rn+1],Rn===qn-1&&sr>=Dr.t-Ar){_r.h&&(_r=Dr),In=0;break}if(Dr.t-Ar>sr){In=Rn;break}Rn<qn-1?Rn+=1:(In=0,Qn=!1)}$r=this.keyframesMetadata[Rn]||{};var xs,cs=Dr.t-Ar,ks=_r.t-Ar;if(_r.to){$r.bezierData||($r.bezierData=bez.buildBezierData(_r.s,Dr.s||_r.e,_r.to,_r.ti));var _o=$r.bezierData;if(sr>=cs||sr<ks){var qs=sr>=cs?_o.points.length-1:0;for(Jr=_o.points[qs].point.length,Br=0;Br<Jr;Br+=1)cr[Br]=_o.points[qs].point[Br]}else{$r.__fnct?en=$r.__fnct:(en=BezierFactory.getBezierEasing(_r.o.x,_r.o.y,_r.i.x,_r.i.y,_r.n).get,$r.__fnct=en),mn=en((sr-ks)/(cs-ks));var Ss,eo=_o.segmentLength*mn,Ao=ar.lastFrame<sr&&ar._lastKeyframeIndex===Rn?ar._lastAddedLength:0;for($n=ar.lastFrame<sr&&ar._lastKeyframeIndex===Rn?ar._lastPoint:0,Qn=!0,Mn=_o.points.length;Qn;){if(Ao+=_o.points[$n].partialLength,eo===0||mn===0||$n===_o.points.length-1){for(Jr=_o.points[$n].point.length,Br=0;Br<Jr;Br+=1)cr[Br]=_o.points[$n].point[Br];break}if(eo>=Ao&&eo<Ao+_o.points[$n+1].partialLength){for(Ss=(eo-Ao)/_o.points[$n+1].partialLength,Jr=_o.points[$n].point.length,Br=0;Br<Jr;Br+=1)cr[Br]=_o.points[$n].point[Br]+(_o.points[$n+1].point[Br]-_o.points[$n].point[Br])*Ss;break}$n<Mn-1?$n+=1:Qn=!1}ar._lastPoint=$n,ar._lastAddedLength=Ao-_o.points[$n].partialLength,ar._lastKeyframeIndex=Rn}}else{var Oo,uo,uu,cu,Jl;if(qn=_r.s.length,xs=Dr.s||_r.e,this.sh&&_r.h!==1)sr>=cs?(cr[0]=xs[0],cr[1]=xs[1],cr[2]=xs[2]):sr<=ks?(cr[0]=_r.s[0],cr[1]=_r.s[1],cr[2]=_r.s[2]):function(mu,pu){var Zu=pu[0],Mp=pu[1],Up=pu[2],Ep=pu[3],mp=Math.atan2(2*Mp*Ep-2*Zu*Up,1-2*Mp*Mp-2*Up*Up),Cp=Math.asin(2*Zu*Mp+2*Up*Ep),t0=Math.atan2(2*Zu*Ep-2*Mp*Up,1-2*Zu*Zu-2*Up*Up);mu[0]=mp/degToRads,mu[1]=Cp/degToRads,mu[2]=t0/degToRads}(cr,function(mu,pu,Zu){var Mp,Up,Ep,mp,Cp,t0=[],_g=mu[0],m0=mu[1],K0=mu[2],Jp=mu[3],y0=pu[0],z0=pu[1],jm=pu[2],Nu=pu[3];return(Up=_g*y0+m0*z0+K0*jm+Jp*Nu)<0&&(Up=-Up,y0=-y0,z0=-z0,jm=-jm,Nu=-Nu),1-Up>1e-6?(Mp=Math.acos(Up),Ep=Math.sin(Mp),mp=Math.sin((1-Zu)*Mp)/Ep,Cp=Math.sin(Zu*Mp)/Ep):(mp=1-Zu,Cp=Zu),t0[0]=mp*_g+Cp*y0,t0[1]=mp*m0+Cp*z0,t0[2]=mp*K0+Cp*jm,t0[3]=mp*Jp+Cp*Nu,t0}(mt(_r.s),mt(xs),(sr-ks)/(cs-ks)));else for(Rn=0;Rn<qn;Rn+=1)_r.h!==1&&(sr>=cs?mn=1:sr<ks?mn=0:(_r.o.x.constructor===Array?($r.__fnct||($r.__fnct=[]),$r.__fnct[Rn]?en=$r.__fnct[Rn]:(Oo=_r.o.x[Rn]===void 0?_r.o.x[0]:_r.o.x[Rn],uo=_r.o.y[Rn]===void 0?_r.o.y[0]:_r.o.y[Rn],uu=_r.i.x[Rn]===void 0?_r.i.x[0]:_r.i.x[Rn],cu=_r.i.y[Rn]===void 0?_r.i.y[0]:_r.i.y[Rn],en=BezierFactory.getBezierEasing(Oo,uo,uu,cu).get,$r.__fnct[Rn]=en)):$r.__fnct?en=$r.__fnct:(Oo=_r.o.x,uo=_r.o.y,uu=_r.i.x,cu=_r.i.y,en=BezierFactory.getBezierEasing(Oo,uo,uu,cu).get,_r.keyframeMetadata=en),mn=en((sr-ks)/(cs-ks)))),xs=Dr.s||_r.e,Jl=_r.h===1?_r.s[Rn]:_r.s[Rn]+(xs[Rn]-_r.s[Rn])*mn,this.propType==="multidimensional"?cr[Rn]=Jl:cr=Jl}return ar.lastIndex=In,cr}function mt(sr){var ar=sr[0]*degToRads,cr=sr[1]*degToRads,Ar=sr[2]*degToRads,_r=Math.cos(ar/2),Dr=Math.cos(cr/2),$r=Math.cos(Ar/2),Br=Math.sin(ar/2),Jr=Math.sin(cr/2),mn=Math.sin(Ar/2);return[Br*Jr*$r+_r*Dr*mn,Br*Dr*$r+_r*Jr*mn,_r*Jr*$r-Br*Dr*mn,_r*Dr*$r-Br*Jr*mn]}function bt(){var sr=this.comp.renderedFrame-this.offsetTime,ar=this.keyframes[0].t-this.offsetTime,cr=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(sr===this._caching.lastFrame||this._caching.lastFrame!==rt&&(this._caching.lastFrame>=cr&&sr>=cr||this._caching.lastFrame<ar&&sr<ar))){this._caching.lastFrame>=sr&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var Ar=this.interpolateValue(sr,this._caching);this.pv=Ar}return this._caching.lastFrame=sr,this.pv}function St(sr){var ar;if(this.propType==="unidimensional")ar=sr*this.mult,_(this.v-ar)>1e-5&&(this.v=ar,this._mdf=!0);else for(var cr=0,Ar=this.v.length;cr<Ar;)ar=sr[cr]*this.mult,_(this.v[cr]-ar)>1e-5&&(this.v[cr]=ar,this._mdf=!0),cr+=1}function Mt(){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var sr;this.lock=!0,this._mdf=this._isFirstFrame;var ar=this.effectsSequence.length,cr=this.kf?this.pv:this.data.k;for(sr=0;sr<ar;sr+=1)cr=this.effectsSequence[sr](cr);this.setVValue(cr),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function Bt(sr){this.effectsSequence.push(sr),this.container.addDynamicProperty(this)}function Ut(sr,ar,cr,Ar){this.propType="unidimensional",this.mult=cr||1,this.data=ar,this.v=cr?ar.k*cr:ar.k,this.pv=ar.k,this._mdf=!1,this.elem=sr,this.container=Ar,this.comp=sr.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=Mt,this.setVValue=St,this.addEffect=Bt}function Ht(sr,ar,cr,Ar){var _r;this.propType="multidimensional",this.mult=cr||1,this.data=ar,this._mdf=!1,this.elem=sr,this.container=Ar,this.comp=sr.comp,this.k=!1,this.kf=!1,this.frameId=-1;var Dr=ar.k.length;for(this.v=createTypedArray("float32",Dr),this.pv=createTypedArray("float32",Dr),this.vel=createTypedArray("float32",Dr),_r=0;_r<Dr;_r+=1)this.v[_r]=ar.k[_r]*this.mult,this.pv[_r]=ar.k[_r];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=Mt,this.setVValue=St,this.addEffect=Bt}function tr(sr,ar,cr,Ar){this.propType="unidimensional",this.keyframes=ar.k,this.keyframesMetadata=[],this.offsetTime=sr.data.st,this.frameId=-1,this._caching={lastFrame:rt,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=ar,this.mult=cr||1,this.elem=sr,this.container=Ar,this.comp=sr.comp,this.v=rt,this.pv=rt,this._isFirstFrame=!0,this.getValue=Mt,this.setVValue=St,this.interpolateValue=ut,this.effectsSequence=[bt.bind(this)],this.addEffect=Bt}function rr(sr,ar,cr,Ar){var _r;this.propType="multidimensional";var Dr,$r,Br,Jr,mn=ar.k.length;for(_r=0;_r<mn-1;_r+=1)ar.k[_r].to&&ar.k[_r].s&&ar.k[_r+1]&&ar.k[_r+1].s&&(Dr=ar.k[_r].s,$r=ar.k[_r+1].s,Br=ar.k[_r].to,Jr=ar.k[_r].ti,(Dr.length===2&&(Dr[0]!==$r[0]||Dr[1]!==$r[1])&&bez.pointOnLine2D(Dr[0],Dr[1],$r[0],$r[1],Dr[0]+Br[0],Dr[1]+Br[1])&&bez.pointOnLine2D(Dr[0],Dr[1],$r[0],$r[1],$r[0]+Jr[0],$r[1]+Jr[1])||Dr.length===3&&(Dr[0]!==$r[0]||Dr[1]!==$r[1]||Dr[2]!==$r[2])&&bez.pointOnLine3D(Dr[0],Dr[1],Dr[2],$r[0],$r[1],$r[2],Dr[0]+Br[0],Dr[1]+Br[1],Dr[2]+Br[2])&&bez.pointOnLine3D(Dr[0],Dr[1],Dr[2],$r[0],$r[1],$r[2],$r[0]+Jr[0],$r[1]+Jr[1],$r[2]+Jr[2]))&&(ar.k[_r].to=null,ar.k[_r].ti=null),Dr[0]===$r[0]&&Dr[1]===$r[1]&&Br[0]===0&&Br[1]===0&&Jr[0]===0&&Jr[1]===0&&(Dr.length===2||Dr[2]===$r[2]&&Br[2]===0&&Jr[2]===0)&&(ar.k[_r].to=null,ar.k[_r].ti=null));this.effectsSequence=[bt.bind(this)],this.data=ar,this.keyframes=ar.k,this.keyframesMetadata=[],this.offsetTime=sr.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=cr||1,this.elem=sr,this.container=Ar,this.comp=sr.comp,this.getValue=Mt,this.setVValue=St,this.interpolateValue=ut,this.frameId=-1;var Mn=ar.k[0].s.length;for(this.v=createTypedArray("float32",Mn),this.pv=createTypedArray("float32",Mn),_r=0;_r<Mn;_r+=1)this.v[_r]=rt,this.pv[_r]=rt;this._caching={lastFrame:rt,lastIndex:0,value:createTypedArray("float32",Mn)},this.addEffect=Bt}return{getProp:function(sr,ar,cr,Ar,_r){var Dr;if(ar.k.length)if(typeof ar.k[0]=="number")Dr=new Ht(sr,ar,Ar,_r);else switch(cr){case 0:Dr=new tr(sr,ar,Ar,_r);break;case 1:Dr=new rr(sr,ar,Ar,_r)}else Dr=new Ut(sr,ar,Ar,_r);return Dr.effectsSequence.length&&_r.addDynamicProperty(Dr),Dr}}}();function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(rt){this.dynamicProperties.indexOf(rt)===-1&&(this.dynamicProperties.push(rt),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){var rt;this._mdf=!1;var _=this.dynamicProperties.length;for(rt=0;rt<_;rt+=1)this.dynamicProperties[rt].getValue(),this.dynamicProperties[rt]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(rt){this.container=rt,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var pointPool=poolFactory(8,function(){return createTypedArray("float32",2)});function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(rt,_){this.c=rt,this.setLength(_);for(var ut=0;ut<_;)this.v[ut]=pointPool.newElement(),this.o[ut]=pointPool.newElement(),this.i[ut]=pointPool.newElement(),ut+=1},ShapePath.prototype.setLength=function(rt){for(;this._maxLength<rt;)this.doubleArrayLength();this._length=rt},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(rt,_,ut,mt,bt){var St;switch(this._length=Math.max(this._length,mt+1),this._length>=this._maxLength&&this.doubleArrayLength(),ut){case"v":St=this.v;break;case"i":St=this.i;break;case"o":St=this.o;break;default:St=[]}(!St[mt]||St[mt]&&!bt)&&(St[mt]=pointPool.newElement()),St[mt][0]=rt,St[mt][1]=_},ShapePath.prototype.setTripleAt=function(rt,_,ut,mt,bt,St,Mt,Bt){this.setXYAt(rt,_,"v",Mt,Bt),this.setXYAt(ut,mt,"o",Mt,Bt),this.setXYAt(bt,St,"i",Mt,Bt)},ShapePath.prototype.reverse=function(){var rt=new ShapePath;rt.setPathData(this.c,this._length);var _=this.v,ut=this.o,mt=this.i,bt=0;this.c&&(rt.setTripleAt(_[0][0],_[0][1],mt[0][0],mt[0][1],ut[0][0],ut[0][1],0,!1),bt=1);var St,Mt=this._length-1,Bt=this._length;for(St=bt;St<Bt;St+=1)rt.setTripleAt(_[Mt][0],_[Mt][1],mt[Mt][0],mt[Mt][1],ut[Mt][0],ut[Mt][1],St,!1),Mt-=1;return rt},ShapePath.prototype.length=function(){return this._length};var shapePool=(factory=poolFactory(4,function(){return new ShapePath},function(rt){var _,ut=rt._length;for(_=0;_<ut;_+=1)pointPool.release(rt.v[_]),pointPool.release(rt.i[_]),pointPool.release(rt.o[_]),rt.v[_]=null,rt.i[_]=null,rt.o[_]=null;rt._length=0,rt.c=!1}),factory.clone=function(rt){var _,ut=factory.newElement(),mt=rt._length===void 0?rt.v.length:rt._length;for(ut.setLength(mt),ut.c=rt.c,_=0;_<mt;_+=1)ut.setTripleAt(rt.v[_][0],rt.v[_][1],rt.o[_][0],rt.o[_][1],rt.i[_][0],rt.i[_][1],_);return ut},factory),factory;function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}ShapeCollection.prototype.addShape=function(rt){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=rt,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var rt;for(rt=0;rt<this._length;rt+=1)shapePool.release(this.shapes[rt]);this._length=0};var shapeCollectionPool=(ob={newShapeCollection:function(){return _length?pool[_length-=1]:new ShapeCollection},release:function(rt){var _,ut=rt._length;for(_=0;_<ut;_+=1)shapePool.release(rt.shapes[_]);rt._length=0,_length===_maxLength&&(pool=pooling.double(pool),_maxLength*=2),pool[_length]=rt,_length+=1}},_length=0,_maxLength=4,pool=createSizedArray(_maxLength),ob),ob,_length,_maxLength,pool,ShapePropertyFactory=function(){function rt(sr,ar,cr){var Ar,_r,Dr,$r,Br,Jr,mn,Mn,$n,en=cr.lastIndex,In=this.keyframes;if(sr<In[0].t-this.offsetTime)Ar=In[0].s[0],Dr=!0,en=0;else if(sr>=In[In.length-1].t-this.offsetTime)Ar=In[In.length-1].s?In[In.length-1].s[0]:In[In.length-2].e[0],Dr=!0;else{for(var Rn,qn,Qn,xs=en,cs=In.length-1,ks=!0;ks&&(Rn=In[xs],!((qn=In[xs+1]).t-this.offsetTime>sr));)xs<cs-1?xs+=1:ks=!1;if(Qn=this.keyframesMetadata[xs]||{},en=xs,!(Dr=Rn.h===1)){if(sr>=qn.t-this.offsetTime)Mn=1;else if(sr<Rn.t-this.offsetTime)Mn=0;else{var _o;Qn.__fnct?_o=Qn.__fnct:(_o=BezierFactory.getBezierEasing(Rn.o.x,Rn.o.y,Rn.i.x,Rn.i.y).get,Qn.__fnct=_o),Mn=_o((sr-(Rn.t-this.offsetTime))/(qn.t-this.offsetTime-(Rn.t-this.offsetTime)))}_r=qn.s?qn.s[0]:Rn.e[0]}Ar=Rn.s[0]}for(Jr=ar._length,mn=Ar.i[0].length,cr.lastIndex=en,$r=0;$r<Jr;$r+=1)for(Br=0;Br<mn;Br+=1)$n=Dr?Ar.i[$r][Br]:Ar.i[$r][Br]+(_r.i[$r][Br]-Ar.i[$r][Br])*Mn,ar.i[$r][Br]=$n,$n=Dr?Ar.o[$r][Br]:Ar.o[$r][Br]+(_r.o[$r][Br]-Ar.o[$r][Br])*Mn,ar.o[$r][Br]=$n,$n=Dr?Ar.v[$r][Br]:Ar.v[$r][Br]+(_r.v[$r][Br]-Ar.v[$r][Br])*Mn,ar.v[$r][Br]=$n}function _(){var sr=this.comp.renderedFrame-this.offsetTime,ar=this.keyframes[0].t-this.offsetTime,cr=this.keyframes[this.keyframes.length-1].t-this.offsetTime,Ar=this._caching.lastFrame;return Ar!==-999999&&(Ar<ar&&sr<ar||Ar>cr&&sr>cr)||(this._caching.lastIndex=Ar<sr?this._caching.lastIndex:0,this.interpolateShape(sr,this.pv,this._caching)),this._caching.lastFrame=sr,this.pv}function ut(){this.paths=this.localShapeCollection}function mt(sr){(function(ar,cr){if(ar._length!==cr._length||ar.c!==cr.c)return!1;var Ar,_r=ar._length;for(Ar=0;Ar<_r;Ar+=1)if(ar.v[Ar][0]!==cr.v[Ar][0]||ar.v[Ar][1]!==cr.v[Ar][1]||ar.o[Ar][0]!==cr.o[Ar][0]||ar.o[Ar][1]!==cr.o[Ar][1]||ar.i[Ar][0]!==cr.i[Ar][0]||ar.i[Ar][1]!==cr.i[Ar][1])return!1;return!0})(this.v,sr)||(this.v=shapePool.clone(sr),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function bt(){if(this.elem.globalData.frameId!==this.frameId)if(this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var sr,ar;this.lock=!0,this._mdf=!1,sr=this.kf?this.pv:this.data.ks?this.data.ks.k:this.data.pt.k;var cr=this.effectsSequence.length;for(ar=0;ar<cr;ar+=1)sr=this.effectsSequence[ar](sr);this.setVValue(sr),this.lock=!1,this.frameId=this.elem.globalData.frameId}else this._mdf=!1}function St(sr,ar,cr){this.propType="shape",this.comp=sr.comp,this.container=sr,this.elem=sr,this.data=ar,this.k=!1,this.kf=!1,this._mdf=!1;var Ar=cr===3?ar.pt.k:ar.ks.k;this.v=shapePool.clone(Ar),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=ut,this.effectsSequence=[]}function Mt(sr){this.effectsSequence.push(sr),this.container.addDynamicProperty(this)}function Bt(sr,ar,cr){this.propType="shape",this.comp=sr.comp,this.elem=sr,this.container=sr,this.offsetTime=sr.data.st,this.keyframes=cr===3?ar.pt.k:ar.ks.k,this.keyframesMetadata=[],this.k=!0,this.kf=!0;var Ar=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,Ar),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=-999999,this.reset=ut,this._caching={lastFrame:-999999,lastIndex:0},this.effectsSequence=[_.bind(this)]}St.prototype.interpolateShape=rt,St.prototype.getValue=bt,St.prototype.setVValue=mt,St.prototype.addEffect=Mt,Bt.prototype.getValue=bt,Bt.prototype.interpolateShape=rt,Bt.prototype.setVValue=mt,Bt.prototype.addEffect=Mt;var Ut=function(){var sr=roundCorner;function ar(cr,Ar){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=Ar.d,this.elem=cr,this.comp=cr.comp,this.frameId=-1,this.initDynamicPropertyContainer(cr),this.p=PropertyFactory.getProp(cr,Ar.p,1,0,this),this.s=PropertyFactory.getProp(cr,Ar.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return ar.prototype={reset:ut,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var cr=this.p.v[0],Ar=this.p.v[1],_r=this.s.v[0]/2,Dr=this.s.v[1]/2,$r=this.d!==3,Br=this.v;Br.v[0][0]=cr,Br.v[0][1]=Ar-Dr,Br.v[1][0]=$r?cr+_r:cr-_r,Br.v[1][1]=Ar,Br.v[2][0]=cr,Br.v[2][1]=Ar+Dr,Br.v[3][0]=$r?cr-_r:cr+_r,Br.v[3][1]=Ar,Br.i[0][0]=$r?cr-_r*sr:cr+_r*sr,Br.i[0][1]=Ar-Dr,Br.i[1][0]=$r?cr+_r:cr-_r,Br.i[1][1]=Ar-Dr*sr,Br.i[2][0]=$r?cr+_r*sr:cr-_r*sr,Br.i[2][1]=Ar+Dr,Br.i[3][0]=$r?cr-_r:cr+_r,Br.i[3][1]=Ar+Dr*sr,Br.o[0][0]=$r?cr+_r*sr:cr-_r*sr,Br.o[0][1]=Ar-Dr,Br.o[1][0]=$r?cr+_r:cr-_r,Br.o[1][1]=Ar+Dr*sr,Br.o[2][0]=$r?cr-_r*sr:cr+_r*sr,Br.o[2][1]=Ar+Dr,Br.o[3][0]=$r?cr-_r:cr+_r,Br.o[3][1]=Ar-Dr*sr}},extendPrototype([DynamicPropertyContainer],ar),ar}(),Ht=function(){function sr(ar,cr){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=ar,this.comp=ar.comp,this.data=cr,this.frameId=-1,this.d=cr.d,this.initDynamicPropertyContainer(ar),cr.sy===1?(this.ir=PropertyFactory.getProp(ar,cr.ir,0,0,this),this.is=PropertyFactory.getProp(ar,cr.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(ar,cr.pt,0,0,this),this.p=PropertyFactory.getProp(ar,cr.p,1,0,this),this.r=PropertyFactory.getProp(ar,cr.r,0,degToRads,this),this.or=PropertyFactory.getProp(ar,cr.or,0,0,this),this.os=PropertyFactory.getProp(ar,cr.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return sr.prototype={reset:ut,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var ar,cr,Ar,_r,Dr=2*Math.floor(this.pt.v),$r=2*Math.PI/Dr,Br=!0,Jr=this.or.v,mn=this.ir.v,Mn=this.os.v,$n=this.is.v,en=2*Math.PI*Jr/(2*Dr),In=2*Math.PI*mn/(2*Dr),Rn=-Math.PI/2;Rn+=this.r.v;var qn=this.data.d===3?-1:1;for(this.v._length=0,ar=0;ar<Dr;ar+=1){Ar=Br?Mn:$n,_r=Br?en:In;var Qn=(cr=Br?Jr:mn)*Math.cos(Rn),xs=cr*Math.sin(Rn),cs=Qn===0&&xs===0?0:xs/Math.sqrt(Qn*Qn+xs*xs),ks=Qn===0&&xs===0?0:-Qn/Math.sqrt(Qn*Qn+xs*xs);Qn+=+this.p.v[0],xs+=+this.p.v[1],this.v.setTripleAt(Qn,xs,Qn-cs*_r*Ar*qn,xs-ks*_r*Ar*qn,Qn+cs*_r*Ar*qn,xs+ks*_r*Ar*qn,ar,!0),Br=!Br,Rn+=$r*qn}},convertPolygonToPath:function(){var ar,cr=Math.floor(this.pt.v),Ar=2*Math.PI/cr,_r=this.or.v,Dr=this.os.v,$r=2*Math.PI*_r/(4*cr),Br=.5*-Math.PI,Jr=this.data.d===3?-1:1;for(Br+=this.r.v,this.v._length=0,ar=0;ar<cr;ar+=1){var mn=_r*Math.cos(Br),Mn=_r*Math.sin(Br),$n=mn===0&&Mn===0?0:Mn/Math.sqrt(mn*mn+Mn*Mn),en=mn===0&&Mn===0?0:-mn/Math.sqrt(mn*mn+Mn*Mn);mn+=+this.p.v[0],Mn+=+this.p.v[1],this.v.setTripleAt(mn,Mn,mn-$n*$r*Dr*Jr,Mn-en*$r*Dr*Jr,mn+$n*$r*Dr*Jr,Mn+en*$r*Dr*Jr,ar,!0),Br+=Ar*Jr}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],sr),sr}(),tr=function(){function sr(ar,cr){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=ar,this.comp=ar.comp,this.frameId=-1,this.d=cr.d,this.initDynamicPropertyContainer(ar),this.p=PropertyFactory.getProp(ar,cr.p,1,0,this),this.s=PropertyFactory.getProp(ar,cr.s,1,0,this),this.r=PropertyFactory.getProp(ar,cr.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return sr.prototype={convertRectToPath:function(){var ar=this.p.v[0],cr=this.p.v[1],Ar=this.s.v[0]/2,_r=this.s.v[1]/2,Dr=bmMin(Ar,_r,this.r.v),$r=Dr*(1-roundCorner);this.v._length=0,this.d===2||this.d===1?(this.v.setTripleAt(ar+Ar,cr-_r+Dr,ar+Ar,cr-_r+Dr,ar+Ar,cr-_r+$r,0,!0),this.v.setTripleAt(ar+Ar,cr+_r-Dr,ar+Ar,cr+_r-$r,ar+Ar,cr+_r-Dr,1,!0),Dr!==0?(this.v.setTripleAt(ar+Ar-Dr,cr+_r,ar+Ar-Dr,cr+_r,ar+Ar-$r,cr+_r,2,!0),this.v.setTripleAt(ar-Ar+Dr,cr+_r,ar-Ar+$r,cr+_r,ar-Ar+Dr,cr+_r,3,!0),this.v.setTripleAt(ar-Ar,cr+_r-Dr,ar-Ar,cr+_r-Dr,ar-Ar,cr+_r-$r,4,!0),this.v.setTripleAt(ar-Ar,cr-_r+Dr,ar-Ar,cr-_r+$r,ar-Ar,cr-_r+Dr,5,!0),this.v.setTripleAt(ar-Ar+Dr,cr-_r,ar-Ar+Dr,cr-_r,ar-Ar+$r,cr-_r,6,!0),this.v.setTripleAt(ar+Ar-Dr,cr-_r,ar+Ar-$r,cr-_r,ar+Ar-Dr,cr-_r,7,!0)):(this.v.setTripleAt(ar-Ar,cr+_r,ar-Ar+$r,cr+_r,ar-Ar,cr+_r,2),this.v.setTripleAt(ar-Ar,cr-_r,ar-Ar,cr-_r+$r,ar-Ar,cr-_r,3))):(this.v.setTripleAt(ar+Ar,cr-_r+Dr,ar+Ar,cr-_r+$r,ar+Ar,cr-_r+Dr,0,!0),Dr!==0?(this.v.setTripleAt(ar+Ar-Dr,cr-_r,ar+Ar-Dr,cr-_r,ar+Ar-$r,cr-_r,1,!0),this.v.setTripleAt(ar-Ar+Dr,cr-_r,ar-Ar+$r,cr-_r,ar-Ar+Dr,cr-_r,2,!0),this.v.setTripleAt(ar-Ar,cr-_r+Dr,ar-Ar,cr-_r+Dr,ar-Ar,cr-_r+$r,3,!0),this.v.setTripleAt(ar-Ar,cr+_r-Dr,ar-Ar,cr+_r-$r,ar-Ar,cr+_r-Dr,4,!0),this.v.setTripleAt(ar-Ar+Dr,cr+_r,ar-Ar+Dr,cr+_r,ar-Ar+$r,cr+_r,5,!0),this.v.setTripleAt(ar+Ar-Dr,cr+_r,ar+Ar-$r,cr+_r,ar+Ar-Dr,cr+_r,6,!0),this.v.setTripleAt(ar+Ar,cr+_r-Dr,ar+Ar,cr+_r-Dr,ar+Ar,cr+_r-$r,7,!0)):(this.v.setTripleAt(ar-Ar,cr-_r,ar-Ar+$r,cr-_r,ar-Ar,cr-_r,1,!0),this.v.setTripleAt(ar-Ar,cr+_r,ar-Ar,cr+_r-$r,ar-Ar,cr+_r,2,!0),this.v.setTripleAt(ar+Ar,cr+_r,ar+Ar-$r,cr+_r,ar+Ar,cr+_r,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:ut},extendPrototype([DynamicPropertyContainer],sr),sr}(),rr={getShapeProp:function(sr,ar,cr){var Ar;return cr===3||cr===4?Ar=(cr===3?ar.pt:ar.ks).k.length?new Bt(sr,ar,cr):new St(sr,ar,cr):cr===5?Ar=new tr(sr,ar):cr===6?Ar=new Ut(sr,ar):cr===7&&(Ar=new Ht(sr,ar)),Ar.k&&sr.addDynamicProperty(Ar),Ar},getConstructorFunction:function(){return St},getKeyframedConstructorFunction:function(){return Bt}};return rr}(),Matrix=function(){var rt=Math.cos,_=Math.sin,ut=Math.tan,mt=Math.round;function bt(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function St(qs){if(qs===0)return this;var Ss=rt(qs),eo=_(qs);return this._t(Ss,-eo,0,0,eo,Ss,0,0,0,0,1,0,0,0,0,1)}function Mt(qs){if(qs===0)return this;var Ss=rt(qs),eo=_(qs);return this._t(1,0,0,0,0,Ss,-eo,0,0,eo,Ss,0,0,0,0,1)}function Bt(qs){if(qs===0)return this;var Ss=rt(qs),eo=_(qs);return this._t(Ss,0,eo,0,0,1,0,0,-eo,0,Ss,0,0,0,0,1)}function Ut(qs){if(qs===0)return this;var Ss=rt(qs),eo=_(qs);return this._t(Ss,-eo,0,0,eo,Ss,0,0,0,0,1,0,0,0,0,1)}function Ht(qs,Ss){return this._t(1,Ss,qs,1,0,0)}function tr(qs,Ss){return this.shear(ut(qs),ut(Ss))}function rr(qs,Ss){var eo=rt(Ss),Ao=_(Ss);return this._t(eo,Ao,0,0,-Ao,eo,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,ut(qs),1,0,0,0,0,1,0,0,0,0,1)._t(eo,-Ao,0,0,Ao,eo,0,0,0,0,1,0,0,0,0,1)}function sr(qs,Ss,eo){return eo||eo===0||(eo=1),qs===1&&Ss===1&&eo===1?this:this._t(qs,0,0,0,0,Ss,0,0,0,0,eo,0,0,0,0,1)}function ar(qs,Ss,eo,Ao,Oo,uo,uu,cu,Jl,mu,pu,Zu,Mp,Up,Ep,mp){return this.props[0]=qs,this.props[1]=Ss,this.props[2]=eo,this.props[3]=Ao,this.props[4]=Oo,this.props[5]=uo,this.props[6]=uu,this.props[7]=cu,this.props[8]=Jl,this.props[9]=mu,this.props[10]=pu,this.props[11]=Zu,this.props[12]=Mp,this.props[13]=Up,this.props[14]=Ep,this.props[15]=mp,this}function cr(qs,Ss,eo){return eo=eo||0,qs!==0||Ss!==0||eo!==0?this._t(1,0,0,0,0,1,0,0,0,0,1,0,qs,Ss,eo,1):this}function Ar(qs,Ss,eo,Ao,Oo,uo,uu,cu,Jl,mu,pu,Zu,Mp,Up,Ep,mp){var Cp=this.props;if(qs===1&&Ss===0&&eo===0&&Ao===0&&Oo===0&&uo===1&&uu===0&&cu===0&&Jl===0&&mu===0&&pu===1&&Zu===0)return Cp[12]=Cp[12]*qs+Cp[15]*Mp,Cp[13]=Cp[13]*uo+Cp[15]*Up,Cp[14]=Cp[14]*pu+Cp[15]*Ep,Cp[15]*=mp,this._identityCalculated=!1,this;var t0=Cp[0],_g=Cp[1],m0=Cp[2],K0=Cp[3],Jp=Cp[4],y0=Cp[5],z0=Cp[6],jm=Cp[7],Nu=Cp[8],Co=Cp[9],Bp=Cp[10],a0=Cp[11],Q0=Cp[12],T0=Cp[13],av=Cp[14],lv=Cp[15];return Cp[0]=t0*qs+_g*Oo+m0*Jl+K0*Mp,Cp[1]=t0*Ss+_g*uo+m0*mu+K0*Up,Cp[2]=t0*eo+_g*uu+m0*pu+K0*Ep,Cp[3]=t0*Ao+_g*cu+m0*Zu+K0*mp,Cp[4]=Jp*qs+y0*Oo+z0*Jl+jm*Mp,Cp[5]=Jp*Ss+y0*uo+z0*mu+jm*Up,Cp[6]=Jp*eo+y0*uu+z0*pu+jm*Ep,Cp[7]=Jp*Ao+y0*cu+z0*Zu+jm*mp,Cp[8]=Nu*qs+Co*Oo+Bp*Jl+a0*Mp,Cp[9]=Nu*Ss+Co*uo+Bp*mu+a0*Up,Cp[10]=Nu*eo+Co*uu+Bp*pu+a0*Ep,Cp[11]=Nu*Ao+Co*cu+Bp*Zu+a0*mp,Cp[12]=Q0*qs+T0*Oo+av*Jl+lv*Mp,Cp[13]=Q0*Ss+T0*uo+av*mu+lv*Up,Cp[14]=Q0*eo+T0*uu+av*pu+lv*Ep,Cp[15]=Q0*Ao+T0*cu+av*Zu+lv*mp,this._identityCalculated=!1,this}function _r(){return this._identityCalculated||(this._identity=!(this.props[0]!==1||this.props[1]!==0||this.props[2]!==0||this.props[3]!==0||this.props[4]!==0||this.props[5]!==1||this.props[6]!==0||this.props[7]!==0||this.props[8]!==0||this.props[9]!==0||this.props[10]!==1||this.props[11]!==0||this.props[12]!==0||this.props[13]!==0||this.props[14]!==0||this.props[15]!==1),this._identityCalculated=!0),this._identity}function Dr(qs){for(var Ss=0;Ss<16;){if(qs.props[Ss]!==this.props[Ss])return!1;Ss+=1}return!0}function $r(qs){var Ss;for(Ss=0;Ss<16;Ss+=1)qs.props[Ss]=this.props[Ss];return qs}function Br(qs){var Ss;for(Ss=0;Ss<16;Ss+=1)this.props[Ss]=qs[Ss]}function Jr(qs,Ss,eo){return{x:qs*this.props[0]+Ss*this.props[4]+eo*this.props[8]+this.props[12],y:qs*this.props[1]+Ss*this.props[5]+eo*this.props[9]+this.props[13],z:qs*this.props[2]+Ss*this.props[6]+eo*this.props[10]+this.props[14]}}function mn(qs,Ss,eo){return qs*this.props[0]+Ss*this.props[4]+eo*this.props[8]+this.props[12]}function Mn(qs,Ss,eo){return qs*this.props[1]+Ss*this.props[5]+eo*this.props[9]+this.props[13]}function $n(qs,Ss,eo){return qs*this.props[2]+Ss*this.props[6]+eo*this.props[10]+this.props[14]}function en(){var qs=this.props[0]*this.props[5]-this.props[1]*this.props[4],Ss=this.props[5]/qs,eo=-this.props[1]/qs,Ao=-this.props[4]/qs,Oo=this.props[0]/qs,uo=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/qs,uu=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/qs,cu=new Matrix;return cu.props[0]=Ss,cu.props[1]=eo,cu.props[4]=Ao,cu.props[5]=Oo,cu.props[12]=uo,cu.props[13]=uu,cu}function In(qs){return this.getInverseMatrix().applyToPointArray(qs[0],qs[1],qs[2]||0)}function Rn(qs){var Ss,eo=qs.length,Ao=[];for(Ss=0;Ss<eo;Ss+=1)Ao[Ss]=In(qs[Ss]);return Ao}function qn(qs,Ss,eo){var Ao=createTypedArray("float32",6);if(this.isIdentity())Ao[0]=qs[0],Ao[1]=qs[1],Ao[2]=Ss[0],Ao[3]=Ss[1],Ao[4]=eo[0],Ao[5]=eo[1];else{var Oo=this.props[0],uo=this.props[1],uu=this.props[4],cu=this.props[5],Jl=this.props[12],mu=this.props[13];Ao[0]=qs[0]*Oo+qs[1]*uu+Jl,Ao[1]=qs[0]*uo+qs[1]*cu+mu,Ao[2]=Ss[0]*Oo+Ss[1]*uu+Jl,Ao[3]=Ss[0]*uo+Ss[1]*cu+mu,Ao[4]=eo[0]*Oo+eo[1]*uu+Jl,Ao[5]=eo[0]*uo+eo[1]*cu+mu}return Ao}function Qn(qs,Ss,eo){return this.isIdentity()?[qs,Ss,eo]:[qs*this.props[0]+Ss*this.props[4]+eo*this.props[8]+this.props[12],qs*this.props[1]+Ss*this.props[5]+eo*this.props[9]+this.props[13],qs*this.props[2]+Ss*this.props[6]+eo*this.props[10]+this.props[14]]}function xs(qs,Ss){if(this.isIdentity())return qs+","+Ss;var eo=this.props;return Math.round(100*(qs*eo[0]+Ss*eo[4]+eo[12]))/100+","+Math.round(100*(qs*eo[1]+Ss*eo[5]+eo[13]))/100}function cs(){for(var qs=0,Ss=this.props,eo="matrix3d(";qs<16;)eo+=mt(1e4*Ss[qs])/1e4,eo+=qs===15?")":",",qs+=1;return eo}function ks(qs){return qs<1e-6&&qs>0||qs>-1e-6&&qs<0?mt(1e4*qs)/1e4:qs}function _o(){var qs=this.props;return"matrix("+ks(qs[0])+","+ks(qs[1])+","+ks(qs[4])+","+ks(qs[5])+","+ks(qs[12])+","+ks(qs[13])+")"}return function(){this.reset=bt,this.rotate=St,this.rotateX=Mt,this.rotateY=Bt,this.rotateZ=Ut,this.skew=tr,this.skewFromAxis=rr,this.shear=Ht,this.scale=sr,this.setTransform=ar,this.translate=cr,this.transform=Ar,this.applyToPoint=Jr,this.applyToX=mn,this.applyToY=Mn,this.applyToZ=$n,this.applyToPointArray=Qn,this.applyToTriplePoints=qn,this.applyToPointStringified=xs,this.toCSS=cs,this.to2dCSS=_o,this.clone=$r,this.cloneFromProps=Br,this.equals=Dr,this.inversePoints=Rn,this.inversePoint=In,this.getInverseMatrix=en,this._t=this.transform,this.isIdentity=_r,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();function _typeof$3(rt){return(_typeof$3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(rt)}var lottie={};function setLocation(rt){setLocationHref(rt)}function searchAnimations(){animationManager.searchAnimations()}function setSubframeRendering(rt){setSubframeEnabled(rt)}function setPrefix(rt){setIdPrefix(rt)}function loadAnimation(rt){return animationManager.loadAnimation(rt)}function setQuality(rt){if(typeof rt=="string")switch(rt){case"high":setDefaultCurveSegments(200);break;default:case"medium":setDefaultCurveSegments(50);break;case"low":setDefaultCurveSegments(10)}else!isNaN(rt)&&rt>1&&setDefaultCurveSegments(rt)}function inBrowser(){return typeof navigator<"u"}function installPlugin(rt,_){rt==="expressions"&&setExpressionsPlugin(_)}function getFactory(rt){switch(rt){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}function checkReady(){document.readyState==="complete"&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(rt){for(var _=queryString.split("&"),ut=0;ut<_.length;ut+=1){var mt=_[ut].split("=");if(decodeURIComponent(mt[0])==rt)return decodeURIComponent(mt[1])}return null}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocation,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.useWebWorker=setWebWorker,lottie.setIDPrefix=setPrefix,lottie.__getFactory=getFactory,lottie.version="5.10.2";var queryString="";{var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src?myScript.src.replace(/^[^\?]+\??/,""):"",getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);try{_typeof$3(exports)!=="object"&&(window.bodymovin=lottie)}catch(rt){}var ShapeModifiers=function(){var rt={},_={};return rt.registerModifier=function(ut,mt){_[ut]||(_[ut]=mt)},rt.getModifier=function(ut,mt,bt){return new _[ut](mt,bt)},rt}();function ShapeModifier(){}function TrimModifier(){}function PuckerAndBloatModifier(){}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(rt){if(!this.closed){rt.sh.container.addDynamicProperty(rt.sh);var _={shape:rt.sh,data:rt,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(_),this.addShapeToModifier(_),this._isAnimated&&rt.setAsAnimated()}},ShapeModifier.prototype.init=function(rt,_){this.shapes=[],this.elem=rt,this.initDynamicPropertyContainer(rt),this.initModifierProperties(rt,_),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier),extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(rt,_){this.s=PropertyFactory.getProp(rt,_.s,0,.01,this),this.e=PropertyFactory.getProp(rt,_.e,0,.01,this),this.o=PropertyFactory.getProp(rt,_.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=_.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(rt){rt.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(rt,_,ut,mt,bt){var St=[];_<=1?St.push({s:rt,e:_}):rt>=1?St.push({s:rt-1,e:_-1}):(St.push({s:rt,e:1}),St.push({s:0,e:_-1}));var Mt,Bt,Ut=[],Ht=St.length;for(Mt=0;Mt<Ht;Mt+=1){var tr,rr;(Bt=St[Mt]).e*bt<mt||Bt.s*bt>mt+ut||(tr=Bt.s*bt<=mt?0:(Bt.s*bt-mt)/ut,rr=Bt.e*bt>=mt+ut?1:(Bt.e*bt-mt)/ut,Ut.push([tr,rr]))}return Ut.length||Ut.push([0,0]),Ut},TrimModifier.prototype.releasePathsData=function(rt){var _,ut=rt.length;for(_=0;_<ut;_+=1)segmentsLengthPool.release(rt[_]);return rt.length=0,rt},TrimModifier.prototype.processShapes=function(rt){var _,ut,mt,bt;if(this._mdf||rt){var St=this.o.v%360/360;if(St<0&&(St+=1),(_=this.s.v>1?1+St:this.s.v<0?0+St:this.s.v+St)>(ut=this.e.v>1?1+St:this.e.v<0?0+St:this.e.v+St)){var Mt=_;_=ut,ut=Mt}_=1e-4*Math.round(1e4*_),ut=1e-4*Math.round(1e4*ut),this.sValue=_,this.eValue=ut}else _=this.sValue,ut=this.eValue;var Bt,Ut,Ht,tr,rr,sr=this.shapes.length,ar=0;if(ut===_)for(bt=0;bt<sr;bt+=1)this.shapes[bt].localShapeCollection.releaseShapes(),this.shapes[bt].shape._mdf=!0,this.shapes[bt].shape.paths=this.shapes[bt].localShapeCollection,this._mdf&&(this.shapes[bt].pathsData.length=0);else if(ut===1&&_===0||ut===0&&_===1){if(this._mdf)for(bt=0;bt<sr;bt+=1)this.shapes[bt].pathsData.length=0,this.shapes[bt].shape._mdf=!0}else{var cr,Ar,_r=[];for(bt=0;bt<sr;bt+=1)if((cr=this.shapes[bt]).shape._mdf||this._mdf||rt||this.m===2){if(Ut=(mt=cr.shape.paths)._length,rr=0,!cr.shape._mdf&&cr.pathsData.length)rr=cr.totalShapeLength;else{for(Ht=this.releasePathsData(cr.pathsData),Bt=0;Bt<Ut;Bt+=1)tr=bez.getSegmentsLength(mt.shapes[Bt]),Ht.push(tr),rr+=tr.totalLength;cr.totalShapeLength=rr,cr.pathsData=Ht}ar+=rr,cr.shape._mdf=!0}else cr.shape.paths=cr.localShapeCollection;var Dr,$r=_,Br=ut,Jr=0;for(bt=sr-1;bt>=0;bt-=1)if((cr=this.shapes[bt]).shape._mdf){for((Ar=cr.localShapeCollection).releaseShapes(),this.m===2&&sr>1?(Dr=this.calculateShapeEdges(_,ut,cr.totalShapeLength,Jr,ar),Jr+=cr.totalShapeLength):Dr=[[$r,Br]],Ut=Dr.length,Bt=0;Bt<Ut;Bt+=1){$r=Dr[Bt][0],Br=Dr[Bt][1],_r.length=0,Br<=1?_r.push({s:cr.totalShapeLength*$r,e:cr.totalShapeLength*Br}):$r>=1?_r.push({s:cr.totalShapeLength*($r-1),e:cr.totalShapeLength*(Br-1)}):(_r.push({s:cr.totalShapeLength*$r,e:cr.totalShapeLength}),_r.push({s:0,e:cr.totalShapeLength*(Br-1)}));var mn=this.addShapes(cr,_r[0]);if(_r[0].s!==_r[0].e){if(_r.length>1)if(cr.shape.paths.shapes[cr.shape.paths._length-1].c){var Mn=mn.pop();this.addPaths(mn,Ar),mn=this.addShapes(cr,_r[1],Mn)}else this.addPaths(mn,Ar),mn=this.addShapes(cr,_r[1]);this.addPaths(mn,Ar)}}cr.shape.paths=Ar}}},TrimModifier.prototype.addPaths=function(rt,_){var ut,mt=rt.length;for(ut=0;ut<mt;ut+=1)_.addShape(rt[ut])},TrimModifier.prototype.addSegment=function(rt,_,ut,mt,bt,St,Mt){bt.setXYAt(_[0],_[1],"o",St),bt.setXYAt(ut[0],ut[1],"i",St+1),Mt&&bt.setXYAt(rt[0],rt[1],"v",St),bt.setXYAt(mt[0],mt[1],"v",St+1)},TrimModifier.prototype.addSegmentFromArray=function(rt,_,ut,mt){_.setXYAt(rt[1],rt[5],"o",ut),_.setXYAt(rt[2],rt[6],"i",ut+1),mt&&_.setXYAt(rt[0],rt[4],"v",ut),_.setXYAt(rt[3],rt[7],"v",ut+1)},TrimModifier.prototype.addShapes=function(rt,_,ut){var mt,bt,St,Mt,Bt,Ut,Ht,tr,rr=rt.pathsData,sr=rt.shape.paths.shapes,ar=rt.shape.paths._length,cr=0,Ar=[],_r=!0;for(ut?(Bt=ut._length,tr=ut._length):(ut=shapePool.newElement(),Bt=0,tr=0),Ar.push(ut),mt=0;mt<ar;mt+=1){for(Ut=rr[mt].lengths,ut.c=sr[mt].c,St=sr[mt].c?Ut.length:Ut.length+1,bt=1;bt<St;bt+=1)if(cr+(Mt=Ut[bt-1]).addedLength<_.s)cr+=Mt.addedLength,ut.c=!1;else{if(cr>_.e){ut.c=!1;break}_.s<=cr&&_.e>=cr+Mt.addedLength?(this.addSegment(sr[mt].v[bt-1],sr[mt].o[bt-1],sr[mt].i[bt],sr[mt].v[bt],ut,Bt,_r),_r=!1):(Ht=bez.getNewSegment(sr[mt].v[bt-1],sr[mt].v[bt],sr[mt].o[bt-1],sr[mt].i[bt],(_.s-cr)/Mt.addedLength,(_.e-cr)/Mt.addedLength,Ut[bt-1]),this.addSegmentFromArray(Ht,ut,Bt,_r),_r=!1,ut.c=!1),cr+=Mt.addedLength,Bt+=1}if(sr[mt].c&&Ut.length){if(Mt=Ut[bt-1],cr<=_.e){var Dr=Ut[bt-1].addedLength;_.s<=cr&&_.e>=cr+Dr?(this.addSegment(sr[mt].v[bt-1],sr[mt].o[bt-1],sr[mt].i[0],sr[mt].v[0],ut,Bt,_r),_r=!1):(Ht=bez.getNewSegment(sr[mt].v[bt-1],sr[mt].v[0],sr[mt].o[bt-1],sr[mt].i[0],(_.s-cr)/Dr,(_.e-cr)/Dr,Ut[bt-1]),this.addSegmentFromArray(Ht,ut,Bt,_r),_r=!1,ut.c=!1)}else ut.c=!1;cr+=Mt.addedLength,Bt+=1}if(ut._length&&(ut.setXYAt(ut.v[tr][0],ut.v[tr][1],"i",tr),ut.setXYAt(ut.v[ut._length-1][0],ut.v[ut._length-1][1],"o",ut._length-1)),cr>_.e)break;mt<ar-1&&(ut=shapePool.newElement(),_r=!0,Ar.push(ut),Bt=0)}return Ar},extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(rt,_){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(rt,_.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(rt,_){var ut=_/100,mt=[0,0],bt=rt._length,St=0;for(St=0;St<bt;St+=1)mt[0]+=rt.v[St][0],mt[1]+=rt.v[St][1];mt[0]/=bt,mt[1]/=bt;var Mt,Bt,Ut,Ht,tr,rr,sr=shapePool.newElement();for(sr.c=rt.c,St=0;St<bt;St+=1)Mt=rt.v[St][0]+(mt[0]-rt.v[St][0])*ut,Bt=rt.v[St][1]+(mt[1]-rt.v[St][1])*ut,Ut=rt.o[St][0]+(mt[0]-rt.o[St][0])*-ut,Ht=rt.o[St][1]+(mt[1]-rt.o[St][1])*-ut,tr=rt.i[St][0]+(mt[0]-rt.i[St][0])*-ut,rr=rt.i[St][1]+(mt[1]-rt.i[St][1])*-ut,sr.setTripleAt(Mt,Bt,Ut,Ht,tr,rr,St);return sr},PuckerAndBloatModifier.prototype.processShapes=function(rt){var _,ut,mt,bt,St,Mt,Bt=this.shapes.length,Ut=this.amount.v;if(Ut!==0)for(ut=0;ut<Bt;ut+=1){if(Mt=(St=this.shapes[ut]).localShapeCollection,St.shape._mdf||this._mdf||rt)for(Mt.releaseShapes(),St.shape._mdf=!0,_=St.shape.paths.shapes,bt=St.shape.paths._length,mt=0;mt<bt;mt+=1)Mt.addShape(this.processPath(_[mt],Ut));St.shape.paths=St.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var TransformPropertyFactory=function(){var rt=[0,0];function _(ut,mt,bt){if(this.elem=ut,this.frameId=-1,this.propType="transform",this.data=mt,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(bt||ut),mt.p&&mt.p.s?(this.px=PropertyFactory.getProp(ut,mt.p.x,0,0,this),this.py=PropertyFactory.getProp(ut,mt.p.y,0,0,this),mt.p.z&&(this.pz=PropertyFactory.getProp(ut,mt.p.z,0,0,this))):this.p=PropertyFactory.getProp(ut,mt.p||{k:[0,0,0]},1,0,this),mt.rx){if(this.rx=PropertyFactory.getProp(ut,mt.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(ut,mt.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(ut,mt.rz,0,degToRads,this),mt.or.k[0].ti){var St,Mt=mt.or.k.length;for(St=0;St<Mt;St+=1)mt.or.k[St].to=null,mt.or.k[St].ti=null}this.or=PropertyFactory.getProp(ut,mt.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(ut,mt.r||{k:0},0,degToRads,this);mt.sk&&(this.sk=PropertyFactory.getProp(ut,mt.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(ut,mt.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(ut,mt.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(ut,mt.s||{k:[100,100,100]},1,.01,this),mt.o?this.o=PropertyFactory.getProp(ut,mt.o,0,.01,ut):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}return _.prototype={applyToMatrix:function(ut){var mt=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||mt,this.a&&ut.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&ut.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&ut.skewFromAxis(-this.sk.v,this.sa.v),this.r?ut.rotate(-this.r.v):ut.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?ut.translate(this.px.v,this.py.v,-this.pz.v):ut.translate(this.px.v,this.py.v,0):ut.translate(this.p.v[0],this.p.v[1],-this.p.v[2])},getValue:function(ut){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||ut){var mt;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var bt,St;if(mt=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(bt=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/mt,0),St=this.p.getValueAtTime(this.p.keyframes[0].t/mt,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(bt=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/mt,0),St=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/mt,0)):(bt=this.p.pv,St=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/mt,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){bt=[],St=[];var Mt=this.px,Bt=this.py;Mt._caching.lastFrame+Mt.offsetTime<=Mt.keyframes[0].t?(bt[0]=Mt.getValueAtTime((Mt.keyframes[0].t+.01)/mt,0),bt[1]=Bt.getValueAtTime((Bt.keyframes[0].t+.01)/mt,0),St[0]=Mt.getValueAtTime(Mt.keyframes[0].t/mt,0),St[1]=Bt.getValueAtTime(Bt.keyframes[0].t/mt,0)):Mt._caching.lastFrame+Mt.offsetTime>=Mt.keyframes[Mt.keyframes.length-1].t?(bt[0]=Mt.getValueAtTime(Mt.keyframes[Mt.keyframes.length-1].t/mt,0),bt[1]=Bt.getValueAtTime(Bt.keyframes[Bt.keyframes.length-1].t/mt,0),St[0]=Mt.getValueAtTime((Mt.keyframes[Mt.keyframes.length-1].t-.01)/mt,0),St[1]=Bt.getValueAtTime((Bt.keyframes[Bt.keyframes.length-1].t-.01)/mt,0)):(bt=[Mt.pv,Bt.pv],St[0]=Mt.getValueAtTime((Mt._caching.lastFrame+Mt.offsetTime-.01)/mt,Mt.offsetTime),St[1]=Bt.getValueAtTime((Bt._caching.lastFrame+Bt.offsetTime-.01)/mt,Bt.offsetTime))}else bt=St=rt;this.v.rotate(-Math.atan2(bt[1]-St[1],bt[0]-St[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}},precalculateMatrix:function(){if(!this.a.k&&(this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1,!this.s.effectsSequence.length)){if(this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2,this.sk){if(this.sk.effectsSequence.length||this.sa.effectsSequence.length)return;this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3}this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):this.rz.effectsSequence.length||this.ry.effectsSequence.length||this.rx.effectsSequence.length||this.or.effectsSequence.length||(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}},autoOrient:function(){}},extendPrototype([DynamicPropertyContainer],_),_.prototype.addDynamicProperty=function(ut){this._addDynamicProperty(ut),this.elem.addDynamicProperty(ut),this._isDirty=!0},_.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty,{getTransformProperty:function(ut,mt,bt){return new _(ut,mt,bt)}}}();function RepeaterModifier(){}function RoundCornersModifier(){}function floatEqual(rt,_){return 1e5*Math.abs(rt-_)<=Math.min(Math.abs(rt),Math.abs(_))}function floatZero(rt){return Math.abs(rt)<=1e-5}function lerp(rt,_,ut){return rt*(1-ut)+_*ut}function lerpPoint(rt,_,ut){return[lerp(rt[0],_[0],ut),lerp(rt[1],_[1],ut)]}function quadRoots(rt,_,ut){if(rt===0)return[];var mt=_*_-4*rt*ut;if(mt<0)return[];var bt=-_/(2*rt);if(mt===0)return[bt];var St=Math.sqrt(mt)/(2*rt);return[bt-St,bt+St]}function polynomialCoefficients(rt,_,ut,mt){return[3*_-rt-3*ut+mt,3*rt-6*_+3*ut,-3*rt+3*_,rt]}function singlePoint(rt){return new PolynomialBezier(rt,rt,rt,rt,!1)}function PolynomialBezier(rt,_,ut,mt,bt){bt&&pointEqual(rt,_)&&(_=lerpPoint(rt,mt,1/3)),bt&&pointEqual(ut,mt)&&(ut=lerpPoint(rt,mt,2/3));var St=polynomialCoefficients(rt[0],_[0],ut[0],mt[0]),Mt=polynomialCoefficients(rt[1],_[1],ut[1],mt[1]);this.a=[St[0],Mt[0]],this.b=[St[1],Mt[1]],this.c=[St[2],Mt[2]],this.d=[St[3],Mt[3]],this.points=[rt,_,ut,mt]}function extrema(rt,_){var ut=rt.points[0][_],mt=rt.points[rt.points.length-1][_];if(ut>mt){var bt=mt;mt=ut,ut=bt}for(var St=quadRoots(3*rt.a[_],2*rt.b[_],rt.c[_]),Mt=0;Mt<St.length;Mt+=1)if(St[Mt]>0&&St[Mt]<1){var Bt=rt.point(St[Mt])[_];Bt<ut?ut=Bt:Bt>mt&&(mt=Bt)}return{min:ut,max:mt}}function intersectData(rt,_,ut){var mt=rt.boundingBox();return{cx:mt.cx,cy:mt.cy,width:mt.width,height:mt.height,bez:rt,t:(_+ut)/2,t1:_,t2:ut}}function splitData(rt){var _=rt.bez.split(.5);return[intersectData(_[0],rt.t1,rt.t),intersectData(_[1],rt.t,rt.t2)]}function boxIntersect(rt,_){return 2*Math.abs(rt.cx-_.cx)<rt.width+_.width&&2*Math.abs(rt.cy-_.cy)<rt.height+_.height}function intersectsImpl(rt,_,ut,mt,bt,St){if(boxIntersect(rt,_))if(ut>=St||rt.width<=mt&&rt.height<=mt&&_.width<=mt&&_.height<=mt)bt.push([rt.t,_.t]);else{var Mt=splitData(rt),Bt=splitData(_);intersectsImpl(Mt[0],Bt[0],ut+1,mt,bt,St),intersectsImpl(Mt[0],Bt[1],ut+1,mt,bt,St),intersectsImpl(Mt[1],Bt[0],ut+1,mt,bt,St),intersectsImpl(Mt[1],Bt[1],ut+1,mt,bt,St)}}function crossProduct(rt,_){return[rt[1]*_[2]-rt[2]*_[1],rt[2]*_[0]-rt[0]*_[2],rt[0]*_[1]-rt[1]*_[0]]}function lineIntersection(rt,_,ut,mt){var bt=[rt[0],rt[1],1],St=[_[0],_[1],1],Mt=[ut[0],ut[1],1],Bt=[mt[0],mt[1],1],Ut=crossProduct(crossProduct(bt,St),crossProduct(Mt,Bt));return floatZero(Ut[2])?null:[Ut[0]/Ut[2],Ut[1]/Ut[2]]}function polarOffset(rt,_,ut){return[rt[0]+Math.cos(_)*ut,rt[1]-Math.sin(_)*ut]}function pointDistance(rt,_){return Math.hypot(rt[0]-_[0],rt[1]-_[1])}function pointEqual(rt,_){return floatEqual(rt[0],_[0])&&floatEqual(rt[1],_[1])}function ZigZagModifier(){}function setPoint(rt,_,ut,mt,bt,St,Mt){var Bt=ut-Math.PI/2,Ut=ut+Math.PI/2,Ht=_[0]+Math.cos(ut)*mt*bt,tr=_[1]-Math.sin(ut)*mt*bt;rt.setTripleAt(Ht,tr,Ht+Math.cos(Bt)*St,tr-Math.sin(Bt)*St,Ht+Math.cos(Ut)*Mt,tr-Math.sin(Ut)*Mt,rt.length())}function getPerpendicularVector(rt,_){var ut=[_[0]-rt[0],_[1]-rt[1]],mt=.5*-Math.PI;return[Math.cos(mt)*ut[0]-Math.sin(mt)*ut[1],Math.sin(mt)*ut[0]+Math.cos(mt)*ut[1]]}function getProjectingAngle(rt,_){var ut=_===0?rt.length()-1:_-1,mt=(_+1)%rt.length(),bt=getPerpendicularVector(rt.v[ut],rt.v[mt]);return Math.atan2(0,1)-Math.atan2(bt[1],bt[0])}function zigZagCorner(rt,_,ut,mt,bt,St,Mt){var Bt=getProjectingAngle(_,ut),Ut=_.v[ut%_._length],Ht=_.v[ut===0?_._length-1:ut-1],tr=_.v[(ut+1)%_._length],rr=St===2?Math.sqrt(Math.pow(Ut[0]-Ht[0],2)+Math.pow(Ut[1]-Ht[1],2)):0,sr=St===2?Math.sqrt(Math.pow(Ut[0]-tr[0],2)+Math.pow(Ut[1]-tr[1],2)):0;setPoint(rt,_.v[ut%_._length],Bt,Mt,mt,sr/(2*(bt+1)),rr/(2*(bt+1)))}function zigZagSegment(rt,_,ut,mt,bt,St){for(var Mt=0;Mt<mt;Mt+=1){var Bt=(Mt+1)/(mt+1),Ut=bt===2?Math.sqrt(Math.pow(_.points[3][0]-_.points[0][0],2)+Math.pow(_.points[3][1]-_.points[0][1],2)):0,Ht=_.normalAngle(Bt);setPoint(rt,_.point(Bt),Ht,St,ut,Ut/(2*(mt+1)),Ut/(2*(mt+1))),St=-St}return St}function linearOffset(rt,_,ut){var mt=Math.atan2(_[0]-rt[0],_[1]-rt[1]);return[polarOffset(rt,mt,ut),polarOffset(_,mt,ut)]}function offsetSegment(rt,_){var ut,mt,bt,St,Mt,Bt,Ut;ut=(Ut=linearOffset(rt.points[0],rt.points[1],_))[0],mt=Ut[1],bt=(Ut=linearOffset(rt.points[1],rt.points[2],_))[0],St=Ut[1],Mt=(Ut=linearOffset(rt.points[2],rt.points[3],_))[0],Bt=Ut[1];var Ht=lineIntersection(ut,mt,bt,St);Ht===null&&(Ht=mt);var tr=lineIntersection(Mt,Bt,bt,St);return tr===null&&(tr=Mt),new PolynomialBezier(ut,Ht,tr,Bt)}function joinLines(rt,_,ut,mt,bt){var St=_.points[3],Mt=ut.points[0];if(mt===3||pointEqual(St,Mt))return St;if(mt===2){var Bt=-_.tangentAngle(1),Ut=-ut.tangentAngle(0)+Math.PI,Ht=lineIntersection(St,polarOffset(St,Bt+Math.PI/2,100),Mt,polarOffset(Mt,Bt+Math.PI/2,100)),tr=Ht?pointDistance(Ht,St):pointDistance(St,Mt)/2,rr=polarOffset(St,Bt,2*tr*roundCorner);return rt.setXYAt(rr[0],rr[1],"o",rt.length()-1),rr=polarOffset(Mt,Ut,2*tr*roundCorner),rt.setTripleAt(Mt[0],Mt[1],Mt[0],Mt[1],rr[0],rr[1],rt.length()),Mt}var sr=lineIntersection(pointEqual(St,_.points[2])?_.points[0]:_.points[2],St,Mt,pointEqual(Mt,ut.points[1])?ut.points[3]:ut.points[1]);return sr&&pointDistance(sr,St)<bt?(rt.setTripleAt(sr[0],sr[1],sr[0],sr[1],sr[0],sr[1],rt.length()),sr):St}function getIntersection(rt,_){var ut=rt.intersections(_);return ut.length&&floatEqual(ut[0][0],1)&&ut.shift(),ut.length?ut[0]:null}function pruneSegmentIntersection(rt,_){var ut=rt.slice(),mt=_.slice(),bt=getIntersection(rt[rt.length-1],_[0]);return bt&&(ut[rt.length-1]=rt[rt.length-1].split(bt[0])[0],mt[0]=_[0].split(bt[1])[1]),rt.length>1&&_.length>1&&(bt=getIntersection(rt[0],_[_.length-1]))?[[rt[0].split(bt[0])[0]],[_[_.length-1].split(bt[1])[1]]]:[ut,mt]}function pruneIntersections(rt){for(var _,ut=1;ut<rt.length;ut+=1)_=pruneSegmentIntersection(rt[ut-1],rt[ut]),rt[ut-1]=_[0],rt[ut]=_[1];return rt.length>1&&(_=pruneSegmentIntersection(rt[rt.length-1],rt[0]),rt[rt.length-1]=_[0],rt[0]=_[1]),rt}function offsetSegmentSplit(rt,_){var ut,mt,bt,St,Mt=rt.inflectionPoints();if(Mt.length===0)return[offsetSegment(rt,_)];if(Mt.length===1||floatEqual(Mt[1],1))return ut=(bt=rt.split(Mt[0]))[0],mt=bt[1],[offsetSegment(ut,_),offsetSegment(mt,_)];ut=(bt=rt.split(Mt[0]))[0];var Bt=(Mt[1]-Mt[0])/(1-Mt[0]);return St=(bt=bt[1].split(Bt))[0],mt=bt[1],[offsetSegment(ut,_),offsetSegment(St,_),offsetSegment(mt,_)]}function OffsetPathModifier(){}function getFontProperties(rt){for(var _=rt.fStyle?rt.fStyle.split(" "):[],ut="normal",mt="normal",bt=_.length,St=0;St<bt;St+=1)switch(_[St].toLowerCase()){case"italic":mt="italic";break;case"bold":ut="700";break;case"black":ut="900";break;case"medium":ut="500";break;case"regular":case"normal":ut="400";break;case"light":case"thin":ut="200"}return{style:mt,weight:rt.fWeight||ut}}extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(rt,_){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(rt,_.c,0,null,this),this.o=PropertyFactory.getProp(rt,_.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(rt,_.tr,this),this.so=PropertyFactory.getProp(rt,_.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(rt,_.tr.eo,0,.01,this),this.data=_,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(rt,_,ut,mt,bt,St){var Mt=St?-1:1,Bt=mt.s.v[0]+(1-mt.s.v[0])*(1-bt),Ut=mt.s.v[1]+(1-mt.s.v[1])*(1-bt);rt.translate(mt.p.v[0]*Mt*bt,mt.p.v[1]*Mt*bt,mt.p.v[2]),_.translate(-mt.a.v[0],-mt.a.v[1],mt.a.v[2]),_.rotate(-mt.r.v*Mt*bt),_.translate(mt.a.v[0],mt.a.v[1],mt.a.v[2]),ut.translate(-mt.a.v[0],-mt.a.v[1],mt.a.v[2]),ut.scale(St?1/Bt:Bt,St?1/Ut:Ut),ut.translate(mt.a.v[0],mt.a.v[1],mt.a.v[2])},RepeaterModifier.prototype.init=function(rt,_,ut,mt){for(this.elem=rt,this.arr=_,this.pos=ut,this.elemsData=mt,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(rt),this.initModifierProperties(rt,_[ut]);ut>0;)ut-=1,this._elements.unshift(_[ut]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(rt){var _,ut=rt.length;for(_=0;_<ut;_+=1)rt[_]._processed=!1,rt[_].ty==="gr"&&this.resetElements(rt[_].it)},RepeaterModifier.prototype.cloneElements=function(rt){var _=JSON.parse(JSON.stringify(rt));return this.resetElements(_),_},RepeaterModifier.prototype.changeGroupRender=function(rt,_){var ut,mt=rt.length;for(ut=0;ut<mt;ut+=1)rt[ut]._render=_,rt[ut].ty==="gr"&&this.changeGroupRender(rt[ut].it,_)},RepeaterModifier.prototype.processShapes=function(rt){var _,ut,mt,bt,St,Mt=!1;if(this._mdf||rt){var Bt,Ut=Math.ceil(this.c.v);if(this._groups.length<Ut){for(;this._groups.length<Ut;){var Ht={it:this.cloneElements(this._elements),ty:"gr"};Ht.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,Ht),this._groups.splice(0,0,Ht),this._currentCopies+=1}this.elem.reloadShapes(),Mt=!0}for(St=0,mt=0;mt<=this._groups.length-1;mt+=1){if(Bt=St<Ut,this._groups[mt]._render=Bt,this.changeGroupRender(this._groups[mt].it,Bt),!Bt){var tr=this.elemsData[mt].it,rr=tr[tr.length-1];rr.transform.op.v!==0?(rr.transform.op._mdf=!0,rr.transform.op.v=0):rr.transform.op._mdf=!1}St+=1}this._currentCopies=Ut;var sr=this.o.v,ar=sr%1,cr=sr>0?Math.floor(sr):Math.ceil(sr),Ar=this.pMatrix.props,_r=this.rMatrix.props,Dr=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var $r,Br,Jr=0;if(sr>0){for(;Jr<cr;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),Jr+=1;ar&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,ar,!1),Jr+=ar)}else if(sr<0){for(;Jr>cr;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),Jr-=1;ar&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-ar,!0),Jr-=ar)}for(mt=this.data.m===1?0:this._currentCopies-1,bt=this.data.m===1?1:-1,St=this._currentCopies;St;){if(Br=(ut=(_=this.elemsData[mt].it)[_.length-1].transform.mProps.v.props).length,_[_.length-1].transform.mProps._mdf=!0,_[_.length-1].transform.op._mdf=!0,_[_.length-1].transform.op.v=this._currentCopies===1?this.so.v:this.so.v+(this.eo.v-this.so.v)*(mt/(this._currentCopies-1)),Jr!==0){for((mt!==0&&bt===1||mt!==this._currentCopies-1&&bt===-1)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(_r[0],_r[1],_r[2],_r[3],_r[4],_r[5],_r[6],_r[7],_r[8],_r[9],_r[10],_r[11],_r[12],_r[13],_r[14],_r[15]),this.matrix.transform(Dr[0],Dr[1],Dr[2],Dr[3],Dr[4],Dr[5],Dr[6],Dr[7],Dr[8],Dr[9],Dr[10],Dr[11],Dr[12],Dr[13],Dr[14],Dr[15]),this.matrix.transform(Ar[0],Ar[1],Ar[2],Ar[3],Ar[4],Ar[5],Ar[6],Ar[7],Ar[8],Ar[9],Ar[10],Ar[11],Ar[12],Ar[13],Ar[14],Ar[15]),$r=0;$r<Br;$r+=1)ut[$r]=this.matrix.props[$r];this.matrix.reset()}else for(this.matrix.reset(),$r=0;$r<Br;$r+=1)ut[$r]=this.matrix.props[$r];Jr+=1,St-=1,mt+=bt}}else for(St=this._currentCopies,mt=0,bt=1;St;)ut=(_=this.elemsData[mt].it)[_.length-1].transform.mProps.v.props,_[_.length-1].transform.mProps._mdf=!1,_[_.length-1].transform.op._mdf=!1,St-=1,mt+=bt;return Mt},RepeaterModifier.prototype.addShape=function(){},extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(rt,_){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(rt,_.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(rt,_){var ut,mt=shapePool.newElement();mt.c=rt.c;var bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar,_r=rt._length,Dr=0;for(ut=0;ut<_r;ut+=1)bt=rt.v[ut],Mt=rt.o[ut],St=rt.i[ut],bt[0]===Mt[0]&&bt[1]===Mt[1]&&bt[0]===St[0]&&bt[1]===St[1]?ut!==0&&ut!==_r-1||rt.c?(Bt=ut===0?rt.v[_r-1]:rt.v[ut-1],Ht=(Ut=Math.sqrt(Math.pow(bt[0]-Bt[0],2)+Math.pow(bt[1]-Bt[1],2)))?Math.min(Ut/2,_)/Ut:0,tr=cr=bt[0]+(Bt[0]-bt[0])*Ht,rr=Ar=bt[1]-(bt[1]-Bt[1])*Ht,sr=tr-(tr-bt[0])*roundCorner,ar=rr-(rr-bt[1])*roundCorner,mt.setTripleAt(tr,rr,sr,ar,cr,Ar,Dr),Dr+=1,Bt=ut===_r-1?rt.v[0]:rt.v[ut+1],Ht=(Ut=Math.sqrt(Math.pow(bt[0]-Bt[0],2)+Math.pow(bt[1]-Bt[1],2)))?Math.min(Ut/2,_)/Ut:0,tr=sr=bt[0]+(Bt[0]-bt[0])*Ht,rr=ar=bt[1]+(Bt[1]-bt[1])*Ht,cr=tr-(tr-bt[0])*roundCorner,Ar=rr-(rr-bt[1])*roundCorner,mt.setTripleAt(tr,rr,sr,ar,cr,Ar,Dr),Dr+=1):(mt.setTripleAt(bt[0],bt[1],Mt[0],Mt[1],St[0],St[1],Dr),Dr+=1):(mt.setTripleAt(rt.v[ut][0],rt.v[ut][1],rt.o[ut][0],rt.o[ut][1],rt.i[ut][0],rt.i[ut][1],Dr),Dr+=1);return mt},RoundCornersModifier.prototype.processShapes=function(rt){var _,ut,mt,bt,St,Mt,Bt=this.shapes.length,Ut=this.rd.v;if(Ut!==0)for(ut=0;ut<Bt;ut+=1){if(Mt=(St=this.shapes[ut]).localShapeCollection,St.shape._mdf||this._mdf||rt)for(Mt.releaseShapes(),St.shape._mdf=!0,_=St.shape.paths.shapes,bt=St.shape.paths._length,mt=0;mt<bt;mt+=1)Mt.addShape(this.processPath(_[mt],Ut));St.shape.paths=St.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},PolynomialBezier.prototype.point=function(rt){return[((this.a[0]*rt+this.b[0])*rt+this.c[0])*rt+this.d[0],((this.a[1]*rt+this.b[1])*rt+this.c[1])*rt+this.d[1]]},PolynomialBezier.prototype.derivative=function(rt){return[(3*rt*this.a[0]+2*this.b[0])*rt+this.c[0],(3*rt*this.a[1]+2*this.b[1])*rt+this.c[1]]},PolynomialBezier.prototype.tangentAngle=function(rt){var _=this.derivative(rt);return Math.atan2(_[1],_[0])},PolynomialBezier.prototype.normalAngle=function(rt){var _=this.derivative(rt);return Math.atan2(_[0],_[1])},PolynomialBezier.prototype.inflectionPoints=function(){var rt=this.a[1]*this.b[0]-this.a[0]*this.b[1];if(floatZero(rt))return[];var _=-.5*(this.a[1]*this.c[0]-this.a[0]*this.c[1])/rt,ut=_*_-1/3*(this.b[1]*this.c[0]-this.b[0]*this.c[1])/rt;if(ut<0)return[];var mt=Math.sqrt(ut);return floatZero(mt)?mt>0&&mt<1?[_]:[]:[_-mt,_+mt].filter(function(bt){return bt>0&&bt<1})},PolynomialBezier.prototype.split=function(rt){if(rt<=0)return[singlePoint(this.points[0]),this];if(rt>=1)return[this,singlePoint(this.points[this.points.length-1])];var _=lerpPoint(this.points[0],this.points[1],rt),ut=lerpPoint(this.points[1],this.points[2],rt),mt=lerpPoint(this.points[2],this.points[3],rt),bt=lerpPoint(_,ut,rt),St=lerpPoint(ut,mt,rt),Mt=lerpPoint(bt,St,rt);return[new PolynomialBezier(this.points[0],_,bt,Mt,!0),new PolynomialBezier(Mt,St,mt,this.points[3],!0)]},PolynomialBezier.prototype.bounds=function(){return{x:extrema(this,0),y:extrema(this,1)}},PolynomialBezier.prototype.boundingBox=function(){var rt=this.bounds();return{left:rt.x.min,right:rt.x.max,top:rt.y.min,bottom:rt.y.max,width:rt.x.max-rt.x.min,height:rt.y.max-rt.y.min,cx:(rt.x.max+rt.x.min)/2,cy:(rt.y.max+rt.y.min)/2}},PolynomialBezier.prototype.intersections=function(rt,_,ut){_===void 0&&(_=2),ut===void 0&&(ut=7);var mt=[];return intersectsImpl(intersectData(this,0,1),intersectData(rt,0,1),0,_,mt,ut),mt},PolynomialBezier.shapeSegment=function(rt,_){var ut=(_+1)%rt.length();return new PolynomialBezier(rt.v[_],rt.o[_],rt.i[ut],rt.v[ut],!0)},PolynomialBezier.shapeSegmentInverted=function(rt,_){var ut=(_+1)%rt.length();return new PolynomialBezier(rt.v[ut],rt.i[ut],rt.o[_],rt.v[_],!0)},extendPrototype([ShapeModifier],ZigZagModifier),ZigZagModifier.prototype.initModifierProperties=function(rt,_){this.getValue=this.processKeys,this.amplitude=PropertyFactory.getProp(rt,_.s,0,null,this),this.frequency=PropertyFactory.getProp(rt,_.r,0,null,this),this.pointsType=PropertyFactory.getProp(rt,_.pt,0,null,this),this._isAnimated=this.amplitude.effectsSequence.length!==0||this.frequency.effectsSequence.length!==0||this.pointsType.effectsSequence.length!==0},ZigZagModifier.prototype.processPath=function(rt,_,ut,mt){var bt=rt._length,St=shapePool.newElement();if(St.c=rt.c,rt.c||(bt-=1),bt===0)return St;var Mt=-1,Bt=PolynomialBezier.shapeSegment(rt,0);zigZagCorner(St,rt,0,_,ut,mt,Mt);for(var Ut=0;Ut<bt;Ut+=1)Mt=zigZagSegment(St,Bt,_,ut,mt,-Mt),Bt=Ut!==bt-1||rt.c?PolynomialBezier.shapeSegment(rt,(Ut+1)%bt):null,zigZagCorner(St,rt,Ut+1,_,ut,mt,Mt);return St},ZigZagModifier.prototype.processShapes=function(rt){var _,ut,mt,bt,St,Mt,Bt=this.shapes.length,Ut=this.amplitude.v,Ht=Math.max(0,Math.round(this.frequency.v)),tr=this.pointsType.v;if(Ut!==0)for(ut=0;ut<Bt;ut+=1){if(Mt=(St=this.shapes[ut]).localShapeCollection,St.shape._mdf||this._mdf||rt)for(Mt.releaseShapes(),St.shape._mdf=!0,_=St.shape.paths.shapes,bt=St.shape.paths._length,mt=0;mt<bt;mt+=1)Mt.addShape(this.processPath(_[mt],Ut,Ht,tr));St.shape.paths=St.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},extendPrototype([ShapeModifier],OffsetPathModifier),OffsetPathModifier.prototype.initModifierProperties=function(rt,_){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(rt,_.a,0,null,this),this.miterLimit=PropertyFactory.getProp(rt,_.ml,0,null,this),this.lineJoin=_.lj,this._isAnimated=this.amount.effectsSequence.length!==0},OffsetPathModifier.prototype.processPath=function(rt,_,ut,mt){var bt=shapePool.newElement();bt.c=rt.c;var St,Mt,Bt,Ut=rt.length();rt.c||(Ut-=1);var Ht=[];for(St=0;St<Ut;St+=1)Bt=PolynomialBezier.shapeSegment(rt,St),Ht.push(offsetSegmentSplit(Bt,_));if(!rt.c)for(St=Ut-1;St>=0;St-=1)Bt=PolynomialBezier.shapeSegmentInverted(rt,St),Ht.push(offsetSegmentSplit(Bt,_));Ht=pruneIntersections(Ht);var tr=null,rr=null;for(St=0;St<Ht.length;St+=1){var sr=Ht[St];for(rr&&(tr=joinLines(bt,rr,sr[0],ut,mt)),rr=sr[sr.length-1],Mt=0;Mt<sr.length;Mt+=1)Bt=sr[Mt],tr&&pointEqual(Bt.points[0],tr)?bt.setXYAt(Bt.points[1][0],Bt.points[1][1],"o",bt.length()-1):bt.setTripleAt(Bt.points[0][0],Bt.points[0][1],Bt.points[1][0],Bt.points[1][1],Bt.points[0][0],Bt.points[0][1],bt.length()),bt.setTripleAt(Bt.points[3][0],Bt.points[3][1],Bt.points[3][0],Bt.points[3][1],Bt.points[2][0],Bt.points[2][1],bt.length()),tr=Bt.points[3]}return Ht.length&&joinLines(bt,rr,Ht[0][0],ut,mt),bt},OffsetPathModifier.prototype.processShapes=function(rt){var _,ut,mt,bt,St,Mt,Bt=this.shapes.length,Ut=this.amount.v,Ht=this.miterLimit.v,tr=this.lineJoin;if(Ut!==0)for(ut=0;ut<Bt;ut+=1){if(Mt=(St=this.shapes[ut]).localShapeCollection,St.shape._mdf||this._mdf||rt)for(Mt.releaseShapes(),St.shape._mdf=!0,_=St.shape.paths.shapes,bt=St.shape.paths._length,mt=0;mt<bt;mt+=1)Mt.addShape(this.processPath(_[mt],Ut,tr,Ht));St.shape.paths=St.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)};var FontManager=function(){var rt={w:0,size:0,shapes:[],data:{shapes:[]}},_=[];_=_.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var ut=["d83cdffb","d83cdffc","d83cdffd","d83cdffe","d83cdfff"],mt=[65039,8205];function bt(Bt,Ut){var Ht=createTag("span");Ht.setAttribute("aria-hidden",!0),Ht.style.fontFamily=Ut;var tr=createTag("span");tr.innerText="giItT1WQy@!-/#",Ht.style.position="absolute",Ht.style.left="-10000px",Ht.style.top="-10000px",Ht.style.fontSize="300px",Ht.style.fontVariant="normal",Ht.style.fontStyle="normal",Ht.style.fontWeight="normal",Ht.style.letterSpacing="0",Ht.appendChild(tr),document.body.appendChild(Ht);var rr=tr.offsetWidth;return tr.style.fontFamily=function(sr){var ar,cr=sr.split(","),Ar=cr.length,_r=[];for(ar=0;ar<Ar;ar+=1)cr[ar]!=="sans-serif"&&cr[ar]!=="monospace"&&_r.push(cr[ar]);return _r.join(",")}(Bt)+", "+Ut,{node:tr,w:rr,parent:Ht}}function St(Bt,Ut){var Ht,tr=document.body&&Ut?"svg":"canvas",rr=getFontProperties(Bt);if(tr==="svg"){var sr=createNS("text");sr.style.fontSize="100px",sr.setAttribute("font-family",Bt.fFamily),sr.setAttribute("font-style",rr.style),sr.setAttribute("font-weight",rr.weight),sr.textContent="1",Bt.fClass?(sr.style.fontFamily="inherit",sr.setAttribute("class",Bt.fClass)):sr.style.fontFamily=Bt.fFamily,Ut.appendChild(sr),Ht=sr}else{var ar=new OffscreenCanvas(500,500).getContext("2d");ar.font=rr.style+" "+rr.weight+" 100px "+Bt.fFamily,Ht=ar}return{measureText:function(cr){return tr==="svg"?(Ht.textContent=cr,Ht.getComputedTextLength()):Ht.measureText(cr).width}}}var Mt=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};return Mt.isModifier=function(Bt,Ut){var Ht=Bt.toString(16)+Ut.toString(16);return ut.indexOf(Ht)!==-1},Mt.isZeroWidthJoiner=function(Bt,Ut){return Ut?Bt===mt[0]&&Ut===mt[1]:Bt===mt[1]},Mt.isCombinedCharacter=function(Bt){return _.indexOf(Bt)!==-1},Mt.prototype={addChars:function(Bt){if(Bt){var Ut;this.chars||(this.chars=[]);var Ht,tr,rr=Bt.length,sr=this.chars.length;for(Ut=0;Ut<rr;Ut+=1){for(Ht=0,tr=!1;Ht<sr;)this.chars[Ht].style===Bt[Ut].style&&this.chars[Ht].fFamily===Bt[Ut].fFamily&&this.chars[Ht].ch===Bt[Ut].ch&&(tr=!0),Ht+=1;tr||(this.chars.push(Bt[Ut]),sr+=1)}}},addFonts:function(Bt,Ut){if(Bt){if(this.chars)return this.isLoaded=!0,void(this.fonts=Bt.list);if(!document.body)return this.isLoaded=!0,Bt.list.forEach(function(Br){Br.helper=St(Br),Br.cache={}}),void(this.fonts=Bt.list);var Ht,tr=Bt.list,rr=tr.length,sr=rr;for(Ht=0;Ht<rr;Ht+=1){var ar,cr,Ar=!0;if(tr[Ht].loaded=!1,tr[Ht].monoCase=bt(tr[Ht].fFamily,"monospace"),tr[Ht].sansCase=bt(tr[Ht].fFamily,"sans-serif"),tr[Ht].fPath){if(tr[Ht].fOrigin==="p"||tr[Ht].origin===3){if((ar=document.querySelectorAll('style[f-forigin="p"][f-family="'+tr[Ht].fFamily+'"], style[f-origin="3"][f-family="'+tr[Ht].fFamily+'"]')).length>0&&(Ar=!1),Ar){var _r=createTag("style");_r.setAttribute("f-forigin",tr[Ht].fOrigin),_r.setAttribute("f-origin",tr[Ht].origin),_r.setAttribute("f-family",tr[Ht].fFamily),_r.type="text/css",_r.innerText="@font-face {font-family: "+tr[Ht].fFamily+"; font-style: normal; src: url('"+tr[Ht].fPath+"');}",Ut.appendChild(_r)}}else if(tr[Ht].fOrigin==="g"||tr[Ht].origin===1){for(ar=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),cr=0;cr<ar.length;cr+=1)ar[cr].href.indexOf(tr[Ht].fPath)!==-1&&(Ar=!1);if(Ar){var Dr=createTag("link");Dr.setAttribute("f-forigin",tr[Ht].fOrigin),Dr.setAttribute("f-origin",tr[Ht].origin),Dr.type="text/css",Dr.rel="stylesheet",Dr.href=tr[Ht].fPath,document.body.appendChild(Dr)}}else if(tr[Ht].fOrigin==="t"||tr[Ht].origin===2){for(ar=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),cr=0;cr<ar.length;cr+=1)tr[Ht].fPath===ar[cr].src&&(Ar=!1);if(Ar){var $r=createTag("link");$r.setAttribute("f-forigin",tr[Ht].fOrigin),$r.setAttribute("f-origin",tr[Ht].origin),$r.setAttribute("rel","stylesheet"),$r.setAttribute("href",tr[Ht].fPath),Ut.appendChild($r)}}}else tr[Ht].loaded=!0,sr-=1;tr[Ht].helper=St(tr[Ht],Ut),tr[Ht].cache={},this.fonts.push(tr[Ht])}sr===0?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}else this.isLoaded=!0},getCharData:function(Bt,Ut,Ht){for(var tr=0,rr=this.chars.length;tr<rr;){if(this.chars[tr].ch===Bt&&this.chars[tr].style===Ut&&this.chars[tr].fFamily===Ht)return this.chars[tr];tr+=1}return(typeof Bt=="string"&&Bt.charCodeAt(0)!==13||!Bt)&&console&&console.warn&&!this._warned&&(this._warned=!0),rt},getFontByName:function(Bt){for(var Ut=0,Ht=this.fonts.length;Ut<Ht;){if(this.fonts[Ut].fName===Bt)return this.fonts[Ut];Ut+=1}return this.fonts[0]},measureText:function(Bt,Ut,Ht){var tr=this.getFontByName(Ut),rr=Bt.charCodeAt(0);if(!tr.cache[rr+1]){var sr=tr.helper;if(Bt===" "){var ar=sr.measureText("|"+Bt+"|"),cr=sr.measureText("||");tr.cache[rr+1]=(ar-cr)/100}else tr.cache[rr+1]=sr.measureText(Bt)/100}return tr.cache[rr+1]*Ht},checkLoadedFonts:function(){var Bt,Ut,Ht,tr=this.fonts.length,rr=tr;for(Bt=0;Bt<tr;Bt+=1)this.fonts[Bt].loaded?rr-=1:this.fonts[Bt].fOrigin==="n"||this.fonts[Bt].origin===0?this.fonts[Bt].loaded=!0:(Ut=this.fonts[Bt].monoCase.node,Ht=this.fonts[Bt].monoCase.w,Ut.offsetWidth!==Ht?(rr-=1,this.fonts[Bt].loaded=!0):(Ut=this.fonts[Bt].sansCase.node,Ht=this.fonts[Bt].sansCase.w,Ut.offsetWidth!==Ht&&(rr-=1,this.fonts[Bt].loaded=!0)),this.fonts[Bt].loaded&&(this.fonts[Bt].sansCase.parent.parentNode.removeChild(this.fonts[Bt].sansCase.parent),this.fonts[Bt].monoCase.parent.parentNode.removeChild(this.fonts[Bt].monoCase.parent)));rr!==0&&Date.now()-this.initTime<5e3?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)},setIsLoaded:function(){this.isLoaded=!0}},Mt}();function RenderableElement(){}RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(rt){this.renderableComponents.indexOf(rt)===-1&&this.renderableComponents.push(rt)},removeRenderableComponent:function(rt){this.renderableComponents.indexOf(rt)!==-1&&this.renderableComponents.splice(this.renderableComponents.indexOf(rt),1)},prepareRenderableFrame:function(rt){this.checkLayerLimits(rt)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(rt){this.data.ip-this.data.st<=rt&&this.data.op-this.data.st>rt?this.isInRange!==!0&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):this.isInRange!==!1&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var rt,_=this.renderableComponents.length;for(rt=0;rt<_;rt+=1)this.renderableComponents[rt].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return this.data.ty===5?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}};var getBlendMode=(blendModeEnums={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"},function(rt){return blendModeEnums[rt]||""}),blendModeEnums;function SliderEffect(rt,_,ut){this.p=PropertyFactory.getProp(_,rt.v,0,0,ut)}function AngleEffect(rt,_,ut){this.p=PropertyFactory.getProp(_,rt.v,0,0,ut)}function ColorEffect(rt,_,ut){this.p=PropertyFactory.getProp(_,rt.v,1,0,ut)}function PointEffect(rt,_,ut){this.p=PropertyFactory.getProp(_,rt.v,1,0,ut)}function LayerIndexEffect(rt,_,ut){this.p=PropertyFactory.getProp(_,rt.v,0,0,ut)}function MaskIndexEffect(rt,_,ut){this.p=PropertyFactory.getProp(_,rt.v,0,0,ut)}function CheckboxEffect(rt,_,ut){this.p=PropertyFactory.getProp(_,rt.v,0,0,ut)}function NoValueEffect(){this.p={}}function EffectsManager(rt,_){var ut,mt=rt.ef||[];this.effectElements=[];var bt,St=mt.length;for(ut=0;ut<St;ut+=1)bt=new GroupEffect(mt[ut],_),this.effectElements.push(bt)}function GroupEffect(rt,_){this.init(rt,_)}function BaseElement(){}function FrameElement(){}function FootageElement(rt,_,ut){this.initFrame(),this.initRenderable(),this.assetData=_.getAssetData(rt.refId),this.footageData=_.imageLoader.getAsset(this.assetData),this.initBaseData(rt,_,ut)}function AudioElement(rt,_,ut){this.initFrame(),this.initRenderable(),this.assetData=_.getAssetData(rt.refId),this.initBaseData(rt,_,ut),this._isPlaying=!1,this._canPlay=!1;var mt=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(mt),this._currentTime=0,this.globalData.audioController.addAudio(this),this._volumeMultiplier=1,this._volume=1,this._previousVolume=null,this.tm=rt.tm?PropertyFactory.getProp(this,rt.tm,0,_.frameRate,this):{_placeholder:!0},this.lv=PropertyFactory.getProp(this,rt.au&&rt.au.lv?rt.au.lv:{k:[100]},1,.01,this)}function BaseRenderer(){}function TransformElement(){}function MaskElement(rt,_,ut){this.data=rt,this.element=_,this.globalData=ut,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var mt,bt,St=this.globalData.defs,Mt=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(Mt),this.solidPath="";var Bt,Ut,Ht,tr,rr,sr,ar=this.masksProperties,cr=0,Ar=[],_r=createElementID(),Dr="clipPath",$r="clip-path";for(mt=0;mt<Mt;mt+=1)if((ar[mt].mode!=="a"&&ar[mt].mode!=="n"||ar[mt].inv||ar[mt].o.k!==100||ar[mt].o.x)&&(Dr="mask",$r="mask"),ar[mt].mode!=="s"&&ar[mt].mode!=="i"||cr!==0?Ht=null:((Ht=createNS("rect")).setAttribute("fill","#ffffff"),Ht.setAttribute("width",this.element.comp.data.w||0),Ht.setAttribute("height",this.element.comp.data.h||0),Ar.push(Ht)),bt=createNS("path"),ar[mt].mode==="n")this.viewData[mt]={op:PropertyFactory.getProp(this.element,ar[mt].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,ar[mt],3),elem:bt,lastPath:""},St.appendChild(bt);else{var Br;if(cr+=1,bt.setAttribute("fill",ar[mt].mode==="s"?"#000000":"#ffffff"),bt.setAttribute("clip-rule","nonzero"),ar[mt].x.k!==0?(Dr="mask",$r="mask",sr=PropertyFactory.getProp(this.element,ar[mt].x,0,null,this.element),Br=createElementID(),(tr=createNS("filter")).setAttribute("id",Br),(rr=createNS("feMorphology")).setAttribute("operator","erode"),rr.setAttribute("in","SourceGraphic"),rr.setAttribute("radius","0"),tr.appendChild(rr),St.appendChild(tr),bt.setAttribute("stroke",ar[mt].mode==="s"?"#000000":"#ffffff")):(rr=null,sr=null),this.storedData[mt]={elem:bt,x:sr,expan:rr,lastPath:"",lastOperator:"",filterId:Br,lastRadius:0},ar[mt].mode==="i"){Ut=Ar.length;var Jr=createNS("g");for(Bt=0;Bt<Ut;Bt+=1)Jr.appendChild(Ar[Bt]);var mn=createNS("mask");mn.setAttribute("mask-type","alpha"),mn.setAttribute("id",_r+"_"+cr),mn.appendChild(bt),St.appendChild(mn),Jr.setAttribute("mask","url("+getLocationHref()+"#"+_r+"_"+cr+")"),Ar.length=0,Ar.push(Jr)}else Ar.push(bt);ar[mt].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[mt]={elem:bt,lastPath:"",op:PropertyFactory.getProp(this.element,ar[mt].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,ar[mt],3),invRect:Ht},this.viewData[mt].prop.k||this.drawPath(ar[mt],this.viewData[mt].prop.v,this.viewData[mt])}for(this.maskElement=createNS(Dr),Mt=Ar.length,mt=0;mt<Mt;mt+=1)this.maskElement.appendChild(Ar[mt]);cr>0&&(this.maskElement.setAttribute("id",_r),this.element.maskedElement.setAttribute($r,"url("+getLocationHref()+"#"+_r+")"),St.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(rt,_){var ut;this.data=rt,this.effectElements=[],this.initDynamicPropertyContainer(_);var mt,bt=this.data.ef.length,St=this.data.ef;for(ut=0;ut<bt;ut+=1){switch(mt=null,St[ut].ty){case 0:mt=new SliderEffect(St[ut],_,this);break;case 1:mt=new AngleEffect(St[ut],_,this);break;case 2:mt=new ColorEffect(St[ut],_,this);break;case 3:mt=new PointEffect(St[ut],_,this);break;case 4:case 7:mt=new CheckboxEffect(St[ut],_,this);break;case 10:mt=new LayerIndexEffect(St[ut],_,this);break;case 11:mt=new MaskIndexEffect(St[ut],_,this);break;case 5:mt=new EffectsManager(St[ut],_);break;default:mt=new NoValueEffect(St[ut])}mt&&this.effectElements.push(mt)}},BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var rt=0,_=this.data.masksProperties.length;rt<_;){if(this.data.masksProperties[rt].mode!=="n"&&this.data.masksProperties[rt].cl!==!1)return!0;rt+=1}return!1},initExpressions:function(){var rt=getExpressionInterfaces();if(rt){var _=rt("layer"),ut=rt("effects"),mt=rt("shape"),bt=rt("text"),St=rt("comp");this.layerInterface=_(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var Mt=ut.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(Mt),this.data.ty===0||this.data.xt?this.compInterface=St(this):this.data.ty===4?(this.layerInterface.shapeInterface=mt(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):this.data.ty===5&&(this.layerInterface.textInterface=bt(this),this.layerInterface.text=this.layerInterface.textInterface)}},setBlendMode:function(){var rt=getBlendMode(this.data.bm);(this.baseElement||this.layerElement).style["mix-blend-mode"]=rt},initBaseData:function(rt,_,ut){this.globalData=_,this.comp=ut,this.data=rt,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}},FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(rt,_){var ut,mt=this.dynamicProperties.length;for(ut=0;ut<mt;ut+=1)(_||this._isParent&&this.dynamicProperties[ut].propType==="transform")&&(this.dynamicProperties[ut].getValue(),this.dynamicProperties[ut]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(rt){this.dynamicProperties.indexOf(rt)===-1&&this.dynamicProperties.push(rt)}},FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){var rt=getExpressionInterfaces();if(rt){var _=rt("footage");this.layerInterface=_(this)}},FootageElement.prototype.getFootageData=function(){return this.footageData},AudioElement.prototype.prepareFrame=function(rt){if(this.prepareRenderableFrame(rt,!0),this.prepareProperties(rt,!0),this.tm._placeholder)this._currentTime=rt/this.data.sr;else{var _=this.tm.v;this._currentTime=_}this._volume=this.lv.v[0];var ut=this._volume*this._volumeMultiplier;this._previousVolume!==ut&&(this._previousVolume=ut,this.audio.volume(ut))},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(rt){this.audio.rate(rt)},AudioElement.prototype.volume=function(rt){this._volumeMultiplier=rt,this._previousVolume=rt*this._volume,this.audio.volume(this._previousVolume)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){},BaseRenderer.prototype.checkLayers=function(rt){var _,ut,mt=this.layers.length;for(this.completeLayers=!0,_=mt-1;_>=0;_-=1)this.elements[_]||(ut=this.layers[_]).ip-ut.st<=rt-this.layers[_].st&&ut.op-ut.st>rt-this.layers[_].st&&this.buildItem(_),this.completeLayers=!!this.elements[_]&&this.completeLayers;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(rt){switch(rt.ty){case 2:return this.createImage(rt);case 0:return this.createComp(rt);case 1:return this.createSolid(rt);case 3:return this.createNull(rt);case 4:return this.createShape(rt);case 5:return this.createText(rt);case 6:return this.createAudio(rt);case 13:return this.createCamera(rt);case 15:return this.createFootage(rt);default:return this.createNull(rt)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(rt){return new AudioElement(rt,this.globalData,this)},BaseRenderer.prototype.createFootage=function(rt){return new FootageElement(rt,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var rt,_=this.layers.length;for(rt=0;rt<_;rt+=1)this.buildItem(rt);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(rt){var _;this.completeLayers=!1;var ut,mt=rt.length,bt=this.layers.length;for(_=0;_<mt;_+=1)for(ut=0;ut<bt;){if(this.layers[ut].id===rt[_].id){this.layers[ut]=rt[_];break}ut+=1}},BaseRenderer.prototype.setProjectInterface=function(rt){this.globalData.projectInterface=rt},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(rt,_,ut){for(var mt=this.elements,bt=this.layers,St=0,Mt=bt.length;St<Mt;)bt[St].ind==_&&(mt[St]&&mt[St]!==!0?(ut.push(mt[St]),mt[St].setAsParent(),bt[St].parent!==void 0?this.buildElementParenting(rt,bt[St].parent,ut):rt.setHierarchy(ut)):(this.buildItem(St),this.addPendingElement(rt))),St+=1},BaseRenderer.prototype.addPendingElement=function(rt){this.pendingElements.push(rt)},BaseRenderer.prototype.searchExtraCompositions=function(rt){var _,ut=rt.length;for(_=0;_<ut;_+=1)if(rt[_].xt){var mt=this.createComp(rt[_]);mt.initExpressions(),this.globalData.projectInterface.registerComposition(mt)}},BaseRenderer.prototype.getElementById=function(rt){var _,ut=this.elements.length;for(_=0;_<ut;_+=1)if(this.elements[_].data.ind===rt)return this.elements[_];return null},BaseRenderer.prototype.getElementByPath=function(rt){var _,ut=rt.shift();if(typeof ut=="number")_=this.elements[ut];else{var mt,bt=this.elements.length;for(mt=0;mt<bt;mt+=1)if(this.elements[mt].data.nm===ut){_=this.elements[mt];break}}return rt.length===0?_:_.getElementByPath(rt)},BaseRenderer.prototype.setupGlobalData=function(rt,_){this.globalData.fontManager=new FontManager,this.globalData.fontManager.addChars(rt.chars),this.globalData.fontManager.addFonts(rt.fonts,_),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=rt.fr,this.globalData.nm=rt.nm,this.globalData.compSize={w:rt.w,h:rt.h}},TransformElement.prototype={initTransform:function(){this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_opMdf:!1,mat:new Matrix},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var rt,_=this.finalTransform.mat,ut=0,mt=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;ut<mt;){if(this.hierarchy[ut].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}ut+=1}if(this.finalTransform._matMdf)for(rt=this.finalTransform.mProp.v.props,_.cloneFromProps(rt),ut=0;ut<mt;ut+=1)rt=this.hierarchy[ut].finalTransform.mProp.v.props,_.transform(rt[0],rt[1],rt[2],rt[3],rt[4],rt[5],rt[6],rt[7],rt[8],rt[9],rt[10],rt[11],rt[12],rt[13],rt[14],rt[15])}},globalToLocal:function(rt){var _=[];_.push(this.finalTransform);for(var ut,mt=!0,bt=this.comp;mt;)bt.finalTransform?(bt.data.hasMask&&_.splice(0,0,bt.finalTransform),bt=bt.comp):mt=!1;var St,Mt=_.length;for(ut=0;ut<Mt;ut+=1)St=_[ut].mat.applyToPointArray(0,0,0),rt=[rt[0]-St[0],rt[1]-St[1],0];return rt},mHelper:new Matrix},MaskElement.prototype.getMaskProperty=function(rt){return this.viewData[rt].prop},MaskElement.prototype.renderFrame=function(rt){var _,ut=this.element.finalTransform.mat,mt=this.masksProperties.length;for(_=0;_<mt;_+=1)if((this.viewData[_].prop._mdf||rt)&&this.drawPath(this.masksProperties[_],this.viewData[_].prop.v,this.viewData[_]),(this.viewData[_].op._mdf||rt)&&this.viewData[_].elem.setAttribute("fill-opacity",this.viewData[_].op.v),this.masksProperties[_].mode!=="n"&&(this.viewData[_].invRect&&(this.element.finalTransform.mProp._mdf||rt)&&this.viewData[_].invRect.setAttribute("transform",ut.getInverseMatrix().to2dCSS()),this.storedData[_].x&&(this.storedData[_].x._mdf||rt))){var bt=this.storedData[_].expan;this.storedData[_].x.v<0?(this.storedData[_].lastOperator!=="erode"&&(this.storedData[_].lastOperator="erode",this.storedData[_].elem.setAttribute("filter","url("+getLocationHref()+"#"+this.storedData[_].filterId+")")),bt.setAttribute("radius",-this.storedData[_].x.v)):(this.storedData[_].lastOperator!=="dilate"&&(this.storedData[_].lastOperator="dilate",this.storedData[_].elem.setAttribute("filter",null)),this.storedData[_].elem.setAttribute("stroke-width",2*this.storedData[_].x.v))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var rt="M0,0 ";return rt+=" h"+this.globalData.compSize.w,rt+=" v"+this.globalData.compSize.h,rt+=" h-"+this.globalData.compSize.w,rt+=" v-"+this.globalData.compSize.h+" "},MaskElement.prototype.drawPath=function(rt,_,ut){var mt,bt,St=" M"+_.v[0][0]+","+_.v[0][1];for(bt=_._length,mt=1;mt<bt;mt+=1)St+=" C"+_.o[mt-1][0]+","+_.o[mt-1][1]+" "+_.i[mt][0]+","+_.i[mt][1]+" "+_.v[mt][0]+","+_.v[mt][1];if(_.c&&bt>1&&(St+=" C"+_.o[mt-1][0]+","+_.o[mt-1][1]+" "+_.i[0][0]+","+_.i[0][1]+" "+_.v[0][0]+","+_.v[0][1]),ut.lastPath!==St){var Mt="";ut.elem&&(_.c&&(Mt=rt.inv?this.solidPath+St:St),ut.elem.setAttribute("d",Mt)),ut.lastPath=St}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null};var filtersFactory=function(){var rt={};return rt.createFilter=function(_,ut){var mt=createNS("filter");return mt.setAttribute("id",_),ut!==!0&&(mt.setAttribute("filterUnits","objectBoundingBox"),mt.setAttribute("x","0%"),mt.setAttribute("y","0%"),mt.setAttribute("width","100%"),mt.setAttribute("height","100%")),mt},rt.createAlphaToLuminanceFilter=function(){var _=createNS("feColorMatrix");return _.setAttribute("type","matrix"),_.setAttribute("color-interpolation-filters","sRGB"),_.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),_},rt}(),featureSupport=function(){var rt={maskType:!0,svgLumaHidden:!0,offscreenCanvas:typeof OffscreenCanvas<"u"};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(rt.maskType=!1),/firefox/i.test(navigator.userAgent)&&(rt.svgLumaHidden=!1),rt}(),registeredEffects={},idPrefix="filter_result_";function SVGEffects(rt){var _,ut,mt="SourceGraphic",bt=rt.data.ef?rt.data.ef.length:0,St=createElementID(),Mt=filtersFactory.createFilter(St,!0),Bt=0;for(this.filters=[],_=0;_<bt;_+=1){ut=null;var Ut=rt.data.ef[_].ty;registeredEffects[Ut]&&(ut=new registeredEffects[Ut].effect(Mt,rt.effectsManager.effectElements[_],rt,idPrefix+Bt,mt),mt=idPrefix+Bt,registeredEffects[Ut].countsAsEffect&&(Bt+=1)),ut&&this.filters.push(ut)}Bt&&(rt.globalData.defs.appendChild(Mt),rt.layerElement.setAttribute("filter","url("+getLocationHref()+"#"+St+")")),this.filters.length&&rt.addRenderableComponent(this)}function registerEffect(rt,_,ut){registeredEffects[rt]={effect:_,countsAsEffect:ut}}function SVGBaseElement(){}function HierarchyElement(){}function RenderableDOMElement(){}function IImageElement(rt,_,ut){this.assetData=_.getAssetData(rt.refId),this.initElement(rt,_,ut),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}function ProcessedElement(rt,_){this.elem=rt,this.pos=_}function IShapeElement(){}SVGEffects.prototype.renderFrame=function(rt){var _,ut=this.filters.length;for(_=0;_<ut;_+=1)this.filters[_].renderFrame(rt)},SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var rt=null;if(this.data.td){this.matteMasks={};var _=createNS("g");_.setAttribute("id",this.layerId),_.appendChild(this.layerElement),rt=_,this.globalData.defs.appendChild(_)}else this.data.tt?(this.matteElement.appendChild(this.layerElement),rt=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.ty===0&&!this.data.hd){var ut=createNS("clipPath"),mt=createNS("path");mt.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var bt=createElementID();if(ut.setAttribute("id",bt),ut.appendChild(mt),this.globalData.defs.appendChild(ut),this.checkMasks()){var St=createNS("g");St.setAttribute("clip-path","url("+getLocationHref()+"#"+bt+")"),St.appendChild(this.layerElement),this.transformedElement=St,rt?rt.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+bt+")")}this.data.bm!==0&&this.setBlendMode()},renderElement:function(){this.finalTransform._matMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.mat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.mProp.o.v)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this)},getMatte:function(rt){if(this.matteMasks||(this.matteMasks={}),!this.matteMasks[rt]){var _,ut,mt,bt,St=this.layerId+"_"+rt;if(rt===1||rt===3){var Mt=createNS("mask");Mt.setAttribute("id",St),Mt.setAttribute("mask-type",rt===3?"luminance":"alpha"),(mt=createNS("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),Mt.appendChild(mt),this.globalData.defs.appendChild(Mt),featureSupport.maskType||rt!==1||(Mt.setAttribute("mask-type","luminance"),_=createElementID(),ut=filtersFactory.createFilter(_),this.globalData.defs.appendChild(ut),ut.appendChild(filtersFactory.createAlphaToLuminanceFilter()),(bt=createNS("g")).appendChild(mt),Mt.appendChild(bt),bt.setAttribute("filter","url("+getLocationHref()+"#"+_+")"))}else if(rt===2){var Bt=createNS("mask");Bt.setAttribute("id",St),Bt.setAttribute("mask-type","alpha");var Ut=createNS("g");Bt.appendChild(Ut),_=createElementID(),ut=filtersFactory.createFilter(_);var Ht=createNS("feComponentTransfer");Ht.setAttribute("in","SourceGraphic"),ut.appendChild(Ht);var tr=createNS("feFuncA");tr.setAttribute("type","table"),tr.setAttribute("tableValues","1.0 0.0"),Ht.appendChild(tr),this.globalData.defs.appendChild(ut);var rr=createNS("rect");rr.setAttribute("width",this.comp.data.w),rr.setAttribute("height",this.comp.data.h),rr.setAttribute("x","0"),rr.setAttribute("y","0"),rr.setAttribute("fill","#ffffff"),rr.setAttribute("opacity","0"),Ut.setAttribute("filter","url("+getLocationHref()+"#"+_+")"),Ut.appendChild(rr),(mt=createNS("use")).setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.layerId),Ut.appendChild(mt),featureSupport.maskType||(Bt.setAttribute("mask-type","luminance"),ut.appendChild(filtersFactory.createAlphaToLuminanceFilter()),bt=createNS("g"),Ut.appendChild(rr),bt.appendChild(this.layerElement),Ut.appendChild(bt)),this.globalData.defs.appendChild(Bt)}this.matteMasks[rt]=St}return this.matteMasks[rt]},setMatte:function(rt){this.matteElement&&this.matteElement.setAttribute("mask","url("+getLocationHref()+"#"+rt+")")}},HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(rt){this.hierarchy=rt},setAsParent:function(){this._isParent=!0},checkParenting:function(){this.data.parent!==void 0&&this.comp.buildElementParenting(this,this.data.parent,[])}},extendPrototype([RenderableElement,createProxyFunction({initElement:function(rt,_,ut){this.initFrame(),this.initBaseData(rt,_,ut),this.initTransform(rt,_,ut),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){this.hidden||this.isInRange&&!this.isTransparent||((this.baseElement||this.layerElement).style.display="none",this.hidden=!0)},show:function(){this.isInRange&&!this.isTransparent&&(this.data.hd||((this.baseElement||this.layerElement).style.display="block"),this.hidden=!1,this._isFirstFrame=!0)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(rt){this._mdf=!1,this.prepareRenderableFrame(rt),this.prepareProperties(rt,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}})],RenderableDOMElement),extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var rt=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",rt),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect},IShapeElement.prototype={addShapeToModifiers:function(rt){var _,ut=this.shapeModifiers.length;for(_=0;_<ut;_+=1)this.shapeModifiers[_].addShape(rt)},isShapeInAnimatedModifiers:function(rt){for(var _=this.shapeModifiers.length;0<_;)if(this.shapeModifiers[0].isAnimatedWithShape(rt))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var rt,_=this.shapes.length;for(rt=0;rt<_;rt+=1)this.shapes[rt].sh.reset();for(rt=(_=this.shapeModifiers.length)-1;rt>=0&&!this.shapeModifiers[rt].processShapes(this._isFirstFrame);rt-=1);}},searchProcessedElement:function(rt){for(var _=this.processedElements,ut=0,mt=_.length;ut<mt;){if(_[ut].elem===rt)return _[ut].pos;ut+=1}return 0},addProcessedElement:function(rt,_){for(var ut=this.processedElements,mt=ut.length;mt;)if(ut[mt-=1].elem===rt)return void(ut[mt].pos=_);ut.push(new ProcessedElement(rt,_))},prepareFrame:function(rt){this.prepareRenderableFrame(rt),this.prepareProperties(rt,this.isInRange)}};var lineCapEnum={1:"butt",2:"round",3:"square"},lineJoinEnum={1:"miter",2:"round",3:"bevel"};function SVGShapeData(rt,_,ut){this.caches=[],this.styles=[],this.transformers=rt,this.lStr="",this.sh=ut,this.lvl=_,this._isAnimated=!!ut.k;for(var mt=0,bt=rt.length;mt<bt;){if(rt[mt].mProps.dynamicProperties.length){this._isAnimated=!0;break}mt+=1}}function SVGStyleData(rt,_){this.data=rt,this.type=rt.ty,this.d="",this.lvl=_,this._mdf=!1,this.closed=rt.hd===!0,this.pElem=createNS("path"),this.msElem=null}function DashProperty(rt,_,ut,mt){var bt;this.elem=rt,this.frameId=-1,this.dataProps=createSizedArray(_.length),this.renderer=ut,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",_.length?_.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(mt);var St,Mt=_.length||0;for(bt=0;bt<Mt;bt+=1)St=PropertyFactory.getProp(rt,_[bt].v,0,0,this),this.k=St.k||this.k,this.dataProps[bt]={n:_[bt].n,p:St};this.k||this.getValue(!0),this._isAnimated=this.k}function SVGStrokeStyleData(rt,_,ut){this.initDynamicPropertyContainer(rt),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(rt,_.o,0,.01,this),this.w=PropertyFactory.getProp(rt,_.w,0,null,this),this.d=new DashProperty(rt,_.d||{},"svg",this),this.c=PropertyFactory.getProp(rt,_.c,1,255,this),this.style=ut,this._isAnimated=!!this._isAnimated}function SVGFillStyleData(rt,_,ut){this.initDynamicPropertyContainer(rt),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(rt,_.o,0,.01,this),this.c=PropertyFactory.getProp(rt,_.c,1,255,this),this.style=ut}function SVGNoStyleData(rt,_,ut){this.initDynamicPropertyContainer(rt),this.getValue=this.iterateDynamicProperties,this.style=ut}function GradientProperty(rt,_,ut){this.data=_,this.c=createTypedArray("uint8c",4*_.p);var mt=_.k.k[0].s?_.k.k[0].s.length-4*_.p:_.k.k.length-4*_.p;this.o=createTypedArray("float32",mt),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=mt,this.initDynamicPropertyContainer(ut),this.prop=PropertyFactory.getProp(rt,_.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}function SVGGradientFillStyleData(rt,_,ut){this.initDynamicPropertyContainer(rt),this.getValue=this.iterateDynamicProperties,this.initGradientData(rt,_,ut)}function SVGGradientStrokeStyleData(rt,_,ut){this.initDynamicPropertyContainer(rt),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(rt,_.w,0,null,this),this.d=new DashProperty(rt,_.d||{},"svg",this),this.initGradientData(rt,_,ut),this._isAnimated=!!this._isAnimated}function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}function SVGTransformData(rt,_,ut){this.transform={mProps:rt,op:_,container:ut},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0},SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1},DashProperty.prototype.getValue=function(rt){if((this.elem.globalData.frameId!==this.frameId||rt)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||rt,this._mdf)){var _=0,ut=this.dataProps.length;for(this.renderer==="svg"&&(this.dashStr=""),_=0;_<ut;_+=1)this.dataProps[_].n!=="o"?this.renderer==="svg"?this.dashStr+=" "+this.dataProps[_].p.v:this.dashArray[_]=this.dataProps[_].p.v:this.dashoffset[0]=this.dataProps[_].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty),extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData),extendPrototype([DynamicPropertyContainer],SVGFillStyleData),extendPrototype([DynamicPropertyContainer],SVGNoStyleData),GradientProperty.prototype.comparePoints=function(rt,_){for(var ut=0,mt=this.o.length/2;ut<mt;){if(Math.abs(rt[4*ut]-rt[4*_+2*ut])>.01)return!1;ut+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!=this.c.length/4)return!1;if(this.data.k.k[0].s)for(var rt=0,_=this.data.k.k.length;rt<_;){if(!this.comparePoints(this.data.k.k[rt].s,this.data.p))return!1;rt+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(rt){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||rt){var _,ut,mt,bt=4*this.data.p;for(_=0;_<bt;_+=1)ut=_%4==0?100:255,mt=Math.round(this.prop.v[_]*ut),this.c[_]!==mt&&(this.c[_]=mt,this._cmdf=!rt);if(this.o.length)for(bt=this.prop.v.length,_=4*this.data.p;_<bt;_+=1)ut=_%2==0?100:1,mt=_%2==0?Math.round(100*this.prop.v[_]):this.prop.v[_],this.o[_-4*this.data.p]!==mt&&(this.o[_-4*this.data.p]=mt,this._omdf=!rt);this._mdf=!rt}},extendPrototype([DynamicPropertyContainer],GradientProperty),SVGGradientFillStyleData.prototype.initGradientData=function(rt,_,ut){this.o=PropertyFactory.getProp(rt,_.o,0,.01,this),this.s=PropertyFactory.getProp(rt,_.s,1,null,this),this.e=PropertyFactory.getProp(rt,_.e,1,null,this),this.h=PropertyFactory.getProp(rt,_.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(rt,_.a||{k:0},0,degToRads,this),this.g=new GradientProperty(rt,_.g,this),this.style=ut,this.stops=[],this.setGradientData(ut.pElem,_),this.setGradientOpacity(_,ut),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(rt,_){var ut=createElementID(),mt=createNS(_.t===1?"linearGradient":"radialGradient");mt.setAttribute("id",ut),mt.setAttribute("spreadMethod","pad"),mt.setAttribute("gradientUnits","userSpaceOnUse");var bt,St,Mt,Bt=[];for(Mt=4*_.g.p,St=0;St<Mt;St+=4)bt=createNS("stop"),mt.appendChild(bt),Bt.push(bt);rt.setAttribute(_.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+ut+")"),this.gf=mt,this.cst=Bt},SVGGradientFillStyleData.prototype.setGradientOpacity=function(rt,_){if(this.g._hasOpacity&&!this.g._collapsable){var ut,mt,bt,St=createNS("mask"),Mt=createNS("path");St.appendChild(Mt);var Bt=createElementID(),Ut=createElementID();St.setAttribute("id",Ut);var Ht=createNS(rt.t===1?"linearGradient":"radialGradient");Ht.setAttribute("id",Bt),Ht.setAttribute("spreadMethod","pad"),Ht.setAttribute("gradientUnits","userSpaceOnUse"),bt=rt.g.k.k[0].s?rt.g.k.k[0].s.length:rt.g.k.k.length;var tr=this.stops;for(mt=4*rt.g.p;mt<bt;mt+=2)(ut=createNS("stop")).setAttribute("stop-color","rgb(255,255,255)"),Ht.appendChild(ut),tr.push(ut);Mt.setAttribute(rt.ty==="gf"?"fill":"stroke","url("+getLocationHref()+"#"+Bt+")"),rt.ty==="gs"&&(Mt.setAttribute("stroke-linecap",lineCapEnum[rt.lc||2]),Mt.setAttribute("stroke-linejoin",lineJoinEnum[rt.lj||2]),rt.lj===1&&Mt.setAttribute("stroke-miterlimit",rt.ml)),this.of=Ht,this.ms=St,this.ost=tr,this.maskId=Ut,_.msElem=Mt}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData),extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);var buildShapeString=function(rt,_,ut,mt){if(_===0)return"";var bt,St=rt.o,Mt=rt.i,Bt=rt.v,Ut=" M"+mt.applyToPointStringified(Bt[0][0],Bt[0][1]);for(bt=1;bt<_;bt+=1)Ut+=" C"+mt.applyToPointStringified(St[bt-1][0],St[bt-1][1])+" "+mt.applyToPointStringified(Mt[bt][0],Mt[bt][1])+" "+mt.applyToPointStringified(Bt[bt][0],Bt[bt][1]);return ut&&_&&(Ut+=" C"+mt.applyToPointStringified(St[bt-1][0],St[bt-1][1])+" "+mt.applyToPointStringified(Mt[0][0],Mt[0][1])+" "+mt.applyToPointStringified(Bt[0][0],Bt[0][1]),Ut+="z"),Ut},SVGElementsRenderer=function(){var rt=new Matrix,_=new Matrix;function ut(Ht,tr,rr){(rr||tr.transform.op._mdf)&&tr.transform.container.setAttribute("opacity",tr.transform.op.v),(rr||tr.transform.mProps._mdf)&&tr.transform.container.setAttribute("transform",tr.transform.mProps.v.to2dCSS())}function mt(){}function bt(Ht,tr,rr){var sr,ar,cr,Ar,_r,Dr,$r,Br,Jr,mn,Mn,$n=tr.styles.length,en=tr.lvl;for(Dr=0;Dr<$n;Dr+=1){if(Ar=tr.sh._mdf||rr,tr.styles[Dr].lvl<en){for(Br=_.reset(),mn=en-tr.styles[Dr].lvl,Mn=tr.transformers.length-1;!Ar&&mn>0;)Ar=tr.transformers[Mn].mProps._mdf||Ar,mn-=1,Mn-=1;if(Ar)for(mn=en-tr.styles[Dr].lvl,Mn=tr.transformers.length-1;mn>0;)Jr=tr.transformers[Mn].mProps.v.props,Br.transform(Jr[0],Jr[1],Jr[2],Jr[3],Jr[4],Jr[5],Jr[6],Jr[7],Jr[8],Jr[9],Jr[10],Jr[11],Jr[12],Jr[13],Jr[14],Jr[15]),mn-=1,Mn-=1}else Br=rt;if(ar=($r=tr.sh.paths)._length,Ar){for(cr="",sr=0;sr<ar;sr+=1)(_r=$r.shapes[sr])&&_r._length&&(cr+=buildShapeString(_r,_r._length,_r.c,Br));tr.caches[Dr]=cr}else cr=tr.caches[Dr];tr.styles[Dr].d+=Ht.hd===!0?"":cr,tr.styles[Dr]._mdf=Ar||tr.styles[Dr]._mdf}}function St(Ht,tr,rr){var sr=tr.style;(tr.c._mdf||rr)&&sr.pElem.setAttribute("fill","rgb("+bmFloor(tr.c.v[0])+","+bmFloor(tr.c.v[1])+","+bmFloor(tr.c.v[2])+")"),(tr.o._mdf||rr)&&sr.pElem.setAttribute("fill-opacity",tr.o.v)}function Mt(Ht,tr,rr){Bt(Ht,tr,rr),Ut(Ht,tr,rr)}function Bt(Ht,tr,rr){var sr,ar,cr,Ar,_r,Dr=tr.gf,$r=tr.g._hasOpacity,Br=tr.s.v,Jr=tr.e.v;if(tr.o._mdf||rr){var mn=Ht.ty==="gf"?"fill-opacity":"stroke-opacity";tr.style.pElem.setAttribute(mn,tr.o.v)}if(tr.s._mdf||rr){var Mn=Ht.t===1?"x1":"cx",$n=Mn==="x1"?"y1":"cy";Dr.setAttribute(Mn,Br[0]),Dr.setAttribute($n,Br[1]),$r&&!tr.g._collapsable&&(tr.of.setAttribute(Mn,Br[0]),tr.of.setAttribute($n,Br[1]))}if(tr.g._cmdf||rr){sr=tr.cst;var en=tr.g.c;for(cr=sr.length,ar=0;ar<cr;ar+=1)(Ar=sr[ar]).setAttribute("offset",en[4*ar]+"%"),Ar.setAttribute("stop-color","rgb("+en[4*ar+1]+","+en[4*ar+2]+","+en[4*ar+3]+")")}if($r&&(tr.g._omdf||rr)){var In=tr.g.o;for(cr=(sr=tr.g._collapsable?tr.cst:tr.ost).length,ar=0;ar<cr;ar+=1)Ar=sr[ar],tr.g._collapsable||Ar.setAttribute("offset",In[2*ar]+"%"),Ar.setAttribute("stop-opacity",In[2*ar+1])}if(Ht.t===1)(tr.e._mdf||rr)&&(Dr.setAttribute("x2",Jr[0]),Dr.setAttribute("y2",Jr[1]),$r&&!tr.g._collapsable&&(tr.of.setAttribute("x2",Jr[0]),tr.of.setAttribute("y2",Jr[1])));else if((tr.s._mdf||tr.e._mdf||rr)&&(_r=Math.sqrt(Math.pow(Br[0]-Jr[0],2)+Math.pow(Br[1]-Jr[1],2)),Dr.setAttribute("r",_r),$r&&!tr.g._collapsable&&tr.of.setAttribute("r",_r)),tr.e._mdf||tr.h._mdf||tr.a._mdf||rr){_r||(_r=Math.sqrt(Math.pow(Br[0]-Jr[0],2)+Math.pow(Br[1]-Jr[1],2)));var Rn=Math.atan2(Jr[1]-Br[1],Jr[0]-Br[0]),qn=tr.h.v;qn>=1?qn=.99:qn<=-1&&(qn=-.99);var Qn=_r*qn,xs=Math.cos(Rn+tr.a.v)*Qn+Br[0],cs=Math.sin(Rn+tr.a.v)*Qn+Br[1];Dr.setAttribute("fx",xs),Dr.setAttribute("fy",cs),$r&&!tr.g._collapsable&&(tr.of.setAttribute("fx",xs),tr.of.setAttribute("fy",cs))}}function Ut(Ht,tr,rr){var sr=tr.style,ar=tr.d;ar&&(ar._mdf||rr)&&ar.dashStr&&(sr.pElem.setAttribute("stroke-dasharray",ar.dashStr),sr.pElem.setAttribute("stroke-dashoffset",ar.dashoffset[0])),tr.c&&(tr.c._mdf||rr)&&sr.pElem.setAttribute("stroke","rgb("+bmFloor(tr.c.v[0])+","+bmFloor(tr.c.v[1])+","+bmFloor(tr.c.v[2])+")"),(tr.o._mdf||rr)&&sr.pElem.setAttribute("stroke-opacity",tr.o.v),(tr.w._mdf||rr)&&(sr.pElem.setAttribute("stroke-width",tr.w.v),sr.msElem&&sr.msElem.setAttribute("stroke-width",tr.w.v))}return{createRenderFunction:function(Ht){switch(Ht.ty){case"fl":return St;case"gf":return Bt;case"gs":return Mt;case"st":return Ut;case"sh":case"el":case"rc":case"sr":return bt;case"tr":return ut;case"no":return mt;default:return null}}}}();function SVGShapeElement(rt,_,ut){this.shapes=[],this.shapesData=rt.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(rt,_,ut),this.prevViewData=[]}function LetterProps(rt,_,ut,mt,bt,St){this.o=rt,this.sw=_,this.sc=ut,this.fc=mt,this.m=bt,this.p=St,this._mdf={o:!0,sw:!!_,sc:!!ut,fc:!!mt,m:!0,p:!0}}function TextProperty(rt,_){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,this.data=_,this.elem=rt,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var rt,_,ut,mt,bt=this.shapes.length,St=this.stylesList.length,Mt=[],Bt=!1;for(ut=0;ut<St;ut+=1){for(mt=this.stylesList[ut],Bt=!1,Mt.length=0,rt=0;rt<bt;rt+=1)(_=this.shapes[rt]).styles.indexOf(mt)!==-1&&(Mt.push(_),Bt=_._isAnimated||Bt);Mt.length>1&&Bt&&this.setShapesAsAnimated(Mt)}},SVGShapeElement.prototype.setShapesAsAnimated=function(rt){var _,ut=rt.length;for(_=0;_<ut;_+=1)rt[_].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(rt,_){var ut,mt=new SVGStyleData(rt,_),bt=mt.pElem;return rt.ty==="st"?ut=new SVGStrokeStyleData(this,rt,mt):rt.ty==="fl"?ut=new SVGFillStyleData(this,rt,mt):rt.ty==="gf"||rt.ty==="gs"?(ut=new(rt.ty==="gf"?SVGGradientFillStyleData:SVGGradientStrokeStyleData)(this,rt,mt),this.globalData.defs.appendChild(ut.gf),ut.maskId&&(this.globalData.defs.appendChild(ut.ms),this.globalData.defs.appendChild(ut.of),bt.setAttribute("mask","url("+getLocationHref()+"#"+ut.maskId+")"))):rt.ty==="no"&&(ut=new SVGNoStyleData(this,rt,mt)),rt.ty!=="st"&&rt.ty!=="gs"||(bt.setAttribute("stroke-linecap",lineCapEnum[rt.lc||2]),bt.setAttribute("stroke-linejoin",lineJoinEnum[rt.lj||2]),bt.setAttribute("fill-opacity","0"),rt.lj===1&&bt.setAttribute("stroke-miterlimit",rt.ml)),rt.r===2&&bt.setAttribute("fill-rule","evenodd"),rt.ln&&bt.setAttribute("id",rt.ln),rt.cl&&bt.setAttribute("class",rt.cl),rt.bm&&(bt.style["mix-blend-mode"]=getBlendMode(rt.bm)),this.stylesList.push(mt),this.addToAnimatedContents(rt,ut),ut},SVGShapeElement.prototype.createGroupElement=function(rt){var _=new ShapeGroupData;return rt.ln&&_.gr.setAttribute("id",rt.ln),rt.cl&&_.gr.setAttribute("class",rt.cl),rt.bm&&(_.gr.style["mix-blend-mode"]=getBlendMode(rt.bm)),_},SVGShapeElement.prototype.createTransformElement=function(rt,_){var ut=TransformPropertyFactory.getTransformProperty(this,rt,this),mt=new SVGTransformData(ut,ut.o,_);return this.addToAnimatedContents(rt,mt),mt},SVGShapeElement.prototype.createShapeElement=function(rt,_,ut){var mt=4;rt.ty==="rc"?mt=5:rt.ty==="el"?mt=6:rt.ty==="sr"&&(mt=7);var bt=new SVGShapeData(_,ut,ShapePropertyFactory.getShapeProp(this,rt,mt,this));return this.shapes.push(bt),this.addShapeToModifiers(bt),this.addToAnimatedContents(rt,bt),bt},SVGShapeElement.prototype.addToAnimatedContents=function(rt,_){for(var ut=0,mt=this.animatedContents.length;ut<mt;){if(this.animatedContents[ut].element===_)return;ut+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(rt),element:_,data:rt})},SVGShapeElement.prototype.setElementStyles=function(rt){var _,ut=rt.styles,mt=this.stylesList.length;for(_=0;_<mt;_+=1)this.stylesList[_].closed||ut.push(this.stylesList[_])},SVGShapeElement.prototype.reloadShapes=function(){var rt;this._isFirstFrame=!0;var _=this.itemsData.length;for(rt=0;rt<_;rt+=1)this.prevViewData[rt]=this.itemsData[rt];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),_=this.dynamicProperties.length,rt=0;rt<_;rt+=1)this.dynamicProperties[rt].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(rt,_,ut,mt,bt,St,Mt){var Bt,Ut,Ht,tr,rr,sr,ar=[].concat(St),cr=rt.length-1,Ar=[],_r=[];for(Bt=cr;Bt>=0;Bt-=1){if((sr=this.searchProcessedElement(rt[Bt]))?_[Bt]=ut[sr-1]:rt[Bt]._render=Mt,rt[Bt].ty==="fl"||rt[Bt].ty==="st"||rt[Bt].ty==="gf"||rt[Bt].ty==="gs"||rt[Bt].ty==="no")sr?_[Bt].style.closed=!1:_[Bt]=this.createStyleElement(rt[Bt],bt),rt[Bt]._render&&_[Bt].style.pElem.parentNode!==mt&&mt.appendChild(_[Bt].style.pElem),Ar.push(_[Bt].style);else if(rt[Bt].ty==="gr"){if(sr)for(Ht=_[Bt].it.length,Ut=0;Ut<Ht;Ut+=1)_[Bt].prevViewData[Ut]=_[Bt].it[Ut];else _[Bt]=this.createGroupElement(rt[Bt]);this.searchShapes(rt[Bt].it,_[Bt].it,_[Bt].prevViewData,_[Bt].gr,bt+1,ar,Mt),rt[Bt]._render&&_[Bt].gr.parentNode!==mt&&mt.appendChild(_[Bt].gr)}else rt[Bt].ty==="tr"?(sr||(_[Bt]=this.createTransformElement(rt[Bt],mt)),tr=_[Bt].transform,ar.push(tr)):rt[Bt].ty==="sh"||rt[Bt].ty==="rc"||rt[Bt].ty==="el"||rt[Bt].ty==="sr"?(sr||(_[Bt]=this.createShapeElement(rt[Bt],ar,bt)),this.setElementStyles(_[Bt])):rt[Bt].ty==="tm"||rt[Bt].ty==="rd"||rt[Bt].ty==="ms"||rt[Bt].ty==="pb"||rt[Bt].ty==="zz"||rt[Bt].ty==="op"?(sr?(rr=_[Bt]).closed=!1:((rr=ShapeModifiers.getModifier(rt[Bt].ty)).init(this,rt[Bt]),_[Bt]=rr,this.shapeModifiers.push(rr)),_r.push(rr)):rt[Bt].ty==="rp"&&(sr?(rr=_[Bt]).closed=!0:(rr=ShapeModifiers.getModifier(rt[Bt].ty),_[Bt]=rr,rr.init(this,rt,Bt,_),this.shapeModifiers.push(rr),Mt=!1),_r.push(rr));this.addProcessedElement(rt[Bt],Bt+1)}for(cr=Ar.length,Bt=0;Bt<cr;Bt+=1)Ar[Bt].closed=!0;for(cr=_r.length,Bt=0;Bt<cr;Bt+=1)_r[Bt].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){var rt;this.renderModifiers();var _=this.stylesList.length;for(rt=0;rt<_;rt+=1)this.stylesList[rt].reset();for(this.renderShape(),rt=0;rt<_;rt+=1)(this.stylesList[rt]._mdf||this._isFirstFrame)&&(this.stylesList[rt].msElem&&(this.stylesList[rt].msElem.setAttribute("d",this.stylesList[rt].d),this.stylesList[rt].d="M0 0"+this.stylesList[rt].d),this.stylesList[rt].pElem.setAttribute("d",this.stylesList[rt].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var rt,_,ut=this.animatedContents.length;for(rt=0;rt<ut;rt+=1)_=this.animatedContents[rt],(this._isFirstFrame||_.element._isAnimated)&&_.data!==!0&&_.fn(_.data,_.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null},LetterProps.prototype.update=function(rt,_,ut,mt,bt,St){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var Mt=!1;return this.o!==rt&&(this.o=rt,this._mdf.o=!0,Mt=!0),this.sw!==_&&(this.sw=_,this._mdf.sw=!0,Mt=!0),this.sc!==ut&&(this.sc=ut,this._mdf.sc=!0,Mt=!0),this.fc!==mt&&(this.fc=mt,this._mdf.fc=!0,Mt=!0),this.m!==bt&&(this.m=bt,this._mdf.m=!0,Mt=!0),!St.length||this.p[0]===St[0]&&this.p[1]===St[1]&&this.p[4]===St[4]&&this.p[5]===St[5]&&this.p[12]===St[12]&&this.p[13]===St[13]||(this.p=St,this._mdf.p=!0,Mt=!0),Mt},TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(rt,_){for(var ut in _)Object.prototype.hasOwnProperty.call(_,ut)&&(rt[ut]=_[ut]);return rt},TextProperty.prototype.setCurrentData=function(rt){rt.__complete||this.completeTextData(rt),this.currentData=rt,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(rt){this.effectsSequence.push(rt),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(rt){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length||rt){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var _=this.currentData,ut=this.keysIndex;if(this.lock)this.setCurrentData(this.currentData);else{var mt;this.lock=!0,this._mdf=!1;var bt=this.effectsSequence.length,St=rt||this.data.d.k[this.keysIndex].s;for(mt=0;mt<bt;mt+=1)St=ut!==this.keysIndex?this.effectsSequence[mt](St,St.t):this.effectsSequence[mt](this.currentData,St.t);_!==St&&this.setCurrentData(St),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}}},TextProperty.prototype.getKeyframeValue=function(){for(var rt=this.data.d.k,_=this.elem.comp.renderedFrame,ut=0,mt=rt.length;ut<=mt-1&&!(ut===mt-1||rt[ut+1].t>_);)ut+=1;return this.keysIndex!==ut&&(this.keysIndex=ut),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(rt){for(var _,ut,mt=[],bt=0,St=rt.length,Mt=!1;bt<St;)_=rt.charCodeAt(bt),FontManager.isCombinedCharacter(_)?mt[mt.length-1]+=rt.charAt(bt):_>=55296&&_<=56319?(ut=rt.charCodeAt(bt+1))>=56320&&ut<=57343?(Mt||FontManager.isModifier(_,ut)?(mt[mt.length-1]+=rt.substr(bt,2),Mt=!1):mt.push(rt.substr(bt,2)),bt+=1):mt.push(rt.charAt(bt)):_>56319?(ut=rt.charCodeAt(bt+1),FontManager.isZeroWidthJoiner(_,ut)?(Mt=!0,mt[mt.length-1]+=rt.substr(bt,2),bt+=1):mt.push(rt.charAt(bt))):FontManager.isZeroWidthJoiner(_)?(mt[mt.length-1]+=rt.charAt(bt),Mt=!0):mt.push(rt.charAt(bt)),bt+=1;return mt},TextProperty.prototype.completeTextData=function(rt){rt.__complete=!0;var _,ut,mt,bt,St,Mt,Bt,Ut=this.elem.globalData.fontManager,Ht=this.data,tr=[],rr=0,sr=Ht.m.g,ar=0,cr=0,Ar=0,_r=[],Dr=0,$r=0,Br=Ut.getFontByName(rt.f),Jr=0,mn=getFontProperties(Br);rt.fWeight=mn.weight,rt.fStyle=mn.style,rt.finalSize=rt.s,rt.finalText=this.buildFinalText(rt.t),ut=rt.finalText.length,rt.finalLineHeight=rt.lh;var Mn,$n=rt.tr/1e3*rt.finalSize;if(rt.sz)for(var en,In,Rn=!0,qn=rt.sz[0],Qn=rt.sz[1];Rn;){en=0,Dr=0,ut=(In=this.buildFinalText(rt.t)).length,$n=rt.tr/1e3*rt.finalSize;var xs=-1;for(_=0;_<ut;_+=1)Mn=In[_].charCodeAt(0),mt=!1,In[_]===" "?xs=_:Mn!==13&&Mn!==3||(Dr=0,mt=!0,en+=rt.finalLineHeight||1.2*rt.finalSize),Ut.chars?(Bt=Ut.getCharData(In[_],Br.fStyle,Br.fFamily),Jr=mt?0:Bt.w*rt.finalSize/100):Jr=Ut.measureText(In[_],rt.f,rt.finalSize),Dr+Jr>qn&&In[_]!==" "?(xs===-1?ut+=1:_=xs,en+=rt.finalLineHeight||1.2*rt.finalSize,In.splice(_,xs===_?1:0,"\r"),xs=-1,Dr=0):(Dr+=Jr,Dr+=$n);en+=Br.ascent*rt.finalSize/100,this.canResize&&rt.finalSize>this.minimumFontSize&&Qn<en?(rt.finalSize-=1,rt.finalLineHeight=rt.finalSize*rt.lh/rt.s):(rt.finalText=In,ut=rt.finalText.length,Rn=!1)}Dr=-$n,Jr=0;var cs,ks=0;for(_=0;_<ut;_+=1)if(mt=!1,(Mn=(cs=rt.finalText[_]).charCodeAt(0))===13||Mn===3?(ks=0,_r.push(Dr),$r=Dr>$r?Dr:$r,Dr=-2*$n,bt="",mt=!0,Ar+=1):bt=cs,Ut.chars?(Bt=Ut.getCharData(cs,Br.fStyle,Ut.getFontByName(rt.f).fFamily),Jr=mt?0:Bt.w*rt.finalSize/100):Jr=Ut.measureText(bt,rt.f,rt.finalSize),cs===" "?ks+=Jr+$n:(Dr+=Jr+$n+ks,ks=0),tr.push({l:Jr,an:Jr,add:ar,n:mt,anIndexes:[],val:bt,line:Ar,animatorJustifyOffset:0}),sr==2){if(ar+=Jr,bt===""||bt===" "||_===ut-1){for(bt!==""&&bt!==" "||(ar-=Jr);cr<=_;)tr[cr].an=ar,tr[cr].ind=rr,tr[cr].extra=Jr,cr+=1;rr+=1,ar=0}}else if(sr==3){if(ar+=Jr,bt===""||_===ut-1){for(bt===""&&(ar-=Jr);cr<=_;)tr[cr].an=ar,tr[cr].ind=rr,tr[cr].extra=Jr,cr+=1;ar=0,rr+=1}}else tr[rr].ind=rr,tr[rr].extra=0,rr+=1;if(rt.l=tr,$r=Dr>$r?Dr:$r,_r.push(Dr),rt.sz)rt.boxWidth=rt.sz[0],rt.justifyOffset=0;else switch(rt.boxWidth=$r,rt.j){case 1:rt.justifyOffset=-rt.boxWidth;break;case 2:rt.justifyOffset=-rt.boxWidth/2;break;default:rt.justifyOffset=0}rt.lineWidths=_r;var _o,qs,Ss,eo,Ao=Ht.a;Mt=Ao.length;var Oo=[];for(St=0;St<Mt;St+=1){for((_o=Ao[St]).a.sc&&(rt.strokeColorAnim=!0),_o.a.sw&&(rt.strokeWidthAnim=!0),(_o.a.fc||_o.a.fh||_o.a.fs||_o.a.fb)&&(rt.fillColorAnim=!0),eo=0,Ss=_o.s.b,_=0;_<ut;_+=1)(qs=tr[_]).anIndexes[St]=eo,(Ss==1&&qs.val!==""||Ss==2&&qs.val!==""&&qs.val!==" "||Ss==3&&(qs.n||qs.val==" "||_==ut-1)||Ss==4&&(qs.n||_==ut-1))&&(_o.s.rn===1&&Oo.push(eo),eo+=1);Ht.a[St].s.totalChars=eo;var uo,uu=-1;if(_o.s.rn===1)for(_=0;_<ut;_+=1)uu!=(qs=tr[_]).anIndexes[St]&&(uu=qs.anIndexes[St],uo=Oo.splice(Math.floor(Math.random()*Oo.length),1)[0]),qs.anIndexes[St]=uo}rt.yOffset=rt.finalLineHeight||1.2*rt.finalSize,rt.ls=rt.ls||0,rt.ascent=Br.ascent*rt.finalSize/100},TextProperty.prototype.updateDocumentData=function(rt,_){_=_===void 0?this.keysIndex:_;var ut=this.copyData({},this.data.d.k[_].s);ut=this.copyData(ut,rt),this.data.d.k[_].s=ut,this.recalculate(_),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(rt){var _=this.data.d.k[rt].s;_.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(_)},TextProperty.prototype.canResizeFont=function(rt){this.canResize=rt,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(rt){this.minimumFontSize=Math.floor(rt)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var rt=Math.max,_=Math.min,ut=Math.floor;function mt(bt,St){this._currentTextLength=-1,this.k=!1,this.data=St,this.elem=bt,this.comp=bt.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(bt),this.s=PropertyFactory.getProp(bt,St.s||{k:0},0,0,this),this.e="e"in St?PropertyFactory.getProp(bt,St.e,0,0,this):{v:100},this.o=PropertyFactory.getProp(bt,St.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(bt,St.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(bt,St.ne||{k:0},0,0,this),this.sm=PropertyFactory.getProp(bt,St.sm||{k:100},0,0,this),this.a=PropertyFactory.getProp(bt,St.a,0,.01,this),this.dynamicProperties.length||this.getValue()}return mt.prototype={getMult:function(bt){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var St=0,Mt=0,Bt=1,Ut=1;this.ne.v>0?St=this.ne.v/100:Mt=-this.ne.v/100,this.xe.v>0?Bt=1-this.xe.v/100:Ut=1+this.xe.v/100;var Ht=BezierFactory.getBezierEasing(St,Mt,Bt,Ut).get,tr=0,rr=this.finalS,sr=this.finalE,ar=this.data.sh;if(ar===2)tr=Ht(tr=sr===rr?bt>=sr?1:0:rt(0,_(.5/(sr-rr)+(bt-rr)/(sr-rr),1)));else if(ar===3)tr=Ht(tr=sr===rr?bt>=sr?0:1:1-rt(0,_(.5/(sr-rr)+(bt-rr)/(sr-rr),1)));else if(ar===4)sr===rr?tr=0:(tr=rt(0,_(.5/(sr-rr)+(bt-rr)/(sr-rr),1)))<.5?tr*=2:tr=1-2*(tr-.5),tr=Ht(tr);else if(ar===5){if(sr===rr)tr=0;else{var cr=sr-rr,Ar=-cr/2+(bt=_(rt(0,bt+.5-rr),sr-rr)),_r=cr/2;tr=Math.sqrt(1-Ar*Ar/(_r*_r))}tr=Ht(tr)}else ar===6?(sr===rr?tr=0:(bt=_(rt(0,bt+.5-rr),sr-rr),tr=(1+Math.cos(Math.PI+2*Math.PI*bt/(sr-rr)))/2),tr=Ht(tr)):(bt>=ut(rr)&&(tr=rt(0,_(bt-rr<0?_(sr,1)-(rr-bt):sr-bt,1))),tr=Ht(tr));if(this.sm.v!==100){var Dr=.01*this.sm.v;Dr===0&&(Dr=1e-8);var $r=.5-.5*Dr;tr<$r?tr=0:(tr=(tr-$r)/Dr)>1&&(tr=1)}return tr*this.a.v},getValue:function(bt){this.iterateDynamicProperties(),this._mdf=bt||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,bt&&this.data.r===2&&(this.e.v=this._currentTextLength);var St=this.data.r===2?1:100/this.data.totalChars,Mt=this.o.v/St,Bt=this.s.v/St+Mt,Ut=this.e.v/St+Mt;if(Bt>Ut){var Ht=Bt;Bt=Ut,Ut=Ht}this.finalS=Bt,this.finalE=Ut}},extendPrototype([DynamicPropertyContainer],mt),{getTextSelectorProp:function(bt,St,Mt){return new mt(bt,St)}}}();function TextAnimatorDataProperty(rt,_,ut){var mt={propType:!1},bt=PropertyFactory.getProp,St=_.a;this.a={r:St.r?bt(rt,St.r,0,degToRads,ut):mt,rx:St.rx?bt(rt,St.rx,0,degToRads,ut):mt,ry:St.ry?bt(rt,St.ry,0,degToRads,ut):mt,sk:St.sk?bt(rt,St.sk,0,degToRads,ut):mt,sa:St.sa?bt(rt,St.sa,0,degToRads,ut):mt,s:St.s?bt(rt,St.s,1,.01,ut):mt,a:St.a?bt(rt,St.a,1,0,ut):mt,o:St.o?bt(rt,St.o,0,.01,ut):mt,p:St.p?bt(rt,St.p,1,0,ut):mt,sw:St.sw?bt(rt,St.sw,0,0,ut):mt,sc:St.sc?bt(rt,St.sc,1,0,ut):mt,fc:St.fc?bt(rt,St.fc,1,0,ut):mt,fh:St.fh?bt(rt,St.fh,0,0,ut):mt,fs:St.fs?bt(rt,St.fs,0,.01,ut):mt,fb:St.fb?bt(rt,St.fb,0,.01,ut):mt,t:St.t?bt(rt,St.t,0,0,ut):mt},this.s=TextSelectorProp.getTextSelectorProp(rt,_.s,ut),this.s.t=_.s.t}function TextAnimatorProperty(rt,_,ut){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=rt,this._renderType=_,this._elem=ut,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(ut)}function ITextElement(){}TextAnimatorProperty.prototype.searchProperties=function(){var rt,_,ut=this._textData.a.length,mt=PropertyFactory.getProp;for(rt=0;rt<ut;rt+=1)_=this._textData.a[rt],this._animatorsData[rt]=new TextAnimatorDataProperty(this._elem,_,this);this._textData.p&&"m"in this._textData.p?(this._pathData={a:mt(this._elem,this._textData.p.a,0,0,this),f:mt(this._elem,this._textData.p.f,0,0,this),l:mt(this._elem,this._textData.p.l,0,0,this),r:mt(this._elem,this._textData.p.r,0,0,this),p:mt(this._elem,this._textData.p.p,0,0,this),m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=mt(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(rt,_){if(this.lettersChangedFlag=_,this._mdf||this._isFirstFrame||_||this._hasMaskedPath&&this._pathData.m._mdf){this._isFirstFrame=!1;var ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar,_r,Dr,$r,Br,Jr,mn=this._moreOptions.alignment.v,Mn=this._animatorsData,$n=this._textData,en=this.mHelper,In=this._renderType,Rn=this.renderedLetters.length,qn=rt.l;if(this._hasMaskedPath){if(Jr=this._pathData.m,!this._pathData.n||this._pathData._mdf){var Qn,xs=Jr.v;for(this._pathData.r.v&&(xs=xs.reverse()),Mt={tLength:0,segments:[]},St=xs._length-1,Dr=0,bt=0;bt<St;bt+=1)Qn=bez.buildBezierData(xs.v[bt],xs.v[bt+1],[xs.o[bt][0]-xs.v[bt][0],xs.o[bt][1]-xs.v[bt][1]],[xs.i[bt+1][0]-xs.v[bt+1][0],xs.i[bt+1][1]-xs.v[bt+1][1]]),Mt.tLength+=Qn.segmentLength,Mt.segments.push(Qn),Dr+=Qn.segmentLength;bt=St,Jr.v.c&&(Qn=bez.buildBezierData(xs.v[bt],xs.v[0],[xs.o[bt][0]-xs.v[bt][0],xs.o[bt][1]-xs.v[bt][1]],[xs.i[0][0]-xs.v[0][0],xs.i[0][1]-xs.v[0][1]]),Mt.tLength+=Qn.segmentLength,Mt.segments.push(Qn),Dr+=Qn.segmentLength),this._pathData.pi=Mt}if(Mt=this._pathData.pi,Bt=this._pathData.f.v,sr=0,rr=1,Ht=0,tr=!0,Ar=Mt.segments,Bt<0&&Jr.v.c)for(Mt.tLength<Math.abs(Bt)&&(Bt=-Math.abs(Bt)%Mt.tLength),rr=(cr=Ar[sr=Ar.length-1].points).length-1;Bt<0;)Bt+=cr[rr].partialLength,(rr-=1)<0&&(rr=(cr=Ar[sr-=1].points).length-1);ar=(cr=Ar[sr].points)[rr-1],_r=(Ut=cr[rr]).partialLength}St=qn.length,ut=0,mt=0;var cs,ks,_o,qs,Ss,eo=1.2*rt.finalSize*.714,Ao=!0;_o=Mn.length;var Oo,uo,uu,cu,Jl,mu,pu,Zu,Mp,Up,Ep,mp,Cp=-1,t0=Bt,_g=sr,m0=rr,K0=-1,Jp="",y0=this.defaultPropsArray;if(rt.j===2||rt.j===1){var z0=0,jm=0,Nu=rt.j===2?-.5:-1,Co=0,Bp=!0;for(bt=0;bt<St;bt+=1)if(qn[bt].n){for(z0&&(z0+=jm);Co<bt;)qn[Co].animatorJustifyOffset=z0,Co+=1;z0=0,Bp=!0}else{for(ks=0;ks<_o;ks+=1)(cs=Mn[ks].a).t.propType&&(Bp&&rt.j===2&&(jm+=cs.t.v*Nu),(Ss=Mn[ks].s.getMult(qn[bt].anIndexes[ks],$n.a[ks].s.totalChars)).length?z0+=cs.t.v*Ss[0]*Nu:z0+=cs.t.v*Ss*Nu);Bp=!1}for(z0&&(z0+=jm);Co<bt;)qn[Co].animatorJustifyOffset=z0,Co+=1}for(bt=0;bt<St;bt+=1){if(en.reset(),cu=1,qn[bt].n)ut=0,mt+=rt.yOffset,mt+=Ao?1:0,Bt=t0,Ao=!1,this._hasMaskedPath&&(rr=m0,ar=(cr=Ar[sr=_g].points)[rr-1],_r=(Ut=cr[rr]).partialLength,Ht=0),Jp="",Ep="",Mp="",mp="",y0=this.defaultPropsArray;else{if(this._hasMaskedPath){if(K0!==qn[bt].line){switch(rt.j){case 1:Bt+=Dr-rt.lineWidths[qn[bt].line];break;case 2:Bt+=(Dr-rt.lineWidths[qn[bt].line])/2}K0=qn[bt].line}Cp!==qn[bt].ind&&(qn[Cp]&&(Bt+=qn[Cp].extra),Bt+=qn[bt].an/2,Cp=qn[bt].ind),Bt+=mn[0]*qn[bt].an*.005;var a0=0;for(ks=0;ks<_o;ks+=1)(cs=Mn[ks].a).p.propType&&((Ss=Mn[ks].s.getMult(qn[bt].anIndexes[ks],$n.a[ks].s.totalChars)).length?a0+=cs.p.v[0]*Ss[0]:a0+=cs.p.v[0]*Ss),cs.a.propType&&((Ss=Mn[ks].s.getMult(qn[bt].anIndexes[ks],$n.a[ks].s.totalChars)).length?a0+=cs.a.v[0]*Ss[0]:a0+=cs.a.v[0]*Ss);for(tr=!0,this._pathData.a.v&&(Bt=.5*qn[0].an+(Dr-this._pathData.f.v-.5*qn[0].an-.5*qn[qn.length-1].an)*Cp/(St-1),Bt+=this._pathData.f.v);tr;)Ht+_r>=Bt+a0||!cr?($r=(Bt+a0-Ht)/Ut.partialLength,uo=ar.point[0]+(Ut.point[0]-ar.point[0])*$r,uu=ar.point[1]+(Ut.point[1]-ar.point[1])*$r,en.translate(-mn[0]*qn[bt].an*.005,-mn[1]*eo*.01),tr=!1):cr&&(Ht+=Ut.partialLength,(rr+=1)>=cr.length&&(rr=0,Ar[sr+=1]?cr=Ar[sr].points:Jr.v.c?(rr=0,cr=Ar[sr=0].points):(Ht-=Ut.partialLength,cr=null)),cr&&(ar=Ut,_r=(Ut=cr[rr]).partialLength));Oo=qn[bt].an/2-qn[bt].add,en.translate(-Oo,0,0)}else Oo=qn[bt].an/2-qn[bt].add,en.translate(-Oo,0,0),en.translate(-mn[0]*qn[bt].an*.005,-mn[1]*eo*.01,0);for(ks=0;ks<_o;ks+=1)(cs=Mn[ks].a).t.propType&&(Ss=Mn[ks].s.getMult(qn[bt].anIndexes[ks],$n.a[ks].s.totalChars),ut===0&&rt.j===0||(this._hasMaskedPath?Ss.length?Bt+=cs.t.v*Ss[0]:Bt+=cs.t.v*Ss:Ss.length?ut+=cs.t.v*Ss[0]:ut+=cs.t.v*Ss));for(rt.strokeWidthAnim&&(mu=rt.sw||0),rt.strokeColorAnim&&(Jl=rt.sc?[rt.sc[0],rt.sc[1],rt.sc[2]]:[0,0,0]),rt.fillColorAnim&&rt.fc&&(pu=[rt.fc[0],rt.fc[1],rt.fc[2]]),ks=0;ks<_o;ks+=1)(cs=Mn[ks].a).a.propType&&((Ss=Mn[ks].s.getMult(qn[bt].anIndexes[ks],$n.a[ks].s.totalChars)).length?en.translate(-cs.a.v[0]*Ss[0],-cs.a.v[1]*Ss[1],cs.a.v[2]*Ss[2]):en.translate(-cs.a.v[0]*Ss,-cs.a.v[1]*Ss,cs.a.v[2]*Ss));for(ks=0;ks<_o;ks+=1)(cs=Mn[ks].a).s.propType&&((Ss=Mn[ks].s.getMult(qn[bt].anIndexes[ks],$n.a[ks].s.totalChars)).length?en.scale(1+(cs.s.v[0]-1)*Ss[0],1+(cs.s.v[1]-1)*Ss[1],1):en.scale(1+(cs.s.v[0]-1)*Ss,1+(cs.s.v[1]-1)*Ss,1));for(ks=0;ks<_o;ks+=1){if(cs=Mn[ks].a,Ss=Mn[ks].s.getMult(qn[bt].anIndexes[ks],$n.a[ks].s.totalChars),cs.sk.propType&&(Ss.length?en.skewFromAxis(-cs.sk.v*Ss[0],cs.sa.v*Ss[1]):en.skewFromAxis(-cs.sk.v*Ss,cs.sa.v*Ss)),cs.r.propType&&(Ss.length?en.rotateZ(-cs.r.v*Ss[2]):en.rotateZ(-cs.r.v*Ss)),cs.ry.propType&&(Ss.length?en.rotateY(cs.ry.v*Ss[1]):en.rotateY(cs.ry.v*Ss)),cs.rx.propType&&(Ss.length?en.rotateX(cs.rx.v*Ss[0]):en.rotateX(cs.rx.v*Ss)),cs.o.propType&&(Ss.length?cu+=(cs.o.v*Ss[0]-cu)*Ss[0]:cu+=(cs.o.v*Ss-cu)*Ss),rt.strokeWidthAnim&&cs.sw.propType&&(Ss.length?mu+=cs.sw.v*Ss[0]:mu+=cs.sw.v*Ss),rt.strokeColorAnim&&cs.sc.propType)for(Zu=0;Zu<3;Zu+=1)Ss.length?Jl[Zu]+=(cs.sc.v[Zu]-Jl[Zu])*Ss[0]:Jl[Zu]+=(cs.sc.v[Zu]-Jl[Zu])*Ss;if(rt.fillColorAnim&&rt.fc){if(cs.fc.propType)for(Zu=0;Zu<3;Zu+=1)Ss.length?pu[Zu]+=(cs.fc.v[Zu]-pu[Zu])*Ss[0]:pu[Zu]+=(cs.fc.v[Zu]-pu[Zu])*Ss;cs.fh.propType&&(pu=Ss.length?addHueToRGB(pu,cs.fh.v*Ss[0]):addHueToRGB(pu,cs.fh.v*Ss)),cs.fs.propType&&(pu=Ss.length?addSaturationToRGB(pu,cs.fs.v*Ss[0]):addSaturationToRGB(pu,cs.fs.v*Ss)),cs.fb.propType&&(pu=Ss.length?addBrightnessToRGB(pu,cs.fb.v*Ss[0]):addBrightnessToRGB(pu,cs.fb.v*Ss))}}for(ks=0;ks<_o;ks+=1)(cs=Mn[ks].a).p.propType&&(Ss=Mn[ks].s.getMult(qn[bt].anIndexes[ks],$n.a[ks].s.totalChars),this._hasMaskedPath?Ss.length?en.translate(0,cs.p.v[1]*Ss[0],-cs.p.v[2]*Ss[1]):en.translate(0,cs.p.v[1]*Ss,-cs.p.v[2]*Ss):Ss.length?en.translate(cs.p.v[0]*Ss[0],cs.p.v[1]*Ss[1],-cs.p.v[2]*Ss[2]):en.translate(cs.p.v[0]*Ss,cs.p.v[1]*Ss,-cs.p.v[2]*Ss));if(rt.strokeWidthAnim&&(Mp=mu<0?0:mu),rt.strokeColorAnim&&(Up="rgb("+Math.round(255*Jl[0])+","+Math.round(255*Jl[1])+","+Math.round(255*Jl[2])+")"),rt.fillColorAnim&&rt.fc&&(Ep="rgb("+Math.round(255*pu[0])+","+Math.round(255*pu[1])+","+Math.round(255*pu[2])+")"),this._hasMaskedPath){if(en.translate(0,-rt.ls),en.translate(0,mn[1]*eo*.01+mt,0),this._pathData.p.v){Br=(Ut.point[1]-ar.point[1])/(Ut.point[0]-ar.point[0]);var Q0=180*Math.atan(Br)/Math.PI;Ut.point[0]<ar.point[0]&&(Q0+=180),en.rotate(-Q0*Math.PI/180)}en.translate(uo,uu,0),Bt-=mn[0]*qn[bt].an*.005,qn[bt+1]&&Cp!==qn[bt+1].ind&&(Bt+=qn[bt].an/2,Bt+=.001*rt.tr*rt.finalSize)}else{switch(en.translate(ut,mt,0),rt.ps&&en.translate(rt.ps[0],rt.ps[1]+rt.ascent,0),rt.j){case 1:en.translate(qn[bt].animatorJustifyOffset+rt.justifyOffset+(rt.boxWidth-rt.lineWidths[qn[bt].line]),0,0);break;case 2:en.translate(qn[bt].animatorJustifyOffset+rt.justifyOffset+(rt.boxWidth-rt.lineWidths[qn[bt].line])/2,0,0)}en.translate(0,-rt.ls),en.translate(Oo,0,0),en.translate(mn[0]*qn[bt].an*.005,mn[1]*eo*.01,0),ut+=qn[bt].l+.001*rt.tr*rt.finalSize}In==="html"?Jp=en.toCSS():In==="svg"?Jp=en.to2dCSS():y0=[en.props[0],en.props[1],en.props[2],en.props[3],en.props[4],en.props[5],en.props[6],en.props[7],en.props[8],en.props[9],en.props[10],en.props[11],en.props[12],en.props[13],en.props[14],en.props[15]],mp=cu}Rn<=bt?(qs=new LetterProps(mp,Mp,Up,Ep,Jp,y0),this.renderedLetters.push(qs),Rn+=1,this.lettersChangedFlag=!0):(qs=this.renderedLetters[bt],this.lettersChangedFlag=qs.update(mp,Mp,Up,Ep,Jp,y0)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty),ITextElement.prototype.initElement=function(rt,_,ut){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(rt,_,ut),this.textProperty=new TextProperty(this,rt.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(rt.t,this.renderType,this),this.initTransform(rt,_,ut),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(rt){this._mdf=!1,this.prepareRenderableFrame(rt),this.prepareProperties(rt,this.isInRange),(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)},ITextElement.prototype.createPathShape=function(rt,_){var ut,mt,bt=_.length,St="";for(ut=0;ut<bt;ut+=1)_[ut].ty==="sh"&&(mt=_[ut].ks.k,St+=buildShapeString(mt,mt.i.length,!0,rt));return St},ITextElement.prototype.updateDocumentData=function(rt,_){this.textProperty.updateDocumentData(rt,_)},ITextElement.prototype.canResizeFont=function(rt){this.textProperty.canResizeFont(rt)},ITextElement.prototype.setMinimumFontSize=function(rt){this.textProperty.setMinimumFontSize(rt)},ITextElement.prototype.applyTextPropertiesToMatrix=function(rt,_,ut,mt,bt){switch(rt.ps&&_.translate(rt.ps[0],rt.ps[1]+rt.ascent,0),_.translate(0,-rt.ls,0),rt.j){case 1:_.translate(rt.justifyOffset+(rt.boxWidth-rt.lineWidths[ut]),0,0);break;case 2:_.translate(rt.justifyOffset+(rt.boxWidth-rt.lineWidths[ut])/2,0,0)}_.translate(mt,bt,0)},ITextElement.prototype.buildColor=function(rt){return"rgb("+Math.round(255*rt[0])+","+Math.round(255*rt[1])+","+Math.round(255*rt[2])+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){};var emptyShapeData={shapes:[]};function SVGTextLottieElement(rt,_,ut){this.textSpans=[],this.renderType="svg",this.initElement(rt,_,ut)}function ISolidElement(rt,_,ut){this.initElement(rt,_,ut)}function NullElement(rt,_,ut){this.initFrame(),this.initBaseData(rt,_,ut),this.initFrame(),this.initTransform(rt,_,ut),this.initHierarchy()}function SVGRendererBase(){}function ICompElement(){}function SVGCompElement(rt,_,ut){this.layers=rt.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(rt,_,ut),this.tm=rt.tm?PropertyFactory.getProp(this,rt.tm,0,_.frameRate,this):{_placeholder:!0}}function SVGRenderer(rt,_){this.animationItem=rt,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var ut="";if(_&&_.title){var mt=createNS("title"),bt=createElementID();mt.setAttribute("id",bt),mt.textContent=_.title,this.svgElement.appendChild(mt),ut+=bt}if(_&&_.description){var St=createNS("desc"),Mt=createElementID();St.setAttribute("id",Mt),St.textContent=_.description,this.svgElement.appendChild(St),ut+=" "+Mt}ut&&this.svgElement.setAttribute("aria-labelledby",ut);var Bt=createNS("defs");this.svgElement.appendChild(Bt);var Ut=createNS("g");this.svgElement.appendChild(Ut),this.layerElement=Ut,this.renderConfig={preserveAspectRatio:_&&_.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:_&&_.contentVisibility||"visible",progressiveLoad:_&&_.progressiveLoad||!1,hideOnTransparent:!(_&&_.hideOnTransparent===!1),viewBoxOnly:_&&_.viewBoxOnly||!1,viewBoxSize:_&&_.viewBoxSize||!1,className:_&&_.className||"",id:_&&_.id||"",focusable:_&&_.focusable,filterSize:{width:_&&_.filterSize&&_.filterSize.width||"100%",height:_&&_.filterSize&&_.filterSize.height||"100%",x:_&&_.filterSize&&_.filterSize.x||"0%",y:_&&_.filterSize&&_.filterSize.y||"0%"},width:_&&_.width,height:_&&_.height,runExpressions:!_||_.runExpressions===void 0||_.runExpressions},this.globalData={_mdf:!1,frameNum:-1,defs:Bt,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}function CVContextData(){var rt;for(this.saved=[],this.cArrPos=0,this.cTr=new Matrix,this.cO=1,this.savedOp=createTypedArray("float32",15),rt=0;rt<15;rt+=1)this.saved[rt]=createTypedArray("float32",16);this._length=15}function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(rt){for(var _=0,ut=rt.length,mt=[],bt="";_<ut;)rt[_]==="\r"||rt[_]===""?(mt.push(bt),bt=""):bt+=rt[_],_+=1;return mt.push(bt),mt},SVGTextLottieElement.prototype.buildShapeData=function(rt,_){if(rt.shapes&&rt.shapes.length){var ut=rt.shapes[0];if(ut.it){var mt=ut.it[ut.it.length-1];mt.s&&(mt.s.k[0]=_,mt.s.k[1]=_)}}return rt},SVGTextLottieElement.prototype.buildNewText=function(){var rt,_;this.addDynamicProperty(this);var ut=this.textProperty.currentData;this.renderedLetters=createSizedArray(ut?ut.l.length:0),ut.fc?this.layerElement.setAttribute("fill",this.buildColor(ut.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),ut.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(ut.sc)),this.layerElement.setAttribute("stroke-width",ut.sw)),this.layerElement.setAttribute("font-size",ut.finalSize);var mt=this.globalData.fontManager.getFontByName(ut.f);if(mt.fClass)this.layerElement.setAttribute("class",mt.fClass);else{this.layerElement.setAttribute("font-family",mt.fFamily);var bt=ut.fWeight,St=ut.fStyle;this.layerElement.setAttribute("font-style",St),this.layerElement.setAttribute("font-weight",bt)}this.layerElement.setAttribute("aria-label",ut.t);var Mt,Bt=ut.l||[],Ut=!!this.globalData.fontManager.chars;_=Bt.length;var Ht=this.mHelper,tr=this.data.singleShape,rr=0,sr=0,ar=!0,cr=.001*ut.tr*ut.finalSize;if(!tr||Ut||ut.sz){var Ar,_r=this.textSpans.length;for(rt=0;rt<_;rt+=1){if(this.textSpans[rt]||(this.textSpans[rt]={span:null,childSpan:null,glyph:null}),!Ut||!tr||rt===0){if(Mt=_r>rt?this.textSpans[rt].span:createNS(Ut?"g":"text"),_r<=rt){if(Mt.setAttribute("stroke-linecap","butt"),Mt.setAttribute("stroke-linejoin","round"),Mt.setAttribute("stroke-miterlimit","4"),this.textSpans[rt].span=Mt,Ut){var Dr=createNS("g");Mt.appendChild(Dr),this.textSpans[rt].childSpan=Dr}this.textSpans[rt].span=Mt,this.layerElement.appendChild(Mt)}Mt.style.display="inherit"}if(Ht.reset(),tr&&(Bt[rt].n&&(rr=-cr,sr+=ut.yOffset,sr+=ar?1:0,ar=!1),this.applyTextPropertiesToMatrix(ut,Ht,Bt[rt].line,rr,sr),rr+=Bt[rt].l||0,rr+=cr),Ut){var $r;if((Ar=this.globalData.fontManager.getCharData(ut.finalText[rt],mt.fStyle,this.globalData.fontManager.getFontByName(ut.f).fFamily)).t===1)$r=new SVGCompElement(Ar.data,this.globalData,this);else{var Br=emptyShapeData;Ar.data&&Ar.data.shapes&&(Br=this.buildShapeData(Ar.data,ut.finalSize)),$r=new SVGShapeElement(Br,this.globalData,this)}if(this.textSpans[rt].glyph){var Jr=this.textSpans[rt].glyph;this.textSpans[rt].childSpan.removeChild(Jr.layerElement),Jr.destroy()}this.textSpans[rt].glyph=$r,$r._debug=!0,$r.prepareFrame(0),$r.renderFrame(),this.textSpans[rt].childSpan.appendChild($r.layerElement),Ar.t===1&&this.textSpans[rt].childSpan.setAttribute("transform","scale("+ut.finalSize/100+","+ut.finalSize/100+")")}else tr&&Mt.setAttribute("transform","translate("+Ht.props[12]+","+Ht.props[13]+")"),Mt.textContent=Bt[rt].val,Mt.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve")}tr&&Mt&&Mt.setAttribute("d","")}else{var mn=this.textContainer,Mn="start";switch(ut.j){case 1:Mn="end";break;case 2:Mn="middle";break;default:Mn="start"}mn.setAttribute("text-anchor",Mn),mn.setAttribute("letter-spacing",cr);var $n=this.buildTextContents(ut.finalText);for(_=$n.length,sr=ut.ps?ut.ps[1]+ut.ascent:0,rt=0;rt<_;rt+=1)(Mt=this.textSpans[rt].span||createNS("tspan")).textContent=$n[rt],Mt.setAttribute("x",0),Mt.setAttribute("y",sr),Mt.style.display="inherit",mn.appendChild(Mt),this.textSpans[rt]||(this.textSpans[rt]={span:null,glyph:null}),this.textSpans[rt].span=Mt,sr+=ut.finalLineHeight;this.layerElement.appendChild(mn)}for(;rt<this.textSpans.length;)this.textSpans[rt].span.style.display="none",rt+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var rt=this.layerElement.getBBox();this.bbox={top:rt.y,left:rt.x,width:rt.width,height:rt.height}}return this.bbox},SVGTextLottieElement.prototype.getValue=function(){var rt,_,ut=this.textSpans.length;for(this.renderedFrame=this.comp.renderedFrame,rt=0;rt<ut;rt+=1)(_=this.textSpans[rt].glyph)&&(_.prepareFrame(this.comp.renderedFrame-this.data.st),_._mdf&&(this._mdf=!0))},SVGTextLottieElement.prototype.renderInnerContent=function(){if((!this.data.singleShape||this._mdf)&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){var rt,_;this._sizeChanged=!0;var ut,mt,bt,St=this.textAnimator.renderedLetters,Mt=this.textProperty.currentData.l;for(_=Mt.length,rt=0;rt<_;rt+=1)Mt[rt].n||(ut=St[rt],mt=this.textSpans[rt].span,(bt=this.textSpans[rt].glyph)&&bt.renderFrame(),ut._mdf.m&&mt.setAttribute("transform",ut.m),ut._mdf.o&&mt.setAttribute("opacity",ut.o),ut._mdf.sw&&mt.setAttribute("stroke-width",ut.sw),ut._mdf.sc&&mt.setAttribute("stroke",ut.sc),ut._mdf.fc&&mt.setAttribute("fill",ut.fc))}},extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var rt=createNS("rect");rt.setAttribute("width",this.data.sw),rt.setAttribute("height",this.data.sh),rt.setAttribute("fill",this.data.sc),this.layerElement.appendChild(rt)},NullElement.prototype.prepareFrame=function(rt){this.prepareProperties(rt,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement),extendPrototype([BaseRenderer],SVGRendererBase),SVGRendererBase.prototype.createNull=function(rt){return new NullElement(rt,this.globalData,this)},SVGRendererBase.prototype.createShape=function(rt){return new SVGShapeElement(rt,this.globalData,this)},SVGRendererBase.prototype.createText=function(rt){return new SVGTextLottieElement(rt,this.globalData,this)},SVGRendererBase.prototype.createImage=function(rt){return new IImageElement(rt,this.globalData,this)},SVGRendererBase.prototype.createSolid=function(rt){return new ISolidElement(rt,this.globalData,this)},SVGRendererBase.prototype.configAnimation=function(rt){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgElement.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+rt.w+" "+rt.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",rt.w),this.svgElement.setAttribute("height",rt.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)",this.svgElement.style.contentVisibility=this.renderConfig.contentVisibility),this.renderConfig.width&&this.svgElement.setAttribute("width",this.renderConfig.width),this.renderConfig.height&&this.svgElement.setAttribute("height",this.renderConfig.height),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),this.renderConfig.focusable!==void 0&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var _=this.globalData.defs;this.setupGlobalData(rt,_),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=rt;var ut=createNS("clipPath"),mt=createNS("rect");mt.setAttribute("width",rt.w),mt.setAttribute("height",rt.h),mt.setAttribute("x",0),mt.setAttribute("y",0);var bt=createElementID();ut.setAttribute("id",bt),ut.appendChild(mt),this.layerElement.setAttribute("clip-path","url("+getLocationHref()+"#"+bt+")"),_.appendChild(ut),this.layers=rt.layers,this.elements=createSizedArray(rt.layers.length)},SVGRendererBase.prototype.destroy=function(){var rt;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var _=this.layers?this.layers.length:0;for(rt=0;rt<_;rt+=1)this.elements[rt]&&this.elements[rt].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRendererBase.prototype.updateContainerSize=function(){},SVGRendererBase.prototype.findIndexByInd=function(rt){var _=0,ut=this.layers.length;for(_=0;_<ut;_+=1)if(this.layers[_].ind===rt)return _;return-1},SVGRendererBase.prototype.buildItem=function(rt){var _=this.elements;if(!_[rt]&&this.layers[rt].ty!==99){_[rt]=!0;var ut=this.createItem(this.layers[rt]);if(_[rt]=ut,getExpressionsPlugin()&&(this.layers[rt].ty===0&&this.globalData.projectInterface.registerComposition(ut),ut.initExpressions()),this.appendElementInPos(ut,rt),this.layers[rt].tt){var mt="tp"in this.layers[rt]?this.findIndexByInd(this.layers[rt].tp):rt-1;if(mt===-1)return;if(this.elements[mt]&&this.elements[mt]!==!0){var bt=_[mt].getMatte(this.layers[rt].tt);ut.setMatte(bt)}else this.buildItem(mt),this.addPendingElement(ut)}}},SVGRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var rt=this.pendingElements.pop();if(rt.checkParenting(),rt.data.tt)for(var _=0,ut=this.elements.length;_<ut;){if(this.elements[_]===rt){var mt="tp"in rt.data?this.findIndexByInd(rt.data.tp):_-1,bt=this.elements[mt].getMatte(this.layers[_].tt);rt.setMatte(bt);break}_+=1}}},SVGRendererBase.prototype.renderFrame=function(rt){if(this.renderedFrame!==rt&&!this.destroyed){var _;rt===null?rt=this.renderedFrame:this.renderedFrame=rt,this.globalData.frameNum=rt,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=rt,this.globalData._mdf=!1;var ut=this.layers.length;for(this.completeLayers||this.checkLayers(rt),_=ut-1;_>=0;_-=1)(this.completeLayers||this.elements[_])&&this.elements[_].prepareFrame(rt-this.layers[_].st);if(this.globalData._mdf)for(_=0;_<ut;_+=1)(this.completeLayers||this.elements[_])&&this.elements[_].renderFrame()}},SVGRendererBase.prototype.appendElementInPos=function(rt,_){var ut=rt.getBaseElement();if(ut){for(var mt,bt=0;bt<_;)this.elements[bt]&&this.elements[bt]!==!0&&this.elements[bt].getBaseElement()&&(mt=this.elements[bt].getBaseElement()),bt+=1;mt?this.layerElement.insertBefore(ut,mt):this.layerElement.appendChild(ut)}},SVGRendererBase.prototype.hide=function(){this.layerElement.style.display="none"},SVGRendererBase.prototype.show=function(){this.layerElement.style.display="block"},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(rt,_,ut){this.initFrame(),this.initBaseData(rt,_,ut),this.initTransform(rt,_,ut),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),!this.data.xt&&_.progressiveLoad||this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(rt){if(this._mdf=!1,this.prepareRenderableFrame(rt),this.prepareProperties(rt,this.isInRange),this.isInRange||this.data.xt){if(this.tm._placeholder)this.renderedFrame=rt/this.data.sr;else{var _=this.tm.v;_===this.data.op&&(_=this.data.op-1),this.renderedFrame=_}var ut,mt=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),ut=mt-1;ut>=0;ut-=1)(this.completeLayers||this.elements[ut])&&(this.elements[ut].prepareFrame(this.renderedFrame-this.layers[ut].st),this.elements[ut]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var rt,_=this.layers.length;for(rt=0;rt<_;rt+=1)(this.completeLayers||this.elements[rt])&&this.elements[rt].renderFrame()},ICompElement.prototype.setElements=function(rt){this.elements=rt},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var rt,_=this.layers.length;for(rt=0;rt<_;rt+=1)this.elements[rt]&&this.elements[rt].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()},extendPrototype([SVGRendererBase,ICompElement,SVGBaseElement],SVGCompElement),SVGCompElement.prototype.createComp=function(rt){return new SVGCompElement(rt,this.globalData,this)},extendPrototype([SVGRendererBase],SVGRenderer),SVGRenderer.prototype.createComp=function(rt){return new SVGCompElement(rt,this.globalData,this)},CVContextData.prototype.duplicate=function(){var rt=2*this._length,_=this.savedOp;this.savedOp=createTypedArray("float32",rt),this.savedOp.set(_);var ut=0;for(ut=this._length;ut<rt;ut+=1)this.saved[ut]=createTypedArray("float32",16);this._length=rt},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.cO=1},CVContextData.prototype.popTransform=function(){var rt,_=this.saved[this.cArrPos],ut=this.cTr.props;for(rt=0;rt<16;rt+=1)ut[rt]=_[rt];return _},CVContextData.prototype.popOpacity=function(){var rt=this.savedOp[this.cArrPos];return this.cO=rt,rt},CVContextData.prototype.pop=function(){return this.cArrPos-=1,{transform:this.popTransform(),opacity:this.popOpacity()}},CVContextData.prototype.push=function(){var rt,_=this.cTr.props;this._length<=this.cArrPos&&this.duplicate();var ut=this.saved[this.cArrPos];for(rt=0;rt<16;rt+=1)ut[rt]=_[rt];this.savedOp[this.cArrPos]=this.cO,this.cArrPos+=1},CVContextData.prototype.getTransform=function(){return this.cTr},CVContextData.prototype.getOpacity=function(){return this.cO},CVContextData.prototype.setOpacity=function(rt){this.cO=rt},ShapeTransformManager.prototype={addTransformSequence:function(rt){var _,ut=rt.length,mt="_";for(_=0;_<ut;_+=1)mt+=rt[_].transform.key+"_";var bt=this.sequences[mt];return bt||(bt={transforms:[].concat(rt),finalTransform:new Matrix,_mdf:!1},this.sequences[mt]=bt,this.sequenceList.push(bt)),bt},processSequence:function(rt,_){for(var ut,mt=0,bt=rt.transforms.length,St=_;mt<bt&&!_;){if(rt.transforms[mt].transform.mProps._mdf){St=!0;break}mt+=1}if(St)for(rt.finalTransform.reset(),mt=bt-1;mt>=0;mt-=1)ut=rt.transforms[mt].transform.mProps.v.props,rt.finalTransform.transform(ut[0],ut[1],ut[2],ut[3],ut[4],ut[5],ut[6],ut[7],ut[8],ut[9],ut[10],ut[11],ut[12],ut[13],ut[14],ut[15]);rt._mdf=St},processSequences:function(rt){var _,ut=this.sequenceList.length;for(_=0;_<ut;_+=1)this.processSequence(this.sequenceList[_],rt)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}};var lumaLoader=function(){var rt="__lottie_element_luma_buffer",_=null,ut=null,mt=null;function bt(){var St,Mt,Bt;_||(St=createNS("svg"),Mt=createNS("filter"),Bt=createNS("feColorMatrix"),Mt.setAttribute("id",rt),Bt.setAttribute("type","matrix"),Bt.setAttribute("color-interpolation-filters","sRGB"),Bt.setAttribute("values","0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0, 0.3, 0.3, 0.3, 0, 0"),Mt.appendChild(Bt),St.appendChild(Mt),St.setAttribute("id",rt+"_svg"),featureSupport.svgLumaHidden&&(St.style.display="none"),mt=St,document.body.appendChild(mt),_=createTag("canvas"),(ut=_.getContext("2d")).filter="url(#"+rt+")",ut.fillStyle="rgba(0,0,0,0)",ut.fillRect(0,0,1,1))}return{load:bt,get:function(St){return _||bt(),_.width=St.width,_.height=St.height,ut.filter="url(#"+rt+")",_}}};function createCanvas(rt,_){if(featureSupport.offscreenCanvas)return new OffscreenCanvas(rt,_);var ut=createTag("canvas");return ut.width=rt,ut.height=_,ut}var assetLoader={loadLumaCanvas:lumaLoader.load,getLumaCanvas:lumaLoader.get,createCanvas};function CVEffects(){}function CVMaskElement(rt,_){var ut;this.data=rt,this.element=_,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var mt=this.masksProperties.length,bt=!1;for(ut=0;ut<mt;ut+=1)this.masksProperties[ut].mode!=="n"&&(bt=!0),this.viewData[ut]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[ut],3);this.hasMasks=bt,bt&&this.element.addRenderableComponent(this)}function CVBaseElement(){}CVEffects.prototype.renderFrame=function(){},CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var rt,_,ut,mt,bt=this.element.finalTransform.mat,St=this.element.canvasContext,Mt=this.masksProperties.length;for(St.beginPath(),rt=0;rt<Mt;rt+=1)if(this.masksProperties[rt].mode!=="n"){var Bt;this.masksProperties[rt].inv&&(St.moveTo(0,0),St.lineTo(this.element.globalData.compSize.w,0),St.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),St.lineTo(0,this.element.globalData.compSize.h),St.lineTo(0,0)),mt=this.viewData[rt].v,_=bt.applyToPointArray(mt.v[0][0],mt.v[0][1],0),St.moveTo(_[0],_[1]);var Ut=mt._length;for(Bt=1;Bt<Ut;Bt+=1)ut=bt.applyToTriplePoints(mt.o[Bt-1],mt.i[Bt],mt.v[Bt]),St.bezierCurveTo(ut[0],ut[1],ut[2],ut[3],ut[4],ut[5]);ut=bt.applyToTriplePoints(mt.o[Bt-1],mt.i[0],mt.v[0]),St.bezierCurveTo(ut[0],ut[1],ut[2],ut[3],ut[4],ut[5])}this.element.globalData.renderer.save(!0),St.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null};var operationsMap={1:"source-in",2:"source-out",3:"source-in",4:"source-out"};function CVShapeData(rt,_,ut,mt){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var bt,St=4;_.ty==="rc"?St=5:_.ty==="el"?St=6:_.ty==="sr"&&(St=7),this.sh=ShapePropertyFactory.getShapeProp(rt,_,St,rt);var Mt,Bt=ut.length;for(bt=0;bt<Bt;bt+=1)ut[bt].closed||(Mt={transforms:mt.addTransformSequence(ut[bt].transforms),trNodes:[]},this.styledShapes.push(Mt),ut[bt].elements.push(Mt))}function CVShapeElement(rt,_,ut){this.shapes=[],this.shapesData=rt.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(rt,_,ut)}function CVTextElement(rt,_,ut){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(rt,_,ut)}function CVImageElement(rt,_,ut){this.assetData=_.getAssetData(rt.refId),this.img=_.imageLoader.getAsset(this.assetData),this.initElement(rt,_,ut)}function CVSolidElement(rt,_,ut){this.initElement(rt,_,ut)}function CanvasRendererBase(rt,_){this.animationItem=rt,this.renderConfig={clearCanvas:!_||_.clearCanvas===void 0||_.clearCanvas,context:_&&_.context||null,progressiveLoad:_&&_.progressiveLoad||!1,preserveAspectRatio:_&&_.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:_&&_.contentVisibility||"visible",className:_&&_.className||"",id:_&&_.id||""},this.renderConfig.dpr=_&&_.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=_&&_.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}function CVCompElement(rt,_,ut){this.completeLayers=!1,this.layers=rt.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(rt,_,ut),this.tm=rt.tm?PropertyFactory.getProp(this,rt.tm,0,_.frameRate,this):{_placeholder:!0}}function CanvasRenderer(rt,_){this.animationItem=rt,this.renderConfig={clearCanvas:!_||_.clearCanvas===void 0||_.clearCanvas,context:_&&_.context||null,progressiveLoad:_&&_.progressiveLoad||!1,preserveAspectRatio:_&&_.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",contentVisibility:_&&_.contentVisibility||"visible",className:_&&_.className||"",id:_&&_.id||"",runExpressions:!_||_.runExpressions===void 0||_.runExpressions},this.renderConfig.dpr=_&&_.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=_&&_.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}function HBaseElement(){}function HSolidElement(rt,_,ut){this.initElement(rt,_,ut)}function HShapeElement(rt,_,ut){this.shapes=[],this.shapesData=rt.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(rt,_,ut),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}function HTextElement(rt,_,ut){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(rt,_,ut)}function HCameraElement(rt,_,ut){this.initFrame(),this.initBaseData(rt,_,ut),this.initHierarchy();var mt=PropertyFactory.getProp;if(this.pe=mt(this,rt.pe,0,0,this),rt.ks.p.s?(this.px=mt(this,rt.ks.p.x,1,0,this),this.py=mt(this,rt.ks.p.y,1,0,this),this.pz=mt(this,rt.ks.p.z,1,0,this)):this.p=mt(this,rt.ks.p,1,0,this),rt.ks.a&&(this.a=mt(this,rt.ks.a,1,0,this)),rt.ks.or.k.length&&rt.ks.or.k[0].to){var bt,St=rt.ks.or.k.length;for(bt=0;bt<St;bt+=1)rt.ks.or.k[bt].to=null,rt.ks.or.k[bt].ti=null}this.or=mt(this,rt.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=mt(this,rt.ks.rx,0,degToRads,this),this.ry=mt(this,rt.ks.ry,0,degToRads,this),this.rz=mt(this,rt.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}function HImageElement(rt,_,ut){this.assetData=_.getAssetData(rt.refId),this.initElement(rt,_,ut)}function HybridRendererBase(rt,_){this.animationItem=rt,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:_&&_.className||"",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(_&&_.hideOnTransparent===!1),filterSize:{width:_&&_.filterSize&&_.filterSize.width||"400%",height:_&&_.filterSize&&_.filterSize.height||"400%",x:_&&_.filterSize&&_.filterSize.x||"-100%",y:_&&_.filterSize&&_.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}function HCompElement(rt,_,ut){this.layers=rt.layers,this.supports3d=!rt.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(rt,_,ut),this.tm=rt.tm?PropertyFactory.getProp(this,rt.tm,0,_.frameRate,this):{_placeholder:!0}}function HybridRenderer(rt,_){this.animationItem=rt,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:_&&_.className||"",imagePreserveAspectRatio:_&&_.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(_&&_.hideOnTransparent===!1),filterSize:{width:_&&_.filterSize&&_.filterSize.width||"400%",height:_&&_.filterSize&&_.filterSize.height||"400%",x:_&&_.filterSize&&_.filterSize.x||"-100%",y:_&&_.filterSize&&_.filterSize.y||"-100%"},runExpressions:!_||_.runExpressions===void 0||_.runExpressions},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){if(this.data.tt>=1){this.buffers=[];var rt=this.globalData.canvasContext,_=assetLoader.createCanvas(rt.canvas.width,rt.canvas.height);this.buffers.push(_);var ut=assetLoader.createCanvas(rt.canvas.width,rt.canvas.height);this.buffers.push(ut),this.data.tt>=3&&!document._isProxy&&assetLoader.loadLumaCanvas()}this.canvasContext=this.globalData.canvasContext,this.transformCanvas=this.globalData.transformCanvas,this.renderableEffectsManager=new CVEffects},createContent:function(){},setBlendMode:function(){var rt=this.globalData;if(rt.blendMode!==this.data.bm){rt.blendMode=this.data.bm;var _=getBlendMode(this.data.bm);rt.canvasContext.globalCompositeOperation=_}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this)},hideElement:function(){this.hidden||this.isInRange&&!this.isTransparent||(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},clearCanvas:function(rt){rt.clearRect(this.transformCanvas.tx,this.transformCanvas.ty,this.transformCanvas.w*this.transformCanvas.sx,this.transformCanvas.h*this.transformCanvas.sy)},prepareLayer:function(){if(this.data.tt>=1){var rt=this.buffers[0].getContext("2d");this.clearCanvas(rt),rt.drawImage(this.canvasContext.canvas,0,0),this.currentTransform=this.canvasContext.getTransform(),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform)}},exitLayer:function(){if(this.data.tt>=1){var rt=this.buffers[1],_=rt.getContext("2d");if(this.clearCanvas(_),_.drawImage(this.canvasContext.canvas,0,0),this.canvasContext.setTransform(1,0,0,1,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.setTransform(this.currentTransform),this.comp.getElementById("tp"in this.data?this.data.tp:this.data.ind-1).renderFrame(!0),this.canvasContext.setTransform(1,0,0,1,0,0),this.data.tt>=3&&!document._isProxy){var ut=assetLoader.getLumaCanvas(this.canvasContext.canvas);ut.getContext("2d").drawImage(this.canvasContext.canvas,0,0),this.clearCanvas(this.canvasContext),this.canvasContext.drawImage(ut,0,0)}this.canvasContext.globalCompositeOperation=operationsMap[this.data.tt],this.canvasContext.drawImage(rt,0,0),this.canvasContext.globalCompositeOperation="destination-over",this.canvasContext.drawImage(this.buffers[0],0,0),this.canvasContext.setTransform(this.currentTransform),this.canvasContext.globalCompositeOperation="source-over"}},renderFrame:function(rt){if(!this.hidden&&!this.data.hd&&(this.data.td!==1||rt)){this.renderTransform(),this.renderRenderable(),this.setBlendMode();var _=this.data.ty===0;this.prepareLayer(),this.globalData.renderer.save(_),this.globalData.renderer.ctxTransform(this.finalTransform.mat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.mProp.o.v),this.renderInnerContent(),this.globalData.renderer.restore(_),this.exitLayer(),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement,CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated,extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(rt,_){var ut={data:rt,type:rt.ty,preTransforms:this.transformsManager.addTransformSequence(_),transforms:[],elements:[],closed:rt.hd===!0},mt={};if(rt.ty==="fl"||rt.ty==="st"?(mt.c=PropertyFactory.getProp(this,rt.c,1,255,this),mt.c.k||(ut.co="rgb("+bmFloor(mt.c.v[0])+","+bmFloor(mt.c.v[1])+","+bmFloor(mt.c.v[2])+")")):rt.ty!=="gf"&&rt.ty!=="gs"||(mt.s=PropertyFactory.getProp(this,rt.s,1,null,this),mt.e=PropertyFactory.getProp(this,rt.e,1,null,this),mt.h=PropertyFactory.getProp(this,rt.h||{k:0},0,.01,this),mt.a=PropertyFactory.getProp(this,rt.a||{k:0},0,degToRads,this),mt.g=new GradientProperty(this,rt.g,this)),mt.o=PropertyFactory.getProp(this,rt.o,0,.01,this),rt.ty==="st"||rt.ty==="gs"){if(ut.lc=lineCapEnum[rt.lc||2],ut.lj=lineJoinEnum[rt.lj||2],rt.lj==1&&(ut.ml=rt.ml),mt.w=PropertyFactory.getProp(this,rt.w,0,null,this),mt.w.k||(ut.wi=mt.w.v),rt.d){var bt=new DashProperty(this,rt.d,"canvas",this);mt.d=bt,mt.d.k||(ut.da=mt.d.dashArray,ut.do=mt.d.dashoffset[0])}}else ut.r=rt.r===2?"evenodd":"nonzero";return this.stylesList.push(ut),mt.style=ut,mt},CVShapeElement.prototype.createGroupElement=function(){return{it:[],prevViewData:[]}},CVShapeElement.prototype.createTransformElement=function(rt){return{transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,rt.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,rt,this)}}},CVShapeElement.prototype.createShapeElement=function(rt){var _=new CVShapeData(this,rt,this.stylesList,this.transformsManager);return this.shapes.push(_),this.addShapeToModifiers(_),_},CVShapeElement.prototype.reloadShapes=function(){var rt;this._isFirstFrame=!0;var _=this.itemsData.length;for(rt=0;rt<_;rt+=1)this.prevViewData[rt]=this.itemsData[rt];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),_=this.dynamicProperties.length,rt=0;rt<_;rt+=1)this.dynamicProperties[rt].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(rt){var _,ut=this.stylesList.length;for(_=0;_<ut;_+=1)this.stylesList[_].closed||this.stylesList[_].transforms.push(rt)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var rt,_=this.stylesList.length;for(rt=0;rt<_;rt+=1)this.stylesList[rt].closed||this.stylesList[rt].transforms.pop()},CVShapeElement.prototype.closeStyles=function(rt){var _,ut=rt.length;for(_=0;_<ut;_+=1)rt[_].closed=!0},CVShapeElement.prototype.searchShapes=function(rt,_,ut,mt,bt){var St,Mt,Bt,Ut,Ht,tr,rr=rt.length-1,sr=[],ar=[],cr=[].concat(bt);for(St=rr;St>=0;St-=1){if((Ut=this.searchProcessedElement(rt[St]))?_[St]=ut[Ut-1]:rt[St]._shouldRender=mt,rt[St].ty==="fl"||rt[St].ty==="st"||rt[St].ty==="gf"||rt[St].ty==="gs")Ut?_[St].style.closed=!1:_[St]=this.createStyleElement(rt[St],cr),sr.push(_[St].style);else if(rt[St].ty==="gr"){if(Ut)for(Bt=_[St].it.length,Mt=0;Mt<Bt;Mt+=1)_[St].prevViewData[Mt]=_[St].it[Mt];else _[St]=this.createGroupElement(rt[St]);this.searchShapes(rt[St].it,_[St].it,_[St].prevViewData,mt,cr)}else rt[St].ty==="tr"?(Ut||(tr=this.createTransformElement(rt[St]),_[St]=tr),cr.push(_[St]),this.addTransformToStyleList(_[St])):rt[St].ty==="sh"||rt[St].ty==="rc"||rt[St].ty==="el"||rt[St].ty==="sr"?Ut||(_[St]=this.createShapeElement(rt[St])):rt[St].ty==="tm"||rt[St].ty==="rd"||rt[St].ty==="pb"||rt[St].ty==="zz"||rt[St].ty==="op"?(Ut?(Ht=_[St]).closed=!1:((Ht=ShapeModifiers.getModifier(rt[St].ty)).init(this,rt[St]),_[St]=Ht,this.shapeModifiers.push(Ht)),ar.push(Ht)):rt[St].ty==="rp"&&(Ut?(Ht=_[St]).closed=!0:(Ht=ShapeModifiers.getModifier(rt[St].ty),_[St]=Ht,Ht.init(this,rt,St,_),this.shapeModifiers.push(Ht),mt=!1),ar.push(Ht));this.addProcessedElement(rt[St],St+1)}for(this.removeTransformFromStyleList(),this.closeStyles(sr),rr=ar.length,St=0;St<rr;St+=1)ar[St].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(rt,_){(rt._opMdf||_.op._mdf||this._isFirstFrame)&&(_.opacity=rt.opacity,_.opacity*=_.op.v,_._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht=this.stylesList.length,tr=this.globalData.renderer,rr=this.globalData.canvasContext;for(rt=0;rt<Ht;rt+=1)if(((Bt=(Ut=this.stylesList[rt]).type)!=="st"&&Bt!=="gs"||Ut.wi!==0)&&Ut.data._shouldRender&&Ut.coOp!==0&&this.globalData.currentGlobalAlpha!==0){for(tr.save(),St=Ut.elements,Bt==="st"||Bt==="gs"?(rr.strokeStyle=Bt==="st"?Ut.co:Ut.grd,rr.lineWidth=Ut.wi,rr.lineCap=Ut.lc,rr.lineJoin=Ut.lj,rr.miterLimit=Ut.ml||0):rr.fillStyle=Bt==="fl"?Ut.co:Ut.grd,tr.ctxOpacity(Ut.coOp),Bt!=="st"&&Bt!=="gs"&&rr.beginPath(),tr.ctxTransform(Ut.preTransforms.finalTransform.props),ut=St.length,_=0;_<ut;_+=1){for(Bt!=="st"&&Bt!=="gs"||(rr.beginPath(),Ut.da&&(rr.setLineDash(Ut.da),rr.lineDashOffset=Ut.do)),bt=(Mt=St[_].trNodes).length,mt=0;mt<bt;mt+=1)Mt[mt].t==="m"?rr.moveTo(Mt[mt].p[0],Mt[mt].p[1]):Mt[mt].t==="c"?rr.bezierCurveTo(Mt[mt].pts[0],Mt[mt].pts[1],Mt[mt].pts[2],Mt[mt].pts[3],Mt[mt].pts[4],Mt[mt].pts[5]):rr.closePath();Bt!=="st"&&Bt!=="gs"||(rr.stroke(),Ut.da&&rr.setLineDash(this.dashResetter))}Bt!=="st"&&Bt!=="gs"&&rr.fill(Ut.r),tr.restore()}},CVShapeElement.prototype.renderShape=function(rt,_,ut,mt){var bt,St;for(St=rt,bt=_.length-1;bt>=0;bt-=1)_[bt].ty==="tr"?(St=ut[bt].transform,this.renderShapeTransform(rt,St)):_[bt].ty==="sh"||_[bt].ty==="el"||_[bt].ty==="rc"||_[bt].ty==="sr"?this.renderPath(_[bt],ut[bt]):_[bt].ty==="fl"?this.renderFill(_[bt],ut[bt],St):_[bt].ty==="st"?this.renderStroke(_[bt],ut[bt],St):_[bt].ty==="gf"||_[bt].ty==="gs"?this.renderGradientFill(_[bt],ut[bt],St):_[bt].ty==="gr"?this.renderShape(St,_[bt].it,ut[bt].it):_[bt].ty;mt&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(rt,_){if(this._isFirstFrame||_._mdf||rt.transforms._mdf){var ut,mt,bt,St=rt.trNodes,Mt=_.paths,Bt=Mt._length;St.length=0;var Ut=rt.transforms.finalTransform;for(bt=0;bt<Bt;bt+=1){var Ht=Mt.shapes[bt];if(Ht&&Ht.v){for(mt=Ht._length,ut=1;ut<mt;ut+=1)ut===1&&St.push({t:"m",p:Ut.applyToPointArray(Ht.v[0][0],Ht.v[0][1],0)}),St.push({t:"c",pts:Ut.applyToTriplePoints(Ht.o[ut-1],Ht.i[ut],Ht.v[ut])});mt===1&&St.push({t:"m",p:Ut.applyToPointArray(Ht.v[0][0],Ht.v[0][1],0)}),Ht.c&&mt&&(St.push({t:"c",pts:Ut.applyToTriplePoints(Ht.o[ut-1],Ht.i[0],Ht.v[0])}),St.push({t:"z"}))}}rt.trNodes=St}},CVShapeElement.prototype.renderPath=function(rt,_){if(rt.hd!==!0&&rt._shouldRender){var ut,mt=_.styledShapes.length;for(ut=0;ut<mt;ut+=1)this.renderStyledShape(_.styledShapes[ut],_.sh)}},CVShapeElement.prototype.renderFill=function(rt,_,ut){var mt=_.style;(_.c._mdf||this._isFirstFrame)&&(mt.co="rgb("+bmFloor(_.c.v[0])+","+bmFloor(_.c.v[1])+","+bmFloor(_.c.v[2])+")"),(_.o._mdf||ut._opMdf||this._isFirstFrame)&&(mt.coOp=_.o.v*ut.opacity)},CVShapeElement.prototype.renderGradientFill=function(rt,_,ut){var mt,bt=_.style;if(!bt.grd||_.g._mdf||_.s._mdf||_.e._mdf||rt.t!==1&&(_.h._mdf||_.a._mdf)){var St,Mt=this.globalData.canvasContext,Bt=_.s.v,Ut=_.e.v;if(rt.t===1)mt=Mt.createLinearGradient(Bt[0],Bt[1],Ut[0],Ut[1]);else{var Ht=Math.sqrt(Math.pow(Bt[0]-Ut[0],2)+Math.pow(Bt[1]-Ut[1],2)),tr=Math.atan2(Ut[1]-Bt[1],Ut[0]-Bt[0]),rr=_.h.v;rr>=1?rr=.99:rr<=-1&&(rr=-.99);var sr=Ht*rr,ar=Math.cos(tr+_.a.v)*sr+Bt[0],cr=Math.sin(tr+_.a.v)*sr+Bt[1];mt=Mt.createRadialGradient(ar,cr,0,Bt[0],Bt[1],Ht)}var Ar=rt.g.p,_r=_.g.c,Dr=1;for(St=0;St<Ar;St+=1)_.g._hasOpacity&&_.g._collapsable&&(Dr=_.g.o[2*St+1]),mt.addColorStop(_r[4*St]/100,"rgba("+_r[4*St+1]+","+_r[4*St+2]+","+_r[4*St+3]+","+Dr+")");bt.grd=mt}bt.coOp=_.o.v*ut.opacity},CVShapeElement.prototype.renderStroke=function(rt,_,ut){var mt=_.style,bt=_.d;bt&&(bt._mdf||this._isFirstFrame)&&(mt.da=bt.dashArray,mt.do=bt.dashoffset[0]),(_.c._mdf||this._isFirstFrame)&&(mt.co="rgb("+bmFloor(_.c.v[0])+","+bmFloor(_.c.v[1])+","+bmFloor(_.c.v[2])+")"),(_.o._mdf||ut._opMdf||this._isFirstFrame)&&(mt.coOp=_.o.v*ut.opacity),(_.w._mdf||this._isFirstFrame)&&(mt.wi=_.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var rt=this.textProperty.currentData;this.renderedLetters=createSizedArray(rt.l?rt.l.length:0);var _=!1;rt.fc?(_=!0,this.values.fill=this.buildColor(rt.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=_;var ut=!1;rt.sc&&(ut=!0,this.values.stroke=this.buildColor(rt.sc),this.values.sWidth=rt.sw);var mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar=this.globalData.fontManager.getFontByName(rt.f),_r=rt.l,Dr=this.mHelper;this.stroke=ut,this.values.fValue=rt.finalSize+"px "+this.globalData.fontManager.getFontByName(rt.f).fFamily,bt=rt.finalText.length;var $r=this.data.singleShape,Br=.001*rt.tr*rt.finalSize,Jr=0,mn=0,Mn=!0,$n=0;for(mt=0;mt<bt;mt+=1){Mt=(St=this.globalData.fontManager.getCharData(rt.finalText[mt],Ar.fStyle,this.globalData.fontManager.getFontByName(rt.f).fFamily))&&St.data||{},Dr.reset(),$r&&_r[mt].n&&(Jr=-Br,mn+=rt.yOffset,mn+=Mn?1:0,Mn=!1),rr=(Ht=Mt.shapes?Mt.shapes[0].it:[]).length,Dr.scale(rt.finalSize/100,rt.finalSize/100),$r&&this.applyTextPropertiesToMatrix(rt,Dr,_r[mt].line,Jr,mn),ar=createSizedArray(rr-1);var en=0;for(tr=0;tr<rr;tr+=1)if(Ht[tr].ty==="sh"){for(Ut=Ht[tr].ks.k.i.length,sr=Ht[tr].ks.k,cr=[],Bt=1;Bt<Ut;Bt+=1)Bt===1&&cr.push(Dr.applyToX(sr.v[0][0],sr.v[0][1],0),Dr.applyToY(sr.v[0][0],sr.v[0][1],0)),cr.push(Dr.applyToX(sr.o[Bt-1][0],sr.o[Bt-1][1],0),Dr.applyToY(sr.o[Bt-1][0],sr.o[Bt-1][1],0),Dr.applyToX(sr.i[Bt][0],sr.i[Bt][1],0),Dr.applyToY(sr.i[Bt][0],sr.i[Bt][1],0),Dr.applyToX(sr.v[Bt][0],sr.v[Bt][1],0),Dr.applyToY(sr.v[Bt][0],sr.v[Bt][1],0));cr.push(Dr.applyToX(sr.o[Bt-1][0],sr.o[Bt-1][1],0),Dr.applyToY(sr.o[Bt-1][0],sr.o[Bt-1][1],0),Dr.applyToX(sr.i[0][0],sr.i[0][1],0),Dr.applyToY(sr.i[0][0],sr.i[0][1],0),Dr.applyToX(sr.v[0][0],sr.v[0][1],0),Dr.applyToY(sr.v[0][0],sr.v[0][1],0)),ar[en]=cr,en+=1}$r&&(Jr+=_r[mt].l,Jr+=Br),this.textSpans[$n]?this.textSpans[$n].elem=ar:this.textSpans[$n]={elem:ar},$n+=1}},CVTextElement.prototype.renderInnerContent=function(){var rt,_,ut,mt,bt,St,Mt=this.canvasContext;Mt.font=this.values.fValue,Mt.lineCap="butt",Mt.lineJoin="miter",Mt.miterLimit=4,this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var Bt,Ut=this.textAnimator.renderedLetters,Ht=this.textProperty.currentData.l;_=Ht.length;var tr,rr,sr=null,ar=null,cr=null;for(rt=0;rt<_;rt+=1)if(!Ht[rt].n){if((Bt=Ut[rt])&&(this.globalData.renderer.save(),this.globalData.renderer.ctxTransform(Bt.p),this.globalData.renderer.ctxOpacity(Bt.o)),this.fill){for(Bt&&Bt.fc?sr!==Bt.fc&&(sr=Bt.fc,Mt.fillStyle=Bt.fc):sr!==this.values.fill&&(sr=this.values.fill,Mt.fillStyle=this.values.fill),mt=(tr=this.textSpans[rt].elem).length,this.globalData.canvasContext.beginPath(),ut=0;ut<mt;ut+=1)for(St=(rr=tr[ut]).length,this.globalData.canvasContext.moveTo(rr[0],rr[1]),bt=2;bt<St;bt+=6)this.globalData.canvasContext.bezierCurveTo(rr[bt],rr[bt+1],rr[bt+2],rr[bt+3],rr[bt+4],rr[bt+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.fill()}if(this.stroke){for(Bt&&Bt.sw?cr!==Bt.sw&&(cr=Bt.sw,Mt.lineWidth=Bt.sw):cr!==this.values.sWidth&&(cr=this.values.sWidth,Mt.lineWidth=this.values.sWidth),Bt&&Bt.sc?ar!==Bt.sc&&(ar=Bt.sc,Mt.strokeStyle=Bt.sc):ar!==this.values.stroke&&(ar=this.values.stroke,Mt.strokeStyle=this.values.stroke),mt=(tr=this.textSpans[rt].elem).length,this.globalData.canvasContext.beginPath(),ut=0;ut<mt;ut+=1)for(St=(rr=tr[ut]).length,this.globalData.canvasContext.moveTo(rr[0],rr[1]),bt=2;bt<St;bt+=6)this.globalData.canvasContext.bezierCurveTo(rr[bt],rr[bt+1],rr[bt+2],rr[bt+3],rr[bt+4],rr[bt+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.stroke()}Bt&&this.globalData.renderer.restore()}},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var rt=createTag("canvas");rt.width=this.assetData.w,rt.height=this.assetData.h;var _,ut,mt=rt.getContext("2d"),bt=this.img.width,St=this.img.height,Mt=bt/St,Bt=this.assetData.w/this.assetData.h,Ut=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;Mt>Bt&&Ut==="xMidYMid slice"||Mt<Bt&&Ut!=="xMidYMid slice"?_=(ut=St)*Bt:ut=(_=bt)/Bt,mt.drawImage(this.img,(bt-_)/2,(St-ut)/2,_,ut,0,0,this.assetData.w,this.assetData.h),this.img=rt}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){var rt=this.canvasContext;rt.fillStyle=this.data.sc,rt.fillRect(0,0,this.data.sw,this.data.sh)},extendPrototype([BaseRenderer],CanvasRendererBase),CanvasRendererBase.prototype.createShape=function(rt){return new CVShapeElement(rt,this.globalData,this)},CanvasRendererBase.prototype.createText=function(rt){return new CVTextElement(rt,this.globalData,this)},CanvasRendererBase.prototype.createImage=function(rt){return new CVImageElement(rt,this.globalData,this)},CanvasRendererBase.prototype.createSolid=function(rt){return new CVSolidElement(rt,this.globalData,this)},CanvasRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRendererBase.prototype.ctxTransform=function(rt){if(rt[0]!==1||rt[1]!==0||rt[4]!==0||rt[5]!==1||rt[12]!==0||rt[13]!==0)if(this.renderConfig.clearCanvas){this.transformMat.cloneFromProps(rt);var _=this.contextData.getTransform(),ut=_.props;this.transformMat.transform(ut[0],ut[1],ut[2],ut[3],ut[4],ut[5],ut[6],ut[7],ut[8],ut[9],ut[10],ut[11],ut[12],ut[13],ut[14],ut[15]),_.cloneFromProps(this.transformMat.props);var mt=_.props;this.canvasContext.setTransform(mt[0],mt[1],mt[4],mt[5],mt[12],mt[13])}else this.canvasContext.transform(rt[0],rt[1],rt[4],rt[5],rt[12],rt[13])},CanvasRendererBase.prototype.ctxOpacity=function(rt){var _=this.contextData.getOpacity();if(!this.renderConfig.clearCanvas)return this.canvasContext.globalAlpha*=rt<0?0:rt,void(this.globalData.currentGlobalAlpha=_);_*=rt<0?0:rt,this.contextData.setOpacity(_),this.globalData.currentGlobalAlpha!==_&&(this.canvasContext.globalAlpha=_,this.globalData.currentGlobalAlpha=_)},CanvasRendererBase.prototype.reset=function(){this.renderConfig.clearCanvas?this.contextData.reset():this.canvasContext.restore()},CanvasRendererBase.prototype.save=function(rt){this.renderConfig.clearCanvas?(rt&&this.canvasContext.save(),this.contextData.push()):this.canvasContext.save()},CanvasRendererBase.prototype.restore=function(rt){if(this.renderConfig.clearCanvas){rt&&(this.canvasContext.restore(),this.globalData.blendMode="source-over");var _=this.contextData.pop(),ut=_.transform,mt=_.opacity;this.canvasContext.setTransform(ut[0],ut[1],ut[4],ut[5],ut[12],ut[13]),this.globalData.currentGlobalAlpha!==mt&&(this.canvasContext.globalAlpha=mt,this.globalData.currentGlobalAlpha=mt)}else this.canvasContext.restore()},CanvasRendererBase.prototype.configAnimation=function(rt){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var _=this.animationItem.container.style;_.width="100%",_.height="100%";var ut="0px 0px 0px";_.transformOrigin=ut,_.mozTransformOrigin=ut,_.webkitTransformOrigin=ut,_["-webkit-transform"]=ut,_.contentVisibility=this.renderConfig.contentVisibility,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.data=rt,this.layers=rt.layers,this.transformCanvas={w:rt.w,h:rt.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(rt,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(rt.layers.length),this.updateContainerSize()},CanvasRendererBase.prototype.updateContainerSize=function(rt,_){var ut,mt,bt,St;if(this.reset(),rt?(ut=rt,mt=_,this.canvasContext.canvas.width=ut,this.canvasContext.canvas.height=mt):(this.animationItem.wrapper&&this.animationItem.container?(ut=this.animationItem.wrapper.offsetWidth,mt=this.animationItem.wrapper.offsetHeight):(ut=this.canvasContext.canvas.width,mt=this.canvasContext.canvas.height),this.canvasContext.canvas.width=ut*this.renderConfig.dpr,this.canvasContext.canvas.height=mt*this.renderConfig.dpr),this.renderConfig.preserveAspectRatio.indexOf("meet")!==-1||this.renderConfig.preserveAspectRatio.indexOf("slice")!==-1){var Mt=this.renderConfig.preserveAspectRatio.split(" "),Bt=Mt[1]||"meet",Ut=Mt[0]||"xMidYMid",Ht=Ut.substr(0,4),tr=Ut.substr(4);bt=ut/mt,(St=this.transformCanvas.w/this.transformCanvas.h)>bt&&Bt==="meet"||St<bt&&Bt==="slice"?(this.transformCanvas.sx=ut/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=ut/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=mt/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=mt/(this.transformCanvas.h/this.renderConfig.dpr)),this.transformCanvas.tx=Ht==="xMid"&&(St<bt&&Bt==="meet"||St>bt&&Bt==="slice")?(ut-this.transformCanvas.w*(mt/this.transformCanvas.h))/2*this.renderConfig.dpr:Ht==="xMax"&&(St<bt&&Bt==="meet"||St>bt&&Bt==="slice")?(ut-this.transformCanvas.w*(mt/this.transformCanvas.h))*this.renderConfig.dpr:0,this.transformCanvas.ty=tr==="YMid"&&(St>bt&&Bt==="meet"||St<bt&&Bt==="slice")?(mt-this.transformCanvas.h*(ut/this.transformCanvas.w))/2*this.renderConfig.dpr:tr==="YMax"&&(St>bt&&Bt==="meet"||St<bt&&Bt==="slice")?(mt-this.transformCanvas.h*(ut/this.transformCanvas.w))*this.renderConfig.dpr:0}else this.renderConfig.preserveAspectRatio==="none"?(this.transformCanvas.sx=ut/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=mt/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRendererBase.prototype.destroy=function(){var rt;for(this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),rt=(this.layers?this.layers.length:0)-1;rt>=0;rt-=1)this.elements[rt]&&this.elements[rt].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRendererBase.prototype.renderFrame=function(rt,_){if((this.renderedFrame!==rt||this.renderConfig.clearCanvas!==!0||_)&&!this.destroyed&&rt!==-1){var ut;this.renderedFrame=rt,this.globalData.frameNum=rt-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||_,this.globalData.projectInterface.currentFrame=rt;var mt=this.layers.length;for(this.completeLayers||this.checkLayers(rt),ut=0;ut<mt;ut+=1)(this.completeLayers||this.elements[ut])&&this.elements[ut].prepareFrame(rt-this.layers[ut].st);if(this.globalData._mdf){for(this.renderConfig.clearCanvas===!0?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),ut=mt-1;ut>=0;ut-=1)(this.completeLayers||this.elements[ut])&&this.elements[ut].renderFrame();this.renderConfig.clearCanvas!==!0&&this.restore()}}},CanvasRendererBase.prototype.buildItem=function(rt){var _=this.elements;if(!_[rt]&&this.layers[rt].ty!==99){var ut=this.createItem(this.layers[rt],this,this.globalData);_[rt]=ut,ut.initExpressions()}},CanvasRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},CanvasRendererBase.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRendererBase.prototype.show=function(){this.animationItem.container.style.display="block"},extendPrototype([CanvasRendererBase,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var rt,_=this.canvasContext;for(_.beginPath(),_.moveTo(0,0),_.lineTo(this.data.w,0),_.lineTo(this.data.w,this.data.h),_.lineTo(0,this.data.h),_.lineTo(0,0),_.clip(),rt=this.layers.length-1;rt>=0;rt-=1)(this.completeLayers||this.elements[rt])&&this.elements[rt].renderFrame()},CVCompElement.prototype.destroy=function(){var rt;for(rt=this.layers.length-1;rt>=0;rt-=1)this.elements[rt]&&this.elements[rt].destroy();this.layers=null,this.elements=null},CVCompElement.prototype.createComp=function(rt){return new CVCompElement(rt,this.globalData,this)},extendPrototype([CanvasRendererBase],CanvasRenderer),CanvasRenderer.prototype.createComp=function(rt){return new CVCompElement(rt,this.globalData,this)},HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects,this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),this.data.bm!==0&&this.setBlendMode()},renderElement:function(){var rt=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var _=this.finalTransform.mat.toCSS();rt.transform=_,rt.webkitTransform=_}this.finalTransform._opMdf&&(rt.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=BaseRenderer.prototype.buildElementParenting,extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var rt;this.data.hasMask?((rt=createNS("rect")).setAttribute("width",this.data.sw),rt.setAttribute("height",this.data.sh),rt.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):((rt=createTag("div")).style.width=this.data.sw+"px",rt.style.height=this.data.sh+"px",rt.style.backgroundColor=this.data.sc),this.layerElement.appendChild(rt)},extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var rt;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),rt=this.svgElement;else{rt=createNS("svg");var _=this.comp.data?this.comp.data:this.globalData.compSize;rt.setAttribute("width",_.w),rt.setAttribute("height",_.h),rt.appendChild(this.shapesContainer),this.layerElement.appendChild(rt)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=rt},HShapeElement.prototype.getTransformedPoint=function(rt,_){var ut,mt=rt.length;for(ut=0;ut<mt;ut+=1)_=rt[ut].mProps.v.applyToPointArray(_[0],_[1],0);return _},HShapeElement.prototype.calculateShapeBoundingBox=function(rt,_){var ut,mt,bt,St,Mt,Bt=rt.sh.v,Ut=rt.transformers,Ht=Bt._length;if(!(Ht<=1)){for(ut=0;ut<Ht-1;ut+=1)mt=this.getTransformedPoint(Ut,Bt.v[ut]),bt=this.getTransformedPoint(Ut,Bt.o[ut]),St=this.getTransformedPoint(Ut,Bt.i[ut+1]),Mt=this.getTransformedPoint(Ut,Bt.v[ut+1]),this.checkBounds(mt,bt,St,Mt,_);Bt.c&&(mt=this.getTransformedPoint(Ut,Bt.v[ut]),bt=this.getTransformedPoint(Ut,Bt.o[ut]),St=this.getTransformedPoint(Ut,Bt.i[0]),Mt=this.getTransformedPoint(Ut,Bt.v[0]),this.checkBounds(mt,bt,St,Mt,_))}},HShapeElement.prototype.checkBounds=function(rt,_,ut,mt,bt){this.getBoundsOfCurve(rt,_,ut,mt);var St=this.shapeBoundingBox;bt.x=bmMin(St.left,bt.x),bt.xMax=bmMax(St.right,bt.xMax),bt.y=bmMin(St.top,bt.y),bt.yMax=bmMax(St.bottom,bt.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(rt,_,ut,mt){for(var bt,St,Mt,Bt,Ut,Ht,tr,rr=[[rt[0],mt[0]],[rt[1],mt[1]]],sr=0;sr<2;++sr)St=6*rt[sr]-12*_[sr]+6*ut[sr],bt=-3*rt[sr]+9*_[sr]-9*ut[sr]+3*mt[sr],Mt=3*_[sr]-3*rt[sr],St|=0,Mt|=0,(bt|=0)===0&&St===0||(bt===0?(Bt=-Mt/St)>0&&Bt<1&&rr[sr].push(this.calculateF(Bt,rt,_,ut,mt,sr)):(Ut=St*St-4*Mt*bt)>=0&&((Ht=(-St+bmSqrt(Ut))/(2*bt))>0&&Ht<1&&rr[sr].push(this.calculateF(Ht,rt,_,ut,mt,sr)),(tr=(-St-bmSqrt(Ut))/(2*bt))>0&&tr<1&&rr[sr].push(this.calculateF(tr,rt,_,ut,mt,sr))));this.shapeBoundingBox.left=bmMin.apply(null,rr[0]),this.shapeBoundingBox.top=bmMin.apply(null,rr[1]),this.shapeBoundingBox.right=bmMax.apply(null,rr[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,rr[1])},HShapeElement.prototype.calculateF=function(rt,_,ut,mt,bt,St){return bmPow(1-rt,3)*_[St]+3*bmPow(1-rt,2)*rt*ut[St]+3*(1-rt)*bmPow(rt,2)*mt[St]+bmPow(rt,3)*bt[St]},HShapeElement.prototype.calculateBoundingBox=function(rt,_){var ut,mt=rt.length;for(ut=0;ut<mt;ut+=1)rt[ut]&&rt[ut].sh?this.calculateShapeBoundingBox(rt[ut],_):rt[ut]&&rt[ut].it?this.calculateBoundingBox(rt[ut].it,_):rt[ut]&&rt[ut].style&&rt[ut].w&&this.expandStrokeBoundingBox(rt[ut].w,_)},HShapeElement.prototype.expandStrokeBoundingBox=function(rt,_){var ut=0;if(rt.keyframes){for(var mt=0;mt<rt.keyframes.length;mt+=1){var bt=rt.keyframes[mt].s;bt>ut&&(ut=bt)}ut*=rt.mult}else ut=rt.v*rt.mult;_.x-=ut,_.xMax+=ut,_.y-=ut,_.yMax+=ut},HShapeElement.prototype.currentBoxContains=function(rt){return this.currentBBox.x<=rt.x&&this.currentBBox.y<=rt.y&&this.currentBBox.width+this.currentBBox.x>=rt.x+rt.width&&this.currentBBox.height+this.currentBBox.y>=rt.y+rt.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var rt=this.tempBoundingBox,_=999999;if(rt.x=_,rt.xMax=-_,rt.y=_,rt.yMax=-_,this.calculateBoundingBox(this.itemsData,rt),rt.width=rt.xMax<rt.x?0:rt.xMax-rt.x,rt.height=rt.yMax<rt.y?0:rt.yMax-rt.y,this.currentBoxContains(rt))return;var ut=!1;if(this.currentBBox.w!==rt.width&&(this.currentBBox.w=rt.width,this.shapeCont.setAttribute("width",rt.width),ut=!0),this.currentBBox.h!==rt.height&&(this.currentBBox.h=rt.height,this.shapeCont.setAttribute("height",rt.height),ut=!0),ut||this.currentBBox.x!==rt.x||this.currentBBox.y!==rt.y){this.currentBBox.w=rt.width,this.currentBBox.h=rt.height,this.currentBBox.x=rt.x,this.currentBBox.y=rt.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var mt=this.shapeCont.style,bt="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";mt.transform=bt,mt.webkitTransform=bt}}},extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var rt=createNS("g");this.maskedElement.appendChild(rt),this.innerElem=rt}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var rt=this.textProperty.currentData;this.renderedLetters=createSizedArray(rt.l?rt.l.length:0);var _=this.innerElem.style,ut=rt.fc?this.buildColor(rt.fc):"rgba(0,0,0,0)";_.fill=ut,_.color=ut,rt.sc&&(_.stroke=this.buildColor(rt.sc),_.strokeWidth=rt.sw+"px");var mt,bt,St=this.globalData.fontManager.getFontByName(rt.f);if(!this.globalData.fontManager.chars)if(_.fontSize=rt.finalSize+"px",_.lineHeight=rt.finalSize+"px",St.fClass)this.innerElem.className=St.fClass;else{_.fontFamily=St.fFamily;var Mt=rt.fWeight,Bt=rt.fStyle;_.fontStyle=Bt,_.fontWeight=Mt}var Ut,Ht,tr,rr=rt.l;bt=rr.length;var sr,ar=this.mHelper,cr="",Ar=0;for(mt=0;mt<bt;mt+=1){if(this.globalData.fontManager.chars?(this.textPaths[Ar]?Ut=this.textPaths[Ar]:((Ut=createNS("path")).setAttribute("stroke-linecap",lineCapEnum[1]),Ut.setAttribute("stroke-linejoin",lineJoinEnum[2]),Ut.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[Ar]?tr=(Ht=this.textSpans[Ar]).children[0]:((Ht=createTag("div")).style.lineHeight=0,(tr=createNS("svg")).appendChild(Ut),styleDiv(Ht)))):this.isMasked?Ut=this.textPaths[Ar]?this.textPaths[Ar]:createNS("text"):this.textSpans[Ar]?(Ht=this.textSpans[Ar],Ut=this.textPaths[Ar]):(styleDiv(Ht=createTag("span")),styleDiv(Ut=createTag("span")),Ht.appendChild(Ut)),this.globalData.fontManager.chars){var _r,Dr=this.globalData.fontManager.getCharData(rt.finalText[mt],St.fStyle,this.globalData.fontManager.getFontByName(rt.f).fFamily);if(_r=Dr?Dr.data:null,ar.reset(),_r&&_r.shapes&&_r.shapes.length&&(sr=_r.shapes[0].it,ar.scale(rt.finalSize/100,rt.finalSize/100),cr=this.createPathShape(ar,sr),Ut.setAttribute("d",cr)),this.isMasked)this.innerElem.appendChild(Ut);else{if(this.innerElem.appendChild(Ht),_r&&_r.shapes){document.body.appendChild(tr);var $r=tr.getBBox();tr.setAttribute("width",$r.width+2),tr.setAttribute("height",$r.height+2),tr.setAttribute("viewBox",$r.x-1+" "+($r.y-1)+" "+($r.width+2)+" "+($r.height+2));var Br=tr.style,Jr="translate("+($r.x-1)+"px,"+($r.y-1)+"px)";Br.transform=Jr,Br.webkitTransform=Jr,rr[mt].yOffset=$r.y-1}else tr.setAttribute("width",1),tr.setAttribute("height",1);Ht.appendChild(tr)}}else if(Ut.textContent=rr[mt].val,Ut.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(Ut);else{this.innerElem.appendChild(Ht);var mn=Ut.style,Mn="translate3d(0,"+-rt.finalSize/1.2+"px,0)";mn.transform=Mn,mn.webkitTransform=Mn}this.isMasked?this.textSpans[Ar]=Ut:this.textSpans[Ar]=Ht,this.textSpans[Ar].style.display="block",this.textPaths[Ar]=Ut,Ar+=1}for(;Ar<this.textSpans.length;)this.textSpans[Ar].style.display="none",Ar+=1},HTextElement.prototype.renderInnerContent=function(){var rt;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),rt=this.svgElement.style;var _="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";rt.transform=_,rt.webkitTransform=_}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag){var ut,mt,bt,St,Mt,Bt=0,Ut=this.textAnimator.renderedLetters,Ht=this.textProperty.currentData.l;for(mt=Ht.length,ut=0;ut<mt;ut+=1)Ht[ut].n?Bt+=1:(St=this.textSpans[ut],Mt=this.textPaths[ut],bt=Ut[Bt],Bt+=1,bt._mdf.m&&(this.isMasked?St.setAttribute("transform",bt.m):(St.style.webkitTransform=bt.m,St.style.transform=bt.m)),St.style.opacity=bt.o,bt.sw&&bt._mdf.sw&&Mt.setAttribute("stroke-width",bt.sw),bt.sc&&bt._mdf.sc&&Mt.setAttribute("stroke",bt.sc),bt.fc&&bt._mdf.fc&&(Mt.setAttribute("fill",bt.fc),Mt.style.color=bt.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var tr=this.innerElem.getBBox();if(this.currentBBox.w!==tr.width&&(this.currentBBox.w=tr.width,this.svgElement.setAttribute("width",tr.width)),this.currentBBox.h!==tr.height&&(this.currentBBox.h=tr.height,this.svgElement.setAttribute("height",tr.height)),this.currentBBox.w!==tr.width+2||this.currentBBox.h!==tr.height+2||this.currentBBox.x!==tr.x-1||this.currentBBox.y!==tr.y-1){this.currentBBox.w=tr.width+2,this.currentBBox.h=tr.height+2,this.currentBBox.x=tr.x-1,this.currentBBox.y=tr.y-1,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),rt=this.svgElement.style;var rr="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";rt.transform=rr,rt.webkitTransform=rr}}}},extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var rt,_,ut,mt,bt=this.comp.threeDElements.length;for(rt=0;rt<bt;rt+=1)if((_=this.comp.threeDElements[rt]).type==="3d"){ut=_.perspectiveElem.style,mt=_.container.style;var St=this.pe.v+"px",Mt="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";ut.perspective=St,ut.webkitPerspective=St,mt.transformOrigin="0px 0px 0px",mt.mozTransformOrigin="0px 0px 0px",mt.webkitTransformOrigin="0px 0px 0px",ut.transform=Mt,ut.webkitTransform=Mt}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var rt,_,ut=this._isFirstFrame;if(this.hierarchy)for(_=this.hierarchy.length,rt=0;rt<_;rt+=1)ut=this.hierarchy[rt].finalTransform.mProp._mdf||ut;if(ut||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(rt=_=this.hierarchy.length-1;rt>=0;rt-=1){var mt=this.hierarchy[rt].finalTransform.mProp;this.mat.translate(-mt.p.v[0],-mt.p.v[1],mt.p.v[2]),this.mat.rotateX(-mt.or.v[0]).rotateY(-mt.or.v[1]).rotateZ(mt.or.v[2]),this.mat.rotateX(-mt.rx.v).rotateY(-mt.ry.v).rotateZ(mt.rz.v),this.mat.scale(1/mt.s.v[0],1/mt.s.v[1],1/mt.s.v[2]),this.mat.translate(mt.a.v[0],mt.a.v[1],mt.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var bt;bt=this.p?[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var St=Math.sqrt(Math.pow(bt[0],2)+Math.pow(bt[1],2)+Math.pow(bt[2],2)),Mt=[bt[0]/St,bt[1]/St,bt[2]/St],Bt=Math.sqrt(Mt[2]*Mt[2]+Mt[0]*Mt[0]),Ut=Math.atan2(Mt[1],Bt),Ht=Math.atan2(Mt[0],-Mt[2]);this.mat.rotateY(Ht).rotateX(-Ut)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var tr=!this._prevMat.equals(this.mat);if((tr||this.pe._mdf)&&this.comp.threeDElements){var rr,sr,ar;for(_=this.comp.threeDElements.length,rt=0;rt<_;rt+=1)if((rr=this.comp.threeDElements[rt]).type==="3d"){if(tr){var cr=this.mat.toCSS();(ar=rr.container.style).transform=cr,ar.webkitTransform=cr}this.pe._mdf&&((sr=rr.perspectiveElem.style).perspective=this.pe.v+"px",sr.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(rt){this.prepareProperties(rt,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null},extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var rt=this.globalData.getAssetsPath(this.assetData),_=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",rt),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(_),_.crossOrigin="anonymous",_.src=rt,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)},extendPrototype([BaseRenderer],HybridRendererBase),HybridRendererBase.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRendererBase.prototype.checkPendingElements=function(){for(;this.pendingElements.length;)this.pendingElements.pop().checkParenting()},HybridRendererBase.prototype.appendElementInPos=function(rt,_){var ut=rt.getBaseElement();if(ut){var mt=this.layers[_];if(mt.ddd&&this.supports3d)this.addTo3dContainer(ut,_);else if(this.threeDElements)this.addTo3dContainer(ut,_);else{for(var bt,St,Mt=0;Mt<_;)this.elements[Mt]&&this.elements[Mt]!==!0&&this.elements[Mt].getBaseElement&&(St=this.elements[Mt],bt=(this.layers[Mt].ddd?this.getThreeDContainerByPos(Mt):St.getBaseElement())||bt),Mt+=1;bt?mt.ddd&&this.supports3d||this.layerElement.insertBefore(ut,bt):mt.ddd&&this.supports3d||this.layerElement.appendChild(ut)}}},HybridRendererBase.prototype.createShape=function(rt){return this.supports3d?new HShapeElement(rt,this.globalData,this):new SVGShapeElement(rt,this.globalData,this)},HybridRendererBase.prototype.createText=function(rt){return this.supports3d?new HTextElement(rt,this.globalData,this):new SVGTextLottieElement(rt,this.globalData,this)},HybridRendererBase.prototype.createCamera=function(rt){return this.camera=new HCameraElement(rt,this.globalData,this),this.camera},HybridRendererBase.prototype.createImage=function(rt){return this.supports3d?new HImageElement(rt,this.globalData,this):new IImageElement(rt,this.globalData,this)},HybridRendererBase.prototype.createSolid=function(rt){return this.supports3d?new HSolidElement(rt,this.globalData,this):new ISolidElement(rt,this.globalData,this)},HybridRendererBase.prototype.createNull=SVGRenderer.prototype.createNull,HybridRendererBase.prototype.getThreeDContainerByPos=function(rt){for(var _=0,ut=this.threeDElements.length;_<ut;){if(this.threeDElements[_].startPos<=rt&&this.threeDElements[_].endPos>=rt)return this.threeDElements[_].perspectiveElem;_+=1}return null},HybridRendererBase.prototype.createThreeDContainer=function(rt,_){var ut,mt,bt=createTag("div");styleDiv(bt);var St=createTag("div");if(styleDiv(St),_==="3d"){(ut=bt.style).width=this.globalData.compSize.w+"px",ut.height=this.globalData.compSize.h+"px",ut.webkitTransformOrigin="50% 50%",ut.mozTransformOrigin="50% 50%",ut.transformOrigin="50% 50%";var Mt="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";(mt=St.style).transform=Mt,mt.webkitTransform=Mt}bt.appendChild(St);var Bt={container:St,perspectiveElem:bt,startPos:rt,endPos:rt,type:_};return this.threeDElements.push(Bt),Bt},HybridRendererBase.prototype.build3dContainers=function(){var rt,_,ut=this.layers.length,mt="";for(rt=0;rt<ut;rt+=1)this.layers[rt].ddd&&this.layers[rt].ty!==3?(mt!=="3d"&&(mt="3d",_=this.createThreeDContainer(rt,"3d")),_.endPos=Math.max(_.endPos,rt)):(mt!=="2d"&&(mt="2d",_=this.createThreeDContainer(rt,"2d")),_.endPos=Math.max(_.endPos,rt));for(rt=(ut=this.threeDElements.length)-1;rt>=0;rt-=1)this.resizerElem.appendChild(this.threeDElements[rt].perspectiveElem)},HybridRendererBase.prototype.addTo3dContainer=function(rt,_){for(var ut=0,mt=this.threeDElements.length;ut<mt;){if(_<=this.threeDElements[ut].endPos){for(var bt,St=this.threeDElements[ut].startPos;St<_;)this.elements[St]&&this.elements[St].getBaseElement&&(bt=this.elements[St].getBaseElement()),St+=1;bt?this.threeDElements[ut].container.insertBefore(rt,bt):this.threeDElements[ut].container.appendChild(rt);break}ut+=1}},HybridRendererBase.prototype.configAnimation=function(rt){var _=createTag("div"),ut=this.animationItem.wrapper,mt=_.style;mt.width=rt.w+"px",mt.height=rt.h+"px",this.resizerElem=_,styleDiv(_),mt.transformStyle="flat",mt.mozTransformStyle="flat",mt.webkitTransformStyle="flat",this.renderConfig.className&&_.setAttribute("class",this.renderConfig.className),ut.appendChild(_),mt.overflow="hidden";var bt=createNS("svg");bt.setAttribute("width","1"),bt.setAttribute("height","1"),styleDiv(bt),this.resizerElem.appendChild(bt);var St=createNS("defs");bt.appendChild(St),this.data=rt,this.setupGlobalData(rt,bt),this.globalData.defs=St,this.layers=rt.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRendererBase.prototype.destroy=function(){var rt;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var _=this.layers?this.layers.length:0;for(rt=0;rt<_;rt+=1)this.elements[rt].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRendererBase.prototype.updateContainerSize=function(){var rt,_,ut,mt,bt=this.animationItem.wrapper.offsetWidth,St=this.animationItem.wrapper.offsetHeight,Mt=bt/St;this.globalData.compSize.w/this.globalData.compSize.h>Mt?(rt=bt/this.globalData.compSize.w,_=bt/this.globalData.compSize.w,ut=0,mt=(St-this.globalData.compSize.h*(bt/this.globalData.compSize.w))/2):(rt=St/this.globalData.compSize.h,_=St/this.globalData.compSize.h,ut=(bt-this.globalData.compSize.w*(St/this.globalData.compSize.h))/2,mt=0);var Bt=this.resizerElem.style;Bt.webkitTransform="matrix3d("+rt+",0,0,0,0,"+_+",0,0,0,0,1,0,"+ut+","+mt+",0,1)",Bt.transform=Bt.webkitTransform},HybridRendererBase.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRendererBase.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRendererBase.prototype.show=function(){this.resizerElem.style.display="block"},HybridRendererBase.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var rt,_=this.globalData.compSize.w,ut=this.globalData.compSize.h,mt=this.threeDElements.length;for(rt=0;rt<mt;rt+=1){var bt=this.threeDElements[rt].perspectiveElem.style;bt.webkitPerspective=Math.sqrt(Math.pow(_,2)+Math.pow(ut,2))+"px",bt.perspective=bt.webkitPerspective}}},HybridRendererBase.prototype.searchExtraCompositions=function(rt){var _,ut=rt.length,mt=createTag("div");for(_=0;_<ut;_+=1)if(rt[_].xt){var bt=this.createComp(rt[_],mt,this.globalData.comp,null);bt.initExpressions(),this.globalData.projectInterface.registerComposition(bt)}},extendPrototype([HybridRendererBase,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(rt,_){for(var ut,mt=0;mt<_;)this.elements[mt]&&this.elements[mt].getBaseElement&&(ut=this.elements[mt].getBaseElement()),mt+=1;ut?this.layerElement.insertBefore(rt,ut):this.layerElement.appendChild(rt)},HCompElement.prototype.createComp=function(rt){return this.supports3d?new HCompElement(rt,this.globalData,this):new SVGCompElement(rt,this.globalData,this)},extendPrototype([HybridRendererBase],HybridRenderer),HybridRenderer.prototype.createComp=function(rt){return this.supports3d?new HCompElement(rt,this.globalData,this):new SVGCompElement(rt,this.globalData,this)};var CompExpressionInterface=function(rt){function _(ut){for(var mt=0,bt=rt.layers.length;mt<bt;){if(rt.layers[mt].nm===ut||rt.layers[mt].ind===ut)return rt.elements[mt].layerInterface;mt+=1}return null}return Object.defineProperty(_,"_name",{value:rt.data.nm}),_.layer=_,_.pixelAspect=1,_.height=rt.data.h||rt.globalData.compSize.h,_.width=rt.data.w||rt.globalData.compSize.w,_.pixelAspect=1,_.frameDuration=1/rt.globalData.frameRate,_.displayStartTime=0,_.numLayers=rt.layers.length,_},Expressions=function(){var rt={};return rt.initExpressions=function(_){var ut=0,mt=[];_.renderer.compInterface=CompExpressionInterface(_.renderer),_.renderer.globalData.projectInterface.registerComposition(_.renderer),_.renderer.globalData.pushExpression=function(){ut+=1},_.renderer.globalData.popExpression=function(){(ut-=1)===0&&function(){var bt,St=mt.length;for(bt=0;bt<St;bt+=1)mt[bt].release();mt.length=0}()},_.renderer.globalData.registerExpressionProperty=function(bt){mt.indexOf(bt)===-1&&mt.push(bt)}},rt}(),MaskManagerInterface=function(){function rt(_,ut){this._mask=_,this._data=ut}return Object.defineProperty(rt.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(rt.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),100*this._mask.op.v}}),function(_){var ut,mt=createSizedArray(_.viewData.length),bt=_.viewData.length;for(ut=0;ut<bt;ut+=1)mt[ut]=new rt(_.viewData[ut],_.masksProperties[ut]);return function(St){for(ut=0;ut<bt;){if(_.masksProperties[ut].nm===St)return mt[ut];ut+=1}return null}}}(),ExpressionPropertyInterface=function(){var rt={pv:0,v:0,mult:1},_={pv:[0,0,0],v:[0,0,0],mult:1};function ut(bt,St,Mt){Object.defineProperty(bt,"velocity",{get:function(){return St.getVelocityAtTime(St.comp.currentFrame)}}),bt.numKeys=St.keyframes?St.keyframes.length:0,bt.key=function(Bt){if(!bt.numKeys)return 0;var Ut="";Ut="s"in St.keyframes[Bt-1]?St.keyframes[Bt-1].s:"e"in St.keyframes[Bt-2]?St.keyframes[Bt-2].e:St.keyframes[Bt-2].s;var Ht=Mt==="unidimensional"?new Number(Ut):Object.assign({},Ut);return Ht.time=St.keyframes[Bt-1].t/St.elem.comp.globalData.frameRate,Ht.value=Mt==="unidimensional"?Ut[0]:Ut,Ht},bt.valueAtTime=St.getValueAtTime,bt.speedAtTime=St.getSpeedAtTime,bt.velocityAtTime=St.getVelocityAtTime,bt.propertyGroup=St.propertyGroup}function mt(){return rt}return function(bt){return bt?bt.propType==="unidimensional"?function(St){St&&"pv"in St||(St=rt);var Mt=1/St.mult,Bt=St.pv*Mt,Ut=new Number(Bt);return Ut.value=Bt,ut(Ut,St,"unidimensional"),function(){return St.k&&St.getValue(),Bt=St.v*Mt,Ut.value!==Bt&&((Ut=new Number(Bt)).value=Bt,ut(Ut,St,"unidimensional")),Ut}}(bt):function(St){St&&"pv"in St||(St=_);var Mt=1/St.mult,Bt=St.data&&St.data.l||St.pv.length,Ut=createTypedArray("float32",Bt),Ht=createTypedArray("float32",Bt);return Ut.value=Ht,ut(Ut,St,"multidimensional"),function(){St.k&&St.getValue();for(var tr=0;tr<Bt;tr+=1)Ht[tr]=St.v[tr]*Mt,Ut[tr]=Ht[tr];return Ut}}(bt):mt}}(),TransformExpressionInterface=function(rt){function _(Mt){switch(Mt){case"scale":case"Scale":case"ADBE Scale":case 6:return _.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return _.rotation;case"ADBE Rotate X":return _.xRotation;case"ADBE Rotate Y":return _.yRotation;case"position":case"Position":case"ADBE Position":case 2:return _.position;case"ADBE Position_0":return _.xPosition;case"ADBE Position_1":return _.yPosition;case"ADBE Position_2":return _.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return _.anchorPoint;case"opacity":case"Opacity":case 11:return _.opacity;default:return null}}var ut,mt,bt,St;return Object.defineProperty(_,"rotation",{get:ExpressionPropertyInterface(rt.r||rt.rz)}),Object.defineProperty(_,"zRotation",{get:ExpressionPropertyInterface(rt.rz||rt.r)}),Object.defineProperty(_,"xRotation",{get:ExpressionPropertyInterface(rt.rx)}),Object.defineProperty(_,"yRotation",{get:ExpressionPropertyInterface(rt.ry)}),Object.defineProperty(_,"scale",{get:ExpressionPropertyInterface(rt.s)}),rt.p?St=ExpressionPropertyInterface(rt.p):(ut=ExpressionPropertyInterface(rt.px),mt=ExpressionPropertyInterface(rt.py),rt.pz&&(bt=ExpressionPropertyInterface(rt.pz))),Object.defineProperty(_,"position",{get:function(){return rt.p?St():[ut(),mt(),bt?bt():0]}}),Object.defineProperty(_,"xPosition",{get:ExpressionPropertyInterface(rt.px)}),Object.defineProperty(_,"yPosition",{get:ExpressionPropertyInterface(rt.py)}),Object.defineProperty(_,"zPosition",{get:ExpressionPropertyInterface(rt.pz)}),Object.defineProperty(_,"anchorPoint",{get:ExpressionPropertyInterface(rt.a)}),Object.defineProperty(_,"opacity",{get:ExpressionPropertyInterface(rt.o)}),Object.defineProperty(_,"skew",{get:ExpressionPropertyInterface(rt.sk)}),Object.defineProperty(_,"skewAxis",{get:ExpressionPropertyInterface(rt.sa)}),Object.defineProperty(_,"orientation",{get:ExpressionPropertyInterface(rt.or)}),_},LayerExpressionInterface=function(){function rt(Ht){var tr=new Matrix;return Ht!==void 0?this._elem.finalTransform.mProp.getValueAtTime(Ht).clone(tr):this._elem.finalTransform.mProp.applyToMatrix(tr),tr}function _(Ht,tr){var rr=this.getMatrix(tr);return rr.props[12]=0,rr.props[13]=0,rr.props[14]=0,this.applyPoint(rr,Ht)}function ut(Ht,tr){var rr=this.getMatrix(tr);return this.applyPoint(rr,Ht)}function mt(Ht,tr){var rr=this.getMatrix(tr);return rr.props[12]=0,rr.props[13]=0,rr.props[14]=0,this.invertPoint(rr,Ht)}function bt(Ht,tr){var rr=this.getMatrix(tr);return this.invertPoint(rr,Ht)}function St(Ht,tr){if(this._elem.hierarchy&&this._elem.hierarchy.length){var rr,sr=this._elem.hierarchy.length;for(rr=0;rr<sr;rr+=1)this._elem.hierarchy[rr].finalTransform.mProp.applyToMatrix(Ht)}return Ht.applyToPointArray(tr[0],tr[1],tr[2]||0)}function Mt(Ht,tr){if(this._elem.hierarchy&&this._elem.hierarchy.length){var rr,sr=this._elem.hierarchy.length;for(rr=0;rr<sr;rr+=1)this._elem.hierarchy[rr].finalTransform.mProp.applyToMatrix(Ht)}return Ht.inversePoint(tr)}function Bt(Ht){var tr=new Matrix;if(tr.reset(),this._elem.finalTransform.mProp.applyToMatrix(tr),this._elem.hierarchy&&this._elem.hierarchy.length){var rr,sr=this._elem.hierarchy.length;for(rr=0;rr<sr;rr+=1)this._elem.hierarchy[rr].finalTransform.mProp.applyToMatrix(tr);return tr.inversePoint(Ht)}return tr.inversePoint(Ht)}function Ut(){return[1,1,1,1]}return function(Ht){var tr;function rr(ar){switch(ar){case"ADBE Root Vectors Group":case"Contents":case 2:return rr.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return tr;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return rr.effect;case"ADBE Text Properties":return rr.textInterface;default:return null}}rr.getMatrix=rt,rr.invertPoint=Mt,rr.applyPoint=St,rr.toWorld=ut,rr.toWorldVec=_,rr.fromWorld=bt,rr.fromWorldVec=mt,rr.toComp=ut,rr.fromComp=Bt,rr.sampleImage=Ut,rr.sourceRectAtTime=Ht.sourceRectAtTime.bind(Ht),rr._elem=Ht;var sr=getDescriptor(tr=TransformExpressionInterface(Ht.finalTransform.mProp),"anchorPoint");return Object.defineProperties(rr,{hasParent:{get:function(){return Ht.hierarchy.length}},parent:{get:function(){return Ht.hierarchy[0].layerInterface}},rotation:getDescriptor(tr,"rotation"),scale:getDescriptor(tr,"scale"),position:getDescriptor(tr,"position"),opacity:getDescriptor(tr,"opacity"),anchorPoint:sr,anchor_point:sr,transform:{get:function(){return tr}},active:{get:function(){return Ht.isInRange}}}),rr.startTime=Ht.data.st,rr.index=Ht.data.ind,rr.source=Ht.data.refId,rr.height=Ht.data.ty===0?Ht.data.h:100,rr.width=Ht.data.ty===0?Ht.data.w:100,rr.inPoint=Ht.data.ip/Ht.comp.globalData.frameRate,rr.outPoint=Ht.data.op/Ht.comp.globalData.frameRate,rr._name=Ht.data.nm,rr.registerMaskInterface=function(ar){rr.mask=new MaskManagerInterface(ar,Ht)},rr.registerEffectsInterface=function(ar){rr.effect=ar},rr}}(),propertyGroupFactory=function(rt,_){return function(ut){return(ut=ut===void 0?1:ut)<=0?rt:_(ut-1)}},PropertyInterface=function(rt,_){var ut={_name:rt};return function(mt){return(mt=mt===void 0?1:mt)<=0?ut:_(mt-1)}},EffectsExpressionInterface=function(){function rt(ut,mt,bt,St){function Mt(rr){for(var sr=ut.ef,ar=0,cr=sr.length;ar<cr;){if(rr===sr[ar].nm||rr===sr[ar].mn||rr===sr[ar].ix)return sr[ar].ty===5?Ht[ar]:Ht[ar]();ar+=1}throw new Error}var Bt,Ut=propertyGroupFactory(Mt,bt),Ht=[],tr=ut.ef.length;for(Bt=0;Bt<tr;Bt+=1)ut.ef[Bt].ty===5?Ht.push(rt(ut.ef[Bt],mt.effectElements[Bt],mt.effectElements[Bt].propertyGroup,St)):Ht.push(_(mt.effectElements[Bt],ut.ef[Bt].ty,St,Ut));return ut.mn==="ADBE Color Control"&&Object.defineProperty(Mt,"color",{get:function(){return Ht[0]()}}),Object.defineProperties(Mt,{numProperties:{get:function(){return ut.np}},_name:{value:ut.nm},propertyGroup:{value:Ut}}),Mt.enabled=ut.en!==0,Mt.active=Mt.enabled,Mt}function _(ut,mt,bt,St){var Mt=ExpressionPropertyInterface(ut.p);return ut.p.setGroupProperty&&ut.p.setGroupProperty(PropertyInterface("",St)),function(){return mt===10?bt.comp.compInterface(ut.p.v):Mt()}}return{createEffectsInterface:function(ut,mt){if(ut.effectsManager){var bt,St=[],Mt=ut.data.ef,Bt=ut.effectsManager.effectElements.length;for(bt=0;bt<Bt;bt+=1)St.push(rt(Mt[bt],ut.effectsManager.effectElements[bt],mt,ut));var Ut=ut.data.ef||[],Ht=function(tr){for(bt=0,Bt=Ut.length;bt<Bt;){if(tr===Ut[bt].nm||tr===Ut[bt].mn||tr===Ut[bt].ix)return St[bt];bt+=1}return null};return Object.defineProperty(Ht,"numProperties",{get:function(){return Ut.length}}),Ht}return null}}}(),ShapePathInterface=function(rt,_,ut){var mt=_.sh;function bt(Mt){return Mt==="Shape"||Mt==="shape"||Mt==="Path"||Mt==="path"||Mt==="ADBE Vector Shape"||Mt===2?bt.path:null}var St=propertyGroupFactory(bt,ut);return mt.setGroupProperty(PropertyInterface("Path",St)),Object.defineProperties(bt,{path:{get:function(){return mt.k&&mt.getValue(),mt}},shape:{get:function(){return mt.k&&mt.getValue(),mt}},_name:{value:rt.nm},ix:{value:rt.ix},propertyIndex:{value:rt.ix},mn:{value:rt.mn},propertyGroup:{value:ut}}),bt},ShapeExpressionInterface=function(){function rt(ar,cr,Ar){var _r,Dr=[],$r=ar?ar.length:0;for(_r=0;_r<$r;_r+=1)ar[_r].ty==="gr"?Dr.push(_(ar[_r],cr[_r],Ar)):ar[_r].ty==="fl"?Dr.push(ut(ar[_r],cr[_r],Ar)):ar[_r].ty==="st"?Dr.push(St(ar[_r],cr[_r],Ar)):ar[_r].ty==="tm"?Dr.push(Mt(ar[_r],cr[_r],Ar)):ar[_r].ty==="tr"||(ar[_r].ty==="el"?Dr.push(Ut(ar[_r],cr[_r],Ar)):ar[_r].ty==="sr"?Dr.push(Ht(ar[_r],cr[_r],Ar)):ar[_r].ty==="sh"?Dr.push(ShapePathInterface(ar[_r],cr[_r],Ar)):ar[_r].ty==="rc"?Dr.push(tr(ar[_r],cr[_r],Ar)):ar[_r].ty==="rd"?Dr.push(rr(ar[_r],cr[_r],Ar)):ar[_r].ty==="rp"?Dr.push(sr(ar[_r],cr[_r],Ar)):ar[_r].ty==="gf"?Dr.push(mt(ar[_r],cr[_r],Ar)):Dr.push(bt(ar[_r],cr[_r])));return Dr}function _(ar,cr,Ar){var _r=function(Br){switch(Br){case"ADBE Vectors Group":case"Contents":case 2:return _r.content;default:return _r.transform}};_r.propertyGroup=propertyGroupFactory(_r,Ar);var Dr=function(Br,Jr,mn){var Mn,$n=function(In){for(var Rn=0,qn=Mn.length;Rn<qn;){if(Mn[Rn]._name===In||Mn[Rn].mn===In||Mn[Rn].propertyIndex===In||Mn[Rn].ix===In||Mn[Rn].ind===In)return Mn[Rn];Rn+=1}return typeof In=="number"?Mn[In-1]:null};$n.propertyGroup=propertyGroupFactory($n,mn),Mn=rt(Br.it,Jr.it,$n.propertyGroup),$n.numProperties=Mn.length;var en=Bt(Br.it[Br.it.length-1],Jr.it[Jr.it.length-1],$n.propertyGroup);return $n.transform=en,$n.propertyIndex=Br.cix,$n._name=Br.nm,$n}(ar,cr,_r.propertyGroup),$r=Bt(ar.it[ar.it.length-1],cr.it[cr.it.length-1],_r.propertyGroup);return _r.content=Dr,_r.transform=$r,Object.defineProperty(_r,"_name",{get:function(){return ar.nm}}),_r.numProperties=ar.np,_r.propertyIndex=ar.ix,_r.nm=ar.nm,_r.mn=ar.mn,_r}function ut(ar,cr,Ar){function _r(Dr){return Dr==="Color"||Dr==="color"?_r.color:Dr==="Opacity"||Dr==="opacity"?_r.opacity:null}return Object.defineProperties(_r,{color:{get:ExpressionPropertyInterface(cr.c)},opacity:{get:ExpressionPropertyInterface(cr.o)},_name:{value:ar.nm},mn:{value:ar.mn}}),cr.c.setGroupProperty(PropertyInterface("Color",Ar)),cr.o.setGroupProperty(PropertyInterface("Opacity",Ar)),_r}function mt(ar,cr,Ar){function _r(Dr){return Dr==="Start Point"||Dr==="start point"?_r.startPoint:Dr==="End Point"||Dr==="end point"?_r.endPoint:Dr==="Opacity"||Dr==="opacity"?_r.opacity:null}return Object.defineProperties(_r,{startPoint:{get:ExpressionPropertyInterface(cr.s)},endPoint:{get:ExpressionPropertyInterface(cr.e)},opacity:{get:ExpressionPropertyInterface(cr.o)},type:{get:function(){return"a"}},_name:{value:ar.nm},mn:{value:ar.mn}}),cr.s.setGroupProperty(PropertyInterface("Start Point",Ar)),cr.e.setGroupProperty(PropertyInterface("End Point",Ar)),cr.o.setGroupProperty(PropertyInterface("Opacity",Ar)),_r}function bt(){return function(){return null}}function St(ar,cr,Ar){var _r,Dr=propertyGroupFactory(Mn,Ar),$r=propertyGroupFactory(mn,Dr);function Br($n){Object.defineProperty(mn,ar.d[$n].nm,{get:ExpressionPropertyInterface(cr.d.dataProps[$n].p)})}var Jr=ar.d?ar.d.length:0,mn={};for(_r=0;_r<Jr;_r+=1)Br(_r),cr.d.dataProps[_r].p.setGroupProperty($r);function Mn($n){return $n==="Color"||$n==="color"?Mn.color:$n==="Opacity"||$n==="opacity"?Mn.opacity:$n==="Stroke Width"||$n==="stroke width"?Mn.strokeWidth:null}return Object.defineProperties(Mn,{color:{get:ExpressionPropertyInterface(cr.c)},opacity:{get:ExpressionPropertyInterface(cr.o)},strokeWidth:{get:ExpressionPropertyInterface(cr.w)},dash:{get:function(){return mn}},_name:{value:ar.nm},mn:{value:ar.mn}}),cr.c.setGroupProperty(PropertyInterface("Color",Dr)),cr.o.setGroupProperty(PropertyInterface("Opacity",Dr)),cr.w.setGroupProperty(PropertyInterface("Stroke Width",Dr)),Mn}function Mt(ar,cr,Ar){function _r($r){return $r===ar.e.ix||$r==="End"||$r==="end"?_r.end:$r===ar.s.ix?_r.start:$r===ar.o.ix?_r.offset:null}var Dr=propertyGroupFactory(_r,Ar);return _r.propertyIndex=ar.ix,cr.s.setGroupProperty(PropertyInterface("Start",Dr)),cr.e.setGroupProperty(PropertyInterface("End",Dr)),cr.o.setGroupProperty(PropertyInterface("Offset",Dr)),_r.propertyIndex=ar.ix,_r.propertyGroup=Ar,Object.defineProperties(_r,{start:{get:ExpressionPropertyInterface(cr.s)},end:{get:ExpressionPropertyInterface(cr.e)},offset:{get:ExpressionPropertyInterface(cr.o)},_name:{value:ar.nm}}),_r.mn=ar.mn,_r}function Bt(ar,cr,Ar){function _r($r){return ar.a.ix===$r||$r==="Anchor Point"?_r.anchorPoint:ar.o.ix===$r||$r==="Opacity"?_r.opacity:ar.p.ix===$r||$r==="Position"?_r.position:ar.r.ix===$r||$r==="Rotation"||$r==="ADBE Vector Rotation"?_r.rotation:ar.s.ix===$r||$r==="Scale"?_r.scale:ar.sk&&ar.sk.ix===$r||$r==="Skew"?_r.skew:ar.sa&&ar.sa.ix===$r||$r==="Skew Axis"?_r.skewAxis:null}var Dr=propertyGroupFactory(_r,Ar);return cr.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",Dr)),cr.transform.mProps.p.setGroupProperty(PropertyInterface("Position",Dr)),cr.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",Dr)),cr.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",Dr)),cr.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",Dr)),cr.transform.mProps.sk&&(cr.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",Dr)),cr.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",Dr))),cr.transform.op.setGroupProperty(PropertyInterface("Opacity",Dr)),Object.defineProperties(_r,{opacity:{get:ExpressionPropertyInterface(cr.transform.mProps.o)},position:{get:ExpressionPropertyInterface(cr.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(cr.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(cr.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(cr.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(cr.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(cr.transform.mProps.sa)},_name:{value:ar.nm}}),_r.ty="tr",_r.mn=ar.mn,_r.propertyGroup=Ar,_r}function Ut(ar,cr,Ar){function _r(Br){return ar.p.ix===Br?_r.position:ar.s.ix===Br?_r.size:null}var Dr=propertyGroupFactory(_r,Ar);_r.propertyIndex=ar.ix;var $r=cr.sh.ty==="tm"?cr.sh.prop:cr.sh;return $r.s.setGroupProperty(PropertyInterface("Size",Dr)),$r.p.setGroupProperty(PropertyInterface("Position",Dr)),Object.defineProperties(_r,{size:{get:ExpressionPropertyInterface($r.s)},position:{get:ExpressionPropertyInterface($r.p)},_name:{value:ar.nm}}),_r.mn=ar.mn,_r}function Ht(ar,cr,Ar){function _r(Br){return ar.p.ix===Br?_r.position:ar.r.ix===Br?_r.rotation:ar.pt.ix===Br?_r.points:ar.or.ix===Br||Br==="ADBE Vector Star Outer Radius"?_r.outerRadius:ar.os.ix===Br?_r.outerRoundness:!ar.ir||ar.ir.ix!==Br&&Br!=="ADBE Vector Star Inner Radius"?ar.is&&ar.is.ix===Br?_r.innerRoundness:null:_r.innerRadius}var Dr=propertyGroupFactory(_r,Ar),$r=cr.sh.ty==="tm"?cr.sh.prop:cr.sh;return _r.propertyIndex=ar.ix,$r.or.setGroupProperty(PropertyInterface("Outer Radius",Dr)),$r.os.setGroupProperty(PropertyInterface("Outer Roundness",Dr)),$r.pt.setGroupProperty(PropertyInterface("Points",Dr)),$r.p.setGroupProperty(PropertyInterface("Position",Dr)),$r.r.setGroupProperty(PropertyInterface("Rotation",Dr)),ar.ir&&($r.ir.setGroupProperty(PropertyInterface("Inner Radius",Dr)),$r.is.setGroupProperty(PropertyInterface("Inner Roundness",Dr))),Object.defineProperties(_r,{position:{get:ExpressionPropertyInterface($r.p)},rotation:{get:ExpressionPropertyInterface($r.r)},points:{get:ExpressionPropertyInterface($r.pt)},outerRadius:{get:ExpressionPropertyInterface($r.or)},outerRoundness:{get:ExpressionPropertyInterface($r.os)},innerRadius:{get:ExpressionPropertyInterface($r.ir)},innerRoundness:{get:ExpressionPropertyInterface($r.is)},_name:{value:ar.nm}}),_r.mn=ar.mn,_r}function tr(ar,cr,Ar){function _r(Br){return ar.p.ix===Br?_r.position:ar.r.ix===Br?_r.roundness:ar.s.ix===Br||Br==="Size"||Br==="ADBE Vector Rect Size"?_r.size:null}var Dr=propertyGroupFactory(_r,Ar),$r=cr.sh.ty==="tm"?cr.sh.prop:cr.sh;return _r.propertyIndex=ar.ix,$r.p.setGroupProperty(PropertyInterface("Position",Dr)),$r.s.setGroupProperty(PropertyInterface("Size",Dr)),$r.r.setGroupProperty(PropertyInterface("Rotation",Dr)),Object.defineProperties(_r,{position:{get:ExpressionPropertyInterface($r.p)},roundness:{get:ExpressionPropertyInterface($r.r)},size:{get:ExpressionPropertyInterface($r.s)},_name:{value:ar.nm}}),_r.mn=ar.mn,_r}function rr(ar,cr,Ar){function _r(Br){return ar.r.ix===Br||Br==="Round Corners 1"?_r.radius:null}var Dr=propertyGroupFactory(_r,Ar),$r=cr;return _r.propertyIndex=ar.ix,$r.rd.setGroupProperty(PropertyInterface("Radius",Dr)),Object.defineProperties(_r,{radius:{get:ExpressionPropertyInterface($r.rd)},_name:{value:ar.nm}}),_r.mn=ar.mn,_r}function sr(ar,cr,Ar){function _r(Br){return ar.c.ix===Br||Br==="Copies"?_r.copies:ar.o.ix===Br||Br==="Offset"?_r.offset:null}var Dr=propertyGroupFactory(_r,Ar),$r=cr;return _r.propertyIndex=ar.ix,$r.c.setGroupProperty(PropertyInterface("Copies",Dr)),$r.o.setGroupProperty(PropertyInterface("Offset",Dr)),Object.defineProperties(_r,{copies:{get:ExpressionPropertyInterface($r.c)},offset:{get:ExpressionPropertyInterface($r.o)},_name:{value:ar.nm}}),_r.mn=ar.mn,_r}return function(ar,cr,Ar){var _r;function Dr($r){if(typeof $r=="number")return($r=$r===void 0?1:$r)===0?Ar:_r[$r-1];for(var Br=0,Jr=_r.length;Br<Jr;){if(_r[Br]._name===$r)return _r[Br];Br+=1}return null}return Dr.propertyGroup=propertyGroupFactory(Dr,function(){return Ar}),_r=rt(ar,cr,Dr.propertyGroup),Dr.numProperties=_r.length,Dr._name="Contents",Dr}}(),TextExpressionInterface=function(rt){var _,ut;function mt(bt){switch(bt){case"ADBE Text Document":return mt.sourceText;default:return null}}return Object.defineProperty(mt,"sourceText",{get:function(){rt.textProperty.getValue();var bt=rt.textProperty.currentData.t;return bt!==_&&(_=rt.textProperty.currentData.t,(ut=new String(bt)).value=bt||new String(bt),Object.defineProperty(ut,"style",{get:function(){return{fillColor:rt.textProperty.currentData.fc}}})),ut}}),mt};function _typeof$2(rt){return(_typeof$2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(rt)}var FootageInterface=(dataInterfaceFactory=function(rt){function _(ut){return ut==="Outline"?_.outlineInterface():null}return _._name="Outline",_.outlineInterface=function(ut){var mt="",bt=ut.getFootageData();function St(Mt){if(bt[Mt])return mt=Mt,_typeof$2(bt=bt[Mt])==="object"?St:bt;var Bt=Mt.indexOf(mt);if(Bt!==-1){var Ut=parseInt(Mt.substr(Bt+mt.length),10);return _typeof$2(bt=bt[Ut])==="object"?St:bt}return""}return function(){return mt="",bt=ut.getFootageData(),St}}(rt),_},function(rt){function _(ut){return ut==="Data"?_.dataInterface:null}return _._name="Data",_.dataInterface=dataInterfaceFactory(rt),_}),dataInterfaceFactory,interfaces={layer:LayerExpressionInterface,effects:EffectsExpressionInterface,comp:CompExpressionInterface,shape:ShapeExpressionInterface,text:TextExpressionInterface,footage:FootageInterface};function getInterface(rt){return interfaces[rt]||null}function _typeof$1(rt){return(_typeof$1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(rt)}function seedRandom(rt,_){var ut=this,mt=_.pow(256,6),bt=_.pow(2,52),St=2*bt;function Mt(tr){var rr,sr=tr.length,ar=this,cr=0,Ar=ar.i=ar.j=0,_r=ar.S=[];for(sr||(tr=[sr++]);cr<256;)_r[cr]=cr++;for(cr=0;cr<256;cr++)_r[cr]=_r[Ar=255&Ar+tr[cr%sr]+(rr=_r[cr])],_r[Ar]=rr;ar.g=function(Dr){for(var $r,Br=0,Jr=ar.i,mn=ar.j,Mn=ar.S;Dr--;)$r=Mn[Jr=255&Jr+1],Br=256*Br+Mn[255&(Mn[Jr]=Mn[mn=255&mn+$r])+(Mn[mn]=$r)];return ar.i=Jr,ar.j=mn,Br}}function Bt(tr,rr){return rr.i=tr.i,rr.j=tr.j,rr.S=tr.S.slice(),rr}function Ut(tr,rr){for(var sr,ar=tr+"",cr=0;cr<ar.length;)rr[255&cr]=255&(sr^=19*rr[255&cr])+ar.charCodeAt(cr++);return Ht(rr)}function Ht(tr){return String.fromCharCode.apply(0,tr)}_.seedrandom=function(tr,rr,sr){var ar=[],cr=Ut(function Dr($r,Br){var Jr,mn=[],Mn=_typeof$1($r);if(Br&&Mn=="object")for(Jr in $r)try{mn.push(Dr($r[Jr],Br-1))}catch{}return mn.length?mn:Mn=="string"?$r:$r+"\0"}((rr=rr===!0?{entropy:!0}:rr||{}).entropy?[tr,Ht(rt)]:tr===null?function(){try{var Dr=new Uint8Array(256);return(ut.crypto||ut.msCrypto).getRandomValues(Dr),Ht(Dr)}catch{var $r=ut.navigator,Br=$r&&$r.plugins;return[+new Date,ut,Br,ut.screen,Ht(rt)]}}():tr,3),ar),Ar=new Mt(ar),_r=function(){for(var Dr=Ar.g(6),$r=mt,Br=0;Dr<bt;)Dr=256*(Dr+Br),$r*=256,Br=Ar.g(1);for(;Dr>=St;)Dr/=2,$r/=2,Br>>>=1;return(Dr+Br)/$r};return _r.int32=function(){return 0|Ar.g(4)},_r.quick=function(){return Ar.g(4)/4294967296},_r.double=_r,Ut(Ht(Ar.S),rt),(rr.pass||sr||function(Dr,$r,Br,Jr){return Jr&&(Jr.S&&Bt(Jr,Ar),Dr.state=function(){return Bt(Ar,{})}),Br?(_.random=Dr,$r):Dr})(_r,cr,"global"in rr?rr.global:this==_,rr.state)},Ut(_.random(),rt)}function initialize$2(rt){seedRandom([],rt)}var propTypes={SHAPE:"shape"};function _typeof(rt){return(_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(rt)}var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null,frames=null;function $bm_isInstanceOfArray(rt){return rt.constructor===Array||rt.constructor===Float32Array}function isNumerable(rt,_){return rt==="number"||rt==="boolean"||rt==="string"||_ instanceof Number}function $bm_neg(rt){var _=_typeof(rt);if(_==="number"||_==="boolean"||rt instanceof Number)return-rt;if($bm_isInstanceOfArray(rt)){var ut,mt=rt.length,bt=[];for(ut=0;ut<mt;ut+=1)bt[ut]=-rt[ut];return bt}return rt.propType?rt.v:-rt}initialize$2(BMMath);var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(rt,_){var ut=_typeof(rt),mt=_typeof(_);if(ut==="string"||mt==="string"||isNumerable(ut,rt)&&isNumerable(mt,_))return rt+_;if($bm_isInstanceOfArray(rt)&&isNumerable(mt,_))return(rt=rt.slice(0))[0]+=_,rt;if(isNumerable(ut,rt)&&$bm_isInstanceOfArray(_))return(_=_.slice(0))[0]=rt+_[0],_;if($bm_isInstanceOfArray(rt)&&$bm_isInstanceOfArray(_)){for(var bt=0,St=rt.length,Mt=_.length,Bt=[];bt<St||bt<Mt;)(typeof rt[bt]=="number"||rt[bt]instanceof Number)&&(typeof _[bt]=="number"||_[bt]instanceof Number)?Bt[bt]=rt[bt]+_[bt]:Bt[bt]=_[bt]===void 0?rt[bt]:rt[bt]||_[bt],bt+=1;return Bt}return 0}var add=sum;function sub(rt,_){var ut=_typeof(rt),mt=_typeof(_);if(isNumerable(ut,rt)&&isNumerable(mt,_))return ut==="string"&&(rt=parseInt(rt,10)),mt==="string"&&(_=parseInt(_,10)),rt-_;if($bm_isInstanceOfArray(rt)&&isNumerable(mt,_))return(rt=rt.slice(0))[0]-=_,rt;if(isNumerable(ut,rt)&&$bm_isInstanceOfArray(_))return(_=_.slice(0))[0]=rt-_[0],_;if($bm_isInstanceOfArray(rt)&&$bm_isInstanceOfArray(_)){for(var bt=0,St=rt.length,Mt=_.length,Bt=[];bt<St||bt<Mt;)(typeof rt[bt]=="number"||rt[bt]instanceof Number)&&(typeof _[bt]=="number"||_[bt]instanceof Number)?Bt[bt]=rt[bt]-_[bt]:Bt[bt]=_[bt]===void 0?rt[bt]:rt[bt]||_[bt],bt+=1;return Bt}return 0}function mul(rt,_){var ut,mt,bt,St=_typeof(rt),Mt=_typeof(_);if(isNumerable(St,rt)&&isNumerable(Mt,_))return rt*_;if($bm_isInstanceOfArray(rt)&&isNumerable(Mt,_)){for(bt=rt.length,ut=createTypedArray("float32",bt),mt=0;mt<bt;mt+=1)ut[mt]=rt[mt]*_;return ut}if(isNumerable(St,rt)&&$bm_isInstanceOfArray(_)){for(bt=_.length,ut=createTypedArray("float32",bt),mt=0;mt<bt;mt+=1)ut[mt]=rt*_[mt];return ut}return 0}function div(rt,_){var ut,mt,bt,St=_typeof(rt),Mt=_typeof(_);if(isNumerable(St,rt)&&isNumerable(Mt,_))return rt/_;if($bm_isInstanceOfArray(rt)&&isNumerable(Mt,_)){for(bt=rt.length,ut=createTypedArray("float32",bt),mt=0;mt<bt;mt+=1)ut[mt]=rt[mt]/_;return ut}if(isNumerable(St,rt)&&$bm_isInstanceOfArray(_)){for(bt=_.length,ut=createTypedArray("float32",bt),mt=0;mt<bt;mt+=1)ut[mt]=rt/_[mt];return ut}return 0}function mod(rt,_){return typeof rt=="string"&&(rt=parseInt(rt,10)),typeof _=="string"&&(_=parseInt(_,10)),rt%_}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(rt,_,ut){if(_>ut){var mt=ut;ut=_,_=mt}return Math.min(Math.max(rt,_),ut)}function radiansToDegrees(rt){return rt/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(rt){return rt*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(rt,_){if(typeof rt=="number"||rt instanceof Number)return _=_||0,Math.abs(rt-_);var ut;_||(_=helperLengthArray);var mt=Math.min(rt.length,_.length),bt=0;for(ut=0;ut<mt;ut+=1)bt+=Math.pow(_[ut]-rt[ut],2);return Math.sqrt(bt)}function normalize(rt){return div(rt,length(rt))}function rgbToHsl(rt){var _,ut,mt=rt[0],bt=rt[1],St=rt[2],Mt=Math.max(mt,bt,St),Bt=Math.min(mt,bt,St),Ut=(Mt+Bt)/2;if(Mt===Bt)_=0,ut=0;else{var Ht=Mt-Bt;switch(ut=Ut>.5?Ht/(2-Mt-Bt):Ht/(Mt+Bt),Mt){case mt:_=(bt-St)/Ht+(bt<St?6:0);break;case bt:_=(St-mt)/Ht+2;break;case St:_=(mt-bt)/Ht+4}_/=6}return[_,ut,Ut,rt[3]]}function hue2rgb(rt,_,ut){return ut<0&&(ut+=1),ut>1&&(ut-=1),ut<1/6?rt+6*(_-rt)*ut:ut<.5?_:ut<2/3?rt+(_-rt)*(2/3-ut)*6:rt}function hslToRgb(rt){var _,ut,mt,bt=rt[0],St=rt[1],Mt=rt[2];if(St===0)_=Mt,mt=Mt,ut=Mt;else{var Bt=Mt<.5?Mt*(1+St):Mt+St-Mt*St,Ut=2*Mt-Bt;_=hue2rgb(Ut,Bt,bt+1/3),ut=hue2rgb(Ut,Bt,bt),mt=hue2rgb(Ut,Bt,bt-1/3)}return[_,ut,mt,rt[3]]}function linear(rt,_,ut,mt,bt){if(mt!==void 0&&bt!==void 0||(mt=_,bt=ut,_=0,ut=1),ut<_){var St=ut;ut=_,_=St}if(rt<=_)return mt;if(rt>=ut)return bt;var Mt,Bt=ut===_?0:(rt-_)/(ut-_);if(!mt.length)return mt+(bt-mt)*Bt;var Ut=mt.length,Ht=createTypedArray("float32",Ut);for(Mt=0;Mt<Ut;Mt+=1)Ht[Mt]=mt[Mt]+(bt[Mt]-mt[Mt])*Bt;return Ht}function random(rt,_){if(_===void 0&&(rt===void 0?(rt=0,_=1):(_=rt,rt=void 0)),_.length){var ut,mt=_.length;rt||(rt=createTypedArray("float32",mt));var bt=createTypedArray("float32",mt),St=BMMath.random();for(ut=0;ut<mt;ut+=1)bt[ut]=rt[ut]+St*(_[ut]-rt[ut]);return bt}return rt===void 0&&(rt=0),rt+BMMath.random()*(_-rt)}function createPath(rt,_,ut,mt){var bt,St=rt.length,Mt=shapePool.newElement();Mt.setPathData(!!mt,St);var Bt,Ut,Ht=[0,0];for(bt=0;bt<St;bt+=1)Bt=_&&_[bt]?_[bt]:Ht,Ut=ut&&ut[bt]?ut[bt]:Ht,Mt.setTripleAt(rt[bt][0],rt[bt][1],Ut[0]+rt[bt][0],Ut[1]+rt[bt][1],Bt[0]+rt[bt][0],Bt[1]+rt[bt][1],bt,!0);return Mt}function initiateExpression(elem,data,property){function noOp(rt){return rt}if(!elem.globalData.renderConfig.runExpressions)return noOp;var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=val.indexOf("random")!==-1,elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||this.data.hd!==!0,wiggle=(function(rt,_){var ut,mt,bt=this.pv.length?this.pv.length:1,St=createTypedArray("float32",bt),Mt=Math.floor(5*time);for(ut=0,mt=0;ut<Mt;){for(mt=0;mt<bt;mt+=1)St[mt]+=-_+2*_*BMMath.random();ut+=1}var Bt=5*time,Ut=Bt-Math.floor(Bt),Ht=createTypedArray("float32",bt);if(bt>1){for(mt=0;mt<bt;mt+=1)Ht[mt]=this.pv[mt]+St[mt]+(-_+2*_*BMMath.random())*Ut;return Ht}return this.pv+St[0]+(-_+2*_*BMMath.random())*Ut}).bind(this);function loopInDuration(rt,_){return loopIn(rt,_,!0)}function loopOutDuration(rt,_){return loopOut(rt,_,!0)}thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty)),this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface),time,velocity,value,text,textIndex,textTotal,selectorValue;function lookAt(rt,_){var ut=[_[0]-rt[0],_[1]-rt[1],_[2]-rt[2]],mt=Math.atan2(ut[0],Math.sqrt(ut[1]*ut[1]+ut[2]*ut[2]))/degToRads;return[-Math.atan2(ut[1],ut[2])/degToRads,mt,0]}function easeOut(rt,_,ut,mt,bt){return applyEase(easeOutBez,rt,_,ut,mt,bt)}function easeIn(rt,_,ut,mt,bt){return applyEase(easeInBez,rt,_,ut,mt,bt)}function ease(rt,_,ut,mt,bt){return applyEase(easeInOutBez,rt,_,ut,mt,bt)}function applyEase(rt,_,ut,mt,bt,St){bt===void 0?(bt=ut,St=mt):_=(_-ut)/(mt-ut),_>1?_=1:_<0&&(_=0);var Mt=rt(_);if($bm_isInstanceOfArray(bt)){var Bt,Ut=bt.length,Ht=createTypedArray("float32",Ut);for(Bt=0;Bt<Ut;Bt+=1)Ht[Bt]=(St[Bt]-bt[Bt])*Mt+bt[Bt];return Ht}return(St-bt)*Mt+bt}function nearestKey(rt){var _,ut,mt,bt=data.k.length;if(data.k.length&&typeof data.k[0]!="number")if(ut=-1,(rt*=elem.comp.globalData.frameRate)<data.k[0].t)ut=1,mt=data.k[0].t;else{for(_=0;_<bt-1;_+=1){if(rt===data.k[_].t){ut=_+1,mt=data.k[_].t;break}if(rt>data.k[_].t&&rt<data.k[_+1].t){rt-data.k[_].t>data.k[_+1].t-rt?(ut=_+2,mt=data.k[_+1].t):(ut=_+1,mt=data.k[_].t);break}}ut===-1&&(ut=_+1,mt=data.k[_].t)}else ut=0,mt=0;var St={};return St.index=ut,St.time=mt/elem.comp.globalData.frameRate,St}function key(rt){var _,ut,mt;if(!data.k.length||typeof data.k[0]=="number")throw new Error("The property has no keyframe at index "+rt);rt-=1,_={time:data.k[rt].t/elem.comp.globalData.frameRate,value:[]};var bt=Object.prototype.hasOwnProperty.call(data.k[rt],"s")?data.k[rt].s:data.k[rt-1].e;for(mt=bt.length,ut=0;ut<mt;ut+=1)_[ut]=bt[ut],_.value[ut]=bt[ut];return _}function framesToTime(rt,_){return _||(_=elem.comp.globalData.frameRate),rt/_}function timeToFrames(rt,_){return rt||rt===0||(rt=time),_||(_=elem.comp.globalData.frameRate),rt*_}function seedRandom(rt){BMMath.seedrandom(randSeed+rt)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(rt,_){return typeof value=="string"?_===void 0?value.substring(rt):value.substring(rt,_):""}function substr(rt,_){return typeof value=="string"?_===void 0?value.substr(rt):value.substr(rt,_):""}function posterizeTime(rt){time=rt===0?0:Math.floor(time*rt)/rt,value=valueAtTime(time)}var index=elem.data.ind;!elem.hierarchy||elem.hierarchy.length;var parent,randSeed=Math.floor(1e6*Math.random()),globalData=elem.globalData;function executeExpression(rt){return value=rt,this.frameExpressionId===elem.globalData.frameId&&this.propType!=="textSelector"?value:(this.propType==="textSelector"&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),elemType!==4||content||(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),!(!elem.hierarchy||!elem.hierarchy.length)&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,_needsRandom&&seedRandom(randSeed+time),needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,scoped_bm_rt=scoped_bm_rt.propType===propTypes.SHAPE?scoped_bm_rt.v:scoped_bm_rt)}return executeExpression.__preventDeadCodeRemoval=[$bm_transform,anchorPoint,time,velocity,inPoint,outPoint,width,height,name,loop_in,loop_out,smooth,toComp,fromCompToSurface,toWorld,fromWorld,mask,position,rotation,scale,thisComp,numKeys,active,wiggle,loopInDuration,loopOutDuration,comp,lookAt,easeOut,easeIn,ease,nearestKey,key,text,textIndex,textTotal,selectorValue,framesToTime,timeToFrames,sourceRectAtTime,substring,substr,posterizeTime,index,globalData],executeExpression}return ob.initiateExpression=initiateExpression,ob.__preventDeadCodeRemoval=[window,document,XMLHttpRequest,fetch,frames,$bm_neg,add,$bm_sum,$bm_sub,$bm_mul,$bm_div,$bm_mod,clamp,radians_to_degrees,degreesToRadians,degrees_to_radians,normalize,rgbToHsl,hslToRgb,linear,random,createPath],ob}(),expressionHelpers={searchExpressions:function(rt,_,ut){_.x&&(ut.k=!0,ut.x=!0,ut.initiateExpression=ExpressionManager.initiateExpression,ut.effectsSequence.push(ut.initiateExpression(rt,_,ut).bind(ut)))},getSpeedAtTime:function(rt){var _=this.getValueAtTime(rt),ut=this.getValueAtTime(rt+-.01),mt=0;if(_.length){var bt;for(bt=0;bt<_.length;bt+=1)mt+=Math.pow(ut[bt]-_[bt],2);mt=100*Math.sqrt(mt)}else mt=0;return mt},getVelocityAtTime:function(rt){if(this.vel!==void 0)return this.vel;var _,ut,mt=this.getValueAtTime(rt),bt=this.getValueAtTime(rt+-.001);if(mt.length)for(_=createTypedArray("float32",mt.length),ut=0;ut<mt.length;ut+=1)_[ut]=(bt[ut]-mt[ut])/-.001;else _=(bt-mt)/-.001;return _},getValueAtTime:function(rt){return rt*=this.elem.globalData.frameRate,(rt-=this.offsetTime)!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<rt?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(rt,this._cachingAtTime),this._cachingAtTime.lastFrame=rt),this._cachingAtTime.value},getStaticValueAtTime:function(){return this.pv},setGroupProperty:function(rt){this.propertyGroup=rt}};function addPropertyDecorator(){function rt(rr,sr,ar){if(!this.k||!this.keyframes)return this.pv;rr=rr?rr.toLowerCase():"";var cr,Ar,_r,Dr,$r,Br=this.comp.renderedFrame,Jr=this.keyframes,mn=Jr[Jr.length-1].t;if(Br<=mn)return this.pv;if(ar?Ar=mn-(cr=sr?Math.abs(mn-this.elem.comp.globalData.frameRate*sr):Math.max(0,mn-this.elem.data.ip)):((!sr||sr>Jr.length-1)&&(sr=Jr.length-1),cr=mn-(Ar=Jr[Jr.length-1-sr].t)),rr==="pingpong"){if(Math.floor((Br-Ar)/cr)%2!=0)return this.getValueAtTime((cr-(Br-Ar)%cr+Ar)/this.comp.globalData.frameRate,0)}else{if(rr==="offset"){var Mn=this.getValueAtTime(Ar/this.comp.globalData.frameRate,0),$n=this.getValueAtTime(mn/this.comp.globalData.frameRate,0),en=this.getValueAtTime(((Br-Ar)%cr+Ar)/this.comp.globalData.frameRate,0),In=Math.floor((Br-Ar)/cr);if(this.pv.length){for(Dr=($r=new Array(Mn.length)).length,_r=0;_r<Dr;_r+=1)$r[_r]=($n[_r]-Mn[_r])*In+en[_r];return $r}return($n-Mn)*In+en}if(rr==="continue"){var Rn=this.getValueAtTime(mn/this.comp.globalData.frameRate,0),qn=this.getValueAtTime((mn-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(Dr=($r=new Array(Rn.length)).length,_r=0;_r<Dr;_r+=1)$r[_r]=Rn[_r]+(Rn[_r]-qn[_r])*((Br-mn)/this.comp.globalData.frameRate)/5e-4;return $r}return Rn+(Br-mn)/.001*(Rn-qn)}}return this.getValueAtTime(((Br-Ar)%cr+Ar)/this.comp.globalData.frameRate,0)}function _(rr,sr,ar){if(!this.k)return this.pv;rr=rr?rr.toLowerCase():"";var cr,Ar,_r,Dr,$r,Br=this.comp.renderedFrame,Jr=this.keyframes,mn=Jr[0].t;if(Br>=mn)return this.pv;if(ar?Ar=mn+(cr=sr?Math.abs(this.elem.comp.globalData.frameRate*sr):Math.max(0,this.elem.data.op-mn)):((!sr||sr>Jr.length-1)&&(sr=Jr.length-1),cr=(Ar=Jr[sr].t)-mn),rr==="pingpong"){if(Math.floor((mn-Br)/cr)%2==0)return this.getValueAtTime(((mn-Br)%cr+mn)/this.comp.globalData.frameRate,0)}else{if(rr==="offset"){var Mn=this.getValueAtTime(mn/this.comp.globalData.frameRate,0),$n=this.getValueAtTime(Ar/this.comp.globalData.frameRate,0),en=this.getValueAtTime((cr-(mn-Br)%cr+mn)/this.comp.globalData.frameRate,0),In=Math.floor((mn-Br)/cr)+1;if(this.pv.length){for(Dr=($r=new Array(Mn.length)).length,_r=0;_r<Dr;_r+=1)$r[_r]=en[_r]-($n[_r]-Mn[_r])*In;return $r}return en-($n-Mn)*In}if(rr==="continue"){var Rn=this.getValueAtTime(mn/this.comp.globalData.frameRate,0),qn=this.getValueAtTime((mn+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(Dr=($r=new Array(Rn.length)).length,_r=0;_r<Dr;_r+=1)$r[_r]=Rn[_r]+(Rn[_r]-qn[_r])*(mn-Br)/.001;return $r}return Rn+(Rn-qn)*(mn-Br)/.001}}return this.getValueAtTime((cr-((mn-Br)%cr+mn))/this.comp.globalData.frameRate,0)}function ut(rr,sr){if(!this.k)return this.pv;if(rr=.5*(rr||.4),(sr=Math.floor(sr||5))<=1)return this.pv;var ar,cr,Ar=this.comp.renderedFrame/this.comp.globalData.frameRate,_r=Ar-rr,Dr=sr>1?(Ar+rr-_r)/(sr-1):1,$r=0,Br=0;for(ar=this.pv.length?createTypedArray("float32",this.pv.length):0;$r<sr;){if(cr=this.getValueAtTime(_r+$r*Dr),this.pv.length)for(Br=0;Br<this.pv.length;Br+=1)ar[Br]+=cr[Br];else ar+=cr;$r+=1}if(this.pv.length)for(Br=0;Br<this.pv.length;Br+=1)ar[Br]/=sr;else ar/=sr;return ar}function mt(rr){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var sr=this._transformCachingAtTime.v;if(sr.cloneFromProps(this.pre.props),this.appliedTransformations<1){var ar=this.a.getValueAtTime(rr);sr.translate(-ar[0]*this.a.mult,-ar[1]*this.a.mult,ar[2]*this.a.mult)}if(this.appliedTransformations<2){var cr=this.s.getValueAtTime(rr);sr.scale(cr[0]*this.s.mult,cr[1]*this.s.mult,cr[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var Ar=this.sk.getValueAtTime(rr),_r=this.sa.getValueAtTime(rr);sr.skewFromAxis(-Ar*this.sk.mult,_r*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var Dr=this.r.getValueAtTime(rr);sr.rotate(-Dr*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var $r=this.rz.getValueAtTime(rr),Br=this.ry.getValueAtTime(rr),Jr=this.rx.getValueAtTime(rr),mn=this.or.getValueAtTime(rr);sr.rotateZ(-$r*this.rz.mult).rotateY(Br*this.ry.mult).rotateX(Jr*this.rx.mult).rotateZ(-mn[2]*this.or.mult).rotateY(mn[1]*this.or.mult).rotateX(mn[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var Mn=this.px.getValueAtTime(rr),$n=this.py.getValueAtTime(rr);if(this.data.p.z){var en=this.pz.getValueAtTime(rr);sr.translate(Mn*this.px.mult,$n*this.py.mult,-en*this.pz.mult)}else sr.translate(Mn*this.px.mult,$n*this.py.mult,0)}else{var In=this.p.getValueAtTime(rr);sr.translate(In[0]*this.p.mult,In[1]*this.p.mult,-In[2]*this.p.mult)}return sr}function bt(){return this.v.clone(new Matrix)}var St=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(rr,sr,ar){var cr=St(rr,sr,ar);return cr.dynamicProperties.length?cr.getValueAtTime=mt.bind(cr):cr.getValueAtTime=bt.bind(cr),cr.setGroupProperty=expressionHelpers.setGroupProperty,cr};var Mt=PropertyFactory.getProp;PropertyFactory.getProp=function(rr,sr,ar,cr,Ar){var _r=Mt(rr,sr,ar,cr,Ar);_r.kf?_r.getValueAtTime=expressionHelpers.getValueAtTime.bind(_r):_r.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(_r),_r.setGroupProperty=expressionHelpers.setGroupProperty,_r.loopOut=rt,_r.loopIn=_,_r.smooth=ut,_r.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(_r),_r.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(_r),_r.numKeys=sr.a===1?sr.k.length:0,_r.propertyIndex=sr.ix;var Dr=0;return ar!==0&&(Dr=createTypedArray("float32",sr.a===1?sr.k[0].s.length:sr.k.length)),_r._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:Dr},expressionHelpers.searchExpressions(rr,sr,_r),_r.k&&Ar.addDynamicProperty(_r),_r};var Bt=ShapePropertyFactory.getConstructorFunction(),Ut=ShapePropertyFactory.getKeyframedConstructorFunction();function Ht(){}Ht.prototype={vertices:function(rr,sr){this.k&&this.getValue();var ar,cr=this.v;sr!==void 0&&(cr=this.getValueAtTime(sr,0));var Ar=cr._length,_r=cr[rr],Dr=cr.v,$r=createSizedArray(Ar);for(ar=0;ar<Ar;ar+=1)$r[ar]=rr==="i"||rr==="o"?[_r[ar][0]-Dr[ar][0],_r[ar][1]-Dr[ar][1]]:[_r[ar][0],_r[ar][1]];return $r},points:function(rr){return this.vertices("v",rr)},inTangents:function(rr){return this.vertices("i",rr)},outTangents:function(rr){return this.vertices("o",rr)},isClosed:function(){return this.v.c},pointOnPath:function(rr,sr){var ar=this.v;sr!==void 0&&(ar=this.getValueAtTime(sr,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(ar));for(var cr,Ar=this._segmentsLength,_r=Ar.lengths,Dr=Ar.totalLength*rr,$r=0,Br=_r.length,Jr=0;$r<Br;){if(Jr+_r[$r].addedLength>Dr){var mn=$r,Mn=ar.c&&$r===Br-1?0:$r+1,$n=(Dr-Jr)/_r[$r].addedLength;cr=bez.getPointInSegment(ar.v[mn],ar.v[Mn],ar.o[mn],ar.i[Mn],$n,_r[$r]);break}Jr+=_r[$r].addedLength,$r+=1}return cr||(cr=ar.c?[ar.v[0][0],ar.v[0][1]]:[ar.v[ar._length-1][0],ar.v[ar._length-1][1]]),cr},vectorOnPath:function(rr,sr,ar){rr==1?rr=this.v.c:rr==0&&(rr=.999);var cr=this.pointOnPath(rr,sr),Ar=this.pointOnPath(rr+.001,sr),_r=Ar[0]-cr[0],Dr=Ar[1]-cr[1],$r=Math.sqrt(Math.pow(_r,2)+Math.pow(Dr,2));return $r===0?[0,0]:ar==="tangent"?[_r/$r,Dr/$r]:[-Dr/$r,_r/$r]},tangentOnPath:function(rr,sr){return this.vectorOnPath(rr,sr,"tangent")},normalOnPath:function(rr,sr){return this.vectorOnPath(rr,sr,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([Ht],Bt),extendPrototype([Ht],Ut),Ut.prototype.getValueAtTime=function(rr){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),rr*=this.elem.globalData.frameRate,(rr-=this.offsetTime)!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<rr?this._caching.lastIndex:0,this._cachingAtTime.lastTime=rr,this.interpolateShape(rr,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue},Ut.prototype.initiateExpression=ExpressionManager.initiateExpression;var tr=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(rr,sr,ar,cr,Ar){var _r=tr(rr,sr,ar,cr,Ar);return _r.propertyIndex=sr.ix,_r.lock=!1,ar===3?expressionHelpers.searchExpressions(rr,sr.pt,_r):ar===4&&expressionHelpers.searchExpressions(rr,sr.ks,_r),_r.k&&rr.addDynamicProperty(_r),_r}}function initialize$1(){addPropertyDecorator()}function addDecorator(){TextProperty.prototype.getExpressionValue=function(rt,_){var ut=this.calculateExpression(_);if(rt.t!==ut){var mt={};return this.copyData(mt,rt),mt.t=ut.toString(),mt.__complete=!1,mt}return rt},TextProperty.prototype.searchProperty=function(){var rt=this.searchKeyframes(),_=this.searchExpressions();return this.kf=rt||_,this.kf},TextProperty.prototype.searchExpressions=function(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}}function initialize(){addDecorator()}function SVGComposableEffect(){}SVGComposableEffect.prototype={createMergeNode:function(rt,_){var ut,mt,bt=createNS("feMerge");for(bt.setAttribute("result",rt),mt=0;mt<_.length;mt+=1)(ut=createNS("feMergeNode")).setAttribute("in",_[mt]),bt.appendChild(ut),bt.appendChild(ut);return bt}};var linearFilterValue="0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0";function SVGTintFilter(rt,_,ut,mt,bt){this.filterManager=_;var St=createNS("feColorMatrix");St.setAttribute("type","matrix"),St.setAttribute("color-interpolation-filters","linearRGB"),St.setAttribute("values",linearFilterValue+" 1 0"),this.linearFilter=St,St.setAttribute("result",mt+"_tint_1"),rt.appendChild(St),(St=createNS("feColorMatrix")).setAttribute("type","matrix"),St.setAttribute("color-interpolation-filters","sRGB"),St.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),St.setAttribute("result",mt+"_tint_2"),rt.appendChild(St),this.matrixFilter=St;var Mt=this.createMergeNode(mt,[bt,mt+"_tint_1",mt+"_tint_2"]);rt.appendChild(Mt)}function SVGFillFilter(rt,_,ut,mt){this.filterManager=_;var bt=createNS("feColorMatrix");bt.setAttribute("type","matrix"),bt.setAttribute("color-interpolation-filters","sRGB"),bt.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),bt.setAttribute("result",mt),rt.appendChild(bt),this.matrixFilter=bt}function SVGStrokeEffect(rt,_,ut){this.initialized=!1,this.filterManager=_,this.elem=ut,this.paths=[]}function SVGTritoneFilter(rt,_,ut,mt){this.filterManager=_;var bt=createNS("feColorMatrix");bt.setAttribute("type","matrix"),bt.setAttribute("color-interpolation-filters","linearRGB"),bt.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),rt.appendChild(bt);var St=createNS("feComponentTransfer");St.setAttribute("color-interpolation-filters","sRGB"),St.setAttribute("result",mt),this.matrixFilter=St;var Mt=createNS("feFuncR");Mt.setAttribute("type","table"),St.appendChild(Mt),this.feFuncR=Mt;var Bt=createNS("feFuncG");Bt.setAttribute("type","table"),St.appendChild(Bt),this.feFuncG=Bt;var Ut=createNS("feFuncB");Ut.setAttribute("type","table"),St.appendChild(Ut),this.feFuncB=Ut,rt.appendChild(St)}function SVGProLevelsFilter(rt,_,ut,mt){this.filterManager=_;var bt=this.filterManager.effectElements,St=createNS("feComponentTransfer");(bt[10].p.k||bt[10].p.v!==0||bt[11].p.k||bt[11].p.v!==1||bt[12].p.k||bt[12].p.v!==1||bt[13].p.k||bt[13].p.v!==0||bt[14].p.k||bt[14].p.v!==1)&&(this.feFuncR=this.createFeFunc("feFuncR",St)),(bt[17].p.k||bt[17].p.v!==0||bt[18].p.k||bt[18].p.v!==1||bt[19].p.k||bt[19].p.v!==1||bt[20].p.k||bt[20].p.v!==0||bt[21].p.k||bt[21].p.v!==1)&&(this.feFuncG=this.createFeFunc("feFuncG",St)),(bt[24].p.k||bt[24].p.v!==0||bt[25].p.k||bt[25].p.v!==1||bt[26].p.k||bt[26].p.v!==1||bt[27].p.k||bt[27].p.v!==0||bt[28].p.k||bt[28].p.v!==1)&&(this.feFuncB=this.createFeFunc("feFuncB",St)),(bt[31].p.k||bt[31].p.v!==0||bt[32].p.k||bt[32].p.v!==1||bt[33].p.k||bt[33].p.v!==1||bt[34].p.k||bt[34].p.v!==0||bt[35].p.k||bt[35].p.v!==1)&&(this.feFuncA=this.createFeFunc("feFuncA",St)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(St.setAttribute("color-interpolation-filters","sRGB"),rt.appendChild(St)),(bt[3].p.k||bt[3].p.v!==0||bt[4].p.k||bt[4].p.v!==1||bt[5].p.k||bt[5].p.v!==1||bt[6].p.k||bt[6].p.v!==0||bt[7].p.k||bt[7].p.v!==1)&&((St=createNS("feComponentTransfer")).setAttribute("color-interpolation-filters","sRGB"),St.setAttribute("result",mt),rt.appendChild(St),this.feFuncRComposed=this.createFeFunc("feFuncR",St),this.feFuncGComposed=this.createFeFunc("feFuncG",St),this.feFuncBComposed=this.createFeFunc("feFuncB",St))}function SVGDropShadowEffect(rt,_,ut,mt,bt){var St=_.container.globalData.renderConfig.filterSize,Mt=_.data.fs||St;rt.setAttribute("x",Mt.x||St.x),rt.setAttribute("y",Mt.y||St.y),rt.setAttribute("width",Mt.width||St.width),rt.setAttribute("height",Mt.height||St.height),this.filterManager=_;var Bt=createNS("feGaussianBlur");Bt.setAttribute("in","SourceAlpha"),Bt.setAttribute("result",mt+"_drop_shadow_1"),Bt.setAttribute("stdDeviation","0"),this.feGaussianBlur=Bt,rt.appendChild(Bt);var Ut=createNS("feOffset");Ut.setAttribute("dx","25"),Ut.setAttribute("dy","0"),Ut.setAttribute("in",mt+"_drop_shadow_1"),Ut.setAttribute("result",mt+"_drop_shadow_2"),this.feOffset=Ut,rt.appendChild(Ut);var Ht=createNS("feFlood");Ht.setAttribute("flood-color","#00ff00"),Ht.setAttribute("flood-opacity","1"),Ht.setAttribute("result",mt+"_drop_shadow_3"),this.feFlood=Ht,rt.appendChild(Ht);var tr=createNS("feComposite");tr.setAttribute("in",mt+"_drop_shadow_3"),tr.setAttribute("in2",mt+"_drop_shadow_2"),tr.setAttribute("operator","in"),tr.setAttribute("result",mt+"_drop_shadow_4"),rt.appendChild(tr);var rr=this.createMergeNode(mt,[mt+"_drop_shadow_4",bt]);rt.appendChild(rr)}extendPrototype([SVGComposableEffect],SVGTintFilter),SVGTintFilter.prototype.renderFrame=function(rt){if(rt||this.filterManager._mdf){var _=this.filterManager.effectElements[0].p.v,ut=this.filterManager.effectElements[1].p.v,mt=this.filterManager.effectElements[2].p.v/100;this.linearFilter.setAttribute("values",linearFilterValue+" "+mt+" 0"),this.matrixFilter.setAttribute("values",ut[0]-_[0]+" 0 0 0 "+_[0]+" "+(ut[1]-_[1])+" 0 0 0 "+_[1]+" "+(ut[2]-_[2])+" 0 0 0 "+_[2]+" 0 0 0 1 0")}},SVGFillFilter.prototype.renderFrame=function(rt){if(rt||this.filterManager._mdf){var _=this.filterManager.effectElements[2].p.v,ut=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+_[0]+" 0 0 0 0 "+_[1]+" 0 0 0 0 "+_[2]+" 0 0 0 "+ut+" 0")}},SVGStrokeEffect.prototype.initialize=function(){var rt,_,ut,mt,bt=this.elem.layerElement.children||this.elem.layerElement.childNodes;for(this.filterManager.effectElements[1].p.v===1?(mt=this.elem.maskManager.masksProperties.length,ut=0):mt=(ut=this.filterManager.effectElements[0].p.v-1)+1,(_=createNS("g")).setAttribute("fill","none"),_.setAttribute("stroke-linecap","round"),_.setAttribute("stroke-dashoffset",1);ut<mt;ut+=1)rt=createNS("path"),_.appendChild(rt),this.paths.push({p:rt,m:ut});if(this.filterManager.effectElements[10].p.v===3){var St=createNS("mask"),Mt=createElementID();St.setAttribute("id",Mt),St.setAttribute("mask-type","alpha"),St.appendChild(_),this.elem.globalData.defs.appendChild(St);var Bt=createNS("g");for(Bt.setAttribute("mask","url("+getLocationHref()+"#"+Mt+")");bt[0];)Bt.appendChild(bt[0]);this.elem.layerElement.appendChild(Bt),this.masker=St,_.setAttribute("stroke","#fff")}else if(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2){if(this.filterManager.effectElements[10].p.v===2)for(bt=this.elem.layerElement.children||this.elem.layerElement.childNodes;bt.length;)this.elem.layerElement.removeChild(bt[0]);this.elem.layerElement.appendChild(_),this.elem.layerElement.removeAttribute("mask"),_.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=_},SVGStrokeEffect.prototype.renderFrame=function(rt){var _;this.initialized||this.initialize();var ut,mt,bt=this.paths.length;for(_=0;_<bt;_+=1)if(this.paths[_].m!==-1&&(ut=this.elem.maskManager.viewData[this.paths[_].m],mt=this.paths[_].p,(rt||this.filterManager._mdf||ut.prop._mdf)&&mt.setAttribute("d",ut.lastPath),rt||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||ut.prop._mdf)){var St;if(this.filterManager.effectElements[7].p.v!==0||this.filterManager.effectElements[8].p.v!==100){var Mt=.01*Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),Bt=.01*Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),Ut=mt.getTotalLength();St="0 0 0 "+Ut*Mt+" ";var Ht,tr=Ut*(Bt-Mt),rr=1+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01,sr=Math.floor(tr/rr);for(Ht=0;Ht<sr;Ht+=1)St+="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01+" ";St+="0 "+10*Ut+" 0 0"}else St="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01;mt.setAttribute("stroke-dasharray",St)}if((rt||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",2*this.filterManager.effectElements[4].p.v),(rt||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(this.filterManager.effectElements[10].p.v===1||this.filterManager.effectElements[10].p.v===2)&&(rt||this.filterManager.effectElements[3].p._mdf)){var ar=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(255*ar[0])+","+bmFloor(255*ar[1])+","+bmFloor(255*ar[2])+")")}},SVGTritoneFilter.prototype.renderFrame=function(rt){if(rt||this.filterManager._mdf){var _=this.filterManager.effectElements[0].p.v,ut=this.filterManager.effectElements[1].p.v,mt=this.filterManager.effectElements[2].p.v,bt=mt[0]+" "+ut[0]+" "+_[0],St=mt[1]+" "+ut[1]+" "+_[1],Mt=mt[2]+" "+ut[2]+" "+_[2];this.feFuncR.setAttribute("tableValues",bt),this.feFuncG.setAttribute("tableValues",St),this.feFuncB.setAttribute("tableValues",Mt)}},SVGProLevelsFilter.prototype.createFeFunc=function(rt,_){var ut=createNS(rt);return ut.setAttribute("type","table"),_.appendChild(ut),ut},SVGProLevelsFilter.prototype.getTableValue=function(rt,_,ut,mt,bt){for(var St,Mt,Bt=0,Ut=Math.min(rt,_),Ht=Math.max(rt,_),tr=Array.call(null,{length:256}),rr=0,sr=bt-mt,ar=_-rt;Bt<=256;)Mt=(St=Bt/256)<=Ut?ar<0?bt:mt:St>=Ht?ar<0?mt:bt:mt+sr*Math.pow((St-rt)/ar,1/ut),tr[rr]=Mt,rr+=1,Bt+=256/255;return tr.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(rt){if(rt||this.filterManager._mdf){var _,ut=this.filterManager.effectElements;this.feFuncRComposed&&(rt||ut[3].p._mdf||ut[4].p._mdf||ut[5].p._mdf||ut[6].p._mdf||ut[7].p._mdf)&&(_=this.getTableValue(ut[3].p.v,ut[4].p.v,ut[5].p.v,ut[6].p.v,ut[7].p.v),this.feFuncRComposed.setAttribute("tableValues",_),this.feFuncGComposed.setAttribute("tableValues",_),this.feFuncBComposed.setAttribute("tableValues",_)),this.feFuncR&&(rt||ut[10].p._mdf||ut[11].p._mdf||ut[12].p._mdf||ut[13].p._mdf||ut[14].p._mdf)&&(_=this.getTableValue(ut[10].p.v,ut[11].p.v,ut[12].p.v,ut[13].p.v,ut[14].p.v),this.feFuncR.setAttribute("tableValues",_)),this.feFuncG&&(rt||ut[17].p._mdf||ut[18].p._mdf||ut[19].p._mdf||ut[20].p._mdf||ut[21].p._mdf)&&(_=this.getTableValue(ut[17].p.v,ut[18].p.v,ut[19].p.v,ut[20].p.v,ut[21].p.v),this.feFuncG.setAttribute("tableValues",_)),this.feFuncB&&(rt||ut[24].p._mdf||ut[25].p._mdf||ut[26].p._mdf||ut[27].p._mdf||ut[28].p._mdf)&&(_=this.getTableValue(ut[24].p.v,ut[25].p.v,ut[26].p.v,ut[27].p.v,ut[28].p.v),this.feFuncB.setAttribute("tableValues",_)),this.feFuncA&&(rt||ut[31].p._mdf||ut[32].p._mdf||ut[33].p._mdf||ut[34].p._mdf||ut[35].p._mdf)&&(_=this.getTableValue(ut[31].p.v,ut[32].p.v,ut[33].p.v,ut[34].p.v,ut[35].p.v),this.feFuncA.setAttribute("tableValues",_))}},extendPrototype([SVGComposableEffect],SVGDropShadowEffect),SVGDropShadowEffect.prototype.renderFrame=function(rt){if(rt||this.filterManager._mdf){if((rt||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),rt||this.filterManager.effectElements[0].p._mdf){var _=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(255*_[0]),Math.round(255*_[1]),Math.round(255*_[2])))}if((rt||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),rt||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var ut=this.filterManager.effectElements[3].p.v,mt=(this.filterManager.effectElements[2].p.v-90)*degToRads,bt=ut*Math.cos(mt),St=ut*Math.sin(mt);this.feOffset.setAttribute("dx",bt),this.feOffset.setAttribute("dy",St)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(rt,_,ut){this.initialized=!1,this.filterManager=_,this.filterElem=rt,this.elem=ut,ut.matteElement=createNS("g"),ut.matteElement.appendChild(ut.layerElement),ut.matteElement.appendChild(ut.transformedElement),ut.baseElement=ut.matteElement}function SVGGaussianBlurEffect(rt,_,ut,mt){rt.setAttribute("x","-100%"),rt.setAttribute("y","-100%"),rt.setAttribute("width","300%"),rt.setAttribute("height","300%"),this.filterManager=_;var bt=createNS("feGaussianBlur");bt.setAttribute("result",mt),rt.appendChild(bt),this.feGaussianBlur=bt}return SVGMatte3Effect.prototype.findSymbol=function(rt){for(var _=0,ut=_svgMatteSymbols.length;_<ut;){if(_svgMatteSymbols[_]===rt)return _svgMatteSymbols[_];_+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(rt,_){var ut=rt.layerElement.parentNode;if(ut){for(var mt,bt=ut.children,St=0,Mt=bt.length;St<Mt&&bt[St]!==rt.layerElement;)St+=1;St<=Mt-2&&(mt=bt[St+1]);var Bt=createNS("use");Bt.setAttribute("href","#"+_),mt?ut.insertBefore(Bt,mt):ut.appendChild(Bt)}},SVGMatte3Effect.prototype.setElementAsMask=function(rt,_){if(!this.findSymbol(_)){var ut=createElementID(),mt=createNS("mask");mt.setAttribute("id",_.layerId),mt.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(_);var bt=rt.globalData.defs;bt.appendChild(mt);var St=createNS("symbol");St.setAttribute("id",ut),this.replaceInParent(_,ut),St.appendChild(_.layerElement),bt.appendChild(St);var Mt=createNS("use");Mt.setAttribute("href","#"+ut),mt.appendChild(Mt),_.data.hd=!1,_.show()}rt.setMatte(_.layerId)},SVGMatte3Effect.prototype.initialize=function(){for(var rt=this.filterManager.effectElements[0].p.v,_=this.elem.comp.elements,ut=0,mt=_.length;ut<mt;)_[ut]&&_[ut].data.ind===rt&&this.setElementAsMask(this.elem,_[ut]),ut+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()},SVGGaussianBlurEffect.prototype.renderFrame=function(rt){if(rt||this.filterManager._mdf){var _=.3*this.filterManager.effectElements[0].p.v,ut=this.filterManager.effectElements[1].p.v,mt=ut==3?0:_,bt=ut==2?0:_;this.feGaussianBlur.setAttribute("stdDeviation",mt+" "+bt);var St=this.filterManager.effectElements[2].p.v==1?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",St)}},registerRenderer("canvas",CanvasRenderer),registerRenderer("html",HybridRenderer),registerRenderer("svg",SVGRenderer),ShapeModifiers.registerModifier("tm",TrimModifier),ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeModifiers.registerModifier("rd",RoundCornersModifier),ShapeModifiers.registerModifier("zz",ZigZagModifier),ShapeModifiers.registerModifier("op",OffsetPathModifier),setExpressionsPlugin(Expressions),setExpressionInterfaces(getInterface),initialize$1(),initialize(),registerEffect(20,SVGTintFilter,!0),registerEffect(21,SVGFillFilter,!0),registerEffect(22,SVGStrokeEffect,!1),registerEffect(23,SVGTritoneFilter,!0),registerEffect(24,SVGProLevelsFilter,!0),registerEffect(25,SVGDropShadowEffect,!0),registerEffect(28,SVGMatte3Effect,!1),registerEffect(29,SVGGaussianBlurEffect,!0),lottie})}),REACT_LOTTIE_PLAYER_VERSION="3.5.3",LOTTIE_WEB_VERSION="^5.10.2",PlayerState,PlayerEvent;function parseSrc(rt){if(typeof rt=="object")return rt;try{return JSON.parse(rt)}catch{}try{return new URL(rt).toString()}catch{}return rt}(function(rt){rt.Loading="loading",rt.Playing="playing",rt.Paused="paused",rt.Stopped="stopped",rt.Frozen="frozen",rt.Error="error"})(PlayerState||(PlayerState={})),function(rt){rt.Load="load",rt.InstanceSaved="instanceSaved",rt.Error="error",rt.Ready="ready",rt.Play="play",rt.Pause="pause",rt.Stop="stop",rt.Freeze="freeze",rt.Loop="loop",rt.Complete="complete",rt.Frame="frame"}(PlayerEvent||(PlayerEvent={}));var defaultOptions={clearCanvas:!1,hideOnTransparent:!0,progressiveLoad:!0},Player=function(rt){function _(ut){var mt=rt.call(this,ut)||this;return mt.container=null,mt.unmounted=!1,mt.handleBgChange=function(bt){mt.setState({background:bt})},mt.triggerDownload=function(bt,St){var Mt=document.createElement("a");Mt.href=bt,Mt.download=St,document.body.appendChild(Mt),Mt.click(),document.body.removeChild(Mt)},mt.snapshot=function(bt){var St;bt===void 0&&(bt=!0);var Mt=mt.props.id?mt.props.id:"lottie",Bt=document.getElementById(Mt);if(mt.props.renderer==="svg"){if(Bt){var Ut=Bt.querySelector("svg");if(Ut){var Ht=new XMLSerializer().serializeToString(Ut);St="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(Ht)}}bt&&mt.triggerDownload(St,"snapshot.svg")}else if(mt.props.renderer==="canvas"){if(Bt){var tr=Bt.querySelector("canvas");tr&&(St=tr.toDataURL("image/png"))}bt&&mt.triggerDownload(St,"snapshot.png")}return St},typeof window<"u"&&(window.lottie=lottie),mt.state={animationData:null,background:"transparent",containerRef:reactExports.createRef(),debug:!0,instance:null,playerState:PlayerState.Loading,seeker:0},mt}return __extends(_,rt),_.getDerivedStateFromProps=function(ut,mt){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(bt){return ut.background!==mt.background?[2,{background:ut.background}]:[2,null]})})},_.prototype.getVersions=function(){return{lottieWebVersion:LOTTIE_WEB_VERSION,lottiePlayerVersion:REACT_LOTTIE_PLAYER_VERSION}},_.prototype.componentDidMount=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(ut){switch(ut.label){case 0:return this.unmounted?[3,2]:[4,this.createLottie()];case 1:ut.sent(),ut.label=2;case 2:return[2]}})})},_.prototype.componentWillUnmount=function(){this.unmounted=!0,this.state.instance&&this.state.instance.destroy()},_.prototype.componentDidUpdate=function(ut){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(mt){switch(mt.label){case 0:return this.props.src===ut.src?[3,2]:(this.state.instance&&this.state.instance.destroy(),[4,this.createLottie()]);case 1:mt.sent(),mt.label=2;case 2:return[2]}})})},_.prototype.render=function(){var ut=this,mt=this.props,bt=mt.children,St=mt.loop,Mt=mt.style,Bt=mt.onBackgroundChange,Ut=mt.className,Ht=this.state,tr=Ht.animationData,rr=Ht.instance,sr=Ht.playerState,ar=Ht.seeker,cr=Ht.debug,Ar=Ht.background;return reactExports.createElement("div",{className:"lf-player-container"},this.state.playerState===PlayerState.Error?reactExports.createElement("div",{className:"lf-error"},reactExports.createElement("span",{"aria-label":"error-symbol",role:"img"},"⚠️")):reactExports.createElement("div",{id:this.props.id?this.props.id:"lottie",ref:function(_r){return ut.container=_r},style:__assign({background:Ar,margin:"0 auto",outline:"none",overflow:"hidden"},Mt),className:Ut}),reactExports.Children.map(bt,function(_r){return reactExports.isValidElement(_r)?reactExports.cloneElement(_r,{animationData:tr,background:Ar,debug:cr,instance:rr,loop:St,pause:function(){return ut.pause()},play:function(){return ut.play()},playerState:sr,seeker:ar,setBackground:function(Dr){ut.setState({background:Dr}),typeof Bt=="function"&&Bt(Dr)},setSeeker:function(Dr,$r){return ut.setSeeker(Dr,$r)},stop:function(){return ut.stop()},toggleDebug:function(){return ut.toggleDebug()},setLoop:function(Dr){return ut.setLoop(Dr)},colorChangedEvent:function(Dr){ut.handleBgChange(Dr)},snapshot:function(){ut.snapshot()}}):null}))},_.prototype.toggleDebug=function(){this.setState({debug:!this.state.debug})},_.prototype.createLottie=function(){return __awaiter$1(this,void 0,void 0,function(){var ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar,_r=this;return __generator$1(this,function(Dr){switch(Dr.label){case 0:if(ut=this.props,mt=ut.autoplay,bt=ut.direction,St=ut.loop,Mt=ut.lottieRef,Bt=ut.renderer,Ut=ut.speed,Ht=ut.src,tr=ut.background,rr=ut.rendererSettings,sr=ut.hover,ar=this.state.instance,!Ht||!this.container)return[2];Dr.label=1;case 1:return Dr.trys.push([1,5,,6]),typeof(cr=parseSrc(Ht))!="string"?[3,4]:[4,fetch(cr).catch(function(){throw _r.setState({playerState:PlayerState.Error}),_r.triggerEvent(PlayerEvent.Error),new Error("@LottieFiles/lottie-react: Animation data could not be fetched.")})];case 2:return[4,Dr.sent().json().catch(function(){throw _r.setState({playerState:PlayerState.Error}),_r.triggerEvent(PlayerEvent.Error),new Error("@LottieFiles/lottie-react: Animation data could not be fetched.")})];case 3:cr=Dr.sent(),Dr.label=4;case 4:return ar&&ar.destroy(),Ar=lottie.loadAnimation({rendererSettings:rr||defaultOptions,animationData:cr,autoplay:mt||!1,container:this.container,loop:St||!1,renderer:Bt}),Ut&&Ar.setSpeed(Ut),this.setState({animationData:cr}),this.setState({instance:Ar},function(){_r.triggerEvent(PlayerEvent.InstanceSaved),typeof Mt=="function"&&Mt(Ar),mt&&_r.play()}),Ar.addEventListener("enterFrame",function(){_r.triggerEvent(PlayerEvent.Frame),_r.setState({seeker:Math.floor(Ar.currentFrame)})}),Ar.addEventListener("DOMLoaded",function(){_r.triggerEvent(PlayerEvent.Load)}),Ar.addEventListener("data_ready",function(){_r.triggerEvent(PlayerEvent.Ready)}),Ar.addEventListener("data_failed",function(){_r.setState({playerState:PlayerState.Error}),_r.triggerEvent(PlayerEvent.Error)}),Ar.addEventListener("loopComplete",function(){_r.triggerEvent(PlayerEvent.Loop)}),Ar.addEventListener("complete",function(){_r.triggerEvent(PlayerEvent.Complete),_r.setState({playerState:PlayerState.Paused}),_r.props.keepLastFrame&&!_r.props.loop||_r.setSeeker(0)}),this.container&&(this.container.addEventListener("mouseenter",function(){sr&&_r.state.playerState!==PlayerState.Playing&&(_r.props.keepLastFrame&&_r.stop(),_r.play())}),this.container.addEventListener("mouseleave",function(){sr&&_r.state.playerState===PlayerState.Playing&&_r.stop()})),Ut&&this.setPlayerSpeed(Ut),bt&&this.setPlayerDirection(bt),tr&&this.setState({background:tr}),[3,6];case 5:return Dr.sent(),this.setState({playerState:PlayerState.Error}),this.triggerEvent(PlayerEvent.Error),[3,6];case 6:return[2]}})})},_.prototype.play=function(){var ut=this.state.instance;ut&&(this.triggerEvent(PlayerEvent.Play),ut.play(),this.setState({playerState:PlayerState.Playing}))},_.prototype.pause=function(){var ut=this.state.instance;ut&&(this.triggerEvent(PlayerEvent.Pause),ut.pause(),this.setState({playerState:PlayerState.Paused}))},_.prototype.stop=function(){var ut=this.state.instance;ut&&(this.triggerEvent(PlayerEvent.Stop),ut.stop(),this.setState({playerState:PlayerState.Stopped}))},_.prototype.setPlayerSpeed=function(ut){var mt=this.state.instance;mt&&mt.setSpeed(ut)},_.prototype.setPlayerDirection=function(ut){var mt=this.state.instance;mt&&mt.setDirection(ut)},_.prototype.setSeeker=function(ut,mt){mt===void 0&&(mt=!1);var bt=this.state,St=bt.instance,Mt=bt.playerState;St&&(mt&&Mt===PlayerState.Playing?St.goToAndPlay(ut,!0):(St.goToAndStop(ut,!0),this.triggerEvent(PlayerEvent.Pause),this.setState({playerState:PlayerState.Paused})))},_.prototype.setLoop=function(ut){var mt=this.state.instance;mt&&(mt.loop=ut,this.setState({instance:mt}))},_.prototype.triggerEvent=function(ut){var mt=this.props.onEvent;mt&&mt(ut)},_.defaultProps={loop:!1},_}(reactExports.Component);function styleInject(rt,_){_===void 0&&(_={});var ut=_.insertAt;if(typeof document<"u"){var mt=document.head||document.getElementsByTagName("head")[0],bt=document.createElement("style");bt.type="text/css",ut==="top"&&mt.firstChild?mt.insertBefore(bt,mt.firstChild):mt.appendChild(bt),bt.styleSheet?bt.styleSheet.cssText=rt:bt.appendChild(document.createTextNode(rt))}}var css_248z=`.lf-progress {
  -webkit-appearance: none;
  -moz-apperance: none;
  width: 100%;
  /* margin: 0 10px; */
  height: 4px;
  border-radius: 3px;
  cursor: pointer;
}
.lf-progress:focus {
  outline: none;
  border: none;
}
.lf-progress::-moz-range-track {
  cursor: pointer;
  background: none;
  border: none;
  outline: none;
}
.lf-progress::-webkit-slider-thumb {
  -webkit-appearance: none !important;
  height: 13px;
  width: 13px;
  border: 0;
  border-radius: 50%;
  background: #0fccce;
  cursor: pointer;
}
.lf-progress::-moz-range-thumb {
  -moz-appearance: none !important;
  height: 13px;
  width: 13px;
  border: 0;
  border-radius: 50%;
  background: #0fccce;
  cursor: pointer;
}
.lf-progress::-ms-track {
  width: 100%;
  height: 3px;
  cursor: pointer;
  background: transparent;
  border-color: transparent;
  color: transparent;
}
.lf-progress::-ms-fill-lower {
  background: #ccc;
  border-radius: 3px;
}
.lf-progress::-ms-fill-upper {
  background: #ccc;
  border-radius: 3px;
}
.lf-progress::-ms-thumb {
  border: 0;
  height: 15px;
  width: 15px;
  border-radius: 50%;
  background: #0fccce;
  cursor: pointer;
}
.lf-progress:focus::-ms-fill-lower {
  background: #ccc;
}
.lf-progress:focus::-ms-fill-upper {
  background: #ccc;
}
.lf-player-container :focus {
  outline: 0;
}
.lf-popover {
  position: relative;
}

.lf-popover-content {
  display: inline-block;
  position: absolute;
  opacity: 1;
  visibility: visible;
  transform: translate(0, -10px);
  box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);
  transition: all 0.3s cubic-bezier(0.75, -0.02, 0.2, 0.97);
}

.lf-popover-content.hidden {
  opacity: 0;
  visibility: hidden;
  transform: translate(0, 0px);
}

.lf-player-btn-container {
  display: flex;
  align-items: center;
}
.lf-player-btn {
  cursor: pointer;
  fill: #999;
  width: 14px;
}

.lf-player-btn.active {
  fill: #555;
}

.lf-popover {
  position: relative;
}

.lf-popover-content {
  display: inline-block;
  position: absolute;
  background-color: #ffffff;
  opacity: 1;

  transform: translate(0, -10px);
  box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);
  transition: all 0.3s cubic-bezier(0.75, -0.02, 0.2, 0.97);
  padding: 10px;
}

.lf-popover-content.hidden {
  opacity: 0;
  visibility: hidden;
  transform: translate(0, 0px);
}

.lf-arrow {
  position: absolute;
  z-index: -1;
  content: '';
  bottom: -9px;
  border-style: solid;
  border-width: 10px 10px 0px 10px;
}

.lf-left-align,
.lf-left-align .lfarrow {
  left: 0;
  right: unset;
}

.lf-right-align,
.lf-right-align .lf-arrow {
  right: 0;
  left: unset;
}

.lf-text-input {
  border: 1px #ccc solid;
  border-radius: 5px;
  padding: 3px;
  width: 60px;
  margin: 0;
}

.lf-color-picker {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  height: 90px;
}

.lf-color-selectors {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.lf-color-component {
  display: flex;
  flex-direction: row;
  font-size: 12px;
  align-items: center;
  justify-content: center;
}

.lf-color-component strong {
  width: 40px;
}

.lf-color-component input[type='range'] {
  margin: 0 0 0 10px;
}

.lf-color-component input[type='number'] {
  width: 50px;
  margin: 0 0 0 10px;
}

.lf-color-preview {
  font-size: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
  padding-left: 5px;
}

.lf-preview {
  height: 60px;
  width: 60px;
}

.lf-popover-snapshot {
  width: 150px;
}
.lf-popover-snapshot h5 {
  margin: 5px 0 10px 0;
  font-size: 0.75rem;
}
.lf-popover-snapshot a {
  display: block;
  text-decoration: none;
}
.lf-popover-snapshot a:before {
  content: '⥼';
  margin-right: 5px;
}
.lf-popover-snapshot .lf-note {
  display: block;
  margin-top: 10px;
  color: #999;
}
.lf-player-controls > div {
  margin-right: 5px;
  margin-left: 5px;
}
.lf-player-controls > div:first-child {
  margin-left: 0px;
}
.lf-player-controls > div:last-child {
  margin-right: 0px;
}
`;styleInject(css_248z);var ColorPicker=function(rt){function _(){var ut=rt!==null&&rt.apply(this,arguments)||this;return ut.state={red:0,green:0,blue:0,rgba:null,hex:"#000000",colorComponents:[]},ut.handleChange=function(mt,bt){if(mt==="r"){var St="#"+(256|bt).toString(16).slice(1)+(256|ut.state.green).toString(16).slice(1)+(256|ut.state.blue).toString(16).slice(1);ut.setState({hex:St})}else mt==="g"?(St="#"+(256|ut.state.red).toString(16).slice(1)+(256|bt).toString(16).slice(1)+(256|ut.state.blue).toString(16).slice(1),ut.setState({hex:St})):mt==="b"&&(St="#"+(256|ut.state.red).toString(16).slice(1)+(256|ut.state.green).toString(16).slice(1)+(256|bt).toString(16).slice(1),ut.setState({hex:St}))},ut.parseColor=function(mt){var bt;if(typeof mt=="string"){if(mt[0]==="#"){var St=mt.length===4?[mt.slice(1,2),mt.slice(2,3),mt.slice(3,4)].map(function(Mt){return parseInt(""+Mt+Mt,16)}):[mt.slice(1,3),mt.slice(3,5),mt.slice(5,7)].map(function(Mt){return parseInt(Mt,16)});ut.setState({colorComponents:St})}else mt.startsWith("rgb")&&(St=(bt=mt.match(/\d+/g))===null||bt===void 0?void 0:bt.map(function(Mt){return parseInt(Mt)}))!==void 0&&ut.setState({colorComponents:St});ut.state.colorComponents.length&&(ut.setState({red:ut.state.colorComponents[0]}),ut.setState({green:ut.state.colorComponents[1]}),ut.setState({blue:ut.state.colorComponents[2]}))}},ut}return __extends(_,rt),_.prototype.componentDidUpdate=function(ut,mt){return this.props.colorChangedEvent&&this.state.hex!==mt.hex&&this.props.colorChangedEvent(this.state.hex),!0},_.prototype.render=function(){var ut=this;return reactExports.createElement("div",{className:"lf-color-picker"},reactExports.createElement("div",{className:"lf-color-selectors"},reactExports.createElement("div",{className:"lf-color-component"},reactExports.createElement("strong",null,"Red"),reactExports.createElement("input",{type:"range",min:"0",max:"255",value:this.state.red,onChange:function(mt){ut.setState({red:mt.target.value}),ut.handleChange("r",mt.target.value)}}),reactExports.createElement("input",{className:"lf-text-input",type:"number",min:"0",max:"255",value:this.state.red,onChange:function(mt){ut.setState({red:mt.target.value}),ut.handleChange("r",mt.target.value)}})),reactExports.createElement("div",{className:"lf-color-component"},reactExports.createElement("strong",null,"Green"),reactExports.createElement("input",{type:"range",min:"0",max:"255",value:this.state.green,onChange:function(mt){ut.setState({green:mt.target.value}),ut.handleChange("g",mt.target.value)}}),reactExports.createElement("input",{className:"lf-text-input",type:"number",min:"0",max:"255",value:this.state.green,onChange:function(mt){ut.setState({green:mt.target.value}),ut.handleChange("g",mt.target.value)}})),reactExports.createElement("div",{className:"lf-color-component"},reactExports.createElement("strong",null,"Blue"),reactExports.createElement("input",{type:"range",min:"0",max:"255",value:this.state.blue,onChange:function(mt){ut.setState({blue:mt.target.value}),ut.handleChange("b",mt.target.value)}}),reactExports.createElement("input",{className:"lf-text-input",type:"number",min:"0",max:"255",value:this.state.blue,onChange:function(mt){ut.setState({blue:mt.target.value}),ut.handleChange("b",mt.target.value)}}))),reactExports.createElement("div",{className:"lf-color-preview"},reactExports.createElement("div",{className:"lf-preview",style:{background:"rgb("+this.state.red+", "+this.state.green+", "+this.state.blue+")"}}),reactExports.createElement("div",null,reactExports.createElement("input",{className:"lf-text-input",type:"text",value:this.state.hex,onChange:function(mt){ut.setState({hex:mt.target.value}),ut.parseColor(mt.target.value)}}))))},_}(reactExports.Component),Popover=function(rt){var _=rt.children,ut=rt.icon,mt=reactExports.useState(null),bt=mt[0],St=mt[1],Mt=reactExports.useState(null),Bt=Mt[0],Ut=Mt[1],Ht=reactExports.useState(null),tr=Ht[0],rr=Ht[1],sr=reactExports.useState(!1),ar=sr[0],cr=sr[1];return reactExports.useEffect(function(){if(bt&&Bt){var Ar=bt.getBoundingClientRect(),_r=Bt.getBoundingClientRect(),Dr=Ar.left+_r.width>window.innerWidth?-1:0;rr(Dr)}},[tr,Bt,bt]),reactExports.createElement("div",{className:"lf-popover",onMouseOver:function(){cr(!0)},onMouseLeave:function(){cr(!1)},ref:function(Ar){St(Ar)}},reactExports.createElement("div",{className:" lf-player-btn"},ut),reactExports.createElement("div",{className:"lf-popover-content",ref:function(Ar){Ut(Ar)},style:{bottom:"22px",right:"0px",zIndex:2,visibility:ar?"visible":"hidden"}},_))},Seeker=function(rt){function _(ut){var mt=rt.call(this,ut)||this;return mt.inputRef=reactExports.createRef(),mt.handleChange=function(){return function(bt){var St=bt.target.value,Mt=Math.floor(St/100*mt.props.max);mt.props.onChange(Mt)}},mt.state={value:0},mt}return __extends(_,rt),_.prototype.render=function(){var ut=this.props.value/this.props.max*100,mt={backgroundImage:"-webkit-gradient(linear, left top, right top, color-stop("+ut+"%, rgba(15, 204, 206, 0.4)), color-stop("+ut+"%, #DAE1E7))"},bt={position:"absolute",left:0,marginTop:"8px",width:"20px",display:"block",border:"0px",backgroundColor:this.props.darkTheme?"#505050":"rgb(218, 225, 231)",color:this.props.darkTheme?"#B9B9B9":"#555",padding:"2px",textAlign:"center",borderRadius:"3px",fontSize:"8px",fontWeight:"bold"},St={position:"absolute",right:0,marginTop:"8px",width:"20px",display:"block",border:"0px",backgroundColor:this.props.darkTheme?"#505050":"rgb(218, 225, 231)",color:this.props.darkTheme?"#B9B9B9":"#555",padding:"2px",textAlign:"center",borderRadius:"3px",fontSize:"8px",fontWeight:"bold"};return reactExports.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",marginRight:"5px",marginLeft:"5px",position:"relative"}},reactExports.createElement("input",{ref:this.inputRef,id:"track",className:"lf-progress",name:"progress","aria-label":"progress",type:"range",min:"0",max:"100",step:"0.1",value:ut,onInput:this.handleChange(),onChange:this.handleChange(),style:mt}),this.props.showLabels&&reactExports.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},reactExports.createElement("div",{style:bt},this.props.min),reactExports.createElement("div",{style:St},this.props.max)))},_}(reactExports.Component),ControlButtonStyle={display:"inline-flex",cursor:"pointer"};(function(rt){function _(ut){var mt=rt.call(this,ut)||this;return mt.state={activeFrame:0,mouseDown:!1},mt}return __extends(_,rt),_.prototype.render=function(){var ut=this,mt=this.props,bt=mt.instance,St=mt.playerState,Mt=mt.seeker,Bt=mt.setLoop,Ut=mt.setSeeker,Ht=mt.play,tr=mt.pause,rr=mt.stop,sr=mt.visible,ar=mt.buttons;if(!bt||!sr)return null;var cr=!ar||ar.includes("play"),Ar=!ar||ar.includes("stop"),_r=!ar||ar.includes("repeat"),Dr=!ar||ar.includes("frame"),$r=!ar||ar.includes("background"),Br=!ar||ar.includes("snapshot"),Jr={width:14,height:14,viewBox:"0 0 24 24"},mn=Math.round(bt.currentFrame);return reactExports.createElement("div",{className:"lf-player-controls",style:{display:"flex",justifyContent:"space-between",height:"60px",alignItems:"center",backgroundColor:this.props.transparentTheme?"transparent":this.props.darkTheme?"#3C3C3C":"#ffffff",paddingLeft:"10px",paddingRight:"10px"}},cr&&reactExports.createElement("div",{role:"button","aria-label":St===PlayerState.Playing?PlayerEvent.Pause:PlayerEvent.Play,tabIndex:0,onClick:function(){St===PlayerState.Playing?typeof tr=="function"&&tr():typeof Ht=="function"&&Ht()},onKeyDown:function(){St===PlayerState.Playing?typeof tr=="function"&&tr():typeof Ht=="function"&&Ht()},className:"lf-player-btn",style:ControlButtonStyle},St===PlayerState.Playing?reactExports.createElement("svg",__assign({},Jr),reactExports.createElement("rect",{height:"22.9",rx:"1.9",width:"7.6",x:"14",y:".5"}),reactExports.createElement("rect",{height:"22.9",rx:"1.9",width:"7.6",x:"2",y:".5"})):reactExports.createElement("svg",__assign({},Jr),reactExports.createElement("path",{d:"M2 3.4C2 1.9 3.5 1 4.8 1.8l16.5 9.6c1.2.7 1.2 2.5 0 3.2L4.8 24.2C3.5 25 2 24.1 2 22.6V3.4z"}))),Ar&&reactExports.createElement("div",{tabIndex:0,role:"button","aria-label":PlayerEvent.Stop,onClick:function(){return rr&&rr()},onKeyDown:function(){return rr&&rr()},className:St===PlayerState.Stopped?"lf-player-btn active":"lf-player-btn",style:ControlButtonStyle},reactExports.createElement("svg",__assign({},Jr),reactExports.createElement("path",{d:`M2 3.667A1.67 1.67 0 0 1 3.667 2h16.666A1.67 1.67 0 0 1 22 3.667v16.666A1.67 1.67 0 0 1 20.333
            22H3.667A1.67 1.67 0 0 1 2 20.333z`}))),reactExports.createElement(Seeker,{min:0,step:1,max:bt?bt.totalFrames:1,value:Mt||0,onChange:function(Mn){Ut&&ut.setState({activeFrame:Mn},function(){Ut(Mn,!1)})},onChangeEnd:function(Mn){Ut&&ut.setState({activeFrame:Mn},function(){Ut(Mn,!1)})},showLabels:this.props.showLabels,darkTheme:this.props.darkTheme}),Dr&&reactExports.createElement("div",{role:"button",className:"lf-player-btn-container"},reactExports.createElement("input",{style:{outline:"none",border:this.props.darkTheme?"1px #505050 solid":"1px #ccc solid",borderRadius:"3px",width:"40px",textAlign:"center",backgroundColor:this.props.darkTheme?"#505050":"#ffffff",color:this.props.darkTheme?"#B9B9B9":"#999",fontSize:"0.7rem",padding:"0",fontFamily:"inherit"},type:"text",value:mn,readOnly:!0})),_r&&reactExports.createElement("div",{role:"button","aria-label":PlayerEvent.Loop,tabIndex:0,onClick:function(){bt&&Bt&&Bt(!bt.loop)},onKeyDown:function(){bt&&Bt&&Bt(!bt.loop)},className:bt.loop?"lf-player-btn active":"lf-player-btn",style:ControlButtonStyle},reactExports.createElement("svg",__assign({},Jr),reactExports.createElement("path",{d:`M12.5 16.8137h-.13v1.8939h4.9696c3.6455 0 6.6113-2.9658 6.6113-6.6116
            0-3.64549-2.9658-6.61131-6.6113-6.61131-.5231 0-.947.42391-.947.94696 0 .52304.4239.94696.947.94696 2.6011 0
            4.7174 2.11634 4.7174 4.71739 0 2.6014-2.1166 4.7177-4.7174 4.7177H12.5zM13.6025
            5.61469v-.13H7.48137C3.83582 5.48469.87 8.45051.87 12.096c0 3.6509 3.17269 6.6117 6.81304 6.6117.52304 0
            .94696-.424.94696-.947 0-.5231-.42392-.947-.94696-.947-2.60804 0-4.91907-2.1231-4.91907-4.7176 0-2.60115
            2.11634-4.71744 4.7174-4.71744h6.12113V5.61469z`,stroke:"#8795A1",strokeWidth:".26"}),reactExports.createElement("path",{d:`M11.1482
            2.20355h0l-.001-.00116c-.3412-.40061-.9405-.44558-1.33668-.0996h-.00001c-.39526.34519-.43936.94795-.09898
            1.34767l2.51487 3.03683-2.51894 3.06468c-.33872.40088-.29282 1.00363.10347
            1.34723l.08517-.0982-.08517.0982c.17853.1549.39807.2308.61647.2308.2671 0 .5328-.114.72-.3347h0l.0011-.0014
            3.0435-3.68655.0006-.00068c.3035-.35872.3025-.88754-.0019-1.24526l-3.0425-3.65786zM13.9453
            21.7965h0l.001.0011c.3413.4006.9407.4456 1.337.0996h0c.3953-.3452.4395-.9479.099-1.3477l-2.5154-3.0368
            2.5195-3.0647c.3388-.4008.2929-1.0036-.1035-1.3472l-.0852.0982.0852-.0982c-.1786-.1549-.3981-.2308-.6166-.2308-.2671
            0-.5329.114-.7202.3347h0l-.0011.0014-3.0442
            3.6865c-.0001.0003-.0003.0005-.0005.0007-.3036.3587-.3027.8876.0019 1.2453l3.0431 3.6579z`,fill:"#8795A1",stroke:"#8795A1",strokeWidth:".26"}))),$r&&reactExports.createElement(Popover,{icon:reactExports.createElement("svg",__assign({},Jr),reactExports.createElement("path",{d:`M12 3.1L6.1 8.6a7.6 7.6 0 00-2.2 4 7.2 7.2 0 00.4 4.4 7.9 7.9 0 003 3.5 8.7 8.7 0 004.7 1.3c1.6 0
            3.2-.5 4.6-1.3s2.4-2 3-3.5a7.2 7.2 0 00.5-4.5 7.6 7.6 0 00-2.2-4L12 3.2zM12 0l7.5 7a9.8 9.8 0 013 5.1
            9.3 9.3 0 01-.6 5.8c-.9 1.8-2.2 3.3-4 4.4A11.2 11.2 0 0112 24a11.2 11.2 0
            01-6-1.7c-1.7-1-3-2.6-3.9-4.4a9.3 9.3 0 01-.6-5.8c.4-2 1.5-3.7 3-5L12 0zM6 14h12c0 1.5-.7 3-1.8 4s-2.6
            1.6-4.2 1.6S9 19 7.8 18s-1.7-2.5-1.7-4z`}))},reactExports.createElement("div",{slot:"content",className:"lf-popover popover-background"},reactExports.createElement(ColorPicker,{colorChangedEvent:this.props.colorChangedEvent}))),Br&&reactExports.createElement(Popover,{icon:reactExports.createElement("svg",__assign({},Jr),reactExports.createElement("path",{clipRule:"evenodd",d:`M0 3.01A2.983 2.983 0 012.983.027H16.99a2.983 2.983 0 012.983 2.983v14.008a2.982 2.982 0 01-2.983
              2.983H2.983A2.983 2.983 0 010 17.018zm2.983-.941a.941.941 0 00-.942.94v14.01c0
              .52.422.94.942.94H16.99a.94.94 0 00.941-.94V3.008a.941.941 0 00-.94-.94H2.981z`,fillRule:"evenodd"}),reactExports.createElement("path",{d:"M12.229 7.945l-2.07 4.598-2.586-2.605-2.414 2.758v2.146h9.656V11.93z"}),reactExports.createElement("circle",{cx:"7.444",cy:"6.513",r:"2.032"}),reactExports.createElement("path",{d:`M9.561 23.916h11.25a2.929 2.929 0 002.926-2.927V9.954a1.06 1.06 0 10-2.122 0v11.035a.805.805 0
              01-.803.804H9.562a1.061 1.061 0 100 2.123z`,stroke:"#8795a1",strokeWidth:".215"}))},reactExports.createElement("div",{slot:"content",className:"lf-popover lf-popover-snapshot",onWheel:function(Mn){Ut&&Ut(mn+(Mn.deltaY>0?-1:1),!1)}},reactExports.createElement("h5",null,"Frame ",mn),reactExports.createElement("div",{style:{cursor:"pointer",color:"#0FCCCE"},onClick:this.props.snapshot},"Download SVG"),reactExports.createElement("div",{style:{cursor:"pointer",color:"#0FCCCE"},onClick:this.props.snapshot},"Download PNG"),reactExports.createElement("i",{className:"lf-note"},"Scroll with mousewheel to find exact frame"))))},_})(reactExports.Component);const float="_float_1afm8_1",learnMore="_learnMore_1afm8_22",styles$1={float,learnMore},Float$2=()=>jsxRuntimeExports.jsx("div",{className:styles$1.float,children:jsxRuntimeExports.jsx(Player,{src:"https://assets1.lottiefiles.com/packages/lf20_myejiggj.json",className:"player",loop:!0,autoplay:!0})}),Home=()=>{const[rt,_]=reactExports.useState(window.innerWidth>1079);return reactExports.useEffect(()=>{const ut=()=>{_(window.innerWidth>1079)};return window.addEventListener("resize",ut),()=>window.removeEventListener("resize",ut)},[]),jsxRuntimeExports.jsxs("div",{className:styles$2.homeContainer,children:[jsxRuntimeExports.jsx(TypingText,{}),rt&&jsxRuntimeExports.jsx(Float$2,{})]})},TypingText=()=>{const[rt,_]=reactExports.useState(0),[ut,mt]=reactExports.useState(!1),[bt,St]=reactExports.useState(""),[Mt,Bt]=reactExports.useState(300-Math.random()*100),[,Ut]=reactExports.useState(1),Ht=["Web Developer","3D Artist","Web Designer"],tr=2e3,[,rr]=useAtom(setTab),[sr,ar]=reactExports.useState(!1),cr=()=>{ar(!0),console.log("Mouse is hovering!")},Ar=()=>{ar(!1),console.log("Mouse is not hovering.")};reactExports.useEffect(()=>{let Dr=setInterval(()=>{_r()},Mt);return()=>{clearInterval(Dr)}},[bt]);const _r=()=>{let Dr=rt%Ht.length,$r=Ht[Dr],Br=ut?$r.substring(0,bt.length-1):$r.substring(0,bt.length+1);St(Br),ut&&Bt(Jr=>Jr/2),!ut&&Br===$r?(mt(!0),Ut(Jr=>Jr-1),Bt(tr)):ut&&Br===""?(mt(!1),_(rt+1),Ut(1),Bt(500)):Ut(Jr=>Jr+1)};return jsxRuntimeExports.jsxs("div",{className:styles$2.textContainer,children:[jsxRuntimeExports.jsx("span",{className:styles$2.tagline,children:"Welcome to my Portfolio"}),jsxRuntimeExports.jsxs("h1",{className:styles$2.bigTitle,children:[jsxRuntimeExports.jsx("p",{children:"Hi! I'm Loop Shen, "}),jsxRuntimeExports.jsx("span",{className:"txt-rotate","data-period":"1000","data-rotate":'[ "Web Developer", "3D Artist", "Web Designer", ]',children:jsxRuntimeExports.jsx("span",{className:"wrap",children:bt})})]}),jsxRuntimeExports.jsxs("div",{className:styles$2.description,children:[jsxRuntimeExports.jsx("p",{children:"Go big or go home when it comes to having fun --👻 👻"}),jsxRuntimeExports.jsx("p",{children:" Party like there’s no tomorrow...HahHah.."})]}),jsxRuntimeExports.jsxs("div",{className:styles$2.aniButton,onMouseEnter:cr,onMouseLeave:Ar,style:{marginLeft:sr?"10px":"0px",transition:"margin-left 0.2s ease-in-out, font-style 0.2s ease-in-out",fontStyle:sr?"italic":"normal"},children:[jsxRuntimeExports.jsx(Link,{onClick:()=>{console.log("Go sightseeing～"),rr(1)},to:"/projects",children:"Go sightseeing"}),jsxRuntimeExports.jsx("div",{style:{marginLeft:sr?"10px":"0px",transition:"margin-left 0.3s ease-in-out"},children:jsxRuntimeExports.jsx(ArrowRightCircle,{size:25})})]})]})},outContainer="_outContainer_1lg0f_3",flexContainer="_flexContainer_1lg0f_15",item="_item_1lg0f_22",pImage="_pImage_1lg0f_38",pText="_pText_1lg0f_54",styles={outContainer,flexContainer,item,pImage,pText},Projects$1=()=>{const[rt,_]=useAtom(setProjectShow),ut=[{name:"in3",img:"/projectImg/in3.png",link:"/projects/in3"},{name:"threeDCharacter",img:"/projectImg/threeDCharacter.png",link:"/projects/threedcharacter"},{name:"carCar",img:"/projectImg/carCar.png",link:"/projects/car"},{name:"aiGallery",img:"/projectImg/aiGallery.png",link:"/projects/gallery"}];return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:!rt&&jsxRuntimeExports.jsx("div",{className:styles.outContainer,children:jsxRuntimeExports.jsx("div",{className:styles.flexContainer,children:ut.map((mt,bt)=>jsxRuntimeExports.jsxs(Link,{to:ut[bt].link,className:styles.item,onClick:()=>{_(!0),console.log(bt,mt,rt)},children:[jsxRuntimeExports.jsx("div",{className:styles.pImage,children:jsxRuntimeExports.jsx("img",{src:ut[bt].img})}),jsxRuntimeExports.jsx("div",{className:styles.pText,children:ut[bt].name})]},bt))})})||rt&&jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(Outlet,{})})})};/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="150",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,TwoPassDoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipMapNearestFilter=1004,NearestMipmapLinearFilter=1005,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipMapNearestFilter=1007,LinearMipmapLinearFilter=1008,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,AlphaFormat=1021,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,NormalAnimationBlendMode=2500,AdditiveAnimationBlendMode=2501,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,LinearEncoding$1=3e3,sRGBEncoding$1=3001,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",ZeroStencilOp=0,KeepStencilOp=7680,ReplaceStencilOp=7681,IncrementStencilOp=7682,DecrementStencilOp=7683,IncrementWrapStencilOp=34055,DecrementWrapStencilOp=34056,InvertStencilOp=5386,NeverStencilFunc=512,LessStencilFunc=513,EqualStencilFunc=514,LessEqualStencilFunc=515,GreaterStencilFunc=516,NotEqualStencilFunc=517,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,StaticDrawUsage=35044,DynamicDrawUsage=35048,StreamDrawUsage=35040,StaticReadUsage=35045,DynamicReadUsage=35049,StreamReadUsage=35041,StaticCopyUsage=35046,DynamicCopyUsage=35050,StreamCopyUsage=35042,GLSL1="100",GLSL3="300 es",_SRGBAFormat=1035;class EventDispatcher{addEventListener(_,ut){this._listeners===void 0&&(this._listeners={});const mt=this._listeners;mt[_]===void 0&&(mt[_]=[]),mt[_].indexOf(ut)===-1&&mt[_].push(ut)}hasEventListener(_,ut){if(this._listeners===void 0)return!1;const mt=this._listeners;return mt[_]!==void 0&&mt[_].indexOf(ut)!==-1}removeEventListener(_,ut){if(this._listeners===void 0)return;const bt=this._listeners[_];if(bt!==void 0){const St=bt.indexOf(ut);St!==-1&&bt.splice(St,1)}}dispatchEvent(_){if(this._listeners===void 0)return;const mt=this._listeners[_.type];if(mt!==void 0){_.target=this;const bt=mt.slice(0);for(let St=0,Mt=bt.length;St<Mt;St++)bt[St].call(this,_);_.target=null}}}const _lut$1=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let _seed=1234567;const DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID$1(){const rt=Math.random()*4294967295|0,_=Math.random()*4294967295|0,ut=Math.random()*4294967295|0,mt=Math.random()*4294967295|0;return(_lut$1[rt&255]+_lut$1[rt>>8&255]+_lut$1[rt>>16&255]+_lut$1[rt>>24&255]+"-"+_lut$1[_&255]+_lut$1[_>>8&255]+"-"+_lut$1[_>>16&15|64]+_lut$1[_>>24&255]+"-"+_lut$1[ut&63|128]+_lut$1[ut>>8&255]+"-"+_lut$1[ut>>16&255]+_lut$1[ut>>24&255]+_lut$1[mt&255]+_lut$1[mt>>8&255]+_lut$1[mt>>16&255]+_lut$1[mt>>24&255]).toLowerCase()}function clamp$7(rt,_,ut){return Math.max(_,Math.min(ut,rt))}function euclideanModulo(rt,_){return(rt%_+_)%_}function mapLinear(rt,_,ut,mt,bt){return mt+(rt-_)*(bt-mt)/(ut-_)}function inverseLerp(rt,_,ut){return rt!==_?(ut-rt)/(_-rt):0}function lerp(rt,_,ut){return(1-ut)*rt+ut*_}function damp$1(rt,_,ut,mt){return lerp(rt,_,1-Math.exp(-ut*mt))}function pingpong(rt,_=1){return _-Math.abs(euclideanModulo(rt,_*2)-_)}function smoothstep(rt,_,ut){return rt<=_?0:rt>=ut?1:(rt=(rt-_)/(ut-_),rt*rt*(3-2*rt))}function smootherstep(rt,_,ut){return rt<=_?0:rt>=ut?1:(rt=(rt-_)/(ut-_),rt*rt*rt*(rt*(rt*6-15)+10))}function randInt(rt,_){return rt+Math.floor(Math.random()*(_-rt+1))}function randFloat(rt,_){return rt+Math.random()*(_-rt)}function randFloatSpread(rt){return rt*(.5-Math.random())}function seededRandom(rt){rt!==void 0&&(_seed=rt);let _=_seed+=1831565813;return _=Math.imul(_^_>>>15,_|1),_^=_+Math.imul(_^_>>>7,_|61),((_^_>>>14)>>>0)/4294967296}function degToRad(rt){return rt*DEG2RAD}function radToDeg(rt){return rt*RAD2DEG}function isPowerOfTwo(rt){return(rt&rt-1)===0&&rt!==0}function ceilPowerOfTwo(rt){return Math.pow(2,Math.ceil(Math.log(rt)/Math.LN2))}function floorPowerOfTwo(rt){return Math.pow(2,Math.floor(Math.log(rt)/Math.LN2))}function setQuaternionFromProperEuler(rt,_,ut,mt,bt){const St=Math.cos,Mt=Math.sin,Bt=St(ut/2),Ut=Mt(ut/2),Ht=St((_+mt)/2),tr=Mt((_+mt)/2),rr=St((_-mt)/2),sr=Mt((_-mt)/2),ar=St((mt-_)/2),cr=Mt((mt-_)/2);switch(bt){case"XYX":rt.set(Bt*tr,Ut*rr,Ut*sr,Bt*Ht);break;case"YZY":rt.set(Ut*sr,Bt*tr,Ut*rr,Bt*Ht);break;case"ZXZ":rt.set(Ut*rr,Ut*sr,Bt*tr,Bt*Ht);break;case"XZX":rt.set(Bt*tr,Ut*cr,Ut*ar,Bt*Ht);break;case"YXY":rt.set(Ut*ar,Bt*tr,Ut*cr,Bt*Ht);break;case"ZYZ":rt.set(Ut*cr,Ut*ar,Bt*tr,Bt*Ht);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+bt)}}function denormalize(rt,_){switch(_.constructor){case Float32Array:return rt;case Uint16Array:return rt/65535;case Uint8Array:return rt/255;case Int16Array:return Math.max(rt/32767,-1);case Int8Array:return Math.max(rt/127,-1);default:throw new Error("Invalid component type.")}}function normalize$6(rt,_){switch(_.constructor){case Float32Array:return rt;case Uint16Array:return Math.round(rt*65535);case Uint8Array:return Math.round(rt*255);case Int16Array:return Math.round(rt*32767);case Int8Array:return Math.round(rt*127);default:throw new Error("Invalid component type.")}}const MathUtils={DEG2RAD,RAD2DEG,generateUUID:generateUUID$1,clamp:clamp$7,euclideanModulo,mapLinear,inverseLerp,lerp,damp:damp$1,pingpong,smoothstep,smootherstep,randInt,randFloat,randFloatSpread,seededRandom,degToRad,radToDeg,isPowerOfTwo,ceilPowerOfTwo,floorPowerOfTwo,setQuaternionFromProperEuler,normalize:normalize$6,denormalize};class Vector2{constructor(_=0,ut=0){Vector2.prototype.isVector2=!0,this.x=_,this.y=ut}get width(){return this.x}set width(_){this.x=_}get height(){return this.y}set height(_){this.y=_}set(_,ut){return this.x=_,this.y=ut,this}setScalar(_){return this.x=_,this.y=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setComponent(_,ut){switch(_){case 0:this.x=ut;break;case 1:this.y=ut;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y)}copy(_){return this.x=_.x,this.y=_.y,this}add(_){return this.x+=_.x,this.y+=_.y,this}addScalar(_){return this.x+=_,this.y+=_,this}addVectors(_,ut){return this.x=_.x+ut.x,this.y=_.y+ut.y,this}addScaledVector(_,ut){return this.x+=_.x*ut,this.y+=_.y*ut,this}sub(_){return this.x-=_.x,this.y-=_.y,this}subScalar(_){return this.x-=_,this.y-=_,this}subVectors(_,ut){return this.x=_.x-ut.x,this.y=_.y-ut.y,this}multiply(_){return this.x*=_.x,this.y*=_.y,this}multiplyScalar(_){return this.x*=_,this.y*=_,this}divide(_){return this.x/=_.x,this.y/=_.y,this}divideScalar(_){return this.multiplyScalar(1/_)}applyMatrix3(_){const ut=this.x,mt=this.y,bt=_.elements;return this.x=bt[0]*ut+bt[3]*mt+bt[6],this.y=bt[1]*ut+bt[4]*mt+bt[7],this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this}clamp(_,ut){return this.x=Math.max(_.x,Math.min(ut.x,this.x)),this.y=Math.max(_.y,Math.min(ut.y,this.y)),this}clampScalar(_,ut){return this.x=Math.max(_,Math.min(ut,this.x)),this.y=Math.max(_,Math.min(ut,this.y)),this}clampLength(_,ut){const mt=this.length();return this.divideScalar(mt||1).multiplyScalar(Math.max(_,Math.min(ut,mt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(_){return this.x*_.x+this.y*_.y}cross(_){return this.x*_.y-this.y*_.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const ut=this.x-_.x,mt=this.y-_.y;return ut*ut+mt*mt}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,ut){return this.x+=(_.x-this.x)*ut,this.y+=(_.y-this.y)*ut,this}lerpVectors(_,ut,mt){return this.x=_.x+(ut.x-_.x)*mt,this.y=_.y+(ut.y-_.y)*mt,this}equals(_){return _.x===this.x&&_.y===this.y}fromArray(_,ut=0){return this.x=_[ut],this.y=_[ut+1],this}toArray(_=[],ut=0){return _[ut]=this.x,_[ut+1]=this.y,_}fromBufferAttribute(_,ut){return this.x=_.getX(ut),this.y=_.getY(ut),this}rotateAround(_,ut){const mt=Math.cos(ut),bt=Math.sin(ut),St=this.x-_.x,Mt=this.y-_.y;return this.x=St*mt-Mt*bt+_.x,this.y=St*bt+Mt*mt+_.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(_,ut,mt,bt,St,Mt,Bt,Ut,Ht){const tr=this.elements;return tr[0]=_,tr[1]=bt,tr[2]=Bt,tr[3]=ut,tr[4]=St,tr[5]=Ut,tr[6]=mt,tr[7]=Mt,tr[8]=Ht,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(_){const ut=this.elements,mt=_.elements;return ut[0]=mt[0],ut[1]=mt[1],ut[2]=mt[2],ut[3]=mt[3],ut[4]=mt[4],ut[5]=mt[5],ut[6]=mt[6],ut[7]=mt[7],ut[8]=mt[8],this}extractBasis(_,ut,mt){return _.setFromMatrix3Column(this,0),ut.setFromMatrix3Column(this,1),mt.setFromMatrix3Column(this,2),this}setFromMatrix4(_){const ut=_.elements;return this.set(ut[0],ut[4],ut[8],ut[1],ut[5],ut[9],ut[2],ut[6],ut[10]),this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,ut){const mt=_.elements,bt=ut.elements,St=this.elements,Mt=mt[0],Bt=mt[3],Ut=mt[6],Ht=mt[1],tr=mt[4],rr=mt[7],sr=mt[2],ar=mt[5],cr=mt[8],Ar=bt[0],_r=bt[3],Dr=bt[6],$r=bt[1],Br=bt[4],Jr=bt[7],mn=bt[2],Mn=bt[5],$n=bt[8];return St[0]=Mt*Ar+Bt*$r+Ut*mn,St[3]=Mt*_r+Bt*Br+Ut*Mn,St[6]=Mt*Dr+Bt*Jr+Ut*$n,St[1]=Ht*Ar+tr*$r+rr*mn,St[4]=Ht*_r+tr*Br+rr*Mn,St[7]=Ht*Dr+tr*Jr+rr*$n,St[2]=sr*Ar+ar*$r+cr*mn,St[5]=sr*_r+ar*Br+cr*Mn,St[8]=sr*Dr+ar*Jr+cr*$n,this}multiplyScalar(_){const ut=this.elements;return ut[0]*=_,ut[3]*=_,ut[6]*=_,ut[1]*=_,ut[4]*=_,ut[7]*=_,ut[2]*=_,ut[5]*=_,ut[8]*=_,this}determinant(){const _=this.elements,ut=_[0],mt=_[1],bt=_[2],St=_[3],Mt=_[4],Bt=_[5],Ut=_[6],Ht=_[7],tr=_[8];return ut*Mt*tr-ut*Bt*Ht-mt*St*tr+mt*Bt*Ut+bt*St*Ht-bt*Mt*Ut}invert(){const _=this.elements,ut=_[0],mt=_[1],bt=_[2],St=_[3],Mt=_[4],Bt=_[5],Ut=_[6],Ht=_[7],tr=_[8],rr=tr*Mt-Bt*Ht,sr=Bt*Ut-tr*St,ar=Ht*St-Mt*Ut,cr=ut*rr+mt*sr+bt*ar;if(cr===0)return this.set(0,0,0,0,0,0,0,0,0);const Ar=1/cr;return _[0]=rr*Ar,_[1]=(bt*Ht-tr*mt)*Ar,_[2]=(Bt*mt-bt*Mt)*Ar,_[3]=sr*Ar,_[4]=(tr*ut-bt*Ut)*Ar,_[5]=(bt*St-Bt*ut)*Ar,_[6]=ar*Ar,_[7]=(mt*Ut-Ht*ut)*Ar,_[8]=(Mt*ut-mt*St)*Ar,this}transpose(){let _;const ut=this.elements;return _=ut[1],ut[1]=ut[3],ut[3]=_,_=ut[2],ut[2]=ut[6],ut[6]=_,_=ut[5],ut[5]=ut[7],ut[7]=_,this}getNormalMatrix(_){return this.setFromMatrix4(_).invert().transpose()}transposeIntoArray(_){const ut=this.elements;return _[0]=ut[0],_[1]=ut[3],_[2]=ut[6],_[3]=ut[1],_[4]=ut[4],_[5]=ut[7],_[6]=ut[2],_[7]=ut[5],_[8]=ut[8],this}setUvTransform(_,ut,mt,bt,St,Mt,Bt){const Ut=Math.cos(St),Ht=Math.sin(St);return this.set(mt*Ut,mt*Ht,-mt*(Ut*Mt+Ht*Bt)+Mt+_,-bt*Ht,bt*Ut,-bt*(-Ht*Mt+Ut*Bt)+Bt+ut,0,0,1),this}scale(_,ut){return this.premultiply(_m3.makeScale(_,ut)),this}rotate(_){return this.premultiply(_m3.makeRotation(-_)),this}translate(_,ut){return this.premultiply(_m3.makeTranslation(_,ut)),this}makeTranslation(_,ut){return this.set(1,0,_,0,1,ut,0,0,1),this}makeRotation(_){const ut=Math.cos(_),mt=Math.sin(_);return this.set(ut,-mt,0,mt,ut,0,0,0,1),this}makeScale(_,ut){return this.set(_,0,0,0,ut,0,0,0,1),this}equals(_){const ut=this.elements,mt=_.elements;for(let bt=0;bt<9;bt++)if(ut[bt]!==mt[bt])return!1;return!0}fromArray(_,ut=0){for(let mt=0;mt<9;mt++)this.elements[mt]=_[mt+ut];return this}toArray(_=[],ut=0){const mt=this.elements;return _[ut]=mt[0],_[ut+1]=mt[1],_[ut+2]=mt[2],_[ut+3]=mt[3],_[ut+4]=mt[4],_[ut+5]=mt[5],_[ut+6]=mt[6],_[ut+7]=mt[7],_[ut+8]=mt[8],_}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(rt){for(let _=rt.length-1;_>=0;--_)if(rt[_]>=65535)return!0;return!1}const TYPED_ARRAYS={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function getTypedArray(rt,_){return new TYPED_ARRAYS[rt](_)}function createElementNS(rt){return document.createElementNS("http://www.w3.org/1999/xhtml",rt)}class Quaternion{constructor(_=0,ut=0,mt=0,bt=1){this.isQuaternion=!0,this._x=_,this._y=ut,this._z=mt,this._w=bt}static slerpFlat(_,ut,mt,bt,St,Mt,Bt){let Ut=mt[bt+0],Ht=mt[bt+1],tr=mt[bt+2],rr=mt[bt+3];const sr=St[Mt+0],ar=St[Mt+1],cr=St[Mt+2],Ar=St[Mt+3];if(Bt===0){_[ut+0]=Ut,_[ut+1]=Ht,_[ut+2]=tr,_[ut+3]=rr;return}if(Bt===1){_[ut+0]=sr,_[ut+1]=ar,_[ut+2]=cr,_[ut+3]=Ar;return}if(rr!==Ar||Ut!==sr||Ht!==ar||tr!==cr){let _r=1-Bt;const Dr=Ut*sr+Ht*ar+tr*cr+rr*Ar,$r=Dr>=0?1:-1,Br=1-Dr*Dr;if(Br>Number.EPSILON){const mn=Math.sqrt(Br),Mn=Math.atan2(mn,Dr*$r);_r=Math.sin(_r*Mn)/mn,Bt=Math.sin(Bt*Mn)/mn}const Jr=Bt*$r;if(Ut=Ut*_r+sr*Jr,Ht=Ht*_r+ar*Jr,tr=tr*_r+cr*Jr,rr=rr*_r+Ar*Jr,_r===1-Bt){const mn=1/Math.sqrt(Ut*Ut+Ht*Ht+tr*tr+rr*rr);Ut*=mn,Ht*=mn,tr*=mn,rr*=mn}}_[ut]=Ut,_[ut+1]=Ht,_[ut+2]=tr,_[ut+3]=rr}static multiplyQuaternionsFlat(_,ut,mt,bt,St,Mt){const Bt=mt[bt],Ut=mt[bt+1],Ht=mt[bt+2],tr=mt[bt+3],rr=St[Mt],sr=St[Mt+1],ar=St[Mt+2],cr=St[Mt+3];return _[ut]=Bt*cr+tr*rr+Ut*ar-Ht*sr,_[ut+1]=Ut*cr+tr*sr+Ht*rr-Bt*ar,_[ut+2]=Ht*cr+tr*ar+Bt*sr-Ut*rr,_[ut+3]=tr*cr-Bt*rr-Ut*sr-Ht*ar,_}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get w(){return this._w}set w(_){this._w=_,this._onChangeCallback()}set(_,ut,mt,bt){return this._x=_,this._y=ut,this._z=mt,this._w=bt,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(_){return this._x=_.x,this._y=_.y,this._z=_.z,this._w=_.w,this._onChangeCallback(),this}setFromEuler(_,ut){const mt=_._x,bt=_._y,St=_._z,Mt=_._order,Bt=Math.cos,Ut=Math.sin,Ht=Bt(mt/2),tr=Bt(bt/2),rr=Bt(St/2),sr=Ut(mt/2),ar=Ut(bt/2),cr=Ut(St/2);switch(Mt){case"XYZ":this._x=sr*tr*rr+Ht*ar*cr,this._y=Ht*ar*rr-sr*tr*cr,this._z=Ht*tr*cr+sr*ar*rr,this._w=Ht*tr*rr-sr*ar*cr;break;case"YXZ":this._x=sr*tr*rr+Ht*ar*cr,this._y=Ht*ar*rr-sr*tr*cr,this._z=Ht*tr*cr-sr*ar*rr,this._w=Ht*tr*rr+sr*ar*cr;break;case"ZXY":this._x=sr*tr*rr-Ht*ar*cr,this._y=Ht*ar*rr+sr*tr*cr,this._z=Ht*tr*cr+sr*ar*rr,this._w=Ht*tr*rr-sr*ar*cr;break;case"ZYX":this._x=sr*tr*rr-Ht*ar*cr,this._y=Ht*ar*rr+sr*tr*cr,this._z=Ht*tr*cr-sr*ar*rr,this._w=Ht*tr*rr+sr*ar*cr;break;case"YZX":this._x=sr*tr*rr+Ht*ar*cr,this._y=Ht*ar*rr+sr*tr*cr,this._z=Ht*tr*cr-sr*ar*rr,this._w=Ht*tr*rr-sr*ar*cr;break;case"XZY":this._x=sr*tr*rr-Ht*ar*cr,this._y=Ht*ar*rr-sr*tr*cr,this._z=Ht*tr*cr+sr*ar*rr,this._w=Ht*tr*rr+sr*ar*cr;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+Mt)}return ut!==!1&&this._onChangeCallback(),this}setFromAxisAngle(_,ut){const mt=ut/2,bt=Math.sin(mt);return this._x=_.x*bt,this._y=_.y*bt,this._z=_.z*bt,this._w=Math.cos(mt),this._onChangeCallback(),this}setFromRotationMatrix(_){const ut=_.elements,mt=ut[0],bt=ut[4],St=ut[8],Mt=ut[1],Bt=ut[5],Ut=ut[9],Ht=ut[2],tr=ut[6],rr=ut[10],sr=mt+Bt+rr;if(sr>0){const ar=.5/Math.sqrt(sr+1);this._w=.25/ar,this._x=(tr-Ut)*ar,this._y=(St-Ht)*ar,this._z=(Mt-bt)*ar}else if(mt>Bt&&mt>rr){const ar=2*Math.sqrt(1+mt-Bt-rr);this._w=(tr-Ut)/ar,this._x=.25*ar,this._y=(bt+Mt)/ar,this._z=(St+Ht)/ar}else if(Bt>rr){const ar=2*Math.sqrt(1+Bt-mt-rr);this._w=(St-Ht)/ar,this._x=(bt+Mt)/ar,this._y=.25*ar,this._z=(Ut+tr)/ar}else{const ar=2*Math.sqrt(1+rr-mt-Bt);this._w=(Mt-bt)/ar,this._x=(St+Ht)/ar,this._y=(Ut+tr)/ar,this._z=.25*ar}return this._onChangeCallback(),this}setFromUnitVectors(_,ut){let mt=_.dot(ut)+1;return mt<Number.EPSILON?(mt=0,Math.abs(_.x)>Math.abs(_.z)?(this._x=-_.y,this._y=_.x,this._z=0,this._w=mt):(this._x=0,this._y=-_.z,this._z=_.y,this._w=mt)):(this._x=_.y*ut.z-_.z*ut.y,this._y=_.z*ut.x-_.x*ut.z,this._z=_.x*ut.y-_.y*ut.x,this._w=mt),this.normalize()}angleTo(_){return 2*Math.acos(Math.abs(clamp$7(this.dot(_),-1,1)))}rotateTowards(_,ut){const mt=this.angleTo(_);if(mt===0)return this;const bt=Math.min(1,ut/mt);return this.slerp(_,bt),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(_){return this._x*_._x+this._y*_._y+this._z*_._z+this._w*_._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let _=this.length();return _===0?(this._x=0,this._y=0,this._z=0,this._w=1):(_=1/_,this._x=this._x*_,this._y=this._y*_,this._z=this._z*_,this._w=this._w*_),this._onChangeCallback(),this}multiply(_){return this.multiplyQuaternions(this,_)}premultiply(_){return this.multiplyQuaternions(_,this)}multiplyQuaternions(_,ut){const mt=_._x,bt=_._y,St=_._z,Mt=_._w,Bt=ut._x,Ut=ut._y,Ht=ut._z,tr=ut._w;return this._x=mt*tr+Mt*Bt+bt*Ht-St*Ut,this._y=bt*tr+Mt*Ut+St*Bt-mt*Ht,this._z=St*tr+Mt*Ht+mt*Ut-bt*Bt,this._w=Mt*tr-mt*Bt-bt*Ut-St*Ht,this._onChangeCallback(),this}slerp(_,ut){if(ut===0)return this;if(ut===1)return this.copy(_);const mt=this._x,bt=this._y,St=this._z,Mt=this._w;let Bt=Mt*_._w+mt*_._x+bt*_._y+St*_._z;if(Bt<0?(this._w=-_._w,this._x=-_._x,this._y=-_._y,this._z=-_._z,Bt=-Bt):this.copy(_),Bt>=1)return this._w=Mt,this._x=mt,this._y=bt,this._z=St,this;const Ut=1-Bt*Bt;if(Ut<=Number.EPSILON){const ar=1-ut;return this._w=ar*Mt+ut*this._w,this._x=ar*mt+ut*this._x,this._y=ar*bt+ut*this._y,this._z=ar*St+ut*this._z,this.normalize(),this._onChangeCallback(),this}const Ht=Math.sqrt(Ut),tr=Math.atan2(Ht,Bt),rr=Math.sin((1-ut)*tr)/Ht,sr=Math.sin(ut*tr)/Ht;return this._w=Mt*rr+this._w*sr,this._x=mt*rr+this._x*sr,this._y=bt*rr+this._y*sr,this._z=St*rr+this._z*sr,this._onChangeCallback(),this}slerpQuaternions(_,ut,mt){return this.copy(_).slerp(ut,mt)}random(){const _=Math.random(),ut=Math.sqrt(1-_),mt=Math.sqrt(_),bt=2*Math.PI*Math.random(),St=2*Math.PI*Math.random();return this.set(ut*Math.cos(bt),mt*Math.sin(St),mt*Math.cos(St),ut*Math.sin(bt))}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._w===this._w}fromArray(_,ut=0){return this._x=_[ut],this._y=_[ut+1],this._z=_[ut+2],this._w=_[ut+3],this._onChangeCallback(),this}toArray(_=[],ut=0){return _[ut]=this._x,_[ut+1]=this._y,_[ut+2]=this._z,_[ut+3]=this._w,_}fromBufferAttribute(_,ut){return this._x=_.getX(ut),this._y=_.getY(ut),this._z=_.getZ(ut),this._w=_.getW(ut),this}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(_=0,ut=0,mt=0){Vector3.prototype.isVector3=!0,this.x=_,this.y=ut,this.z=mt}set(_,ut,mt){return mt===void 0&&(mt=this.z),this.x=_,this.y=ut,this.z=mt,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setComponent(_,ut){switch(_){case 0:this.x=ut;break;case 1:this.y=ut;break;case 2:this.z=ut;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this}addVectors(_,ut){return this.x=_.x+ut.x,this.y=_.y+ut.y,this.z=_.z+ut.z,this}addScaledVector(_,ut){return this.x+=_.x*ut,this.y+=_.y*ut,this.z+=_.z*ut,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this}subVectors(_,ut){return this.x=_.x-ut.x,this.y=_.y-ut.y,this.z=_.z-ut.z,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this}multiplyVectors(_,ut){return this.x=_.x*ut.x,this.y=_.y*ut.y,this.z=_.z*ut.z,this}applyEuler(_){return this.applyQuaternion(_quaternion$4.setFromEuler(_))}applyAxisAngle(_,ut){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(_,ut))}applyMatrix3(_){const ut=this.x,mt=this.y,bt=this.z,St=_.elements;return this.x=St[0]*ut+St[3]*mt+St[6]*bt,this.y=St[1]*ut+St[4]*mt+St[7]*bt,this.z=St[2]*ut+St[5]*mt+St[8]*bt,this}applyNormalMatrix(_){return this.applyMatrix3(_).normalize()}applyMatrix4(_){const ut=this.x,mt=this.y,bt=this.z,St=_.elements,Mt=1/(St[3]*ut+St[7]*mt+St[11]*bt+St[15]);return this.x=(St[0]*ut+St[4]*mt+St[8]*bt+St[12])*Mt,this.y=(St[1]*ut+St[5]*mt+St[9]*bt+St[13])*Mt,this.z=(St[2]*ut+St[6]*mt+St[10]*bt+St[14])*Mt,this}applyQuaternion(_){const ut=this.x,mt=this.y,bt=this.z,St=_.x,Mt=_.y,Bt=_.z,Ut=_.w,Ht=Ut*ut+Mt*bt-Bt*mt,tr=Ut*mt+Bt*ut-St*bt,rr=Ut*bt+St*mt-Mt*ut,sr=-St*ut-Mt*mt-Bt*bt;return this.x=Ht*Ut+sr*-St+tr*-Bt-rr*-Mt,this.y=tr*Ut+sr*-Mt+rr*-St-Ht*-Bt,this.z=rr*Ut+sr*-Bt+Ht*-Mt-tr*-St,this}project(_){return this.applyMatrix4(_.matrixWorldInverse).applyMatrix4(_.projectionMatrix)}unproject(_){return this.applyMatrix4(_.projectionMatrixInverse).applyMatrix4(_.matrixWorld)}transformDirection(_){const ut=this.x,mt=this.y,bt=this.z,St=_.elements;return this.x=St[0]*ut+St[4]*mt+St[8]*bt,this.y=St[1]*ut+St[5]*mt+St[9]*bt,this.z=St[2]*ut+St[6]*mt+St[10]*bt,this.normalize()}divide(_){return this.x/=_.x,this.y/=_.y,this.z/=_.z,this}divideScalar(_){return this.multiplyScalar(1/_)}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this}clamp(_,ut){return this.x=Math.max(_.x,Math.min(ut.x,this.x)),this.y=Math.max(_.y,Math.min(ut.y,this.y)),this.z=Math.max(_.z,Math.min(ut.z,this.z)),this}clampScalar(_,ut){return this.x=Math.max(_,Math.min(ut,this.x)),this.y=Math.max(_,Math.min(ut,this.y)),this.z=Math.max(_,Math.min(ut,this.z)),this}clampLength(_,ut){const mt=this.length();return this.divideScalar(mt||1).multiplyScalar(Math.max(_,Math.min(ut,mt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,ut){return this.x+=(_.x-this.x)*ut,this.y+=(_.y-this.y)*ut,this.z+=(_.z-this.z)*ut,this}lerpVectors(_,ut,mt){return this.x=_.x+(ut.x-_.x)*mt,this.y=_.y+(ut.y-_.y)*mt,this.z=_.z+(ut.z-_.z)*mt,this}cross(_){return this.crossVectors(this,_)}crossVectors(_,ut){const mt=_.x,bt=_.y,St=_.z,Mt=ut.x,Bt=ut.y,Ut=ut.z;return this.x=bt*Ut-St*Bt,this.y=St*Mt-mt*Ut,this.z=mt*Bt-bt*Mt,this}projectOnVector(_){const ut=_.lengthSq();if(ut===0)return this.set(0,0,0);const mt=_.dot(this)/ut;return this.copy(_).multiplyScalar(mt)}projectOnPlane(_){return _vector$d.copy(this).projectOnVector(_),this.sub(_vector$d)}reflect(_){return this.sub(_vector$d.copy(_).multiplyScalar(2*this.dot(_)))}angleTo(_){const ut=Math.sqrt(this.lengthSq()*_.lengthSq());if(ut===0)return Math.PI/2;const mt=this.dot(_)/ut;return Math.acos(clamp$7(mt,-1,1))}distanceTo(_){return Math.sqrt(this.distanceToSquared(_))}distanceToSquared(_){const ut=this.x-_.x,mt=this.y-_.y,bt=this.z-_.z;return ut*ut+mt*mt+bt*bt}manhattanDistanceTo(_){return Math.abs(this.x-_.x)+Math.abs(this.y-_.y)+Math.abs(this.z-_.z)}setFromSpherical(_){return this.setFromSphericalCoords(_.radius,_.phi,_.theta)}setFromSphericalCoords(_,ut,mt){const bt=Math.sin(ut)*_;return this.x=bt*Math.sin(mt),this.y=Math.cos(ut)*_,this.z=bt*Math.cos(mt),this}setFromCylindrical(_){return this.setFromCylindricalCoords(_.radius,_.theta,_.y)}setFromCylindricalCoords(_,ut,mt){return this.x=_*Math.sin(ut),this.y=mt,this.z=_*Math.cos(ut),this}setFromMatrixPosition(_){const ut=_.elements;return this.x=ut[12],this.y=ut[13],this.z=ut[14],this}setFromMatrixScale(_){const ut=this.setFromMatrixColumn(_,0).length(),mt=this.setFromMatrixColumn(_,1).length(),bt=this.setFromMatrixColumn(_,2).length();return this.x=ut,this.y=mt,this.z=bt,this}setFromMatrixColumn(_,ut){return this.fromArray(_.elements,ut*4)}setFromMatrix3Column(_,ut){return this.fromArray(_.elements,ut*3)}setFromEuler(_){return this.x=_._x,this.y=_._y,this.z=_._z,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z}fromArray(_,ut=0){return this.x=_[ut],this.y=_[ut+1],this.z=_[ut+2],this}toArray(_=[],ut=0){return _[ut]=this.x,_[ut+1]=this.y,_[ut+2]=this.z,_}fromBufferAttribute(_,ut){return this.x=_.getX(ut),this.y=_.getY(ut),this.z=_.getZ(ut),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const _=(Math.random()-.5)*2,ut=Math.random()*Math.PI*2,mt=Math.sqrt(1-_**2);return this.x=mt*Math.cos(ut),this.y=mt*Math.sin(ut),this.z=_,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$d=new Vector3,_quaternion$4=new Quaternion;function SRGBToLinear(rt){return rt<.04045?rt*.0773993808:Math.pow(rt*.9478672986+.0521327014,2.4)}function LinearToSRGB(rt){return rt<.0031308?rt*12.92:1.055*Math.pow(rt,.41666)-.055}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),_vector$c=new Vector3;function DisplayP3ToLinearSRGB(rt){return rt.convertSRGBToLinear(),_vector$c.set(rt.r,rt.g,rt.b).applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),rt.setRGB(_vector$c.x,_vector$c.y,_vector$c.z)}function LinearSRGBToDisplayP3(rt){return _vector$c.set(rt.r,rt.g,rt.b).applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3),rt.setRGB(_vector$c.x,_vector$c.y,_vector$c.z).convertLinearToSRGB()}const TO_LINEAR={[LinearSRGBColorSpace]:rt=>rt,[SRGBColorSpace]:rt=>rt.convertSRGBToLinear(),[DisplayP3ColorSpace]:DisplayP3ToLinearSRGB},FROM_LINEAR={[LinearSRGBColorSpace]:rt=>rt,[SRGBColorSpace]:rt=>rt.convertLinearToSRGB(),[DisplayP3ColorSpace]:LinearSRGBToDisplayP3},ColorManagement={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(rt){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!rt},get workingColorSpace(){return LinearSRGBColorSpace},set workingColorSpace(rt){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(rt,_,ut){if(this.enabled===!1||_===ut||!_||!ut)return rt;const mt=TO_LINEAR[_],bt=FROM_LINEAR[ut];if(mt===void 0||bt===void 0)throw new Error(`Unsupported color space conversion, "${_}" to "${ut}".`);return bt(mt(rt))},fromWorkingColorSpace:function(rt,_){return this.convert(rt,this.workingColorSpace,_)},toWorkingColorSpace:function(rt,_){return this.convert(rt,_,this.workingColorSpace)}};let _canvas;class ImageUtils{static getDataURL(_){if(/^data:/i.test(_.src)||typeof HTMLCanvasElement>"u")return _.src;let ut;if(_ instanceof HTMLCanvasElement)ut=_;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=_.width,_canvas.height=_.height;const mt=_canvas.getContext("2d");_ instanceof ImageData?mt.putImageData(_,0,0):mt.drawImage(_,0,0,_.width,_.height),ut=_canvas}return ut.width>2048||ut.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",_),ut.toDataURL("image/jpeg",.6)):ut.toDataURL("image/png")}static sRGBToLinear(_){if(typeof HTMLImageElement<"u"&&_ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&_ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&_ instanceof ImageBitmap){const ut=createElementNS("canvas");ut.width=_.width,ut.height=_.height;const mt=ut.getContext("2d");mt.drawImage(_,0,0,_.width,_.height);const bt=mt.getImageData(0,0,_.width,_.height),St=bt.data;for(let Mt=0;Mt<St.length;Mt++)St[Mt]=SRGBToLinear(St[Mt]/255)*255;return mt.putImageData(bt,0,0),ut}else if(_.data){const ut=_.data.slice(0);for(let mt=0;mt<ut.length;mt++)ut instanceof Uint8Array||ut instanceof Uint8ClampedArray?ut[mt]=Math.floor(SRGBToLinear(ut[mt]/255)*255):ut[mt]=SRGBToLinear(ut[mt]);return{data:ut,width:_.width,height:_.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),_}}class Source{constructor(_=null){this.isSource=!0,this.uuid=generateUUID$1(),this.data=_,this.version=0}set needsUpdate(_){_===!0&&this.version++}toJSON(_){const ut=_===void 0||typeof _=="string";if(!ut&&_.images[this.uuid]!==void 0)return _.images[this.uuid];const mt={uuid:this.uuid,url:""},bt=this.data;if(bt!==null){let St;if(Array.isArray(bt)){St=[];for(let Mt=0,Bt=bt.length;Mt<Bt;Mt++)bt[Mt].isDataTexture?St.push(serializeImage(bt[Mt].image)):St.push(serializeImage(bt[Mt]))}else St=serializeImage(bt);mt.url=St}return ut||(_.images[this.uuid]=mt),mt}}function serializeImage(rt){return typeof HTMLImageElement<"u"&&rt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&rt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&rt instanceof ImageBitmap?ImageUtils.getDataURL(rt):rt.data?{data:Array.from(rt.data),width:rt.width,height:rt.height,type:rt.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let textureId=0;class Texture extends EventDispatcher{constructor(_=Texture.DEFAULT_IMAGE,ut=Texture.DEFAULT_MAPPING,mt=ClampToEdgeWrapping,bt=ClampToEdgeWrapping,St=LinearFilter,Mt=LinearMipmapLinearFilter,Bt=RGBAFormat,Ut=UnsignedByteType,Ht=Texture.DEFAULT_ANISOTROPY,tr=LinearEncoding$1){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:textureId++}),this.uuid=generateUUID$1(),this.name="",this.source=new Source(_),this.mipmaps=[],this.mapping=ut,this.wrapS=mt,this.wrapT=bt,this.magFilter=St,this.minFilter=Mt,this.anisotropy=Ht,this.format=Bt,this.internalFormat=null,this.type=Ut,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=tr,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(_=null){this.source.data=_}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(_){return this.name=_.name,this.source=_.source,this.mipmaps=_.mipmaps.slice(0),this.mapping=_.mapping,this.wrapS=_.wrapS,this.wrapT=_.wrapT,this.magFilter=_.magFilter,this.minFilter=_.minFilter,this.anisotropy=_.anisotropy,this.format=_.format,this.internalFormat=_.internalFormat,this.type=_.type,this.offset.copy(_.offset),this.repeat.copy(_.repeat),this.center.copy(_.center),this.rotation=_.rotation,this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrix.copy(_.matrix),this.generateMipmaps=_.generateMipmaps,this.premultiplyAlpha=_.premultiplyAlpha,this.flipY=_.flipY,this.unpackAlignment=_.unpackAlignment,this.encoding=_.encoding,this.userData=JSON.parse(JSON.stringify(_.userData)),this.needsUpdate=!0,this}toJSON(_){const ut=_===void 0||typeof _=="string";if(!ut&&_.textures[this.uuid]!==void 0)return _.textures[this.uuid];const mt={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(_).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(mt.userData=this.userData),ut||(_.textures[this.uuid]=mt),mt}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(_){if(this.mapping!==UVMapping)return _;if(_.applyMatrix3(this.matrix),_.x<0||_.x>1)switch(this.wrapS){case RepeatWrapping:_.x=_.x-Math.floor(_.x);break;case ClampToEdgeWrapping:_.x=_.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_.x)%2)===1?_.x=Math.ceil(_.x)-_.x:_.x=_.x-Math.floor(_.x);break}if(_.y<0||_.y>1)switch(this.wrapT){case RepeatWrapping:_.y=_.y-Math.floor(_.y);break;case ClampToEdgeWrapping:_.y=_.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(_.y)%2)===1?_.y=Math.ceil(_.y)-_.y:_.y=_.y-Math.floor(_.y);break}return this.flipY&&(_.y=1-_.y),_}set needsUpdate(_){_===!0&&(this.version++,this.source.needsUpdate=!0)}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(_=0,ut=0,mt=0,bt=1){Vector4.prototype.isVector4=!0,this.x=_,this.y=ut,this.z=mt,this.w=bt}get width(){return this.z}set width(_){this.z=_}get height(){return this.w}set height(_){this.w=_}set(_,ut,mt,bt){return this.x=_,this.y=ut,this.z=mt,this.w=bt,this}setScalar(_){return this.x=_,this.y=_,this.z=_,this.w=_,this}setX(_){return this.x=_,this}setY(_){return this.y=_,this}setZ(_){return this.z=_,this}setW(_){return this.w=_,this}setComponent(_,ut){switch(_){case 0:this.x=ut;break;case 1:this.y=ut;break;case 2:this.z=ut;break;case 3:this.w=ut;break;default:throw new Error("index is out of range: "+_)}return this}getComponent(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(_){return this.x=_.x,this.y=_.y,this.z=_.z,this.w=_.w!==void 0?_.w:1,this}add(_){return this.x+=_.x,this.y+=_.y,this.z+=_.z,this.w+=_.w,this}addScalar(_){return this.x+=_,this.y+=_,this.z+=_,this.w+=_,this}addVectors(_,ut){return this.x=_.x+ut.x,this.y=_.y+ut.y,this.z=_.z+ut.z,this.w=_.w+ut.w,this}addScaledVector(_,ut){return this.x+=_.x*ut,this.y+=_.y*ut,this.z+=_.z*ut,this.w+=_.w*ut,this}sub(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this.w-=_.w,this}subScalar(_){return this.x-=_,this.y-=_,this.z-=_,this.w-=_,this}subVectors(_,ut){return this.x=_.x-ut.x,this.y=_.y-ut.y,this.z=_.z-ut.z,this.w=_.w-ut.w,this}multiply(_){return this.x*=_.x,this.y*=_.y,this.z*=_.z,this.w*=_.w,this}multiplyScalar(_){return this.x*=_,this.y*=_,this.z*=_,this.w*=_,this}applyMatrix4(_){const ut=this.x,mt=this.y,bt=this.z,St=this.w,Mt=_.elements;return this.x=Mt[0]*ut+Mt[4]*mt+Mt[8]*bt+Mt[12]*St,this.y=Mt[1]*ut+Mt[5]*mt+Mt[9]*bt+Mt[13]*St,this.z=Mt[2]*ut+Mt[6]*mt+Mt[10]*bt+Mt[14]*St,this.w=Mt[3]*ut+Mt[7]*mt+Mt[11]*bt+Mt[15]*St,this}divideScalar(_){return this.multiplyScalar(1/_)}setAxisAngleFromQuaternion(_){this.w=2*Math.acos(_.w);const ut=Math.sqrt(1-_.w*_.w);return ut<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=_.x/ut,this.y=_.y/ut,this.z=_.z/ut),this}setAxisAngleFromRotationMatrix(_){let ut,mt,bt,St;const Ut=_.elements,Ht=Ut[0],tr=Ut[4],rr=Ut[8],sr=Ut[1],ar=Ut[5],cr=Ut[9],Ar=Ut[2],_r=Ut[6],Dr=Ut[10];if(Math.abs(tr-sr)<.01&&Math.abs(rr-Ar)<.01&&Math.abs(cr-_r)<.01){if(Math.abs(tr+sr)<.1&&Math.abs(rr+Ar)<.1&&Math.abs(cr+_r)<.1&&Math.abs(Ht+ar+Dr-3)<.1)return this.set(1,0,0,0),this;ut=Math.PI;const Br=(Ht+1)/2,Jr=(ar+1)/2,mn=(Dr+1)/2,Mn=(tr+sr)/4,$n=(rr+Ar)/4,en=(cr+_r)/4;return Br>Jr&&Br>mn?Br<.01?(mt=0,bt=.707106781,St=.707106781):(mt=Math.sqrt(Br),bt=Mn/mt,St=$n/mt):Jr>mn?Jr<.01?(mt=.707106781,bt=0,St=.707106781):(bt=Math.sqrt(Jr),mt=Mn/bt,St=en/bt):mn<.01?(mt=.707106781,bt=.707106781,St=0):(St=Math.sqrt(mn),mt=$n/St,bt=en/St),this.set(mt,bt,St,ut),this}let $r=Math.sqrt((_r-cr)*(_r-cr)+(rr-Ar)*(rr-Ar)+(sr-tr)*(sr-tr));return Math.abs($r)<.001&&($r=1),this.x=(_r-cr)/$r,this.y=(rr-Ar)/$r,this.z=(sr-tr)/$r,this.w=Math.acos((Ht+ar+Dr-1)/2),this}min(_){return this.x=Math.min(this.x,_.x),this.y=Math.min(this.y,_.y),this.z=Math.min(this.z,_.z),this.w=Math.min(this.w,_.w),this}max(_){return this.x=Math.max(this.x,_.x),this.y=Math.max(this.y,_.y),this.z=Math.max(this.z,_.z),this.w=Math.max(this.w,_.w),this}clamp(_,ut){return this.x=Math.max(_.x,Math.min(ut.x,this.x)),this.y=Math.max(_.y,Math.min(ut.y,this.y)),this.z=Math.max(_.z,Math.min(ut.z,this.z)),this.w=Math.max(_.w,Math.min(ut.w,this.w)),this}clampScalar(_,ut){return this.x=Math.max(_,Math.min(ut,this.x)),this.y=Math.max(_,Math.min(ut,this.y)),this.z=Math.max(_,Math.min(ut,this.z)),this.w=Math.max(_,Math.min(ut,this.w)),this}clampLength(_,ut){const mt=this.length();return this.divideScalar(mt||1).multiplyScalar(Math.max(_,Math.min(ut,mt)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(_){return this.x*_.x+this.y*_.y+this.z*_.z+this.w*_.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(_){return this.normalize().multiplyScalar(_)}lerp(_,ut){return this.x+=(_.x-this.x)*ut,this.y+=(_.y-this.y)*ut,this.z+=(_.z-this.z)*ut,this.w+=(_.w-this.w)*ut,this}lerpVectors(_,ut,mt){return this.x=_.x+(ut.x-_.x)*mt,this.y=_.y+(ut.y-_.y)*mt,this.z=_.z+(ut.z-_.z)*mt,this.w=_.w+(ut.w-_.w)*mt,this}equals(_){return _.x===this.x&&_.y===this.y&&_.z===this.z&&_.w===this.w}fromArray(_,ut=0){return this.x=_[ut],this.y=_[ut+1],this.z=_[ut+2],this.w=_[ut+3],this}toArray(_=[],ut=0){return _[ut]=this.x,_[ut+1]=this.y,_[ut+2]=this.z,_[ut+3]=this.w,_}fromBufferAttribute(_,ut){return this.x=_.getX(ut),this.y=_.getY(ut),this.z=_.getZ(ut),this.w=_.getW(ut),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class WebGLRenderTarget extends EventDispatcher{constructor(_=1,ut=1,mt={}){super(),this.isWebGLRenderTarget=!0,this.width=_,this.height=ut,this.depth=1,this.scissor=new Vector4(0,0,_,ut),this.scissorTest=!1,this.viewport=new Vector4(0,0,_,ut);const bt={width:_,height:ut,depth:1};this.texture=new Texture(bt,mt.mapping,mt.wrapS,mt.wrapT,mt.magFilter,mt.minFilter,mt.format,mt.type,mt.anisotropy,mt.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=mt.generateMipmaps!==void 0?mt.generateMipmaps:!1,this.texture.internalFormat=mt.internalFormat!==void 0?mt.internalFormat:null,this.texture.minFilter=mt.minFilter!==void 0?mt.minFilter:LinearFilter,this.depthBuffer=mt.depthBuffer!==void 0?mt.depthBuffer:!0,this.stencilBuffer=mt.stencilBuffer!==void 0?mt.stencilBuffer:!1,this.depthTexture=mt.depthTexture!==void 0?mt.depthTexture:null,this.samples=mt.samples!==void 0?mt.samples:0}setSize(_,ut,mt=1){(this.width!==_||this.height!==ut||this.depth!==mt)&&(this.width=_,this.height=ut,this.depth=mt,this.texture.image.width=_,this.texture.image.height=ut,this.texture.image.depth=mt,this.dispose()),this.viewport.set(0,0,_,ut),this.scissor.set(0,0,_,ut)}clone(){return new this.constructor().copy(this)}copy(_){this.width=_.width,this.height=_.height,this.depth=_.depth,this.viewport.copy(_.viewport),this.texture=_.texture.clone(),this.texture.isRenderTargetTexture=!0;const ut=Object.assign({},_.texture.image);return this.texture.source=new Source(ut),this.depthBuffer=_.depthBuffer,this.stencilBuffer=_.stencilBuffer,_.depthTexture!==null&&(this.depthTexture=_.depthTexture.clone()),this.samples=_.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class DataArrayTexture extends Texture{constructor(_=null,ut=1,mt=1,bt=1){super(null),this.isDataArrayTexture=!0,this.image={data:_,width:ut,height:mt,depth:bt},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGLArrayRenderTarget extends WebGLRenderTarget{constructor(_=1,ut=1,mt=1){super(_,ut),this.isWebGLArrayRenderTarget=!0,this.depth=mt,this.texture=new DataArrayTexture(null,_,ut,mt),this.texture.isRenderTargetTexture=!0}}class Data3DTexture extends Texture{constructor(_=null,ut=1,mt=1,bt=1){super(null),this.isData3DTexture=!0,this.image={data:_,width:ut,height:mt,depth:bt},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class WebGL3DRenderTarget extends WebGLRenderTarget{constructor(_=1,ut=1,mt=1){super(_,ut),this.isWebGL3DRenderTarget=!0,this.depth=mt,this.texture=new Data3DTexture(null,_,ut,mt),this.texture.isRenderTargetTexture=!0}}class WebGLMultipleRenderTargets extends WebGLRenderTarget{constructor(_=1,ut=1,mt=1,bt={}){super(_,ut,bt),this.isWebGLMultipleRenderTargets=!0;const St=this.texture;this.texture=[];for(let Mt=0;Mt<mt;Mt++)this.texture[Mt]=St.clone(),this.texture[Mt].isRenderTargetTexture=!0}setSize(_,ut,mt=1){if(this.width!==_||this.height!==ut||this.depth!==mt){this.width=_,this.height=ut,this.depth=mt;for(let bt=0,St=this.texture.length;bt<St;bt++)this.texture[bt].image.width=_,this.texture[bt].image.height=ut,this.texture[bt].image.depth=mt;this.dispose()}return this.viewport.set(0,0,_,ut),this.scissor.set(0,0,_,ut),this}copy(_){this.dispose(),this.width=_.width,this.height=_.height,this.depth=_.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=_.depthBuffer,this.stencilBuffer=_.stencilBuffer,_.depthTexture!==null&&(this.depthTexture=_.depthTexture.clone()),this.texture.length=0;for(let ut=0,mt=_.texture.length;ut<mt;ut++)this.texture[ut]=_.texture[ut].clone(),this.texture[ut].isRenderTargetTexture=!0;return this}}class Box3{constructor(_=new Vector3(1/0,1/0,1/0),ut=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=_,this.max=ut}set(_,ut){return this.min.copy(_),this.max.copy(ut),this}setFromArray(_){let ut=1/0,mt=1/0,bt=1/0,St=-1/0,Mt=-1/0,Bt=-1/0;for(let Ut=0,Ht=_.length;Ut<Ht;Ut+=3){const tr=_[Ut],rr=_[Ut+1],sr=_[Ut+2];tr<ut&&(ut=tr),rr<mt&&(mt=rr),sr<bt&&(bt=sr),tr>St&&(St=tr),rr>Mt&&(Mt=rr),sr>Bt&&(Bt=sr)}return this.min.set(ut,mt,bt),this.max.set(St,Mt,Bt),this}setFromBufferAttribute(_){let ut=1/0,mt=1/0,bt=1/0,St=-1/0,Mt=-1/0,Bt=-1/0;for(let Ut=0,Ht=_.count;Ut<Ht;Ut++){const tr=_.getX(Ut),rr=_.getY(Ut),sr=_.getZ(Ut);tr<ut&&(ut=tr),rr<mt&&(mt=rr),sr<bt&&(bt=sr),tr>St&&(St=tr),rr>Mt&&(Mt=rr),sr>Bt&&(Bt=sr)}return this.min.set(ut,mt,bt),this.max.set(St,Mt,Bt),this}setFromPoints(_){this.makeEmpty();for(let ut=0,mt=_.length;ut<mt;ut++)this.expandByPoint(_[ut]);return this}setFromCenterAndSize(_,ut){const mt=_vector$b.copy(ut).multiplyScalar(.5);return this.min.copy(_).sub(mt),this.max.copy(_).add(mt),this}setFromObject(_,ut=!1){return this.makeEmpty(),this.expandByObject(_,ut)}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(_){return this.isEmpty()?_.set(0,0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}expandByObject(_,ut=!1){_.updateWorldMatrix(!1,!1);const mt=_.geometry;if(mt!==void 0)if(ut&&mt.attributes!=null&&mt.attributes.position!==void 0){const St=mt.attributes.position;for(let Mt=0,Bt=St.count;Mt<Bt;Mt++)_vector$b.fromBufferAttribute(St,Mt).applyMatrix4(_.matrixWorld),this.expandByPoint(_vector$b)}else mt.boundingBox===null&&mt.computeBoundingBox(),_box$3.copy(mt.boundingBox),_box$3.applyMatrix4(_.matrixWorld),this.union(_box$3);const bt=_.children;for(let St=0,Mt=bt.length;St<Mt;St++)this.expandByObject(bt[St],ut);return this}containsPoint(_){return!(_.x<this.min.x||_.x>this.max.x||_.y<this.min.y||_.y>this.max.y||_.z<this.min.z||_.z>this.max.z)}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y&&this.min.z<=_.min.z&&_.max.z<=this.max.z}getParameter(_,ut){return ut.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y),(_.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(_){return!(_.max.x<this.min.x||_.min.x>this.max.x||_.max.y<this.min.y||_.min.y>this.max.y||_.max.z<this.min.z||_.min.z>this.max.z)}intersectsSphere(_){return this.clampPoint(_.center,_vector$b),_vector$b.distanceToSquared(_.center)<=_.radius*_.radius}intersectsPlane(_){let ut,mt;return _.normal.x>0?(ut=_.normal.x*this.min.x,mt=_.normal.x*this.max.x):(ut=_.normal.x*this.max.x,mt=_.normal.x*this.min.x),_.normal.y>0?(ut+=_.normal.y*this.min.y,mt+=_.normal.y*this.max.y):(ut+=_.normal.y*this.max.y,mt+=_.normal.y*this.min.y),_.normal.z>0?(ut+=_.normal.z*this.min.z,mt+=_.normal.z*this.max.z):(ut+=_.normal.z*this.max.z,mt+=_.normal.z*this.min.z),ut<=-_.constant&&mt>=-_.constant}intersectsTriangle(_){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(_.a,_center),_v1$7.subVectors(_.b,_center),_v2$4.subVectors(_.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let ut=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(ut,_v0$2,_v1$7,_v2$4,_extents)||(ut=[1,0,0,0,1,0,0,0,1],!satForAxes(ut,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),ut=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(ut,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(_,ut){return ut.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return this.clampPoint(_,_vector$b).distanceTo(_)}getBoundingSphere(_){return this.isEmpty()?_.makeEmpty():(this.getCenter(_.center),_.radius=this.getSize(_vector$b).length()*.5),_}intersect(_){return this.min.max(_.min),this.max.min(_.max),this.isEmpty()&&this.makeEmpty(),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}applyMatrix4(_){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(_),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(_),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(_),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(_),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(_),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(_),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(_),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(_),this.setFromPoints(_points),this)}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$b=new Vector3,_box$3=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(rt,_,ut,mt,bt){for(let St=0,Mt=rt.length-3;St<=Mt;St+=3){_testAxis.fromArray(rt,St);const Bt=bt.x*Math.abs(_testAxis.x)+bt.y*Math.abs(_testAxis.y)+bt.z*Math.abs(_testAxis.z),Ut=_.dot(_testAxis),Ht=ut.dot(_testAxis),tr=mt.dot(_testAxis);if(Math.max(-Math.max(Ut,Ht,tr),Math.min(Ut,Ht,tr))>Bt)return!1}return!0}const _box$2=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;let Sphere$1=class{constructor(_=new Vector3,ut=-1){this.center=_,this.radius=ut}set(_,ut){return this.center.copy(_),this.radius=ut,this}setFromPoints(_,ut){const mt=this.center;ut!==void 0?mt.copy(ut):_box$2.setFromPoints(_).getCenter(mt);let bt=0;for(let St=0,Mt=_.length;St<Mt;St++)bt=Math.max(bt,mt.distanceToSquared(_[St]));return this.radius=Math.sqrt(bt),this}copy(_){return this.center.copy(_.center),this.radius=_.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(_){return _.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(_){return _.distanceTo(this.center)-this.radius}intersectsSphere(_){const ut=this.radius+_.radius;return _.center.distanceToSquared(this.center)<=ut*ut}intersectsBox(_){return _.intersectsSphere(this)}intersectsPlane(_){return Math.abs(_.distanceToPoint(this.center))<=this.radius}clampPoint(_,ut){const mt=this.center.distanceToSquared(_);return ut.copy(_),mt>this.radius*this.radius&&(ut.sub(this.center).normalize(),ut.multiplyScalar(this.radius).add(this.center)),ut}getBoundingBox(_){return this.isEmpty()?(_.makeEmpty(),_):(_.set(this.center,this.center),_.expandByScalar(this.radius),_)}applyMatrix4(_){return this.center.applyMatrix4(_),this.radius=this.radius*_.getMaxScaleOnAxis(),this}translate(_){return this.center.add(_),this}expandByPoint(_){if(this.isEmpty())return this.center.copy(_),this.radius=0,this;_v1$6.subVectors(_,this.center);const ut=_v1$6.lengthSq();if(ut>this.radius*this.radius){const mt=Math.sqrt(ut),bt=(mt-this.radius)*.5;this.center.addScaledVector(_v1$6,bt/mt),this.radius+=bt}return this}union(_){return _.isEmpty()?this:this.isEmpty()?(this.copy(_),this):(this.center.equals(_.center)===!0?this.radius=Math.max(this.radius,_.radius):(_v2$3.subVectors(_.center,this.center).setLength(_.radius),this.expandByPoint(_v1$6.copy(_.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(_.center).sub(_v2$3))),this)}equals(_){return _.center.equals(this.center)&&_.radius===this.radius}clone(){return new this.constructor().copy(this)}};const _vector$a=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(_=new Vector3,ut=new Vector3(0,0,-1)){this.origin=_,this.direction=ut}set(_,ut){return this.origin.copy(_),this.direction.copy(ut),this}copy(_){return this.origin.copy(_.origin),this.direction.copy(_.direction),this}at(_,ut){return ut.copy(this.origin).addScaledVector(this.direction,_)}lookAt(_){return this.direction.copy(_).sub(this.origin).normalize(),this}recast(_){return this.origin.copy(this.at(_,_vector$a)),this}closestPointToPoint(_,ut){ut.subVectors(_,this.origin);const mt=ut.dot(this.direction);return mt<0?ut.copy(this.origin):ut.copy(this.origin).addScaledVector(this.direction,mt)}distanceToPoint(_){return Math.sqrt(this.distanceSqToPoint(_))}distanceSqToPoint(_){const ut=_vector$a.subVectors(_,this.origin).dot(this.direction);return ut<0?this.origin.distanceToSquared(_):(_vector$a.copy(this.origin).addScaledVector(this.direction,ut),_vector$a.distanceToSquared(_))}distanceSqToSegment(_,ut,mt,bt){_segCenter.copy(_).add(ut).multiplyScalar(.5),_segDir.copy(ut).sub(_).normalize(),_diff.copy(this.origin).sub(_segCenter);const St=_.distanceTo(ut)*.5,Mt=-this.direction.dot(_segDir),Bt=_diff.dot(this.direction),Ut=-_diff.dot(_segDir),Ht=_diff.lengthSq(),tr=Math.abs(1-Mt*Mt);let rr,sr,ar,cr;if(tr>0)if(rr=Mt*Ut-Bt,sr=Mt*Bt-Ut,cr=St*tr,rr>=0)if(sr>=-cr)if(sr<=cr){const Ar=1/tr;rr*=Ar,sr*=Ar,ar=rr*(rr+Mt*sr+2*Bt)+sr*(Mt*rr+sr+2*Ut)+Ht}else sr=St,rr=Math.max(0,-(Mt*sr+Bt)),ar=-rr*rr+sr*(sr+2*Ut)+Ht;else sr=-St,rr=Math.max(0,-(Mt*sr+Bt)),ar=-rr*rr+sr*(sr+2*Ut)+Ht;else sr<=-cr?(rr=Math.max(0,-(-Mt*St+Bt)),sr=rr>0?-St:Math.min(Math.max(-St,-Ut),St),ar=-rr*rr+sr*(sr+2*Ut)+Ht):sr<=cr?(rr=0,sr=Math.min(Math.max(-St,-Ut),St),ar=sr*(sr+2*Ut)+Ht):(rr=Math.max(0,-(Mt*St+Bt)),sr=rr>0?St:Math.min(Math.max(-St,-Ut),St),ar=-rr*rr+sr*(sr+2*Ut)+Ht);else sr=Mt>0?-St:St,rr=Math.max(0,-(Mt*sr+Bt)),ar=-rr*rr+sr*(sr+2*Ut)+Ht;return mt&&mt.copy(this.origin).addScaledVector(this.direction,rr),bt&&bt.copy(_segCenter).addScaledVector(_segDir,sr),ar}intersectSphere(_,ut){_vector$a.subVectors(_.center,this.origin);const mt=_vector$a.dot(this.direction),bt=_vector$a.dot(_vector$a)-mt*mt,St=_.radius*_.radius;if(bt>St)return null;const Mt=Math.sqrt(St-bt),Bt=mt-Mt,Ut=mt+Mt;return Ut<0?null:Bt<0?this.at(Ut,ut):this.at(Bt,ut)}intersectsSphere(_){return this.distanceSqToPoint(_.center)<=_.radius*_.radius}distanceToPlane(_){const ut=_.normal.dot(this.direction);if(ut===0)return _.distanceToPoint(this.origin)===0?0:null;const mt=-(this.origin.dot(_.normal)+_.constant)/ut;return mt>=0?mt:null}intersectPlane(_,ut){const mt=this.distanceToPlane(_);return mt===null?null:this.at(mt,ut)}intersectsPlane(_){const ut=_.distanceToPoint(this.origin);return ut===0||_.normal.dot(this.direction)*ut<0}intersectBox(_,ut){let mt,bt,St,Mt,Bt,Ut;const Ht=1/this.direction.x,tr=1/this.direction.y,rr=1/this.direction.z,sr=this.origin;return Ht>=0?(mt=(_.min.x-sr.x)*Ht,bt=(_.max.x-sr.x)*Ht):(mt=(_.max.x-sr.x)*Ht,bt=(_.min.x-sr.x)*Ht),tr>=0?(St=(_.min.y-sr.y)*tr,Mt=(_.max.y-sr.y)*tr):(St=(_.max.y-sr.y)*tr,Mt=(_.min.y-sr.y)*tr),mt>Mt||St>bt||((St>mt||isNaN(mt))&&(mt=St),(Mt<bt||isNaN(bt))&&(bt=Mt),rr>=0?(Bt=(_.min.z-sr.z)*rr,Ut=(_.max.z-sr.z)*rr):(Bt=(_.max.z-sr.z)*rr,Ut=(_.min.z-sr.z)*rr),mt>Ut||Bt>bt)||((Bt>mt||mt!==mt)&&(mt=Bt),(Ut<bt||bt!==bt)&&(bt=Ut),bt<0)?null:this.at(mt>=0?mt:bt,ut)}intersectsBox(_){return this.intersectBox(_,_vector$a)!==null}intersectTriangle(_,ut,mt,bt,St){_edge1.subVectors(ut,_),_edge2.subVectors(mt,_),_normal$1.crossVectors(_edge1,_edge2);let Mt=this.direction.dot(_normal$1),Bt;if(Mt>0){if(bt)return null;Bt=1}else if(Mt<0)Bt=-1,Mt=-Mt;else return null;_diff.subVectors(this.origin,_);const Ut=Bt*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(Ut<0)return null;const Ht=Bt*this.direction.dot(_edge1.cross(_diff));if(Ht<0||Ut+Ht>Mt)return null;const tr=-Bt*_diff.dot(_normal$1);return tr<0?null:this.at(tr/Mt,St)}applyMatrix4(_){return this.origin.applyMatrix4(_),this.direction.transformDirection(_),this}equals(_){return _.origin.equals(this.origin)&&_.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar,_r){const Dr=this.elements;return Dr[0]=_,Dr[4]=ut,Dr[8]=mt,Dr[12]=bt,Dr[1]=St,Dr[5]=Mt,Dr[9]=Bt,Dr[13]=Ut,Dr[2]=Ht,Dr[6]=tr,Dr[10]=rr,Dr[14]=sr,Dr[3]=ar,Dr[7]=cr,Dr[11]=Ar,Dr[15]=_r,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(_){const ut=this.elements,mt=_.elements;return ut[0]=mt[0],ut[1]=mt[1],ut[2]=mt[2],ut[3]=mt[3],ut[4]=mt[4],ut[5]=mt[5],ut[6]=mt[6],ut[7]=mt[7],ut[8]=mt[8],ut[9]=mt[9],ut[10]=mt[10],ut[11]=mt[11],ut[12]=mt[12],ut[13]=mt[13],ut[14]=mt[14],ut[15]=mt[15],this}copyPosition(_){const ut=this.elements,mt=_.elements;return ut[12]=mt[12],ut[13]=mt[13],ut[14]=mt[14],this}setFromMatrix3(_){const ut=_.elements;return this.set(ut[0],ut[3],ut[6],0,ut[1],ut[4],ut[7],0,ut[2],ut[5],ut[8],0,0,0,0,1),this}extractBasis(_,ut,mt){return _.setFromMatrixColumn(this,0),ut.setFromMatrixColumn(this,1),mt.setFromMatrixColumn(this,2),this}makeBasis(_,ut,mt){return this.set(_.x,ut.x,mt.x,0,_.y,ut.y,mt.y,0,_.z,ut.z,mt.z,0,0,0,0,1),this}extractRotation(_){const ut=this.elements,mt=_.elements,bt=1/_v1$5.setFromMatrixColumn(_,0).length(),St=1/_v1$5.setFromMatrixColumn(_,1).length(),Mt=1/_v1$5.setFromMatrixColumn(_,2).length();return ut[0]=mt[0]*bt,ut[1]=mt[1]*bt,ut[2]=mt[2]*bt,ut[3]=0,ut[4]=mt[4]*St,ut[5]=mt[5]*St,ut[6]=mt[6]*St,ut[7]=0,ut[8]=mt[8]*Mt,ut[9]=mt[9]*Mt,ut[10]=mt[10]*Mt,ut[11]=0,ut[12]=0,ut[13]=0,ut[14]=0,ut[15]=1,this}makeRotationFromEuler(_){const ut=this.elements,mt=_.x,bt=_.y,St=_.z,Mt=Math.cos(mt),Bt=Math.sin(mt),Ut=Math.cos(bt),Ht=Math.sin(bt),tr=Math.cos(St),rr=Math.sin(St);if(_.order==="XYZ"){const sr=Mt*tr,ar=Mt*rr,cr=Bt*tr,Ar=Bt*rr;ut[0]=Ut*tr,ut[4]=-Ut*rr,ut[8]=Ht,ut[1]=ar+cr*Ht,ut[5]=sr-Ar*Ht,ut[9]=-Bt*Ut,ut[2]=Ar-sr*Ht,ut[6]=cr+ar*Ht,ut[10]=Mt*Ut}else if(_.order==="YXZ"){const sr=Ut*tr,ar=Ut*rr,cr=Ht*tr,Ar=Ht*rr;ut[0]=sr+Ar*Bt,ut[4]=cr*Bt-ar,ut[8]=Mt*Ht,ut[1]=Mt*rr,ut[5]=Mt*tr,ut[9]=-Bt,ut[2]=ar*Bt-cr,ut[6]=Ar+sr*Bt,ut[10]=Mt*Ut}else if(_.order==="ZXY"){const sr=Ut*tr,ar=Ut*rr,cr=Ht*tr,Ar=Ht*rr;ut[0]=sr-Ar*Bt,ut[4]=-Mt*rr,ut[8]=cr+ar*Bt,ut[1]=ar+cr*Bt,ut[5]=Mt*tr,ut[9]=Ar-sr*Bt,ut[2]=-Mt*Ht,ut[6]=Bt,ut[10]=Mt*Ut}else if(_.order==="ZYX"){const sr=Mt*tr,ar=Mt*rr,cr=Bt*tr,Ar=Bt*rr;ut[0]=Ut*tr,ut[4]=cr*Ht-ar,ut[8]=sr*Ht+Ar,ut[1]=Ut*rr,ut[5]=Ar*Ht+sr,ut[9]=ar*Ht-cr,ut[2]=-Ht,ut[6]=Bt*Ut,ut[10]=Mt*Ut}else if(_.order==="YZX"){const sr=Mt*Ut,ar=Mt*Ht,cr=Bt*Ut,Ar=Bt*Ht;ut[0]=Ut*tr,ut[4]=Ar-sr*rr,ut[8]=cr*rr+ar,ut[1]=rr,ut[5]=Mt*tr,ut[9]=-Bt*tr,ut[2]=-Ht*tr,ut[6]=ar*rr+cr,ut[10]=sr-Ar*rr}else if(_.order==="XZY"){const sr=Mt*Ut,ar=Mt*Ht,cr=Bt*Ut,Ar=Bt*Ht;ut[0]=Ut*tr,ut[4]=-rr,ut[8]=Ht*tr,ut[1]=sr*rr+Ar,ut[5]=Mt*tr,ut[9]=ar*rr-cr,ut[2]=cr*rr-ar,ut[6]=Bt*tr,ut[10]=Ar*rr+sr}return ut[3]=0,ut[7]=0,ut[11]=0,ut[12]=0,ut[13]=0,ut[14]=0,ut[15]=1,this}makeRotationFromQuaternion(_){return this.compose(_zero,_,_one)}lookAt(_,ut,mt){const bt=this.elements;return _z.subVectors(_,ut),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x$1.crossVectors(mt,_z),_x$1.lengthSq()===0&&(Math.abs(mt.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x$1.crossVectors(mt,_z)),_x$1.normalize(),_y$1.crossVectors(_z,_x$1),bt[0]=_x$1.x,bt[4]=_y$1.x,bt[8]=_z.x,bt[1]=_x$1.y,bt[5]=_y$1.y,bt[9]=_z.y,bt[2]=_x$1.z,bt[6]=_y$1.z,bt[10]=_z.z,this}multiply(_){return this.multiplyMatrices(this,_)}premultiply(_){return this.multiplyMatrices(_,this)}multiplyMatrices(_,ut){const mt=_.elements,bt=ut.elements,St=this.elements,Mt=mt[0],Bt=mt[4],Ut=mt[8],Ht=mt[12],tr=mt[1],rr=mt[5],sr=mt[9],ar=mt[13],cr=mt[2],Ar=mt[6],_r=mt[10],Dr=mt[14],$r=mt[3],Br=mt[7],Jr=mt[11],mn=mt[15],Mn=bt[0],$n=bt[4],en=bt[8],In=bt[12],Rn=bt[1],qn=bt[5],Qn=bt[9],xs=bt[13],cs=bt[2],ks=bt[6],_o=bt[10],qs=bt[14],Ss=bt[3],eo=bt[7],Ao=bt[11],Oo=bt[15];return St[0]=Mt*Mn+Bt*Rn+Ut*cs+Ht*Ss,St[4]=Mt*$n+Bt*qn+Ut*ks+Ht*eo,St[8]=Mt*en+Bt*Qn+Ut*_o+Ht*Ao,St[12]=Mt*In+Bt*xs+Ut*qs+Ht*Oo,St[1]=tr*Mn+rr*Rn+sr*cs+ar*Ss,St[5]=tr*$n+rr*qn+sr*ks+ar*eo,St[9]=tr*en+rr*Qn+sr*_o+ar*Ao,St[13]=tr*In+rr*xs+sr*qs+ar*Oo,St[2]=cr*Mn+Ar*Rn+_r*cs+Dr*Ss,St[6]=cr*$n+Ar*qn+_r*ks+Dr*eo,St[10]=cr*en+Ar*Qn+_r*_o+Dr*Ao,St[14]=cr*In+Ar*xs+_r*qs+Dr*Oo,St[3]=$r*Mn+Br*Rn+Jr*cs+mn*Ss,St[7]=$r*$n+Br*qn+Jr*ks+mn*eo,St[11]=$r*en+Br*Qn+Jr*_o+mn*Ao,St[15]=$r*In+Br*xs+Jr*qs+mn*Oo,this}multiplyScalar(_){const ut=this.elements;return ut[0]*=_,ut[4]*=_,ut[8]*=_,ut[12]*=_,ut[1]*=_,ut[5]*=_,ut[9]*=_,ut[13]*=_,ut[2]*=_,ut[6]*=_,ut[10]*=_,ut[14]*=_,ut[3]*=_,ut[7]*=_,ut[11]*=_,ut[15]*=_,this}determinant(){const _=this.elements,ut=_[0],mt=_[4],bt=_[8],St=_[12],Mt=_[1],Bt=_[5],Ut=_[9],Ht=_[13],tr=_[2],rr=_[6],sr=_[10],ar=_[14],cr=_[3],Ar=_[7],_r=_[11],Dr=_[15];return cr*(+St*Ut*rr-bt*Ht*rr-St*Bt*sr+mt*Ht*sr+bt*Bt*ar-mt*Ut*ar)+Ar*(+ut*Ut*ar-ut*Ht*sr+St*Mt*sr-bt*Mt*ar+bt*Ht*tr-St*Ut*tr)+_r*(+ut*Ht*rr-ut*Bt*ar-St*Mt*rr+mt*Mt*ar+St*Bt*tr-mt*Ht*tr)+Dr*(-bt*Bt*tr-ut*Ut*rr+ut*Bt*sr+bt*Mt*rr-mt*Mt*sr+mt*Ut*tr)}transpose(){const _=this.elements;let ut;return ut=_[1],_[1]=_[4],_[4]=ut,ut=_[2],_[2]=_[8],_[8]=ut,ut=_[6],_[6]=_[9],_[9]=ut,ut=_[3],_[3]=_[12],_[12]=ut,ut=_[7],_[7]=_[13],_[13]=ut,ut=_[11],_[11]=_[14],_[14]=ut,this}setPosition(_,ut,mt){const bt=this.elements;return _.isVector3?(bt[12]=_.x,bt[13]=_.y,bt[14]=_.z):(bt[12]=_,bt[13]=ut,bt[14]=mt),this}invert(){const _=this.elements,ut=_[0],mt=_[1],bt=_[2],St=_[3],Mt=_[4],Bt=_[5],Ut=_[6],Ht=_[7],tr=_[8],rr=_[9],sr=_[10],ar=_[11],cr=_[12],Ar=_[13],_r=_[14],Dr=_[15],$r=rr*_r*Ht-Ar*sr*Ht+Ar*Ut*ar-Bt*_r*ar-rr*Ut*Dr+Bt*sr*Dr,Br=cr*sr*Ht-tr*_r*Ht-cr*Ut*ar+Mt*_r*ar+tr*Ut*Dr-Mt*sr*Dr,Jr=tr*Ar*Ht-cr*rr*Ht+cr*Bt*ar-Mt*Ar*ar-tr*Bt*Dr+Mt*rr*Dr,mn=cr*rr*Ut-tr*Ar*Ut-cr*Bt*sr+Mt*Ar*sr+tr*Bt*_r-Mt*rr*_r,Mn=ut*$r+mt*Br+bt*Jr+St*mn;if(Mn===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const $n=1/Mn;return _[0]=$r*$n,_[1]=(Ar*sr*St-rr*_r*St-Ar*bt*ar+mt*_r*ar+rr*bt*Dr-mt*sr*Dr)*$n,_[2]=(Bt*_r*St-Ar*Ut*St+Ar*bt*Ht-mt*_r*Ht-Bt*bt*Dr+mt*Ut*Dr)*$n,_[3]=(rr*Ut*St-Bt*sr*St-rr*bt*Ht+mt*sr*Ht+Bt*bt*ar-mt*Ut*ar)*$n,_[4]=Br*$n,_[5]=(tr*_r*St-cr*sr*St+cr*bt*ar-ut*_r*ar-tr*bt*Dr+ut*sr*Dr)*$n,_[6]=(cr*Ut*St-Mt*_r*St-cr*bt*Ht+ut*_r*Ht+Mt*bt*Dr-ut*Ut*Dr)*$n,_[7]=(Mt*sr*St-tr*Ut*St+tr*bt*Ht-ut*sr*Ht-Mt*bt*ar+ut*Ut*ar)*$n,_[8]=Jr*$n,_[9]=(cr*rr*St-tr*Ar*St-cr*mt*ar+ut*Ar*ar+tr*mt*Dr-ut*rr*Dr)*$n,_[10]=(Mt*Ar*St-cr*Bt*St+cr*mt*Ht-ut*Ar*Ht-Mt*mt*Dr+ut*Bt*Dr)*$n,_[11]=(tr*Bt*St-Mt*rr*St-tr*mt*Ht+ut*rr*Ht+Mt*mt*ar-ut*Bt*ar)*$n,_[12]=mn*$n,_[13]=(tr*Ar*bt-cr*rr*bt+cr*mt*sr-ut*Ar*sr-tr*mt*_r+ut*rr*_r)*$n,_[14]=(cr*Bt*bt-Mt*Ar*bt-cr*mt*Ut+ut*Ar*Ut+Mt*mt*_r-ut*Bt*_r)*$n,_[15]=(Mt*rr*bt-tr*Bt*bt+tr*mt*Ut-ut*rr*Ut-Mt*mt*sr+ut*Bt*sr)*$n,this}scale(_){const ut=this.elements,mt=_.x,bt=_.y,St=_.z;return ut[0]*=mt,ut[4]*=bt,ut[8]*=St,ut[1]*=mt,ut[5]*=bt,ut[9]*=St,ut[2]*=mt,ut[6]*=bt,ut[10]*=St,ut[3]*=mt,ut[7]*=bt,ut[11]*=St,this}getMaxScaleOnAxis(){const _=this.elements,ut=_[0]*_[0]+_[1]*_[1]+_[2]*_[2],mt=_[4]*_[4]+_[5]*_[5]+_[6]*_[6],bt=_[8]*_[8]+_[9]*_[9]+_[10]*_[10];return Math.sqrt(Math.max(ut,mt,bt))}makeTranslation(_,ut,mt){return this.set(1,0,0,_,0,1,0,ut,0,0,1,mt,0,0,0,1),this}makeRotationX(_){const ut=Math.cos(_),mt=Math.sin(_);return this.set(1,0,0,0,0,ut,-mt,0,0,mt,ut,0,0,0,0,1),this}makeRotationY(_){const ut=Math.cos(_),mt=Math.sin(_);return this.set(ut,0,mt,0,0,1,0,0,-mt,0,ut,0,0,0,0,1),this}makeRotationZ(_){const ut=Math.cos(_),mt=Math.sin(_);return this.set(ut,-mt,0,0,mt,ut,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(_,ut){const mt=Math.cos(ut),bt=Math.sin(ut),St=1-mt,Mt=_.x,Bt=_.y,Ut=_.z,Ht=St*Mt,tr=St*Bt;return this.set(Ht*Mt+mt,Ht*Bt-bt*Ut,Ht*Ut+bt*Bt,0,Ht*Bt+bt*Ut,tr*Bt+mt,tr*Ut-bt*Mt,0,Ht*Ut-bt*Bt,tr*Ut+bt*Mt,St*Ut*Ut+mt,0,0,0,0,1),this}makeScale(_,ut,mt){return this.set(_,0,0,0,0,ut,0,0,0,0,mt,0,0,0,0,1),this}makeShear(_,ut,mt,bt,St,Mt){return this.set(1,mt,St,0,_,1,Mt,0,ut,bt,1,0,0,0,0,1),this}compose(_,ut,mt){const bt=this.elements,St=ut._x,Mt=ut._y,Bt=ut._z,Ut=ut._w,Ht=St+St,tr=Mt+Mt,rr=Bt+Bt,sr=St*Ht,ar=St*tr,cr=St*rr,Ar=Mt*tr,_r=Mt*rr,Dr=Bt*rr,$r=Ut*Ht,Br=Ut*tr,Jr=Ut*rr,mn=mt.x,Mn=mt.y,$n=mt.z;return bt[0]=(1-(Ar+Dr))*mn,bt[1]=(ar+Jr)*mn,bt[2]=(cr-Br)*mn,bt[3]=0,bt[4]=(ar-Jr)*Mn,bt[5]=(1-(sr+Dr))*Mn,bt[6]=(_r+$r)*Mn,bt[7]=0,bt[8]=(cr+Br)*$n,bt[9]=(_r-$r)*$n,bt[10]=(1-(sr+Ar))*$n,bt[11]=0,bt[12]=_.x,bt[13]=_.y,bt[14]=_.z,bt[15]=1,this}decompose(_,ut,mt){const bt=this.elements;let St=_v1$5.set(bt[0],bt[1],bt[2]).length();const Mt=_v1$5.set(bt[4],bt[5],bt[6]).length(),Bt=_v1$5.set(bt[8],bt[9],bt[10]).length();this.determinant()<0&&(St=-St),_.x=bt[12],_.y=bt[13],_.z=bt[14],_m1$2.copy(this);const Ht=1/St,tr=1/Mt,rr=1/Bt;return _m1$2.elements[0]*=Ht,_m1$2.elements[1]*=Ht,_m1$2.elements[2]*=Ht,_m1$2.elements[4]*=tr,_m1$2.elements[5]*=tr,_m1$2.elements[6]*=tr,_m1$2.elements[8]*=rr,_m1$2.elements[9]*=rr,_m1$2.elements[10]*=rr,ut.setFromRotationMatrix(_m1$2),mt.x=St,mt.y=Mt,mt.z=Bt,this}makePerspective(_,ut,mt,bt,St,Mt){const Bt=this.elements,Ut=2*St/(ut-_),Ht=2*St/(mt-bt),tr=(ut+_)/(ut-_),rr=(mt+bt)/(mt-bt),sr=-(Mt+St)/(Mt-St),ar=-2*Mt*St/(Mt-St);return Bt[0]=Ut,Bt[4]=0,Bt[8]=tr,Bt[12]=0,Bt[1]=0,Bt[5]=Ht,Bt[9]=rr,Bt[13]=0,Bt[2]=0,Bt[6]=0,Bt[10]=sr,Bt[14]=ar,Bt[3]=0,Bt[7]=0,Bt[11]=-1,Bt[15]=0,this}makeOrthographic(_,ut,mt,bt,St,Mt){const Bt=this.elements,Ut=1/(ut-_),Ht=1/(mt-bt),tr=1/(Mt-St),rr=(ut+_)*Ut,sr=(mt+bt)*Ht,ar=(Mt+St)*tr;return Bt[0]=2*Ut,Bt[4]=0,Bt[8]=0,Bt[12]=-rr,Bt[1]=0,Bt[5]=2*Ht,Bt[9]=0,Bt[13]=-sr,Bt[2]=0,Bt[6]=0,Bt[10]=-2*tr,Bt[14]=-ar,Bt[3]=0,Bt[7]=0,Bt[11]=0,Bt[15]=1,this}equals(_){const ut=this.elements,mt=_.elements;for(let bt=0;bt<16;bt++)if(ut[bt]!==mt[bt])return!1;return!0}fromArray(_,ut=0){for(let mt=0;mt<16;mt++)this.elements[mt]=_[mt+ut];return this}toArray(_=[],ut=0){const mt=this.elements;return _[ut]=mt[0],_[ut+1]=mt[1],_[ut+2]=mt[2],_[ut+3]=mt[3],_[ut+4]=mt[4],_[ut+5]=mt[5],_[ut+6]=mt[6],_[ut+7]=mt[7],_[ut+8]=mt[8],_[ut+9]=mt[9],_[ut+10]=mt[10],_[ut+11]=mt[11],_[ut+12]=mt[12],_[ut+13]=mt[13],_[ut+14]=mt[14],_[ut+15]=mt[15],_}}const _v1$5=new Vector3,_m1$2=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x$1=new Vector3,_y$1=new Vector3,_z=new Vector3,_matrix$1=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(_=0,ut=0,mt=0,bt=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=_,this._y=ut,this._z=mt,this._order=bt}get x(){return this._x}set x(_){this._x=_,this._onChangeCallback()}get y(){return this._y}set y(_){this._y=_,this._onChangeCallback()}get z(){return this._z}set z(_){this._z=_,this._onChangeCallback()}get order(){return this._order}set order(_){this._order=_,this._onChangeCallback()}set(_,ut,mt,bt=this._order){return this._x=_,this._y=ut,this._z=mt,this._order=bt,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(_){return this._x=_._x,this._y=_._y,this._z=_._z,this._order=_._order,this._onChangeCallback(),this}setFromRotationMatrix(_,ut=this._order,mt=!0){const bt=_.elements,St=bt[0],Mt=bt[4],Bt=bt[8],Ut=bt[1],Ht=bt[5],tr=bt[9],rr=bt[2],sr=bt[6],ar=bt[10];switch(ut){case"XYZ":this._y=Math.asin(clamp$7(Bt,-1,1)),Math.abs(Bt)<.9999999?(this._x=Math.atan2(-tr,ar),this._z=Math.atan2(-Mt,St)):(this._x=Math.atan2(sr,Ht),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp$7(tr,-1,1)),Math.abs(tr)<.9999999?(this._y=Math.atan2(Bt,ar),this._z=Math.atan2(Ut,Ht)):(this._y=Math.atan2(-rr,St),this._z=0);break;case"ZXY":this._x=Math.asin(clamp$7(sr,-1,1)),Math.abs(sr)<.9999999?(this._y=Math.atan2(-rr,ar),this._z=Math.atan2(-Mt,Ht)):(this._y=0,this._z=Math.atan2(Ut,St));break;case"ZYX":this._y=Math.asin(-clamp$7(rr,-1,1)),Math.abs(rr)<.9999999?(this._x=Math.atan2(sr,ar),this._z=Math.atan2(Ut,St)):(this._x=0,this._z=Math.atan2(-Mt,Ht));break;case"YZX":this._z=Math.asin(clamp$7(Ut,-1,1)),Math.abs(Ut)<.9999999?(this._x=Math.atan2(-tr,Ht),this._y=Math.atan2(-rr,St)):(this._x=0,this._y=Math.atan2(Bt,ar));break;case"XZY":this._z=Math.asin(-clamp$7(Mt,-1,1)),Math.abs(Mt)<.9999999?(this._x=Math.atan2(sr,Ht),this._y=Math.atan2(Bt,St)):(this._x=Math.atan2(-tr,ar),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+ut)}return this._order=ut,mt===!0&&this._onChangeCallback(),this}setFromQuaternion(_,ut,mt){return _matrix$1.makeRotationFromQuaternion(_),this.setFromRotationMatrix(_matrix$1,ut,mt)}setFromVector3(_,ut=this._order){return this.set(_.x,_.y,_.z,ut)}reorder(_){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,_)}equals(_){return _._x===this._x&&_._y===this._y&&_._z===this._z&&_._order===this._order}fromArray(_){return this._x=_[0],this._y=_[1],this._z=_[2],_[3]!==void 0&&(this._order=_[3]),this._onChangeCallback(),this}toArray(_=[],ut=0){return _[ut]=this._x,_[ut+1]=this._y,_[ut+2]=this._z,_[ut+3]=this._order,_}_onChange(_){return this._onChangeCallback=_,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(_){this.mask=(1<<_|0)>>>0}enable(_){this.mask|=1<<_|0}enableAll(){this.mask=-1}toggle(_){this.mask^=1<<_|0}disable(_){this.mask&=~(1<<_|0)}disableAll(){this.mask=0}test(_){return(this.mask&_.mask)!==0}isEnabled(_){return(this.mask&(1<<_|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1$1=new Quaternion,_m1$1=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID$1(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const _=new Vector3,ut=new Euler,mt=new Quaternion,bt=new Vector3(1,1,1);function St(){mt.setFromEuler(ut,!1)}function Mt(){ut.setFromQuaternion(mt,void 0,!1)}ut._onChange(St),mt._onChange(Mt),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:_},rotation:{configurable:!0,enumerable:!0,value:ut},quaternion:{configurable:!0,enumerable:!0,value:mt},scale:{configurable:!0,enumerable:!0,value:bt},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(_){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(_),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(_){return this.quaternion.premultiply(_),this}setRotationFromAxisAngle(_,ut){this.quaternion.setFromAxisAngle(_,ut)}setRotationFromEuler(_){this.quaternion.setFromEuler(_,!0)}setRotationFromMatrix(_){this.quaternion.setFromRotationMatrix(_)}setRotationFromQuaternion(_){this.quaternion.copy(_)}rotateOnAxis(_,ut){return _q1$1.setFromAxisAngle(_,ut),this.quaternion.multiply(_q1$1),this}rotateOnWorldAxis(_,ut){return _q1$1.setFromAxisAngle(_,ut),this.quaternion.premultiply(_q1$1),this}rotateX(_){return this.rotateOnAxis(_xAxis,_)}rotateY(_){return this.rotateOnAxis(_yAxis,_)}rotateZ(_){return this.rotateOnAxis(_zAxis,_)}translateOnAxis(_,ut){return _v1$4.copy(_).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(ut)),this}translateX(_){return this.translateOnAxis(_xAxis,_)}translateY(_){return this.translateOnAxis(_yAxis,_)}translateZ(_){return this.translateOnAxis(_zAxis,_)}localToWorld(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(this.matrixWorld)}worldToLocal(_){return this.updateWorldMatrix(!0,!1),_.applyMatrix4(_m1$1.copy(this.matrixWorld).invert())}lookAt(_,ut,mt){_.isVector3?_target.copy(_):_target.set(_,ut,mt);const bt=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1.lookAt(_position$3,_target,this.up):_m1$1.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$1),bt&&(_m1$1.extractRotation(bt.matrixWorld),_q1$1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1$1.invert()))}add(_){if(arguments.length>1){for(let ut=0;ut<arguments.length;ut++)this.add(arguments[ut]);return this}return _===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",_),this):(_&&_.isObject3D?(_.parent!==null&&_.parent.remove(_),_.parent=this,this.children.push(_),_.dispatchEvent(_addedEvent)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",_),this)}remove(_){if(arguments.length>1){for(let mt=0;mt<arguments.length;mt++)this.remove(arguments[mt]);return this}const ut=this.children.indexOf(_);return ut!==-1&&(_.parent=null,this.children.splice(ut,1),_.dispatchEvent(_removedEvent)),this}removeFromParent(){const _=this.parent;return _!==null&&_.remove(this),this}clear(){for(let _=0;_<this.children.length;_++){const ut=this.children[_];ut.parent=null,ut.dispatchEvent(_removedEvent)}return this.children.length=0,this}attach(_){return this.updateWorldMatrix(!0,!1),_m1$1.copy(this.matrixWorld).invert(),_.parent!==null&&(_.parent.updateWorldMatrix(!0,!1),_m1$1.multiply(_.parent.matrixWorld)),_.applyMatrix4(_m1$1),this.add(_),_.updateWorldMatrix(!1,!0),this}getObjectById(_){return this.getObjectByProperty("id",_)}getObjectByName(_){return this.getObjectByProperty("name",_)}getObjectByProperty(_,ut){if(this[_]===ut)return this;for(let mt=0,bt=this.children.length;mt<bt;mt++){const Mt=this.children[mt].getObjectByProperty(_,ut);if(Mt!==void 0)return Mt}}getObjectsByProperty(_,ut){let mt=[];this[_]===ut&&mt.push(this);for(let bt=0,St=this.children.length;bt<St;bt++){const Mt=this.children[bt].getObjectsByProperty(_,ut);Mt.length>0&&(mt=mt.concat(Mt))}return mt}getWorldPosition(_){return this.updateWorldMatrix(!0,!1),_.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_,_scale$2),_}getWorldScale(_){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,_),_}getWorldDirection(_){this.updateWorldMatrix(!0,!1);const ut=this.matrixWorld.elements;return _.set(ut[8],ut[9],ut[10]).normalize()}raycast(){}traverse(_){_(this);const ut=this.children;for(let mt=0,bt=ut.length;mt<bt;mt++)ut[mt].traverse(_)}traverseVisible(_){if(this.visible===!1)return;_(this);const ut=this.children;for(let mt=0,bt=ut.length;mt<bt;mt++)ut[mt].traverseVisible(_)}traverseAncestors(_){const ut=this.parent;ut!==null&&(_(ut),ut.traverseAncestors(_))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(_){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,_=!0);const ut=this.children;for(let mt=0,bt=ut.length;mt<bt;mt++){const St=ut[mt];(St.matrixWorldAutoUpdate===!0||_===!0)&&St.updateMatrixWorld(_)}}updateWorldMatrix(_,ut){const mt=this.parent;if(_===!0&&mt!==null&&mt.matrixWorldAutoUpdate===!0&&mt.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),ut===!0){const bt=this.children;for(let St=0,Mt=bt.length;St<Mt;St++){const Bt=bt[St];Bt.matrixWorldAutoUpdate===!0&&Bt.updateWorldMatrix(!1,!0)}}}toJSON(_){const ut=_===void 0||typeof _=="string",mt={};ut&&(_={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},mt.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const bt={};bt.uuid=this.uuid,bt.type=this.type,this.name!==""&&(bt.name=this.name),this.castShadow===!0&&(bt.castShadow=!0),this.receiveShadow===!0&&(bt.receiveShadow=!0),this.visible===!1&&(bt.visible=!1),this.frustumCulled===!1&&(bt.frustumCulled=!1),this.renderOrder!==0&&(bt.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(bt.userData=this.userData),bt.layers=this.layers.mask,bt.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(bt.matrixAutoUpdate=!1),this.isInstancedMesh&&(bt.type="InstancedMesh",bt.count=this.count,bt.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(bt.instanceColor=this.instanceColor.toJSON()));function St(Bt,Ut){return Bt[Ut.uuid]===void 0&&(Bt[Ut.uuid]=Ut.toJSON(_)),Ut.uuid}if(this.isScene)this.background&&(this.background.isColor?bt.background=this.background.toJSON():this.background.isTexture&&(bt.background=this.background.toJSON(_).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(bt.environment=this.environment.toJSON(_).uuid);else if(this.isMesh||this.isLine||this.isPoints){bt.geometry=St(_.geometries,this.geometry);const Bt=this.geometry.parameters;if(Bt!==void 0&&Bt.shapes!==void 0){const Ut=Bt.shapes;if(Array.isArray(Ut))for(let Ht=0,tr=Ut.length;Ht<tr;Ht++){const rr=Ut[Ht];St(_.shapes,rr)}else St(_.shapes,Ut)}}if(this.isSkinnedMesh&&(bt.bindMode=this.bindMode,bt.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(St(_.skeletons,this.skeleton),bt.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const Bt=[];for(let Ut=0,Ht=this.material.length;Ut<Ht;Ut++)Bt.push(St(_.materials,this.material[Ut]));bt.material=Bt}else bt.material=St(_.materials,this.material);if(this.children.length>0){bt.children=[];for(let Bt=0;Bt<this.children.length;Bt++)bt.children.push(this.children[Bt].toJSON(_).object)}if(this.animations.length>0){bt.animations=[];for(let Bt=0;Bt<this.animations.length;Bt++){const Ut=this.animations[Bt];bt.animations.push(St(_.animations,Ut))}}if(ut){const Bt=Mt(_.geometries),Ut=Mt(_.materials),Ht=Mt(_.textures),tr=Mt(_.images),rr=Mt(_.shapes),sr=Mt(_.skeletons),ar=Mt(_.animations),cr=Mt(_.nodes);Bt.length>0&&(mt.geometries=Bt),Ut.length>0&&(mt.materials=Ut),Ht.length>0&&(mt.textures=Ht),tr.length>0&&(mt.images=tr),rr.length>0&&(mt.shapes=rr),sr.length>0&&(mt.skeletons=sr),ar.length>0&&(mt.animations=ar),cr.length>0&&(mt.nodes=cr)}return mt.object=bt,mt;function Mt(Bt){const Ut=[];for(const Ht in Bt){const tr=Bt[Ht];delete tr.metadata,Ut.push(tr)}return Ut}}clone(_){return new this.constructor().copy(this,_)}copy(_,ut=!0){if(this.name=_.name,this.up.copy(_.up),this.position.copy(_.position),this.rotation.order=_.rotation.order,this.quaternion.copy(_.quaternion),this.scale.copy(_.scale),this.matrix.copy(_.matrix),this.matrixWorld.copy(_.matrixWorld),this.matrixAutoUpdate=_.matrixAutoUpdate,this.matrixWorldNeedsUpdate=_.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=_.matrixWorldAutoUpdate,this.layers.mask=_.layers.mask,this.visible=_.visible,this.castShadow=_.castShadow,this.receiveShadow=_.receiveShadow,this.frustumCulled=_.frustumCulled,this.renderOrder=_.renderOrder,this.userData=JSON.parse(JSON.stringify(_.userData)),ut===!0)for(let mt=0;mt<_.children.length;mt++){const bt=_.children[mt];this.add(bt.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$1=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;class Triangle{constructor(_=new Vector3,ut=new Vector3,mt=new Vector3){this.a=_,this.b=ut,this.c=mt}static getNormal(_,ut,mt,bt){bt.subVectors(mt,ut),_v0$1.subVectors(_,ut),bt.cross(_v0$1);const St=bt.lengthSq();return St>0?bt.multiplyScalar(1/Math.sqrt(St)):bt.set(0,0,0)}static getBarycoord(_,ut,mt,bt,St){_v0$1.subVectors(bt,ut),_v1$3.subVectors(mt,ut),_v2$2.subVectors(_,ut);const Mt=_v0$1.dot(_v0$1),Bt=_v0$1.dot(_v1$3),Ut=_v0$1.dot(_v2$2),Ht=_v1$3.dot(_v1$3),tr=_v1$3.dot(_v2$2),rr=Mt*Ht-Bt*Bt;if(rr===0)return St.set(-2,-1,-1);const sr=1/rr,ar=(Ht*Ut-Bt*tr)*sr,cr=(Mt*tr-Bt*Ut)*sr;return St.set(1-ar-cr,cr,ar)}static containsPoint(_,ut,mt,bt){return this.getBarycoord(_,ut,mt,bt,_v3$1),_v3$1.x>=0&&_v3$1.y>=0&&_v3$1.x+_v3$1.y<=1}static getUV(_,ut,mt,bt,St,Mt,Bt,Ut){return this.getBarycoord(_,ut,mt,bt,_v3$1),Ut.set(0,0),Ut.addScaledVector(St,_v3$1.x),Ut.addScaledVector(Mt,_v3$1.y),Ut.addScaledVector(Bt,_v3$1.z),Ut}static isFrontFacing(_,ut,mt,bt){return _v0$1.subVectors(mt,ut),_v1$3.subVectors(_,ut),_v0$1.cross(_v1$3).dot(bt)<0}set(_,ut,mt){return this.a.copy(_),this.b.copy(ut),this.c.copy(mt),this}setFromPointsAndIndices(_,ut,mt,bt){return this.a.copy(_[ut]),this.b.copy(_[mt]),this.c.copy(_[bt]),this}setFromAttributeAndIndices(_,ut,mt,bt){return this.a.fromBufferAttribute(_,ut),this.b.fromBufferAttribute(_,mt),this.c.fromBufferAttribute(_,bt),this}clone(){return new this.constructor().copy(this)}copy(_){return this.a.copy(_.a),this.b.copy(_.b),this.c.copy(_.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(_){return _.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(_){return Triangle.getNormal(this.a,this.b,this.c,_)}getPlane(_){return _.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(_,ut){return Triangle.getBarycoord(_,this.a,this.b,this.c,ut)}getUV(_,ut,mt,bt,St){return Triangle.getUV(_,this.a,this.b,this.c,ut,mt,bt,St)}containsPoint(_){return Triangle.containsPoint(_,this.a,this.b,this.c)}isFrontFacing(_){return Triangle.isFrontFacing(this.a,this.b,this.c,_)}intersectsBox(_){return _.intersectsTriangle(this)}closestPointToPoint(_,ut){const mt=this.a,bt=this.b,St=this.c;let Mt,Bt;_vab.subVectors(bt,mt),_vac.subVectors(St,mt),_vap.subVectors(_,mt);const Ut=_vab.dot(_vap),Ht=_vac.dot(_vap);if(Ut<=0&&Ht<=0)return ut.copy(mt);_vbp.subVectors(_,bt);const tr=_vab.dot(_vbp),rr=_vac.dot(_vbp);if(tr>=0&&rr<=tr)return ut.copy(bt);const sr=Ut*rr-tr*Ht;if(sr<=0&&Ut>=0&&tr<=0)return Mt=Ut/(Ut-tr),ut.copy(mt).addScaledVector(_vab,Mt);_vcp.subVectors(_,St);const ar=_vab.dot(_vcp),cr=_vac.dot(_vcp);if(cr>=0&&ar<=cr)return ut.copy(St);const Ar=ar*Ht-Ut*cr;if(Ar<=0&&Ht>=0&&cr<=0)return Bt=Ht/(Ht-cr),ut.copy(mt).addScaledVector(_vac,Bt);const _r=tr*cr-ar*rr;if(_r<=0&&rr-tr>=0&&ar-cr>=0)return _vbc.subVectors(St,bt),Bt=(rr-tr)/(rr-tr+(ar-cr)),ut.copy(bt).addScaledVector(_vbc,Bt);const Dr=1/(_r+Ar+sr);return Mt=Ar*Dr,Bt=sr*Dr,ut.copy(mt).addScaledVector(_vab,Mt).addScaledVector(_vac,Bt)}equals(_){return _.a.equals(this.a)&&_.b.equals(this.b)&&_.c.equals(this.c)}}let materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:materialId++}),this.uuid=generateUUID$1(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(_){this._alphaTest>0!=_>0&&this.version++,this._alphaTest=_}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(_){if(_!==void 0)for(const ut in _){const mt=_[ut];if(mt===void 0){console.warn("THREE.Material: '"+ut+"' parameter is undefined.");continue}const bt=this[ut];if(bt===void 0){console.warn("THREE."+this.type+": '"+ut+"' is not a property of this material.");continue}bt&&bt.isColor?bt.set(mt):bt&&bt.isVector3&&mt&&mt.isVector3?bt.copy(mt):this[ut]=mt}}toJSON(_){const ut=_===void 0||typeof _=="string";ut&&(_={textures:{},images:{}});const mt={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};mt.uuid=this.uuid,mt.type=this.type,this.name!==""&&(mt.name=this.name),this.color&&this.color.isColor&&(mt.color=this.color.getHex()),this.roughness!==void 0&&(mt.roughness=this.roughness),this.metalness!==void 0&&(mt.metalness=this.metalness),this.sheen!==void 0&&(mt.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(mt.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(mt.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(mt.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(mt.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(mt.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(mt.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(mt.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(mt.shininess=this.shininess),this.clearcoat!==void 0&&(mt.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(mt.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(mt.clearcoatMap=this.clearcoatMap.toJSON(_).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(mt.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(_).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(mt.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(_).uuid,mt.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(mt.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(mt.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(mt.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(mt.iridescenceMap=this.iridescenceMap.toJSON(_).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(mt.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(_).uuid),this.map&&this.map.isTexture&&(mt.map=this.map.toJSON(_).uuid),this.matcap&&this.matcap.isTexture&&(mt.matcap=this.matcap.toJSON(_).uuid),this.alphaMap&&this.alphaMap.isTexture&&(mt.alphaMap=this.alphaMap.toJSON(_).uuid),this.lightMap&&this.lightMap.isTexture&&(mt.lightMap=this.lightMap.toJSON(_).uuid,mt.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(mt.aoMap=this.aoMap.toJSON(_).uuid,mt.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(mt.bumpMap=this.bumpMap.toJSON(_).uuid,mt.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(mt.normalMap=this.normalMap.toJSON(_).uuid,mt.normalMapType=this.normalMapType,mt.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(mt.displacementMap=this.displacementMap.toJSON(_).uuid,mt.displacementScale=this.displacementScale,mt.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(mt.roughnessMap=this.roughnessMap.toJSON(_).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(mt.metalnessMap=this.metalnessMap.toJSON(_).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(mt.emissiveMap=this.emissiveMap.toJSON(_).uuid),this.specularMap&&this.specularMap.isTexture&&(mt.specularMap=this.specularMap.toJSON(_).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(mt.specularIntensityMap=this.specularIntensityMap.toJSON(_).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(mt.specularColorMap=this.specularColorMap.toJSON(_).uuid),this.envMap&&this.envMap.isTexture&&(mt.envMap=this.envMap.toJSON(_).uuid,this.combine!==void 0&&(mt.combine=this.combine)),this.envMapIntensity!==void 0&&(mt.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(mt.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(mt.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(mt.gradientMap=this.gradientMap.toJSON(_).uuid),this.transmission!==void 0&&(mt.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(mt.transmissionMap=this.transmissionMap.toJSON(_).uuid),this.thickness!==void 0&&(mt.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(mt.thicknessMap=this.thicknessMap.toJSON(_).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(mt.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(mt.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(mt.size=this.size),this.shadowSide!==null&&(mt.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(mt.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(mt.blending=this.blending),this.side!==FrontSide&&(mt.side=this.side),this.vertexColors&&(mt.vertexColors=!0),this.opacity<1&&(mt.opacity=this.opacity),this.transparent===!0&&(mt.transparent=this.transparent),mt.depthFunc=this.depthFunc,mt.depthTest=this.depthTest,mt.depthWrite=this.depthWrite,mt.colorWrite=this.colorWrite,mt.stencilWrite=this.stencilWrite,mt.stencilWriteMask=this.stencilWriteMask,mt.stencilFunc=this.stencilFunc,mt.stencilRef=this.stencilRef,mt.stencilFuncMask=this.stencilFuncMask,mt.stencilFail=this.stencilFail,mt.stencilZFail=this.stencilZFail,mt.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(mt.rotation=this.rotation),this.polygonOffset===!0&&(mt.polygonOffset=!0),this.polygonOffsetFactor!==0&&(mt.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(mt.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(mt.linewidth=this.linewidth),this.dashSize!==void 0&&(mt.dashSize=this.dashSize),this.gapSize!==void 0&&(mt.gapSize=this.gapSize),this.scale!==void 0&&(mt.scale=this.scale),this.dithering===!0&&(mt.dithering=!0),this.alphaTest>0&&(mt.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(mt.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(mt.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(mt.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(mt.wireframe=this.wireframe),this.wireframeLinewidth>1&&(mt.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(mt.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(mt.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(mt.flatShading=this.flatShading),this.visible===!1&&(mt.visible=!1),this.toneMapped===!1&&(mt.toneMapped=!1),this.fog===!1&&(mt.fog=!1),Object.keys(this.userData).length>0&&(mt.userData=this.userData);function bt(St){const Mt=[];for(const Bt in St){const Ut=St[Bt];delete Ut.metadata,Mt.push(Ut)}return Mt}if(ut){const St=bt(_.textures),Mt=bt(_.images);St.length>0&&(mt.textures=St),Mt.length>0&&(mt.images=Mt)}return mt}clone(){return new this.constructor().copy(this)}copy(_){this.name=_.name,this.blending=_.blending,this.side=_.side,this.vertexColors=_.vertexColors,this.opacity=_.opacity,this.transparent=_.transparent,this.blendSrc=_.blendSrc,this.blendDst=_.blendDst,this.blendEquation=_.blendEquation,this.blendSrcAlpha=_.blendSrcAlpha,this.blendDstAlpha=_.blendDstAlpha,this.blendEquationAlpha=_.blendEquationAlpha,this.depthFunc=_.depthFunc,this.depthTest=_.depthTest,this.depthWrite=_.depthWrite,this.stencilWriteMask=_.stencilWriteMask,this.stencilFunc=_.stencilFunc,this.stencilRef=_.stencilRef,this.stencilFuncMask=_.stencilFuncMask,this.stencilFail=_.stencilFail,this.stencilZFail=_.stencilZFail,this.stencilZPass=_.stencilZPass,this.stencilWrite=_.stencilWrite;const ut=_.clippingPlanes;let mt=null;if(ut!==null){const bt=ut.length;mt=new Array(bt);for(let St=0;St!==bt;++St)mt[St]=ut[St].clone()}return this.clippingPlanes=mt,this.clipIntersection=_.clipIntersection,this.clipShadows=_.clipShadows,this.shadowSide=_.shadowSide,this.colorWrite=_.colorWrite,this.precision=_.precision,this.polygonOffset=_.polygonOffset,this.polygonOffsetFactor=_.polygonOffsetFactor,this.polygonOffsetUnits=_.polygonOffsetUnits,this.dithering=_.dithering,this.alphaTest=_.alphaTest,this.alphaToCoverage=_.alphaToCoverage,this.premultipliedAlpha=_.premultipliedAlpha,this.forceSinglePass=_.forceSinglePass,this.visible=_.visible,this.toneMapped=_.toneMapped,this.userData=JSON.parse(JSON.stringify(_.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(_){_===!0&&this.version++}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb$1(rt,_,ut){return ut<0&&(ut+=1),ut>1&&(ut-=1),ut<1/6?rt+(_-rt)*6*ut:ut<1/2?_:ut<2/3?rt+(_-rt)*6*(2/3-ut):rt}let Color$1=class{constructor(_,ut,mt){return this.isColor=!0,this.r=1,this.g=1,this.b=1,ut===void 0&&mt===void 0?this.set(_):this.setRGB(_,ut,mt)}set(_){return _&&_.isColor?this.copy(_):typeof _=="number"?this.setHex(_):typeof _=="string"&&this.setStyle(_),this}setScalar(_){return this.r=_,this.g=_,this.b=_,this}setHex(_,ut=SRGBColorSpace){return _=Math.floor(_),this.r=(_>>16&255)/255,this.g=(_>>8&255)/255,this.b=(_&255)/255,ColorManagement.toWorkingColorSpace(this,ut),this}setRGB(_,ut,mt,bt=ColorManagement.workingColorSpace){return this.r=_,this.g=ut,this.b=mt,ColorManagement.toWorkingColorSpace(this,bt),this}setHSL(_,ut,mt,bt=ColorManagement.workingColorSpace){if(_=euclideanModulo(_,1),ut=clamp$7(ut,0,1),mt=clamp$7(mt,0,1),ut===0)this.r=this.g=this.b=mt;else{const St=mt<=.5?mt*(1+ut):mt+ut-mt*ut,Mt=2*mt-St;this.r=hue2rgb$1(Mt,St,_+1/3),this.g=hue2rgb$1(Mt,St,_),this.b=hue2rgb$1(Mt,St,_-1/3)}return ColorManagement.toWorkingColorSpace(this,bt),this}setStyle(_,ut=SRGBColorSpace){function mt(St){St!==void 0&&parseFloat(St)<1&&console.warn("THREE.Color: Alpha component of "+_+" will be ignored.")}let bt;if(bt=/^(\w+)\(([^\)]*)\)/.exec(_)){let St;const Mt=bt[1],Bt=bt[2];switch(Mt){case"rgb":case"rgba":if(St=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(Bt))return this.r=Math.min(255,parseInt(St[1],10))/255,this.g=Math.min(255,parseInt(St[2],10))/255,this.b=Math.min(255,parseInt(St[3],10))/255,ColorManagement.toWorkingColorSpace(this,ut),mt(St[4]),this;if(St=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(Bt))return this.r=Math.min(100,parseInt(St[1],10))/100,this.g=Math.min(100,parseInt(St[2],10))/100,this.b=Math.min(100,parseInt(St[3],10))/100,ColorManagement.toWorkingColorSpace(this,ut),mt(St[4]),this;break;case"hsl":case"hsla":if(St=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(Bt)){const Ut=parseFloat(St[1])/360,Ht=parseFloat(St[2])/100,tr=parseFloat(St[3])/100;return mt(St[4]),this.setHSL(Ut,Ht,tr,ut)}break;default:console.warn("THREE.Color: Unknown color model "+_)}}else if(bt=/^\#([A-Fa-f\d]+)$/.exec(_)){const St=bt[1],Mt=St.length;if(Mt===3)return this.r=parseInt(St.charAt(0)+St.charAt(0),16)/255,this.g=parseInt(St.charAt(1)+St.charAt(1),16)/255,this.b=parseInt(St.charAt(2)+St.charAt(2),16)/255,ColorManagement.toWorkingColorSpace(this,ut),this;if(Mt===6)return this.r=parseInt(St.charAt(0)+St.charAt(1),16)/255,this.g=parseInt(St.charAt(2)+St.charAt(3),16)/255,this.b=parseInt(St.charAt(4)+St.charAt(5),16)/255,ColorManagement.toWorkingColorSpace(this,ut),this;console.warn("THREE.Color: Invalid hex color "+_)}else if(_&&_.length>0)return this.setColorName(_,ut);return this}setColorName(_,ut=SRGBColorSpace){const mt=_colorKeywords[_.toLowerCase()];return mt!==void 0?this.setHex(mt,ut):console.warn("THREE.Color: Unknown color "+_),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(_){return this.r=_.r,this.g=_.g,this.b=_.b,this}copySRGBToLinear(_){return this.r=SRGBToLinear(_.r),this.g=SRGBToLinear(_.g),this.b=SRGBToLinear(_.b),this}copyLinearToSRGB(_){return this.r=LinearToSRGB(_.r),this.g=LinearToSRGB(_.g),this.b=LinearToSRGB(_.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(_=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),_),clamp$7(_color.r*255,0,255)<<16^clamp$7(_color.g*255,0,255)<<8^clamp$7(_color.b*255,0,255)<<0}getHexString(_=SRGBColorSpace){return("000000"+this.getHex(_).toString(16)).slice(-6)}getHSL(_,ut=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),ut);const mt=_color.r,bt=_color.g,St=_color.b,Mt=Math.max(mt,bt,St),Bt=Math.min(mt,bt,St);let Ut,Ht;const tr=(Bt+Mt)/2;if(Bt===Mt)Ut=0,Ht=0;else{const rr=Mt-Bt;switch(Ht=tr<=.5?rr/(Mt+Bt):rr/(2-Mt-Bt),Mt){case mt:Ut=(bt-St)/rr+(bt<St?6:0);break;case bt:Ut=(St-mt)/rr+2;break;case St:Ut=(mt-bt)/rr+4;break}Ut/=6}return _.h=Ut,_.s=Ht,_.l=tr,_}getRGB(_,ut=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),ut),_.r=_color.r,_.g=_color.g,_.b=_color.b,_}getStyle(_=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),_);const ut=_color.r,mt=_color.g,bt=_color.b;return _!==SRGBColorSpace?`color(${_} ${ut.toFixed(3)} ${mt.toFixed(3)} ${bt.toFixed(3)})`:`rgb(${ut*255|0},${mt*255|0},${bt*255|0})`}offsetHSL(_,ut,mt){return this.getHSL(_hslA),_hslA.h+=_,_hslA.s+=ut,_hslA.l+=mt,this.setHSL(_hslA.h,_hslA.s,_hslA.l),this}add(_){return this.r+=_.r,this.g+=_.g,this.b+=_.b,this}addColors(_,ut){return this.r=_.r+ut.r,this.g=_.g+ut.g,this.b=_.b+ut.b,this}addScalar(_){return this.r+=_,this.g+=_,this.b+=_,this}sub(_){return this.r=Math.max(0,this.r-_.r),this.g=Math.max(0,this.g-_.g),this.b=Math.max(0,this.b-_.b),this}multiply(_){return this.r*=_.r,this.g*=_.g,this.b*=_.b,this}multiplyScalar(_){return this.r*=_,this.g*=_,this.b*=_,this}lerp(_,ut){return this.r+=(_.r-this.r)*ut,this.g+=(_.g-this.g)*ut,this.b+=(_.b-this.b)*ut,this}lerpColors(_,ut,mt){return this.r=_.r+(ut.r-_.r)*mt,this.g=_.g+(ut.g-_.g)*mt,this.b=_.b+(ut.b-_.b)*mt,this}lerpHSL(_,ut){this.getHSL(_hslA),_.getHSL(_hslB);const mt=lerp(_hslA.h,_hslB.h,ut),bt=lerp(_hslA.s,_hslB.s,ut),St=lerp(_hslA.l,_hslB.l,ut);return this.setHSL(mt,bt,St),this}equals(_){return _.r===this.r&&_.g===this.g&&_.b===this.b}fromArray(_,ut=0){return this.r=_[ut],this.g=_[ut+1],this.b=_[ut+2],this}toArray(_=[],ut=0){return _[ut]=this.r,_[ut+1]=this.g,_[ut+2]=this.b,_}fromBufferAttribute(_,ut){return this.r=_.getX(ut),this.g=_.getY(ut),this.b=_.getZ(ut),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const _color=new Color$1;Color$1.NAMES=_colorKeywords;class MeshBasicMaterial extends Material{constructor(_){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}}const _vector$9=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(_,ut,mt=!1){if(Array.isArray(_))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=_,this.itemSize=ut,this.count=_!==void 0?_.length/ut:0,this.normalized=mt,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}setUsage(_){return this.usage=_,this}copy(_){return this.name=_.name,this.array=new _.array.constructor(_.array),this.itemSize=_.itemSize,this.count=_.count,this.normalized=_.normalized,this.usage=_.usage,this}copyAt(_,ut,mt){_*=this.itemSize,mt*=ut.itemSize;for(let bt=0,St=this.itemSize;bt<St;bt++)this.array[_+bt]=ut.array[mt+bt];return this}copyArray(_){return this.array.set(_),this}applyMatrix3(_){if(this.itemSize===2)for(let ut=0,mt=this.count;ut<mt;ut++)_vector2$1.fromBufferAttribute(this,ut),_vector2$1.applyMatrix3(_),this.setXY(ut,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let ut=0,mt=this.count;ut<mt;ut++)_vector$9.fromBufferAttribute(this,ut),_vector$9.applyMatrix3(_),this.setXYZ(ut,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyMatrix4(_){for(let ut=0,mt=this.count;ut<mt;ut++)_vector$9.fromBufferAttribute(this,ut),_vector$9.applyMatrix4(_),this.setXYZ(ut,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyNormalMatrix(_){for(let ut=0,mt=this.count;ut<mt;ut++)_vector$9.fromBufferAttribute(this,ut),_vector$9.applyNormalMatrix(_),this.setXYZ(ut,_vector$9.x,_vector$9.y,_vector$9.z);return this}transformDirection(_){for(let ut=0,mt=this.count;ut<mt;ut++)_vector$9.fromBufferAttribute(this,ut),_vector$9.transformDirection(_),this.setXYZ(ut,_vector$9.x,_vector$9.y,_vector$9.z);return this}set(_,ut=0){return this.array.set(_,ut),this}getX(_){let ut=this.array[_*this.itemSize];return this.normalized&&(ut=denormalize(ut,this.array)),ut}setX(_,ut){return this.normalized&&(ut=normalize$6(ut,this.array)),this.array[_*this.itemSize]=ut,this}getY(_){let ut=this.array[_*this.itemSize+1];return this.normalized&&(ut=denormalize(ut,this.array)),ut}setY(_,ut){return this.normalized&&(ut=normalize$6(ut,this.array)),this.array[_*this.itemSize+1]=ut,this}getZ(_){let ut=this.array[_*this.itemSize+2];return this.normalized&&(ut=denormalize(ut,this.array)),ut}setZ(_,ut){return this.normalized&&(ut=normalize$6(ut,this.array)),this.array[_*this.itemSize+2]=ut,this}getW(_){let ut=this.array[_*this.itemSize+3];return this.normalized&&(ut=denormalize(ut,this.array)),ut}setW(_,ut){return this.normalized&&(ut=normalize$6(ut,this.array)),this.array[_*this.itemSize+3]=ut,this}setXY(_,ut,mt){return _*=this.itemSize,this.normalized&&(ut=normalize$6(ut,this.array),mt=normalize$6(mt,this.array)),this.array[_+0]=ut,this.array[_+1]=mt,this}setXYZ(_,ut,mt,bt){return _*=this.itemSize,this.normalized&&(ut=normalize$6(ut,this.array),mt=normalize$6(mt,this.array),bt=normalize$6(bt,this.array)),this.array[_+0]=ut,this.array[_+1]=mt,this.array[_+2]=bt,this}setXYZW(_,ut,mt,bt,St){return _*=this.itemSize,this.normalized&&(ut=normalize$6(ut,this.array),mt=normalize$6(mt,this.array),bt=normalize$6(bt,this.array),St=normalize$6(St,this.array)),this.array[_+0]=ut,this.array[_+1]=mt,this.array[_+2]=bt,this.array[_+3]=St,this}onUpload(_){return this.onUploadCallback=_,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const _={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(_.name=this.name),this.usage!==StaticDrawUsage&&(_.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(_.updateRange=this.updateRange),_}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Int8BufferAttribute extends BufferAttribute{constructor(_,ut,mt){super(new Int8Array(_),ut,mt)}}class Uint8BufferAttribute extends BufferAttribute{constructor(_,ut,mt){super(new Uint8Array(_),ut,mt)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(_,ut,mt){super(new Uint8ClampedArray(_),ut,mt)}}class Int16BufferAttribute extends BufferAttribute{constructor(_,ut,mt){super(new Int16Array(_),ut,mt)}}class Uint16BufferAttribute extends BufferAttribute{constructor(_,ut,mt){super(new Uint16Array(_),ut,mt)}}class Int32BufferAttribute extends BufferAttribute{constructor(_,ut,mt){super(new Int32Array(_),ut,mt)}}class Uint32BufferAttribute extends BufferAttribute{constructor(_,ut,mt){super(new Uint32Array(_),ut,mt)}}class Float16BufferAttribute extends BufferAttribute{constructor(_,ut,mt){super(new Uint16Array(_),ut,mt),this.isFloat16BufferAttribute=!0}}class Float32BufferAttribute extends BufferAttribute{constructor(_,ut,mt){super(new Float32Array(_),ut,mt)}}class Float64BufferAttribute extends BufferAttribute{constructor(_,ut,mt){super(new Float64Array(_),ut,mt)}}let _id$1=0;const _m1$3=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$1=new Box3,_boxMorphTargets=new Box3,_vector$8=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$1++}),this.uuid=generateUUID$1(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(_){return Array.isArray(_)?this.index=new(arrayNeedsUint32(_)?Uint32BufferAttribute:Uint16BufferAttribute)(_,1):this.index=_,this}getAttribute(_){return this.attributes[_]}setAttribute(_,ut){return this.attributes[_]=ut,this}deleteAttribute(_){return delete this.attributes[_],this}hasAttribute(_){return this.attributes[_]!==void 0}addGroup(_,ut,mt=0){this.groups.push({start:_,count:ut,materialIndex:mt})}clearGroups(){this.groups=[]}setDrawRange(_,ut){this.drawRange.start=_,this.drawRange.count=ut}applyMatrix4(_){const ut=this.attributes.position;ut!==void 0&&(ut.applyMatrix4(_),ut.needsUpdate=!0);const mt=this.attributes.normal;if(mt!==void 0){const St=new Matrix3().getNormalMatrix(_);mt.applyNormalMatrix(St),mt.needsUpdate=!0}const bt=this.attributes.tangent;return bt!==void 0&&(bt.transformDirection(_),bt.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(_){return _m1$3.makeRotationFromQuaternion(_),this.applyMatrix4(_m1$3),this}rotateX(_){return _m1$3.makeRotationX(_),this.applyMatrix4(_m1$3),this}rotateY(_){return _m1$3.makeRotationY(_),this.applyMatrix4(_m1$3),this}rotateZ(_){return _m1$3.makeRotationZ(_),this.applyMatrix4(_m1$3),this}translate(_,ut,mt){return _m1$3.makeTranslation(_,ut,mt),this.applyMatrix4(_m1$3),this}scale(_,ut,mt){return _m1$3.makeScale(_,ut,mt),this.applyMatrix4(_m1$3),this}lookAt(_){return _obj.lookAt(_),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(_){const ut=[];for(let mt=0,bt=_.length;mt<bt;mt++){const St=_[mt];ut.push(St.x,St.y,St.z||0)}return this.setAttribute("position",new Float32BufferAttribute(ut,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const _=this.attributes.position,ut=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(_!==void 0){if(this.boundingBox.setFromBufferAttribute(_),ut)for(let mt=0,bt=ut.length;mt<bt;mt++){const St=ut[mt];_box$1.setFromBufferAttribute(St),this.morphTargetsRelative?(_vector$8.addVectors(this.boundingBox.min,_box$1.min),this.boundingBox.expandByPoint(_vector$8),_vector$8.addVectors(this.boundingBox.max,_box$1.max),this.boundingBox.expandByPoint(_vector$8)):(this.boundingBox.expandByPoint(_box$1.min),this.boundingBox.expandByPoint(_box$1.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere$1);const _=this.attributes.position,ut=this.morphAttributes.position;if(_&&_.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Vector3,1/0);return}if(_){const mt=this.boundingSphere.center;if(_box$1.setFromBufferAttribute(_),ut)for(let St=0,Mt=ut.length;St<Mt;St++){const Bt=ut[St];_boxMorphTargets.setFromBufferAttribute(Bt),this.morphTargetsRelative?(_vector$8.addVectors(_box$1.min,_boxMorphTargets.min),_box$1.expandByPoint(_vector$8),_vector$8.addVectors(_box$1.max,_boxMorphTargets.max),_box$1.expandByPoint(_vector$8)):(_box$1.expandByPoint(_boxMorphTargets.min),_box$1.expandByPoint(_boxMorphTargets.max))}_box$1.getCenter(mt);let bt=0;for(let St=0,Mt=_.count;St<Mt;St++)_vector$8.fromBufferAttribute(_,St),bt=Math.max(bt,mt.distanceToSquared(_vector$8));if(ut)for(let St=0,Mt=ut.length;St<Mt;St++){const Bt=ut[St],Ut=this.morphTargetsRelative;for(let Ht=0,tr=Bt.count;Ht<tr;Ht++)_vector$8.fromBufferAttribute(Bt,Ht),Ut&&(_offset.fromBufferAttribute(_,Ht),_vector$8.add(_offset)),bt=Math.max(bt,mt.distanceToSquared(_vector$8))}this.boundingSphere.radius=Math.sqrt(bt),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const _=this.index,ut=this.attributes;if(_===null||ut.position===void 0||ut.normal===void 0||ut.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const mt=_.array,bt=ut.position.array,St=ut.normal.array,Mt=ut.uv.array,Bt=bt.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*Bt),4));const Ut=this.getAttribute("tangent").array,Ht=[],tr=[];for(let Rn=0;Rn<Bt;Rn++)Ht[Rn]=new Vector3,tr[Rn]=new Vector3;const rr=new Vector3,sr=new Vector3,ar=new Vector3,cr=new Vector2,Ar=new Vector2,_r=new Vector2,Dr=new Vector3,$r=new Vector3;function Br(Rn,qn,Qn){rr.fromArray(bt,Rn*3),sr.fromArray(bt,qn*3),ar.fromArray(bt,Qn*3),cr.fromArray(Mt,Rn*2),Ar.fromArray(Mt,qn*2),_r.fromArray(Mt,Qn*2),sr.sub(rr),ar.sub(rr),Ar.sub(cr),_r.sub(cr);const xs=1/(Ar.x*_r.y-_r.x*Ar.y);isFinite(xs)&&(Dr.copy(sr).multiplyScalar(_r.y).addScaledVector(ar,-Ar.y).multiplyScalar(xs),$r.copy(ar).multiplyScalar(Ar.x).addScaledVector(sr,-_r.x).multiplyScalar(xs),Ht[Rn].add(Dr),Ht[qn].add(Dr),Ht[Qn].add(Dr),tr[Rn].add($r),tr[qn].add($r),tr[Qn].add($r))}let Jr=this.groups;Jr.length===0&&(Jr=[{start:0,count:mt.length}]);for(let Rn=0,qn=Jr.length;Rn<qn;++Rn){const Qn=Jr[Rn],xs=Qn.start,cs=Qn.count;for(let ks=xs,_o=xs+cs;ks<_o;ks+=3)Br(mt[ks+0],mt[ks+1],mt[ks+2])}const mn=new Vector3,Mn=new Vector3,$n=new Vector3,en=new Vector3;function In(Rn){$n.fromArray(St,Rn*3),en.copy($n);const qn=Ht[Rn];mn.copy(qn),mn.sub($n.multiplyScalar($n.dot(qn))).normalize(),Mn.crossVectors(en,qn);const xs=Mn.dot(tr[Rn])<0?-1:1;Ut[Rn*4]=mn.x,Ut[Rn*4+1]=mn.y,Ut[Rn*4+2]=mn.z,Ut[Rn*4+3]=xs}for(let Rn=0,qn=Jr.length;Rn<qn;++Rn){const Qn=Jr[Rn],xs=Qn.start,cs=Qn.count;for(let ks=xs,_o=xs+cs;ks<_o;ks+=3)In(mt[ks+0]),In(mt[ks+1]),In(mt[ks+2])}}computeVertexNormals(){const _=this.index,ut=this.getAttribute("position");if(ut!==void 0){let mt=this.getAttribute("normal");if(mt===void 0)mt=new BufferAttribute(new Float32Array(ut.count*3),3),this.setAttribute("normal",mt);else for(let sr=0,ar=mt.count;sr<ar;sr++)mt.setXYZ(sr,0,0,0);const bt=new Vector3,St=new Vector3,Mt=new Vector3,Bt=new Vector3,Ut=new Vector3,Ht=new Vector3,tr=new Vector3,rr=new Vector3;if(_)for(let sr=0,ar=_.count;sr<ar;sr+=3){const cr=_.getX(sr+0),Ar=_.getX(sr+1),_r=_.getX(sr+2);bt.fromBufferAttribute(ut,cr),St.fromBufferAttribute(ut,Ar),Mt.fromBufferAttribute(ut,_r),tr.subVectors(Mt,St),rr.subVectors(bt,St),tr.cross(rr),Bt.fromBufferAttribute(mt,cr),Ut.fromBufferAttribute(mt,Ar),Ht.fromBufferAttribute(mt,_r),Bt.add(tr),Ut.add(tr),Ht.add(tr),mt.setXYZ(cr,Bt.x,Bt.y,Bt.z),mt.setXYZ(Ar,Ut.x,Ut.y,Ut.z),mt.setXYZ(_r,Ht.x,Ht.y,Ht.z)}else for(let sr=0,ar=ut.count;sr<ar;sr+=3)bt.fromBufferAttribute(ut,sr+0),St.fromBufferAttribute(ut,sr+1),Mt.fromBufferAttribute(ut,sr+2),tr.subVectors(Mt,St),rr.subVectors(bt,St),tr.cross(rr),mt.setXYZ(sr+0,tr.x,tr.y,tr.z),mt.setXYZ(sr+1,tr.x,tr.y,tr.z),mt.setXYZ(sr+2,tr.x,tr.y,tr.z);this.normalizeNormals(),mt.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const _=this.attributes.normal;for(let ut=0,mt=_.count;ut<mt;ut++)_vector$8.fromBufferAttribute(_,ut),_vector$8.normalize(),_.setXYZ(ut,_vector$8.x,_vector$8.y,_vector$8.z)}toNonIndexed(){function _(Bt,Ut){const Ht=Bt.array,tr=Bt.itemSize,rr=Bt.normalized,sr=new Ht.constructor(Ut.length*tr);let ar=0,cr=0;for(let Ar=0,_r=Ut.length;Ar<_r;Ar++){Bt.isInterleavedBufferAttribute?ar=Ut[Ar]*Bt.data.stride+Bt.offset:ar=Ut[Ar]*tr;for(let Dr=0;Dr<tr;Dr++)sr[cr++]=Ht[ar++]}return new BufferAttribute(sr,tr,rr)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const ut=new BufferGeometry,mt=this.index.array,bt=this.attributes;for(const Bt in bt){const Ut=bt[Bt],Ht=_(Ut,mt);ut.setAttribute(Bt,Ht)}const St=this.morphAttributes;for(const Bt in St){const Ut=[],Ht=St[Bt];for(let tr=0,rr=Ht.length;tr<rr;tr++){const sr=Ht[tr],ar=_(sr,mt);Ut.push(ar)}ut.morphAttributes[Bt]=Ut}ut.morphTargetsRelative=this.morphTargetsRelative;const Mt=this.groups;for(let Bt=0,Ut=Mt.length;Bt<Ut;Bt++){const Ht=Mt[Bt];ut.addGroup(Ht.start,Ht.count,Ht.materialIndex)}return ut}toJSON(){const _={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(_.uuid=this.uuid,_.type=this.type,this.name!==""&&(_.name=this.name),Object.keys(this.userData).length>0&&(_.userData=this.userData),this.parameters!==void 0){const Ut=this.parameters;for(const Ht in Ut)Ut[Ht]!==void 0&&(_[Ht]=Ut[Ht]);return _}_.data={attributes:{}};const ut=this.index;ut!==null&&(_.data.index={type:ut.array.constructor.name,array:Array.prototype.slice.call(ut.array)});const mt=this.attributes;for(const Ut in mt){const Ht=mt[Ut];_.data.attributes[Ut]=Ht.toJSON(_.data)}const bt={};let St=!1;for(const Ut in this.morphAttributes){const Ht=this.morphAttributes[Ut],tr=[];for(let rr=0,sr=Ht.length;rr<sr;rr++){const ar=Ht[rr];tr.push(ar.toJSON(_.data))}tr.length>0&&(bt[Ut]=tr,St=!0)}St&&(_.data.morphAttributes=bt,_.data.morphTargetsRelative=this.morphTargetsRelative);const Mt=this.groups;Mt.length>0&&(_.data.groups=JSON.parse(JSON.stringify(Mt)));const Bt=this.boundingSphere;return Bt!==null&&(_.data.boundingSphere={center:Bt.center.toArray(),radius:Bt.radius}),_}clone(){return new this.constructor().copy(this)}copy(_){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const ut={};this.name=_.name;const mt=_.index;mt!==null&&this.setIndex(mt.clone(ut));const bt=_.attributes;for(const Ht in bt){const tr=bt[Ht];this.setAttribute(Ht,tr.clone(ut))}const St=_.morphAttributes;for(const Ht in St){const tr=[],rr=St[Ht];for(let sr=0,ar=rr.length;sr<ar;sr++)tr.push(rr[sr].clone(ut));this.morphAttributes[Ht]=tr}this.morphTargetsRelative=_.morphTargetsRelative;const Mt=_.groups;for(let Ht=0,tr=Mt.length;Ht<tr;Ht++){const rr=Mt[Ht];this.addGroup(rr.start,rr.count,rr.materialIndex)}const Bt=_.boundingBox;Bt!==null&&(this.boundingBox=Bt.clone());const Ut=_.boundingSphere;return Ut!==null&&(this.boundingSphere=Ut.clone()),this.drawRange.start=_.drawRange.start,this.drawRange.count=_.drawRange.count,this.userData=_.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$2=new Matrix4,_ray$2=new Ray,_sphere$3=new Sphere$1,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(_=new BufferGeometry,ut=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=_,this.material=ut,this.updateMorphTargets()}copy(_,ut){return super.copy(_,ut),_.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=_.morphTargetInfluences.slice()),_.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},_.morphTargetDictionary)),this.material=_.material,this.geometry=_.geometry,this}updateMorphTargets(){const ut=this.geometry.morphAttributes,mt=Object.keys(ut);if(mt.length>0){const bt=ut[mt[0]];if(bt!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let St=0,Mt=bt.length;St<Mt;St++){const Bt=bt[St].name||String(St);this.morphTargetInfluences.push(0),this.morphTargetDictionary[Bt]=St}}}}getVertexPosition(_,ut){const mt=this.geometry,bt=mt.attributes.position,St=mt.morphAttributes.position,Mt=mt.morphTargetsRelative;ut.fromBufferAttribute(bt,_);const Bt=this.morphTargetInfluences;if(St&&Bt){_morphA.set(0,0,0);for(let Ut=0,Ht=St.length;Ut<Ht;Ut++){const tr=Bt[Ut],rr=St[Ut];tr!==0&&(_tempA.fromBufferAttribute(rr,_),Mt?_morphA.addScaledVector(_tempA,tr):_morphA.addScaledVector(_tempA.sub(ut),tr))}ut.add(_morphA)}return this.isSkinnedMesh&&this.boneTransform(_,ut),ut}raycast(_,ut){const mt=this.geometry,bt=this.material,St=this.matrixWorld;if(bt===void 0||(mt.boundingSphere===null&&mt.computeBoundingSphere(),_sphere$3.copy(mt.boundingSphere),_sphere$3.applyMatrix4(St),_ray$2.copy(_.ray).recast(_.near),_sphere$3.containsPoint(_ray$2.origin)===!1&&(_ray$2.intersectSphere(_sphere$3,_sphereHitAt)===null||_ray$2.origin.distanceToSquared(_sphereHitAt)>(_.far-_.near)**2))||(_inverseMatrix$2.copy(St).invert(),_ray$2.copy(_.ray).applyMatrix4(_inverseMatrix$2),mt.boundingBox!==null&&_ray$2.intersectsBox(mt.boundingBox)===!1))return;let Mt;const Bt=mt.index,Ut=mt.attributes.position,Ht=mt.attributes.uv,tr=mt.attributes.uv2,rr=mt.groups,sr=mt.drawRange;if(Bt!==null)if(Array.isArray(bt))for(let ar=0,cr=rr.length;ar<cr;ar++){const Ar=rr[ar],_r=bt[Ar.materialIndex],Dr=Math.max(Ar.start,sr.start),$r=Math.min(Bt.count,Math.min(Ar.start+Ar.count,sr.start+sr.count));for(let Br=Dr,Jr=$r;Br<Jr;Br+=3){const mn=Bt.getX(Br),Mn=Bt.getX(Br+1),$n=Bt.getX(Br+2);Mt=checkBufferGeometryIntersection(this,_r,_,_ray$2,Ht,tr,mn,Mn,$n),Mt&&(Mt.faceIndex=Math.floor(Br/3),Mt.face.materialIndex=Ar.materialIndex,ut.push(Mt))}}else{const ar=Math.max(0,sr.start),cr=Math.min(Bt.count,sr.start+sr.count);for(let Ar=ar,_r=cr;Ar<_r;Ar+=3){const Dr=Bt.getX(Ar),$r=Bt.getX(Ar+1),Br=Bt.getX(Ar+2);Mt=checkBufferGeometryIntersection(this,bt,_,_ray$2,Ht,tr,Dr,$r,Br),Mt&&(Mt.faceIndex=Math.floor(Ar/3),ut.push(Mt))}}else if(Ut!==void 0)if(Array.isArray(bt))for(let ar=0,cr=rr.length;ar<cr;ar++){const Ar=rr[ar],_r=bt[Ar.materialIndex],Dr=Math.max(Ar.start,sr.start),$r=Math.min(Ut.count,Math.min(Ar.start+Ar.count,sr.start+sr.count));for(let Br=Dr,Jr=$r;Br<Jr;Br+=3){const mn=Br,Mn=Br+1,$n=Br+2;Mt=checkBufferGeometryIntersection(this,_r,_,_ray$2,Ht,tr,mn,Mn,$n),Mt&&(Mt.faceIndex=Math.floor(Br/3),Mt.face.materialIndex=Ar.materialIndex,ut.push(Mt))}}else{const ar=Math.max(0,sr.start),cr=Math.min(Ut.count,sr.start+sr.count);for(let Ar=ar,_r=cr;Ar<_r;Ar+=3){const Dr=Ar,$r=Ar+1,Br=Ar+2;Mt=checkBufferGeometryIntersection(this,bt,_,_ray$2,Ht,tr,Dr,$r,Br),Mt&&(Mt.faceIndex=Math.floor(Ar/3),ut.push(Mt))}}}}function checkIntersection(rt,_,ut,mt,bt,St,Mt,Bt){let Ut;if(_.side===BackSide?Ut=mt.intersectTriangle(Mt,St,bt,!0,Bt):Ut=mt.intersectTriangle(bt,St,Mt,_.side===FrontSide,Bt),Ut===null)return null;_intersectionPointWorld.copy(Bt),_intersectionPointWorld.applyMatrix4(rt.matrixWorld);const Ht=ut.ray.origin.distanceTo(_intersectionPointWorld);return Ht<ut.near||Ht>ut.far?null:{distance:Ht,point:_intersectionPointWorld.clone(),object:rt}}function checkBufferGeometryIntersection(rt,_,ut,mt,bt,St,Mt,Bt,Ut){rt.getVertexPosition(Mt,_vA$1),rt.getVertexPosition(Bt,_vB$1),rt.getVertexPosition(Ut,_vC$1);const Ht=checkIntersection(rt,_,ut,mt,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(Ht){bt&&(_uvA$1.fromBufferAttribute(bt,Mt),_uvB$1.fromBufferAttribute(bt,Bt),_uvC$1.fromBufferAttribute(bt,Ut),Ht.uv=Triangle.getUV(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),St&&(_uvA$1.fromBufferAttribute(St,Mt),_uvB$1.fromBufferAttribute(St,Bt),_uvC$1.fromBufferAttribute(St,Ut),Ht.uv2=Triangle.getUV(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2));const tr={a:Mt,b:Bt,c:Ut,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,tr.normal),Ht.face=tr}return Ht}class BoxGeometry extends BufferGeometry{constructor(_=1,ut=1,mt=1,bt=1,St=1,Mt=1){super(),this.type="BoxGeometry",this.parameters={width:_,height:ut,depth:mt,widthSegments:bt,heightSegments:St,depthSegments:Mt};const Bt=this;bt=Math.floor(bt),St=Math.floor(St),Mt=Math.floor(Mt);const Ut=[],Ht=[],tr=[],rr=[];let sr=0,ar=0;cr("z","y","x",-1,-1,mt,ut,_,Mt,St,0),cr("z","y","x",1,-1,mt,ut,-_,Mt,St,1),cr("x","z","y",1,1,_,mt,ut,bt,Mt,2),cr("x","z","y",1,-1,_,mt,-ut,bt,Mt,3),cr("x","y","z",1,-1,_,ut,mt,bt,St,4),cr("x","y","z",-1,-1,_,ut,-mt,bt,St,5),this.setIndex(Ut),this.setAttribute("position",new Float32BufferAttribute(Ht,3)),this.setAttribute("normal",new Float32BufferAttribute(tr,3)),this.setAttribute("uv",new Float32BufferAttribute(rr,2));function cr(Ar,_r,Dr,$r,Br,Jr,mn,Mn,$n,en,In){const Rn=Jr/$n,qn=mn/en,Qn=Jr/2,xs=mn/2,cs=Mn/2,ks=$n+1,_o=en+1;let qs=0,Ss=0;const eo=new Vector3;for(let Ao=0;Ao<_o;Ao++){const Oo=Ao*qn-xs;for(let uo=0;uo<ks;uo++){const uu=uo*Rn-Qn;eo[Ar]=uu*$r,eo[_r]=Oo*Br,eo[Dr]=cs,Ht.push(eo.x,eo.y,eo.z),eo[Ar]=0,eo[_r]=0,eo[Dr]=Mn>0?1:-1,tr.push(eo.x,eo.y,eo.z),rr.push(uo/$n),rr.push(1-Ao/en),qs+=1}}for(let Ao=0;Ao<en;Ao++)for(let Oo=0;Oo<$n;Oo++){const uo=sr+Oo+ks*Ao,uu=sr+Oo+ks*(Ao+1),cu=sr+(Oo+1)+ks*(Ao+1),Jl=sr+(Oo+1)+ks*Ao;Ut.push(uo,uu,Jl),Ut.push(uu,cu,Jl),Ss+=6}Bt.addGroup(ar,Ss,In),ar+=Ss,sr+=qs}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new BoxGeometry(_.width,_.height,_.depth,_.widthSegments,_.heightSegments,_.depthSegments)}}function cloneUniforms(rt){const _={};for(const ut in rt){_[ut]={};for(const mt in rt[ut]){const bt=rt[ut][mt];bt&&(bt.isColor||bt.isMatrix3||bt.isMatrix4||bt.isVector2||bt.isVector3||bt.isVector4||bt.isTexture||bt.isQuaternion)?_[ut][mt]=bt.clone():Array.isArray(bt)?_[ut][mt]=bt.slice():_[ut][mt]=bt}}return _}function mergeUniforms(rt){const _={};for(let ut=0;ut<rt.length;ut++){const mt=cloneUniforms(rt[ut]);for(const bt in mt)_[bt]=mt[bt]}return _}function cloneUniformsGroups(rt){const _=[];for(let ut=0;ut<rt.length;ut++)_.push(rt[ut].clone());return _}function getUnlitUniformColorSpace(rt){return rt.getRenderTarget()===null&&rt.outputEncoding===sRGBEncoding$1?SRGBColorSpace:LinearSRGBColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material{constructor(_){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,_!==void 0&&this.setValues(_)}copy(_){return super.copy(_),this.fragmentShader=_.fragmentShader,this.vertexShader=_.vertexShader,this.uniforms=cloneUniforms(_.uniforms),this.uniformsGroups=cloneUniformsGroups(_.uniformsGroups),this.defines=Object.assign({},_.defines),this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.fog=_.fog,this.lights=_.lights,this.clipping=_.clipping,this.extensions=Object.assign({},_.extensions),this.glslVersion=_.glslVersion,this}toJSON(_){const ut=super.toJSON(_);ut.glslVersion=this.glslVersion,ut.uniforms={};for(const bt in this.uniforms){const Mt=this.uniforms[bt].value;Mt&&Mt.isTexture?ut.uniforms[bt]={type:"t",value:Mt.toJSON(_).uuid}:Mt&&Mt.isColor?ut.uniforms[bt]={type:"c",value:Mt.getHex()}:Mt&&Mt.isVector2?ut.uniforms[bt]={type:"v2",value:Mt.toArray()}:Mt&&Mt.isVector3?ut.uniforms[bt]={type:"v3",value:Mt.toArray()}:Mt&&Mt.isVector4?ut.uniforms[bt]={type:"v4",value:Mt.toArray()}:Mt&&Mt.isMatrix3?ut.uniforms[bt]={type:"m3",value:Mt.toArray()}:Mt&&Mt.isMatrix4?ut.uniforms[bt]={type:"m4",value:Mt.toArray()}:ut.uniforms[bt]={value:Mt}}Object.keys(this.defines).length>0&&(ut.defines=this.defines),ut.vertexShader=this.vertexShader,ut.fragmentShader=this.fragmentShader;const mt={};for(const bt in this.extensions)this.extensions[bt]===!0&&(mt[bt]=!0);return Object.keys(mt).length>0&&(ut.extensions=mt),ut}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4}copy(_,ut){return super.copy(_,ut),this.matrixWorldInverse.copy(_.matrixWorldInverse),this.projectionMatrix.copy(_.projectionMatrix),this.projectionMatrixInverse.copy(_.projectionMatrixInverse),this}getWorldDirection(_){this.updateWorldMatrix(!0,!1);const ut=this.matrixWorld.elements;return _.set(-ut[8],-ut[9],-ut[10]).normalize()}updateMatrixWorld(_){super.updateMatrixWorld(_),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(_,ut){super.updateWorldMatrix(_,ut),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}let PerspectiveCamera$1=class extends Camera{constructor(_=50,ut=1,mt=.1,bt=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=_,this.zoom=1,this.near=mt,this.far=bt,this.focus=10,this.aspect=ut,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(_,ut){return super.copy(_,ut),this.fov=_.fov,this.zoom=_.zoom,this.near=_.near,this.far=_.far,this.focus=_.focus,this.aspect=_.aspect,this.view=_.view===null?null:Object.assign({},_.view),this.filmGauge=_.filmGauge,this.filmOffset=_.filmOffset,this}setFocalLength(_){const ut=.5*this.getFilmHeight()/_;this.fov=RAD2DEG*2*Math.atan(ut),this.updateProjectionMatrix()}getFocalLength(){const _=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/_}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(_,ut,mt,bt,St,Mt){this.aspect=_/ut,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=ut,this.view.offsetX=mt,this.view.offsetY=bt,this.view.width=St,this.view.height=Mt,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=this.near;let ut=_*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,mt=2*ut,bt=this.aspect*mt,St=-.5*bt;const Mt=this.view;if(this.view!==null&&this.view.enabled){const Ut=Mt.fullWidth,Ht=Mt.fullHeight;St+=Mt.offsetX*bt/Ut,ut-=Mt.offsetY*mt/Ht,bt*=Mt.width/Ut,mt*=Mt.height/Ht}const Bt=this.filmOffset;Bt!==0&&(St+=_*Bt/this.getFilmWidth()),this.projectionMatrix.makePerspective(St,St+bt,ut,ut-mt,_,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const ut=super.toJSON(_);return ut.object.fov=this.fov,ut.object.zoom=this.zoom,ut.object.near=this.near,ut.object.far=this.far,ut.object.focus=this.focus,ut.object.aspect=this.aspect,this.view!==null&&(ut.object.view=Object.assign({},this.view)),ut.object.filmGauge=this.filmGauge,ut.object.filmOffset=this.filmOffset,ut}};const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(_,ut,mt){super(),this.type="CubeCamera",this.renderTarget=mt;const bt=new PerspectiveCamera$1(fov,aspect,_,ut);bt.layers=this.layers,bt.up.set(0,1,0),bt.lookAt(1,0,0),this.add(bt);const St=new PerspectiveCamera$1(fov,aspect,_,ut);St.layers=this.layers,St.up.set(0,1,0),St.lookAt(-1,0,0),this.add(St);const Mt=new PerspectiveCamera$1(fov,aspect,_,ut);Mt.layers=this.layers,Mt.up.set(0,0,-1),Mt.lookAt(0,1,0),this.add(Mt);const Bt=new PerspectiveCamera$1(fov,aspect,_,ut);Bt.layers=this.layers,Bt.up.set(0,0,1),Bt.lookAt(0,-1,0),this.add(Bt);const Ut=new PerspectiveCamera$1(fov,aspect,_,ut);Ut.layers=this.layers,Ut.up.set(0,1,0),Ut.lookAt(0,0,1),this.add(Ut);const Ht=new PerspectiveCamera$1(fov,aspect,_,ut);Ht.layers=this.layers,Ht.up.set(0,1,0),Ht.lookAt(0,0,-1),this.add(Ht)}update(_,ut){this.parent===null&&this.updateMatrixWorld();const mt=this.renderTarget,[bt,St,Mt,Bt,Ut,Ht]=this.children,tr=_.getRenderTarget(),rr=_.toneMapping,sr=_.xr.enabled;_.toneMapping=NoToneMapping,_.xr.enabled=!1;const ar=mt.texture.generateMipmaps;mt.texture.generateMipmaps=!1,_.setRenderTarget(mt,0),_.render(ut,bt),_.setRenderTarget(mt,1),_.render(ut,St),_.setRenderTarget(mt,2),_.render(ut,Mt),_.setRenderTarget(mt,3),_.render(ut,Bt),_.setRenderTarget(mt,4),_.render(ut,Ut),mt.texture.generateMipmaps=ar,_.setRenderTarget(mt,5),_.render(ut,Ht),_.setRenderTarget(tr),_.toneMapping=rr,_.xr.enabled=sr,mt.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture{constructor(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr){_=_!==void 0?_:[],ut=ut!==void 0?ut:CubeReflectionMapping,super(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(_){this.image=_}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(_=1,ut={}){super(_,_,ut),this.isWebGLCubeRenderTarget=!0;const mt={width:_,height:_,depth:1},bt=[mt,mt,mt,mt,mt,mt];this.texture=new CubeTexture(bt,ut.mapping,ut.wrapS,ut.wrapT,ut.magFilter,ut.minFilter,ut.format,ut.type,ut.anisotropy,ut.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=ut.generateMipmaps!==void 0?ut.generateMipmaps:!1,this.texture.minFilter=ut.minFilter!==void 0?ut.minFilter:LinearFilter}fromEquirectangularTexture(_,ut){this.texture.type=ut.type,this.texture.encoding=ut.encoding,this.texture.generateMipmaps=ut.generateMipmaps,this.texture.minFilter=ut.minFilter,this.texture.magFilter=ut.magFilter;const mt={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},bt=new BoxGeometry(5,5,5),St=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(mt.uniforms),vertexShader:mt.vertexShader,fragmentShader:mt.fragmentShader,side:BackSide,blending:NoBlending});St.uniforms.tEquirect.value=ut;const Mt=new Mesh(bt,St),Bt=ut.minFilter;return ut.minFilter===LinearMipmapLinearFilter&&(ut.minFilter=LinearFilter),new CubeCamera(1,10,this).update(_,Mt),ut.minFilter=Bt,Mt.geometry.dispose(),Mt.material.dispose(),this}clear(_,ut,mt,bt){const St=_.getRenderTarget();for(let Mt=0;Mt<6;Mt++)_.setRenderTarget(this,Mt),_.clear(ut,mt,bt);_.setRenderTarget(St)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(_=new Vector3(1,0,0),ut=0){this.isPlane=!0,this.normal=_,this.constant=ut}set(_,ut){return this.normal.copy(_),this.constant=ut,this}setComponents(_,ut,mt,bt){return this.normal.set(_,ut,mt),this.constant=bt,this}setFromNormalAndCoplanarPoint(_,ut){return this.normal.copy(_),this.constant=-ut.dot(this.normal),this}setFromCoplanarPoints(_,ut,mt){const bt=_vector1.subVectors(mt,ut).cross(_vector2.subVectors(_,ut)).normalize();return this.setFromNormalAndCoplanarPoint(bt,_),this}copy(_){return this.normal.copy(_.normal),this.constant=_.constant,this}normalize(){const _=1/this.normal.length();return this.normal.multiplyScalar(_),this.constant*=_,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(_){return this.normal.dot(_)+this.constant}distanceToSphere(_){return this.distanceToPoint(_.center)-_.radius}projectPoint(_,ut){return ut.copy(_).addScaledVector(this.normal,-this.distanceToPoint(_))}intersectLine(_,ut){const mt=_.delta(_vector1),bt=this.normal.dot(mt);if(bt===0)return this.distanceToPoint(_.start)===0?ut.copy(_.start):null;const St=-(_.start.dot(this.normal)+this.constant)/bt;return St<0||St>1?null:ut.copy(_.start).addScaledVector(mt,St)}intersectsLine(_){const ut=this.distanceToPoint(_.start),mt=this.distanceToPoint(_.end);return ut<0&&mt>0||mt<0&&ut>0}intersectsBox(_){return _.intersectsPlane(this)}intersectsSphere(_){return _.intersectsPlane(this)}coplanarPoint(_){return _.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(_,ut){const mt=ut||_normalMatrix.getNormalMatrix(_),bt=this.coplanarPoint(_vector1).applyMatrix4(_),St=this.normal.applyMatrix3(mt).normalize();return this.constant=-bt.dot(St),this}translate(_){return this.constant-=_.dot(this.normal),this}equals(_){return _.normal.equals(this.normal)&&_.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$2=new Sphere$1,_vector$7=new Vector3;class Frustum{constructor(_=new Plane,ut=new Plane,mt=new Plane,bt=new Plane,St=new Plane,Mt=new Plane){this.planes=[_,ut,mt,bt,St,Mt]}set(_,ut,mt,bt,St,Mt){const Bt=this.planes;return Bt[0].copy(_),Bt[1].copy(ut),Bt[2].copy(mt),Bt[3].copy(bt),Bt[4].copy(St),Bt[5].copy(Mt),this}copy(_){const ut=this.planes;for(let mt=0;mt<6;mt++)ut[mt].copy(_.planes[mt]);return this}setFromProjectionMatrix(_){const ut=this.planes,mt=_.elements,bt=mt[0],St=mt[1],Mt=mt[2],Bt=mt[3],Ut=mt[4],Ht=mt[5],tr=mt[6],rr=mt[7],sr=mt[8],ar=mt[9],cr=mt[10],Ar=mt[11],_r=mt[12],Dr=mt[13],$r=mt[14],Br=mt[15];return ut[0].setComponents(Bt-bt,rr-Ut,Ar-sr,Br-_r).normalize(),ut[1].setComponents(Bt+bt,rr+Ut,Ar+sr,Br+_r).normalize(),ut[2].setComponents(Bt+St,rr+Ht,Ar+ar,Br+Dr).normalize(),ut[3].setComponents(Bt-St,rr-Ht,Ar-ar,Br-Dr).normalize(),ut[4].setComponents(Bt-Mt,rr-tr,Ar-cr,Br-$r).normalize(),ut[5].setComponents(Bt+Mt,rr+tr,Ar+cr,Br+$r).normalize(),this}intersectsObject(_){const ut=_.geometry;return ut.boundingSphere===null&&ut.computeBoundingSphere(),_sphere$2.copy(ut.boundingSphere).applyMatrix4(_.matrixWorld),this.intersectsSphere(_sphere$2)}intersectsSprite(_){return _sphere$2.center.set(0,0,0),_sphere$2.radius=.7071067811865476,_sphere$2.applyMatrix4(_.matrixWorld),this.intersectsSphere(_sphere$2)}intersectsSphere(_){const ut=this.planes,mt=_.center,bt=-_.radius;for(let St=0;St<6;St++)if(ut[St].distanceToPoint(mt)<bt)return!1;return!0}intersectsBox(_){const ut=this.planes;for(let mt=0;mt<6;mt++){const bt=ut[mt];if(_vector$7.x=bt.normal.x>0?_.max.x:_.min.x,_vector$7.y=bt.normal.y>0?_.max.y:_.min.y,_vector$7.z=bt.normal.z>0?_.max.z:_.min.z,bt.distanceToPoint(_vector$7)<0)return!1}return!0}containsPoint(_){const ut=this.planes;for(let mt=0;mt<6;mt++)if(ut[mt].distanceToPoint(_)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WebGLAnimation(){let rt=null,_=!1,ut=null,mt=null;function bt(St,Mt){ut(St,Mt),mt=rt.requestAnimationFrame(bt)}return{start:function(){_!==!0&&ut!==null&&(mt=rt.requestAnimationFrame(bt),_=!0)},stop:function(){rt.cancelAnimationFrame(mt),_=!1},setAnimationLoop:function(St){ut=St},setContext:function(St){rt=St}}}function WebGLAttributes(rt,_){const ut=_.isWebGL2,mt=new WeakMap;function bt(Ht,tr){const rr=Ht.array,sr=Ht.usage,ar=rt.createBuffer();rt.bindBuffer(tr,ar),rt.bufferData(tr,rr,sr),Ht.onUploadCallback();let cr;if(rr instanceof Float32Array)cr=5126;else if(rr instanceof Uint16Array)if(Ht.isFloat16BufferAttribute)if(ut)cr=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else cr=5123;else if(rr instanceof Int16Array)cr=5122;else if(rr instanceof Uint32Array)cr=5125;else if(rr instanceof Int32Array)cr=5124;else if(rr instanceof Int8Array)cr=5120;else if(rr instanceof Uint8Array)cr=5121;else if(rr instanceof Uint8ClampedArray)cr=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+rr);return{buffer:ar,type:cr,bytesPerElement:rr.BYTES_PER_ELEMENT,version:Ht.version}}function St(Ht,tr,rr){const sr=tr.array,ar=tr.updateRange;rt.bindBuffer(rr,Ht),ar.count===-1?rt.bufferSubData(rr,0,sr):(ut?rt.bufferSubData(rr,ar.offset*sr.BYTES_PER_ELEMENT,sr,ar.offset,ar.count):rt.bufferSubData(rr,ar.offset*sr.BYTES_PER_ELEMENT,sr.subarray(ar.offset,ar.offset+ar.count)),ar.count=-1),tr.onUploadCallback()}function Mt(Ht){return Ht.isInterleavedBufferAttribute&&(Ht=Ht.data),mt.get(Ht)}function Bt(Ht){Ht.isInterleavedBufferAttribute&&(Ht=Ht.data);const tr=mt.get(Ht);tr&&(rt.deleteBuffer(tr.buffer),mt.delete(Ht))}function Ut(Ht,tr){if(Ht.isGLBufferAttribute){const sr=mt.get(Ht);(!sr||sr.version<Ht.version)&&mt.set(Ht,{buffer:Ht.buffer,type:Ht.type,bytesPerElement:Ht.elementSize,version:Ht.version});return}Ht.isInterleavedBufferAttribute&&(Ht=Ht.data);const rr=mt.get(Ht);rr===void 0?mt.set(Ht,bt(Ht,tr)):rr.version<Ht.version&&(St(rr.buffer,Ht,tr),rr.version=Ht.version)}return{get:Mt,remove:Bt,update:Ut}}class PlaneGeometry extends BufferGeometry{constructor(_=1,ut=1,mt=1,bt=1){super(),this.type="PlaneGeometry",this.parameters={width:_,height:ut,widthSegments:mt,heightSegments:bt};const St=_/2,Mt=ut/2,Bt=Math.floor(mt),Ut=Math.floor(bt),Ht=Bt+1,tr=Ut+1,rr=_/Bt,sr=ut/Ut,ar=[],cr=[],Ar=[],_r=[];for(let Dr=0;Dr<tr;Dr++){const $r=Dr*sr-Mt;for(let Br=0;Br<Ht;Br++){const Jr=Br*rr-St;cr.push(Jr,-$r,0),Ar.push(0,0,1),_r.push(Br/Bt),_r.push(1-Dr/Ut)}}for(let Dr=0;Dr<Ut;Dr++)for(let $r=0;$r<Bt;$r++){const Br=$r+Ht*Dr,Jr=$r+Ht*(Dr+1),mn=$r+1+Ht*(Dr+1),Mn=$r+1+Ht*Dr;ar.push(Br,Jr,Mn),ar.push(Jr,mn,Mn)}this.setIndex(ar),this.setAttribute("position",new Float32BufferAttribute(cr,3)),this.setAttribute("normal",new Float32BufferAttribute(Ar,3)),this.setAttribute("uv",new Float32BufferAttribute(_r,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new PlaneGeometry(_.width,_.height,_.widthSegments,_.heightSegments)}}var alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex="vec3 transformed = vec3( position );",beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_fragment=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,output_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		
		vec2 lodFudge = pow( 1.95, lod ) / fullSize;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec2 fullSize = vec2( textureSize( sampler, 0 ) );
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,uv_pars_fragment=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$e=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,encodings_fragment,encodings_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,output_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,uv2_pars_fragment,uv2_pars_vertex,uv2_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Matrix3},uv2Transform:{value:new Matrix3},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color$1(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color$1(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Matrix3}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},specular:{value:new Color$1(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color$1(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color$1(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Color$1(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Color$1(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Color$1(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0};function WebGLBackground(rt,_,ut,mt,bt,St,Mt){const Bt=new Color$1(0);let Ut=St===!0?0:1,Ht,tr,rr=null,sr=0,ar=null;function cr(_r,Dr){let $r=!1,Br=Dr.isScene===!0?Dr.background:null;Br&&Br.isTexture&&(Br=(Dr.backgroundBlurriness>0?ut:_).get(Br));const Jr=rt.xr,mn=Jr.getSession&&Jr.getSession();mn&&mn.environmentBlendMode==="additive"&&(Br=null),Br===null?Ar(Bt,Ut):Br&&Br.isColor&&(Ar(Br,1),$r=!0),(rt.autoClear||$r)&&rt.clear(rt.autoClearColor,rt.autoClearDepth,rt.autoClearStencil),Br&&(Br.isCubeTexture||Br.mapping===CubeUVReflectionMapping)?(tr===void 0&&(tr=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),tr.geometry.deleteAttribute("normal"),tr.geometry.deleteAttribute("uv"),tr.onBeforeRender=function(Mn,$n,en){this.matrixWorld.copyPosition(en.matrixWorld)},Object.defineProperty(tr.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),bt.update(tr)),tr.material.uniforms.envMap.value=Br,tr.material.uniforms.flipEnvMap.value=Br.isCubeTexture&&Br.isRenderTargetTexture===!1?-1:1,tr.material.uniforms.backgroundBlurriness.value=Dr.backgroundBlurriness,tr.material.uniforms.backgroundIntensity.value=Dr.backgroundIntensity,tr.material.toneMapped=Br.encoding!==sRGBEncoding$1,(rr!==Br||sr!==Br.version||ar!==rt.toneMapping)&&(tr.material.needsUpdate=!0,rr=Br,sr=Br.version,ar=rt.toneMapping),tr.layers.enableAll(),_r.unshift(tr,tr.geometry,tr.material,0,0,null)):Br&&Br.isTexture&&(Ht===void 0&&(Ht=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),Ht.geometry.deleteAttribute("normal"),Object.defineProperty(Ht.material,"map",{get:function(){return this.uniforms.t2D.value}}),bt.update(Ht)),Ht.material.uniforms.t2D.value=Br,Ht.material.uniforms.backgroundIntensity.value=Dr.backgroundIntensity,Ht.material.toneMapped=Br.encoding!==sRGBEncoding$1,Br.matrixAutoUpdate===!0&&Br.updateMatrix(),Ht.material.uniforms.uvTransform.value.copy(Br.matrix),(rr!==Br||sr!==Br.version||ar!==rt.toneMapping)&&(Ht.material.needsUpdate=!0,rr=Br,sr=Br.version,ar=rt.toneMapping),Ht.layers.enableAll(),_r.unshift(Ht,Ht.geometry,Ht.material,0,0,null))}function Ar(_r,Dr){_r.getRGB(_rgb,getUnlitUniformColorSpace(rt)),mt.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,Dr,Mt)}return{getClearColor:function(){return Bt},setClearColor:function(_r,Dr=1){Bt.set(_r),Ut=Dr,Ar(Bt,Ut)},getClearAlpha:function(){return Ut},setClearAlpha:function(_r){Ut=_r,Ar(Bt,Ut)},render:cr}}function WebGLBindingStates(rt,_,ut,mt){const bt=rt.getParameter(34921),St=mt.isWebGL2?null:_.get("OES_vertex_array_object"),Mt=mt.isWebGL2||St!==null,Bt={},Ut=_r(null);let Ht=Ut,tr=!1;function rr(cs,ks,_o,qs,Ss){let eo=!1;if(Mt){const Ao=Ar(qs,_o,ks);Ht!==Ao&&(Ht=Ao,ar(Ht.object)),eo=Dr(cs,qs,_o,Ss),eo&&$r(cs,qs,_o,Ss)}else{const Ao=ks.wireframe===!0;(Ht.geometry!==qs.id||Ht.program!==_o.id||Ht.wireframe!==Ao)&&(Ht.geometry=qs.id,Ht.program=_o.id,Ht.wireframe=Ao,eo=!0)}Ss!==null&&ut.update(Ss,34963),(eo||tr)&&(tr=!1,en(cs,ks,_o,qs),Ss!==null&&rt.bindBuffer(34963,ut.get(Ss).buffer))}function sr(){return mt.isWebGL2?rt.createVertexArray():St.createVertexArrayOES()}function ar(cs){return mt.isWebGL2?rt.bindVertexArray(cs):St.bindVertexArrayOES(cs)}function cr(cs){return mt.isWebGL2?rt.deleteVertexArray(cs):St.deleteVertexArrayOES(cs)}function Ar(cs,ks,_o){const qs=_o.wireframe===!0;let Ss=Bt[cs.id];Ss===void 0&&(Ss={},Bt[cs.id]=Ss);let eo=Ss[ks.id];eo===void 0&&(eo={},Ss[ks.id]=eo);let Ao=eo[qs];return Ao===void 0&&(Ao=_r(sr()),eo[qs]=Ao),Ao}function _r(cs){const ks=[],_o=[],qs=[];for(let Ss=0;Ss<bt;Ss++)ks[Ss]=0,_o[Ss]=0,qs[Ss]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ks,enabledAttributes:_o,attributeDivisors:qs,object:cs,attributes:{},index:null}}function Dr(cs,ks,_o,qs){const Ss=Ht.attributes,eo=ks.attributes;let Ao=0;const Oo=_o.getAttributes();for(const uo in Oo)if(Oo[uo].location>=0){const cu=Ss[uo];let Jl=eo[uo];if(Jl===void 0&&(uo==="instanceMatrix"&&cs.instanceMatrix&&(Jl=cs.instanceMatrix),uo==="instanceColor"&&cs.instanceColor&&(Jl=cs.instanceColor)),cu===void 0||cu.attribute!==Jl||Jl&&cu.data!==Jl.data)return!0;Ao++}return Ht.attributesNum!==Ao||Ht.index!==qs}function $r(cs,ks,_o,qs){const Ss={},eo=ks.attributes;let Ao=0;const Oo=_o.getAttributes();for(const uo in Oo)if(Oo[uo].location>=0){let cu=eo[uo];cu===void 0&&(uo==="instanceMatrix"&&cs.instanceMatrix&&(cu=cs.instanceMatrix),uo==="instanceColor"&&cs.instanceColor&&(cu=cs.instanceColor));const Jl={};Jl.attribute=cu,cu&&cu.data&&(Jl.data=cu.data),Ss[uo]=Jl,Ao++}Ht.attributes=Ss,Ht.attributesNum=Ao,Ht.index=qs}function Br(){const cs=Ht.newAttributes;for(let ks=0,_o=cs.length;ks<_o;ks++)cs[ks]=0}function Jr(cs){mn(cs,0)}function mn(cs,ks){const _o=Ht.newAttributes,qs=Ht.enabledAttributes,Ss=Ht.attributeDivisors;_o[cs]=1,qs[cs]===0&&(rt.enableVertexAttribArray(cs),qs[cs]=1),Ss[cs]!==ks&&((mt.isWebGL2?rt:_.get("ANGLE_instanced_arrays"))[mt.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](cs,ks),Ss[cs]=ks)}function Mn(){const cs=Ht.newAttributes,ks=Ht.enabledAttributes;for(let _o=0,qs=ks.length;_o<qs;_o++)ks[_o]!==cs[_o]&&(rt.disableVertexAttribArray(_o),ks[_o]=0)}function $n(cs,ks,_o,qs,Ss,eo){mt.isWebGL2===!0&&(_o===5124||_o===5125)?rt.vertexAttribIPointer(cs,ks,_o,Ss,eo):rt.vertexAttribPointer(cs,ks,_o,qs,Ss,eo)}function en(cs,ks,_o,qs){if(mt.isWebGL2===!1&&(cs.isInstancedMesh||qs.isInstancedBufferGeometry)&&_.get("ANGLE_instanced_arrays")===null)return;Br();const Ss=qs.attributes,eo=_o.getAttributes(),Ao=ks.defaultAttributeValues;for(const Oo in eo){const uo=eo[Oo];if(uo.location>=0){let uu=Ss[Oo];if(uu===void 0&&(Oo==="instanceMatrix"&&cs.instanceMatrix&&(uu=cs.instanceMatrix),Oo==="instanceColor"&&cs.instanceColor&&(uu=cs.instanceColor)),uu!==void 0){const cu=uu.normalized,Jl=uu.itemSize,mu=ut.get(uu);if(mu===void 0)continue;const pu=mu.buffer,Zu=mu.type,Mp=mu.bytesPerElement;if(uu.isInterleavedBufferAttribute){const Up=uu.data,Ep=Up.stride,mp=uu.offset;if(Up.isInstancedInterleavedBuffer){for(let Cp=0;Cp<uo.locationSize;Cp++)mn(uo.location+Cp,Up.meshPerAttribute);cs.isInstancedMesh!==!0&&qs._maxInstanceCount===void 0&&(qs._maxInstanceCount=Up.meshPerAttribute*Up.count)}else for(let Cp=0;Cp<uo.locationSize;Cp++)Jr(uo.location+Cp);rt.bindBuffer(34962,pu);for(let Cp=0;Cp<uo.locationSize;Cp++)$n(uo.location+Cp,Jl/uo.locationSize,Zu,cu,Ep*Mp,(mp+Jl/uo.locationSize*Cp)*Mp)}else{if(uu.isInstancedBufferAttribute){for(let Up=0;Up<uo.locationSize;Up++)mn(uo.location+Up,uu.meshPerAttribute);cs.isInstancedMesh!==!0&&qs._maxInstanceCount===void 0&&(qs._maxInstanceCount=uu.meshPerAttribute*uu.count)}else for(let Up=0;Up<uo.locationSize;Up++)Jr(uo.location+Up);rt.bindBuffer(34962,pu);for(let Up=0;Up<uo.locationSize;Up++)$n(uo.location+Up,Jl/uo.locationSize,Zu,cu,Jl*Mp,Jl/uo.locationSize*Up*Mp)}}else if(Ao!==void 0){const cu=Ao[Oo];if(cu!==void 0)switch(cu.length){case 2:rt.vertexAttrib2fv(uo.location,cu);break;case 3:rt.vertexAttrib3fv(uo.location,cu);break;case 4:rt.vertexAttrib4fv(uo.location,cu);break;default:rt.vertexAttrib1fv(uo.location,cu)}}}}Mn()}function In(){Qn();for(const cs in Bt){const ks=Bt[cs];for(const _o in ks){const qs=ks[_o];for(const Ss in qs)cr(qs[Ss].object),delete qs[Ss];delete ks[_o]}delete Bt[cs]}}function Rn(cs){if(Bt[cs.id]===void 0)return;const ks=Bt[cs.id];for(const _o in ks){const qs=ks[_o];for(const Ss in qs)cr(qs[Ss].object),delete qs[Ss];delete ks[_o]}delete Bt[cs.id]}function qn(cs){for(const ks in Bt){const _o=Bt[ks];if(_o[cs.id]===void 0)continue;const qs=_o[cs.id];for(const Ss in qs)cr(qs[Ss].object),delete qs[Ss];delete _o[cs.id]}}function Qn(){xs(),tr=!0,Ht!==Ut&&(Ht=Ut,ar(Ht.object))}function xs(){Ut.geometry=null,Ut.program=null,Ut.wireframe=!1}return{setup:rr,reset:Qn,resetDefaultState:xs,dispose:In,releaseStatesOfGeometry:Rn,releaseStatesOfProgram:qn,initAttributes:Br,enableAttribute:Jr,disableUnusedAttributes:Mn}}function WebGLBufferRenderer(rt,_,ut,mt){const bt=mt.isWebGL2;let St;function Mt(Ht){St=Ht}function Bt(Ht,tr){rt.drawArrays(St,Ht,tr),ut.update(tr,St,1)}function Ut(Ht,tr,rr){if(rr===0)return;let sr,ar;if(bt)sr=rt,ar="drawArraysInstanced";else if(sr=_.get("ANGLE_instanced_arrays"),ar="drawArraysInstancedANGLE",sr===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}sr[ar](St,Ht,tr,rr),ut.update(tr,St,rr)}this.setMode=Mt,this.render=Bt,this.renderInstances=Ut}function WebGLCapabilities(rt,_,ut){let mt;function bt(){if(mt!==void 0)return mt;if(_.has("EXT_texture_filter_anisotropic")===!0){const $n=_.get("EXT_texture_filter_anisotropic");mt=rt.getParameter($n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else mt=0;return mt}function St($n){if($n==="highp"){if(rt.getShaderPrecisionFormat(35633,36338).precision>0&&rt.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";$n="mediump"}return $n==="mediump"&&rt.getShaderPrecisionFormat(35633,36337).precision>0&&rt.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const Mt=typeof WebGL2RenderingContext<"u"&&rt instanceof WebGL2RenderingContext;let Bt=ut.precision!==void 0?ut.precision:"highp";const Ut=St(Bt);Ut!==Bt&&(console.warn("THREE.WebGLRenderer:",Bt,"not supported, using",Ut,"instead."),Bt=Ut);const Ht=Mt||_.has("WEBGL_draw_buffers"),tr=ut.logarithmicDepthBuffer===!0,rr=rt.getParameter(34930),sr=rt.getParameter(35660),ar=rt.getParameter(3379),cr=rt.getParameter(34076),Ar=rt.getParameter(34921),_r=rt.getParameter(36347),Dr=rt.getParameter(36348),$r=rt.getParameter(36349),Br=sr>0,Jr=Mt||_.has("OES_texture_float"),mn=Br&&Jr,Mn=Mt?rt.getParameter(36183):0;return{isWebGL2:Mt,drawBuffers:Ht,getMaxAnisotropy:bt,getMaxPrecision:St,precision:Bt,logarithmicDepthBuffer:tr,maxTextures:rr,maxVertexTextures:sr,maxTextureSize:ar,maxCubemapSize:cr,maxAttributes:Ar,maxVertexUniforms:_r,maxVaryings:Dr,maxFragmentUniforms:$r,vertexTextures:Br,floatFragmentTextures:Jr,floatVertexTextures:mn,maxSamples:Mn}}function WebGLClipping(rt){const _=this;let ut=null,mt=0,bt=!1,St=!1;const Mt=new Plane,Bt=new Matrix3,Ut={value:null,needsUpdate:!1};this.uniform=Ut,this.numPlanes=0,this.numIntersection=0,this.init=function(rr,sr){const ar=rr.length!==0||sr||mt!==0||bt;return bt=sr,mt=rr.length,ar},this.beginShadows=function(){St=!0,tr(null)},this.endShadows=function(){St=!1},this.setGlobalState=function(rr,sr){ut=tr(rr,sr,0)},this.setState=function(rr,sr,ar){const cr=rr.clippingPlanes,Ar=rr.clipIntersection,_r=rr.clipShadows,Dr=rt.get(rr);if(!bt||cr===null||cr.length===0||St&&!_r)St?tr(null):Ht();else{const $r=St?0:mt,Br=$r*4;let Jr=Dr.clippingState||null;Ut.value=Jr,Jr=tr(cr,sr,Br,ar);for(let mn=0;mn!==Br;++mn)Jr[mn]=ut[mn];Dr.clippingState=Jr,this.numIntersection=Ar?this.numPlanes:0,this.numPlanes+=$r}};function Ht(){Ut.value!==ut&&(Ut.value=ut,Ut.needsUpdate=mt>0),_.numPlanes=mt,_.numIntersection=0}function tr(rr,sr,ar,cr){const Ar=rr!==null?rr.length:0;let _r=null;if(Ar!==0){if(_r=Ut.value,cr!==!0||_r===null){const Dr=ar+Ar*4,$r=sr.matrixWorldInverse;Bt.getNormalMatrix($r),(_r===null||_r.length<Dr)&&(_r=new Float32Array(Dr));for(let Br=0,Jr=ar;Br!==Ar;++Br,Jr+=4)Mt.copy(rr[Br]).applyMatrix4($r,Bt),Mt.normal.toArray(_r,Jr),_r[Jr+3]=Mt.constant}Ut.value=_r,Ut.needsUpdate=!0}return _.numPlanes=Ar,_.numIntersection=0,_r}}function WebGLCubeMaps(rt){let _=new WeakMap;function ut(Mt,Bt){return Bt===EquirectangularReflectionMapping?Mt.mapping=CubeReflectionMapping:Bt===EquirectangularRefractionMapping&&(Mt.mapping=CubeRefractionMapping),Mt}function mt(Mt){if(Mt&&Mt.isTexture&&Mt.isRenderTargetTexture===!1){const Bt=Mt.mapping;if(Bt===EquirectangularReflectionMapping||Bt===EquirectangularRefractionMapping)if(_.has(Mt)){const Ut=_.get(Mt).texture;return ut(Ut,Mt.mapping)}else{const Ut=Mt.image;if(Ut&&Ut.height>0){const Ht=new WebGLCubeRenderTarget(Ut.height/2);return Ht.fromEquirectangularTexture(rt,Mt),_.set(Mt,Ht),Mt.addEventListener("dispose",bt),ut(Ht.texture,Mt.mapping)}else return null}}return Mt}function bt(Mt){const Bt=Mt.target;Bt.removeEventListener("dispose",bt);const Ut=_.get(Bt);Ut!==void 0&&(_.delete(Bt),Ut.dispose())}function St(){_=new WeakMap}return{get:mt,dispose:St}}let OrthographicCamera$1=class extends Camera{constructor(_=-1,ut=1,mt=1,bt=-1,St=.1,Mt=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=_,this.right=ut,this.top=mt,this.bottom=bt,this.near=St,this.far=Mt,this.updateProjectionMatrix()}copy(_,ut){return super.copy(_,ut),this.left=_.left,this.right=_.right,this.top=_.top,this.bottom=_.bottom,this.near=_.near,this.far=_.far,this.zoom=_.zoom,this.view=_.view===null?null:Object.assign({},_.view),this}setViewOffset(_,ut,mt,bt,St,Mt){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=_,this.view.fullHeight=ut,this.view.offsetX=mt,this.view.offsetY=bt,this.view.width=St,this.view.height=Mt,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const _=(this.right-this.left)/(2*this.zoom),ut=(this.top-this.bottom)/(2*this.zoom),mt=(this.right+this.left)/2,bt=(this.top+this.bottom)/2;let St=mt-_,Mt=mt+_,Bt=bt+ut,Ut=bt-ut;if(this.view!==null&&this.view.enabled){const Ht=(this.right-this.left)/this.view.fullWidth/this.zoom,tr=(this.top-this.bottom)/this.view.fullHeight/this.zoom;St+=Ht*this.view.offsetX,Mt=St+Ht*this.view.width,Bt-=tr*this.view.offsetY,Ut=Bt-tr*this.view.height}this.projectionMatrix.makeOrthographic(St,Mt,Bt,Ut,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(_){const ut=super.toJSON(_);return ut.object.zoom=this.zoom,ut.object.left=this.left,ut.object.right=this.right,ut.object.top=this.top,ut.object.bottom=this.bottom,ut.object.near=this.near,ut.object.far=this.far,this.view!==null&&(ut.object.view=Object.assign({},this.view)),ut}};const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera$1,_clearColor=new Color$1;let _oldTarget=null;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,PHI,INV_PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(INV_PHI,0,PHI),new Vector3(-INV_PHI,0,PHI),new Vector3(PHI,INV_PHI,0),new Vector3(-PHI,INV_PHI,0)];class PMREMGenerator{constructor(_){this._renderer=_,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(_,ut=0,mt=.1,bt=100){_oldTarget=this._renderer.getRenderTarget(),this._setSize(256);const St=this._allocateTargets();return St.depthBuffer=!0,this._sceneToCubeUV(_,mt,bt,St),ut>0&&this._blur(St,0,0,ut),this._applyPMREM(St),this._cleanup(St),St}fromEquirectangular(_,ut=null){return this._fromTexture(_,ut)}fromCubemap(_,ut=null){return this._fromTexture(_,ut)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(_){this._lodMax=Math.floor(Math.log2(_)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let _=0;_<this._lodPlanes.length;_++)this._lodPlanes[_].dispose()}_cleanup(_){this._renderer.setRenderTarget(_oldTarget),_.scissorTest=!1,_setViewport(_,0,0,_.width,_.height)}_fromTexture(_,ut){_.mapping===CubeReflectionMapping||_.mapping===CubeRefractionMapping?this._setSize(_.image.length===0?16:_.image[0].width||_.image[0].image.width):this._setSize(_.image.width/4),_oldTarget=this._renderer.getRenderTarget();const mt=ut||this._allocateTargets();return this._textureToCubeUV(_,mt),this._applyPMREM(mt),this._cleanup(mt),mt}_allocateTargets(){const _=3*Math.max(this._cubeSize,112),ut=4*this._cubeSize,mt={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,encoding:LinearEncoding$1,depthBuffer:!1},bt=_createRenderTarget(_,ut,mt);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==_||this._pingPongRenderTarget.height!==ut){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(_,ut,mt);const{_lodMax:St}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(St)),this._blurMaterial=_getBlurShader(St,_,ut)}return bt}_compileMaterial(_){const ut=new Mesh(this._lodPlanes[0],_);this._renderer.compile(ut,_flatCamera)}_sceneToCubeUV(_,ut,mt,bt){const Bt=new PerspectiveCamera$1(90,1,ut,mt),Ut=[1,-1,1,1,1,1],Ht=[1,1,1,-1,-1,-1],tr=this._renderer,rr=tr.autoClear,sr=tr.toneMapping;tr.getClearColor(_clearColor),tr.toneMapping=NoToneMapping,tr.autoClear=!1;const ar=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),cr=new Mesh(new BoxGeometry,ar);let Ar=!1;const _r=_.background;_r?_r.isColor&&(ar.color.copy(_r),_.background=null,Ar=!0):(ar.color.copy(_clearColor),Ar=!0);for(let Dr=0;Dr<6;Dr++){const $r=Dr%3;$r===0?(Bt.up.set(0,Ut[Dr],0),Bt.lookAt(Ht[Dr],0,0)):$r===1?(Bt.up.set(0,0,Ut[Dr]),Bt.lookAt(0,Ht[Dr],0)):(Bt.up.set(0,Ut[Dr],0),Bt.lookAt(0,0,Ht[Dr]));const Br=this._cubeSize;_setViewport(bt,$r*Br,Dr>2?Br:0,Br,Br),tr.setRenderTarget(bt),Ar&&tr.render(cr,Bt),tr.render(_,Bt)}cr.geometry.dispose(),cr.material.dispose(),tr.toneMapping=sr,tr.autoClear=rr,_.background=_r}_textureToCubeUV(_,ut){const mt=this._renderer,bt=_.mapping===CubeReflectionMapping||_.mapping===CubeRefractionMapping;bt?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=_.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const St=bt?this._cubemapMaterial:this._equirectMaterial,Mt=new Mesh(this._lodPlanes[0],St),Bt=St.uniforms;Bt.envMap.value=_;const Ut=this._cubeSize;_setViewport(ut,0,0,3*Ut,2*Ut),mt.setRenderTarget(ut),mt.render(Mt,_flatCamera)}_applyPMREM(_){const ut=this._renderer,mt=ut.autoClear;ut.autoClear=!1;for(let bt=1;bt<this._lodPlanes.length;bt++){const St=Math.sqrt(this._sigmas[bt]*this._sigmas[bt]-this._sigmas[bt-1]*this._sigmas[bt-1]),Mt=_axisDirections[(bt-1)%_axisDirections.length];this._blur(_,bt-1,bt,St,Mt)}ut.autoClear=mt}_blur(_,ut,mt,bt,St){const Mt=this._pingPongRenderTarget;this._halfBlur(_,Mt,ut,mt,bt,"latitudinal",St),this._halfBlur(Mt,_,mt,mt,bt,"longitudinal",St)}_halfBlur(_,ut,mt,bt,St,Mt,Bt){const Ut=this._renderer,Ht=this._blurMaterial;Mt!=="latitudinal"&&Mt!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const tr=3,rr=new Mesh(this._lodPlanes[bt],Ht),sr=Ht.uniforms,ar=this._sizeLods[mt]-1,cr=isFinite(St)?Math.PI/(2*ar):2*Math.PI/(2*MAX_SAMPLES-1),Ar=St/cr,_r=isFinite(St)?1+Math.floor(tr*Ar):MAX_SAMPLES;_r>MAX_SAMPLES&&console.warn(`sigmaRadians, ${St}, is too large and will clip, as it requested ${_r} samples when the maximum is set to ${MAX_SAMPLES}`);const Dr=[];let $r=0;for(let $n=0;$n<MAX_SAMPLES;++$n){const en=$n/Ar,In=Math.exp(-en*en/2);Dr.push(In),$n===0?$r+=In:$n<_r&&($r+=2*In)}for(let $n=0;$n<Dr.length;$n++)Dr[$n]=Dr[$n]/$r;sr.envMap.value=_.texture,sr.samples.value=_r,sr.weights.value=Dr,sr.latitudinal.value=Mt==="latitudinal",Bt&&(sr.poleAxis.value=Bt);const{_lodMax:Br}=this;sr.dTheta.value=cr,sr.mipInt.value=Br-mt;const Jr=this._sizeLods[bt],mn=3*Jr*(bt>Br-LOD_MIN?bt-Br+LOD_MIN:0),Mn=4*(this._cubeSize-Jr);_setViewport(ut,mn,Mn,3*Jr,2*Jr),Ut.setRenderTarget(ut),Ut.render(rr,_flatCamera)}}function _createPlanes(rt){const _=[],ut=[],mt=[];let bt=rt;const St=rt-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let Mt=0;Mt<St;Mt++){const Bt=Math.pow(2,bt);ut.push(Bt);let Ut=1/Bt;Mt>rt-LOD_MIN?Ut=EXTRA_LOD_SIGMA[Mt-rt+LOD_MIN-1]:Mt===0&&(Ut=0),mt.push(Ut);const Ht=1/(Bt-2),tr=-Ht,rr=1+Ht,sr=[tr,tr,rr,tr,rr,rr,tr,tr,rr,rr,tr,rr],ar=6,cr=6,Ar=3,_r=2,Dr=1,$r=new Float32Array(Ar*cr*ar),Br=new Float32Array(_r*cr*ar),Jr=new Float32Array(Dr*cr*ar);for(let Mn=0;Mn<ar;Mn++){const $n=Mn%3*2/3-1,en=Mn>2?0:-1,In=[$n,en,0,$n+2/3,en,0,$n+2/3,en+1,0,$n,en,0,$n+2/3,en+1,0,$n,en+1,0];$r.set(In,Ar*cr*Mn),Br.set(sr,_r*cr*Mn);const Rn=[Mn,Mn,Mn,Mn,Mn,Mn];Jr.set(Rn,Dr*cr*Mn)}const mn=new BufferGeometry;mn.setAttribute("position",new BufferAttribute($r,Ar)),mn.setAttribute("uv",new BufferAttribute(Br,_r)),mn.setAttribute("faceIndex",new BufferAttribute(Jr,Dr)),_.push(mn),bt>LOD_MIN&&bt--}return{lodPlanes:_,sizeLods:ut,sigmas:mt}}function _createRenderTarget(rt,_,ut){const mt=new WebGLRenderTarget(rt,_,ut);return mt.texture.mapping=CubeUVReflectionMapping,mt.texture.name="PMREM.cubeUv",mt.scissorTest=!0,mt}function _setViewport(rt,_,ut,mt,bt){rt.viewport.set(_,ut,mt,bt),rt.scissor.set(_,ut,mt,bt)}function _getBlurShader(rt,_,ut){const mt=new Float32Array(MAX_SAMPLES),bt=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/_,CUBEUV_TEXEL_HEIGHT:1/ut,CUBEUV_MAX_MIP:`${rt}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:mt},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:bt}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(rt){let _=new WeakMap,ut=null;function mt(Bt){if(Bt&&Bt.isTexture){const Ut=Bt.mapping,Ht=Ut===EquirectangularReflectionMapping||Ut===EquirectangularRefractionMapping,tr=Ut===CubeReflectionMapping||Ut===CubeRefractionMapping;if(Ht||tr)if(Bt.isRenderTargetTexture&&Bt.needsPMREMUpdate===!0){Bt.needsPMREMUpdate=!1;let rr=_.get(Bt);return ut===null&&(ut=new PMREMGenerator(rt)),rr=Ht?ut.fromEquirectangular(Bt,rr):ut.fromCubemap(Bt,rr),_.set(Bt,rr),rr.texture}else{if(_.has(Bt))return _.get(Bt).texture;{const rr=Bt.image;if(Ht&&rr&&rr.height>0||tr&&rr&&bt(rr)){ut===null&&(ut=new PMREMGenerator(rt));const sr=Ht?ut.fromEquirectangular(Bt):ut.fromCubemap(Bt);return _.set(Bt,sr),Bt.addEventListener("dispose",St),sr.texture}else return null}}}return Bt}function bt(Bt){let Ut=0;const Ht=6;for(let tr=0;tr<Ht;tr++)Bt[tr]!==void 0&&Ut++;return Ut===Ht}function St(Bt){const Ut=Bt.target;Ut.removeEventListener("dispose",St);const Ht=_.get(Ut);Ht!==void 0&&(_.delete(Ut),Ht.dispose())}function Mt(){_=new WeakMap,ut!==null&&(ut.dispose(),ut=null)}return{get:mt,dispose:Mt}}function WebGLExtensions(rt){const _={};function ut(mt){if(_[mt]!==void 0)return _[mt];let bt;switch(mt){case"WEBGL_depth_texture":bt=rt.getExtension("WEBGL_depth_texture")||rt.getExtension("MOZ_WEBGL_depth_texture")||rt.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":bt=rt.getExtension("EXT_texture_filter_anisotropic")||rt.getExtension("MOZ_EXT_texture_filter_anisotropic")||rt.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":bt=rt.getExtension("WEBGL_compressed_texture_s3tc")||rt.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||rt.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":bt=rt.getExtension("WEBGL_compressed_texture_pvrtc")||rt.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:bt=rt.getExtension(mt)}return _[mt]=bt,bt}return{has:function(mt){return ut(mt)!==null},init:function(mt){mt.isWebGL2?ut("EXT_color_buffer_float"):(ut("WEBGL_depth_texture"),ut("OES_texture_float"),ut("OES_texture_half_float"),ut("OES_texture_half_float_linear"),ut("OES_standard_derivatives"),ut("OES_element_index_uint"),ut("OES_vertex_array_object"),ut("ANGLE_instanced_arrays")),ut("OES_texture_float_linear"),ut("EXT_color_buffer_half_float"),ut("WEBGL_multisampled_render_to_texture")},get:function(mt){const bt=ut(mt);return bt===null&&console.warn("THREE.WebGLRenderer: "+mt+" extension not supported."),bt}}}function WebGLGeometries(rt,_,ut,mt){const bt={},St=new WeakMap;function Mt(rr){const sr=rr.target;sr.index!==null&&_.remove(sr.index);for(const cr in sr.attributes)_.remove(sr.attributes[cr]);sr.removeEventListener("dispose",Mt),delete bt[sr.id];const ar=St.get(sr);ar&&(_.remove(ar),St.delete(sr)),mt.releaseStatesOfGeometry(sr),sr.isInstancedBufferGeometry===!0&&delete sr._maxInstanceCount,ut.memory.geometries--}function Bt(rr,sr){return bt[sr.id]===!0||(sr.addEventListener("dispose",Mt),bt[sr.id]=!0,ut.memory.geometries++),sr}function Ut(rr){const sr=rr.attributes;for(const cr in sr)_.update(sr[cr],34962);const ar=rr.morphAttributes;for(const cr in ar){const Ar=ar[cr];for(let _r=0,Dr=Ar.length;_r<Dr;_r++)_.update(Ar[_r],34962)}}function Ht(rr){const sr=[],ar=rr.index,cr=rr.attributes.position;let Ar=0;if(ar!==null){const $r=ar.array;Ar=ar.version;for(let Br=0,Jr=$r.length;Br<Jr;Br+=3){const mn=$r[Br+0],Mn=$r[Br+1],$n=$r[Br+2];sr.push(mn,Mn,Mn,$n,$n,mn)}}else{const $r=cr.array;Ar=cr.version;for(let Br=0,Jr=$r.length/3-1;Br<Jr;Br+=3){const mn=Br+0,Mn=Br+1,$n=Br+2;sr.push(mn,Mn,Mn,$n,$n,mn)}}const _r=new(arrayNeedsUint32(sr)?Uint32BufferAttribute:Uint16BufferAttribute)(sr,1);_r.version=Ar;const Dr=St.get(rr);Dr&&_.remove(Dr),St.set(rr,_r)}function tr(rr){const sr=St.get(rr);if(sr){const ar=rr.index;ar!==null&&sr.version<ar.version&&Ht(rr)}else Ht(rr);return St.get(rr)}return{get:Bt,update:Ut,getWireframeAttribute:tr}}function WebGLIndexedBufferRenderer(rt,_,ut,mt){const bt=mt.isWebGL2;let St;function Mt(sr){St=sr}let Bt,Ut;function Ht(sr){Bt=sr.type,Ut=sr.bytesPerElement}function tr(sr,ar){rt.drawElements(St,ar,Bt,sr*Ut),ut.update(ar,St,1)}function rr(sr,ar,cr){if(cr===0)return;let Ar,_r;if(bt)Ar=rt,_r="drawElementsInstanced";else if(Ar=_.get("ANGLE_instanced_arrays"),_r="drawElementsInstancedANGLE",Ar===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}Ar[_r](St,ar,Bt,sr*Ut,cr),ut.update(ar,St,cr)}this.setMode=Mt,this.setIndex=Ht,this.render=tr,this.renderInstances=rr}function WebGLInfo(rt){const _={geometries:0,textures:0},ut={frame:0,calls:0,triangles:0,points:0,lines:0};function mt(St,Mt,Bt){switch(ut.calls++,Mt){case 4:ut.triangles+=Bt*(St/3);break;case 1:ut.lines+=Bt*(St/2);break;case 3:ut.lines+=Bt*(St-1);break;case 2:ut.lines+=Bt*St;break;case 0:ut.points+=Bt*St;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",Mt);break}}function bt(){ut.frame++,ut.calls=0,ut.triangles=0,ut.points=0,ut.lines=0}return{memory:_,render:ut,programs:null,autoReset:!0,reset:bt,update:mt}}function numericalSort(rt,_){return rt[0]-_[0]}function absNumericalSort(rt,_){return Math.abs(_[1])-Math.abs(rt[1])}function WebGLMorphtargets(rt,_,ut){const mt={},bt=new Float32Array(8),St=new WeakMap,Mt=new Vector4,Bt=[];for(let Ht=0;Ht<8;Ht++)Bt[Ht]=[Ht,0];function Ut(Ht,tr,rr){const sr=Ht.morphTargetInfluences;if(_.isWebGL2===!0){const cr=tr.morphAttributes.position||tr.morphAttributes.normal||tr.morphAttributes.color,Ar=cr!==void 0?cr.length:0;let _r=St.get(tr);if(_r===void 0||_r.count!==Ar){let ks=function(){xs.dispose(),St.delete(tr),tr.removeEventListener("dispose",ks)};var ar=ks;_r!==void 0&&_r.texture.dispose();const Br=tr.morphAttributes.position!==void 0,Jr=tr.morphAttributes.normal!==void 0,mn=tr.morphAttributes.color!==void 0,Mn=tr.morphAttributes.position||[],$n=tr.morphAttributes.normal||[],en=tr.morphAttributes.color||[];let In=0;Br===!0&&(In=1),Jr===!0&&(In=2),mn===!0&&(In=3);let Rn=tr.attributes.position.count*In,qn=1;Rn>_.maxTextureSize&&(qn=Math.ceil(Rn/_.maxTextureSize),Rn=_.maxTextureSize);const Qn=new Float32Array(Rn*qn*4*Ar),xs=new DataArrayTexture(Qn,Rn,qn,Ar);xs.type=FloatType,xs.needsUpdate=!0;const cs=In*4;for(let _o=0;_o<Ar;_o++){const qs=Mn[_o],Ss=$n[_o],eo=en[_o],Ao=Rn*qn*4*_o;for(let Oo=0;Oo<qs.count;Oo++){const uo=Oo*cs;Br===!0&&(Mt.fromBufferAttribute(qs,Oo),Qn[Ao+uo+0]=Mt.x,Qn[Ao+uo+1]=Mt.y,Qn[Ao+uo+2]=Mt.z,Qn[Ao+uo+3]=0),Jr===!0&&(Mt.fromBufferAttribute(Ss,Oo),Qn[Ao+uo+4]=Mt.x,Qn[Ao+uo+5]=Mt.y,Qn[Ao+uo+6]=Mt.z,Qn[Ao+uo+7]=0),mn===!0&&(Mt.fromBufferAttribute(eo,Oo),Qn[Ao+uo+8]=Mt.x,Qn[Ao+uo+9]=Mt.y,Qn[Ao+uo+10]=Mt.z,Qn[Ao+uo+11]=eo.itemSize===4?Mt.w:1)}}_r={count:Ar,texture:xs,size:new Vector2(Rn,qn)},St.set(tr,_r),tr.addEventListener("dispose",ks)}let Dr=0;for(let Br=0;Br<sr.length;Br++)Dr+=sr[Br];const $r=tr.morphTargetsRelative?1:1-Dr;rr.getUniforms().setValue(rt,"morphTargetBaseInfluence",$r),rr.getUniforms().setValue(rt,"morphTargetInfluences",sr),rr.getUniforms().setValue(rt,"morphTargetsTexture",_r.texture,ut),rr.getUniforms().setValue(rt,"morphTargetsTextureSize",_r.size)}else{const cr=sr===void 0?0:sr.length;let Ar=mt[tr.id];if(Ar===void 0||Ar.length!==cr){Ar=[];for(let Jr=0;Jr<cr;Jr++)Ar[Jr]=[Jr,0];mt[tr.id]=Ar}for(let Jr=0;Jr<cr;Jr++){const mn=Ar[Jr];mn[0]=Jr,mn[1]=sr[Jr]}Ar.sort(absNumericalSort);for(let Jr=0;Jr<8;Jr++)Jr<cr&&Ar[Jr][1]?(Bt[Jr][0]=Ar[Jr][0],Bt[Jr][1]=Ar[Jr][1]):(Bt[Jr][0]=Number.MAX_SAFE_INTEGER,Bt[Jr][1]=0);Bt.sort(numericalSort);const _r=tr.morphAttributes.position,Dr=tr.morphAttributes.normal;let $r=0;for(let Jr=0;Jr<8;Jr++){const mn=Bt[Jr],Mn=mn[0],$n=mn[1];Mn!==Number.MAX_SAFE_INTEGER&&$n?(_r&&tr.getAttribute("morphTarget"+Jr)!==_r[Mn]&&tr.setAttribute("morphTarget"+Jr,_r[Mn]),Dr&&tr.getAttribute("morphNormal"+Jr)!==Dr[Mn]&&tr.setAttribute("morphNormal"+Jr,Dr[Mn]),bt[Jr]=$n,$r+=$n):(_r&&tr.hasAttribute("morphTarget"+Jr)===!0&&tr.deleteAttribute("morphTarget"+Jr),Dr&&tr.hasAttribute("morphNormal"+Jr)===!0&&tr.deleteAttribute("morphNormal"+Jr),bt[Jr]=0)}const Br=tr.morphTargetsRelative?1:1-$r;rr.getUniforms().setValue(rt,"morphTargetBaseInfluence",Br),rr.getUniforms().setValue(rt,"morphTargetInfluences",bt)}}return{update:Ut}}function WebGLObjects(rt,_,ut,mt){let bt=new WeakMap;function St(Ut){const Ht=mt.render.frame,tr=Ut.geometry,rr=_.get(Ut,tr);return bt.get(rr)!==Ht&&(_.update(rr),bt.set(rr,Ht)),Ut.isInstancedMesh&&(Ut.hasEventListener("dispose",Bt)===!1&&Ut.addEventListener("dispose",Bt),ut.update(Ut.instanceMatrix,34962),Ut.instanceColor!==null&&ut.update(Ut.instanceColor,34962)),rr}function Mt(){bt=new WeakMap}function Bt(Ut){const Ht=Ut.target;Ht.removeEventListener("dispose",Bt),ut.remove(Ht.instanceMatrix),Ht.instanceColor!==null&&ut.remove(Ht.instanceColor)}return{update:St,dispose:Mt}}const emptyTexture=new Texture,emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten$1(rt,_,ut){const mt=rt[0];if(mt<=0||mt>0)return rt;const bt=_*ut;let St=arrayCacheF32[bt];if(St===void 0&&(St=new Float32Array(bt),arrayCacheF32[bt]=St),_!==0){mt.toArray(St,0);for(let Mt=1,Bt=0;Mt!==_;++Mt)Bt+=ut,rt[Mt].toArray(St,Bt)}return St}function arraysEqual(rt,_){if(rt.length!==_.length)return!1;for(let ut=0,mt=rt.length;ut<mt;ut++)if(rt[ut]!==_[ut])return!1;return!0}function copyArray(rt,_){for(let ut=0,mt=_.length;ut<mt;ut++)rt[ut]=_[ut]}function allocTexUnits(rt,_){let ut=arrayCacheI32[_];ut===void 0&&(ut=new Int32Array(_),arrayCacheI32[_]=ut);for(let mt=0;mt!==_;++mt)ut[mt]=rt.allocateTextureUnit();return ut}function setValueV1f(rt,_){const ut=this.cache;ut[0]!==_&&(rt.uniform1f(this.addr,_),ut[0]=_)}function setValueV2f(rt,_){const ut=this.cache;if(_.x!==void 0)(ut[0]!==_.x||ut[1]!==_.y)&&(rt.uniform2f(this.addr,_.x,_.y),ut[0]=_.x,ut[1]=_.y);else{if(arraysEqual(ut,_))return;rt.uniform2fv(this.addr,_),copyArray(ut,_)}}function setValueV3f(rt,_){const ut=this.cache;if(_.x!==void 0)(ut[0]!==_.x||ut[1]!==_.y||ut[2]!==_.z)&&(rt.uniform3f(this.addr,_.x,_.y,_.z),ut[0]=_.x,ut[1]=_.y,ut[2]=_.z);else if(_.r!==void 0)(ut[0]!==_.r||ut[1]!==_.g||ut[2]!==_.b)&&(rt.uniform3f(this.addr,_.r,_.g,_.b),ut[0]=_.r,ut[1]=_.g,ut[2]=_.b);else{if(arraysEqual(ut,_))return;rt.uniform3fv(this.addr,_),copyArray(ut,_)}}function setValueV4f(rt,_){const ut=this.cache;if(_.x!==void 0)(ut[0]!==_.x||ut[1]!==_.y||ut[2]!==_.z||ut[3]!==_.w)&&(rt.uniform4f(this.addr,_.x,_.y,_.z,_.w),ut[0]=_.x,ut[1]=_.y,ut[2]=_.z,ut[3]=_.w);else{if(arraysEqual(ut,_))return;rt.uniform4fv(this.addr,_),copyArray(ut,_)}}function setValueM2(rt,_){const ut=this.cache,mt=_.elements;if(mt===void 0){if(arraysEqual(ut,_))return;rt.uniformMatrix2fv(this.addr,!1,_),copyArray(ut,_)}else{if(arraysEqual(ut,mt))return;mat2array.set(mt),rt.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(ut,mt)}}function setValueM3(rt,_){const ut=this.cache,mt=_.elements;if(mt===void 0){if(arraysEqual(ut,_))return;rt.uniformMatrix3fv(this.addr,!1,_),copyArray(ut,_)}else{if(arraysEqual(ut,mt))return;mat3array.set(mt),rt.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(ut,mt)}}function setValueM4(rt,_){const ut=this.cache,mt=_.elements;if(mt===void 0){if(arraysEqual(ut,_))return;rt.uniformMatrix4fv(this.addr,!1,_),copyArray(ut,_)}else{if(arraysEqual(ut,mt))return;mat4array.set(mt),rt.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(ut,mt)}}function setValueV1i(rt,_){const ut=this.cache;ut[0]!==_&&(rt.uniform1i(this.addr,_),ut[0]=_)}function setValueV2i(rt,_){const ut=this.cache;if(_.x!==void 0)(ut[0]!==_.x||ut[1]!==_.y)&&(rt.uniform2i(this.addr,_.x,_.y),ut[0]=_.x,ut[1]=_.y);else{if(arraysEqual(ut,_))return;rt.uniform2iv(this.addr,_),copyArray(ut,_)}}function setValueV3i(rt,_){const ut=this.cache;if(_.x!==void 0)(ut[0]!==_.x||ut[1]!==_.y||ut[2]!==_.z)&&(rt.uniform3i(this.addr,_.x,_.y,_.z),ut[0]=_.x,ut[1]=_.y,ut[2]=_.z);else{if(arraysEqual(ut,_))return;rt.uniform3iv(this.addr,_),copyArray(ut,_)}}function setValueV4i(rt,_){const ut=this.cache;if(_.x!==void 0)(ut[0]!==_.x||ut[1]!==_.y||ut[2]!==_.z||ut[3]!==_.w)&&(rt.uniform4i(this.addr,_.x,_.y,_.z,_.w),ut[0]=_.x,ut[1]=_.y,ut[2]=_.z,ut[3]=_.w);else{if(arraysEqual(ut,_))return;rt.uniform4iv(this.addr,_),copyArray(ut,_)}}function setValueV1ui(rt,_){const ut=this.cache;ut[0]!==_&&(rt.uniform1ui(this.addr,_),ut[0]=_)}function setValueV2ui(rt,_){const ut=this.cache;if(_.x!==void 0)(ut[0]!==_.x||ut[1]!==_.y)&&(rt.uniform2ui(this.addr,_.x,_.y),ut[0]=_.x,ut[1]=_.y);else{if(arraysEqual(ut,_))return;rt.uniform2uiv(this.addr,_),copyArray(ut,_)}}function setValueV3ui(rt,_){const ut=this.cache;if(_.x!==void 0)(ut[0]!==_.x||ut[1]!==_.y||ut[2]!==_.z)&&(rt.uniform3ui(this.addr,_.x,_.y,_.z),ut[0]=_.x,ut[1]=_.y,ut[2]=_.z);else{if(arraysEqual(ut,_))return;rt.uniform3uiv(this.addr,_),copyArray(ut,_)}}function setValueV4ui(rt,_){const ut=this.cache;if(_.x!==void 0)(ut[0]!==_.x||ut[1]!==_.y||ut[2]!==_.z||ut[3]!==_.w)&&(rt.uniform4ui(this.addr,_.x,_.y,_.z,_.w),ut[0]=_.x,ut[1]=_.y,ut[2]=_.z,ut[3]=_.w);else{if(arraysEqual(ut,_))return;rt.uniform4uiv(this.addr,_),copyArray(ut,_)}}function setValueT1(rt,_,ut){const mt=this.cache,bt=ut.allocateTextureUnit();mt[0]!==bt&&(rt.uniform1i(this.addr,bt),mt[0]=bt),ut.setTexture2D(_||emptyTexture,bt)}function setValueT3D1(rt,_,ut){const mt=this.cache,bt=ut.allocateTextureUnit();mt[0]!==bt&&(rt.uniform1i(this.addr,bt),mt[0]=bt),ut.setTexture3D(_||empty3dTexture,bt)}function setValueT6(rt,_,ut){const mt=this.cache,bt=ut.allocateTextureUnit();mt[0]!==bt&&(rt.uniform1i(this.addr,bt),mt[0]=bt),ut.setTextureCube(_||emptyCubeTexture,bt)}function setValueT2DArray1(rt,_,ut){const mt=this.cache,bt=ut.allocateTextureUnit();mt[0]!==bt&&(rt.uniform1i(this.addr,bt),mt[0]=bt),ut.setTexture2DArray(_||emptyArrayTexture,bt)}function getSingularSetter(rt){switch(rt){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(rt,_){rt.uniform1fv(this.addr,_)}function setValueV2fArray(rt,_){const ut=flatten$1(_,this.size,2);rt.uniform2fv(this.addr,ut)}function setValueV3fArray(rt,_){const ut=flatten$1(_,this.size,3);rt.uniform3fv(this.addr,ut)}function setValueV4fArray(rt,_){const ut=flatten$1(_,this.size,4);rt.uniform4fv(this.addr,ut)}function setValueM2Array(rt,_){const ut=flatten$1(_,this.size,4);rt.uniformMatrix2fv(this.addr,!1,ut)}function setValueM3Array(rt,_){const ut=flatten$1(_,this.size,9);rt.uniformMatrix3fv(this.addr,!1,ut)}function setValueM4Array(rt,_){const ut=flatten$1(_,this.size,16);rt.uniformMatrix4fv(this.addr,!1,ut)}function setValueV1iArray(rt,_){rt.uniform1iv(this.addr,_)}function setValueV2iArray(rt,_){rt.uniform2iv(this.addr,_)}function setValueV3iArray(rt,_){rt.uniform3iv(this.addr,_)}function setValueV4iArray(rt,_){rt.uniform4iv(this.addr,_)}function setValueV1uiArray(rt,_){rt.uniform1uiv(this.addr,_)}function setValueV2uiArray(rt,_){rt.uniform2uiv(this.addr,_)}function setValueV3uiArray(rt,_){rt.uniform3uiv(this.addr,_)}function setValueV4uiArray(rt,_){rt.uniform4uiv(this.addr,_)}function setValueT1Array(rt,_,ut){const mt=this.cache,bt=_.length,St=allocTexUnits(ut,bt);arraysEqual(mt,St)||(rt.uniform1iv(this.addr,St),copyArray(mt,St));for(let Mt=0;Mt!==bt;++Mt)ut.setTexture2D(_[Mt]||emptyTexture,St[Mt])}function setValueT3DArray(rt,_,ut){const mt=this.cache,bt=_.length,St=allocTexUnits(ut,bt);arraysEqual(mt,St)||(rt.uniform1iv(this.addr,St),copyArray(mt,St));for(let Mt=0;Mt!==bt;++Mt)ut.setTexture3D(_[Mt]||empty3dTexture,St[Mt])}function setValueT6Array(rt,_,ut){const mt=this.cache,bt=_.length,St=allocTexUnits(ut,bt);arraysEqual(mt,St)||(rt.uniform1iv(this.addr,St),copyArray(mt,St));for(let Mt=0;Mt!==bt;++Mt)ut.setTextureCube(_[Mt]||emptyCubeTexture,St[Mt])}function setValueT2DArrayArray(rt,_,ut){const mt=this.cache,bt=_.length,St=allocTexUnits(ut,bt);arraysEqual(mt,St)||(rt.uniform1iv(this.addr,St),copyArray(mt,St));for(let Mt=0;Mt!==bt;++Mt)ut.setTexture2DArray(_[Mt]||emptyArrayTexture,St[Mt])}function getPureArraySetter(rt){switch(rt){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(_,ut,mt){this.id=_,this.addr=mt,this.cache=[],this.setValue=getSingularSetter(ut.type)}}class PureArrayUniform{constructor(_,ut,mt){this.id=_,this.addr=mt,this.cache=[],this.size=ut.size,this.setValue=getPureArraySetter(ut.type)}}class StructuredUniform{constructor(_){this.id=_,this.seq=[],this.map={}}setValue(_,ut,mt){const bt=this.seq;for(let St=0,Mt=bt.length;St!==Mt;++St){const Bt=bt[St];Bt.setValue(_,ut[Bt.id],mt)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(rt,_){rt.seq.push(_),rt.map[_.id]=_}function parseUniform(rt,_,ut){const mt=rt.name,bt=mt.length;for(RePathPart.lastIndex=0;;){const St=RePathPart.exec(mt),Mt=RePathPart.lastIndex;let Bt=St[1];const Ut=St[2]==="]",Ht=St[3];if(Ut&&(Bt=Bt|0),Ht===void 0||Ht==="["&&Mt+2===bt){addUniform(ut,Ht===void 0?new SingleUniform(Bt,rt,_):new PureArrayUniform(Bt,rt,_));break}else{let rr=ut.map[Bt];rr===void 0&&(rr=new StructuredUniform(Bt),addUniform(ut,rr)),ut=rr}}}class WebGLUniforms{constructor(_,ut){this.seq=[],this.map={};const mt=_.getProgramParameter(ut,35718);for(let bt=0;bt<mt;++bt){const St=_.getActiveUniform(ut,bt),Mt=_.getUniformLocation(ut,St.name);parseUniform(St,Mt,this)}}setValue(_,ut,mt,bt){const St=this.map[ut];St!==void 0&&St.setValue(_,mt,bt)}setOptional(_,ut,mt){const bt=ut[mt];bt!==void 0&&this.setValue(_,mt,bt)}static upload(_,ut,mt,bt){for(let St=0,Mt=ut.length;St!==Mt;++St){const Bt=ut[St],Ut=mt[Bt.id];Ut.needsUpdate!==!1&&Bt.setValue(_,Ut.value,bt)}}static seqWithValue(_,ut){const mt=[];for(let bt=0,St=_.length;bt!==St;++bt){const Mt=_[bt];Mt.id in ut&&mt.push(Mt)}return mt}}function WebGLShader(rt,_,ut){const mt=rt.createShader(_);return rt.shaderSource(mt,ut),rt.compileShader(mt),mt}let programIdCount=0;function handleSource(rt,_){const ut=rt.split(`
`),mt=[],bt=Math.max(_-6,0),St=Math.min(_+6,ut.length);for(let Mt=bt;Mt<St;Mt++){const Bt=Mt+1;mt.push(`${Bt===_?">":" "} ${Bt}: ${ut[Mt]}`)}return mt.join(`
`)}function getEncodingComponents(rt){switch(rt){case LinearEncoding$1:return["Linear","( value )"];case sRGBEncoding$1:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",rt),["Linear","( value )"]}}function getShaderErrors(rt,_,ut){const mt=rt.getShaderParameter(_,35713),bt=rt.getShaderInfoLog(_).trim();if(mt&&bt==="")return"";const St=/ERROR: 0:(\d+)/.exec(bt);if(St){const Mt=parseInt(St[1]);return ut.toUpperCase()+`

`+bt+`

`+handleSource(rt.getShaderSource(_),Mt)}else return bt}function getTexelEncodingFunction(rt,_){const ut=getEncodingComponents(_);return"vec4 "+rt+"( vec4 value ) { return LinearTo"+ut[0]+ut[1]+"; }"}function getToneMappingFunction(rt,_){let ut;switch(_){case LinearToneMapping:ut="Linear";break;case ReinhardToneMapping:ut="Reinhard";break;case CineonToneMapping:ut="OptimizedCineon";break;case ACESFilmicToneMapping:ut="ACESFilmic";break;case CustomToneMapping:ut="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",_),ut="Linear"}return"vec3 "+rt+"( vec3 color ) { return "+ut+"ToneMapping( color ); }"}function generateExtensions(rt){return[rt.extensionDerivatives||rt.envMapCubeUVHeight||rt.bumpMap||rt.tangentSpaceNormalMap||rt.clearcoatNormalMap||rt.flatShading||rt.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(rt.extensionFragDepth||rt.logarithmicDepthBuffer)&&rt.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",rt.extensionDrawBuffers&&rt.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(rt.extensionShaderTextureLOD||rt.envMap||rt.transmission)&&rt.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join(`
`)}function generateDefines(rt){const _=[];for(const ut in rt){const mt=rt[ut];mt!==!1&&_.push("#define "+ut+" "+mt)}return _.join(`
`)}function fetchAttributeLocations(rt,_){const ut={},mt=rt.getProgramParameter(_,35721);for(let bt=0;bt<mt;bt++){const St=rt.getActiveAttrib(_,bt),Mt=St.name;let Bt=1;St.type===35674&&(Bt=2),St.type===35675&&(Bt=3),St.type===35676&&(Bt=4),ut[Mt]={type:St.type,location:rt.getAttribLocation(_,Mt),locationSize:Bt}}return ut}function filterEmptyLine(rt){return rt!==""}function replaceLightNums(rt,_){const ut=_.numSpotLightShadows+_.numSpotLightMaps-_.numSpotLightShadowsWithMaps;return rt.replace(/NUM_DIR_LIGHTS/g,_.numDirLights).replace(/NUM_SPOT_LIGHTS/g,_.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,_.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,ut).replace(/NUM_RECT_AREA_LIGHTS/g,_.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,_.numPointLights).replace(/NUM_HEMI_LIGHTS/g,_.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,_.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,_.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,_.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,_.numPointLightShadows)}function replaceClippingPlaneNums(rt,_){return rt.replace(/NUM_CLIPPING_PLANES/g,_.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,_.numClippingPlanes-_.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(rt){return rt.replace(includePattern,includeReplacer)}function includeReplacer(rt,_){const ut=ShaderChunk[_];if(ut===void 0)throw new Error("Can not resolve #include <"+_+">");return resolveIncludes(ut)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(rt){return rt.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(rt,_,ut,mt){let bt="";for(let St=parseInt(_);St<parseInt(ut);St++)bt+=mt.replace(/\[\s*i\s*\]/g,"[ "+St+" ]").replace(/UNROLLED_LOOP_INDEX/g,St);return bt}function generatePrecision(rt){let _="precision "+rt.precision+` float;
precision `+rt.precision+" int;";return rt.precision==="highp"?_+=`
#define HIGH_PRECISION`:rt.precision==="mediump"?_+=`
#define MEDIUM_PRECISION`:rt.precision==="lowp"&&(_+=`
#define LOW_PRECISION`),_}function generateShadowMapTypeDefine(rt){let _="SHADOWMAP_TYPE_BASIC";return rt.shadowMapType===PCFShadowMap?_="SHADOWMAP_TYPE_PCF":rt.shadowMapType===PCFSoftShadowMap?_="SHADOWMAP_TYPE_PCF_SOFT":rt.shadowMapType===VSMShadowMap&&(_="SHADOWMAP_TYPE_VSM"),_}function generateEnvMapTypeDefine(rt){let _="ENVMAP_TYPE_CUBE";if(rt.envMap)switch(rt.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:_="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:_="ENVMAP_TYPE_CUBE_UV";break}return _}function generateEnvMapModeDefine(rt){let _="ENVMAP_MODE_REFLECTION";if(rt.envMap)switch(rt.envMapMode){case CubeRefractionMapping:_="ENVMAP_MODE_REFRACTION";break}return _}function generateEnvMapBlendingDefine(rt){let _="ENVMAP_BLENDING_NONE";if(rt.envMap)switch(rt.combine){case MultiplyOperation:_="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:_="ENVMAP_BLENDING_MIX";break;case AddOperation:_="ENVMAP_BLENDING_ADD";break}return _}function generateCubeUVSize(rt){const _=rt.envMapCubeUVHeight;if(_===null)return null;const ut=Math.log2(_)-2,mt=1/_;return{texelWidth:1/(3*Math.max(Math.pow(2,ut),7*16)),texelHeight:mt,maxMip:ut}}function WebGLProgram(rt,_,ut,mt){const bt=rt.getContext(),St=ut.defines;let Mt=ut.vertexShader,Bt=ut.fragmentShader;const Ut=generateShadowMapTypeDefine(ut),Ht=generateEnvMapTypeDefine(ut),tr=generateEnvMapModeDefine(ut),rr=generateEnvMapBlendingDefine(ut),sr=generateCubeUVSize(ut),ar=ut.isWebGL2?"":generateExtensions(ut),cr=generateDefines(St),Ar=bt.createProgram();let _r,Dr,$r=ut.glslVersion?"#version "+ut.glslVersion+`
`:"";ut.isRawShaderMaterial?(_r=[cr].filter(filterEmptyLine).join(`
`),_r.length>0&&(_r+=`
`),Dr=[ar,cr].filter(filterEmptyLine).join(`
`),Dr.length>0&&(Dr+=`
`)):(_r=[generatePrecision(ut),"#define SHADER_NAME "+ut.shaderName,cr,ut.instancing?"#define USE_INSTANCING":"",ut.instancingColor?"#define USE_INSTANCING_COLOR":"",ut.supportsVertexTextures?"#define VERTEX_TEXTURES":"",ut.useFog&&ut.fog?"#define USE_FOG":"",ut.useFog&&ut.fogExp2?"#define FOG_EXP2":"",ut.map?"#define USE_MAP":"",ut.envMap?"#define USE_ENVMAP":"",ut.envMap?"#define "+tr:"",ut.lightMap?"#define USE_LIGHTMAP":"",ut.aoMap?"#define USE_AOMAP":"",ut.emissiveMap?"#define USE_EMISSIVEMAP":"",ut.bumpMap?"#define USE_BUMPMAP":"",ut.normalMap?"#define USE_NORMALMAP":"",ut.normalMap&&ut.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",ut.normalMap&&ut.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",ut.clearcoatMap?"#define USE_CLEARCOATMAP":"",ut.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",ut.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",ut.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",ut.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",ut.displacementMap&&ut.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",ut.specularMap?"#define USE_SPECULARMAP":"",ut.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",ut.specularColorMap?"#define USE_SPECULARCOLORMAP":"",ut.roughnessMap?"#define USE_ROUGHNESSMAP":"",ut.metalnessMap?"#define USE_METALNESSMAP":"",ut.alphaMap?"#define USE_ALPHAMAP":"",ut.transmission?"#define USE_TRANSMISSION":"",ut.transmissionMap?"#define USE_TRANSMISSIONMAP":"",ut.thicknessMap?"#define USE_THICKNESSMAP":"",ut.sheenColorMap?"#define USE_SHEENCOLORMAP":"",ut.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",ut.vertexTangents?"#define USE_TANGENT":"",ut.vertexColors?"#define USE_COLOR":"",ut.vertexAlphas?"#define USE_COLOR_ALPHA":"",ut.vertexUvs?"#define USE_UV":"",ut.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",ut.flatShading?"#define FLAT_SHADED":"",ut.skinning?"#define USE_SKINNING":"",ut.morphTargets?"#define USE_MORPHTARGETS":"",ut.morphNormals&&ut.flatShading===!1?"#define USE_MORPHNORMALS":"",ut.morphColors&&ut.isWebGL2?"#define USE_MORPHCOLORS":"",ut.morphTargetsCount>0&&ut.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",ut.morphTargetsCount>0&&ut.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+ut.morphTextureStride:"",ut.morphTargetsCount>0&&ut.isWebGL2?"#define MORPHTARGETS_COUNT "+ut.morphTargetsCount:"",ut.doubleSided?"#define DOUBLE_SIDED":"",ut.flipSided?"#define FLIP_SIDED":"",ut.shadowMapEnabled?"#define USE_SHADOWMAP":"",ut.shadowMapEnabled?"#define "+Ut:"",ut.sizeAttenuation?"#define USE_SIZEATTENUATION":"",ut.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",ut.logarithmicDepthBuffer&&ut.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),Dr=[ar,generatePrecision(ut),"#define SHADER_NAME "+ut.shaderName,cr,ut.useFog&&ut.fog?"#define USE_FOG":"",ut.useFog&&ut.fogExp2?"#define FOG_EXP2":"",ut.map?"#define USE_MAP":"",ut.matcap?"#define USE_MATCAP":"",ut.envMap?"#define USE_ENVMAP":"",ut.envMap?"#define "+Ht:"",ut.envMap?"#define "+tr:"",ut.envMap?"#define "+rr:"",sr?"#define CUBEUV_TEXEL_WIDTH "+sr.texelWidth:"",sr?"#define CUBEUV_TEXEL_HEIGHT "+sr.texelHeight:"",sr?"#define CUBEUV_MAX_MIP "+sr.maxMip+".0":"",ut.lightMap?"#define USE_LIGHTMAP":"",ut.aoMap?"#define USE_AOMAP":"",ut.emissiveMap?"#define USE_EMISSIVEMAP":"",ut.bumpMap?"#define USE_BUMPMAP":"",ut.normalMap?"#define USE_NORMALMAP":"",ut.normalMap&&ut.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",ut.normalMap&&ut.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",ut.clearcoat?"#define USE_CLEARCOAT":"",ut.clearcoatMap?"#define USE_CLEARCOATMAP":"",ut.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",ut.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",ut.iridescence?"#define USE_IRIDESCENCE":"",ut.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",ut.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",ut.specularMap?"#define USE_SPECULARMAP":"",ut.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",ut.specularColorMap?"#define USE_SPECULARCOLORMAP":"",ut.roughnessMap?"#define USE_ROUGHNESSMAP":"",ut.metalnessMap?"#define USE_METALNESSMAP":"",ut.alphaMap?"#define USE_ALPHAMAP":"",ut.alphaTest?"#define USE_ALPHATEST":"",ut.sheen?"#define USE_SHEEN":"",ut.sheenColorMap?"#define USE_SHEENCOLORMAP":"",ut.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",ut.transmission?"#define USE_TRANSMISSION":"",ut.transmissionMap?"#define USE_TRANSMISSIONMAP":"",ut.thicknessMap?"#define USE_THICKNESSMAP":"",ut.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",ut.vertexTangents?"#define USE_TANGENT":"",ut.vertexColors||ut.instancingColor?"#define USE_COLOR":"",ut.vertexAlphas?"#define USE_COLOR_ALPHA":"",ut.vertexUvs?"#define USE_UV":"",ut.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",ut.gradientMap?"#define USE_GRADIENTMAP":"",ut.flatShading?"#define FLAT_SHADED":"",ut.doubleSided?"#define DOUBLE_SIDED":"",ut.flipSided?"#define FLIP_SIDED":"",ut.shadowMapEnabled?"#define USE_SHADOWMAP":"",ut.shadowMapEnabled?"#define "+Ut:"",ut.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",ut.useLegacyLights?"#define LEGACY_LIGHTS":"",ut.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",ut.logarithmicDepthBuffer&&ut.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",ut.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",ut.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",ut.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",ut.toneMapping):"",ut.dithering?"#define DITHERING":"",ut.opaque?"#define OPAQUE":"",ShaderChunk.encodings_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",ut.outputEncoding),ut.useDepthPacking?"#define DEPTH_PACKING "+ut.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),Mt=resolveIncludes(Mt),Mt=replaceLightNums(Mt,ut),Mt=replaceClippingPlaneNums(Mt,ut),Bt=resolveIncludes(Bt),Bt=replaceLightNums(Bt,ut),Bt=replaceClippingPlaneNums(Bt,ut),Mt=unrollLoops(Mt),Bt=unrollLoops(Bt),ut.isWebGL2&&ut.isRawShaderMaterial!==!0&&($r=`#version 300 es
`,_r=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+_r,Dr=["#define varying in",ut.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",ut.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+Dr);const Br=$r+_r+Mt,Jr=$r+Dr+Bt,mn=WebGLShader(bt,35633,Br),Mn=WebGLShader(bt,35632,Jr);if(bt.attachShader(Ar,mn),bt.attachShader(Ar,Mn),ut.index0AttributeName!==void 0?bt.bindAttribLocation(Ar,0,ut.index0AttributeName):ut.morphTargets===!0&&bt.bindAttribLocation(Ar,0,"position"),bt.linkProgram(Ar),rt.debug.checkShaderErrors){const In=bt.getProgramInfoLog(Ar).trim(),Rn=bt.getShaderInfoLog(mn).trim(),qn=bt.getShaderInfoLog(Mn).trim();let Qn=!0,xs=!0;if(bt.getProgramParameter(Ar,35714)===!1){Qn=!1;const cs=getShaderErrors(bt,mn,"vertex"),ks=getShaderErrors(bt,Mn,"fragment");console.error("THREE.WebGLProgram: Shader Error "+bt.getError()+" - VALIDATE_STATUS "+bt.getProgramParameter(Ar,35715)+`

Program Info Log: `+In+`
`+cs+`
`+ks)}else In!==""?console.warn("THREE.WebGLProgram: Program Info Log:",In):(Rn===""||qn==="")&&(xs=!1);xs&&(this.diagnostics={runnable:Qn,programLog:In,vertexShader:{log:Rn,prefix:_r},fragmentShader:{log:qn,prefix:Dr}})}bt.deleteShader(mn),bt.deleteShader(Mn);let $n;this.getUniforms=function(){return $n===void 0&&($n=new WebGLUniforms(bt,Ar)),$n};let en;return this.getAttributes=function(){return en===void 0&&(en=fetchAttributeLocations(bt,Ar)),en},this.destroy=function(){mt.releaseStatesOfProgram(this),bt.deleteProgram(Ar),this.program=void 0},this.name=ut.shaderName,this.id=programIdCount++,this.cacheKey=_,this.usedTimes=1,this.program=Ar,this.vertexShader=mn,this.fragmentShader=Mn,this}let _id=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(_){const ut=_.vertexShader,mt=_.fragmentShader,bt=this._getShaderStage(ut),St=this._getShaderStage(mt),Mt=this._getShaderCacheForMaterial(_);return Mt.has(bt)===!1&&(Mt.add(bt),bt.usedTimes++),Mt.has(St)===!1&&(Mt.add(St),St.usedTimes++),this}remove(_){const ut=this.materialCache.get(_);for(const mt of ut)mt.usedTimes--,mt.usedTimes===0&&this.shaderCache.delete(mt.code);return this.materialCache.delete(_),this}getVertexShaderID(_){return this._getShaderStage(_.vertexShader).id}getFragmentShaderID(_){return this._getShaderStage(_.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(_){const ut=this.materialCache;let mt=ut.get(_);return mt===void 0&&(mt=new Set,ut.set(_,mt)),mt}_getShaderStage(_){const ut=this.shaderCache;let mt=ut.get(_);return mt===void 0&&(mt=new WebGLShaderStage(_),ut.set(_,mt)),mt}}class WebGLShaderStage{constructor(_){this.id=_id++,this.code=_,this.usedTimes=0}}function WebGLPrograms(rt,_,ut,mt,bt,St,Mt){const Bt=new Layers,Ut=new WebGLShaderCache,Ht=[],tr=bt.isWebGL2,rr=bt.logarithmicDepthBuffer,sr=bt.vertexTextures;let ar=bt.precision;const cr={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function Ar(en,In,Rn,qn,Qn){const xs=qn.fog,cs=Qn.geometry,ks=en.isMeshStandardMaterial?qn.environment:null,_o=(en.isMeshStandardMaterial?ut:_).get(en.envMap||ks),qs=_o&&_o.mapping===CubeUVReflectionMapping?_o.image.height:null,Ss=cr[en.type];en.precision!==null&&(ar=bt.getMaxPrecision(en.precision),ar!==en.precision&&console.warn("THREE.WebGLProgram.getParameters:",en.precision,"not supported, using",ar,"instead."));const eo=cs.morphAttributes.position||cs.morphAttributes.normal||cs.morphAttributes.color,Ao=eo!==void 0?eo.length:0;let Oo=0;cs.morphAttributes.position!==void 0&&(Oo=1),cs.morphAttributes.normal!==void 0&&(Oo=2),cs.morphAttributes.color!==void 0&&(Oo=3);let uo,uu,cu,Jl;if(Ss){const Ep=ShaderLib[Ss];uo=Ep.vertexShader,uu=Ep.fragmentShader}else uo=en.vertexShader,uu=en.fragmentShader,Ut.update(en),cu=Ut.getVertexShaderID(en),Jl=Ut.getFragmentShaderID(en);const mu=rt.getRenderTarget(),pu=en.alphaTest>0,Zu=en.clearcoat>0,Mp=en.iridescence>0;return{isWebGL2:tr,shaderID:Ss,shaderName:en.type,vertexShader:uo,fragmentShader:uu,defines:en.defines,customVertexShaderID:cu,customFragmentShaderID:Jl,isRawShaderMaterial:en.isRawShaderMaterial===!0,glslVersion:en.glslVersion,precision:ar,instancing:Qn.isInstancedMesh===!0,instancingColor:Qn.isInstancedMesh===!0&&Qn.instanceColor!==null,supportsVertexTextures:sr,outputEncoding:mu===null?rt.outputEncoding:mu.isXRRenderTarget===!0?mu.texture.encoding:LinearEncoding$1,map:!!en.map,matcap:!!en.matcap,envMap:!!_o,envMapMode:_o&&_o.mapping,envMapCubeUVHeight:qs,lightMap:!!en.lightMap,aoMap:!!en.aoMap,emissiveMap:!!en.emissiveMap,bumpMap:!!en.bumpMap,normalMap:!!en.normalMap,objectSpaceNormalMap:en.normalMapType===ObjectSpaceNormalMap,tangentSpaceNormalMap:en.normalMapType===TangentSpaceNormalMap,decodeVideoTexture:!!en.map&&en.map.isVideoTexture===!0&&en.map.encoding===sRGBEncoding$1,clearcoat:Zu,clearcoatMap:Zu&&!!en.clearcoatMap,clearcoatRoughnessMap:Zu&&!!en.clearcoatRoughnessMap,clearcoatNormalMap:Zu&&!!en.clearcoatNormalMap,iridescence:Mp,iridescenceMap:Mp&&!!en.iridescenceMap,iridescenceThicknessMap:Mp&&!!en.iridescenceThicknessMap,displacementMap:!!en.displacementMap,roughnessMap:!!en.roughnessMap,metalnessMap:!!en.metalnessMap,specularMap:!!en.specularMap,specularIntensityMap:!!en.specularIntensityMap,specularColorMap:!!en.specularColorMap,opaque:en.transparent===!1&&en.blending===NormalBlending,alphaMap:!!en.alphaMap,alphaTest:pu,gradientMap:!!en.gradientMap,sheen:en.sheen>0,sheenColorMap:!!en.sheenColorMap,sheenRoughnessMap:!!en.sheenRoughnessMap,transmission:en.transmission>0,transmissionMap:!!en.transmissionMap,thicknessMap:!!en.thicknessMap,combine:en.combine,vertexTangents:!!en.normalMap&&!!cs.attributes.tangent,vertexColors:en.vertexColors,vertexAlphas:en.vertexColors===!0&&!!cs.attributes.color&&cs.attributes.color.itemSize===4,vertexUvs:!!en.map||!!en.bumpMap||!!en.normalMap||!!en.specularMap||!!en.alphaMap||!!en.emissiveMap||!!en.roughnessMap||!!en.metalnessMap||!!en.clearcoatMap||!!en.clearcoatRoughnessMap||!!en.clearcoatNormalMap||!!en.iridescenceMap||!!en.iridescenceThicknessMap||!!en.displacementMap||!!en.transmissionMap||!!en.thicknessMap||!!en.specularIntensityMap||!!en.specularColorMap||!!en.sheenColorMap||!!en.sheenRoughnessMap,uvsVertexOnly:!(en.map||en.bumpMap||en.normalMap||en.specularMap||en.alphaMap||en.emissiveMap||en.roughnessMap||en.metalnessMap||en.clearcoatNormalMap||en.iridescenceMap||en.iridescenceThicknessMap||en.transmission>0||en.transmissionMap||en.thicknessMap||en.specularIntensityMap||en.specularColorMap||en.sheen>0||en.sheenColorMap||en.sheenRoughnessMap)&&!!en.displacementMap,fog:!!xs,useFog:en.fog===!0,fogExp2:xs&&xs.isFogExp2,flatShading:!!en.flatShading,sizeAttenuation:en.sizeAttenuation,logarithmicDepthBuffer:rr,skinning:Qn.isSkinnedMesh===!0,morphTargets:cs.morphAttributes.position!==void 0,morphNormals:cs.morphAttributes.normal!==void 0,morphColors:cs.morphAttributes.color!==void 0,morphTargetsCount:Ao,morphTextureStride:Oo,numDirLights:In.directional.length,numPointLights:In.point.length,numSpotLights:In.spot.length,numSpotLightMaps:In.spotLightMap.length,numRectAreaLights:In.rectArea.length,numHemiLights:In.hemi.length,numDirLightShadows:In.directionalShadowMap.length,numPointLightShadows:In.pointShadowMap.length,numSpotLightShadows:In.spotShadowMap.length,numSpotLightShadowsWithMaps:In.numSpotLightShadowsWithMaps,numClippingPlanes:Mt.numPlanes,numClipIntersection:Mt.numIntersection,dithering:en.dithering,shadowMapEnabled:rt.shadowMap.enabled&&Rn.length>0,shadowMapType:rt.shadowMap.type,toneMapping:en.toneMapped?rt.toneMapping:NoToneMapping,useLegacyLights:rt.useLegacyLights,premultipliedAlpha:en.premultipliedAlpha,doubleSided:en.side===DoubleSide,flipSided:en.side===BackSide,useDepthPacking:!!en.depthPacking,depthPacking:en.depthPacking||0,index0AttributeName:en.index0AttributeName,extensionDerivatives:en.extensions&&en.extensions.derivatives,extensionFragDepth:en.extensions&&en.extensions.fragDepth,extensionDrawBuffers:en.extensions&&en.extensions.drawBuffers,extensionShaderTextureLOD:en.extensions&&en.extensions.shaderTextureLOD,rendererExtensionFragDepth:tr||mt.has("EXT_frag_depth"),rendererExtensionDrawBuffers:tr||mt.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:tr||mt.has("EXT_shader_texture_lod"),customProgramCacheKey:en.customProgramCacheKey()}}function _r(en){const In=[];if(en.shaderID?In.push(en.shaderID):(In.push(en.customVertexShaderID),In.push(en.customFragmentShaderID)),en.defines!==void 0)for(const Rn in en.defines)In.push(Rn),In.push(en.defines[Rn]);return en.isRawShaderMaterial===!1&&(Dr(In,en),$r(In,en),In.push(rt.outputEncoding)),In.push(en.customProgramCacheKey),In.join()}function Dr(en,In){en.push(In.precision),en.push(In.outputEncoding),en.push(In.envMapMode),en.push(In.envMapCubeUVHeight),en.push(In.combine),en.push(In.vertexUvs),en.push(In.fogExp2),en.push(In.sizeAttenuation),en.push(In.morphTargetsCount),en.push(In.morphAttributeCount),en.push(In.numDirLights),en.push(In.numPointLights),en.push(In.numSpotLights),en.push(In.numSpotLightMaps),en.push(In.numHemiLights),en.push(In.numRectAreaLights),en.push(In.numDirLightShadows),en.push(In.numPointLightShadows),en.push(In.numSpotLightShadows),en.push(In.numSpotLightShadowsWithMaps),en.push(In.shadowMapType),en.push(In.toneMapping),en.push(In.numClippingPlanes),en.push(In.numClipIntersection),en.push(In.depthPacking)}function $r(en,In){Bt.disableAll(),In.isWebGL2&&Bt.enable(0),In.supportsVertexTextures&&Bt.enable(1),In.instancing&&Bt.enable(2),In.instancingColor&&Bt.enable(3),In.map&&Bt.enable(4),In.matcap&&Bt.enable(5),In.envMap&&Bt.enable(6),In.lightMap&&Bt.enable(7),In.aoMap&&Bt.enable(8),In.emissiveMap&&Bt.enable(9),In.bumpMap&&Bt.enable(10),In.normalMap&&Bt.enable(11),In.objectSpaceNormalMap&&Bt.enable(12),In.tangentSpaceNormalMap&&Bt.enable(13),In.clearcoat&&Bt.enable(14),In.clearcoatMap&&Bt.enable(15),In.clearcoatRoughnessMap&&Bt.enable(16),In.clearcoatNormalMap&&Bt.enable(17),In.iridescence&&Bt.enable(18),In.iridescenceMap&&Bt.enable(19),In.iridescenceThicknessMap&&Bt.enable(20),In.displacementMap&&Bt.enable(21),In.specularMap&&Bt.enable(22),In.roughnessMap&&Bt.enable(23),In.metalnessMap&&Bt.enable(24),In.gradientMap&&Bt.enable(25),In.alphaMap&&Bt.enable(26),In.alphaTest&&Bt.enable(27),In.vertexColors&&Bt.enable(28),In.vertexAlphas&&Bt.enable(29),In.vertexUvs&&Bt.enable(30),In.vertexTangents&&Bt.enable(31),In.uvsVertexOnly&&Bt.enable(32),en.push(Bt.mask),Bt.disableAll(),In.fog&&Bt.enable(0),In.useFog&&Bt.enable(1),In.flatShading&&Bt.enable(2),In.logarithmicDepthBuffer&&Bt.enable(3),In.skinning&&Bt.enable(4),In.morphTargets&&Bt.enable(5),In.morphNormals&&Bt.enable(6),In.morphColors&&Bt.enable(7),In.premultipliedAlpha&&Bt.enable(8),In.shadowMapEnabled&&Bt.enable(9),In.useLegacyLights&&Bt.enable(10),In.doubleSided&&Bt.enable(11),In.flipSided&&Bt.enable(12),In.useDepthPacking&&Bt.enable(13),In.dithering&&Bt.enable(14),In.specularIntensityMap&&Bt.enable(15),In.specularColorMap&&Bt.enable(16),In.transmission&&Bt.enable(17),In.transmissionMap&&Bt.enable(18),In.thicknessMap&&Bt.enable(19),In.sheen&&Bt.enable(20),In.sheenColorMap&&Bt.enable(21),In.sheenRoughnessMap&&Bt.enable(22),In.decodeVideoTexture&&Bt.enable(23),In.opaque&&Bt.enable(24),en.push(Bt.mask)}function Br(en){const In=cr[en.type];let Rn;if(In){const qn=ShaderLib[In];Rn=UniformsUtils.clone(qn.uniforms)}else Rn=en.uniforms;return Rn}function Jr(en,In){let Rn;for(let qn=0,Qn=Ht.length;qn<Qn;qn++){const xs=Ht[qn];if(xs.cacheKey===In){Rn=xs,++Rn.usedTimes;break}}return Rn===void 0&&(Rn=new WebGLProgram(rt,In,en,St),Ht.push(Rn)),Rn}function mn(en){if(--en.usedTimes===0){const In=Ht.indexOf(en);Ht[In]=Ht[Ht.length-1],Ht.pop(),en.destroy()}}function Mn(en){Ut.remove(en)}function $n(){Ut.dispose()}return{getParameters:Ar,getProgramCacheKey:_r,getUniforms:Br,acquireProgram:Jr,releaseProgram:mn,releaseShaderCache:Mn,programs:Ht,dispose:$n}}function WebGLProperties(){let rt=new WeakMap;function _(St){let Mt=rt.get(St);return Mt===void 0&&(Mt={},rt.set(St,Mt)),Mt}function ut(St){rt.delete(St)}function mt(St,Mt,Bt){rt.get(St)[Mt]=Bt}function bt(){rt=new WeakMap}return{get:_,remove:ut,update:mt,dispose:bt}}function painterSortStable(rt,_){return rt.groupOrder!==_.groupOrder?rt.groupOrder-_.groupOrder:rt.renderOrder!==_.renderOrder?rt.renderOrder-_.renderOrder:rt.material.id!==_.material.id?rt.material.id-_.material.id:rt.z!==_.z?rt.z-_.z:rt.id-_.id}function reversePainterSortStable(rt,_){return rt.groupOrder!==_.groupOrder?rt.groupOrder-_.groupOrder:rt.renderOrder!==_.renderOrder?rt.renderOrder-_.renderOrder:rt.z!==_.z?_.z-rt.z:rt.id-_.id}function WebGLRenderList(){const rt=[];let _=0;const ut=[],mt=[],bt=[];function St(){_=0,ut.length=0,mt.length=0,bt.length=0}function Mt(rr,sr,ar,cr,Ar,_r){let Dr=rt[_];return Dr===void 0?(Dr={id:rr.id,object:rr,geometry:sr,material:ar,groupOrder:cr,renderOrder:rr.renderOrder,z:Ar,group:_r},rt[_]=Dr):(Dr.id=rr.id,Dr.object=rr,Dr.geometry=sr,Dr.material=ar,Dr.groupOrder=cr,Dr.renderOrder=rr.renderOrder,Dr.z=Ar,Dr.group=_r),_++,Dr}function Bt(rr,sr,ar,cr,Ar,_r){const Dr=Mt(rr,sr,ar,cr,Ar,_r);ar.transmission>0?mt.push(Dr):ar.transparent===!0?bt.push(Dr):ut.push(Dr)}function Ut(rr,sr,ar,cr,Ar,_r){const Dr=Mt(rr,sr,ar,cr,Ar,_r);ar.transmission>0?mt.unshift(Dr):ar.transparent===!0?bt.unshift(Dr):ut.unshift(Dr)}function Ht(rr,sr){ut.length>1&&ut.sort(rr||painterSortStable),mt.length>1&&mt.sort(sr||reversePainterSortStable),bt.length>1&&bt.sort(sr||reversePainterSortStable)}function tr(){for(let rr=_,sr=rt.length;rr<sr;rr++){const ar=rt[rr];if(ar.id===null)break;ar.id=null,ar.object=null,ar.geometry=null,ar.material=null,ar.group=null}}return{opaque:ut,transmissive:mt,transparent:bt,init:St,push:Bt,unshift:Ut,finish:tr,sort:Ht}}function WebGLRenderLists(){let rt=new WeakMap;function _(mt,bt){const St=rt.get(mt);let Mt;return St===void 0?(Mt=new WebGLRenderList,rt.set(mt,[Mt])):bt>=St.length?(Mt=new WebGLRenderList,St.push(Mt)):Mt=St[bt],Mt}function ut(){rt=new WeakMap}return{get:_,dispose:ut}}function UniformsCache(){const rt={};return{get:function(_){if(rt[_.id]!==void 0)return rt[_.id];let ut;switch(_.type){case"DirectionalLight":ut={direction:new Vector3,color:new Color$1};break;case"SpotLight":ut={position:new Vector3,direction:new Vector3,color:new Color$1,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":ut={position:new Vector3,color:new Color$1,distance:0,decay:0};break;case"HemisphereLight":ut={direction:new Vector3,skyColor:new Color$1,groundColor:new Color$1};break;case"RectAreaLight":ut={color:new Color$1,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return rt[_.id]=ut,ut}}}function ShadowUniformsCache(){const rt={};return{get:function(_){if(rt[_.id]!==void 0)return rt[_.id];let ut;switch(_.type){case"DirectionalLight":ut={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":ut={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":ut={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return rt[_.id]=ut,ut}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(rt,_){return(_.castShadow?2:0)-(rt.castShadow?2:0)+(_.map?1:0)-(rt.map?1:0)}function WebGLLights(rt,_){const ut=new UniformsCache,mt=ShadowUniformsCache(),bt={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let tr=0;tr<9;tr++)bt.probe.push(new Vector3);const St=new Vector3,Mt=new Matrix4,Bt=new Matrix4;function Ut(tr,rr){let sr=0,ar=0,cr=0;for(let qn=0;qn<9;qn++)bt.probe[qn].set(0,0,0);let Ar=0,_r=0,Dr=0,$r=0,Br=0,Jr=0,mn=0,Mn=0,$n=0,en=0;tr.sort(shadowCastingAndTexturingLightsFirst);const In=rr===!0?Math.PI:1;for(let qn=0,Qn=tr.length;qn<Qn;qn++){const xs=tr[qn],cs=xs.color,ks=xs.intensity,_o=xs.distance,qs=xs.shadow&&xs.shadow.map?xs.shadow.map.texture:null;if(xs.isAmbientLight)sr+=cs.r*ks*In,ar+=cs.g*ks*In,cr+=cs.b*ks*In;else if(xs.isLightProbe)for(let Ss=0;Ss<9;Ss++)bt.probe[Ss].addScaledVector(xs.sh.coefficients[Ss],ks);else if(xs.isDirectionalLight){const Ss=ut.get(xs);if(Ss.color.copy(xs.color).multiplyScalar(xs.intensity*In),xs.castShadow){const eo=xs.shadow,Ao=mt.get(xs);Ao.shadowBias=eo.bias,Ao.shadowNormalBias=eo.normalBias,Ao.shadowRadius=eo.radius,Ao.shadowMapSize=eo.mapSize,bt.directionalShadow[Ar]=Ao,bt.directionalShadowMap[Ar]=qs,bt.directionalShadowMatrix[Ar]=xs.shadow.matrix,Jr++}bt.directional[Ar]=Ss,Ar++}else if(xs.isSpotLight){const Ss=ut.get(xs);Ss.position.setFromMatrixPosition(xs.matrixWorld),Ss.color.copy(cs).multiplyScalar(ks*In),Ss.distance=_o,Ss.coneCos=Math.cos(xs.angle),Ss.penumbraCos=Math.cos(xs.angle*(1-xs.penumbra)),Ss.decay=xs.decay,bt.spot[Dr]=Ss;const eo=xs.shadow;if(xs.map&&(bt.spotLightMap[$n]=xs.map,$n++,eo.updateMatrices(xs),xs.castShadow&&en++),bt.spotLightMatrix[Dr]=eo.matrix,xs.castShadow){const Ao=mt.get(xs);Ao.shadowBias=eo.bias,Ao.shadowNormalBias=eo.normalBias,Ao.shadowRadius=eo.radius,Ao.shadowMapSize=eo.mapSize,bt.spotShadow[Dr]=Ao,bt.spotShadowMap[Dr]=qs,Mn++}Dr++}else if(xs.isRectAreaLight){const Ss=ut.get(xs);Ss.color.copy(cs).multiplyScalar(ks),Ss.halfWidth.set(xs.width*.5,0,0),Ss.halfHeight.set(0,xs.height*.5,0),bt.rectArea[$r]=Ss,$r++}else if(xs.isPointLight){const Ss=ut.get(xs);if(Ss.color.copy(xs.color).multiplyScalar(xs.intensity*In),Ss.distance=xs.distance,Ss.decay=xs.decay,xs.castShadow){const eo=xs.shadow,Ao=mt.get(xs);Ao.shadowBias=eo.bias,Ao.shadowNormalBias=eo.normalBias,Ao.shadowRadius=eo.radius,Ao.shadowMapSize=eo.mapSize,Ao.shadowCameraNear=eo.camera.near,Ao.shadowCameraFar=eo.camera.far,bt.pointShadow[_r]=Ao,bt.pointShadowMap[_r]=qs,bt.pointShadowMatrix[_r]=xs.shadow.matrix,mn++}bt.point[_r]=Ss,_r++}else if(xs.isHemisphereLight){const Ss=ut.get(xs);Ss.skyColor.copy(xs.color).multiplyScalar(ks*In),Ss.groundColor.copy(xs.groundColor).multiplyScalar(ks*In),bt.hemi[Br]=Ss,Br++}}$r>0&&(_.isWebGL2||rt.has("OES_texture_float_linear")===!0?(bt.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,bt.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):rt.has("OES_texture_half_float_linear")===!0?(bt.rectAreaLTC1=UniformsLib.LTC_HALF_1,bt.rectAreaLTC2=UniformsLib.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),bt.ambient[0]=sr,bt.ambient[1]=ar,bt.ambient[2]=cr;const Rn=bt.hash;(Rn.directionalLength!==Ar||Rn.pointLength!==_r||Rn.spotLength!==Dr||Rn.rectAreaLength!==$r||Rn.hemiLength!==Br||Rn.numDirectionalShadows!==Jr||Rn.numPointShadows!==mn||Rn.numSpotShadows!==Mn||Rn.numSpotMaps!==$n)&&(bt.directional.length=Ar,bt.spot.length=Dr,bt.rectArea.length=$r,bt.point.length=_r,bt.hemi.length=Br,bt.directionalShadow.length=Jr,bt.directionalShadowMap.length=Jr,bt.pointShadow.length=mn,bt.pointShadowMap.length=mn,bt.spotShadow.length=Mn,bt.spotShadowMap.length=Mn,bt.directionalShadowMatrix.length=Jr,bt.pointShadowMatrix.length=mn,bt.spotLightMatrix.length=Mn+$n-en,bt.spotLightMap.length=$n,bt.numSpotLightShadowsWithMaps=en,Rn.directionalLength=Ar,Rn.pointLength=_r,Rn.spotLength=Dr,Rn.rectAreaLength=$r,Rn.hemiLength=Br,Rn.numDirectionalShadows=Jr,Rn.numPointShadows=mn,Rn.numSpotShadows=Mn,Rn.numSpotMaps=$n,bt.version=nextVersion++)}function Ht(tr,rr){let sr=0,ar=0,cr=0,Ar=0,_r=0;const Dr=rr.matrixWorldInverse;for(let $r=0,Br=tr.length;$r<Br;$r++){const Jr=tr[$r];if(Jr.isDirectionalLight){const mn=bt.directional[sr];mn.direction.setFromMatrixPosition(Jr.matrixWorld),St.setFromMatrixPosition(Jr.target.matrixWorld),mn.direction.sub(St),mn.direction.transformDirection(Dr),sr++}else if(Jr.isSpotLight){const mn=bt.spot[cr];mn.position.setFromMatrixPosition(Jr.matrixWorld),mn.position.applyMatrix4(Dr),mn.direction.setFromMatrixPosition(Jr.matrixWorld),St.setFromMatrixPosition(Jr.target.matrixWorld),mn.direction.sub(St),mn.direction.transformDirection(Dr),cr++}else if(Jr.isRectAreaLight){const mn=bt.rectArea[Ar];mn.position.setFromMatrixPosition(Jr.matrixWorld),mn.position.applyMatrix4(Dr),Bt.identity(),Mt.copy(Jr.matrixWorld),Mt.premultiply(Dr),Bt.extractRotation(Mt),mn.halfWidth.set(Jr.width*.5,0,0),mn.halfHeight.set(0,Jr.height*.5,0),mn.halfWidth.applyMatrix4(Bt),mn.halfHeight.applyMatrix4(Bt),Ar++}else if(Jr.isPointLight){const mn=bt.point[ar];mn.position.setFromMatrixPosition(Jr.matrixWorld),mn.position.applyMatrix4(Dr),ar++}else if(Jr.isHemisphereLight){const mn=bt.hemi[_r];mn.direction.setFromMatrixPosition(Jr.matrixWorld),mn.direction.transformDirection(Dr),_r++}}}return{setup:Ut,setupView:Ht,state:bt}}function WebGLRenderState(rt,_){const ut=new WebGLLights(rt,_),mt=[],bt=[];function St(){mt.length=0,bt.length=0}function Mt(rr){mt.push(rr)}function Bt(rr){bt.push(rr)}function Ut(rr){ut.setup(mt,rr)}function Ht(rr){ut.setupView(mt,rr)}return{init:St,state:{lightsArray:mt,shadowsArray:bt,lights:ut},setupLights:Ut,setupLightsView:Ht,pushLight:Mt,pushShadow:Bt}}function WebGLRenderStates(rt,_){let ut=new WeakMap;function mt(St,Mt=0){const Bt=ut.get(St);let Ut;return Bt===void 0?(Ut=new WebGLRenderState(rt,_),ut.set(St,[Ut])):Mt>=Bt.length?(Ut=new WebGLRenderState(rt,_),Bt.push(Ut)):Ut=Bt[Mt],Ut}function bt(){ut=new WeakMap}return{get:mt,dispose:bt}}class MeshDepthMaterial extends Material{constructor(_){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(_)}copy(_){return super.copy(_),this.depthPacking=_.depthPacking,this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material{constructor(_){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Vector3,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(_)}copy(_){return super.copy(_),this.referencePosition.copy(_.referencePosition),this.nearDistance=_.nearDistance,this.farDistance=_.farDistance,this.map=_.map,this.alphaMap=_.alphaMap,this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(rt,_,ut){let mt=new Frustum;const bt=new Vector2,St=new Vector2,Mt=new Vector4,Bt=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),Ut=new MeshDistanceMaterial,Ht={},tr=ut.maxTextureSize,rr={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},sr=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),ar=sr.clone();ar.defines.HORIZONTAL_PASS=1;const cr=new BufferGeometry;cr.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const Ar=new Mesh(cr,sr),_r=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap,this.render=function(Jr,mn,Mn){if(_r.enabled===!1||_r.autoUpdate===!1&&_r.needsUpdate===!1||Jr.length===0)return;const $n=rt.getRenderTarget(),en=rt.getActiveCubeFace(),In=rt.getActiveMipmapLevel(),Rn=rt.state;Rn.setBlending(NoBlending),Rn.buffers.color.setClear(1,1,1,1),Rn.buffers.depth.setTest(!0),Rn.setScissorTest(!1);for(let qn=0,Qn=Jr.length;qn<Qn;qn++){const xs=Jr[qn],cs=xs.shadow;if(cs===void 0){console.warn("THREE.WebGLShadowMap:",xs,"has no shadow.");continue}if(cs.autoUpdate===!1&&cs.needsUpdate===!1)continue;bt.copy(cs.mapSize);const ks=cs.getFrameExtents();if(bt.multiply(ks),St.copy(cs.mapSize),(bt.x>tr||bt.y>tr)&&(bt.x>tr&&(St.x=Math.floor(tr/ks.x),bt.x=St.x*ks.x,cs.mapSize.x=St.x),bt.y>tr&&(St.y=Math.floor(tr/ks.y),bt.y=St.y*ks.y,cs.mapSize.y=St.y)),cs.map===null){const qs=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};cs.map=new WebGLRenderTarget(bt.x,bt.y,qs),cs.map.texture.name=xs.name+".shadowMap",cs.camera.updateProjectionMatrix()}rt.setRenderTarget(cs.map),rt.clear();const _o=cs.getViewportCount();for(let qs=0;qs<_o;qs++){const Ss=cs.getViewport(qs);Mt.set(St.x*Ss.x,St.y*Ss.y,St.x*Ss.z,St.y*Ss.w),Rn.viewport(Mt),cs.updateMatrices(xs,qs),mt=cs.getFrustum(),Br(mn,Mn,cs.camera,xs,this.type)}cs.isPointLightShadow!==!0&&this.type===VSMShadowMap&&Dr(cs,Mn),cs.needsUpdate=!1}_r.needsUpdate=!1,rt.setRenderTarget($n,en,In)};function Dr(Jr,mn){const Mn=_.update(Ar);sr.defines.VSM_SAMPLES!==Jr.blurSamples&&(sr.defines.VSM_SAMPLES=Jr.blurSamples,ar.defines.VSM_SAMPLES=Jr.blurSamples,sr.needsUpdate=!0,ar.needsUpdate=!0),Jr.mapPass===null&&(Jr.mapPass=new WebGLRenderTarget(bt.x,bt.y)),sr.uniforms.shadow_pass.value=Jr.map.texture,sr.uniforms.resolution.value=Jr.mapSize,sr.uniforms.radius.value=Jr.radius,rt.setRenderTarget(Jr.mapPass),rt.clear(),rt.renderBufferDirect(mn,null,Mn,sr,Ar,null),ar.uniforms.shadow_pass.value=Jr.mapPass.texture,ar.uniforms.resolution.value=Jr.mapSize,ar.uniforms.radius.value=Jr.radius,rt.setRenderTarget(Jr.map),rt.clear(),rt.renderBufferDirect(mn,null,Mn,ar,Ar,null)}function $r(Jr,mn,Mn,$n,en,In){let Rn=null;const qn=Mn.isPointLight===!0?Jr.customDistanceMaterial:Jr.customDepthMaterial;if(qn!==void 0)Rn=qn;else if(Rn=Mn.isPointLight===!0?Ut:Bt,rt.localClippingEnabled&&mn.clipShadows===!0&&Array.isArray(mn.clippingPlanes)&&mn.clippingPlanes.length!==0||mn.displacementMap&&mn.displacementScale!==0||mn.alphaMap&&mn.alphaTest>0||mn.map&&mn.alphaTest>0){const Qn=Rn.uuid,xs=mn.uuid;let cs=Ht[Qn];cs===void 0&&(cs={},Ht[Qn]=cs);let ks=cs[xs];ks===void 0&&(ks=Rn.clone(),cs[xs]=ks),Rn=ks}return Rn.visible=mn.visible,Rn.wireframe=mn.wireframe,In===VSMShadowMap?Rn.side=mn.shadowSide!==null?mn.shadowSide:mn.side:Rn.side=mn.shadowSide!==null?mn.shadowSide:rr[mn.side],Rn.alphaMap=mn.alphaMap,Rn.alphaTest=mn.alphaTest,Rn.map=mn.map,Rn.clipShadows=mn.clipShadows,Rn.clippingPlanes=mn.clippingPlanes,Rn.clipIntersection=mn.clipIntersection,Rn.displacementMap=mn.displacementMap,Rn.displacementScale=mn.displacementScale,Rn.displacementBias=mn.displacementBias,Rn.wireframeLinewidth=mn.wireframeLinewidth,Rn.linewidth=mn.linewidth,Mn.isPointLight===!0&&Rn.isMeshDistanceMaterial===!0&&(Rn.referencePosition.setFromMatrixPosition(Mn.matrixWorld),Rn.nearDistance=$n,Rn.farDistance=en),Rn}function Br(Jr,mn,Mn,$n,en){if(Jr.visible===!1)return;if(Jr.layers.test(mn.layers)&&(Jr.isMesh||Jr.isLine||Jr.isPoints)&&(Jr.castShadow||Jr.receiveShadow&&en===VSMShadowMap)&&(!Jr.frustumCulled||mt.intersectsObject(Jr))){Jr.modelViewMatrix.multiplyMatrices(Mn.matrixWorldInverse,Jr.matrixWorld);const qn=_.update(Jr),Qn=Jr.material;if(Array.isArray(Qn)){const xs=qn.groups;for(let cs=0,ks=xs.length;cs<ks;cs++){const _o=xs[cs],qs=Qn[_o.materialIndex];if(qs&&qs.visible){const Ss=$r(Jr,qs,$n,Mn.near,Mn.far,en);rt.renderBufferDirect(Mn,null,qn,Ss,Jr,_o)}}}else if(Qn.visible){const xs=$r(Jr,Qn,$n,Mn.near,Mn.far,en);rt.renderBufferDirect(Mn,null,qn,xs,Jr,null)}}const Rn=Jr.children;for(let qn=0,Qn=Rn.length;qn<Qn;qn++)Br(Rn[qn],mn,Mn,$n,en)}}function WebGLState(rt,_,ut){const mt=ut.isWebGL2;function bt(){let jp=!1;const Fp=new Vector4;let nv=null;const qy=new Vector4(0,0,0,0);return{setMask:function(Uy){nv!==Uy&&!jp&&(rt.colorMask(Uy,Uy,Uy,Uy),nv=Uy)},setLocked:function(Uy){jp=Uy},setClear:function(Uy,vx,qx,Kx,Mx){Mx===!0&&(Uy*=Kx,vx*=Kx,qx*=Kx),Fp.set(Uy,vx,qx,Kx),qy.equals(Fp)===!1&&(rt.clearColor(Uy,vx,qx,Kx),qy.copy(Fp))},reset:function(){jp=!1,nv=null,qy.set(-1,0,0,0)}}}function St(){let jp=!1,Fp=null,nv=null,qy=null;return{setTest:function(Uy){Uy?pu(2929):Zu(2929)},setMask:function(Uy){Fp!==Uy&&!jp&&(rt.depthMask(Uy),Fp=Uy)},setFunc:function(Uy){if(nv!==Uy){switch(Uy){case NeverDepth:rt.depthFunc(512);break;case AlwaysDepth:rt.depthFunc(519);break;case LessDepth:rt.depthFunc(513);break;case LessEqualDepth:rt.depthFunc(515);break;case EqualDepth:rt.depthFunc(514);break;case GreaterEqualDepth:rt.depthFunc(518);break;case GreaterDepth:rt.depthFunc(516);break;case NotEqualDepth:rt.depthFunc(517);break;default:rt.depthFunc(515)}nv=Uy}},setLocked:function(Uy){jp=Uy},setClear:function(Uy){qy!==Uy&&(rt.clearDepth(Uy),qy=Uy)},reset:function(){jp=!1,Fp=null,nv=null,qy=null}}}function Mt(){let jp=!1,Fp=null,nv=null,qy=null,Uy=null,vx=null,qx=null,Kx=null,Mx=null;return{setTest:function(Ox){jp||(Ox?pu(2960):Zu(2960))},setMask:function(Ox){Fp!==Ox&&!jp&&(rt.stencilMask(Ox),Fp=Ox)},setFunc:function(Ox,E2,$2){(nv!==Ox||qy!==E2||Uy!==$2)&&(rt.stencilFunc(Ox,E2,$2),nv=Ox,qy=E2,Uy=$2)},setOp:function(Ox,E2,$2){(vx!==Ox||qx!==E2||Kx!==$2)&&(rt.stencilOp(Ox,E2,$2),vx=Ox,qx=E2,Kx=$2)},setLocked:function(Ox){jp=Ox},setClear:function(Ox){Mx!==Ox&&(rt.clearStencil(Ox),Mx=Ox)},reset:function(){jp=!1,Fp=null,nv=null,qy=null,Uy=null,vx=null,qx=null,Kx=null,Mx=null}}}const Bt=new bt,Ut=new St,Ht=new Mt,tr=new WeakMap,rr=new WeakMap;let sr={},ar={},cr=new WeakMap,Ar=[],_r=null,Dr=!1,$r=null,Br=null,Jr=null,mn=null,Mn=null,$n=null,en=null,In=!1,Rn=null,qn=null,Qn=null,xs=null,cs=null;const ks=rt.getParameter(35661);let _o=!1,qs=0;const Ss=rt.getParameter(7938);Ss.indexOf("WebGL")!==-1?(qs=parseFloat(/^WebGL (\d)/.exec(Ss)[1]),_o=qs>=1):Ss.indexOf("OpenGL ES")!==-1&&(qs=parseFloat(/^OpenGL ES (\d)/.exec(Ss)[1]),_o=qs>=2);let eo=null,Ao={};const Oo=rt.getParameter(3088),uo=rt.getParameter(2978),uu=new Vector4().fromArray(Oo),cu=new Vector4().fromArray(uo);function Jl(jp,Fp,nv){const qy=new Uint8Array(4),Uy=rt.createTexture();rt.bindTexture(jp,Uy),rt.texParameteri(jp,10241,9728),rt.texParameteri(jp,10240,9728);for(let vx=0;vx<nv;vx++)rt.texImage2D(Fp+vx,0,6408,1,1,0,6408,5121,qy);return Uy}const mu={};mu[3553]=Jl(3553,3553,1),mu[34067]=Jl(34067,34069,6),Bt.setClear(0,0,0,1),Ut.setClear(1),Ht.setClear(0),pu(2929),Ut.setFunc(LessEqualDepth),m0(!1),K0(CullFaceBack),pu(2884),t0(NoBlending);function pu(jp){sr[jp]!==!0&&(rt.enable(jp),sr[jp]=!0)}function Zu(jp){sr[jp]!==!1&&(rt.disable(jp),sr[jp]=!1)}function Mp(jp,Fp){return ar[jp]!==Fp?(rt.bindFramebuffer(jp,Fp),ar[jp]=Fp,mt&&(jp===36009&&(ar[36160]=Fp),jp===36160&&(ar[36009]=Fp)),!0):!1}function Up(jp,Fp){let nv=Ar,qy=!1;if(jp)if(nv=cr.get(Fp),nv===void 0&&(nv=[],cr.set(Fp,nv)),jp.isWebGLMultipleRenderTargets){const Uy=jp.texture;if(nv.length!==Uy.length||nv[0]!==36064){for(let vx=0,qx=Uy.length;vx<qx;vx++)nv[vx]=36064+vx;nv.length=Uy.length,qy=!0}}else nv[0]!==36064&&(nv[0]=36064,qy=!0);else nv[0]!==1029&&(nv[0]=1029,qy=!0);qy&&(ut.isWebGL2?rt.drawBuffers(nv):_.get("WEBGL_draw_buffers").drawBuffersWEBGL(nv))}function Ep(jp){return _r!==jp?(rt.useProgram(jp),_r=jp,!0):!1}const mp={[AddEquation]:32774,[SubtractEquation]:32778,[ReverseSubtractEquation]:32779};if(mt)mp[MinEquation]=32775,mp[MaxEquation]=32776;else{const jp=_.get("EXT_blend_minmax");jp!==null&&(mp[MinEquation]=jp.MIN_EXT,mp[MaxEquation]=jp.MAX_EXT)}const Cp={[ZeroFactor]:0,[OneFactor]:1,[SrcColorFactor]:768,[SrcAlphaFactor]:770,[SrcAlphaSaturateFactor]:776,[DstColorFactor]:774,[DstAlphaFactor]:772,[OneMinusSrcColorFactor]:769,[OneMinusSrcAlphaFactor]:771,[OneMinusDstColorFactor]:775,[OneMinusDstAlphaFactor]:773};function t0(jp,Fp,nv,qy,Uy,vx,qx,Kx){if(jp===NoBlending){Dr===!0&&(Zu(3042),Dr=!1);return}if(Dr===!1&&(pu(3042),Dr=!0),jp!==CustomBlending){if(jp!==$r||Kx!==In){if((Br!==AddEquation||Mn!==AddEquation)&&(rt.blendEquation(32774),Br=AddEquation,Mn=AddEquation),Kx)switch(jp){case NormalBlending:rt.blendFuncSeparate(1,771,1,771);break;case AdditiveBlending:rt.blendFunc(1,1);break;case SubtractiveBlending:rt.blendFuncSeparate(0,769,0,1);break;case MultiplyBlending:rt.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",jp);break}else switch(jp){case NormalBlending:rt.blendFuncSeparate(770,771,1,771);break;case AdditiveBlending:rt.blendFunc(770,1);break;case SubtractiveBlending:rt.blendFuncSeparate(0,769,0,1);break;case MultiplyBlending:rt.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",jp);break}Jr=null,mn=null,$n=null,en=null,$r=jp,In=Kx}return}Uy=Uy||Fp,vx=vx||nv,qx=qx||qy,(Fp!==Br||Uy!==Mn)&&(rt.blendEquationSeparate(mp[Fp],mp[Uy]),Br=Fp,Mn=Uy),(nv!==Jr||qy!==mn||vx!==$n||qx!==en)&&(rt.blendFuncSeparate(Cp[nv],Cp[qy],Cp[vx],Cp[qx]),Jr=nv,mn=qy,$n=vx,en=qx),$r=jp,In=!1}function _g(jp,Fp){jp.side===DoubleSide?Zu(2884):pu(2884);let nv=jp.side===BackSide;Fp&&(nv=!nv),m0(nv),jp.blending===NormalBlending&&jp.transparent===!1?t0(NoBlending):t0(jp.blending,jp.blendEquation,jp.blendSrc,jp.blendDst,jp.blendEquationAlpha,jp.blendSrcAlpha,jp.blendDstAlpha,jp.premultipliedAlpha),Ut.setFunc(jp.depthFunc),Ut.setTest(jp.depthTest),Ut.setMask(jp.depthWrite),Bt.setMask(jp.colorWrite);const qy=jp.stencilWrite;Ht.setTest(qy),qy&&(Ht.setMask(jp.stencilWriteMask),Ht.setFunc(jp.stencilFunc,jp.stencilRef,jp.stencilFuncMask),Ht.setOp(jp.stencilFail,jp.stencilZFail,jp.stencilZPass)),y0(jp.polygonOffset,jp.polygonOffsetFactor,jp.polygonOffsetUnits),jp.alphaToCoverage===!0?pu(32926):Zu(32926)}function m0(jp){Rn!==jp&&(jp?rt.frontFace(2304):rt.frontFace(2305),Rn=jp)}function K0(jp){jp!==CullFaceNone?(pu(2884),jp!==qn&&(jp===CullFaceBack?rt.cullFace(1029):jp===CullFaceFront?rt.cullFace(1028):rt.cullFace(1032))):Zu(2884),qn=jp}function Jp(jp){jp!==Qn&&(_o&&rt.lineWidth(jp),Qn=jp)}function y0(jp,Fp,nv){jp?(pu(32823),(xs!==Fp||cs!==nv)&&(rt.polygonOffset(Fp,nv),xs=Fp,cs=nv)):Zu(32823)}function z0(jp){jp?pu(3089):Zu(3089)}function jm(jp){jp===void 0&&(jp=33984+ks-1),eo!==jp&&(rt.activeTexture(jp),eo=jp)}function Nu(jp,Fp,nv){nv===void 0&&(eo===null?nv=33984+ks-1:nv=eo);let qy=Ao[nv];qy===void 0&&(qy={type:void 0,texture:void 0},Ao[nv]=qy),(qy.type!==jp||qy.texture!==Fp)&&(eo!==nv&&(rt.activeTexture(nv),eo=nv),rt.bindTexture(jp,Fp||mu[jp]),qy.type=jp,qy.texture=Fp)}function Co(){const jp=Ao[eo];jp!==void 0&&jp.type!==void 0&&(rt.bindTexture(jp.type,null),jp.type=void 0,jp.texture=void 0)}function Bp(){try{rt.compressedTexImage2D.apply(rt,arguments)}catch(jp){console.error("THREE.WebGLState:",jp)}}function a0(){try{rt.compressedTexImage3D.apply(rt,arguments)}catch(jp){console.error("THREE.WebGLState:",jp)}}function Q0(){try{rt.texSubImage2D.apply(rt,arguments)}catch(jp){console.error("THREE.WebGLState:",jp)}}function T0(){try{rt.texSubImage3D.apply(rt,arguments)}catch(jp){console.error("THREE.WebGLState:",jp)}}function av(){try{rt.compressedTexSubImage2D.apply(rt,arguments)}catch(jp){console.error("THREE.WebGLState:",jp)}}function lv(){try{rt.compressedTexSubImage3D.apply(rt,arguments)}catch(jp){console.error("THREE.WebGLState:",jp)}}function N0(){try{rt.texStorage2D.apply(rt,arguments)}catch(jp){console.error("THREE.WebGLState:",jp)}}function zv(){try{rt.texStorage3D.apply(rt,arguments)}catch(jp){console.error("THREE.WebGLState:",jp)}}function Uv(){try{rt.texImage2D.apply(rt,arguments)}catch(jp){console.error("THREE.WebGLState:",jp)}}function Gv(){try{rt.texImage3D.apply(rt,arguments)}catch(jp){console.error("THREE.WebGLState:",jp)}}function Dv(jp){uu.equals(jp)===!1&&(rt.scissor(jp.x,jp.y,jp.z,jp.w),uu.copy(jp))}function Cv(jp){cu.equals(jp)===!1&&(rt.viewport(jp.x,jp.y,jp.z,jp.w),cu.copy(jp))}function Kp(jp,Fp){let nv=rr.get(Fp);nv===void 0&&(nv=new WeakMap,rr.set(Fp,nv));let qy=nv.get(jp);qy===void 0&&(qy=rt.getUniformBlockIndex(Fp,jp.name),nv.set(jp,qy))}function sv(jp,Fp){const qy=rr.get(Fp).get(jp);tr.get(Fp)!==qy&&(rt.uniformBlockBinding(Fp,qy,jp.__bindingPointIndex),tr.set(Fp,qy))}function Hv(){rt.disable(3042),rt.disable(2884),rt.disable(2929),rt.disable(32823),rt.disable(3089),rt.disable(2960),rt.disable(32926),rt.blendEquation(32774),rt.blendFunc(1,0),rt.blendFuncSeparate(1,0,1,0),rt.colorMask(!0,!0,!0,!0),rt.clearColor(0,0,0,0),rt.depthMask(!0),rt.depthFunc(513),rt.clearDepth(1),rt.stencilMask(4294967295),rt.stencilFunc(519,0,4294967295),rt.stencilOp(7680,7680,7680),rt.clearStencil(0),rt.cullFace(1029),rt.frontFace(2305),rt.polygonOffset(0,0),rt.activeTexture(33984),rt.bindFramebuffer(36160,null),mt===!0&&(rt.bindFramebuffer(36009,null),rt.bindFramebuffer(36008,null)),rt.useProgram(null),rt.lineWidth(1),rt.scissor(0,0,rt.canvas.width,rt.canvas.height),rt.viewport(0,0,rt.canvas.width,rt.canvas.height),sr={},eo=null,Ao={},ar={},cr=new WeakMap,Ar=[],_r=null,Dr=!1,$r=null,Br=null,Jr=null,mn=null,Mn=null,$n=null,en=null,In=!1,Rn=null,qn=null,Qn=null,xs=null,cs=null,uu.set(0,0,rt.canvas.width,rt.canvas.height),cu.set(0,0,rt.canvas.width,rt.canvas.height),Bt.reset(),Ut.reset(),Ht.reset()}return{buffers:{color:Bt,depth:Ut,stencil:Ht},enable:pu,disable:Zu,bindFramebuffer:Mp,drawBuffers:Up,useProgram:Ep,setBlending:t0,setMaterial:_g,setFlipSided:m0,setCullFace:K0,setLineWidth:Jp,setPolygonOffset:y0,setScissorTest:z0,activeTexture:jm,bindTexture:Nu,unbindTexture:Co,compressedTexImage2D:Bp,compressedTexImage3D:a0,texImage2D:Uv,texImage3D:Gv,updateUBOMapping:Kp,uniformBlockBinding:sv,texStorage2D:N0,texStorage3D:zv,texSubImage2D:Q0,texSubImage3D:T0,compressedTexSubImage2D:av,compressedTexSubImage3D:lv,scissor:Dv,viewport:Cv,reset:Hv}}function WebGLTextures(rt,_,ut,mt,bt,St,Mt){const Bt=bt.isWebGL2,Ut=bt.maxTextures,Ht=bt.maxCubemapSize,tr=bt.maxTextureSize,rr=bt.maxSamples,sr=_.has("WEBGL_multisampled_render_to_texture")?_.get("WEBGL_multisampled_render_to_texture"):null,ar=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),cr=new WeakMap;let Ar;const _r=new WeakMap;let Dr=!1;try{Dr=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function $r(Nu,Co){return Dr?new OffscreenCanvas(Nu,Co):createElementNS("canvas")}function Br(Nu,Co,Bp,a0){let Q0=1;if((Nu.width>a0||Nu.height>a0)&&(Q0=a0/Math.max(Nu.width,Nu.height)),Q0<1||Co===!0)if(typeof HTMLImageElement<"u"&&Nu instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Nu instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Nu instanceof ImageBitmap){const T0=Co?floorPowerOfTwo:Math.floor,av=T0(Q0*Nu.width),lv=T0(Q0*Nu.height);Ar===void 0&&(Ar=$r(av,lv));const N0=Bp?$r(av,lv):Ar;return N0.width=av,N0.height=lv,N0.getContext("2d").drawImage(Nu,0,0,av,lv),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Nu.width+"x"+Nu.height+") to ("+av+"x"+lv+")."),N0}else return"data"in Nu&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Nu.width+"x"+Nu.height+")."),Nu;return Nu}function Jr(Nu){return isPowerOfTwo(Nu.width)&&isPowerOfTwo(Nu.height)}function mn(Nu){return Bt?!1:Nu.wrapS!==ClampToEdgeWrapping||Nu.wrapT!==ClampToEdgeWrapping||Nu.minFilter!==NearestFilter&&Nu.minFilter!==LinearFilter}function Mn(Nu,Co){return Nu.generateMipmaps&&Co&&Nu.minFilter!==NearestFilter&&Nu.minFilter!==LinearFilter}function $n(Nu){rt.generateMipmap(Nu)}function en(Nu,Co,Bp,a0,Q0=!1){if(Bt===!1)return Co;if(Nu!==null){if(rt[Nu]!==void 0)return rt[Nu];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Nu+"'")}let T0=Co;return Co===6403&&(Bp===5126&&(T0=33326),Bp===5131&&(T0=33325),Bp===5121&&(T0=33321)),Co===33319&&(Bp===5126&&(T0=33328),Bp===5131&&(T0=33327),Bp===5121&&(T0=33323)),Co===6408&&(Bp===5126&&(T0=34836),Bp===5131&&(T0=34842),Bp===5121&&(T0=a0===sRGBEncoding$1&&Q0===!1?35907:32856),Bp===32819&&(T0=32854),Bp===32820&&(T0=32855)),(T0===33325||T0===33326||T0===33327||T0===33328||T0===34842||T0===34836)&&_.get("EXT_color_buffer_float"),T0}function In(Nu,Co,Bp){return Mn(Nu,Bp)===!0||Nu.isFramebufferTexture&&Nu.minFilter!==NearestFilter&&Nu.minFilter!==LinearFilter?Math.log2(Math.max(Co.width,Co.height))+1:Nu.mipmaps!==void 0&&Nu.mipmaps.length>0?Nu.mipmaps.length:Nu.isCompressedTexture&&Array.isArray(Nu.image)?Co.mipmaps.length:1}function Rn(Nu){return Nu===NearestFilter||Nu===NearestMipmapNearestFilter||Nu===NearestMipmapLinearFilter?9728:9729}function qn(Nu){const Co=Nu.target;Co.removeEventListener("dispose",qn),xs(Co),Co.isVideoTexture&&cr.delete(Co)}function Qn(Nu){const Co=Nu.target;Co.removeEventListener("dispose",Qn),ks(Co)}function xs(Nu){const Co=mt.get(Nu);if(Co.__webglInit===void 0)return;const Bp=Nu.source,a0=_r.get(Bp);if(a0){const Q0=a0[Co.__cacheKey];Q0.usedTimes--,Q0.usedTimes===0&&cs(Nu),Object.keys(a0).length===0&&_r.delete(Bp)}mt.remove(Nu)}function cs(Nu){const Co=mt.get(Nu);rt.deleteTexture(Co.__webglTexture);const Bp=Nu.source,a0=_r.get(Bp);delete a0[Co.__cacheKey],Mt.memory.textures--}function ks(Nu){const Co=Nu.texture,Bp=mt.get(Nu),a0=mt.get(Co);if(a0.__webglTexture!==void 0&&(rt.deleteTexture(a0.__webglTexture),Mt.memory.textures--),Nu.depthTexture&&Nu.depthTexture.dispose(),Nu.isWebGLCubeRenderTarget)for(let Q0=0;Q0<6;Q0++)rt.deleteFramebuffer(Bp.__webglFramebuffer[Q0]),Bp.__webglDepthbuffer&&rt.deleteRenderbuffer(Bp.__webglDepthbuffer[Q0]);else{if(rt.deleteFramebuffer(Bp.__webglFramebuffer),Bp.__webglDepthbuffer&&rt.deleteRenderbuffer(Bp.__webglDepthbuffer),Bp.__webglMultisampledFramebuffer&&rt.deleteFramebuffer(Bp.__webglMultisampledFramebuffer),Bp.__webglColorRenderbuffer)for(let Q0=0;Q0<Bp.__webglColorRenderbuffer.length;Q0++)Bp.__webglColorRenderbuffer[Q0]&&rt.deleteRenderbuffer(Bp.__webglColorRenderbuffer[Q0]);Bp.__webglDepthRenderbuffer&&rt.deleteRenderbuffer(Bp.__webglDepthRenderbuffer)}if(Nu.isWebGLMultipleRenderTargets)for(let Q0=0,T0=Co.length;Q0<T0;Q0++){const av=mt.get(Co[Q0]);av.__webglTexture&&(rt.deleteTexture(av.__webglTexture),Mt.memory.textures--),mt.remove(Co[Q0])}mt.remove(Co),mt.remove(Nu)}let _o=0;function qs(){_o=0}function Ss(){const Nu=_o;return Nu>=Ut&&console.warn("THREE.WebGLTextures: Trying to use "+Nu+" texture units while this GPU supports only "+Ut),_o+=1,Nu}function eo(Nu){const Co=[];return Co.push(Nu.wrapS),Co.push(Nu.wrapT),Co.push(Nu.wrapR||0),Co.push(Nu.magFilter),Co.push(Nu.minFilter),Co.push(Nu.anisotropy),Co.push(Nu.internalFormat),Co.push(Nu.format),Co.push(Nu.type),Co.push(Nu.generateMipmaps),Co.push(Nu.premultiplyAlpha),Co.push(Nu.flipY),Co.push(Nu.unpackAlignment),Co.push(Nu.encoding),Co.join()}function Ao(Nu,Co){const Bp=mt.get(Nu);if(Nu.isVideoTexture&&z0(Nu),Nu.isRenderTargetTexture===!1&&Nu.version>0&&Bp.__version!==Nu.version){const a0=Nu.image;if(a0===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(a0.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Zu(Bp,Nu,Co);return}}ut.bindTexture(3553,Bp.__webglTexture,33984+Co)}function Oo(Nu,Co){const Bp=mt.get(Nu);if(Nu.version>0&&Bp.__version!==Nu.version){Zu(Bp,Nu,Co);return}ut.bindTexture(35866,Bp.__webglTexture,33984+Co)}function uo(Nu,Co){const Bp=mt.get(Nu);if(Nu.version>0&&Bp.__version!==Nu.version){Zu(Bp,Nu,Co);return}ut.bindTexture(32879,Bp.__webglTexture,33984+Co)}function uu(Nu,Co){const Bp=mt.get(Nu);if(Nu.version>0&&Bp.__version!==Nu.version){Mp(Bp,Nu,Co);return}ut.bindTexture(34067,Bp.__webglTexture,33984+Co)}const cu={[RepeatWrapping]:10497,[ClampToEdgeWrapping]:33071,[MirroredRepeatWrapping]:33648},Jl={[NearestFilter]:9728,[NearestMipmapNearestFilter]:9984,[NearestMipmapLinearFilter]:9986,[LinearFilter]:9729,[LinearMipmapNearestFilter]:9985,[LinearMipmapLinearFilter]:9987};function mu(Nu,Co,Bp){if(Bp?(rt.texParameteri(Nu,10242,cu[Co.wrapS]),rt.texParameteri(Nu,10243,cu[Co.wrapT]),(Nu===32879||Nu===35866)&&rt.texParameteri(Nu,32882,cu[Co.wrapR]),rt.texParameteri(Nu,10240,Jl[Co.magFilter]),rt.texParameteri(Nu,10241,Jl[Co.minFilter])):(rt.texParameteri(Nu,10242,33071),rt.texParameteri(Nu,10243,33071),(Nu===32879||Nu===35866)&&rt.texParameteri(Nu,32882,33071),(Co.wrapS!==ClampToEdgeWrapping||Co.wrapT!==ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),rt.texParameteri(Nu,10240,Rn(Co.magFilter)),rt.texParameteri(Nu,10241,Rn(Co.minFilter)),Co.minFilter!==NearestFilter&&Co.minFilter!==LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),_.has("EXT_texture_filter_anisotropic")===!0){const a0=_.get("EXT_texture_filter_anisotropic");if(Co.magFilter===NearestFilter||Co.minFilter!==NearestMipmapLinearFilter&&Co.minFilter!==LinearMipmapLinearFilter||Co.type===FloatType&&_.has("OES_texture_float_linear")===!1||Bt===!1&&Co.type===HalfFloatType&&_.has("OES_texture_half_float_linear")===!1)return;(Co.anisotropy>1||mt.get(Co).__currentAnisotropy)&&(rt.texParameterf(Nu,a0.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Co.anisotropy,bt.getMaxAnisotropy())),mt.get(Co).__currentAnisotropy=Co.anisotropy)}}function pu(Nu,Co){let Bp=!1;Nu.__webglInit===void 0&&(Nu.__webglInit=!0,Co.addEventListener("dispose",qn));const a0=Co.source;let Q0=_r.get(a0);Q0===void 0&&(Q0={},_r.set(a0,Q0));const T0=eo(Co);if(T0!==Nu.__cacheKey){Q0[T0]===void 0&&(Q0[T0]={texture:rt.createTexture(),usedTimes:0},Mt.memory.textures++,Bp=!0),Q0[T0].usedTimes++;const av=Q0[Nu.__cacheKey];av!==void 0&&(Q0[Nu.__cacheKey].usedTimes--,av.usedTimes===0&&cs(Co)),Nu.__cacheKey=T0,Nu.__webglTexture=Q0[T0].texture}return Bp}function Zu(Nu,Co,Bp){let a0=3553;(Co.isDataArrayTexture||Co.isCompressedArrayTexture)&&(a0=35866),Co.isData3DTexture&&(a0=32879);const Q0=pu(Nu,Co),T0=Co.source;ut.bindTexture(a0,Nu.__webglTexture,33984+Bp);const av=mt.get(T0);if(T0.version!==av.__version||Q0===!0){ut.activeTexture(33984+Bp),rt.pixelStorei(37440,Co.flipY),rt.pixelStorei(37441,Co.premultiplyAlpha),rt.pixelStorei(3317,Co.unpackAlignment),rt.pixelStorei(37443,0);const lv=mn(Co)&&Jr(Co.image)===!1;let N0=Br(Co.image,lv,!1,tr);N0=jm(Co,N0);const zv=Jr(N0)||Bt,Uv=St.convert(Co.format,Co.encoding);let Gv=St.convert(Co.type),Dv=en(Co.internalFormat,Uv,Gv,Co.encoding,Co.isVideoTexture);mu(a0,Co,zv);let Cv;const Kp=Co.mipmaps,sv=Bt&&Co.isVideoTexture!==!0,Hv=av.__version===void 0||Q0===!0,jp=In(Co,N0,zv);if(Co.isDepthTexture)Dv=6402,Bt?Co.type===FloatType?Dv=36012:Co.type===UnsignedIntType?Dv=33190:Co.type===UnsignedInt248Type?Dv=35056:Dv=33189:Co.type===FloatType&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Co.format===DepthFormat&&Dv===6402&&Co.type!==UnsignedShortType&&Co.type!==UnsignedIntType&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Co.type=UnsignedIntType,Gv=St.convert(Co.type)),Co.format===DepthStencilFormat&&Dv===6402&&(Dv=34041,Co.type!==UnsignedInt248Type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Co.type=UnsignedInt248Type,Gv=St.convert(Co.type))),Hv&&(sv?ut.texStorage2D(3553,1,Dv,N0.width,N0.height):ut.texImage2D(3553,0,Dv,N0.width,N0.height,0,Uv,Gv,null));else if(Co.isDataTexture)if(Kp.length>0&&zv){sv&&Hv&&ut.texStorage2D(3553,jp,Dv,Kp[0].width,Kp[0].height);for(let Fp=0,nv=Kp.length;Fp<nv;Fp++)Cv=Kp[Fp],sv?ut.texSubImage2D(3553,Fp,0,0,Cv.width,Cv.height,Uv,Gv,Cv.data):ut.texImage2D(3553,Fp,Dv,Cv.width,Cv.height,0,Uv,Gv,Cv.data);Co.generateMipmaps=!1}else sv?(Hv&&ut.texStorage2D(3553,jp,Dv,N0.width,N0.height),ut.texSubImage2D(3553,0,0,0,N0.width,N0.height,Uv,Gv,N0.data)):ut.texImage2D(3553,0,Dv,N0.width,N0.height,0,Uv,Gv,N0.data);else if(Co.isCompressedTexture)if(Co.isCompressedArrayTexture){sv&&Hv&&ut.texStorage3D(35866,jp,Dv,Kp[0].width,Kp[0].height,N0.depth);for(let Fp=0,nv=Kp.length;Fp<nv;Fp++)Cv=Kp[Fp],Co.format!==RGBAFormat?Uv!==null?sv?ut.compressedTexSubImage3D(35866,Fp,0,0,0,Cv.width,Cv.height,N0.depth,Uv,Cv.data,0,0):ut.compressedTexImage3D(35866,Fp,Dv,Cv.width,Cv.height,N0.depth,0,Cv.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):sv?ut.texSubImage3D(35866,Fp,0,0,0,Cv.width,Cv.height,N0.depth,Uv,Gv,Cv.data):ut.texImage3D(35866,Fp,Dv,Cv.width,Cv.height,N0.depth,0,Uv,Gv,Cv.data)}else{sv&&Hv&&ut.texStorage2D(3553,jp,Dv,Kp[0].width,Kp[0].height);for(let Fp=0,nv=Kp.length;Fp<nv;Fp++)Cv=Kp[Fp],Co.format!==RGBAFormat?Uv!==null?sv?ut.compressedTexSubImage2D(3553,Fp,0,0,Cv.width,Cv.height,Uv,Cv.data):ut.compressedTexImage2D(3553,Fp,Dv,Cv.width,Cv.height,0,Cv.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):sv?ut.texSubImage2D(3553,Fp,0,0,Cv.width,Cv.height,Uv,Gv,Cv.data):ut.texImage2D(3553,Fp,Dv,Cv.width,Cv.height,0,Uv,Gv,Cv.data)}else if(Co.isDataArrayTexture)sv?(Hv&&ut.texStorage3D(35866,jp,Dv,N0.width,N0.height,N0.depth),ut.texSubImage3D(35866,0,0,0,0,N0.width,N0.height,N0.depth,Uv,Gv,N0.data)):ut.texImage3D(35866,0,Dv,N0.width,N0.height,N0.depth,0,Uv,Gv,N0.data);else if(Co.isData3DTexture)sv?(Hv&&ut.texStorage3D(32879,jp,Dv,N0.width,N0.height,N0.depth),ut.texSubImage3D(32879,0,0,0,0,N0.width,N0.height,N0.depth,Uv,Gv,N0.data)):ut.texImage3D(32879,0,Dv,N0.width,N0.height,N0.depth,0,Uv,Gv,N0.data);else if(Co.isFramebufferTexture){if(Hv)if(sv)ut.texStorage2D(3553,jp,Dv,N0.width,N0.height);else{let Fp=N0.width,nv=N0.height;for(let qy=0;qy<jp;qy++)ut.texImage2D(3553,qy,Dv,Fp,nv,0,Uv,Gv,null),Fp>>=1,nv>>=1}}else if(Kp.length>0&&zv){sv&&Hv&&ut.texStorage2D(3553,jp,Dv,Kp[0].width,Kp[0].height);for(let Fp=0,nv=Kp.length;Fp<nv;Fp++)Cv=Kp[Fp],sv?ut.texSubImage2D(3553,Fp,0,0,Uv,Gv,Cv):ut.texImage2D(3553,Fp,Dv,Uv,Gv,Cv);Co.generateMipmaps=!1}else sv?(Hv&&ut.texStorage2D(3553,jp,Dv,N0.width,N0.height),ut.texSubImage2D(3553,0,0,0,Uv,Gv,N0)):ut.texImage2D(3553,0,Dv,Uv,Gv,N0);Mn(Co,zv)&&$n(a0),av.__version=T0.version,Co.onUpdate&&Co.onUpdate(Co)}Nu.__version=Co.version}function Mp(Nu,Co,Bp){if(Co.image.length!==6)return;const a0=pu(Nu,Co),Q0=Co.source;ut.bindTexture(34067,Nu.__webglTexture,33984+Bp);const T0=mt.get(Q0);if(Q0.version!==T0.__version||a0===!0){ut.activeTexture(33984+Bp),rt.pixelStorei(37440,Co.flipY),rt.pixelStorei(37441,Co.premultiplyAlpha),rt.pixelStorei(3317,Co.unpackAlignment),rt.pixelStorei(37443,0);const av=Co.isCompressedTexture||Co.image[0].isCompressedTexture,lv=Co.image[0]&&Co.image[0].isDataTexture,N0=[];for(let Fp=0;Fp<6;Fp++)!av&&!lv?N0[Fp]=Br(Co.image[Fp],!1,!0,Ht):N0[Fp]=lv?Co.image[Fp].image:Co.image[Fp],N0[Fp]=jm(Co,N0[Fp]);const zv=N0[0],Uv=Jr(zv)||Bt,Gv=St.convert(Co.format,Co.encoding),Dv=St.convert(Co.type),Cv=en(Co.internalFormat,Gv,Dv,Co.encoding),Kp=Bt&&Co.isVideoTexture!==!0,sv=T0.__version===void 0||a0===!0;let Hv=In(Co,zv,Uv);mu(34067,Co,Uv);let jp;if(av){Kp&&sv&&ut.texStorage2D(34067,Hv,Cv,zv.width,zv.height);for(let Fp=0;Fp<6;Fp++){jp=N0[Fp].mipmaps;for(let nv=0;nv<jp.length;nv++){const qy=jp[nv];Co.format!==RGBAFormat?Gv!==null?Kp?ut.compressedTexSubImage2D(34069+Fp,nv,0,0,qy.width,qy.height,Gv,qy.data):ut.compressedTexImage2D(34069+Fp,nv,Cv,qy.width,qy.height,0,qy.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Kp?ut.texSubImage2D(34069+Fp,nv,0,0,qy.width,qy.height,Gv,Dv,qy.data):ut.texImage2D(34069+Fp,nv,Cv,qy.width,qy.height,0,Gv,Dv,qy.data)}}}else{jp=Co.mipmaps,Kp&&sv&&(jp.length>0&&Hv++,ut.texStorage2D(34067,Hv,Cv,N0[0].width,N0[0].height));for(let Fp=0;Fp<6;Fp++)if(lv){Kp?ut.texSubImage2D(34069+Fp,0,0,0,N0[Fp].width,N0[Fp].height,Gv,Dv,N0[Fp].data):ut.texImage2D(34069+Fp,0,Cv,N0[Fp].width,N0[Fp].height,0,Gv,Dv,N0[Fp].data);for(let nv=0;nv<jp.length;nv++){const Uy=jp[nv].image[Fp].image;Kp?ut.texSubImage2D(34069+Fp,nv+1,0,0,Uy.width,Uy.height,Gv,Dv,Uy.data):ut.texImage2D(34069+Fp,nv+1,Cv,Uy.width,Uy.height,0,Gv,Dv,Uy.data)}}else{Kp?ut.texSubImage2D(34069+Fp,0,0,0,Gv,Dv,N0[Fp]):ut.texImage2D(34069+Fp,0,Cv,Gv,Dv,N0[Fp]);for(let nv=0;nv<jp.length;nv++){const qy=jp[nv];Kp?ut.texSubImage2D(34069+Fp,nv+1,0,0,Gv,Dv,qy.image[Fp]):ut.texImage2D(34069+Fp,nv+1,Cv,Gv,Dv,qy.image[Fp])}}}Mn(Co,Uv)&&$n(34067),T0.__version=Q0.version,Co.onUpdate&&Co.onUpdate(Co)}Nu.__version=Co.version}function Up(Nu,Co,Bp,a0,Q0){const T0=St.convert(Bp.format,Bp.encoding),av=St.convert(Bp.type),lv=en(Bp.internalFormat,T0,av,Bp.encoding);mt.get(Co).__hasExternalTextures||(Q0===32879||Q0===35866?ut.texImage3D(Q0,0,lv,Co.width,Co.height,Co.depth,0,T0,av,null):ut.texImage2D(Q0,0,lv,Co.width,Co.height,0,T0,av,null)),ut.bindFramebuffer(36160,Nu),y0(Co)?sr.framebufferTexture2DMultisampleEXT(36160,a0,Q0,mt.get(Bp).__webglTexture,0,Jp(Co)):(Q0===3553||Q0>=34069&&Q0<=34074)&&rt.framebufferTexture2D(36160,a0,Q0,mt.get(Bp).__webglTexture,0),ut.bindFramebuffer(36160,null)}function Ep(Nu,Co,Bp){if(rt.bindRenderbuffer(36161,Nu),Co.depthBuffer&&!Co.stencilBuffer){let a0=33189;if(Bp||y0(Co)){const Q0=Co.depthTexture;Q0&&Q0.isDepthTexture&&(Q0.type===FloatType?a0=36012:Q0.type===UnsignedIntType&&(a0=33190));const T0=Jp(Co);y0(Co)?sr.renderbufferStorageMultisampleEXT(36161,T0,a0,Co.width,Co.height):rt.renderbufferStorageMultisample(36161,T0,a0,Co.width,Co.height)}else rt.renderbufferStorage(36161,a0,Co.width,Co.height);rt.framebufferRenderbuffer(36160,36096,36161,Nu)}else if(Co.depthBuffer&&Co.stencilBuffer){const a0=Jp(Co);Bp&&y0(Co)===!1?rt.renderbufferStorageMultisample(36161,a0,35056,Co.width,Co.height):y0(Co)?sr.renderbufferStorageMultisampleEXT(36161,a0,35056,Co.width,Co.height):rt.renderbufferStorage(36161,34041,Co.width,Co.height),rt.framebufferRenderbuffer(36160,33306,36161,Nu)}else{const a0=Co.isWebGLMultipleRenderTargets===!0?Co.texture:[Co.texture];for(let Q0=0;Q0<a0.length;Q0++){const T0=a0[Q0],av=St.convert(T0.format,T0.encoding),lv=St.convert(T0.type),N0=en(T0.internalFormat,av,lv,T0.encoding),zv=Jp(Co);Bp&&y0(Co)===!1?rt.renderbufferStorageMultisample(36161,zv,N0,Co.width,Co.height):y0(Co)?sr.renderbufferStorageMultisampleEXT(36161,zv,N0,Co.width,Co.height):rt.renderbufferStorage(36161,N0,Co.width,Co.height)}}rt.bindRenderbuffer(36161,null)}function mp(Nu,Co){if(Co&&Co.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(ut.bindFramebuffer(36160,Nu),!(Co.depthTexture&&Co.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!mt.get(Co.depthTexture).__webglTexture||Co.depthTexture.image.width!==Co.width||Co.depthTexture.image.height!==Co.height)&&(Co.depthTexture.image.width=Co.width,Co.depthTexture.image.height=Co.height,Co.depthTexture.needsUpdate=!0),Ao(Co.depthTexture,0);const a0=mt.get(Co.depthTexture).__webglTexture,Q0=Jp(Co);if(Co.depthTexture.format===DepthFormat)y0(Co)?sr.framebufferTexture2DMultisampleEXT(36160,36096,3553,a0,0,Q0):rt.framebufferTexture2D(36160,36096,3553,a0,0);else if(Co.depthTexture.format===DepthStencilFormat)y0(Co)?sr.framebufferTexture2DMultisampleEXT(36160,33306,3553,a0,0,Q0):rt.framebufferTexture2D(36160,33306,3553,a0,0);else throw new Error("Unknown depthTexture format")}function Cp(Nu){const Co=mt.get(Nu),Bp=Nu.isWebGLCubeRenderTarget===!0;if(Nu.depthTexture&&!Co.__autoAllocateDepthBuffer){if(Bp)throw new Error("target.depthTexture not supported in Cube render targets");mp(Co.__webglFramebuffer,Nu)}else if(Bp){Co.__webglDepthbuffer=[];for(let a0=0;a0<6;a0++)ut.bindFramebuffer(36160,Co.__webglFramebuffer[a0]),Co.__webglDepthbuffer[a0]=rt.createRenderbuffer(),Ep(Co.__webglDepthbuffer[a0],Nu,!1)}else ut.bindFramebuffer(36160,Co.__webglFramebuffer),Co.__webglDepthbuffer=rt.createRenderbuffer(),Ep(Co.__webglDepthbuffer,Nu,!1);ut.bindFramebuffer(36160,null)}function t0(Nu,Co,Bp){const a0=mt.get(Nu);Co!==void 0&&Up(a0.__webglFramebuffer,Nu,Nu.texture,36064,3553),Bp!==void 0&&Cp(Nu)}function _g(Nu){const Co=Nu.texture,Bp=mt.get(Nu),a0=mt.get(Co);Nu.addEventListener("dispose",Qn),Nu.isWebGLMultipleRenderTargets!==!0&&(a0.__webglTexture===void 0&&(a0.__webglTexture=rt.createTexture()),a0.__version=Co.version,Mt.memory.textures++);const Q0=Nu.isWebGLCubeRenderTarget===!0,T0=Nu.isWebGLMultipleRenderTargets===!0,av=Jr(Nu)||Bt;if(Q0){Bp.__webglFramebuffer=[];for(let lv=0;lv<6;lv++)Bp.__webglFramebuffer[lv]=rt.createFramebuffer()}else{if(Bp.__webglFramebuffer=rt.createFramebuffer(),T0)if(bt.drawBuffers){const lv=Nu.texture;for(let N0=0,zv=lv.length;N0<zv;N0++){const Uv=mt.get(lv[N0]);Uv.__webglTexture===void 0&&(Uv.__webglTexture=rt.createTexture(),Mt.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(Bt&&Nu.samples>0&&y0(Nu)===!1){const lv=T0?Co:[Co];Bp.__webglMultisampledFramebuffer=rt.createFramebuffer(),Bp.__webglColorRenderbuffer=[],ut.bindFramebuffer(36160,Bp.__webglMultisampledFramebuffer);for(let N0=0;N0<lv.length;N0++){const zv=lv[N0];Bp.__webglColorRenderbuffer[N0]=rt.createRenderbuffer(),rt.bindRenderbuffer(36161,Bp.__webglColorRenderbuffer[N0]);const Uv=St.convert(zv.format,zv.encoding),Gv=St.convert(zv.type),Dv=en(zv.internalFormat,Uv,Gv,zv.encoding,Nu.isXRRenderTarget===!0),Cv=Jp(Nu);rt.renderbufferStorageMultisample(36161,Cv,Dv,Nu.width,Nu.height),rt.framebufferRenderbuffer(36160,36064+N0,36161,Bp.__webglColorRenderbuffer[N0])}rt.bindRenderbuffer(36161,null),Nu.depthBuffer&&(Bp.__webglDepthRenderbuffer=rt.createRenderbuffer(),Ep(Bp.__webglDepthRenderbuffer,Nu,!0)),ut.bindFramebuffer(36160,null)}}if(Q0){ut.bindTexture(34067,a0.__webglTexture),mu(34067,Co,av);for(let lv=0;lv<6;lv++)Up(Bp.__webglFramebuffer[lv],Nu,Co,36064,34069+lv);Mn(Co,av)&&$n(34067),ut.unbindTexture()}else if(T0){const lv=Nu.texture;for(let N0=0,zv=lv.length;N0<zv;N0++){const Uv=lv[N0],Gv=mt.get(Uv);ut.bindTexture(3553,Gv.__webglTexture),mu(3553,Uv,av),Up(Bp.__webglFramebuffer,Nu,Uv,36064+N0,3553),Mn(Uv,av)&&$n(3553)}ut.unbindTexture()}else{let lv=3553;(Nu.isWebGL3DRenderTarget||Nu.isWebGLArrayRenderTarget)&&(Bt?lv=Nu.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),ut.bindTexture(lv,a0.__webglTexture),mu(lv,Co,av),Up(Bp.__webglFramebuffer,Nu,Co,36064,lv),Mn(Co,av)&&$n(lv),ut.unbindTexture()}Nu.depthBuffer&&Cp(Nu)}function m0(Nu){const Co=Jr(Nu)||Bt,Bp=Nu.isWebGLMultipleRenderTargets===!0?Nu.texture:[Nu.texture];for(let a0=0,Q0=Bp.length;a0<Q0;a0++){const T0=Bp[a0];if(Mn(T0,Co)){const av=Nu.isWebGLCubeRenderTarget?34067:3553,lv=mt.get(T0).__webglTexture;ut.bindTexture(av,lv),$n(av),ut.unbindTexture()}}}function K0(Nu){if(Bt&&Nu.samples>0&&y0(Nu)===!1){const Co=Nu.isWebGLMultipleRenderTargets?Nu.texture:[Nu.texture],Bp=Nu.width,a0=Nu.height;let Q0=16384;const T0=[],av=Nu.stencilBuffer?33306:36096,lv=mt.get(Nu),N0=Nu.isWebGLMultipleRenderTargets===!0;if(N0)for(let zv=0;zv<Co.length;zv++)ut.bindFramebuffer(36160,lv.__webglMultisampledFramebuffer),rt.framebufferRenderbuffer(36160,36064+zv,36161,null),ut.bindFramebuffer(36160,lv.__webglFramebuffer),rt.framebufferTexture2D(36009,36064+zv,3553,null,0);ut.bindFramebuffer(36008,lv.__webglMultisampledFramebuffer),ut.bindFramebuffer(36009,lv.__webglFramebuffer);for(let zv=0;zv<Co.length;zv++){T0.push(36064+zv),Nu.depthBuffer&&T0.push(av);const Uv=lv.__ignoreDepthValues!==void 0?lv.__ignoreDepthValues:!1;if(Uv===!1&&(Nu.depthBuffer&&(Q0|=256),Nu.stencilBuffer&&(Q0|=1024)),N0&&rt.framebufferRenderbuffer(36008,36064,36161,lv.__webglColorRenderbuffer[zv]),Uv===!0&&(rt.invalidateFramebuffer(36008,[av]),rt.invalidateFramebuffer(36009,[av])),N0){const Gv=mt.get(Co[zv]).__webglTexture;rt.framebufferTexture2D(36009,36064,3553,Gv,0)}rt.blitFramebuffer(0,0,Bp,a0,0,0,Bp,a0,Q0,9728),ar&&rt.invalidateFramebuffer(36008,T0)}if(ut.bindFramebuffer(36008,null),ut.bindFramebuffer(36009,null),N0)for(let zv=0;zv<Co.length;zv++){ut.bindFramebuffer(36160,lv.__webglMultisampledFramebuffer),rt.framebufferRenderbuffer(36160,36064+zv,36161,lv.__webglColorRenderbuffer[zv]);const Uv=mt.get(Co[zv]).__webglTexture;ut.bindFramebuffer(36160,lv.__webglFramebuffer),rt.framebufferTexture2D(36009,36064+zv,3553,Uv,0)}ut.bindFramebuffer(36009,lv.__webglMultisampledFramebuffer)}}function Jp(Nu){return Math.min(rr,Nu.samples)}function y0(Nu){const Co=mt.get(Nu);return Bt&&Nu.samples>0&&_.has("WEBGL_multisampled_render_to_texture")===!0&&Co.__useRenderToTexture!==!1}function z0(Nu){const Co=Mt.render.frame;cr.get(Nu)!==Co&&(cr.set(Nu,Co),Nu.update())}function jm(Nu,Co){const Bp=Nu.encoding,a0=Nu.format,Q0=Nu.type;return Nu.isCompressedTexture===!0||Nu.isVideoTexture===!0||Nu.format===_SRGBAFormat||Bp!==LinearEncoding$1&&(Bp===sRGBEncoding$1?Bt===!1?_.has("EXT_sRGB")===!0&&a0===RGBAFormat?(Nu.format=_SRGBAFormat,Nu.minFilter=LinearFilter,Nu.generateMipmaps=!1):Co=ImageUtils.sRGBToLinear(Co):(a0!==RGBAFormat||Q0!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Bp)),Co}this.allocateTextureUnit=Ss,this.resetTextureUnits=qs,this.setTexture2D=Ao,this.setTexture2DArray=Oo,this.setTexture3D=uo,this.setTextureCube=uu,this.rebindTextures=t0,this.setupRenderTarget=_g,this.updateRenderTargetMipmap=m0,this.updateMultisampleRenderTarget=K0,this.setupDepthRenderbuffer=Cp,this.setupFrameBufferTexture=Up,this.useMultisampledRTT=y0}function WebGLUtils(rt,_,ut){const mt=ut.isWebGL2;function bt(St,Mt=null){let Bt;if(St===UnsignedByteType)return 5121;if(St===UnsignedShort4444Type)return 32819;if(St===UnsignedShort5551Type)return 32820;if(St===ByteType)return 5120;if(St===ShortType)return 5122;if(St===UnsignedShortType)return 5123;if(St===IntType)return 5124;if(St===UnsignedIntType)return 5125;if(St===FloatType)return 5126;if(St===HalfFloatType)return mt?5131:(Bt=_.get("OES_texture_half_float"),Bt!==null?Bt.HALF_FLOAT_OES:null);if(St===AlphaFormat)return 6406;if(St===RGBAFormat)return 6408;if(St===LuminanceFormat)return 6409;if(St===LuminanceAlphaFormat)return 6410;if(St===DepthFormat)return 6402;if(St===DepthStencilFormat)return 34041;if(St===_SRGBAFormat)return Bt=_.get("EXT_sRGB"),Bt!==null?Bt.SRGB_ALPHA_EXT:null;if(St===RedFormat)return 6403;if(St===RedIntegerFormat)return 36244;if(St===RGFormat)return 33319;if(St===RGIntegerFormat)return 33320;if(St===RGBAIntegerFormat)return 36249;if(St===RGB_S3TC_DXT1_Format||St===RGBA_S3TC_DXT1_Format||St===RGBA_S3TC_DXT3_Format||St===RGBA_S3TC_DXT5_Format)if(Mt===sRGBEncoding$1)if(Bt=_.get("WEBGL_compressed_texture_s3tc_srgb"),Bt!==null){if(St===RGB_S3TC_DXT1_Format)return Bt.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(St===RGBA_S3TC_DXT1_Format)return Bt.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(St===RGBA_S3TC_DXT3_Format)return Bt.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(St===RGBA_S3TC_DXT5_Format)return Bt.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(Bt=_.get("WEBGL_compressed_texture_s3tc"),Bt!==null){if(St===RGB_S3TC_DXT1_Format)return Bt.COMPRESSED_RGB_S3TC_DXT1_EXT;if(St===RGBA_S3TC_DXT1_Format)return Bt.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(St===RGBA_S3TC_DXT3_Format)return Bt.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(St===RGBA_S3TC_DXT5_Format)return Bt.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(St===RGB_PVRTC_4BPPV1_Format||St===RGB_PVRTC_2BPPV1_Format||St===RGBA_PVRTC_4BPPV1_Format||St===RGBA_PVRTC_2BPPV1_Format)if(Bt=_.get("WEBGL_compressed_texture_pvrtc"),Bt!==null){if(St===RGB_PVRTC_4BPPV1_Format)return Bt.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(St===RGB_PVRTC_2BPPV1_Format)return Bt.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(St===RGBA_PVRTC_4BPPV1_Format)return Bt.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(St===RGBA_PVRTC_2BPPV1_Format)return Bt.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(St===RGB_ETC1_Format)return Bt=_.get("WEBGL_compressed_texture_etc1"),Bt!==null?Bt.COMPRESSED_RGB_ETC1_WEBGL:null;if(St===RGB_ETC2_Format||St===RGBA_ETC2_EAC_Format)if(Bt=_.get("WEBGL_compressed_texture_etc"),Bt!==null){if(St===RGB_ETC2_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ETC2:Bt.COMPRESSED_RGB8_ETC2;if(St===RGBA_ETC2_EAC_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:Bt.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(St===RGBA_ASTC_4x4_Format||St===RGBA_ASTC_5x4_Format||St===RGBA_ASTC_5x5_Format||St===RGBA_ASTC_6x5_Format||St===RGBA_ASTC_6x6_Format||St===RGBA_ASTC_8x5_Format||St===RGBA_ASTC_8x6_Format||St===RGBA_ASTC_8x8_Format||St===RGBA_ASTC_10x5_Format||St===RGBA_ASTC_10x6_Format||St===RGBA_ASTC_10x8_Format||St===RGBA_ASTC_10x10_Format||St===RGBA_ASTC_12x10_Format||St===RGBA_ASTC_12x12_Format)if(Bt=_.get("WEBGL_compressed_texture_astc"),Bt!==null){if(St===RGBA_ASTC_4x4_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:Bt.COMPRESSED_RGBA_ASTC_4x4_KHR;if(St===RGBA_ASTC_5x4_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:Bt.COMPRESSED_RGBA_ASTC_5x4_KHR;if(St===RGBA_ASTC_5x5_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:Bt.COMPRESSED_RGBA_ASTC_5x5_KHR;if(St===RGBA_ASTC_6x5_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:Bt.COMPRESSED_RGBA_ASTC_6x5_KHR;if(St===RGBA_ASTC_6x6_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:Bt.COMPRESSED_RGBA_ASTC_6x6_KHR;if(St===RGBA_ASTC_8x5_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:Bt.COMPRESSED_RGBA_ASTC_8x5_KHR;if(St===RGBA_ASTC_8x6_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:Bt.COMPRESSED_RGBA_ASTC_8x6_KHR;if(St===RGBA_ASTC_8x8_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:Bt.COMPRESSED_RGBA_ASTC_8x8_KHR;if(St===RGBA_ASTC_10x5_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:Bt.COMPRESSED_RGBA_ASTC_10x5_KHR;if(St===RGBA_ASTC_10x6_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:Bt.COMPRESSED_RGBA_ASTC_10x6_KHR;if(St===RGBA_ASTC_10x8_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:Bt.COMPRESSED_RGBA_ASTC_10x8_KHR;if(St===RGBA_ASTC_10x10_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:Bt.COMPRESSED_RGBA_ASTC_10x10_KHR;if(St===RGBA_ASTC_12x10_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:Bt.COMPRESSED_RGBA_ASTC_12x10_KHR;if(St===RGBA_ASTC_12x12_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:Bt.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(St===RGBA_BPTC_Format)if(Bt=_.get("EXT_texture_compression_bptc"),Bt!==null){if(St===RGBA_BPTC_Format)return Mt===sRGBEncoding$1?Bt.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:Bt.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(St===RED_RGTC1_Format||St===SIGNED_RED_RGTC1_Format||St===RED_GREEN_RGTC2_Format||St===SIGNED_RED_GREEN_RGTC2_Format)if(Bt=_.get("EXT_texture_compression_rgtc"),Bt!==null){if(St===RGBA_BPTC_Format)return Bt.COMPRESSED_RED_RGTC1_EXT;if(St===SIGNED_RED_RGTC1_Format)return Bt.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(St===RED_GREEN_RGTC2_Format)return Bt.COMPRESSED_RED_GREEN_RGTC2_EXT;if(St===SIGNED_RED_GREEN_RGTC2_Format)return Bt.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return St===UnsignedInt248Type?mt?34042:(Bt=_.get("WEBGL_depth_texture"),Bt!==null?Bt.UNSIGNED_INT_24_8_WEBGL:null):rt[St]!==void 0?rt[St]:null}return{convert:bt}}class ArrayCamera extends PerspectiveCamera$1{constructor(_=[]){super(),this.isArrayCamera=!0,this.cameras=_}}let Group$1=class extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}};const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group$1,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group$1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group$1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(_){return this._targetRay!==null&&this._targetRay.dispatchEvent(_),this._grip!==null&&this._grip.dispatchEvent(_),this._hand!==null&&this._hand.dispatchEvent(_),this}connect(_){if(_&&_.hand){const ut=this._hand;if(ut)for(const mt of _.hand.values())this._getHandJoint(ut,mt)}return this.dispatchEvent({type:"connected",data:_}),this}disconnect(_){return this.dispatchEvent({type:"disconnected",data:_}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(_,ut,mt){let bt=null,St=null,Mt=null;const Bt=this._targetRay,Ut=this._grip,Ht=this._hand;if(_&&ut.session.visibilityState!=="visible-blurred"){if(Ht&&_.hand){Mt=!0;for(const Ar of _.hand.values()){const _r=ut.getJointPose(Ar,mt),Dr=this._getHandJoint(Ht,Ar);_r!==null&&(Dr.matrix.fromArray(_r.transform.matrix),Dr.matrix.decompose(Dr.position,Dr.rotation,Dr.scale),Dr.jointRadius=_r.radius),Dr.visible=_r!==null}const tr=Ht.joints["index-finger-tip"],rr=Ht.joints["thumb-tip"],sr=tr.position.distanceTo(rr.position),ar=.02,cr=.005;Ht.inputState.pinching&&sr>ar+cr?(Ht.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:_.handedness,target:this})):!Ht.inputState.pinching&&sr<=ar-cr&&(Ht.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:_.handedness,target:this}))}else Ut!==null&&_.gripSpace&&(St=ut.getPose(_.gripSpace,mt),St!==null&&(Ut.matrix.fromArray(St.transform.matrix),Ut.matrix.decompose(Ut.position,Ut.rotation,Ut.scale),St.linearVelocity?(Ut.hasLinearVelocity=!0,Ut.linearVelocity.copy(St.linearVelocity)):Ut.hasLinearVelocity=!1,St.angularVelocity?(Ut.hasAngularVelocity=!0,Ut.angularVelocity.copy(St.angularVelocity)):Ut.hasAngularVelocity=!1));Bt!==null&&(bt=ut.getPose(_.targetRaySpace,mt),bt===null&&St!==null&&(bt=St),bt!==null&&(Bt.matrix.fromArray(bt.transform.matrix),Bt.matrix.decompose(Bt.position,Bt.rotation,Bt.scale),bt.linearVelocity?(Bt.hasLinearVelocity=!0,Bt.linearVelocity.copy(bt.linearVelocity)):Bt.hasLinearVelocity=!1,bt.angularVelocity?(Bt.hasAngularVelocity=!0,Bt.angularVelocity.copy(bt.angularVelocity)):Bt.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return Bt!==null&&(Bt.visible=bt!==null),Ut!==null&&(Ut.visible=St!==null),Ht!==null&&(Ht.visible=Mt!==null),this}_getHandJoint(_,ut){if(_.joints[ut.jointName]===void 0){const mt=new Group$1;mt.matrixAutoUpdate=!1,mt.visible=!1,_.joints[ut.jointName]=mt,_.add(mt)}return _.joints[ut.jointName]}}class DepthTexture extends Texture{constructor(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr){if(tr=tr!==void 0?tr:DepthFormat,tr!==DepthFormat&&tr!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");mt===void 0&&tr===DepthFormat&&(mt=UnsignedIntType),mt===void 0&&tr===DepthStencilFormat&&(mt=UnsignedInt248Type),super(null,bt,St,Mt,Bt,Ut,tr,mt,Ht),this.isDepthTexture=!0,this.image={width:_,height:ut},this.magFilter=Bt!==void 0?Bt:NearestFilter,this.minFilter=Ut!==void 0?Ut:NearestFilter,this.flipY=!1,this.generateMipmaps=!1}}class WebXRManager extends EventDispatcher{constructor(_,ut){super();const mt=this;let bt=null,St=1,Mt=null,Bt="local-floor",Ut=1,Ht=null,tr=null,rr=null,sr=null,ar=null,cr=null;const Ar=ut.getContextAttributes();let _r=null,Dr=null;const $r=[],Br=[],Jr=new Set,mn=new Map,Mn=new PerspectiveCamera$1;Mn.layers.enable(1),Mn.viewport=new Vector4;const $n=new PerspectiveCamera$1;$n.layers.enable(2),$n.viewport=new Vector4;const en=[Mn,$n],In=new ArrayCamera;In.layers.enable(1),In.layers.enable(2);let Rn=null,qn=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(uo){let uu=$r[uo];return uu===void 0&&(uu=new WebXRController,$r[uo]=uu),uu.getTargetRaySpace()},this.getControllerGrip=function(uo){let uu=$r[uo];return uu===void 0&&(uu=new WebXRController,$r[uo]=uu),uu.getGripSpace()},this.getHand=function(uo){let uu=$r[uo];return uu===void 0&&(uu=new WebXRController,$r[uo]=uu),uu.getHandSpace()};function Qn(uo){const uu=Br.indexOf(uo.inputSource);if(uu===-1)return;const cu=$r[uu];cu!==void 0&&cu.dispatchEvent({type:uo.type,data:uo.inputSource})}function xs(){bt.removeEventListener("select",Qn),bt.removeEventListener("selectstart",Qn),bt.removeEventListener("selectend",Qn),bt.removeEventListener("squeeze",Qn),bt.removeEventListener("squeezestart",Qn),bt.removeEventListener("squeezeend",Qn),bt.removeEventListener("end",xs),bt.removeEventListener("inputsourceschange",cs);for(let uo=0;uo<$r.length;uo++){const uu=Br[uo];uu!==null&&(Br[uo]=null,$r[uo].disconnect(uu))}Rn=null,qn=null,_.setRenderTarget(_r),ar=null,sr=null,rr=null,bt=null,Dr=null,Oo.stop(),mt.isPresenting=!1,mt.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(uo){St=uo,mt.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(uo){Bt=uo,mt.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return Ht||Mt},this.setReferenceSpace=function(uo){Ht=uo},this.getBaseLayer=function(){return sr!==null?sr:ar},this.getBinding=function(){return rr},this.getFrame=function(){return cr},this.getSession=function(){return bt},this.setSession=async function(uo){if(bt=uo,bt!==null){if(_r=_.getRenderTarget(),bt.addEventListener("select",Qn),bt.addEventListener("selectstart",Qn),bt.addEventListener("selectend",Qn),bt.addEventListener("squeeze",Qn),bt.addEventListener("squeezestart",Qn),bt.addEventListener("squeezeend",Qn),bt.addEventListener("end",xs),bt.addEventListener("inputsourceschange",cs),Ar.xrCompatible!==!0&&await ut.makeXRCompatible(),bt.renderState.layers===void 0||_.capabilities.isWebGL2===!1){const uu={antialias:bt.renderState.layers===void 0?Ar.antialias:!0,alpha:Ar.alpha,depth:Ar.depth,stencil:Ar.stencil,framebufferScaleFactor:St};ar=new XRWebGLLayer(bt,ut,uu),bt.updateRenderState({baseLayer:ar}),Dr=new WebGLRenderTarget(ar.framebufferWidth,ar.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,encoding:_.outputEncoding,stencilBuffer:Ar.stencil})}else{let uu=null,cu=null,Jl=null;Ar.depth&&(Jl=Ar.stencil?35056:33190,uu=Ar.stencil?DepthStencilFormat:DepthFormat,cu=Ar.stencil?UnsignedInt248Type:UnsignedIntType);const mu={colorFormat:32856,depthFormat:Jl,scaleFactor:St};rr=new XRWebGLBinding(bt,ut),sr=rr.createProjectionLayer(mu),bt.updateRenderState({layers:[sr]}),Dr=new WebGLRenderTarget(sr.textureWidth,sr.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(sr.textureWidth,sr.textureHeight,cu,void 0,void 0,void 0,void 0,void 0,void 0,uu),stencilBuffer:Ar.stencil,encoding:_.outputEncoding,samples:Ar.antialias?4:0});const pu=_.properties.get(Dr);pu.__ignoreDepthValues=sr.ignoreDepthValues}Dr.isXRRenderTarget=!0,this.setFoveation(Ut),Ht=null,Mt=await bt.requestReferenceSpace(Bt),Oo.setContext(bt),Oo.start(),mt.isPresenting=!0,mt.dispatchEvent({type:"sessionstart"})}};function cs(uo){for(let uu=0;uu<uo.removed.length;uu++){const cu=uo.removed[uu],Jl=Br.indexOf(cu);Jl>=0&&(Br[Jl]=null,$r[Jl].disconnect(cu))}for(let uu=0;uu<uo.added.length;uu++){const cu=uo.added[uu];let Jl=Br.indexOf(cu);if(Jl===-1){for(let pu=0;pu<$r.length;pu++)if(pu>=Br.length){Br.push(cu),Jl=pu;break}else if(Br[pu]===null){Br[pu]=cu,Jl=pu;break}if(Jl===-1)break}const mu=$r[Jl];mu&&mu.connect(cu)}}const ks=new Vector3,_o=new Vector3;function qs(uo,uu,cu){ks.setFromMatrixPosition(uu.matrixWorld),_o.setFromMatrixPosition(cu.matrixWorld);const Jl=ks.distanceTo(_o),mu=uu.projectionMatrix.elements,pu=cu.projectionMatrix.elements,Zu=mu[14]/(mu[10]-1),Mp=mu[14]/(mu[10]+1),Up=(mu[9]+1)/mu[5],Ep=(mu[9]-1)/mu[5],mp=(mu[8]-1)/mu[0],Cp=(pu[8]+1)/pu[0],t0=Zu*mp,_g=Zu*Cp,m0=Jl/(-mp+Cp),K0=m0*-mp;uu.matrixWorld.decompose(uo.position,uo.quaternion,uo.scale),uo.translateX(K0),uo.translateZ(m0),uo.matrixWorld.compose(uo.position,uo.quaternion,uo.scale),uo.matrixWorldInverse.copy(uo.matrixWorld).invert();const Jp=Zu+m0,y0=Mp+m0,z0=t0-K0,jm=_g+(Jl-K0),Nu=Up*Mp/y0*Jp,Co=Ep*Mp/y0*Jp;uo.projectionMatrix.makePerspective(z0,jm,Nu,Co,Jp,y0)}function Ss(uo,uu){uu===null?uo.matrixWorld.copy(uo.matrix):uo.matrixWorld.multiplyMatrices(uu.matrixWorld,uo.matrix),uo.matrixWorldInverse.copy(uo.matrixWorld).invert()}this.updateCamera=function(uo){if(bt===null)return;In.near=$n.near=Mn.near=uo.near,In.far=$n.far=Mn.far=uo.far,(Rn!==In.near||qn!==In.far)&&(bt.updateRenderState({depthNear:In.near,depthFar:In.far}),Rn=In.near,qn=In.far);const uu=uo.parent,cu=In.cameras;Ss(In,uu);for(let mu=0;mu<cu.length;mu++)Ss(cu[mu],uu);In.matrixWorld.decompose(In.position,In.quaternion,In.scale),uo.matrix.copy(In.matrix),uo.matrix.decompose(uo.position,uo.quaternion,uo.scale);const Jl=uo.children;for(let mu=0,pu=Jl.length;mu<pu;mu++)Jl[mu].updateMatrixWorld(!0);cu.length===2?qs(In,Mn,$n):In.projectionMatrix.copy(Mn.projectionMatrix)},this.getCamera=function(){return In},this.getFoveation=function(){if(!(sr===null&&ar===null))return Ut},this.setFoveation=function(uo){Ut=uo,sr!==null&&(sr.fixedFoveation=uo),ar!==null&&ar.fixedFoveation!==void 0&&(ar.fixedFoveation=uo)},this.getPlanes=function(){return Jr};let eo=null;function Ao(uo,uu){if(tr=uu.getViewerPose(Ht||Mt),cr=uu,tr!==null){const cu=tr.views;ar!==null&&(_.setRenderTargetFramebuffer(Dr,ar.framebuffer),_.setRenderTarget(Dr));let Jl=!1;cu.length!==In.cameras.length&&(In.cameras.length=0,Jl=!0);for(let mu=0;mu<cu.length;mu++){const pu=cu[mu];let Zu=null;if(ar!==null)Zu=ar.getViewport(pu);else{const Up=rr.getViewSubImage(sr,pu);Zu=Up.viewport,mu===0&&(_.setRenderTargetTextures(Dr,Up.colorTexture,sr.ignoreDepthValues?void 0:Up.depthStencilTexture),_.setRenderTarget(Dr))}let Mp=en[mu];Mp===void 0&&(Mp=new PerspectiveCamera$1,Mp.layers.enable(mu),Mp.viewport=new Vector4,en[mu]=Mp),Mp.matrix.fromArray(pu.transform.matrix),Mp.projectionMatrix.fromArray(pu.projectionMatrix),Mp.viewport.set(Zu.x,Zu.y,Zu.width,Zu.height),mu===0&&In.matrix.copy(Mp.matrix),Jl===!0&&In.cameras.push(Mp)}}for(let cu=0;cu<$r.length;cu++){const Jl=Br[cu],mu=$r[cu];Jl!==null&&mu!==void 0&&mu.update(Jl,uu,Ht||Mt)}if(eo&&eo(uo,uu),uu.detectedPlanes){mt.dispatchEvent({type:"planesdetected",data:uu.detectedPlanes});let cu=null;for(const Jl of Jr)uu.detectedPlanes.has(Jl)||(cu===null&&(cu=[]),cu.push(Jl));if(cu!==null)for(const Jl of cu)Jr.delete(Jl),mn.delete(Jl),mt.dispatchEvent({type:"planeremoved",data:Jl});for(const Jl of uu.detectedPlanes)if(!Jr.has(Jl))Jr.add(Jl),mn.set(Jl,uu.lastChangedTime),mt.dispatchEvent({type:"planeadded",data:Jl});else{const mu=mn.get(Jl);Jl.lastChangedTime>mu&&(mn.set(Jl,Jl.lastChangedTime),mt.dispatchEvent({type:"planechanged",data:Jl}))}}cr=null}const Oo=new WebGLAnimation;Oo.setAnimationLoop(Ao),this.setAnimationLoop=function(uo){eo=uo},this.dispose=function(){}}}function WebGLMaterials(rt,_){function ut(Ar,_r){_r.color.getRGB(Ar.fogColor.value,getUnlitUniformColorSpace(rt)),_r.isFog?(Ar.fogNear.value=_r.near,Ar.fogFar.value=_r.far):_r.isFogExp2&&(Ar.fogDensity.value=_r.density)}function mt(Ar,_r,Dr,$r,Br){_r.isMeshBasicMaterial||_r.isMeshLambertMaterial?bt(Ar,_r):_r.isMeshToonMaterial?(bt(Ar,_r),tr(Ar,_r)):_r.isMeshPhongMaterial?(bt(Ar,_r),Ht(Ar,_r)):_r.isMeshStandardMaterial?(bt(Ar,_r),rr(Ar,_r),_r.isMeshPhysicalMaterial&&sr(Ar,_r,Br)):_r.isMeshMatcapMaterial?(bt(Ar,_r),ar(Ar,_r)):_r.isMeshDepthMaterial?bt(Ar,_r):_r.isMeshDistanceMaterial?(bt(Ar,_r),cr(Ar,_r)):_r.isMeshNormalMaterial?bt(Ar,_r):_r.isLineBasicMaterial?(St(Ar,_r),_r.isLineDashedMaterial&&Mt(Ar,_r)):_r.isPointsMaterial?Bt(Ar,_r,Dr,$r):_r.isSpriteMaterial?Ut(Ar,_r):_r.isShadowMaterial?(Ar.color.value.copy(_r.color),Ar.opacity.value=_r.opacity):_r.isShaderMaterial&&(_r.uniformsNeedUpdate=!1)}function bt(Ar,_r){Ar.opacity.value=_r.opacity,_r.color&&Ar.diffuse.value.copy(_r.color),_r.emissive&&Ar.emissive.value.copy(_r.emissive).multiplyScalar(_r.emissiveIntensity),_r.map&&(Ar.map.value=_r.map),_r.alphaMap&&(Ar.alphaMap.value=_r.alphaMap),_r.bumpMap&&(Ar.bumpMap.value=_r.bumpMap,Ar.bumpScale.value=_r.bumpScale,_r.side===BackSide&&(Ar.bumpScale.value*=-1)),_r.displacementMap&&(Ar.displacementMap.value=_r.displacementMap,Ar.displacementScale.value=_r.displacementScale,Ar.displacementBias.value=_r.displacementBias),_r.emissiveMap&&(Ar.emissiveMap.value=_r.emissiveMap),_r.normalMap&&(Ar.normalMap.value=_r.normalMap,Ar.normalScale.value.copy(_r.normalScale),_r.side===BackSide&&Ar.normalScale.value.negate()),_r.specularMap&&(Ar.specularMap.value=_r.specularMap),_r.alphaTest>0&&(Ar.alphaTest.value=_r.alphaTest);const Dr=_.get(_r).envMap;if(Dr&&(Ar.envMap.value=Dr,Ar.flipEnvMap.value=Dr.isCubeTexture&&Dr.isRenderTargetTexture===!1?-1:1,Ar.reflectivity.value=_r.reflectivity,Ar.ior.value=_r.ior,Ar.refractionRatio.value=_r.refractionRatio),_r.lightMap){Ar.lightMap.value=_r.lightMap;const Jr=rt.useLegacyLights===!0?Math.PI:1;Ar.lightMapIntensity.value=_r.lightMapIntensity*Jr}_r.aoMap&&(Ar.aoMap.value=_r.aoMap,Ar.aoMapIntensity.value=_r.aoMapIntensity);let $r;_r.map?$r=_r.map:_r.specularMap?$r=_r.specularMap:_r.displacementMap?$r=_r.displacementMap:_r.normalMap?$r=_r.normalMap:_r.bumpMap?$r=_r.bumpMap:_r.roughnessMap?$r=_r.roughnessMap:_r.metalnessMap?$r=_r.metalnessMap:_r.alphaMap?$r=_r.alphaMap:_r.emissiveMap?$r=_r.emissiveMap:_r.clearcoatMap?$r=_r.clearcoatMap:_r.clearcoatNormalMap?$r=_r.clearcoatNormalMap:_r.clearcoatRoughnessMap?$r=_r.clearcoatRoughnessMap:_r.iridescenceMap?$r=_r.iridescenceMap:_r.iridescenceThicknessMap?$r=_r.iridescenceThicknessMap:_r.specularIntensityMap?$r=_r.specularIntensityMap:_r.specularColorMap?$r=_r.specularColorMap:_r.transmissionMap?$r=_r.transmissionMap:_r.thicknessMap?$r=_r.thicknessMap:_r.sheenColorMap?$r=_r.sheenColorMap:_r.sheenRoughnessMap&&($r=_r.sheenRoughnessMap),$r!==void 0&&($r.isWebGLRenderTarget&&($r=$r.texture),$r.matrixAutoUpdate===!0&&$r.updateMatrix(),Ar.uvTransform.value.copy($r.matrix));let Br;_r.aoMap?Br=_r.aoMap:_r.lightMap&&(Br=_r.lightMap),Br!==void 0&&(Br.isWebGLRenderTarget&&(Br=Br.texture),Br.matrixAutoUpdate===!0&&Br.updateMatrix(),Ar.uv2Transform.value.copy(Br.matrix))}function St(Ar,_r){Ar.diffuse.value.copy(_r.color),Ar.opacity.value=_r.opacity}function Mt(Ar,_r){Ar.dashSize.value=_r.dashSize,Ar.totalSize.value=_r.dashSize+_r.gapSize,Ar.scale.value=_r.scale}function Bt(Ar,_r,Dr,$r){Ar.diffuse.value.copy(_r.color),Ar.opacity.value=_r.opacity,Ar.size.value=_r.size*Dr,Ar.scale.value=$r*.5,_r.map&&(Ar.map.value=_r.map),_r.alphaMap&&(Ar.alphaMap.value=_r.alphaMap),_r.alphaTest>0&&(Ar.alphaTest.value=_r.alphaTest);let Br;_r.map?Br=_r.map:_r.alphaMap&&(Br=_r.alphaMap),Br!==void 0&&(Br.matrixAutoUpdate===!0&&Br.updateMatrix(),Ar.uvTransform.value.copy(Br.matrix))}function Ut(Ar,_r){Ar.diffuse.value.copy(_r.color),Ar.opacity.value=_r.opacity,Ar.rotation.value=_r.rotation,_r.map&&(Ar.map.value=_r.map),_r.alphaMap&&(Ar.alphaMap.value=_r.alphaMap),_r.alphaTest>0&&(Ar.alphaTest.value=_r.alphaTest);let Dr;_r.map?Dr=_r.map:_r.alphaMap&&(Dr=_r.alphaMap),Dr!==void 0&&(Dr.matrixAutoUpdate===!0&&Dr.updateMatrix(),Ar.uvTransform.value.copy(Dr.matrix))}function Ht(Ar,_r){Ar.specular.value.copy(_r.specular),Ar.shininess.value=Math.max(_r.shininess,1e-4)}function tr(Ar,_r){_r.gradientMap&&(Ar.gradientMap.value=_r.gradientMap)}function rr(Ar,_r){Ar.roughness.value=_r.roughness,Ar.metalness.value=_r.metalness,_r.roughnessMap&&(Ar.roughnessMap.value=_r.roughnessMap),_r.metalnessMap&&(Ar.metalnessMap.value=_r.metalnessMap),_.get(_r).envMap&&(Ar.envMapIntensity.value=_r.envMapIntensity)}function sr(Ar,_r,Dr){Ar.ior.value=_r.ior,_r.sheen>0&&(Ar.sheenColor.value.copy(_r.sheenColor).multiplyScalar(_r.sheen),Ar.sheenRoughness.value=_r.sheenRoughness,_r.sheenColorMap&&(Ar.sheenColorMap.value=_r.sheenColorMap),_r.sheenRoughnessMap&&(Ar.sheenRoughnessMap.value=_r.sheenRoughnessMap)),_r.clearcoat>0&&(Ar.clearcoat.value=_r.clearcoat,Ar.clearcoatRoughness.value=_r.clearcoatRoughness,_r.clearcoatMap&&(Ar.clearcoatMap.value=_r.clearcoatMap),_r.clearcoatRoughnessMap&&(Ar.clearcoatRoughnessMap.value=_r.clearcoatRoughnessMap),_r.clearcoatNormalMap&&(Ar.clearcoatNormalScale.value.copy(_r.clearcoatNormalScale),Ar.clearcoatNormalMap.value=_r.clearcoatNormalMap,_r.side===BackSide&&Ar.clearcoatNormalScale.value.negate())),_r.iridescence>0&&(Ar.iridescence.value=_r.iridescence,Ar.iridescenceIOR.value=_r.iridescenceIOR,Ar.iridescenceThicknessMinimum.value=_r.iridescenceThicknessRange[0],Ar.iridescenceThicknessMaximum.value=_r.iridescenceThicknessRange[1],_r.iridescenceMap&&(Ar.iridescenceMap.value=_r.iridescenceMap),_r.iridescenceThicknessMap&&(Ar.iridescenceThicknessMap.value=_r.iridescenceThicknessMap)),_r.transmission>0&&(Ar.transmission.value=_r.transmission,Ar.transmissionSamplerMap.value=Dr.texture,Ar.transmissionSamplerSize.value.set(Dr.width,Dr.height),_r.transmissionMap&&(Ar.transmissionMap.value=_r.transmissionMap),Ar.thickness.value=_r.thickness,_r.thicknessMap&&(Ar.thicknessMap.value=_r.thicknessMap),Ar.attenuationDistance.value=_r.attenuationDistance,Ar.attenuationColor.value.copy(_r.attenuationColor)),Ar.specularIntensity.value=_r.specularIntensity,Ar.specularColor.value.copy(_r.specularColor),_r.specularIntensityMap&&(Ar.specularIntensityMap.value=_r.specularIntensityMap),_r.specularColorMap&&(Ar.specularColorMap.value=_r.specularColorMap)}function ar(Ar,_r){_r.matcap&&(Ar.matcap.value=_r.matcap)}function cr(Ar,_r){Ar.referencePosition.value.copy(_r.referencePosition),Ar.nearDistance.value=_r.nearDistance,Ar.farDistance.value=_r.farDistance}return{refreshFogUniforms:ut,refreshMaterialUniforms:mt}}function WebGLUniformsGroups(rt,_,ut,mt){let bt={},St={},Mt=[];const Bt=ut.isWebGL2?rt.getParameter(35375):0;function Ut($r,Br){const Jr=Br.program;mt.uniformBlockBinding($r,Jr)}function Ht($r,Br){let Jr=bt[$r.id];Jr===void 0&&(cr($r),Jr=tr($r),bt[$r.id]=Jr,$r.addEventListener("dispose",_r));const mn=Br.program;mt.updateUBOMapping($r,mn);const Mn=_.render.frame;St[$r.id]!==Mn&&(sr($r),St[$r.id]=Mn)}function tr($r){const Br=rr();$r.__bindingPointIndex=Br;const Jr=rt.createBuffer(),mn=$r.__size,Mn=$r.usage;return rt.bindBuffer(35345,Jr),rt.bufferData(35345,mn,Mn),rt.bindBuffer(35345,null),rt.bindBufferBase(35345,Br,Jr),Jr}function rr(){for(let $r=0;$r<Bt;$r++)if(Mt.indexOf($r)===-1)return Mt.push($r),$r;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function sr($r){const Br=bt[$r.id],Jr=$r.uniforms,mn=$r.__cache;rt.bindBuffer(35345,Br);for(let Mn=0,$n=Jr.length;Mn<$n;Mn++){const en=Jr[Mn];if(ar(en,Mn,mn)===!0){const In=en.__offset,Rn=Array.isArray(en.value)?en.value:[en.value];let qn=0;for(let Qn=0;Qn<Rn.length;Qn++){const xs=Rn[Qn],cs=Ar(xs);typeof xs=="number"?(en.__data[0]=xs,rt.bufferSubData(35345,In+qn,en.__data)):xs.isMatrix3?(en.__data[0]=xs.elements[0],en.__data[1]=xs.elements[1],en.__data[2]=xs.elements[2],en.__data[3]=xs.elements[0],en.__data[4]=xs.elements[3],en.__data[5]=xs.elements[4],en.__data[6]=xs.elements[5],en.__data[7]=xs.elements[0],en.__data[8]=xs.elements[6],en.__data[9]=xs.elements[7],en.__data[10]=xs.elements[8],en.__data[11]=xs.elements[0]):(xs.toArray(en.__data,qn),qn+=cs.storage/Float32Array.BYTES_PER_ELEMENT)}rt.bufferSubData(35345,In,en.__data)}}rt.bindBuffer(35345,null)}function ar($r,Br,Jr){const mn=$r.value;if(Jr[Br]===void 0){if(typeof mn=="number")Jr[Br]=mn;else{const Mn=Array.isArray(mn)?mn:[mn],$n=[];for(let en=0;en<Mn.length;en++)$n.push(Mn[en].clone());Jr[Br]=$n}return!0}else if(typeof mn=="number"){if(Jr[Br]!==mn)return Jr[Br]=mn,!0}else{const Mn=Array.isArray(Jr[Br])?Jr[Br]:[Jr[Br]],$n=Array.isArray(mn)?mn:[mn];for(let en=0;en<Mn.length;en++){const In=Mn[en];if(In.equals($n[en])===!1)return In.copy($n[en]),!0}}return!1}function cr($r){const Br=$r.uniforms;let Jr=0;const mn=16;let Mn=0;for(let $n=0,en=Br.length;$n<en;$n++){const In=Br[$n],Rn={boundary:0,storage:0},qn=Array.isArray(In.value)?In.value:[In.value];for(let Qn=0,xs=qn.length;Qn<xs;Qn++){const cs=qn[Qn],ks=Ar(cs);Rn.boundary+=ks.boundary,Rn.storage+=ks.storage}if(In.__data=new Float32Array(Rn.storage/Float32Array.BYTES_PER_ELEMENT),In.__offset=Jr,$n>0){Mn=Jr%mn;const Qn=mn-Mn;Mn!==0&&Qn-Rn.boundary<0&&(Jr+=mn-Mn,In.__offset=Jr)}Jr+=Rn.storage}return Mn=Jr%mn,Mn>0&&(Jr+=mn-Mn),$r.__size=Jr,$r.__cache={},this}function Ar($r){const Br={boundary:0,storage:0};return typeof $r=="number"?(Br.boundary=4,Br.storage=4):$r.isVector2?(Br.boundary=8,Br.storage=8):$r.isVector3||$r.isColor?(Br.boundary=16,Br.storage=12):$r.isVector4?(Br.boundary=16,Br.storage=16):$r.isMatrix3?(Br.boundary=48,Br.storage=48):$r.isMatrix4?(Br.boundary=64,Br.storage=64):$r.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",$r),Br}function _r($r){const Br=$r.target;Br.removeEventListener("dispose",_r);const Jr=Mt.indexOf(Br.__bindingPointIndex);Mt.splice(Jr,1),rt.deleteBuffer(bt[Br.id]),delete bt[Br.id],delete St[Br.id]}function Dr(){for(const $r in bt)rt.deleteBuffer(bt[$r]);Mt=[],bt={},St={}}return{bind:Ut,update:Ht,dispose:Dr}}function createCanvasElement(){const rt=createElementNS("canvas");return rt.style.display="block",rt}function WebGLRenderer(rt={}){this.isWebGLRenderer=!0;const _=rt.canvas!==void 0?rt.canvas:createCanvasElement(),ut=rt.context!==void 0?rt.context:null,mt=rt.depth!==void 0?rt.depth:!0,bt=rt.stencil!==void 0?rt.stencil:!0,St=rt.antialias!==void 0?rt.antialias:!1,Mt=rt.premultipliedAlpha!==void 0?rt.premultipliedAlpha:!0,Bt=rt.preserveDrawingBuffer!==void 0?rt.preserveDrawingBuffer:!1,Ut=rt.powerPreference!==void 0?rt.powerPreference:"default",Ht=rt.failIfMajorPerformanceCaveat!==void 0?rt.failIfMajorPerformanceCaveat:!1;let tr;ut!==null?tr=ut.getContextAttributes().alpha:tr=rt.alpha!==void 0?rt.alpha:!1;let rr=null,sr=null;const ar=[],cr=[];this.domElement=_,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=LinearEncoding$1,this.useLegacyLights=!0,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const Ar=this;let _r=!1,Dr=0,$r=0,Br=null,Jr=-1,mn=null;const Mn=new Vector4,$n=new Vector4;let en=null,In=_.width,Rn=_.height,qn=1,Qn=null,xs=null;const cs=new Vector4(0,0,In,Rn),ks=new Vector4(0,0,In,Rn);let _o=!1;const qs=new Frustum;let Ss=!1,eo=!1,Ao=null;const Oo=new Matrix4,uo=new Vector3,uu={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function cu(){return Br===null?qn:1}let Jl=ut;function mu(Pp,tv){for(let ov=0;ov<Pp.length;ov++){const p0=Pp[ov],bv=_.getContext(p0,tv);if(bv!==null)return bv}return null}try{const Pp={alpha:!0,depth:mt,stencil:bt,antialias:St,premultipliedAlpha:Mt,preserveDrawingBuffer:Bt,powerPreference:Ut,failIfMajorPerformanceCaveat:Ht};if("setAttribute"in _&&_.setAttribute("data-engine",`three.js r${REVISION}`),_.addEventListener("webglcontextlost",Gv,!1),_.addEventListener("webglcontextrestored",Dv,!1),_.addEventListener("webglcontextcreationerror",Cv,!1),Jl===null){const tv=["webgl2","webgl","experimental-webgl"];if(Ar.isWebGL1Renderer===!0&&tv.shift(),Jl=mu(tv,Pp),Jl===null)throw mu(tv)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Jl.getShaderPrecisionFormat===void 0&&(Jl.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Pp){throw console.error("THREE.WebGLRenderer: "+Pp.message),Pp}let pu,Zu,Mp,Up,Ep,mp,Cp,t0,_g,m0,K0,Jp,y0,z0,jm,Nu,Co,Bp,a0,Q0,T0,av,lv,N0;function zv(){pu=new WebGLExtensions(Jl),Zu=new WebGLCapabilities(Jl,pu,rt),pu.init(Zu),av=new WebGLUtils(Jl,pu,Zu),Mp=new WebGLState(Jl,pu,Zu),Up=new WebGLInfo,Ep=new WebGLProperties,mp=new WebGLTextures(Jl,pu,Mp,Ep,Zu,av,Up),Cp=new WebGLCubeMaps(Ar),t0=new WebGLCubeUVMaps(Ar),_g=new WebGLAttributes(Jl,Zu),lv=new WebGLBindingStates(Jl,pu,_g,Zu),m0=new WebGLGeometries(Jl,_g,Up,lv),K0=new WebGLObjects(Jl,m0,_g,Up),a0=new WebGLMorphtargets(Jl,Zu,mp),Nu=new WebGLClipping(Ep),Jp=new WebGLPrograms(Ar,Cp,t0,pu,Zu,lv,Nu),y0=new WebGLMaterials(Ar,Ep),z0=new WebGLRenderLists,jm=new WebGLRenderStates(pu,Zu),Bp=new WebGLBackground(Ar,Cp,t0,Mp,K0,tr,Mt),Co=new WebGLShadowMap(Ar,K0,Zu),N0=new WebGLUniformsGroups(Jl,Up,Zu,Mp),Q0=new WebGLBufferRenderer(Jl,pu,Up,Zu),T0=new WebGLIndexedBufferRenderer(Jl,pu,Up,Zu),Up.programs=Jp.programs,Ar.capabilities=Zu,Ar.extensions=pu,Ar.properties=Ep,Ar.renderLists=z0,Ar.shadowMap=Co,Ar.state=Mp,Ar.info=Up}zv();const Uv=new WebXRManager(Ar,Jl);this.xr=Uv,this.getContext=function(){return Jl},this.getContextAttributes=function(){return Jl.getContextAttributes()},this.forceContextLoss=function(){const Pp=pu.get("WEBGL_lose_context");Pp&&Pp.loseContext()},this.forceContextRestore=function(){const Pp=pu.get("WEBGL_lose_context");Pp&&Pp.restoreContext()},this.getPixelRatio=function(){return qn},this.setPixelRatio=function(Pp){Pp!==void 0&&(qn=Pp,this.setSize(In,Rn,!1))},this.getSize=function(Pp){return Pp.set(In,Rn)},this.setSize=function(Pp,tv,ov=!0){if(Uv.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}In=Pp,Rn=tv,_.width=Math.floor(Pp*qn),_.height=Math.floor(tv*qn),ov===!0&&(_.style.width=Pp+"px",_.style.height=tv+"px"),this.setViewport(0,0,Pp,tv)},this.getDrawingBufferSize=function(Pp){return Pp.set(In*qn,Rn*qn).floor()},this.setDrawingBufferSize=function(Pp,tv,ov){In=Pp,Rn=tv,qn=ov,_.width=Math.floor(Pp*ov),_.height=Math.floor(tv*ov),this.setViewport(0,0,Pp,tv)},this.getCurrentViewport=function(Pp){return Pp.copy(Mn)},this.getViewport=function(Pp){return Pp.copy(cs)},this.setViewport=function(Pp,tv,ov,p0){Pp.isVector4?cs.set(Pp.x,Pp.y,Pp.z,Pp.w):cs.set(Pp,tv,ov,p0),Mp.viewport(Mn.copy(cs).multiplyScalar(qn).floor())},this.getScissor=function(Pp){return Pp.copy(ks)},this.setScissor=function(Pp,tv,ov,p0){Pp.isVector4?ks.set(Pp.x,Pp.y,Pp.z,Pp.w):ks.set(Pp,tv,ov,p0),Mp.scissor($n.copy(ks).multiplyScalar(qn).floor())},this.getScissorTest=function(){return _o},this.setScissorTest=function(Pp){Mp.setScissorTest(_o=Pp)},this.setOpaqueSort=function(Pp){Qn=Pp},this.setTransparentSort=function(Pp){xs=Pp},this.getClearColor=function(Pp){return Pp.copy(Bp.getClearColor())},this.setClearColor=function(){Bp.setClearColor.apply(Bp,arguments)},this.getClearAlpha=function(){return Bp.getClearAlpha()},this.setClearAlpha=function(){Bp.setClearAlpha.apply(Bp,arguments)},this.clear=function(Pp=!0,tv=!0,ov=!0){let p0=0;Pp&&(p0|=16384),tv&&(p0|=256),ov&&(p0|=1024),Jl.clear(p0)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){_.removeEventListener("webglcontextlost",Gv,!1),_.removeEventListener("webglcontextrestored",Dv,!1),_.removeEventListener("webglcontextcreationerror",Cv,!1),z0.dispose(),jm.dispose(),Ep.dispose(),Cp.dispose(),t0.dispose(),K0.dispose(),lv.dispose(),N0.dispose(),Jp.dispose(),Uv.dispose(),Uv.removeEventListener("sessionstart",nv),Uv.removeEventListener("sessionend",qy),Ao&&(Ao.dispose(),Ao=null),Uy.stop()};function Gv(Pp){Pp.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_r=!0}function Dv(){console.log("THREE.WebGLRenderer: Context Restored."),_r=!1;const Pp=Up.autoReset,tv=Co.enabled,ov=Co.autoUpdate,p0=Co.needsUpdate,bv=Co.type;zv(),Up.autoReset=Pp,Co.enabled=tv,Co.autoUpdate=ov,Co.needsUpdate=p0,Co.type=bv}function Cv(Pp){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Pp.statusMessage)}function Kp(Pp){const tv=Pp.target;tv.removeEventListener("dispose",Kp),sv(tv)}function sv(Pp){Hv(Pp),Ep.remove(Pp)}function Hv(Pp){const tv=Ep.get(Pp).programs;tv!==void 0&&(tv.forEach(function(ov){Jp.releaseProgram(ov)}),Pp.isShaderMaterial&&Jp.releaseShaderCache(Pp))}this.renderBufferDirect=function(Pp,tv,ov,p0,bv,Dx){tv===null&&(tv=uu);const ru=bv.isMesh&&bv.matrixWorld.determinant()<0,Iu=X2(Pp,tv,ov,p0,bv);Mp.setMaterial(p0,ru);let Hp=ov.index,M0=1;p0.wireframe===!0&&(Hp=m0.getWireframeAttribute(ov),M0=2);const H0=ov.drawRange,Z0=ov.attributes.position;let Fv=H0.start*M0,kv=(H0.start+H0.count)*M0;Dx!==null&&(Fv=Math.max(Fv,Dx.start*M0),kv=Math.min(kv,(Dx.start+Dx.count)*M0)),Hp!==null?(Fv=Math.max(Fv,0),kv=Math.min(kv,Hp.count)):Z0!=null&&(Fv=Math.max(Fv,0),kv=Math.min(kv,Z0.count));const Dy=kv-Fv;if(Dy<0||Dy===1/0)return;lv.setup(bv,p0,Iu,ov,Hp);let Gy,jv=Q0;if(Hp!==null&&(Gy=_g.get(Hp),jv=T0,jv.setIndex(Gy)),bv.isMesh)p0.wireframe===!0?(Mp.setLineWidth(p0.wireframeLinewidth*cu()),jv.setMode(1)):jv.setMode(4);else if(bv.isLine){let I0=p0.linewidth;I0===void 0&&(I0=1),Mp.setLineWidth(I0*cu()),bv.isLineSegments?jv.setMode(1):bv.isLineLoop?jv.setMode(2):jv.setMode(3)}else bv.isPoints?jv.setMode(0):bv.isSprite&&jv.setMode(4);if(bv.isInstancedMesh)jv.renderInstances(Fv,Dy,bv.count);else if(ov.isInstancedBufferGeometry){const I0=ov._maxInstanceCount!==void 0?ov._maxInstanceCount:1/0,M2=Math.min(ov.instanceCount,I0);jv.renderInstances(Fv,Dy,M2)}else jv.render(Fv,Dy)},this.compile=function(Pp,tv){function ov(p0,bv,Dx){p0.transparent===!0&&p0.side===DoubleSide&&p0.forceSinglePass===!1?(p0.side=BackSide,p0.needsUpdate=!0,E2(p0,bv,Dx),p0.side=FrontSide,p0.needsUpdate=!0,E2(p0,bv,Dx),p0.side=DoubleSide):E2(p0,bv,Dx)}sr=jm.get(Pp),sr.init(),cr.push(sr),Pp.traverseVisible(function(p0){p0.isLight&&p0.layers.test(tv.layers)&&(sr.pushLight(p0),p0.castShadow&&sr.pushShadow(p0))}),sr.setupLights(Ar.useLegacyLights),Pp.traverse(function(p0){const bv=p0.material;if(bv)if(Array.isArray(bv))for(let Dx=0;Dx<bv.length;Dx++){const ru=bv[Dx];ov(ru,Pp,p0)}else ov(bv,Pp,p0)}),cr.pop(),sr=null};let jp=null;function Fp(Pp){jp&&jp(Pp)}function nv(){Uy.stop()}function qy(){Uy.start()}const Uy=new WebGLAnimation;Uy.setAnimationLoop(Fp),typeof self<"u"&&Uy.setContext(self),this.setAnimationLoop=function(Pp){jp=Pp,Uv.setAnimationLoop(Pp),Pp===null?Uy.stop():Uy.start()},Uv.addEventListener("sessionstart",nv),Uv.addEventListener("sessionend",qy),this.render=function(Pp,tv){if(tv!==void 0&&tv.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_r===!0)return;Pp.matrixWorldAutoUpdate===!0&&Pp.updateMatrixWorld(),tv.parent===null&&tv.matrixWorldAutoUpdate===!0&&tv.updateMatrixWorld(),Uv.enabled===!0&&Uv.isPresenting===!0&&(Uv.cameraAutoUpdate===!0&&Uv.updateCamera(tv),tv=Uv.getCamera()),Pp.isScene===!0&&Pp.onBeforeRender(Ar,Pp,tv,Br),sr=jm.get(Pp,cr.length),sr.init(),cr.push(sr),Oo.multiplyMatrices(tv.projectionMatrix,tv.matrixWorldInverse),qs.setFromProjectionMatrix(Oo),eo=this.localClippingEnabled,Ss=Nu.init(this.clippingPlanes,eo),rr=z0.get(Pp,ar.length),rr.init(),ar.push(rr),vx(Pp,tv,0,Ar.sortObjects),rr.finish(),Ar.sortObjects===!0&&rr.sort(Qn,xs),Ss===!0&&Nu.beginShadows();const ov=sr.state.shadowsArray;if(Co.render(ov,Pp,tv),Ss===!0&&Nu.endShadows(),this.info.autoReset===!0&&this.info.reset(),Bp.render(rr,Pp),sr.setupLights(Ar.useLegacyLights),tv.isArrayCamera){const p0=tv.cameras;for(let bv=0,Dx=p0.length;bv<Dx;bv++){const ru=p0[bv];qx(rr,Pp,ru,ru.viewport)}}else qx(rr,Pp,tv);Br!==null&&(mp.updateMultisampleRenderTarget(Br),mp.updateRenderTargetMipmap(Br)),Pp.isScene===!0&&Pp.onAfterRender(Ar,Pp,tv),lv.resetDefaultState(),Jr=-1,mn=null,cr.pop(),cr.length>0?sr=cr[cr.length-1]:sr=null,ar.pop(),ar.length>0?rr=ar[ar.length-1]:rr=null};function vx(Pp,tv,ov,p0){if(Pp.visible===!1)return;if(Pp.layers.test(tv.layers)){if(Pp.isGroup)ov=Pp.renderOrder;else if(Pp.isLOD)Pp.autoUpdate===!0&&Pp.update(tv);else if(Pp.isLight)sr.pushLight(Pp),Pp.castShadow&&sr.pushShadow(Pp);else if(Pp.isSprite){if(!Pp.frustumCulled||qs.intersectsSprite(Pp)){p0&&uo.setFromMatrixPosition(Pp.matrixWorld).applyMatrix4(Oo);const ru=K0.update(Pp),Iu=Pp.material;Iu.visible&&rr.push(Pp,ru,Iu,ov,uo.z,null)}}else if((Pp.isMesh||Pp.isLine||Pp.isPoints)&&(Pp.isSkinnedMesh&&Pp.skeleton.frame!==Up.render.frame&&(Pp.skeleton.update(),Pp.skeleton.frame=Up.render.frame),!Pp.frustumCulled||qs.intersectsObject(Pp))){p0&&uo.setFromMatrixPosition(Pp.matrixWorld).applyMatrix4(Oo);const ru=K0.update(Pp),Iu=Pp.material;if(Array.isArray(Iu)){const Hp=ru.groups;for(let M0=0,H0=Hp.length;M0<H0;M0++){const Z0=Hp[M0],Fv=Iu[Z0.materialIndex];Fv&&Fv.visible&&rr.push(Pp,ru,Fv,ov,uo.z,Z0)}}else Iu.visible&&rr.push(Pp,ru,Iu,ov,uo.z,null)}}const Dx=Pp.children;for(let ru=0,Iu=Dx.length;ru<Iu;ru++)vx(Dx[ru],tv,ov,p0)}function qx(Pp,tv,ov,p0){const bv=Pp.opaque,Dx=Pp.transmissive,ru=Pp.transparent;sr.setupLightsView(ov),Ss===!0&&Nu.setGlobalState(Ar.clippingPlanes,ov),Dx.length>0&&Kx(bv,tv,ov),p0&&Mp.viewport(Mn.copy(p0)),bv.length>0&&Mx(bv,tv,ov),Dx.length>0&&Mx(Dx,tv,ov),ru.length>0&&Mx(ru,tv,ov),Mp.buffers.depth.setTest(!0),Mp.buffers.depth.setMask(!0),Mp.buffers.color.setMask(!0),Mp.setPolygonOffset(!1)}function Kx(Pp,tv,ov){const p0=Zu.isWebGL2;Ao===null&&(Ao=new WebGLRenderTarget(1024,1024,{generateMipmaps:!0,type:pu.has("EXT_color_buffer_half_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:p0&&St===!0?4:0}));const bv=Ar.getRenderTarget();Ar.setRenderTarget(Ao),Ar.clear();const Dx=Ar.toneMapping;Ar.toneMapping=NoToneMapping,Mx(Pp,tv,ov),Ar.toneMapping=Dx,mp.updateMultisampleRenderTarget(Ao),mp.updateRenderTargetMipmap(Ao),Ar.setRenderTarget(bv)}function Mx(Pp,tv,ov){const p0=tv.isScene===!0?tv.overrideMaterial:null;for(let bv=0,Dx=Pp.length;bv<Dx;bv++){const ru=Pp[bv],Iu=ru.object,Hp=ru.geometry,M0=p0===null?ru.material:p0,H0=ru.group;Iu.layers.test(ov.layers)&&Ox(Iu,tv,ov,Hp,M0,H0)}}function Ox(Pp,tv,ov,p0,bv,Dx){Pp.onBeforeRender(Ar,tv,ov,p0,bv,Dx),Pp.modelViewMatrix.multiplyMatrices(ov.matrixWorldInverse,Pp.matrixWorld),Pp.normalMatrix.getNormalMatrix(Pp.modelViewMatrix),bv.onBeforeRender(Ar,tv,ov,p0,Pp,Dx),bv.transparent===!0&&bv.side===DoubleSide&&bv.forceSinglePass===!1?(bv.side=BackSide,bv.needsUpdate=!0,Ar.renderBufferDirect(ov,tv,p0,bv,Pp,Dx),bv.side=FrontSide,bv.needsUpdate=!0,Ar.renderBufferDirect(ov,tv,p0,bv,Pp,Dx),bv.side=DoubleSide):Ar.renderBufferDirect(ov,tv,p0,bv,Pp,Dx),Pp.onAfterRender(Ar,tv,ov,p0,bv,Dx)}function E2(Pp,tv,ov){tv.isScene!==!0&&(tv=uu);const p0=Ep.get(Pp),bv=sr.state.lights,Dx=sr.state.shadowsArray,ru=bv.state.version,Iu=Jp.getParameters(Pp,bv.state,Dx,tv,ov),Hp=Jp.getProgramCacheKey(Iu);let M0=p0.programs;p0.environment=Pp.isMeshStandardMaterial?tv.environment:null,p0.fog=tv.fog,p0.envMap=(Pp.isMeshStandardMaterial?t0:Cp).get(Pp.envMap||p0.environment),M0===void 0&&(Pp.addEventListener("dispose",Kp),M0=new Map,p0.programs=M0);let H0=M0.get(Hp);if(H0!==void 0){if(p0.currentProgram===H0&&p0.lightsStateVersion===ru)return $2(Pp,Iu),H0}else Iu.uniforms=Jp.getUniforms(Pp),Pp.onBuild(ov,Iu,Ar),Pp.onBeforeCompile(Iu,Ar),H0=Jp.acquireProgram(Iu,Hp),M0.set(Hp,H0),p0.uniforms=Iu.uniforms;const Z0=p0.uniforms;(!Pp.isShaderMaterial&&!Pp.isRawShaderMaterial||Pp.clipping===!0)&&(Z0.clippingPlanes=Nu.uniform),$2(Pp,Iu),p0.needsLights=mE(Pp),p0.lightsStateVersion=ru,p0.needsLights&&(Z0.ambientLightColor.value=bv.state.ambient,Z0.lightProbe.value=bv.state.probe,Z0.directionalLights.value=bv.state.directional,Z0.directionalLightShadows.value=bv.state.directionalShadow,Z0.spotLights.value=bv.state.spot,Z0.spotLightShadows.value=bv.state.spotShadow,Z0.rectAreaLights.value=bv.state.rectArea,Z0.ltc_1.value=bv.state.rectAreaLTC1,Z0.ltc_2.value=bv.state.rectAreaLTC2,Z0.pointLights.value=bv.state.point,Z0.pointLightShadows.value=bv.state.pointShadow,Z0.hemisphereLights.value=bv.state.hemi,Z0.directionalShadowMap.value=bv.state.directionalShadowMap,Z0.directionalShadowMatrix.value=bv.state.directionalShadowMatrix,Z0.spotShadowMap.value=bv.state.spotShadowMap,Z0.spotLightMatrix.value=bv.state.spotLightMatrix,Z0.spotLightMap.value=bv.state.spotLightMap,Z0.pointShadowMap.value=bv.state.pointShadowMap,Z0.pointShadowMatrix.value=bv.state.pointShadowMatrix);const Fv=H0.getUniforms(),kv=WebGLUniforms.seqWithValue(Fv.seq,Z0);return p0.currentProgram=H0,p0.uniformsList=kv,H0}function $2(Pp,tv){const ov=Ep.get(Pp);ov.outputEncoding=tv.outputEncoding,ov.instancing=tv.instancing,ov.skinning=tv.skinning,ov.morphTargets=tv.morphTargets,ov.morphNormals=tv.morphNormals,ov.morphColors=tv.morphColors,ov.morphTargetsCount=tv.morphTargetsCount,ov.numClippingPlanes=tv.numClippingPlanes,ov.numIntersection=tv.numClipIntersection,ov.vertexAlphas=tv.vertexAlphas,ov.vertexTangents=tv.vertexTangents,ov.toneMapping=tv.toneMapping}function X2(Pp,tv,ov,p0,bv){tv.isScene!==!0&&(tv=uu),mp.resetTextureUnits();const Dx=tv.fog,ru=p0.isMeshStandardMaterial?tv.environment:null,Iu=Br===null?Ar.outputEncoding:Br.isXRRenderTarget===!0?Br.texture.encoding:LinearEncoding$1,Hp=(p0.isMeshStandardMaterial?t0:Cp).get(p0.envMap||ru),M0=p0.vertexColors===!0&&!!ov.attributes.color&&ov.attributes.color.itemSize===4,H0=!!p0.normalMap&&!!ov.attributes.tangent,Z0=!!ov.morphAttributes.position,Fv=!!ov.morphAttributes.normal,kv=!!ov.morphAttributes.color,Dy=p0.toneMapped?Ar.toneMapping:NoToneMapping,Gy=ov.morphAttributes.position||ov.morphAttributes.normal||ov.morphAttributes.color,jv=Gy!==void 0?Gy.length:0,I0=Ep.get(p0),M2=sr.state.lights;if(Ss===!0&&(eo===!0||Pp!==mn)){const Yx=Pp===mn&&p0.id===Jr;Nu.setState(p0,Pp,Yx)}let dx=!1;p0.version===I0.__version?(I0.needsLights&&I0.lightsStateVersion!==M2.state.version||I0.outputEncoding!==Iu||bv.isInstancedMesh&&I0.instancing===!1||!bv.isInstancedMesh&&I0.instancing===!0||bv.isSkinnedMesh&&I0.skinning===!1||!bv.isSkinnedMesh&&I0.skinning===!0||I0.envMap!==Hp||p0.fog===!0&&I0.fog!==Dx||I0.numClippingPlanes!==void 0&&(I0.numClippingPlanes!==Nu.numPlanes||I0.numIntersection!==Nu.numIntersection)||I0.vertexAlphas!==M0||I0.vertexTangents!==H0||I0.morphTargets!==Z0||I0.morphNormals!==Fv||I0.morphColors!==kv||I0.toneMapping!==Dy||Zu.isWebGL2===!0&&I0.morphTargetsCount!==jv)&&(dx=!0):(dx=!0,I0.__version=p0.version);let bx=I0.currentProgram;dx===!0&&(bx=E2(p0,tv,bv));let Jx=!1,t2=!1,y2=!1;const Hx=bx.getUniforms(),$x=I0.uniforms;if(Mp.useProgram(bx.program)&&(Jx=!0,t2=!0,y2=!0),p0.id!==Jr&&(Jr=p0.id,t2=!0),Jx||mn!==Pp){if(Hx.setValue(Jl,"projectionMatrix",Pp.projectionMatrix),Zu.logarithmicDepthBuffer&&Hx.setValue(Jl,"logDepthBufFC",2/(Math.log(Pp.far+1)/Math.LN2)),mn!==Pp&&(mn=Pp,t2=!0,y2=!0),p0.isShaderMaterial||p0.isMeshPhongMaterial||p0.isMeshToonMaterial||p0.isMeshStandardMaterial||p0.envMap){const Yx=Hx.map.cameraPosition;Yx!==void 0&&Yx.setValue(Jl,uo.setFromMatrixPosition(Pp.matrixWorld))}(p0.isMeshPhongMaterial||p0.isMeshToonMaterial||p0.isMeshLambertMaterial||p0.isMeshBasicMaterial||p0.isMeshStandardMaterial||p0.isShaderMaterial)&&Hx.setValue(Jl,"isOrthographic",Pp.isOrthographicCamera===!0),(p0.isMeshPhongMaterial||p0.isMeshToonMaterial||p0.isMeshLambertMaterial||p0.isMeshBasicMaterial||p0.isMeshStandardMaterial||p0.isShaderMaterial||p0.isShadowMaterial||bv.isSkinnedMesh)&&Hx.setValue(Jl,"viewMatrix",Pp.matrixWorldInverse)}if(bv.isSkinnedMesh){Hx.setOptional(Jl,bv,"bindMatrix"),Hx.setOptional(Jl,bv,"bindMatrixInverse");const Yx=bv.skeleton;Yx&&(Zu.floatVertexTextures?(Yx.boneTexture===null&&Yx.computeBoneTexture(),Hx.setValue(Jl,"boneTexture",Yx.boneTexture,mp),Hx.setValue(Jl,"boneTextureSize",Yx.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const r2=ov.morphAttributes;if((r2.position!==void 0||r2.normal!==void 0||r2.color!==void 0&&Zu.isWebGL2===!0)&&a0.update(bv,ov,bx),(t2||I0.receiveShadow!==bv.receiveShadow)&&(I0.receiveShadow=bv.receiveShadow,Hx.setValue(Jl,"receiveShadow",bv.receiveShadow)),p0.isMeshGouraudMaterial&&p0.envMap!==null&&($x.envMap.value=Hp,$x.flipEnvMap.value=Hp.isCubeTexture&&Hp.isRenderTargetTexture===!1?-1:1),t2&&(Hx.setValue(Jl,"toneMappingExposure",Ar.toneMappingExposure),I0.needsLights&&_E($x,y2),Dx&&p0.fog===!0&&y0.refreshFogUniforms($x,Dx),y0.refreshMaterialUniforms($x,p0,qn,Rn,Ao),WebGLUniforms.upload(Jl,I0.uniformsList,$x,mp)),p0.isShaderMaterial&&p0.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(Jl,I0.uniformsList,$x,mp),p0.uniformsNeedUpdate=!1),p0.isSpriteMaterial&&Hx.setValue(Jl,"center",bv.center),Hx.setValue(Jl,"modelViewMatrix",bv.modelViewMatrix),Hx.setValue(Jl,"normalMatrix",bv.normalMatrix),Hx.setValue(Jl,"modelMatrix",bv.matrixWorld),p0.isShaderMaterial||p0.isRawShaderMaterial){const Yx=p0.uniformsGroups;for(let I2=0,d2=Yx.length;I2<d2;I2++)if(Zu.isWebGL2){const V2=Yx[I2];N0.update(V2,bx),N0.bind(V2,bx)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return bx}function _E(Pp,tv){Pp.ambientLightColor.needsUpdate=tv,Pp.lightProbe.needsUpdate=tv,Pp.directionalLights.needsUpdate=tv,Pp.directionalLightShadows.needsUpdate=tv,Pp.pointLights.needsUpdate=tv,Pp.pointLightShadows.needsUpdate=tv,Pp.spotLights.needsUpdate=tv,Pp.spotLightShadows.needsUpdate=tv,Pp.rectAreaLights.needsUpdate=tv,Pp.hemisphereLights.needsUpdate=tv}function mE(Pp){return Pp.isMeshLambertMaterial||Pp.isMeshToonMaterial||Pp.isMeshPhongMaterial||Pp.isMeshStandardMaterial||Pp.isShadowMaterial||Pp.isShaderMaterial&&Pp.lights===!0}this.getActiveCubeFace=function(){return Dr},this.getActiveMipmapLevel=function(){return $r},this.getRenderTarget=function(){return Br},this.setRenderTargetTextures=function(Pp,tv,ov){Ep.get(Pp.texture).__webglTexture=tv,Ep.get(Pp.depthTexture).__webglTexture=ov;const p0=Ep.get(Pp);p0.__hasExternalTextures=!0,p0.__hasExternalTextures&&(p0.__autoAllocateDepthBuffer=ov===void 0,p0.__autoAllocateDepthBuffer||pu.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),p0.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Pp,tv){const ov=Ep.get(Pp);ov.__webglFramebuffer=tv,ov.__useDefaultFramebuffer=tv===void 0},this.setRenderTarget=function(Pp,tv=0,ov=0){Br=Pp,Dr=tv,$r=ov;let p0=!0,bv=null,Dx=!1,ru=!1;if(Pp){const Hp=Ep.get(Pp);Hp.__useDefaultFramebuffer!==void 0?(Mp.bindFramebuffer(36160,null),p0=!1):Hp.__webglFramebuffer===void 0?mp.setupRenderTarget(Pp):Hp.__hasExternalTextures&&mp.rebindTextures(Pp,Ep.get(Pp.texture).__webglTexture,Ep.get(Pp.depthTexture).__webglTexture);const M0=Pp.texture;(M0.isData3DTexture||M0.isDataArrayTexture||M0.isCompressedArrayTexture)&&(ru=!0);const H0=Ep.get(Pp).__webglFramebuffer;Pp.isWebGLCubeRenderTarget?(bv=H0[tv],Dx=!0):Zu.isWebGL2&&Pp.samples>0&&mp.useMultisampledRTT(Pp)===!1?bv=Ep.get(Pp).__webglMultisampledFramebuffer:bv=H0,Mn.copy(Pp.viewport),$n.copy(Pp.scissor),en=Pp.scissorTest}else Mn.copy(cs).multiplyScalar(qn).floor(),$n.copy(ks).multiplyScalar(qn).floor(),en=_o;if(Mp.bindFramebuffer(36160,bv)&&Zu.drawBuffers&&p0&&Mp.drawBuffers(Pp,bv),Mp.viewport(Mn),Mp.scissor($n),Mp.setScissorTest(en),Dx){const Hp=Ep.get(Pp.texture);Jl.framebufferTexture2D(36160,36064,34069+tv,Hp.__webglTexture,ov)}else if(ru){const Hp=Ep.get(Pp.texture),M0=tv||0;Jl.framebufferTextureLayer(36160,36064,Hp.__webglTexture,ov||0,M0)}Jr=-1},this.readRenderTargetPixels=function(Pp,tv,ov,p0,bv,Dx,ru){if(!(Pp&&Pp.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Iu=Ep.get(Pp).__webglFramebuffer;if(Pp.isWebGLCubeRenderTarget&&ru!==void 0&&(Iu=Iu[ru]),Iu){Mp.bindFramebuffer(36160,Iu);try{const Hp=Pp.texture,M0=Hp.format,H0=Hp.type;if(M0!==RGBAFormat&&av.convert(M0)!==Jl.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Z0=H0===HalfFloatType&&(pu.has("EXT_color_buffer_half_float")||Zu.isWebGL2&&pu.has("EXT_color_buffer_float"));if(H0!==UnsignedByteType&&av.convert(H0)!==Jl.getParameter(35738)&&!(H0===FloatType&&(Zu.isWebGL2||pu.has("OES_texture_float")||pu.has("WEBGL_color_buffer_float")))&&!Z0){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}tv>=0&&tv<=Pp.width-p0&&ov>=0&&ov<=Pp.height-bv&&Jl.readPixels(tv,ov,p0,bv,av.convert(M0),av.convert(H0),Dx)}finally{const Hp=Br!==null?Ep.get(Br).__webglFramebuffer:null;Mp.bindFramebuffer(36160,Hp)}}},this.copyFramebufferToTexture=function(Pp,tv,ov=0){const p0=Math.pow(2,-ov),bv=Math.floor(tv.image.width*p0),Dx=Math.floor(tv.image.height*p0);mp.setTexture2D(tv,0),Jl.copyTexSubImage2D(3553,ov,0,0,Pp.x,Pp.y,bv,Dx),Mp.unbindTexture()},this.copyTextureToTexture=function(Pp,tv,ov,p0=0){const bv=tv.image.width,Dx=tv.image.height,ru=av.convert(ov.format),Iu=av.convert(ov.type);mp.setTexture2D(ov,0),Jl.pixelStorei(37440,ov.flipY),Jl.pixelStorei(37441,ov.premultiplyAlpha),Jl.pixelStorei(3317,ov.unpackAlignment),tv.isDataTexture?Jl.texSubImage2D(3553,p0,Pp.x,Pp.y,bv,Dx,ru,Iu,tv.image.data):tv.isCompressedTexture?Jl.compressedTexSubImage2D(3553,p0,Pp.x,Pp.y,tv.mipmaps[0].width,tv.mipmaps[0].height,ru,tv.mipmaps[0].data):Jl.texSubImage2D(3553,p0,Pp.x,Pp.y,ru,Iu,tv.image),p0===0&&ov.generateMipmaps&&Jl.generateMipmap(3553),Mp.unbindTexture()},this.copyTextureToTexture3D=function(Pp,tv,ov,p0,bv=0){if(Ar.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Dx=Pp.max.x-Pp.min.x+1,ru=Pp.max.y-Pp.min.y+1,Iu=Pp.max.z-Pp.min.z+1,Hp=av.convert(p0.format),M0=av.convert(p0.type);let H0;if(p0.isData3DTexture)mp.setTexture3D(p0,0),H0=32879;else if(p0.isDataArrayTexture)mp.setTexture2DArray(p0,0),H0=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Jl.pixelStorei(37440,p0.flipY),Jl.pixelStorei(37441,p0.premultiplyAlpha),Jl.pixelStorei(3317,p0.unpackAlignment);const Z0=Jl.getParameter(3314),Fv=Jl.getParameter(32878),kv=Jl.getParameter(3316),Dy=Jl.getParameter(3315),Gy=Jl.getParameter(32877),jv=ov.isCompressedTexture?ov.mipmaps[0]:ov.image;Jl.pixelStorei(3314,jv.width),Jl.pixelStorei(32878,jv.height),Jl.pixelStorei(3316,Pp.min.x),Jl.pixelStorei(3315,Pp.min.y),Jl.pixelStorei(32877,Pp.min.z),ov.isDataTexture||ov.isData3DTexture?Jl.texSubImage3D(H0,bv,tv.x,tv.y,tv.z,Dx,ru,Iu,Hp,M0,jv.data):ov.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Jl.compressedTexSubImage3D(H0,bv,tv.x,tv.y,tv.z,Dx,ru,Iu,Hp,jv.data)):Jl.texSubImage3D(H0,bv,tv.x,tv.y,tv.z,Dx,ru,Iu,Hp,M0,jv),Jl.pixelStorei(3314,Z0),Jl.pixelStorei(32878,Fv),Jl.pixelStorei(3316,kv),Jl.pixelStorei(3315,Dy),Jl.pixelStorei(32877,Gy),bv===0&&p0.generateMipmaps&&Jl.generateMipmap(H0),Mp.unbindTexture()},this.initTexture=function(Pp){Pp.isCubeTexture?mp.setTextureCube(Pp,0):Pp.isData3DTexture?mp.setTexture3D(Pp,0):Pp.isDataArrayTexture||Pp.isCompressedArrayTexture?mp.setTexture2DArray(Pp,0):mp.setTexture2D(Pp,0),Mp.unbindTexture()},this.resetState=function(){Dr=0,$r=0,Br=null,Mp.reset(),lv.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(WebGLRenderer.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(rt){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!rt}}});class WebGL1Renderer extends WebGLRenderer{}WebGL1Renderer.prototype.isWebGL1Renderer=!0;class FogExp2{constructor(_,ut=25e-5){this.isFogExp2=!0,this.name="",this.color=new Color$1(_),this.density=ut}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class Fog{constructor(_,ut=1,mt=1e3){this.isFog=!0,this.name="",this.color=new Color$1(_),this.near=ut,this.far=mt}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}let Scene$3=class extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(_,ut){return super.copy(_,ut),_.background!==null&&(this.background=_.background.clone()),_.environment!==null&&(this.environment=_.environment.clone()),_.fog!==null&&(this.fog=_.fog.clone()),this.backgroundBlurriness=_.backgroundBlurriness,this.backgroundIntensity=_.backgroundIntensity,_.overrideMaterial!==null&&(this.overrideMaterial=_.overrideMaterial.clone()),this.matrixAutoUpdate=_.matrixAutoUpdate,this}toJSON(_){const ut=super.toJSON(_);return this.fog!==null&&(ut.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(ut.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(ut.object.backgroundIntensity=this.backgroundIntensity),ut}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(_){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=_}};class InterleavedBuffer{constructor(_,ut){this.isInterleavedBuffer=!0,this.array=_,this.stride=ut,this.count=_!==void 0?_.length/ut:0,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=generateUUID$1()}onUploadCallback(){}set needsUpdate(_){_===!0&&this.version++}setUsage(_){return this.usage=_,this}copy(_){return this.array=new _.array.constructor(_.array),this.count=_.count,this.stride=_.stride,this.usage=_.usage,this}copyAt(_,ut,mt){_*=this.stride,mt*=ut.stride;for(let bt=0,St=this.stride;bt<St;bt++)this.array[_+bt]=ut.array[mt+bt];return this}set(_,ut=0){return this.array.set(_,ut),this}clone(_){_.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$1()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const ut=new this.array.constructor(_.arrayBuffers[this.array.buffer._uuid]),mt=new this.constructor(ut,this.stride);return mt.setUsage(this.usage),mt}onUpload(_){return this.onUploadCallback=_,this}toJSON(_){return _.arrayBuffers===void 0&&(_.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=generateUUID$1()),_.arrayBuffers[this.array.buffer._uuid]===void 0&&(_.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _vector$6=new Vector3;class InterleavedBufferAttribute{constructor(_,ut,mt,bt=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=_,this.itemSize=ut,this.offset=mt,this.normalized=bt}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(_){this.data.needsUpdate=_}applyMatrix4(_){for(let ut=0,mt=this.data.count;ut<mt;ut++)_vector$6.fromBufferAttribute(this,ut),_vector$6.applyMatrix4(_),this.setXYZ(ut,_vector$6.x,_vector$6.y,_vector$6.z);return this}applyNormalMatrix(_){for(let ut=0,mt=this.count;ut<mt;ut++)_vector$6.fromBufferAttribute(this,ut),_vector$6.applyNormalMatrix(_),this.setXYZ(ut,_vector$6.x,_vector$6.y,_vector$6.z);return this}transformDirection(_){for(let ut=0,mt=this.count;ut<mt;ut++)_vector$6.fromBufferAttribute(this,ut),_vector$6.transformDirection(_),this.setXYZ(ut,_vector$6.x,_vector$6.y,_vector$6.z);return this}setX(_,ut){return this.normalized&&(ut=normalize$6(ut,this.array)),this.data.array[_*this.data.stride+this.offset]=ut,this}setY(_,ut){return this.normalized&&(ut=normalize$6(ut,this.array)),this.data.array[_*this.data.stride+this.offset+1]=ut,this}setZ(_,ut){return this.normalized&&(ut=normalize$6(ut,this.array)),this.data.array[_*this.data.stride+this.offset+2]=ut,this}setW(_,ut){return this.normalized&&(ut=normalize$6(ut,this.array)),this.data.array[_*this.data.stride+this.offset+3]=ut,this}getX(_){let ut=this.data.array[_*this.data.stride+this.offset];return this.normalized&&(ut=denormalize(ut,this.array)),ut}getY(_){let ut=this.data.array[_*this.data.stride+this.offset+1];return this.normalized&&(ut=denormalize(ut,this.array)),ut}getZ(_){let ut=this.data.array[_*this.data.stride+this.offset+2];return this.normalized&&(ut=denormalize(ut,this.array)),ut}getW(_){let ut=this.data.array[_*this.data.stride+this.offset+3];return this.normalized&&(ut=denormalize(ut,this.array)),ut}setXY(_,ut,mt){return _=_*this.data.stride+this.offset,this.normalized&&(ut=normalize$6(ut,this.array),mt=normalize$6(mt,this.array)),this.data.array[_+0]=ut,this.data.array[_+1]=mt,this}setXYZ(_,ut,mt,bt){return _=_*this.data.stride+this.offset,this.normalized&&(ut=normalize$6(ut,this.array),mt=normalize$6(mt,this.array),bt=normalize$6(bt,this.array)),this.data.array[_+0]=ut,this.data.array[_+1]=mt,this.data.array[_+2]=bt,this}setXYZW(_,ut,mt,bt,St){return _=_*this.data.stride+this.offset,this.normalized&&(ut=normalize$6(ut,this.array),mt=normalize$6(mt,this.array),bt=normalize$6(bt,this.array),St=normalize$6(St,this.array)),this.data.array[_+0]=ut,this.data.array[_+1]=mt,this.data.array[_+2]=bt,this.data.array[_+3]=St,this}clone(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const ut=[];for(let mt=0;mt<this.count;mt++){const bt=mt*this.data.stride+this.offset;for(let St=0;St<this.itemSize;St++)ut.push(this.data.array[bt+St])}return new BufferAttribute(new this.array.constructor(ut),this.itemSize,this.normalized)}else return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.clone(_)),new InterleavedBufferAttribute(_.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(_){if(_===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const ut=[];for(let mt=0;mt<this.count;mt++){const bt=mt*this.data.stride+this.offset;for(let St=0;St<this.itemSize;St++)ut.push(this.data.array[bt+St])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:ut,normalized:this.normalized}}else return _.interleavedBuffers===void 0&&(_.interleavedBuffers={}),_.interleavedBuffers[this.data.uuid]===void 0&&(_.interleavedBuffers[this.data.uuid]=this.data.toJSON(_)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class SpriteMaterial extends Material{constructor(_){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Color$1(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.alphaMap=_.alphaMap,this.rotation=_.rotation,this.sizeAttenuation=_.sizeAttenuation,this.fog=_.fog,this}}let _geometry;const _intersectPoint=new Vector3,_worldScale=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2;class Sprite extends Object3D{constructor(_){if(super(),this.isSprite=!0,this.type="Sprite",_geometry===void 0){_geometry=new BufferGeometry;const ut=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),mt=new InterleavedBuffer(ut,5);_geometry.setIndex([0,1,2,0,2,3]),_geometry.setAttribute("position",new InterleavedBufferAttribute(mt,3,0,!1)),_geometry.setAttribute("uv",new InterleavedBufferAttribute(mt,2,3,!1))}this.geometry=_geometry,this.material=_!==void 0?_:new SpriteMaterial,this.center=new Vector2(.5,.5)}raycast(_,ut){_.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy(_.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(_.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),_.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&_worldScale.multiplyScalar(-_mvPosition.z);const mt=this.material.rotation;let bt,St;mt!==0&&(St=Math.cos(mt),bt=Math.sin(mt));const Mt=this.center;transformVertex(_vA.set(-.5,-.5,0),_mvPosition,Mt,_worldScale,bt,St),transformVertex(_vB.set(.5,-.5,0),_mvPosition,Mt,_worldScale,bt,St),transformVertex(_vC.set(.5,.5,0),_mvPosition,Mt,_worldScale,bt,St),_uvA.set(0,0),_uvB.set(1,0),_uvC.set(1,1);let Bt=_.ray.intersectTriangle(_vA,_vB,_vC,!1,_intersectPoint);if(Bt===null&&(transformVertex(_vB.set(-.5,.5,0),_mvPosition,Mt,_worldScale,bt,St),_uvB.set(0,1),Bt=_.ray.intersectTriangle(_vA,_vC,_vB,!1,_intersectPoint),Bt===null))return;const Ut=_.ray.origin.distanceTo(_intersectPoint);Ut<_.near||Ut>_.far||ut.push({distance:Ut,point:_intersectPoint.clone(),uv:Triangle.getUV(_intersectPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2),face:null,object:this})}copy(_,ut){return super.copy(_,ut),_.center!==void 0&&this.center.copy(_.center),this.material=_.material,this}}function transformVertex(rt,_,ut,mt,bt,St){_alignedPosition.subVectors(rt,ut).addScalar(.5).multiply(mt),bt!==void 0?(_rotatedPosition.x=St*_alignedPosition.x-bt*_alignedPosition.y,_rotatedPosition.y=bt*_alignedPosition.x+St*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),rt.copy(_),rt.x+=_rotatedPosition.x,rt.y+=_rotatedPosition.y,rt.applyMatrix4(_viewWorldMatrix)}const _v1$2=new Vector3,_v2$1=new Vector3;class LOD extends Object3D{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(_){super.copy(_,!1);const ut=_.levels;for(let mt=0,bt=ut.length;mt<bt;mt++){const St=ut[mt];this.addLevel(St.object.clone(),St.distance,St.hysteresis)}return this.autoUpdate=_.autoUpdate,this}addLevel(_,ut=0,mt=0){ut=Math.abs(ut);const bt=this.levels;let St;for(St=0;St<bt.length&&!(ut<bt[St].distance);St++);return bt.splice(St,0,{distance:ut,hysteresis:mt,object:_}),this.add(_),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(_){const ut=this.levels;if(ut.length>0){let mt,bt;for(mt=1,bt=ut.length;mt<bt;mt++){let St=ut[mt].distance;if(ut[mt].object.visible&&(St-=St*ut[mt].hysteresis),_<St)break}return ut[mt-1].object}return null}raycast(_,ut){if(this.levels.length>0){_v1$2.setFromMatrixPosition(this.matrixWorld);const bt=_.ray.origin.distanceTo(_v1$2);this.getObjectForDistance(bt).raycast(_,ut)}}update(_){const ut=this.levels;if(ut.length>1){_v1$2.setFromMatrixPosition(_.matrixWorld),_v2$1.setFromMatrixPosition(this.matrixWorld);const mt=_v1$2.distanceTo(_v2$1)/_.zoom;ut[0].object.visible=!0;let bt,St;for(bt=1,St=ut.length;bt<St;bt++){let Mt=ut[bt].distance;if(ut[bt].object.visible&&(Mt-=Mt*ut[bt].hysteresis),mt>=Mt)ut[bt-1].object.visible=!1,ut[bt].object.visible=!0;else break}for(this._currentLevel=bt-1;bt<St;bt++)ut[bt].object.visible=!1}}toJSON(_){const ut=super.toJSON(_);this.autoUpdate===!1&&(ut.object.autoUpdate=!1),ut.object.levels=[];const mt=this.levels;for(let bt=0,St=mt.length;bt<St;bt++){const Mt=mt[bt];ut.object.levels.push({object:Mt.object.uuid,distance:Mt.distance,hysteresis:Mt.hysteresis})}return ut}}const _basePosition=new Vector3,_skinIndex=new Vector4,_skinWeight=new Vector4,_vector$5=new Vector3,_matrix=new Matrix4;class SkinnedMesh extends Mesh{constructor(_,ut){super(_,ut),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4}copy(_,ut){return super.copy(_,ut),this.bindMode=_.bindMode,this.bindMatrix.copy(_.bindMatrix),this.bindMatrixInverse.copy(_.bindMatrixInverse),this.skeleton=_.skeleton,this}bind(_,ut){this.skeleton=_,ut===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),ut=this.matrixWorld),this.bindMatrix.copy(ut),this.bindMatrixInverse.copy(ut).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const _=new Vector4,ut=this.geometry.attributes.skinWeight;for(let mt=0,bt=ut.count;mt<bt;mt++){_.fromBufferAttribute(ut,mt);const St=1/_.manhattanLength();St!==1/0?_.multiplyScalar(St):_.set(1,0,0,0),ut.setXYZW(mt,_.x,_.y,_.z,_.w)}}updateMatrixWorld(_){super.updateMatrixWorld(_),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(_,ut){const mt=this.skeleton,bt=this.geometry;_skinIndex.fromBufferAttribute(bt.attributes.skinIndex,_),_skinWeight.fromBufferAttribute(bt.attributes.skinWeight,_),_basePosition.copy(ut).applyMatrix4(this.bindMatrix),ut.set(0,0,0);for(let St=0;St<4;St++){const Mt=_skinWeight.getComponent(St);if(Mt!==0){const Bt=_skinIndex.getComponent(St);_matrix.multiplyMatrices(mt.bones[Bt].matrixWorld,mt.boneInverses[Bt]),ut.addScaledVector(_vector$5.copy(_basePosition).applyMatrix4(_matrix),Mt)}}return ut.applyMatrix4(this.bindMatrixInverse)}}class Bone extends Object3D{constructor(){super(),this.isBone=!0,this.type="Bone"}}class DataTexture extends Texture{constructor(_=null,ut=1,mt=1,bt,St,Mt,Bt,Ut,Ht=NearestFilter,tr=NearestFilter,rr,sr){super(null,Mt,Bt,Ut,Ht,tr,bt,St,rr,sr),this.isDataTexture=!0,this.image={data:_,width:ut,height:mt},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const _offsetMatrix=new Matrix4,_identityMatrix$1=new Matrix4;class Skeleton{constructor(_=[],ut=[]){this.uuid=generateUUID$1(),this.bones=_.slice(0),this.boneInverses=ut,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const _=this.bones,ut=this.boneInverses;if(this.boneMatrices=new Float32Array(_.length*16),ut.length===0)this.calculateInverses();else if(_.length!==ut.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let mt=0,bt=this.bones.length;mt<bt;mt++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let _=0,ut=this.bones.length;_<ut;_++){const mt=new Matrix4;this.bones[_]&&mt.copy(this.bones[_].matrixWorld).invert(),this.boneInverses.push(mt)}}pose(){for(let _=0,ut=this.bones.length;_<ut;_++){const mt=this.bones[_];mt&&mt.matrixWorld.copy(this.boneInverses[_]).invert()}for(let _=0,ut=this.bones.length;_<ut;_++){const mt=this.bones[_];mt&&(mt.parent&&mt.parent.isBone?(mt.matrix.copy(mt.parent.matrixWorld).invert(),mt.matrix.multiply(mt.matrixWorld)):mt.matrix.copy(mt.matrixWorld),mt.matrix.decompose(mt.position,mt.quaternion,mt.scale))}}update(){const _=this.bones,ut=this.boneInverses,mt=this.boneMatrices,bt=this.boneTexture;for(let St=0,Mt=_.length;St<Mt;St++){const Bt=_[St]?_[St].matrixWorld:_identityMatrix$1;_offsetMatrix.multiplyMatrices(Bt,ut[St]),_offsetMatrix.toArray(mt,St*16)}bt!==null&&(bt.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let _=Math.sqrt(this.bones.length*4);_=ceilPowerOfTwo(_),_=Math.max(_,4);const ut=new Float32Array(_*_*4);ut.set(this.boneMatrices);const mt=new DataTexture(ut,_,_,RGBAFormat,FloatType);return mt.needsUpdate=!0,this.boneMatrices=ut,this.boneTexture=mt,this.boneTextureSize=_,this}getBoneByName(_){for(let ut=0,mt=this.bones.length;ut<mt;ut++){const bt=this.bones[ut];if(bt.name===_)return bt}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(_,ut){this.uuid=_.uuid;for(let mt=0,bt=_.bones.length;mt<bt;mt++){const St=_.bones[mt];let Mt=ut[St];Mt===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",St),Mt=new Bone),this.bones.push(Mt),this.boneInverses.push(new Matrix4().fromArray(_.boneInverses[mt]))}return this.init(),this}toJSON(){const _={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};_.uuid=this.uuid;const ut=this.bones,mt=this.boneInverses;for(let bt=0,St=ut.length;bt<St;bt++){const Mt=ut[bt];_.bones.push(Mt.uuid);const Bt=mt[bt];_.boneInverses.push(Bt.toArray())}return _}}class InstancedBufferAttribute extends BufferAttribute{constructor(_,ut,mt,bt=1){super(_,ut,mt),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=bt}copy(_){return super.copy(_),this.meshPerAttribute=_.meshPerAttribute,this}toJSON(){const _=super.toJSON();return _.meshPerAttribute=this.meshPerAttribute,_.isInstancedBufferAttribute=!0,_}}const _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_identity=new Matrix4,_mesh=new Mesh;class InstancedMesh extends Mesh{constructor(_,ut,mt){super(_,ut),this.isInstancedMesh=!0,this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(mt*16),16),this.instanceColor=null,this.count=mt,this.frustumCulled=!1;for(let bt=0;bt<mt;bt++)this.setMatrixAt(bt,_identity)}copy(_,ut){return super.copy(_,ut),this.instanceMatrix.copy(_.instanceMatrix),_.instanceColor!==null&&(this.instanceColor=_.instanceColor.clone()),this.count=_.count,this}getColorAt(_,ut){ut.fromArray(this.instanceColor.array,_*3)}getMatrixAt(_,ut){ut.fromArray(this.instanceMatrix.array,_*16)}raycast(_,ut){const mt=this.matrixWorld,bt=this.count;if(_mesh.geometry=this.geometry,_mesh.material=this.material,_mesh.material!==void 0)for(let St=0;St<bt;St++){this.getMatrixAt(St,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(mt,_instanceLocalMatrix),_mesh.matrixWorld=_instanceWorldMatrix,_mesh.raycast(_,_instanceIntersects);for(let Mt=0,Bt=_instanceIntersects.length;Mt<Bt;Mt++){const Ut=_instanceIntersects[Mt];Ut.instanceId=St,Ut.object=this,ut.push(Ut)}_instanceIntersects.length=0}}setColorAt(_,ut){this.instanceColor===null&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(this.instanceMatrix.count*3),3)),ut.toArray(this.instanceColor.array,_*3)}setMatrixAt(_,ut){ut.toArray(this.instanceMatrix.array,_*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class LineBasicMaterial extends Material{constructor(_){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Color$1(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.linewidth=_.linewidth,this.linecap=_.linecap,this.linejoin=_.linejoin,this.fog=_.fog,this}}const _start$1=new Vector3,_end$1=new Vector3,_inverseMatrix$1=new Matrix4,_ray$1=new Ray,_sphere$1=new Sphere$1;class Line extends Object3D{constructor(_=new BufferGeometry,ut=new LineBasicMaterial){super(),this.isLine=!0,this.type="Line",this.geometry=_,this.material=ut,this.updateMorphTargets()}copy(_,ut){return super.copy(_,ut),this.material=_.material,this.geometry=_.geometry,this}computeLineDistances(){const _=this.geometry;if(_.index===null){const ut=_.attributes.position,mt=[0];for(let bt=1,St=ut.count;bt<St;bt++)_start$1.fromBufferAttribute(ut,bt-1),_end$1.fromBufferAttribute(ut,bt),mt[bt]=mt[bt-1],mt[bt]+=_start$1.distanceTo(_end$1);_.setAttribute("lineDistance",new Float32BufferAttribute(mt,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(_,ut){const mt=this.geometry,bt=this.matrixWorld,St=_.params.Line.threshold,Mt=mt.drawRange;if(mt.boundingSphere===null&&mt.computeBoundingSphere(),_sphere$1.copy(mt.boundingSphere),_sphere$1.applyMatrix4(bt),_sphere$1.radius+=St,_.ray.intersectsSphere(_sphere$1)===!1)return;_inverseMatrix$1.copy(bt).invert(),_ray$1.copy(_.ray).applyMatrix4(_inverseMatrix$1);const Bt=St/((this.scale.x+this.scale.y+this.scale.z)/3),Ut=Bt*Bt,Ht=new Vector3,tr=new Vector3,rr=new Vector3,sr=new Vector3,ar=this.isLineSegments?2:1,cr=mt.index,_r=mt.attributes.position;if(cr!==null){const Dr=Math.max(0,Mt.start),$r=Math.min(cr.count,Mt.start+Mt.count);for(let Br=Dr,Jr=$r-1;Br<Jr;Br+=ar){const mn=cr.getX(Br),Mn=cr.getX(Br+1);if(Ht.fromBufferAttribute(_r,mn),tr.fromBufferAttribute(_r,Mn),_ray$1.distanceSqToSegment(Ht,tr,sr,rr)>Ut)continue;sr.applyMatrix4(this.matrixWorld);const en=_.ray.origin.distanceTo(sr);en<_.near||en>_.far||ut.push({distance:en,point:rr.clone().applyMatrix4(this.matrixWorld),index:Br,face:null,faceIndex:null,object:this})}}else{const Dr=Math.max(0,Mt.start),$r=Math.min(_r.count,Mt.start+Mt.count);for(let Br=Dr,Jr=$r-1;Br<Jr;Br+=ar){if(Ht.fromBufferAttribute(_r,Br),tr.fromBufferAttribute(_r,Br+1),_ray$1.distanceSqToSegment(Ht,tr,sr,rr)>Ut)continue;sr.applyMatrix4(this.matrixWorld);const Mn=_.ray.origin.distanceTo(sr);Mn<_.near||Mn>_.far||ut.push({distance:Mn,point:rr.clone().applyMatrix4(this.matrixWorld),index:Br,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const ut=this.geometry.morphAttributes,mt=Object.keys(ut);if(mt.length>0){const bt=ut[mt[0]];if(bt!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let St=0,Mt=bt.length;St<Mt;St++){const Bt=bt[St].name||String(St);this.morphTargetInfluences.push(0),this.morphTargetDictionary[Bt]=St}}}}}const _start=new Vector3,_end=new Vector3;class LineSegments extends Line{constructor(_,ut){super(_,ut),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const _=this.geometry;if(_.index===null){const ut=_.attributes.position,mt=[];for(let bt=0,St=ut.count;bt<St;bt+=2)_start.fromBufferAttribute(ut,bt),_end.fromBufferAttribute(ut,bt+1),mt[bt]=bt===0?0:mt[bt-1],mt[bt+1]=mt[bt]+_start.distanceTo(_end);_.setAttribute("lineDistance",new Float32BufferAttribute(mt,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class LineLoop extends Line{constructor(_,ut){super(_,ut),this.isLineLoop=!0,this.type="LineLoop"}}class PointsMaterial extends Material{constructor(_){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Color$1(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.alphaMap=_.alphaMap,this.size=_.size,this.sizeAttenuation=_.sizeAttenuation,this.fog=_.fog,this}}const _inverseMatrix=new Matrix4,_ray$3=new Ray,_sphere=new Sphere$1,_position$2=new Vector3;class Points extends Object3D{constructor(_=new BufferGeometry,ut=new PointsMaterial){super(),this.isPoints=!0,this.type="Points",this.geometry=_,this.material=ut,this.updateMorphTargets()}copy(_,ut){return super.copy(_,ut),this.material=_.material,this.geometry=_.geometry,this}raycast(_,ut){const mt=this.geometry,bt=this.matrixWorld,St=_.params.Points.threshold,Mt=mt.drawRange;if(mt.boundingSphere===null&&mt.computeBoundingSphere(),_sphere.copy(mt.boundingSphere),_sphere.applyMatrix4(bt),_sphere.radius+=St,_.ray.intersectsSphere(_sphere)===!1)return;_inverseMatrix.copy(bt).invert(),_ray$3.copy(_.ray).applyMatrix4(_inverseMatrix);const Bt=St/((this.scale.x+this.scale.y+this.scale.z)/3),Ut=Bt*Bt,Ht=mt.index,rr=mt.attributes.position;if(Ht!==null){const sr=Math.max(0,Mt.start),ar=Math.min(Ht.count,Mt.start+Mt.count);for(let cr=sr,Ar=ar;cr<Ar;cr++){const _r=Ht.getX(cr);_position$2.fromBufferAttribute(rr,_r),testPoint(_position$2,_r,Ut,bt,_,ut,this)}}else{const sr=Math.max(0,Mt.start),ar=Math.min(rr.count,Mt.start+Mt.count);for(let cr=sr,Ar=ar;cr<Ar;cr++)_position$2.fromBufferAttribute(rr,cr),testPoint(_position$2,cr,Ut,bt,_,ut,this)}}updateMorphTargets(){const ut=this.geometry.morphAttributes,mt=Object.keys(ut);if(mt.length>0){const bt=ut[mt[0]];if(bt!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let St=0,Mt=bt.length;St<Mt;St++){const Bt=bt[St].name||String(St);this.morphTargetInfluences.push(0),this.morphTargetDictionary[Bt]=St}}}}}function testPoint(rt,_,ut,mt,bt,St,Mt){const Bt=_ray$3.distanceSqToPoint(rt);if(Bt<ut){const Ut=new Vector3;_ray$3.closestPointToPoint(rt,Ut),Ut.applyMatrix4(mt);const Ht=bt.ray.origin.distanceTo(Ut);if(Ht<bt.near||Ht>bt.far)return;St.push({distance:Ht,distanceToRay:Math.sqrt(Bt),point:Ut,index:_,face:null,object:Mt})}}class VideoTexture extends Texture{constructor(_,ut,mt,bt,St,Mt,Bt,Ut,Ht){super(_,ut,mt,bt,St,Mt,Bt,Ut,Ht),this.isVideoTexture=!0,this.minFilter=Mt!==void 0?Mt:LinearFilter,this.magFilter=St!==void 0?St:LinearFilter,this.generateMipmaps=!1;const tr=this;function rr(){tr.needsUpdate=!0,_.requestVideoFrameCallback(rr)}"requestVideoFrameCallback"in _&&_.requestVideoFrameCallback(rr)}clone(){return new this.constructor(this.image).copy(this)}update(){const _=this.image;"requestVideoFrameCallback"in _===!1&&_.readyState>=_.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class FramebufferTexture extends Texture{constructor(_,ut,mt){super({width:_,height:ut}),this.isFramebufferTexture=!0,this.format=mt,this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.generateMipmaps=!1,this.needsUpdate=!0}}class CompressedTexture extends Texture{constructor(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr){super(null,Mt,Bt,Ut,Ht,tr,bt,St,rr,sr),this.isCompressedTexture=!0,this.image={width:ut,height:mt},this.mipmaps=_,this.flipY=!1,this.generateMipmaps=!1}}class CompressedArrayTexture extends CompressedTexture{constructor(_,ut,mt,bt,St,Mt){super(_,ut,mt,St,Mt),this.isCompressedArrayTexture=!0,this.image.depth=bt,this.wrapR=ClampToEdgeWrapping}}class CanvasTexture extends Texture{constructor(_,ut,mt,bt,St,Mt,Bt,Ut,Ht){super(_,ut,mt,bt,St,Mt,Bt,Ut,Ht),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(_,ut){const mt=this.getUtoTmapping(_);return this.getPoint(mt,ut)}getPoints(_=5){const ut=[];for(let mt=0;mt<=_;mt++)ut.push(this.getPoint(mt/_));return ut}getSpacedPoints(_=5){const ut=[];for(let mt=0;mt<=_;mt++)ut.push(this.getPointAt(mt/_));return ut}getLength(){const _=this.getLengths();return _[_.length-1]}getLengths(_=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===_+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const ut=[];let mt,bt=this.getPoint(0),St=0;ut.push(0);for(let Mt=1;Mt<=_;Mt++)mt=this.getPoint(Mt/_),St+=mt.distanceTo(bt),ut.push(St),bt=mt;return this.cacheArcLengths=ut,ut}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(_,ut){const mt=this.getLengths();let bt=0;const St=mt.length;let Mt;ut?Mt=ut:Mt=_*mt[St-1];let Bt=0,Ut=St-1,Ht;for(;Bt<=Ut;)if(bt=Math.floor(Bt+(Ut-Bt)/2),Ht=mt[bt]-Mt,Ht<0)Bt=bt+1;else if(Ht>0)Ut=bt-1;else{Ut=bt;break}if(bt=Ut,mt[bt]===Mt)return bt/(St-1);const tr=mt[bt],sr=mt[bt+1]-tr,ar=(Mt-tr)/sr;return(bt+ar)/(St-1)}getTangent(_,ut){let bt=_-1e-4,St=_+1e-4;bt<0&&(bt=0),St>1&&(St=1);const Mt=this.getPoint(bt),Bt=this.getPoint(St),Ut=ut||(Mt.isVector2?new Vector2:new Vector3);return Ut.copy(Bt).sub(Mt).normalize(),Ut}getTangentAt(_,ut){const mt=this.getUtoTmapping(_);return this.getTangent(mt,ut)}computeFrenetFrames(_,ut){const mt=new Vector3,bt=[],St=[],Mt=[],Bt=new Vector3,Ut=new Matrix4;for(let ar=0;ar<=_;ar++){const cr=ar/_;bt[ar]=this.getTangentAt(cr,new Vector3)}St[0]=new Vector3,Mt[0]=new Vector3;let Ht=Number.MAX_VALUE;const tr=Math.abs(bt[0].x),rr=Math.abs(bt[0].y),sr=Math.abs(bt[0].z);tr<=Ht&&(Ht=tr,mt.set(1,0,0)),rr<=Ht&&(Ht=rr,mt.set(0,1,0)),sr<=Ht&&mt.set(0,0,1),Bt.crossVectors(bt[0],mt).normalize(),St[0].crossVectors(bt[0],Bt),Mt[0].crossVectors(bt[0],St[0]);for(let ar=1;ar<=_;ar++){if(St[ar]=St[ar-1].clone(),Mt[ar]=Mt[ar-1].clone(),Bt.crossVectors(bt[ar-1],bt[ar]),Bt.length()>Number.EPSILON){Bt.normalize();const cr=Math.acos(clamp$7(bt[ar-1].dot(bt[ar]),-1,1));St[ar].applyMatrix4(Ut.makeRotationAxis(Bt,cr))}Mt[ar].crossVectors(bt[ar],St[ar])}if(ut===!0){let ar=Math.acos(clamp$7(St[0].dot(St[_]),-1,1));ar/=_,bt[0].dot(Bt.crossVectors(St[0],St[_]))>0&&(ar=-ar);for(let cr=1;cr<=_;cr++)St[cr].applyMatrix4(Ut.makeRotationAxis(bt[cr],ar*cr)),Mt[cr].crossVectors(bt[cr],St[cr])}return{tangents:bt,normals:St,binormals:Mt}}clone(){return new this.constructor().copy(this)}copy(_){return this.arcLengthDivisions=_.arcLengthDivisions,this}toJSON(){const _={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return _.arcLengthDivisions=this.arcLengthDivisions,_.type=this.type,_}fromJSON(_){return this.arcLengthDivisions=_.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(_=0,ut=0,mt=1,bt=1,St=0,Mt=Math.PI*2,Bt=!1,Ut=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=_,this.aY=ut,this.xRadius=mt,this.yRadius=bt,this.aStartAngle=St,this.aEndAngle=Mt,this.aClockwise=Bt,this.aRotation=Ut}getPoint(_,ut){const mt=ut||new Vector2,bt=Math.PI*2;let St=this.aEndAngle-this.aStartAngle;const Mt=Math.abs(St)<Number.EPSILON;for(;St<0;)St+=bt;for(;St>bt;)St-=bt;St<Number.EPSILON&&(Mt?St=0:St=bt),this.aClockwise===!0&&!Mt&&(St===bt?St=-bt:St=St-bt);const Bt=this.aStartAngle+_*St;let Ut=this.aX+this.xRadius*Math.cos(Bt),Ht=this.aY+this.yRadius*Math.sin(Bt);if(this.aRotation!==0){const tr=Math.cos(this.aRotation),rr=Math.sin(this.aRotation),sr=Ut-this.aX,ar=Ht-this.aY;Ut=sr*tr-ar*rr+this.aX,Ht=sr*rr+ar*tr+this.aY}return mt.set(Ut,Ht)}copy(_){return super.copy(_),this.aX=_.aX,this.aY=_.aY,this.xRadius=_.xRadius,this.yRadius=_.yRadius,this.aStartAngle=_.aStartAngle,this.aEndAngle=_.aEndAngle,this.aClockwise=_.aClockwise,this.aRotation=_.aRotation,this}toJSON(){const _=super.toJSON();return _.aX=this.aX,_.aY=this.aY,_.xRadius=this.xRadius,_.yRadius=this.yRadius,_.aStartAngle=this.aStartAngle,_.aEndAngle=this.aEndAngle,_.aClockwise=this.aClockwise,_.aRotation=this.aRotation,_}fromJSON(_){return super.fromJSON(_),this.aX=_.aX,this.aY=_.aY,this.xRadius=_.xRadius,this.yRadius=_.yRadius,this.aStartAngle=_.aStartAngle,this.aEndAngle=_.aEndAngle,this.aClockwise=_.aClockwise,this.aRotation=_.aRotation,this}}class ArcCurve extends EllipseCurve{constructor(_,ut,mt,bt,St,Mt){super(_,ut,mt,mt,bt,St,Mt),this.isArcCurve=!0,this.type="ArcCurve"}}function CubicPoly(){let rt=0,_=0,ut=0,mt=0;function bt(St,Mt,Bt,Ut){rt=St,_=Bt,ut=-3*St+3*Mt-2*Bt-Ut,mt=2*St-2*Mt+Bt+Ut}return{initCatmullRom:function(St,Mt,Bt,Ut,Ht){bt(Mt,Bt,Ht*(Bt-St),Ht*(Ut-Mt))},initNonuniformCatmullRom:function(St,Mt,Bt,Ut,Ht,tr,rr){let sr=(Mt-St)/Ht-(Bt-St)/(Ht+tr)+(Bt-Mt)/tr,ar=(Bt-Mt)/tr-(Ut-Mt)/(tr+rr)+(Ut-Bt)/rr;sr*=tr,ar*=tr,bt(Mt,Bt,sr,ar)},calc:function(St){const Mt=St*St,Bt=Mt*St;return rt+_*St+ut*Mt+mt*Bt}}}const tmp=new Vector3,px$2=new CubicPoly,py$1=new CubicPoly,pz=new CubicPoly;class CatmullRomCurve3 extends Curve{constructor(_=[],ut=!1,mt="centripetal",bt=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=_,this.closed=ut,this.curveType=mt,this.tension=bt}getPoint(_,ut=new Vector3){const mt=ut,bt=this.points,St=bt.length,Mt=(St-(this.closed?0:1))*_;let Bt=Math.floor(Mt),Ut=Mt-Bt;this.closed?Bt+=Bt>0?0:(Math.floor(Math.abs(Bt)/St)+1)*St:Ut===0&&Bt===St-1&&(Bt=St-2,Ut=1);let Ht,tr;this.closed||Bt>0?Ht=bt[(Bt-1)%St]:(tmp.subVectors(bt[0],bt[1]).add(bt[0]),Ht=tmp);const rr=bt[Bt%St],sr=bt[(Bt+1)%St];if(this.closed||Bt+2<St?tr=bt[(Bt+2)%St]:(tmp.subVectors(bt[St-1],bt[St-2]).add(bt[St-1]),tr=tmp),this.curveType==="centripetal"||this.curveType==="chordal"){const ar=this.curveType==="chordal"?.5:.25;let cr=Math.pow(Ht.distanceToSquared(rr),ar),Ar=Math.pow(rr.distanceToSquared(sr),ar),_r=Math.pow(sr.distanceToSquared(tr),ar);Ar<1e-4&&(Ar=1),cr<1e-4&&(cr=Ar),_r<1e-4&&(_r=Ar),px$2.initNonuniformCatmullRom(Ht.x,rr.x,sr.x,tr.x,cr,Ar,_r),py$1.initNonuniformCatmullRom(Ht.y,rr.y,sr.y,tr.y,cr,Ar,_r),pz.initNonuniformCatmullRom(Ht.z,rr.z,sr.z,tr.z,cr,Ar,_r)}else this.curveType==="catmullrom"&&(px$2.initCatmullRom(Ht.x,rr.x,sr.x,tr.x,this.tension),py$1.initCatmullRom(Ht.y,rr.y,sr.y,tr.y,this.tension),pz.initCatmullRom(Ht.z,rr.z,sr.z,tr.z,this.tension));return mt.set(px$2.calc(Ut),py$1.calc(Ut),pz.calc(Ut)),mt}copy(_){super.copy(_),this.points=[];for(let ut=0,mt=_.points.length;ut<mt;ut++){const bt=_.points[ut];this.points.push(bt.clone())}return this.closed=_.closed,this.curveType=_.curveType,this.tension=_.tension,this}toJSON(){const _=super.toJSON();_.points=[];for(let ut=0,mt=this.points.length;ut<mt;ut++){const bt=this.points[ut];_.points.push(bt.toArray())}return _.closed=this.closed,_.curveType=this.curveType,_.tension=this.tension,_}fromJSON(_){super.fromJSON(_),this.points=[];for(let ut=0,mt=_.points.length;ut<mt;ut++){const bt=_.points[ut];this.points.push(new Vector3().fromArray(bt))}return this.closed=_.closed,this.curveType=_.curveType,this.tension=_.tension,this}}function CatmullRom(rt,_,ut,mt,bt){const St=(mt-_)*.5,Mt=(bt-ut)*.5,Bt=rt*rt,Ut=rt*Bt;return(2*ut-2*mt+St+Mt)*Ut+(-3*ut+3*mt-2*St-Mt)*Bt+St*rt+ut}function QuadraticBezierP0(rt,_){const ut=1-rt;return ut*ut*_}function QuadraticBezierP1(rt,_){return 2*(1-rt)*rt*_}function QuadraticBezierP2(rt,_){return rt*rt*_}function QuadraticBezier(rt,_,ut,mt){return QuadraticBezierP0(rt,_)+QuadraticBezierP1(rt,ut)+QuadraticBezierP2(rt,mt)}function CubicBezierP0(rt,_){const ut=1-rt;return ut*ut*ut*_}function CubicBezierP1(rt,_){const ut=1-rt;return 3*ut*ut*rt*_}function CubicBezierP2(rt,_){return 3*(1-rt)*rt*rt*_}function CubicBezierP3(rt,_){return rt*rt*rt*_}function CubicBezier(rt,_,ut,mt,bt){return CubicBezierP0(rt,_)+CubicBezierP1(rt,ut)+CubicBezierP2(rt,mt)+CubicBezierP3(rt,bt)}class CubicBezierCurve extends Curve{constructor(_=new Vector2,ut=new Vector2,mt=new Vector2,bt=new Vector2){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=_,this.v1=ut,this.v2=mt,this.v3=bt}getPoint(_,ut=new Vector2){const mt=ut,bt=this.v0,St=this.v1,Mt=this.v2,Bt=this.v3;return mt.set(CubicBezier(_,bt.x,St.x,Mt.x,Bt.x),CubicBezier(_,bt.y,St.y,Mt.y,Bt.y)),mt}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this.v3.copy(_.v3),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_.v3=this.v3.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this.v3.fromArray(_.v3),this}}class CubicBezierCurve3 extends Curve{constructor(_=new Vector3,ut=new Vector3,mt=new Vector3,bt=new Vector3){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=_,this.v1=ut,this.v2=mt,this.v3=bt}getPoint(_,ut=new Vector3){const mt=ut,bt=this.v0,St=this.v1,Mt=this.v2,Bt=this.v3;return mt.set(CubicBezier(_,bt.x,St.x,Mt.x,Bt.x),CubicBezier(_,bt.y,St.y,Mt.y,Bt.y),CubicBezier(_,bt.z,St.z,Mt.z,Bt.z)),mt}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this.v3.copy(_.v3),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_.v3=this.v3.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this.v3.fromArray(_.v3),this}}class LineCurve extends Curve{constructor(_=new Vector2,ut=new Vector2){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=_,this.v2=ut}getPoint(_,ut=new Vector2){const mt=ut;return _===1?mt.copy(this.v2):(mt.copy(this.v2).sub(this.v1),mt.multiplyScalar(_).add(this.v1)),mt}getPointAt(_,ut){return this.getPoint(_,ut)}getTangent(_,ut=new Vector2){return ut.subVectors(this.v2,this.v1).normalize()}getTangentAt(_,ut){return this.getTangent(_,ut)}copy(_){return super.copy(_),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class LineCurve3 extends Curve{constructor(_=new Vector3,ut=new Vector3){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=_,this.v2=ut}getPoint(_,ut=new Vector3){const mt=ut;return _===1?mt.copy(this.v2):(mt.copy(this.v2).sub(this.v1),mt.multiplyScalar(_).add(this.v1)),mt}getPointAt(_,ut){return this.getPoint(_,ut)}getTangent(_,ut=new Vector3){return ut.subVectors(this.v2,this.v1).normalize()}getTangentAt(_,ut){return this.getTangent(_,ut)}copy(_){return super.copy(_),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class QuadraticBezierCurve extends Curve{constructor(_=new Vector2,ut=new Vector2,mt=new Vector2){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=_,this.v1=ut,this.v2=mt}getPoint(_,ut=new Vector2){const mt=ut,bt=this.v0,St=this.v1,Mt=this.v2;return mt.set(QuadraticBezier(_,bt.x,St.x,Mt.x),QuadraticBezier(_,bt.y,St.y,Mt.y)),mt}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class QuadraticBezierCurve3 extends Curve{constructor(_=new Vector3,ut=new Vector3,mt=new Vector3){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=_,this.v1=ut,this.v2=mt}getPoint(_,ut=new Vector3){const mt=ut,bt=this.v0,St=this.v1,Mt=this.v2;return mt.set(QuadraticBezier(_,bt.x,St.x,Mt.x),QuadraticBezier(_,bt.y,St.y,Mt.y),QuadraticBezier(_,bt.z,St.z,Mt.z)),mt}copy(_){return super.copy(_),this.v0.copy(_.v0),this.v1.copy(_.v1),this.v2.copy(_.v2),this}toJSON(){const _=super.toJSON();return _.v0=this.v0.toArray(),_.v1=this.v1.toArray(),_.v2=this.v2.toArray(),_}fromJSON(_){return super.fromJSON(_),this.v0.fromArray(_.v0),this.v1.fromArray(_.v1),this.v2.fromArray(_.v2),this}}class SplineCurve extends Curve{constructor(_=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=_}getPoint(_,ut=new Vector2){const mt=ut,bt=this.points,St=(bt.length-1)*_,Mt=Math.floor(St),Bt=St-Mt,Ut=bt[Mt===0?Mt:Mt-1],Ht=bt[Mt],tr=bt[Mt>bt.length-2?bt.length-1:Mt+1],rr=bt[Mt>bt.length-3?bt.length-1:Mt+2];return mt.set(CatmullRom(Bt,Ut.x,Ht.x,tr.x,rr.x),CatmullRom(Bt,Ut.y,Ht.y,tr.y,rr.y)),mt}copy(_){super.copy(_),this.points=[];for(let ut=0,mt=_.points.length;ut<mt;ut++){const bt=_.points[ut];this.points.push(bt.clone())}return this}toJSON(){const _=super.toJSON();_.points=[];for(let ut=0,mt=this.points.length;ut<mt;ut++){const bt=this.points[ut];_.points.push(bt.toArray())}return _}fromJSON(_){super.fromJSON(_),this.points=[];for(let ut=0,mt=_.points.length;ut<mt;ut++){const bt=_.points[ut];this.points.push(new Vector2().fromArray(bt))}return this}}var Curves=Object.freeze({__proto__:null,ArcCurve,CatmullRomCurve3,CubicBezierCurve,CubicBezierCurve3,EllipseCurve,LineCurve,LineCurve3,QuadraticBezierCurve,QuadraticBezierCurve3,SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(_){this.curves.push(_)}closePath(){const _=this.curves[0].getPoint(0),ut=this.curves[this.curves.length-1].getPoint(1);_.equals(ut)||this.curves.push(new LineCurve(ut,_))}getPoint(_,ut){const mt=_*this.getLength(),bt=this.getCurveLengths();let St=0;for(;St<bt.length;){if(bt[St]>=mt){const Mt=bt[St]-mt,Bt=this.curves[St],Ut=Bt.getLength(),Ht=Ut===0?0:1-Mt/Ut;return Bt.getPointAt(Ht,ut)}St++}return null}getLength(){const _=this.getCurveLengths();return _[_.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const _=[];let ut=0;for(let mt=0,bt=this.curves.length;mt<bt;mt++)ut+=this.curves[mt].getLength(),_.push(ut);return this.cacheLengths=_,_}getSpacedPoints(_=40){const ut=[];for(let mt=0;mt<=_;mt++)ut.push(this.getPoint(mt/_));return this.autoClose&&ut.push(ut[0]),ut}getPoints(_=12){const ut=[];let mt;for(let bt=0,St=this.curves;bt<St.length;bt++){const Mt=St[bt],Bt=Mt.isEllipseCurve?_*2:Mt.isLineCurve||Mt.isLineCurve3?1:Mt.isSplineCurve?_*Mt.points.length:_,Ut=Mt.getPoints(Bt);for(let Ht=0;Ht<Ut.length;Ht++){const tr=Ut[Ht];mt&&mt.equals(tr)||(ut.push(tr),mt=tr)}}return this.autoClose&&ut.length>1&&!ut[ut.length-1].equals(ut[0])&&ut.push(ut[0]),ut}copy(_){super.copy(_),this.curves=[];for(let ut=0,mt=_.curves.length;ut<mt;ut++){const bt=_.curves[ut];this.curves.push(bt.clone())}return this.autoClose=_.autoClose,this}toJSON(){const _=super.toJSON();_.autoClose=this.autoClose,_.curves=[];for(let ut=0,mt=this.curves.length;ut<mt;ut++){const bt=this.curves[ut];_.curves.push(bt.toJSON())}return _}fromJSON(_){super.fromJSON(_),this.autoClose=_.autoClose,this.curves=[];for(let ut=0,mt=_.curves.length;ut<mt;ut++){const bt=_.curves[ut];this.curves.push(new Curves[bt.type]().fromJSON(bt))}return this}}class Path extends CurvePath{constructor(_){super(),this.type="Path",this.currentPoint=new Vector2,_&&this.setFromPoints(_)}setFromPoints(_){this.moveTo(_[0].x,_[0].y);for(let ut=1,mt=_.length;ut<mt;ut++)this.lineTo(_[ut].x,_[ut].y);return this}moveTo(_,ut){return this.currentPoint.set(_,ut),this}lineTo(_,ut){const mt=new LineCurve(this.currentPoint.clone(),new Vector2(_,ut));return this.curves.push(mt),this.currentPoint.set(_,ut),this}quadraticCurveTo(_,ut,mt,bt){const St=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(_,ut),new Vector2(mt,bt));return this.curves.push(St),this.currentPoint.set(mt,bt),this}bezierCurveTo(_,ut,mt,bt,St,Mt){const Bt=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(_,ut),new Vector2(mt,bt),new Vector2(St,Mt));return this.curves.push(Bt),this.currentPoint.set(St,Mt),this}splineThru(_){const ut=[this.currentPoint.clone()].concat(_),mt=new SplineCurve(ut);return this.curves.push(mt),this.currentPoint.copy(_[_.length-1]),this}arc(_,ut,mt,bt,St,Mt){const Bt=this.currentPoint.x,Ut=this.currentPoint.y;return this.absarc(_+Bt,ut+Ut,mt,bt,St,Mt),this}absarc(_,ut,mt,bt,St,Mt){return this.absellipse(_,ut,mt,mt,bt,St,Mt),this}ellipse(_,ut,mt,bt,St,Mt,Bt,Ut){const Ht=this.currentPoint.x,tr=this.currentPoint.y;return this.absellipse(_+Ht,ut+tr,mt,bt,St,Mt,Bt,Ut),this}absellipse(_,ut,mt,bt,St,Mt,Bt,Ut){const Ht=new EllipseCurve(_,ut,mt,bt,St,Mt,Bt,Ut);if(this.curves.length>0){const rr=Ht.getPoint(0);rr.equals(this.currentPoint)||this.lineTo(rr.x,rr.y)}this.curves.push(Ht);const tr=Ht.getPoint(1);return this.currentPoint.copy(tr),this}copy(_){return super.copy(_),this.currentPoint.copy(_.currentPoint),this}toJSON(){const _=super.toJSON();return _.currentPoint=this.currentPoint.toArray(),_}fromJSON(_){return super.fromJSON(_),this.currentPoint.fromArray(_.currentPoint),this}}class LatheGeometry extends BufferGeometry{constructor(_=[new Vector2(0,-.5),new Vector2(.5,0),new Vector2(0,.5)],ut=12,mt=0,bt=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:_,segments:ut,phiStart:mt,phiLength:bt},ut=Math.floor(ut),bt=clamp$7(bt,0,Math.PI*2);const St=[],Mt=[],Bt=[],Ut=[],Ht=[],tr=1/ut,rr=new Vector3,sr=new Vector2,ar=new Vector3,cr=new Vector3,Ar=new Vector3;let _r=0,Dr=0;for(let $r=0;$r<=_.length-1;$r++)switch($r){case 0:_r=_[$r+1].x-_[$r].x,Dr=_[$r+1].y-_[$r].y,ar.x=Dr*1,ar.y=-_r,ar.z=Dr*0,Ar.copy(ar),ar.normalize(),Ut.push(ar.x,ar.y,ar.z);break;case _.length-1:Ut.push(Ar.x,Ar.y,Ar.z);break;default:_r=_[$r+1].x-_[$r].x,Dr=_[$r+1].y-_[$r].y,ar.x=Dr*1,ar.y=-_r,ar.z=Dr*0,cr.copy(ar),ar.x+=Ar.x,ar.y+=Ar.y,ar.z+=Ar.z,ar.normalize(),Ut.push(ar.x,ar.y,ar.z),Ar.copy(cr)}for(let $r=0;$r<=ut;$r++){const Br=mt+$r*tr*bt,Jr=Math.sin(Br),mn=Math.cos(Br);for(let Mn=0;Mn<=_.length-1;Mn++){rr.x=_[Mn].x*Jr,rr.y=_[Mn].y,rr.z=_[Mn].x*mn,Mt.push(rr.x,rr.y,rr.z),sr.x=$r/ut,sr.y=Mn/(_.length-1),Bt.push(sr.x,sr.y);const $n=Ut[3*Mn+0]*Jr,en=Ut[3*Mn+1],In=Ut[3*Mn+0]*mn;Ht.push($n,en,In)}}for(let $r=0;$r<ut;$r++)for(let Br=0;Br<_.length-1;Br++){const Jr=Br+$r*_.length,mn=Jr,Mn=Jr+_.length,$n=Jr+_.length+1,en=Jr+1;St.push(mn,Mn,en),St.push($n,en,Mn)}this.setIndex(St),this.setAttribute("position",new Float32BufferAttribute(Mt,3)),this.setAttribute("uv",new Float32BufferAttribute(Bt,2)),this.setAttribute("normal",new Float32BufferAttribute(Ht,3))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new LatheGeometry(_.points,_.segments,_.phiStart,_.phiLength)}}class CapsuleGeometry extends LatheGeometry{constructor(_=1,ut=1,mt=4,bt=8){const St=new Path;St.absarc(0,-ut/2,_,Math.PI*1.5,0),St.absarc(0,ut/2,_,0,Math.PI*.5),super(St.getPoints(mt),bt),this.type="CapsuleGeometry",this.parameters={radius:_,height:ut,capSegments:mt,radialSegments:bt}}static fromJSON(_){return new CapsuleGeometry(_.radius,_.length,_.capSegments,_.radialSegments)}}class CircleGeometry extends BufferGeometry{constructor(_=1,ut=32,mt=0,bt=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:_,segments:ut,thetaStart:mt,thetaLength:bt},ut=Math.max(3,ut);const St=[],Mt=[],Bt=[],Ut=[],Ht=new Vector3,tr=new Vector2;Mt.push(0,0,0),Bt.push(0,0,1),Ut.push(.5,.5);for(let rr=0,sr=3;rr<=ut;rr++,sr+=3){const ar=mt+rr/ut*bt;Ht.x=_*Math.cos(ar),Ht.y=_*Math.sin(ar),Mt.push(Ht.x,Ht.y,Ht.z),Bt.push(0,0,1),tr.x=(Mt[sr]/_+1)/2,tr.y=(Mt[sr+1]/_+1)/2,Ut.push(tr.x,tr.y)}for(let rr=1;rr<=ut;rr++)St.push(rr,rr+1,0);this.setIndex(St),this.setAttribute("position",new Float32BufferAttribute(Mt,3)),this.setAttribute("normal",new Float32BufferAttribute(Bt,3)),this.setAttribute("uv",new Float32BufferAttribute(Ut,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new CircleGeometry(_.radius,_.segments,_.thetaStart,_.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(_=1,ut=1,mt=1,bt=32,St=1,Mt=!1,Bt=0,Ut=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:_,radiusBottom:ut,height:mt,radialSegments:bt,heightSegments:St,openEnded:Mt,thetaStart:Bt,thetaLength:Ut};const Ht=this;bt=Math.floor(bt),St=Math.floor(St);const tr=[],rr=[],sr=[],ar=[];let cr=0;const Ar=[],_r=mt/2;let Dr=0;$r(),Mt===!1&&(_>0&&Br(!0),ut>0&&Br(!1)),this.setIndex(tr),this.setAttribute("position",new Float32BufferAttribute(rr,3)),this.setAttribute("normal",new Float32BufferAttribute(sr,3)),this.setAttribute("uv",new Float32BufferAttribute(ar,2));function $r(){const Jr=new Vector3,mn=new Vector3;let Mn=0;const $n=(ut-_)/mt;for(let en=0;en<=St;en++){const In=[],Rn=en/St,qn=Rn*(ut-_)+_;for(let Qn=0;Qn<=bt;Qn++){const xs=Qn/bt,cs=xs*Ut+Bt,ks=Math.sin(cs),_o=Math.cos(cs);mn.x=qn*ks,mn.y=-Rn*mt+_r,mn.z=qn*_o,rr.push(mn.x,mn.y,mn.z),Jr.set(ks,$n,_o).normalize(),sr.push(Jr.x,Jr.y,Jr.z),ar.push(xs,1-Rn),In.push(cr++)}Ar.push(In)}for(let en=0;en<bt;en++)for(let In=0;In<St;In++){const Rn=Ar[In][en],qn=Ar[In+1][en],Qn=Ar[In+1][en+1],xs=Ar[In][en+1];tr.push(Rn,qn,xs),tr.push(qn,Qn,xs),Mn+=6}Ht.addGroup(Dr,Mn,0),Dr+=Mn}function Br(Jr){const mn=cr,Mn=new Vector2,$n=new Vector3;let en=0;const In=Jr===!0?_:ut,Rn=Jr===!0?1:-1;for(let Qn=1;Qn<=bt;Qn++)rr.push(0,_r*Rn,0),sr.push(0,Rn,0),ar.push(.5,.5),cr++;const qn=cr;for(let Qn=0;Qn<=bt;Qn++){const cs=Qn/bt*Ut+Bt,ks=Math.cos(cs),_o=Math.sin(cs);$n.x=In*_o,$n.y=_r*Rn,$n.z=In*ks,rr.push($n.x,$n.y,$n.z),sr.push(0,Rn,0),Mn.x=ks*.5+.5,Mn.y=_o*.5*Rn+.5,ar.push(Mn.x,Mn.y),cr++}for(let Qn=0;Qn<bt;Qn++){const xs=mn+Qn,cs=qn+Qn;Jr===!0?tr.push(cs,cs+1,xs):tr.push(cs+1,cs,xs),en+=3}Ht.addGroup(Dr,en,Jr===!0?1:2),Dr+=en}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new CylinderGeometry(_.radiusTop,_.radiusBottom,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(_=1,ut=1,mt=32,bt=1,St=!1,Mt=0,Bt=Math.PI*2){super(0,_,ut,mt,bt,St,Mt,Bt),this.type="ConeGeometry",this.parameters={radius:_,height:ut,radialSegments:mt,heightSegments:bt,openEnded:St,thetaStart:Mt,thetaLength:Bt}}static fromJSON(_){return new ConeGeometry(_.radius,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(_=[],ut=[],mt=1,bt=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:_,indices:ut,radius:mt,detail:bt};const St=[],Mt=[];Bt(bt),Ht(mt),tr(),this.setAttribute("position",new Float32BufferAttribute(St,3)),this.setAttribute("normal",new Float32BufferAttribute(St.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(Mt,2)),bt===0?this.computeVertexNormals():this.normalizeNormals();function Bt($r){const Br=new Vector3,Jr=new Vector3,mn=new Vector3;for(let Mn=0;Mn<ut.length;Mn+=3)ar(ut[Mn+0],Br),ar(ut[Mn+1],Jr),ar(ut[Mn+2],mn),Ut(Br,Jr,mn,$r)}function Ut($r,Br,Jr,mn){const Mn=mn+1,$n=[];for(let en=0;en<=Mn;en++){$n[en]=[];const In=$r.clone().lerp(Jr,en/Mn),Rn=Br.clone().lerp(Jr,en/Mn),qn=Mn-en;for(let Qn=0;Qn<=qn;Qn++)Qn===0&&en===Mn?$n[en][Qn]=In:$n[en][Qn]=In.clone().lerp(Rn,Qn/qn)}for(let en=0;en<Mn;en++)for(let In=0;In<2*(Mn-en)-1;In++){const Rn=Math.floor(In/2);In%2===0?(sr($n[en][Rn+1]),sr($n[en+1][Rn]),sr($n[en][Rn])):(sr($n[en][Rn+1]),sr($n[en+1][Rn+1]),sr($n[en+1][Rn]))}}function Ht($r){const Br=new Vector3;for(let Jr=0;Jr<St.length;Jr+=3)Br.x=St[Jr+0],Br.y=St[Jr+1],Br.z=St[Jr+2],Br.normalize().multiplyScalar($r),St[Jr+0]=Br.x,St[Jr+1]=Br.y,St[Jr+2]=Br.z}function tr(){const $r=new Vector3;for(let Br=0;Br<St.length;Br+=3){$r.x=St[Br+0],$r.y=St[Br+1],$r.z=St[Br+2];const Jr=_r($r)/2/Math.PI+.5,mn=Dr($r)/Math.PI+.5;Mt.push(Jr,1-mn)}cr(),rr()}function rr(){for(let $r=0;$r<Mt.length;$r+=6){const Br=Mt[$r+0],Jr=Mt[$r+2],mn=Mt[$r+4],Mn=Math.max(Br,Jr,mn),$n=Math.min(Br,Jr,mn);Mn>.9&&$n<.1&&(Br<.2&&(Mt[$r+0]+=1),Jr<.2&&(Mt[$r+2]+=1),mn<.2&&(Mt[$r+4]+=1))}}function sr($r){St.push($r.x,$r.y,$r.z)}function ar($r,Br){const Jr=$r*3;Br.x=_[Jr+0],Br.y=_[Jr+1],Br.z=_[Jr+2]}function cr(){const $r=new Vector3,Br=new Vector3,Jr=new Vector3,mn=new Vector3,Mn=new Vector2,$n=new Vector2,en=new Vector2;for(let In=0,Rn=0;In<St.length;In+=9,Rn+=6){$r.set(St[In+0],St[In+1],St[In+2]),Br.set(St[In+3],St[In+4],St[In+5]),Jr.set(St[In+6],St[In+7],St[In+8]),Mn.set(Mt[Rn+0],Mt[Rn+1]),$n.set(Mt[Rn+2],Mt[Rn+3]),en.set(Mt[Rn+4],Mt[Rn+5]),mn.copy($r).add(Br).add(Jr).divideScalar(3);const qn=_r(mn);Ar(Mn,Rn+0,$r,qn),Ar($n,Rn+2,Br,qn),Ar(en,Rn+4,Jr,qn)}}function Ar($r,Br,Jr,mn){mn<0&&$r.x===1&&(Mt[Br]=$r.x-1),Jr.x===0&&Jr.z===0&&(Mt[Br]=mn/2/Math.PI+.5)}function _r($r){return Math.atan2($r.z,-$r.x)}function Dr($r){return Math.atan2(-$r.y,Math.sqrt($r.x*$r.x+$r.z*$r.z))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new PolyhedronGeometry(_.vertices,_.indices,_.radius,_.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(_=1,ut=0){const mt=(1+Math.sqrt(5))/2,bt=1/mt,St=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-bt,-mt,0,-bt,mt,0,bt,-mt,0,bt,mt,-bt,-mt,0,-bt,mt,0,bt,-mt,0,bt,mt,0,-mt,0,-bt,mt,0,-bt,-mt,0,bt,mt,0,bt],Mt=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(St,Mt,_,ut),this.type="DodecahedronGeometry",this.parameters={radius:_,detail:ut}}static fromJSON(_){return new DodecahedronGeometry(_.radius,_.detail)}}const _v0=new Vector3,_v1$1=new Vector3,_normal=new Vector3,_triangle=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(_=null,ut=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:_,thresholdAngle:ut},_!==null){const bt=Math.pow(10,4),St=Math.cos(DEG2RAD*ut),Mt=_.getIndex(),Bt=_.getAttribute("position"),Ut=Mt?Mt.count:Bt.count,Ht=[0,0,0],tr=["a","b","c"],rr=new Array(3),sr={},ar=[];for(let cr=0;cr<Ut;cr+=3){Mt?(Ht[0]=Mt.getX(cr),Ht[1]=Mt.getX(cr+1),Ht[2]=Mt.getX(cr+2)):(Ht[0]=cr,Ht[1]=cr+1,Ht[2]=cr+2);const{a:Ar,b:_r,c:Dr}=_triangle;if(Ar.fromBufferAttribute(Bt,Ht[0]),_r.fromBufferAttribute(Bt,Ht[1]),Dr.fromBufferAttribute(Bt,Ht[2]),_triangle.getNormal(_normal),rr[0]=`${Math.round(Ar.x*bt)},${Math.round(Ar.y*bt)},${Math.round(Ar.z*bt)}`,rr[1]=`${Math.round(_r.x*bt)},${Math.round(_r.y*bt)},${Math.round(_r.z*bt)}`,rr[2]=`${Math.round(Dr.x*bt)},${Math.round(Dr.y*bt)},${Math.round(Dr.z*bt)}`,!(rr[0]===rr[1]||rr[1]===rr[2]||rr[2]===rr[0]))for(let $r=0;$r<3;$r++){const Br=($r+1)%3,Jr=rr[$r],mn=rr[Br],Mn=_triangle[tr[$r]],$n=_triangle[tr[Br]],en=`${Jr}_${mn}`,In=`${mn}_${Jr}`;In in sr&&sr[In]?(_normal.dot(sr[In].normal)<=St&&(ar.push(Mn.x,Mn.y,Mn.z),ar.push($n.x,$n.y,$n.z)),sr[In]=null):en in sr||(sr[en]={index0:Ht[$r],index1:Ht[Br],normal:_normal.clone()})}}for(const cr in sr)if(sr[cr]){const{index0:Ar,index1:_r}=sr[cr];_v0.fromBufferAttribute(Bt,Ar),_v1$1.fromBufferAttribute(Bt,_r),ar.push(_v0.x,_v0.y,_v0.z),ar.push(_v1$1.x,_v1$1.y,_v1$1.z)}this.setAttribute("position",new Float32BufferAttribute(ar,3))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}}class Shape extends Path{constructor(_){super(_),this.uuid=generateUUID$1(),this.type="Shape",this.holes=[]}getPointsHoles(_){const ut=[];for(let mt=0,bt=this.holes.length;mt<bt;mt++)ut[mt]=this.holes[mt].getPoints(_);return ut}extractPoints(_){return{shape:this.getPoints(_),holes:this.getPointsHoles(_)}}copy(_){super.copy(_),this.holes=[];for(let ut=0,mt=_.holes.length;ut<mt;ut++){const bt=_.holes[ut];this.holes.push(bt.clone())}return this}toJSON(){const _=super.toJSON();_.uuid=this.uuid,_.holes=[];for(let ut=0,mt=this.holes.length;ut<mt;ut++){const bt=this.holes[ut];_.holes.push(bt.toJSON())}return _}fromJSON(_){super.fromJSON(_),this.uuid=_.uuid,this.holes=[];for(let ut=0,mt=_.holes.length;ut<mt;ut++){const bt=_.holes[ut];this.holes.push(new Path().fromJSON(bt))}return this}}const Earcut={triangulate:function(rt,_,ut=2){const mt=_&&_.length,bt=mt?_[0]*ut:rt.length;let St=linkedList(rt,0,bt,ut,!0);const Mt=[];if(!St||St.next===St.prev)return Mt;let Bt,Ut,Ht,tr,rr,sr,ar;if(mt&&(St=eliminateHoles(rt,_,St,ut)),rt.length>80*ut){Bt=Ht=rt[0],Ut=tr=rt[1];for(let cr=ut;cr<bt;cr+=ut)rr=rt[cr],sr=rt[cr+1],rr<Bt&&(Bt=rr),sr<Ut&&(Ut=sr),rr>Ht&&(Ht=rr),sr>tr&&(tr=sr);ar=Math.max(Ht-Bt,tr-Ut),ar=ar!==0?32767/ar:0}return earcutLinked(St,Mt,ut,Bt,Ut,ar,0),Mt}};function linkedList(rt,_,ut,mt,bt){let St,Mt;if(bt===signedArea(rt,_,ut,mt)>0)for(St=_;St<ut;St+=mt)Mt=insertNode(St,rt[St],rt[St+1],Mt);else for(St=ut-mt;St>=_;St-=mt)Mt=insertNode(St,rt[St],rt[St+1],Mt);return Mt&&equals(Mt,Mt.next)&&(removeNode(Mt),Mt=Mt.next),Mt}function filterPoints(rt,_){if(!rt)return rt;_||(_=rt);let ut=rt,mt;do if(mt=!1,!ut.steiner&&(equals(ut,ut.next)||area(ut.prev,ut,ut.next)===0)){if(removeNode(ut),ut=_=ut.prev,ut===ut.next)break;mt=!0}else ut=ut.next;while(mt||ut!==_);return _}function earcutLinked(rt,_,ut,mt,bt,St,Mt){if(!rt)return;!Mt&&St&&indexCurve(rt,mt,bt,St);let Bt=rt,Ut,Ht;for(;rt.prev!==rt.next;){if(Ut=rt.prev,Ht=rt.next,St?isEarHashed(rt,mt,bt,St):isEar(rt)){_.push(Ut.i/ut|0),_.push(rt.i/ut|0),_.push(Ht.i/ut|0),removeNode(rt),rt=Ht.next,Bt=Ht.next;continue}if(rt=Ht,rt===Bt){Mt?Mt===1?(rt=cureLocalIntersections(filterPoints(rt),_,ut),earcutLinked(rt,_,ut,mt,bt,St,2)):Mt===2&&splitEarcut(rt,_,ut,mt,bt,St):earcutLinked(filterPoints(rt),_,ut,mt,bt,St,1);break}}}function isEar(rt){const _=rt.prev,ut=rt,mt=rt.next;if(area(_,ut,mt)>=0)return!1;const bt=_.x,St=ut.x,Mt=mt.x,Bt=_.y,Ut=ut.y,Ht=mt.y,tr=bt<St?bt<Mt?bt:Mt:St<Mt?St:Mt,rr=Bt<Ut?Bt<Ht?Bt:Ht:Ut<Ht?Ut:Ht,sr=bt>St?bt>Mt?bt:Mt:St>Mt?St:Mt,ar=Bt>Ut?Bt>Ht?Bt:Ht:Ut>Ht?Ut:Ht;let cr=mt.next;for(;cr!==_;){if(cr.x>=tr&&cr.x<=sr&&cr.y>=rr&&cr.y<=ar&&pointInTriangle(bt,Bt,St,Ut,Mt,Ht,cr.x,cr.y)&&area(cr.prev,cr,cr.next)>=0)return!1;cr=cr.next}return!0}function isEarHashed(rt,_,ut,mt){const bt=rt.prev,St=rt,Mt=rt.next;if(area(bt,St,Mt)>=0)return!1;const Bt=bt.x,Ut=St.x,Ht=Mt.x,tr=bt.y,rr=St.y,sr=Mt.y,ar=Bt<Ut?Bt<Ht?Bt:Ht:Ut<Ht?Ut:Ht,cr=tr<rr?tr<sr?tr:sr:rr<sr?rr:sr,Ar=Bt>Ut?Bt>Ht?Bt:Ht:Ut>Ht?Ut:Ht,_r=tr>rr?tr>sr?tr:sr:rr>sr?rr:sr,Dr=zOrder(ar,cr,_,ut,mt),$r=zOrder(Ar,_r,_,ut,mt);let Br=rt.prevZ,Jr=rt.nextZ;for(;Br&&Br.z>=Dr&&Jr&&Jr.z<=$r;){if(Br.x>=ar&&Br.x<=Ar&&Br.y>=cr&&Br.y<=_r&&Br!==bt&&Br!==Mt&&pointInTriangle(Bt,tr,Ut,rr,Ht,sr,Br.x,Br.y)&&area(Br.prev,Br,Br.next)>=0||(Br=Br.prevZ,Jr.x>=ar&&Jr.x<=Ar&&Jr.y>=cr&&Jr.y<=_r&&Jr!==bt&&Jr!==Mt&&pointInTriangle(Bt,tr,Ut,rr,Ht,sr,Jr.x,Jr.y)&&area(Jr.prev,Jr,Jr.next)>=0))return!1;Jr=Jr.nextZ}for(;Br&&Br.z>=Dr;){if(Br.x>=ar&&Br.x<=Ar&&Br.y>=cr&&Br.y<=_r&&Br!==bt&&Br!==Mt&&pointInTriangle(Bt,tr,Ut,rr,Ht,sr,Br.x,Br.y)&&area(Br.prev,Br,Br.next)>=0)return!1;Br=Br.prevZ}for(;Jr&&Jr.z<=$r;){if(Jr.x>=ar&&Jr.x<=Ar&&Jr.y>=cr&&Jr.y<=_r&&Jr!==bt&&Jr!==Mt&&pointInTriangle(Bt,tr,Ut,rr,Ht,sr,Jr.x,Jr.y)&&area(Jr.prev,Jr,Jr.next)>=0)return!1;Jr=Jr.nextZ}return!0}function cureLocalIntersections(rt,_,ut){let mt=rt;do{const bt=mt.prev,St=mt.next.next;!equals(bt,St)&&intersects(bt,mt,mt.next,St)&&locallyInside(bt,St)&&locallyInside(St,bt)&&(_.push(bt.i/ut|0),_.push(mt.i/ut|0),_.push(St.i/ut|0),removeNode(mt),removeNode(mt.next),mt=rt=St),mt=mt.next}while(mt!==rt);return filterPoints(mt)}function splitEarcut(rt,_,ut,mt,bt,St){let Mt=rt;do{let Bt=Mt.next.next;for(;Bt!==Mt.prev;){if(Mt.i!==Bt.i&&isValidDiagonal(Mt,Bt)){let Ut=splitPolygon(Mt,Bt);Mt=filterPoints(Mt,Mt.next),Ut=filterPoints(Ut,Ut.next),earcutLinked(Mt,_,ut,mt,bt,St,0),earcutLinked(Ut,_,ut,mt,bt,St,0);return}Bt=Bt.next}Mt=Mt.next}while(Mt!==rt)}function eliminateHoles(rt,_,ut,mt){const bt=[];let St,Mt,Bt,Ut,Ht;for(St=0,Mt=_.length;St<Mt;St++)Bt=_[St]*mt,Ut=St<Mt-1?_[St+1]*mt:rt.length,Ht=linkedList(rt,Bt,Ut,mt,!1),Ht===Ht.next&&(Ht.steiner=!0),bt.push(getLeftmost(Ht));for(bt.sort(compareX),St=0;St<bt.length;St++)ut=eliminateHole(bt[St],ut);return ut}function compareX(rt,_){return rt.x-_.x}function eliminateHole(rt,_){const ut=findHoleBridge(rt,_);if(!ut)return _;const mt=splitPolygon(ut,rt);return filterPoints(mt,mt.next),filterPoints(ut,ut.next)}function findHoleBridge(rt,_){let ut=_,mt=-1/0,bt;const St=rt.x,Mt=rt.y;do{if(Mt<=ut.y&&Mt>=ut.next.y&&ut.next.y!==ut.y){const sr=ut.x+(Mt-ut.y)*(ut.next.x-ut.x)/(ut.next.y-ut.y);if(sr<=St&&sr>mt&&(mt=sr,bt=ut.x<ut.next.x?ut:ut.next,sr===St))return bt}ut=ut.next}while(ut!==_);if(!bt)return null;const Bt=bt,Ut=bt.x,Ht=bt.y;let tr=1/0,rr;ut=bt;do St>=ut.x&&ut.x>=Ut&&St!==ut.x&&pointInTriangle(Mt<Ht?St:mt,Mt,Ut,Ht,Mt<Ht?mt:St,Mt,ut.x,ut.y)&&(rr=Math.abs(Mt-ut.y)/(St-ut.x),locallyInside(ut,rt)&&(rr<tr||rr===tr&&(ut.x>bt.x||ut.x===bt.x&&sectorContainsSector(bt,ut)))&&(bt=ut,tr=rr)),ut=ut.next;while(ut!==Bt);return bt}function sectorContainsSector(rt,_){return area(rt.prev,rt,_.prev)<0&&area(_.next,rt,rt.next)<0}function indexCurve(rt,_,ut,mt){let bt=rt;do bt.z===0&&(bt.z=zOrder(bt.x,bt.y,_,ut,mt)),bt.prevZ=bt.prev,bt.nextZ=bt.next,bt=bt.next;while(bt!==rt);bt.prevZ.nextZ=null,bt.prevZ=null,sortLinked(bt)}function sortLinked(rt){let _,ut,mt,bt,St,Mt,Bt,Ut,Ht=1;do{for(ut=rt,rt=null,St=null,Mt=0;ut;){for(Mt++,mt=ut,Bt=0,_=0;_<Ht&&(Bt++,mt=mt.nextZ,!!mt);_++);for(Ut=Ht;Bt>0||Ut>0&&mt;)Bt!==0&&(Ut===0||!mt||ut.z<=mt.z)?(bt=ut,ut=ut.nextZ,Bt--):(bt=mt,mt=mt.nextZ,Ut--),St?St.nextZ=bt:rt=bt,bt.prevZ=St,St=bt;ut=mt}St.nextZ=null,Ht*=2}while(Mt>1);return rt}function zOrder(rt,_,ut,mt,bt){return rt=(rt-ut)*bt|0,_=(_-mt)*bt|0,rt=(rt|rt<<8)&16711935,rt=(rt|rt<<4)&252645135,rt=(rt|rt<<2)&858993459,rt=(rt|rt<<1)&1431655765,_=(_|_<<8)&16711935,_=(_|_<<4)&252645135,_=(_|_<<2)&858993459,_=(_|_<<1)&1431655765,rt|_<<1}function getLeftmost(rt){let _=rt,ut=rt;do(_.x<ut.x||_.x===ut.x&&_.y<ut.y)&&(ut=_),_=_.next;while(_!==rt);return ut}function pointInTriangle(rt,_,ut,mt,bt,St,Mt,Bt){return(bt-Mt)*(_-Bt)>=(rt-Mt)*(St-Bt)&&(rt-Mt)*(mt-Bt)>=(ut-Mt)*(_-Bt)&&(ut-Mt)*(St-Bt)>=(bt-Mt)*(mt-Bt)}function isValidDiagonal(rt,_){return rt.next.i!==_.i&&rt.prev.i!==_.i&&!intersectsPolygon(rt,_)&&(locallyInside(rt,_)&&locallyInside(_,rt)&&middleInside(rt,_)&&(area(rt.prev,rt,_.prev)||area(rt,_.prev,_))||equals(rt,_)&&area(rt.prev,rt,rt.next)>0&&area(_.prev,_,_.next)>0)}function area(rt,_,ut){return(_.y-rt.y)*(ut.x-_.x)-(_.x-rt.x)*(ut.y-_.y)}function equals(rt,_){return rt.x===_.x&&rt.y===_.y}function intersects(rt,_,ut,mt){const bt=sign(area(rt,_,ut)),St=sign(area(rt,_,mt)),Mt=sign(area(ut,mt,rt)),Bt=sign(area(ut,mt,_));return!!(bt!==St&&Mt!==Bt||bt===0&&onSegment(rt,ut,_)||St===0&&onSegment(rt,mt,_)||Mt===0&&onSegment(ut,rt,mt)||Bt===0&&onSegment(ut,_,mt))}function onSegment(rt,_,ut){return _.x<=Math.max(rt.x,ut.x)&&_.x>=Math.min(rt.x,ut.x)&&_.y<=Math.max(rt.y,ut.y)&&_.y>=Math.min(rt.y,ut.y)}function sign(rt){return rt>0?1:rt<0?-1:0}function intersectsPolygon(rt,_){let ut=rt;do{if(ut.i!==rt.i&&ut.next.i!==rt.i&&ut.i!==_.i&&ut.next.i!==_.i&&intersects(ut,ut.next,rt,_))return!0;ut=ut.next}while(ut!==rt);return!1}function locallyInside(rt,_){return area(rt.prev,rt,rt.next)<0?area(rt,_,rt.next)>=0&&area(rt,rt.prev,_)>=0:area(rt,_,rt.prev)<0||area(rt,rt.next,_)<0}function middleInside(rt,_){let ut=rt,mt=!1;const bt=(rt.x+_.x)/2,St=(rt.y+_.y)/2;do ut.y>St!=ut.next.y>St&&ut.next.y!==ut.y&&bt<(ut.next.x-ut.x)*(St-ut.y)/(ut.next.y-ut.y)+ut.x&&(mt=!mt),ut=ut.next;while(ut!==rt);return mt}function splitPolygon(rt,_){const ut=new Node$1(rt.i,rt.x,rt.y),mt=new Node$1(_.i,_.x,_.y),bt=rt.next,St=_.prev;return rt.next=_,_.prev=rt,ut.next=bt,bt.prev=ut,mt.next=ut,ut.prev=mt,St.next=mt,mt.prev=St,mt}function insertNode(rt,_,ut,mt){const bt=new Node$1(rt,_,ut);return mt?(bt.next=mt.next,bt.prev=mt,mt.next.prev=bt,mt.next=bt):(bt.prev=bt,bt.next=bt),bt}function removeNode(rt){rt.next.prev=rt.prev,rt.prev.next=rt.next,rt.prevZ&&(rt.prevZ.nextZ=rt.nextZ),rt.nextZ&&(rt.nextZ.prevZ=rt.prevZ)}function Node$1(rt,_,ut){this.i=rt,this.x=_,this.y=ut,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(rt,_,ut,mt){let bt=0;for(let St=_,Mt=ut-mt;St<ut;St+=mt)bt+=(rt[Mt]-rt[St])*(rt[St+1]+rt[Mt+1]),Mt=St;return bt}class ShapeUtils{static area(_){const ut=_.length;let mt=0;for(let bt=ut-1,St=0;St<ut;bt=St++)mt+=_[bt].x*_[St].y-_[St].x*_[bt].y;return mt*.5}static isClockWise(_){return ShapeUtils.area(_)<0}static triangulateShape(_,ut){const mt=[],bt=[],St=[];removeDupEndPts(_),addContour(mt,_);let Mt=_.length;ut.forEach(removeDupEndPts);for(let Ut=0;Ut<ut.length;Ut++)bt.push(Mt),Mt+=ut[Ut].length,addContour(mt,ut[Ut]);const Bt=Earcut.triangulate(mt,bt);for(let Ut=0;Ut<Bt.length;Ut+=3)St.push(Bt.slice(Ut,Ut+3));return St}}function removeDupEndPts(rt){const _=rt.length;_>2&&rt[_-1].equals(rt[0])&&rt.pop()}function addContour(rt,_){for(let ut=0;ut<_.length;ut++)rt.push(_[ut].x),rt.push(_[ut].y)}class ExtrudeGeometry extends BufferGeometry{constructor(_=new Shape([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),ut={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:_,options:ut},_=Array.isArray(_)?_:[_];const mt=this,bt=[],St=[];for(let Bt=0,Ut=_.length;Bt<Ut;Bt++){const Ht=_[Bt];Mt(Ht)}this.setAttribute("position",new Float32BufferAttribute(bt,3)),this.setAttribute("uv",new Float32BufferAttribute(St,2)),this.computeVertexNormals();function Mt(Bt){const Ut=[],Ht=ut.curveSegments!==void 0?ut.curveSegments:12,tr=ut.steps!==void 0?ut.steps:1,rr=ut.depth!==void 0?ut.depth:1;let sr=ut.bevelEnabled!==void 0?ut.bevelEnabled:!0,ar=ut.bevelThickness!==void 0?ut.bevelThickness:.2,cr=ut.bevelSize!==void 0?ut.bevelSize:ar-.1,Ar=ut.bevelOffset!==void 0?ut.bevelOffset:0,_r=ut.bevelSegments!==void 0?ut.bevelSegments:3;const Dr=ut.extrudePath,$r=ut.UVGenerator!==void 0?ut.UVGenerator:WorldUVGenerator;let Br,Jr=!1,mn,Mn,$n,en;Dr&&(Br=Dr.getSpacedPoints(tr),Jr=!0,sr=!1,mn=Dr.computeFrenetFrames(tr,!1),Mn=new Vector3,$n=new Vector3,en=new Vector3),sr||(_r=0,ar=0,cr=0,Ar=0);const In=Bt.extractPoints(Ht);let Rn=In.shape;const qn=In.holes;if(!ShapeUtils.isClockWise(Rn)){Rn=Rn.reverse();for(let mp=0,Cp=qn.length;mp<Cp;mp++){const t0=qn[mp];ShapeUtils.isClockWise(t0)&&(qn[mp]=t0.reverse())}}const xs=ShapeUtils.triangulateShape(Rn,qn),cs=Rn;for(let mp=0,Cp=qn.length;mp<Cp;mp++){const t0=qn[mp];Rn=Rn.concat(t0)}function ks(mp,Cp,t0){return Cp||console.error("THREE.ExtrudeGeometry: vec does not exist"),mp.clone().addScaledVector(Cp,t0)}const _o=Rn.length,qs=xs.length;function Ss(mp,Cp,t0){let _g,m0,K0;const Jp=mp.x-Cp.x,y0=mp.y-Cp.y,z0=t0.x-mp.x,jm=t0.y-mp.y,Nu=Jp*Jp+y0*y0,Co=Jp*jm-y0*z0;if(Math.abs(Co)>Number.EPSILON){const Bp=Math.sqrt(Nu),a0=Math.sqrt(z0*z0+jm*jm),Q0=Cp.x-y0/Bp,T0=Cp.y+Jp/Bp,av=t0.x-jm/a0,lv=t0.y+z0/a0,N0=((av-Q0)*jm-(lv-T0)*z0)/(Jp*jm-y0*z0);_g=Q0+Jp*N0-mp.x,m0=T0+y0*N0-mp.y;const zv=_g*_g+m0*m0;if(zv<=2)return new Vector2(_g,m0);K0=Math.sqrt(zv/2)}else{let Bp=!1;Jp>Number.EPSILON?z0>Number.EPSILON&&(Bp=!0):Jp<-Number.EPSILON?z0<-Number.EPSILON&&(Bp=!0):Math.sign(y0)===Math.sign(jm)&&(Bp=!0),Bp?(_g=-y0,m0=Jp,K0=Math.sqrt(Nu)):(_g=Jp,m0=y0,K0=Math.sqrt(Nu/2))}return new Vector2(_g/K0,m0/K0)}const eo=[];for(let mp=0,Cp=cs.length,t0=Cp-1,_g=mp+1;mp<Cp;mp++,t0++,_g++)t0===Cp&&(t0=0),_g===Cp&&(_g=0),eo[mp]=Ss(cs[mp],cs[t0],cs[_g]);const Ao=[];let Oo,uo=eo.concat();for(let mp=0,Cp=qn.length;mp<Cp;mp++){const t0=qn[mp];Oo=[];for(let _g=0,m0=t0.length,K0=m0-1,Jp=_g+1;_g<m0;_g++,K0++,Jp++)K0===m0&&(K0=0),Jp===m0&&(Jp=0),Oo[_g]=Ss(t0[_g],t0[K0],t0[Jp]);Ao.push(Oo),uo=uo.concat(Oo)}for(let mp=0;mp<_r;mp++){const Cp=mp/_r,t0=ar*Math.cos(Cp*Math.PI/2),_g=cr*Math.sin(Cp*Math.PI/2)+Ar;for(let m0=0,K0=cs.length;m0<K0;m0++){const Jp=ks(cs[m0],eo[m0],_g);pu(Jp.x,Jp.y,-t0)}for(let m0=0,K0=qn.length;m0<K0;m0++){const Jp=qn[m0];Oo=Ao[m0];for(let y0=0,z0=Jp.length;y0<z0;y0++){const jm=ks(Jp[y0],Oo[y0],_g);pu(jm.x,jm.y,-t0)}}}const uu=cr+Ar;for(let mp=0;mp<_o;mp++){const Cp=sr?ks(Rn[mp],uo[mp],uu):Rn[mp];Jr?($n.copy(mn.normals[0]).multiplyScalar(Cp.x),Mn.copy(mn.binormals[0]).multiplyScalar(Cp.y),en.copy(Br[0]).add($n).add(Mn),pu(en.x,en.y,en.z)):pu(Cp.x,Cp.y,0)}for(let mp=1;mp<=tr;mp++)for(let Cp=0;Cp<_o;Cp++){const t0=sr?ks(Rn[Cp],uo[Cp],uu):Rn[Cp];Jr?($n.copy(mn.normals[mp]).multiplyScalar(t0.x),Mn.copy(mn.binormals[mp]).multiplyScalar(t0.y),en.copy(Br[mp]).add($n).add(Mn),pu(en.x,en.y,en.z)):pu(t0.x,t0.y,rr/tr*mp)}for(let mp=_r-1;mp>=0;mp--){const Cp=mp/_r,t0=ar*Math.cos(Cp*Math.PI/2),_g=cr*Math.sin(Cp*Math.PI/2)+Ar;for(let m0=0,K0=cs.length;m0<K0;m0++){const Jp=ks(cs[m0],eo[m0],_g);pu(Jp.x,Jp.y,rr+t0)}for(let m0=0,K0=qn.length;m0<K0;m0++){const Jp=qn[m0];Oo=Ao[m0];for(let y0=0,z0=Jp.length;y0<z0;y0++){const jm=ks(Jp[y0],Oo[y0],_g);Jr?pu(jm.x,jm.y+Br[tr-1].y,Br[tr-1].x+t0):pu(jm.x,jm.y,rr+t0)}}}cu(),Jl();function cu(){const mp=bt.length/3;if(sr){let Cp=0,t0=_o*Cp;for(let _g=0;_g<qs;_g++){const m0=xs[_g];Zu(m0[2]+t0,m0[1]+t0,m0[0]+t0)}Cp=tr+_r*2,t0=_o*Cp;for(let _g=0;_g<qs;_g++){const m0=xs[_g];Zu(m0[0]+t0,m0[1]+t0,m0[2]+t0)}}else{for(let Cp=0;Cp<qs;Cp++){const t0=xs[Cp];Zu(t0[2],t0[1],t0[0])}for(let Cp=0;Cp<qs;Cp++){const t0=xs[Cp];Zu(t0[0]+_o*tr,t0[1]+_o*tr,t0[2]+_o*tr)}}mt.addGroup(mp,bt.length/3-mp,0)}function Jl(){const mp=bt.length/3;let Cp=0;mu(cs,Cp),Cp+=cs.length;for(let t0=0,_g=qn.length;t0<_g;t0++){const m0=qn[t0];mu(m0,Cp),Cp+=m0.length}mt.addGroup(mp,bt.length/3-mp,1)}function mu(mp,Cp){let t0=mp.length;for(;--t0>=0;){const _g=t0;let m0=t0-1;m0<0&&(m0=mp.length-1);for(let K0=0,Jp=tr+_r*2;K0<Jp;K0++){const y0=_o*K0,z0=_o*(K0+1),jm=Cp+_g+y0,Nu=Cp+m0+y0,Co=Cp+m0+z0,Bp=Cp+_g+z0;Mp(jm,Nu,Co,Bp)}}}function pu(mp,Cp,t0){Ut.push(mp),Ut.push(Cp),Ut.push(t0)}function Zu(mp,Cp,t0){Up(mp),Up(Cp),Up(t0);const _g=bt.length/3,m0=$r.generateTopUV(mt,bt,_g-3,_g-2,_g-1);Ep(m0[0]),Ep(m0[1]),Ep(m0[2])}function Mp(mp,Cp,t0,_g){Up(mp),Up(Cp),Up(_g),Up(Cp),Up(t0),Up(_g);const m0=bt.length/3,K0=$r.generateSideWallUV(mt,bt,m0-6,m0-3,m0-2,m0-1);Ep(K0[0]),Ep(K0[1]),Ep(K0[3]),Ep(K0[1]),Ep(K0[2]),Ep(K0[3])}function Up(mp){bt.push(Ut[mp*3+0]),bt.push(Ut[mp*3+1]),bt.push(Ut[mp*3+2])}function Ep(mp){St.push(mp.x),St.push(mp.y)}}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON(),ut=this.parameters.shapes,mt=this.parameters.options;return toJSON$1(ut,mt,_)}static fromJSON(_,ut){const mt=[];for(let St=0,Mt=_.shapes.length;St<Mt;St++){const Bt=ut[_.shapes[St]];mt.push(Bt)}const bt=_.options.extrudePath;return bt!==void 0&&(_.options.extrudePath=new Curves[bt.type]().fromJSON(bt)),new ExtrudeGeometry(mt,_.options)}}const WorldUVGenerator={generateTopUV:function(rt,_,ut,mt,bt){const St=_[ut*3],Mt=_[ut*3+1],Bt=_[mt*3],Ut=_[mt*3+1],Ht=_[bt*3],tr=_[bt*3+1];return[new Vector2(St,Mt),new Vector2(Bt,Ut),new Vector2(Ht,tr)]},generateSideWallUV:function(rt,_,ut,mt,bt,St){const Mt=_[ut*3],Bt=_[ut*3+1],Ut=_[ut*3+2],Ht=_[mt*3],tr=_[mt*3+1],rr=_[mt*3+2],sr=_[bt*3],ar=_[bt*3+1],cr=_[bt*3+2],Ar=_[St*3],_r=_[St*3+1],Dr=_[St*3+2];return Math.abs(Bt-tr)<Math.abs(Mt-Ht)?[new Vector2(Mt,1-Ut),new Vector2(Ht,1-rr),new Vector2(sr,1-cr),new Vector2(Ar,1-Dr)]:[new Vector2(Bt,1-Ut),new Vector2(tr,1-rr),new Vector2(ar,1-cr),new Vector2(_r,1-Dr)]}};function toJSON$1(rt,_,ut){if(ut.shapes=[],Array.isArray(rt))for(let mt=0,bt=rt.length;mt<bt;mt++){const St=rt[mt];ut.shapes.push(St.uuid)}else ut.shapes.push(rt.uuid);return ut.options=Object.assign({},_),_.extrudePath!==void 0&&(ut.options.extrudePath=_.extrudePath.toJSON()),ut}class IcosahedronGeometry extends PolyhedronGeometry{constructor(_=1,ut=0){const mt=(1+Math.sqrt(5))/2,bt=[-1,mt,0,1,mt,0,-1,-mt,0,1,-mt,0,0,-1,mt,0,1,mt,0,-1,-mt,0,1,-mt,mt,0,-1,mt,0,1,-mt,0,-1,-mt,0,1],St=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(bt,St,_,ut),this.type="IcosahedronGeometry",this.parameters={radius:_,detail:ut}}static fromJSON(_){return new IcosahedronGeometry(_.radius,_.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(_=1,ut=0){const mt=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],bt=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(mt,bt,_,ut),this.type="OctahedronGeometry",this.parameters={radius:_,detail:ut}}static fromJSON(_){return new OctahedronGeometry(_.radius,_.detail)}}class RingGeometry extends BufferGeometry{constructor(_=.5,ut=1,mt=32,bt=1,St=0,Mt=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:_,outerRadius:ut,thetaSegments:mt,phiSegments:bt,thetaStart:St,thetaLength:Mt},mt=Math.max(3,mt),bt=Math.max(1,bt);const Bt=[],Ut=[],Ht=[],tr=[];let rr=_;const sr=(ut-_)/bt,ar=new Vector3,cr=new Vector2;for(let Ar=0;Ar<=bt;Ar++){for(let _r=0;_r<=mt;_r++){const Dr=St+_r/mt*Mt;ar.x=rr*Math.cos(Dr),ar.y=rr*Math.sin(Dr),Ut.push(ar.x,ar.y,ar.z),Ht.push(0,0,1),cr.x=(ar.x/ut+1)/2,cr.y=(ar.y/ut+1)/2,tr.push(cr.x,cr.y)}rr+=sr}for(let Ar=0;Ar<bt;Ar++){const _r=Ar*(mt+1);for(let Dr=0;Dr<mt;Dr++){const $r=Dr+_r,Br=$r,Jr=$r+mt+1,mn=$r+mt+2,Mn=$r+1;Bt.push(Br,Jr,Mn),Bt.push(Jr,mn,Mn)}}this.setIndex(Bt),this.setAttribute("position",new Float32BufferAttribute(Ut,3)),this.setAttribute("normal",new Float32BufferAttribute(Ht,3)),this.setAttribute("uv",new Float32BufferAttribute(tr,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new RingGeometry(_.innerRadius,_.outerRadius,_.thetaSegments,_.phiSegments,_.thetaStart,_.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(_=new Shape([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),ut=12){super(),this.type="ShapeGeometry",this.parameters={shapes:_,curveSegments:ut};const mt=[],bt=[],St=[],Mt=[];let Bt=0,Ut=0;if(Array.isArray(_)===!1)Ht(_);else for(let tr=0;tr<_.length;tr++)Ht(_[tr]),this.addGroup(Bt,Ut,tr),Bt+=Ut,Ut=0;this.setIndex(mt),this.setAttribute("position",new Float32BufferAttribute(bt,3)),this.setAttribute("normal",new Float32BufferAttribute(St,3)),this.setAttribute("uv",new Float32BufferAttribute(Mt,2));function Ht(tr){const rr=bt.length/3,sr=tr.extractPoints(ut);let ar=sr.shape;const cr=sr.holes;ShapeUtils.isClockWise(ar)===!1&&(ar=ar.reverse());for(let _r=0,Dr=cr.length;_r<Dr;_r++){const $r=cr[_r];ShapeUtils.isClockWise($r)===!0&&(cr[_r]=$r.reverse())}const Ar=ShapeUtils.triangulateShape(ar,cr);for(let _r=0,Dr=cr.length;_r<Dr;_r++){const $r=cr[_r];ar=ar.concat($r)}for(let _r=0,Dr=ar.length;_r<Dr;_r++){const $r=ar[_r];bt.push($r.x,$r.y,0),St.push(0,0,1),Mt.push($r.x,$r.y)}for(let _r=0,Dr=Ar.length;_r<Dr;_r++){const $r=Ar[_r],Br=$r[0]+rr,Jr=$r[1]+rr,mn=$r[2]+rr;mt.push(Br,Jr,mn),Ut+=3}}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON(),ut=this.parameters.shapes;return toJSON(ut,_)}static fromJSON(_,ut){const mt=[];for(let bt=0,St=_.shapes.length;bt<St;bt++){const Mt=ut[_.shapes[bt]];mt.push(Mt)}return new ShapeGeometry(mt,_.curveSegments)}}function toJSON(rt,_){if(_.shapes=[],Array.isArray(rt))for(let ut=0,mt=rt.length;ut<mt;ut++){const bt=rt[ut];_.shapes.push(bt.uuid)}else _.shapes.push(rt.uuid);return _}class SphereGeometry extends BufferGeometry{constructor(_=1,ut=32,mt=16,bt=0,St=Math.PI*2,Mt=0,Bt=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:_,widthSegments:ut,heightSegments:mt,phiStart:bt,phiLength:St,thetaStart:Mt,thetaLength:Bt},ut=Math.max(3,Math.floor(ut)),mt=Math.max(2,Math.floor(mt));const Ut=Math.min(Mt+Bt,Math.PI);let Ht=0;const tr=[],rr=new Vector3,sr=new Vector3,ar=[],cr=[],Ar=[],_r=[];for(let Dr=0;Dr<=mt;Dr++){const $r=[],Br=Dr/mt;let Jr=0;Dr==0&&Mt==0?Jr=.5/ut:Dr==mt&&Ut==Math.PI&&(Jr=-.5/ut);for(let mn=0;mn<=ut;mn++){const Mn=mn/ut;rr.x=-_*Math.cos(bt+Mn*St)*Math.sin(Mt+Br*Bt),rr.y=_*Math.cos(Mt+Br*Bt),rr.z=_*Math.sin(bt+Mn*St)*Math.sin(Mt+Br*Bt),cr.push(rr.x,rr.y,rr.z),sr.copy(rr).normalize(),Ar.push(sr.x,sr.y,sr.z),_r.push(Mn+Jr,1-Br),$r.push(Ht++)}tr.push($r)}for(let Dr=0;Dr<mt;Dr++)for(let $r=0;$r<ut;$r++){const Br=tr[Dr][$r+1],Jr=tr[Dr][$r],mn=tr[Dr+1][$r],Mn=tr[Dr+1][$r+1];(Dr!==0||Mt>0)&&ar.push(Br,Jr,Mn),(Dr!==mt-1||Ut<Math.PI)&&ar.push(Jr,mn,Mn)}this.setIndex(ar),this.setAttribute("position",new Float32BufferAttribute(cr,3)),this.setAttribute("normal",new Float32BufferAttribute(Ar,3)),this.setAttribute("uv",new Float32BufferAttribute(_r,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new SphereGeometry(_.radius,_.widthSegments,_.heightSegments,_.phiStart,_.phiLength,_.thetaStart,_.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(_=1,ut=0){const mt=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],bt=[2,1,0,0,3,2,1,3,0,2,3,1];super(mt,bt,_,ut),this.type="TetrahedronGeometry",this.parameters={radius:_,detail:ut}}static fromJSON(_){return new TetrahedronGeometry(_.radius,_.detail)}}class TorusGeometry extends BufferGeometry{constructor(_=1,ut=.4,mt=12,bt=48,St=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:_,tube:ut,radialSegments:mt,tubularSegments:bt,arc:St},mt=Math.floor(mt),bt=Math.floor(bt);const Mt=[],Bt=[],Ut=[],Ht=[],tr=new Vector3,rr=new Vector3,sr=new Vector3;for(let ar=0;ar<=mt;ar++)for(let cr=0;cr<=bt;cr++){const Ar=cr/bt*St,_r=ar/mt*Math.PI*2;rr.x=(_+ut*Math.cos(_r))*Math.cos(Ar),rr.y=(_+ut*Math.cos(_r))*Math.sin(Ar),rr.z=ut*Math.sin(_r),Bt.push(rr.x,rr.y,rr.z),tr.x=_*Math.cos(Ar),tr.y=_*Math.sin(Ar),sr.subVectors(rr,tr).normalize(),Ut.push(sr.x,sr.y,sr.z),Ht.push(cr/bt),Ht.push(ar/mt)}for(let ar=1;ar<=mt;ar++)for(let cr=1;cr<=bt;cr++){const Ar=(bt+1)*ar+cr-1,_r=(bt+1)*(ar-1)+cr-1,Dr=(bt+1)*(ar-1)+cr,$r=(bt+1)*ar+cr;Mt.push(Ar,_r,$r),Mt.push(_r,Dr,$r)}this.setIndex(Mt),this.setAttribute("position",new Float32BufferAttribute(Bt,3)),this.setAttribute("normal",new Float32BufferAttribute(Ut,3)),this.setAttribute("uv",new Float32BufferAttribute(Ht,2))}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new TorusGeometry(_.radius,_.tube,_.radialSegments,_.tubularSegments,_.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(_=1,ut=.4,mt=64,bt=8,St=2,Mt=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:_,tube:ut,tubularSegments:mt,radialSegments:bt,p:St,q:Mt},mt=Math.floor(mt),bt=Math.floor(bt);const Bt=[],Ut=[],Ht=[],tr=[],rr=new Vector3,sr=new Vector3,ar=new Vector3,cr=new Vector3,Ar=new Vector3,_r=new Vector3,Dr=new Vector3;for(let Br=0;Br<=mt;++Br){const Jr=Br/mt*St*Math.PI*2;$r(Jr,St,Mt,_,ar),$r(Jr+.01,St,Mt,_,cr),_r.subVectors(cr,ar),Dr.addVectors(cr,ar),Ar.crossVectors(_r,Dr),Dr.crossVectors(Ar,_r),Ar.normalize(),Dr.normalize();for(let mn=0;mn<=bt;++mn){const Mn=mn/bt*Math.PI*2,$n=-ut*Math.cos(Mn),en=ut*Math.sin(Mn);rr.x=ar.x+($n*Dr.x+en*Ar.x),rr.y=ar.y+($n*Dr.y+en*Ar.y),rr.z=ar.z+($n*Dr.z+en*Ar.z),Ut.push(rr.x,rr.y,rr.z),sr.subVectors(rr,ar).normalize(),Ht.push(sr.x,sr.y,sr.z),tr.push(Br/mt),tr.push(mn/bt)}}for(let Br=1;Br<=mt;Br++)for(let Jr=1;Jr<=bt;Jr++){const mn=(bt+1)*(Br-1)+(Jr-1),Mn=(bt+1)*Br+(Jr-1),$n=(bt+1)*Br+Jr,en=(bt+1)*(Br-1)+Jr;Bt.push(mn,Mn,en),Bt.push(Mn,$n,en)}this.setIndex(Bt),this.setAttribute("position",new Float32BufferAttribute(Ut,3)),this.setAttribute("normal",new Float32BufferAttribute(Ht,3)),this.setAttribute("uv",new Float32BufferAttribute(tr,2));function $r(Br,Jr,mn,Mn,$n){const en=Math.cos(Br),In=Math.sin(Br),Rn=mn/Jr*Br,qn=Math.cos(Rn);$n.x=Mn*(2+qn)*.5*en,$n.y=Mn*(2+qn)*In*.5,$n.z=Mn*Math.sin(Rn)*.5}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}static fromJSON(_){return new TorusKnotGeometry(_.radius,_.tube,_.tubularSegments,_.radialSegments,_.p,_.q)}}class TubeGeometry extends BufferGeometry{constructor(_=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),ut=64,mt=1,bt=8,St=!1){super(),this.type="TubeGeometry",this.parameters={path:_,tubularSegments:ut,radius:mt,radialSegments:bt,closed:St};const Mt=_.computeFrenetFrames(ut,St);this.tangents=Mt.tangents,this.normals=Mt.normals,this.binormals=Mt.binormals;const Bt=new Vector3,Ut=new Vector3,Ht=new Vector2;let tr=new Vector3;const rr=[],sr=[],ar=[],cr=[];Ar(),this.setIndex(cr),this.setAttribute("position",new Float32BufferAttribute(rr,3)),this.setAttribute("normal",new Float32BufferAttribute(sr,3)),this.setAttribute("uv",new Float32BufferAttribute(ar,2));function Ar(){for(let Br=0;Br<ut;Br++)_r(Br);_r(St===!1?ut:0),$r(),Dr()}function _r(Br){tr=_.getPointAt(Br/ut,tr);const Jr=Mt.normals[Br],mn=Mt.binormals[Br];for(let Mn=0;Mn<=bt;Mn++){const $n=Mn/bt*Math.PI*2,en=Math.sin($n),In=-Math.cos($n);Ut.x=In*Jr.x+en*mn.x,Ut.y=In*Jr.y+en*mn.y,Ut.z=In*Jr.z+en*mn.z,Ut.normalize(),sr.push(Ut.x,Ut.y,Ut.z),Bt.x=tr.x+mt*Ut.x,Bt.y=tr.y+mt*Ut.y,Bt.z=tr.z+mt*Ut.z,rr.push(Bt.x,Bt.y,Bt.z)}}function Dr(){for(let Br=1;Br<=ut;Br++)for(let Jr=1;Jr<=bt;Jr++){const mn=(bt+1)*(Br-1)+(Jr-1),Mn=(bt+1)*Br+(Jr-1),$n=(bt+1)*Br+Jr,en=(bt+1)*(Br-1)+Jr;cr.push(mn,Mn,en),cr.push(Mn,$n,en)}}function $r(){for(let Br=0;Br<=ut;Br++)for(let Jr=0;Jr<=bt;Jr++)Ht.x=Br/ut,Ht.y=Jr/bt,ar.push(Ht.x,Ht.y)}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}toJSON(){const _=super.toJSON();return _.path=this.parameters.path.toJSON(),_}static fromJSON(_){return new TubeGeometry(new Curves[_.path.type]().fromJSON(_.path),_.tubularSegments,_.radius,_.radialSegments,_.closed)}}class WireframeGeometry extends BufferGeometry{constructor(_=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:_},_!==null){const ut=[],mt=new Set,bt=new Vector3,St=new Vector3;if(_.index!==null){const Mt=_.attributes.position,Bt=_.index;let Ut=_.groups;Ut.length===0&&(Ut=[{start:0,count:Bt.count,materialIndex:0}]);for(let Ht=0,tr=Ut.length;Ht<tr;++Ht){const rr=Ut[Ht],sr=rr.start,ar=rr.count;for(let cr=sr,Ar=sr+ar;cr<Ar;cr+=3)for(let _r=0;_r<3;_r++){const Dr=Bt.getX(cr+_r),$r=Bt.getX(cr+(_r+1)%3);bt.fromBufferAttribute(Mt,Dr),St.fromBufferAttribute(Mt,$r),isUniqueEdge(bt,St,mt)===!0&&(ut.push(bt.x,bt.y,bt.z),ut.push(St.x,St.y,St.z))}}}else{const Mt=_.attributes.position;for(let Bt=0,Ut=Mt.count/3;Bt<Ut;Bt++)for(let Ht=0;Ht<3;Ht++){const tr=3*Bt+Ht,rr=3*Bt+(Ht+1)%3;bt.fromBufferAttribute(Mt,tr),St.fromBufferAttribute(Mt,rr),isUniqueEdge(bt,St,mt)===!0&&(ut.push(bt.x,bt.y,bt.z),ut.push(St.x,St.y,St.z))}}this.setAttribute("position",new Float32BufferAttribute(ut,3))}}copy(_){return super.copy(_),this.parameters=Object.assign({},_.parameters),this}}function isUniqueEdge(rt,_,ut){const mt=`${rt.x},${rt.y},${rt.z}-${_.x},${_.y},${_.z}`,bt=`${_.x},${_.y},${_.z}-${rt.x},${rt.y},${rt.z}`;return ut.has(mt)===!0||ut.has(bt)===!0?!1:(ut.add(mt),ut.add(bt),!0)}var Geometries=Object.freeze({__proto__:null,BoxGeometry,CapsuleGeometry,CircleGeometry,ConeGeometry,CylinderGeometry,DodecahedronGeometry,EdgesGeometry,ExtrudeGeometry,IcosahedronGeometry,LatheGeometry,OctahedronGeometry,PlaneGeometry,PolyhedronGeometry,RingGeometry,ShapeGeometry,SphereGeometry,TetrahedronGeometry,TorusGeometry,TorusKnotGeometry,TubeGeometry,WireframeGeometry});class ShadowMaterial extends Material{constructor(_){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Color$1(0),this.transparent=!0,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.fog=_.fog,this}}class RawShaderMaterial extends ShaderMaterial{constructor(_){super(_),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class MeshStandardMaterial extends Material{constructor(_){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color$1(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.defines={STANDARD:""},this.color.copy(_.color),this.roughness=_.roughness,this.metalness=_.metalness,this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.roughnessMap=_.roughnessMap,this.metalnessMap=_.metalnessMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.envMapIntensity=_.envMapIntensity,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(_){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return clamp$7(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(ut){this.ior=(1+.4*ut)/(1-.4*ut)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Color$1(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Color$1(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color$1(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(_)}get sheen(){return this._sheen}set sheen(_){this._sheen>0!=_>0&&this.version++,this._sheen=_}get clearcoat(){return this._clearcoat}set clearcoat(_){this._clearcoat>0!=_>0&&this.version++,this._clearcoat=_}get iridescence(){return this._iridescence}set iridescence(_){this._iridescence>0!=_>0&&this.version++,this._iridescence=_}get transmission(){return this._transmission}set transmission(_){this._transmission>0!=_>0&&this.version++,this._transmission=_}copy(_){return super.copy(_),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=_.clearcoat,this.clearcoatMap=_.clearcoatMap,this.clearcoatRoughness=_.clearcoatRoughness,this.clearcoatRoughnessMap=_.clearcoatRoughnessMap,this.clearcoatNormalMap=_.clearcoatNormalMap,this.clearcoatNormalScale.copy(_.clearcoatNormalScale),this.ior=_.ior,this.iridescence=_.iridescence,this.iridescenceMap=_.iridescenceMap,this.iridescenceIOR=_.iridescenceIOR,this.iridescenceThicknessRange=[..._.iridescenceThicknessRange],this.iridescenceThicknessMap=_.iridescenceThicknessMap,this.sheen=_.sheen,this.sheenColor.copy(_.sheenColor),this.sheenColorMap=_.sheenColorMap,this.sheenRoughness=_.sheenRoughness,this.sheenRoughnessMap=_.sheenRoughnessMap,this.transmission=_.transmission,this.transmissionMap=_.transmissionMap,this.thickness=_.thickness,this.thicknessMap=_.thicknessMap,this.attenuationDistance=_.attenuationDistance,this.attenuationColor.copy(_.attenuationColor),this.specularIntensity=_.specularIntensity,this.specularIntensityMap=_.specularIntensityMap,this.specularColor.copy(_.specularColor),this.specularColorMap=_.specularColorMap,this}}class MeshPhongMaterial extends Material{constructor(_){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Color$1(16777215),this.specular=new Color$1(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.specular.copy(_.specular),this.shininess=_.shininess,this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshToonMaterial extends Material{constructor(_){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color$1(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.gradientMap=_.gradientMap,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.alphaMap=_.alphaMap,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.fog=_.fog,this}}class MeshNormalMaterial extends Material{constructor(_){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(_)}copy(_){return super.copy(_),this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.flatShading=_.flatShading,this}}class MeshLambertMaterial extends Material{constructor(_){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Color$1(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color$1(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.color.copy(_.color),this.map=_.map,this.lightMap=_.lightMap,this.lightMapIntensity=_.lightMapIntensity,this.aoMap=_.aoMap,this.aoMapIntensity=_.aoMapIntensity,this.emissive.copy(_.emissive),this.emissiveMap=_.emissiveMap,this.emissiveIntensity=_.emissiveIntensity,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.specularMap=_.specularMap,this.alphaMap=_.alphaMap,this.envMap=_.envMap,this.combine=_.combine,this.reflectivity=_.reflectivity,this.refractionRatio=_.refractionRatio,this.wireframe=_.wireframe,this.wireframeLinewidth=_.wireframeLinewidth,this.wireframeLinecap=_.wireframeLinecap,this.wireframeLinejoin=_.wireframeLinejoin,this.flatShading=_.flatShading,this.fog=_.fog,this}}class MeshMatcapMaterial extends Material{constructor(_){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color$1(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(_)}copy(_){return super.copy(_),this.defines={MATCAP:""},this.color.copy(_.color),this.matcap=_.matcap,this.map=_.map,this.bumpMap=_.bumpMap,this.bumpScale=_.bumpScale,this.normalMap=_.normalMap,this.normalMapType=_.normalMapType,this.normalScale.copy(_.normalScale),this.displacementMap=_.displacementMap,this.displacementScale=_.displacementScale,this.displacementBias=_.displacementBias,this.alphaMap=_.alphaMap,this.flatShading=_.flatShading,this.fog=_.fog,this}}class LineDashedMaterial extends LineBasicMaterial{constructor(_){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(_)}copy(_){return super.copy(_),this.scale=_.scale,this.dashSize=_.dashSize,this.gapSize=_.gapSize,this}}function arraySlice(rt,_,ut){return isTypedArray$1(rt)?new rt.constructor(rt.subarray(_,ut!==void 0?ut:rt.length)):rt.slice(_,ut)}function convertArray(rt,_,ut){return!rt||!ut&&rt.constructor===_?rt:typeof _.BYTES_PER_ELEMENT=="number"?new _(rt):Array.prototype.slice.call(rt)}function isTypedArray$1(rt){return ArrayBuffer.isView(rt)&&!(rt instanceof DataView)}function getKeyframeOrder(rt){function _(bt,St){return rt[bt]-rt[St]}const ut=rt.length,mt=new Array(ut);for(let bt=0;bt!==ut;++bt)mt[bt]=bt;return mt.sort(_),mt}function sortedArray(rt,_,ut){const mt=rt.length,bt=new rt.constructor(mt);for(let St=0,Mt=0;Mt!==mt;++St){const Bt=ut[St]*_;for(let Ut=0;Ut!==_;++Ut)bt[Mt++]=rt[Bt+Ut]}return bt}function flattenJSON(rt,_,ut,mt){let bt=1,St=rt[0];for(;St!==void 0&&St[mt]===void 0;)St=rt[bt++];if(St===void 0)return;let Mt=St[mt];if(Mt!==void 0)if(Array.isArray(Mt))do Mt=St[mt],Mt!==void 0&&(_.push(St.time),ut.push.apply(ut,Mt)),St=rt[bt++];while(St!==void 0);else if(Mt.toArray!==void 0)do Mt=St[mt],Mt!==void 0&&(_.push(St.time),Mt.toArray(ut,ut.length)),St=rt[bt++];while(St!==void 0);else do Mt=St[mt],Mt!==void 0&&(_.push(St.time),ut.push(Mt)),St=rt[bt++];while(St!==void 0)}function subclip(rt,_,ut,mt,bt=30){const St=rt.clone();St.name=_;const Mt=[];for(let Ut=0;Ut<St.tracks.length;++Ut){const Ht=St.tracks[Ut],tr=Ht.getValueSize(),rr=[],sr=[];for(let ar=0;ar<Ht.times.length;++ar){const cr=Ht.times[ar]*bt;if(!(cr<ut||cr>=mt)){rr.push(Ht.times[ar]);for(let Ar=0;Ar<tr;++Ar)sr.push(Ht.values[ar*tr+Ar])}}rr.length!==0&&(Ht.times=convertArray(rr,Ht.times.constructor),Ht.values=convertArray(sr,Ht.values.constructor),Mt.push(Ht))}St.tracks=Mt;let Bt=1/0;for(let Ut=0;Ut<St.tracks.length;++Ut)Bt>St.tracks[Ut].times[0]&&(Bt=St.tracks[Ut].times[0]);for(let Ut=0;Ut<St.tracks.length;++Ut)St.tracks[Ut].shift(-1*Bt);return St.resetDuration(),St}function makeClipAdditive(rt,_=0,ut=rt,mt=30){mt<=0&&(mt=30);const bt=ut.tracks.length,St=_/mt;for(let Mt=0;Mt<bt;++Mt){const Bt=ut.tracks[Mt],Ut=Bt.ValueTypeName;if(Ut==="bool"||Ut==="string")continue;const Ht=rt.tracks.find(function(Dr){return Dr.name===Bt.name&&Dr.ValueTypeName===Ut});if(Ht===void 0)continue;let tr=0;const rr=Bt.getValueSize();Bt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(tr=rr/3);let sr=0;const ar=Ht.getValueSize();Ht.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(sr=ar/3);const cr=Bt.times.length-1;let Ar;if(St<=Bt.times[0]){const Dr=tr,$r=rr-tr;Ar=arraySlice(Bt.values,Dr,$r)}else if(St>=Bt.times[cr]){const Dr=cr*rr+tr,$r=Dr+rr-tr;Ar=arraySlice(Bt.values,Dr,$r)}else{const Dr=Bt.createInterpolant(),$r=tr,Br=rr-tr;Dr.evaluate(St),Ar=arraySlice(Dr.resultBuffer,$r,Br)}Ut==="quaternion"&&new Quaternion().fromArray(Ar).normalize().conjugate().toArray(Ar);const _r=Ht.times.length;for(let Dr=0;Dr<_r;++Dr){const $r=Dr*ar+sr;if(Ut==="quaternion")Quaternion.multiplyQuaternionsFlat(Ht.values,$r,Ar,0,Ht.values,$r);else{const Br=ar-sr*2;for(let Jr=0;Jr<Br;++Jr)Ht.values[$r+Jr]-=Ar[Jr]}}}return rt.blendMode=AdditiveAnimationBlendMode,rt}const AnimationUtils={arraySlice,convertArray,isTypedArray:isTypedArray$1,getKeyframeOrder,sortedArray,flattenJSON,subclip,makeClipAdditive};class Interpolant{constructor(_,ut,mt,bt){this.parameterPositions=_,this._cachedIndex=0,this.resultBuffer=bt!==void 0?bt:new ut.constructor(mt),this.sampleValues=ut,this.valueSize=mt,this.settings=null,this.DefaultSettings_={}}evaluate(_){const ut=this.parameterPositions;let mt=this._cachedIndex,bt=ut[mt],St=ut[mt-1];e:{t:{let Mt;r:{n:if(!(_<bt)){for(let Bt=mt+2;;){if(bt===void 0){if(_<St)break n;return mt=ut.length,this._cachedIndex=mt,this.copySampleValue_(mt-1)}if(mt===Bt)break;if(St=bt,bt=ut[++mt],_<bt)break t}Mt=ut.length;break r}if(!(_>=St)){const Bt=ut[1];_<Bt&&(mt=2,St=Bt);for(let Ut=mt-2;;){if(St===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(mt===Ut)break;if(bt=St,St=ut[--mt-1],_>=St)break t}Mt=mt,mt=0;break r}break e}for(;mt<Mt;){const Bt=mt+Mt>>>1;_<ut[Bt]?Mt=Bt:mt=Bt+1}if(bt=ut[mt],St=ut[mt-1],St===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(bt===void 0)return mt=ut.length,this._cachedIndex=mt,this.copySampleValue_(mt-1)}this._cachedIndex=mt,this.intervalChanged_(mt,St,bt)}return this.interpolate_(mt,St,_,bt)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(_){const ut=this.resultBuffer,mt=this.sampleValues,bt=this.valueSize,St=_*bt;for(let Mt=0;Mt!==bt;++Mt)ut[Mt]=mt[St+Mt];return ut}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class CubicInterpolant extends Interpolant{constructor(_,ut,mt,bt){super(_,ut,mt,bt),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding}}intervalChanged_(_,ut,mt){const bt=this.parameterPositions;let St=_-2,Mt=_+1,Bt=bt[St],Ut=bt[Mt];if(Bt===void 0)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:St=_,Bt=2*ut-mt;break;case WrapAroundEnding:St=bt.length-2,Bt=ut+bt[St]-bt[St+1];break;default:St=_,Bt=mt}if(Ut===void 0)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:Mt=_,Ut=2*mt-ut;break;case WrapAroundEnding:Mt=1,Ut=mt+bt[1]-bt[0];break;default:Mt=_-1,Ut=ut}const Ht=(mt-ut)*.5,tr=this.valueSize;this._weightPrev=Ht/(ut-Bt),this._weightNext=Ht/(Ut-mt),this._offsetPrev=St*tr,this._offsetNext=Mt*tr}interpolate_(_,ut,mt,bt){const St=this.resultBuffer,Mt=this.sampleValues,Bt=this.valueSize,Ut=_*Bt,Ht=Ut-Bt,tr=this._offsetPrev,rr=this._offsetNext,sr=this._weightPrev,ar=this._weightNext,cr=(mt-ut)/(bt-ut),Ar=cr*cr,_r=Ar*cr,Dr=-sr*_r+2*sr*Ar-sr*cr,$r=(1+sr)*_r+(-1.5-2*sr)*Ar+(-.5+sr)*cr+1,Br=(-1-ar)*_r+(1.5+ar)*Ar+.5*cr,Jr=ar*_r-ar*Ar;for(let mn=0;mn!==Bt;++mn)St[mn]=Dr*Mt[tr+mn]+$r*Mt[Ht+mn]+Br*Mt[Ut+mn]+Jr*Mt[rr+mn];return St}}class LinearInterpolant extends Interpolant{constructor(_,ut,mt,bt){super(_,ut,mt,bt)}interpolate_(_,ut,mt,bt){const St=this.resultBuffer,Mt=this.sampleValues,Bt=this.valueSize,Ut=_*Bt,Ht=Ut-Bt,tr=(mt-ut)/(bt-ut),rr=1-tr;for(let sr=0;sr!==Bt;++sr)St[sr]=Mt[Ht+sr]*rr+Mt[Ut+sr]*tr;return St}}class DiscreteInterpolant extends Interpolant{constructor(_,ut,mt,bt){super(_,ut,mt,bt)}interpolate_(_){return this.copySampleValue_(_-1)}}class KeyframeTrack{constructor(_,ut,mt,bt){if(_===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(ut===void 0||ut.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+_);this.name=_,this.times=convertArray(ut,this.TimeBufferType),this.values=convertArray(mt,this.ValueBufferType),this.setInterpolation(bt||this.DefaultInterpolation)}static toJSON(_){const ut=_.constructor;let mt;if(ut.toJSON!==this.toJSON)mt=ut.toJSON(_);else{mt={name:_.name,times:convertArray(_.times,Array),values:convertArray(_.values,Array)};const bt=_.getInterpolation();bt!==_.DefaultInterpolation&&(mt.interpolation=bt)}return mt.type=_.ValueTypeName,mt}InterpolantFactoryMethodDiscrete(_){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodLinear(_){return new LinearInterpolant(this.times,this.values,this.getValueSize(),_)}InterpolantFactoryMethodSmooth(_){return new CubicInterpolant(this.times,this.values,this.getValueSize(),_)}setInterpolation(_){let ut;switch(_){case InterpolateDiscrete:ut=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:ut=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:ut=this.InterpolantFactoryMethodSmooth;break}if(ut===void 0){const mt="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(_!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(mt);return console.warn("THREE.KeyframeTrack:",mt),this}return this.createInterpolant=ut,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}}getValueSize(){return this.values.length/this.times.length}shift(_){if(_!==0){const ut=this.times;for(let mt=0,bt=ut.length;mt!==bt;++mt)ut[mt]+=_}return this}scale(_){if(_!==1){const ut=this.times;for(let mt=0,bt=ut.length;mt!==bt;++mt)ut[mt]*=_}return this}trim(_,ut){const mt=this.times,bt=mt.length;let St=0,Mt=bt-1;for(;St!==bt&&mt[St]<_;)++St;for(;Mt!==-1&&mt[Mt]>ut;)--Mt;if(++Mt,St!==0||Mt!==bt){St>=Mt&&(Mt=Math.max(Mt,1),St=Mt-1);const Bt=this.getValueSize();this.times=arraySlice(mt,St,Mt),this.values=arraySlice(this.values,St*Bt,Mt*Bt)}return this}validate(){let _=!0;const ut=this.getValueSize();ut-Math.floor(ut)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),_=!1);const mt=this.times,bt=this.values,St=mt.length;St===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),_=!1);let Mt=null;for(let Bt=0;Bt!==St;Bt++){const Ut=mt[Bt];if(typeof Ut=="number"&&isNaN(Ut)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,Bt,Ut),_=!1;break}if(Mt!==null&&Mt>Ut){console.error("THREE.KeyframeTrack: Out of order keys.",this,Bt,Ut,Mt),_=!1;break}Mt=Ut}if(bt!==void 0&&isTypedArray$1(bt))for(let Bt=0,Ut=bt.length;Bt!==Ut;++Bt){const Ht=bt[Bt];if(isNaN(Ht)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,Bt,Ht),_=!1;break}}return _}optimize(){const _=arraySlice(this.times),ut=arraySlice(this.values),mt=this.getValueSize(),bt=this.getInterpolation()===InterpolateSmooth,St=_.length-1;let Mt=1;for(let Bt=1;Bt<St;++Bt){let Ut=!1;const Ht=_[Bt],tr=_[Bt+1];if(Ht!==tr&&(Bt!==1||Ht!==_[0]))if(bt)Ut=!0;else{const rr=Bt*mt,sr=rr-mt,ar=rr+mt;for(let cr=0;cr!==mt;++cr){const Ar=ut[rr+cr];if(Ar!==ut[sr+cr]||Ar!==ut[ar+cr]){Ut=!0;break}}}if(Ut){if(Bt!==Mt){_[Mt]=_[Bt];const rr=Bt*mt,sr=Mt*mt;for(let ar=0;ar!==mt;++ar)ut[sr+ar]=ut[rr+ar]}++Mt}}if(St>0){_[Mt]=_[St];for(let Bt=St*mt,Ut=Mt*mt,Ht=0;Ht!==mt;++Ht)ut[Ut+Ht]=ut[Bt+Ht];++Mt}return Mt!==_.length?(this.times=arraySlice(_,0,Mt),this.values=arraySlice(ut,0,Mt*mt)):(this.times=_,this.values=ut),this}clone(){const _=arraySlice(this.times,0),ut=arraySlice(this.values,0),mt=this.constructor,bt=new mt(this.name,_,ut);return bt.createInterpolant=this.createInterpolant,bt}}KeyframeTrack.prototype.TimeBufferType=Float32Array;KeyframeTrack.prototype.ValueBufferType=Float32Array;KeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;class BooleanKeyframeTrack extends KeyframeTrack{}BooleanKeyframeTrack.prototype.ValueTypeName="bool";BooleanKeyframeTrack.prototype.ValueBufferType=Array;BooleanKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(_,ut,mt,bt){super(_,ut,mt,bt)}interpolate_(_,ut,mt,bt){const St=this.resultBuffer,Mt=this.sampleValues,Bt=this.valueSize,Ut=(mt-ut)/(bt-ut);let Ht=_*Bt;for(let tr=Ht+Bt;Ht!==tr;Ht+=4)Quaternion.slerpFlat(St,0,Mt,Ht-Bt,Mt,Ht,Ut);return St}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(_){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),_)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion";QuaternionKeyframeTrack.prototype.DefaultInterpolation=InterpolateLinear;QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{}StringKeyframeTrack.prototype.ValueTypeName="string";StringKeyframeTrack.prototype.ValueBufferType=Array;StringKeyframeTrack.prototype.DefaultInterpolation=InterpolateDiscrete;StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0;StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(_,ut=-1,mt,bt=NormalAnimationBlendMode){this.name=_,this.tracks=mt,this.duration=ut,this.blendMode=bt,this.uuid=generateUUID$1(),this.duration<0&&this.resetDuration()}static parse(_){const ut=[],mt=_.tracks,bt=1/(_.fps||1);for(let Mt=0,Bt=mt.length;Mt!==Bt;++Mt)ut.push(parseKeyframeTrack(mt[Mt]).scale(bt));const St=new this(_.name,_.duration,ut,_.blendMode);return St.uuid=_.uuid,St}static toJSON(_){const ut=[],mt=_.tracks,bt={name:_.name,duration:_.duration,tracks:ut,uuid:_.uuid,blendMode:_.blendMode};for(let St=0,Mt=mt.length;St!==Mt;++St)ut.push(KeyframeTrack.toJSON(mt[St]));return bt}static CreateFromMorphTargetSequence(_,ut,mt,bt){const St=ut.length,Mt=[];for(let Bt=0;Bt<St;Bt++){let Ut=[],Ht=[];Ut.push((Bt+St-1)%St,Bt,(Bt+1)%St),Ht.push(0,1,0);const tr=getKeyframeOrder(Ut);Ut=sortedArray(Ut,1,tr),Ht=sortedArray(Ht,1,tr),!bt&&Ut[0]===0&&(Ut.push(St),Ht.push(Ht[0])),Mt.push(new NumberKeyframeTrack(".morphTargetInfluences["+ut[Bt].name+"]",Ut,Ht).scale(1/mt))}return new this(_,-1,Mt)}static findByName(_,ut){let mt=_;if(!Array.isArray(_)){const bt=_;mt=bt.geometry&&bt.geometry.animations||bt.animations}for(let bt=0;bt<mt.length;bt++)if(mt[bt].name===ut)return mt[bt];return null}static CreateClipsFromMorphTargetSequences(_,ut,mt){const bt={},St=/^([\w-]*?)([\d]+)$/;for(let Bt=0,Ut=_.length;Bt<Ut;Bt++){const Ht=_[Bt],tr=Ht.name.match(St);if(tr&&tr.length>1){const rr=tr[1];let sr=bt[rr];sr||(bt[rr]=sr=[]),sr.push(Ht)}}const Mt=[];for(const Bt in bt)Mt.push(this.CreateFromMorphTargetSequence(Bt,bt[Bt],ut,mt));return Mt}static parseAnimation(_,ut){if(!_)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const mt=function(rr,sr,ar,cr,Ar){if(ar.length!==0){const _r=[],Dr=[];flattenJSON(ar,_r,Dr,cr),_r.length!==0&&Ar.push(new rr(sr,_r,Dr))}},bt=[],St=_.name||"default",Mt=_.fps||30,Bt=_.blendMode;let Ut=_.length||-1;const Ht=_.hierarchy||[];for(let rr=0;rr<Ht.length;rr++){const sr=Ht[rr].keys;if(!(!sr||sr.length===0))if(sr[0].morphTargets){const ar={};let cr;for(cr=0;cr<sr.length;cr++)if(sr[cr].morphTargets)for(let Ar=0;Ar<sr[cr].morphTargets.length;Ar++)ar[sr[cr].morphTargets[Ar]]=-1;for(const Ar in ar){const _r=[],Dr=[];for(let $r=0;$r!==sr[cr].morphTargets.length;++$r){const Br=sr[cr];_r.push(Br.time),Dr.push(Br.morphTarget===Ar?1:0)}bt.push(new NumberKeyframeTrack(".morphTargetInfluence["+Ar+"]",_r,Dr))}Ut=ar.length*Mt}else{const ar=".bones["+ut[rr].name+"]";mt(VectorKeyframeTrack,ar+".position",sr,"pos",bt),mt(QuaternionKeyframeTrack,ar+".quaternion",sr,"rot",bt),mt(VectorKeyframeTrack,ar+".scale",sr,"scl",bt)}}return bt.length===0?null:new this(St,Ut,bt,Bt)}resetDuration(){const _=this.tracks;let ut=0;for(let mt=0,bt=_.length;mt!==bt;++mt){const St=this.tracks[mt];ut=Math.max(ut,St.times[St.times.length-1])}return this.duration=ut,this}trim(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].trim(0,this.duration);return this}validate(){let _=!0;for(let ut=0;ut<this.tracks.length;ut++)_=_&&this.tracks[ut].validate();return _}optimize(){for(let _=0;_<this.tracks.length;_++)this.tracks[_].optimize();return this}clone(){const _=[];for(let ut=0;ut<this.tracks.length;ut++)_.push(this.tracks[ut].clone());return new this.constructor(this.name,this.duration,_,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function getTrackTypeForValueTypeName(rt){switch(rt.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+rt)}function parseKeyframeTrack(rt){if(rt.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const _=getTrackTypeForValueTypeName(rt.type);if(rt.times===void 0){const ut=[],mt=[];flattenJSON(rt.keys,ut,mt,"value"),rt.times=ut,rt.values=mt}return _.parse!==void 0?_.parse(rt):new _(rt.name,rt.times,rt.values,rt.interpolation)}const Cache={enabled:!1,files:{},add:function(rt,_){this.enabled!==!1&&(this.files[rt]=_)},get:function(rt){if(this.enabled!==!1)return this.files[rt]},remove:function(rt){delete this.files[rt]},clear:function(){this.files={}}};class LoadingManager{constructor(_,ut,mt){const bt=this;let St=!1,Mt=0,Bt=0,Ut;const Ht=[];this.onStart=void 0,this.onLoad=_,this.onProgress=ut,this.onError=mt,this.itemStart=function(tr){Bt++,St===!1&&bt.onStart!==void 0&&bt.onStart(tr,Mt,Bt),St=!0},this.itemEnd=function(tr){Mt++,bt.onProgress!==void 0&&bt.onProgress(tr,Mt,Bt),Mt===Bt&&(St=!1,bt.onLoad!==void 0&&bt.onLoad())},this.itemError=function(tr){bt.onError!==void 0&&bt.onError(tr)},this.resolveURL=function(tr){return Ut?Ut(tr):tr},this.setURLModifier=function(tr){return Ut=tr,this},this.addHandler=function(tr,rr){return Ht.push(tr,rr),this},this.removeHandler=function(tr){const rr=Ht.indexOf(tr);return rr!==-1&&Ht.splice(rr,2),this},this.getHandler=function(tr){for(let rr=0,sr=Ht.length;rr<sr;rr+=2){const ar=Ht[rr],cr=Ht[rr+1];if(ar.global&&(ar.lastIndex=0),ar.test(tr))return cr}return null}}}const DefaultLoadingManager=new LoadingManager;class Loader{constructor(_){this.manager=_!==void 0?_:DefaultLoadingManager,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(_,ut){const mt=this;return new Promise(function(bt,St){mt.load(_,bt,ut,St)})}parse(){}setCrossOrigin(_){return this.crossOrigin=_,this}setWithCredentials(_){return this.withCredentials=_,this}setPath(_){return this.path=_,this}setResourcePath(_){return this.resourcePath=_,this}setRequestHeader(_){return this.requestHeader=_,this}}const loading={};class HttpError extends Error{constructor(_,ut){super(_),this.response=ut}}class FileLoader extends Loader{constructor(_){super(_)}load(_,ut,mt,bt){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const St=Cache.get(_);if(St!==void 0)return this.manager.itemStart(_),setTimeout(()=>{ut&&ut(St),this.manager.itemEnd(_)},0),St;if(loading[_]!==void 0){loading[_].push({onLoad:ut,onProgress:mt,onError:bt});return}loading[_]=[],loading[_].push({onLoad:ut,onProgress:mt,onError:bt});const Mt=new Request(_,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),Bt=this.mimeType,Ut=this.responseType;fetch(Mt).then(Ht=>{if(Ht.status===200||Ht.status===0){if(Ht.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||Ht.body===void 0||Ht.body.getReader===void 0)return Ht;const tr=loading[_],rr=Ht.body.getReader(),sr=Ht.headers.get("Content-Length")||Ht.headers.get("X-File-Size"),ar=sr?parseInt(sr):0,cr=ar!==0;let Ar=0;const _r=new ReadableStream({start(Dr){$r();function $r(){rr.read().then(({done:Br,value:Jr})=>{if(Br)Dr.close();else{Ar+=Jr.byteLength;const mn=new ProgressEvent("progress",{lengthComputable:cr,loaded:Ar,total:ar});for(let Mn=0,$n=tr.length;Mn<$n;Mn++){const en=tr[Mn];en.onProgress&&en.onProgress(mn)}Dr.enqueue(Jr),$r()}})}}});return new Response(_r)}else throw new HttpError(`fetch for "${Ht.url}" responded with ${Ht.status}: ${Ht.statusText}`,Ht)}).then(Ht=>{switch(Ut){case"arraybuffer":return Ht.arrayBuffer();case"blob":return Ht.blob();case"document":return Ht.text().then(tr=>new DOMParser().parseFromString(tr,Bt));case"json":return Ht.json();default:if(Bt===void 0)return Ht.text();{const rr=/charset="?([^;"\s]*)"?/i.exec(Bt),sr=rr&&rr[1]?rr[1].toLowerCase():void 0,ar=new TextDecoder(sr);return Ht.arrayBuffer().then(cr=>ar.decode(cr))}}}).then(Ht=>{Cache.add(_,Ht);const tr=loading[_];delete loading[_];for(let rr=0,sr=tr.length;rr<sr;rr++){const ar=tr[rr];ar.onLoad&&ar.onLoad(Ht)}}).catch(Ht=>{const tr=loading[_];if(tr===void 0)throw this.manager.itemError(_),Ht;delete loading[_];for(let rr=0,sr=tr.length;rr<sr;rr++){const ar=tr[rr];ar.onError&&ar.onError(Ht)}this.manager.itemError(_)}).finally(()=>{this.manager.itemEnd(_)}),this.manager.itemStart(_)}setResponseType(_){return this.responseType=_,this}setMimeType(_){return this.mimeType=_,this}}class AnimationLoader extends Loader{constructor(_){super(_)}load(_,ut,mt,bt){const St=this,Mt=new FileLoader(this.manager);Mt.setPath(this.path),Mt.setRequestHeader(this.requestHeader),Mt.setWithCredentials(this.withCredentials),Mt.load(_,function(Bt){try{ut(St.parse(JSON.parse(Bt)))}catch(Ut){bt?bt(Ut):console.error(Ut),St.manager.itemError(_)}},mt,bt)}parse(_){const ut=[];for(let mt=0;mt<_.length;mt++){const bt=AnimationClip.parse(_[mt]);ut.push(bt)}return ut}}class CompressedTextureLoader extends Loader{constructor(_){super(_)}load(_,ut,mt,bt){const St=this,Mt=[],Bt=new CompressedTexture,Ut=new FileLoader(this.manager);Ut.setPath(this.path),Ut.setResponseType("arraybuffer"),Ut.setRequestHeader(this.requestHeader),Ut.setWithCredentials(St.withCredentials);let Ht=0;function tr(rr){Ut.load(_[rr],function(sr){const ar=St.parse(sr,!0);Mt[rr]={width:ar.width,height:ar.height,format:ar.format,mipmaps:ar.mipmaps},Ht+=1,Ht===6&&(ar.mipmapCount===1&&(Bt.minFilter=LinearFilter),Bt.image=Mt,Bt.format=ar.format,Bt.needsUpdate=!0,ut&&ut(Bt))},mt,bt)}if(Array.isArray(_))for(let rr=0,sr=_.length;rr<sr;++rr)tr(rr);else Ut.load(_,function(rr){const sr=St.parse(rr,!0);if(sr.isCubemap){const ar=sr.mipmaps.length/sr.mipmapCount;for(let cr=0;cr<ar;cr++){Mt[cr]={mipmaps:[]};for(let Ar=0;Ar<sr.mipmapCount;Ar++)Mt[cr].mipmaps.push(sr.mipmaps[cr*sr.mipmapCount+Ar]),Mt[cr].format=sr.format,Mt[cr].width=sr.width,Mt[cr].height=sr.height}Bt.image=Mt}else Bt.image.width=sr.width,Bt.image.height=sr.height,Bt.mipmaps=sr.mipmaps;sr.mipmapCount===1&&(Bt.minFilter=LinearFilter),Bt.format=sr.format,Bt.needsUpdate=!0,ut&&ut(Bt)},mt,bt);return Bt}}class ImageLoader extends Loader{constructor(_){super(_)}load(_,ut,mt,bt){this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const St=this,Mt=Cache.get(_);if(Mt!==void 0)return St.manager.itemStart(_),setTimeout(function(){ut&&ut(Mt),St.manager.itemEnd(_)},0),Mt;const Bt=createElementNS("img");function Ut(){tr(),Cache.add(_,this),ut&&ut(this),St.manager.itemEnd(_)}function Ht(rr){tr(),bt&&bt(rr),St.manager.itemError(_),St.manager.itemEnd(_)}function tr(){Bt.removeEventListener("load",Ut,!1),Bt.removeEventListener("error",Ht,!1)}return Bt.addEventListener("load",Ut,!1),Bt.addEventListener("error",Ht,!1),_.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(Bt.crossOrigin=this.crossOrigin),St.manager.itemStart(_),Bt.src=_,Bt}}class CubeTextureLoader extends Loader{constructor(_){super(_)}load(_,ut,mt,bt){const St=new CubeTexture,Mt=new ImageLoader(this.manager);Mt.setCrossOrigin(this.crossOrigin),Mt.setPath(this.path);let Bt=0;function Ut(Ht){Mt.load(_[Ht],function(tr){St.images[Ht]=tr,Bt++,Bt===6&&(St.needsUpdate=!0,ut&&ut(St))},void 0,bt)}for(let Ht=0;Ht<_.length;++Ht)Ut(Ht);return St}}class DataTextureLoader extends Loader{constructor(_){super(_)}load(_,ut,mt,bt){const St=this,Mt=new DataTexture,Bt=new FileLoader(this.manager);return Bt.setResponseType("arraybuffer"),Bt.setRequestHeader(this.requestHeader),Bt.setPath(this.path),Bt.setWithCredentials(St.withCredentials),Bt.load(_,function(Ut){const Ht=St.parse(Ut);Ht&&(Ht.image!==void 0?Mt.image=Ht.image:Ht.data!==void 0&&(Mt.image.width=Ht.width,Mt.image.height=Ht.height,Mt.image.data=Ht.data),Mt.wrapS=Ht.wrapS!==void 0?Ht.wrapS:ClampToEdgeWrapping,Mt.wrapT=Ht.wrapT!==void 0?Ht.wrapT:ClampToEdgeWrapping,Mt.magFilter=Ht.magFilter!==void 0?Ht.magFilter:LinearFilter,Mt.minFilter=Ht.minFilter!==void 0?Ht.minFilter:LinearFilter,Mt.anisotropy=Ht.anisotropy!==void 0?Ht.anisotropy:1,Ht.encoding!==void 0&&(Mt.encoding=Ht.encoding),Ht.flipY!==void 0&&(Mt.flipY=Ht.flipY),Ht.format!==void 0&&(Mt.format=Ht.format),Ht.type!==void 0&&(Mt.type=Ht.type),Ht.mipmaps!==void 0&&(Mt.mipmaps=Ht.mipmaps,Mt.minFilter=LinearMipmapLinearFilter),Ht.mipmapCount===1&&(Mt.minFilter=LinearFilter),Ht.generateMipmaps!==void 0&&(Mt.generateMipmaps=Ht.generateMipmaps),Mt.needsUpdate=!0,ut&&ut(Mt,Ht))},mt,bt),Mt}}class TextureLoader extends Loader{constructor(_){super(_)}load(_,ut,mt,bt){const St=new Texture,Mt=new ImageLoader(this.manager);return Mt.setCrossOrigin(this.crossOrigin),Mt.setPath(this.path),Mt.load(_,function(Bt){St.image=Bt,St.needsUpdate=!0,ut!==void 0&&ut(St)},mt,bt),St}}class Light extends Object3D{constructor(_,ut=1){super(),this.isLight=!0,this.type="Light",this.color=new Color$1(_),this.intensity=ut}dispose(){}copy(_,ut){return super.copy(_,ut),this.color.copy(_.color),this.intensity=_.intensity,this}toJSON(_){const ut=super.toJSON(_);return ut.object.color=this.color.getHex(),ut.object.intensity=this.intensity,this.groundColor!==void 0&&(ut.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(ut.object.distance=this.distance),this.angle!==void 0&&(ut.object.angle=this.angle),this.decay!==void 0&&(ut.object.decay=this.decay),this.penumbra!==void 0&&(ut.object.penumbra=this.penumbra),this.shadow!==void 0&&(ut.object.shadow=this.shadow.toJSON()),ut}}class HemisphereLight extends Light{constructor(_,ut,mt){super(_,mt),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Color$1(ut)}copy(_,ut){return super.copy(_,ut),this.groundColor.copy(_.groundColor),this}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(_){this.camera=_,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(_){const ut=this.camera,mt=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(_.matrixWorld),ut.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(_.target.matrixWorld),ut.lookAt(_lookTarget$1),ut.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(ut.projectionMatrix,ut.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),mt.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),mt.multiply(_projScreenMatrix$1)}getViewport(_){return this._viewports[_]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(_){return this.camera=_.camera.clone(),this.bias=_.bias,this.radius=_.radius,this.mapSize.copy(_.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const _={};return this.bias!==0&&(_.bias=this.bias),this.normalBias!==0&&(_.normalBias=this.normalBias),this.radius!==1&&(_.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(_.mapSize=this.mapSize.toArray()),_.camera=this.camera.toJSON(!1).object,delete _.camera.matrix,_}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera$1(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(_){const ut=this.camera,mt=RAD2DEG*2*_.angle*this.focus,bt=this.mapSize.width/this.mapSize.height,St=_.distance||ut.far;(mt!==ut.fov||bt!==ut.aspect||St!==ut.far)&&(ut.fov=mt,ut.aspect=bt,ut.far=St,ut.updateProjectionMatrix()),super.updateMatrices(_)}copy(_){return super.copy(_),this.focus=_.focus,this}}class SpotLight extends Light{constructor(_,ut,mt=0,bt=Math.PI/3,St=0,Mt=2){super(_,ut),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.distance=mt,this.angle=bt,this.penumbra=St,this.decay=Mt,this.map=null,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(_){this.intensity=_/Math.PI}dispose(){this.shadow.dispose()}copy(_,ut){return super.copy(_,ut),this.distance=_.distance,this.angle=_.angle,this.penumbra=_.penumbra,this.decay=_.decay,this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera$1(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(_,ut=0){const mt=this.camera,bt=this.matrix,St=_.distance||mt.far;St!==mt.far&&(mt.far=St,mt.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(_.matrixWorld),mt.position.copy(_lightPositionWorld),_lookTarget.copy(mt.position),_lookTarget.add(this._cubeDirections[ut]),mt.up.copy(this._cubeUps[ut]),mt.lookAt(_lookTarget),mt.updateMatrixWorld(),bt.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(mt.projectionMatrix,mt.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(_,ut,mt=0,bt=2){super(_,ut),this.isPointLight=!0,this.type="PointLight",this.distance=mt,this.decay=bt,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(_){this.intensity=_/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(_,ut){return super.copy(_,ut),this.distance=_.distance,this.decay=_.decay,this.shadow=_.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera$1(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(_,ut){super(_,ut),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(_){return super.copy(_),this.target=_.target.clone(),this.shadow=_.shadow.clone(),this}}class AmbientLight extends Light{constructor(_,ut){super(_,ut),this.isAmbientLight=!0,this.type="AmbientLight"}}class RectAreaLight extends Light{constructor(_,ut,mt=10,bt=10){super(_,ut),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=mt,this.height=bt}get power(){return this.intensity*this.width*this.height*Math.PI}set power(_){this.intensity=_/(this.width*this.height*Math.PI)}copy(_){return super.copy(_),this.width=_.width,this.height=_.height,this}toJSON(_){const ut=super.toJSON(_);return ut.object.width=this.width,ut.object.height=this.height,ut}}class SphericalHarmonics3{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let _=0;_<9;_++)this.coefficients.push(new Vector3)}set(_){for(let ut=0;ut<9;ut++)this.coefficients[ut].copy(_[ut]);return this}zero(){for(let _=0;_<9;_++)this.coefficients[_].set(0,0,0);return this}getAt(_,ut){const mt=_.x,bt=_.y,St=_.z,Mt=this.coefficients;return ut.copy(Mt[0]).multiplyScalar(.282095),ut.addScaledVector(Mt[1],.488603*bt),ut.addScaledVector(Mt[2],.488603*St),ut.addScaledVector(Mt[3],.488603*mt),ut.addScaledVector(Mt[4],1.092548*(mt*bt)),ut.addScaledVector(Mt[5],1.092548*(bt*St)),ut.addScaledVector(Mt[6],.315392*(3*St*St-1)),ut.addScaledVector(Mt[7],1.092548*(mt*St)),ut.addScaledVector(Mt[8],.546274*(mt*mt-bt*bt)),ut}getIrradianceAt(_,ut){const mt=_.x,bt=_.y,St=_.z,Mt=this.coefficients;return ut.copy(Mt[0]).multiplyScalar(.886227),ut.addScaledVector(Mt[1],2*.511664*bt),ut.addScaledVector(Mt[2],2*.511664*St),ut.addScaledVector(Mt[3],2*.511664*mt),ut.addScaledVector(Mt[4],2*.429043*mt*bt),ut.addScaledVector(Mt[5],2*.429043*bt*St),ut.addScaledVector(Mt[6],.743125*St*St-.247708),ut.addScaledVector(Mt[7],2*.429043*mt*St),ut.addScaledVector(Mt[8],.429043*(mt*mt-bt*bt)),ut}add(_){for(let ut=0;ut<9;ut++)this.coefficients[ut].add(_.coefficients[ut]);return this}addScaledSH(_,ut){for(let mt=0;mt<9;mt++)this.coefficients[mt].addScaledVector(_.coefficients[mt],ut);return this}scale(_){for(let ut=0;ut<9;ut++)this.coefficients[ut].multiplyScalar(_);return this}lerp(_,ut){for(let mt=0;mt<9;mt++)this.coefficients[mt].lerp(_.coefficients[mt],ut);return this}equals(_){for(let ut=0;ut<9;ut++)if(!this.coefficients[ut].equals(_.coefficients[ut]))return!1;return!0}copy(_){return this.set(_.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(_,ut=0){const mt=this.coefficients;for(let bt=0;bt<9;bt++)mt[bt].fromArray(_,ut+bt*3);return this}toArray(_=[],ut=0){const mt=this.coefficients;for(let bt=0;bt<9;bt++)mt[bt].toArray(_,ut+bt*3);return _}static getBasisAt(_,ut){const mt=_.x,bt=_.y,St=_.z;ut[0]=.282095,ut[1]=.488603*bt,ut[2]=.488603*St,ut[3]=.488603*mt,ut[4]=1.092548*mt*bt,ut[5]=1.092548*bt*St,ut[6]=.315392*(3*St*St-1),ut[7]=1.092548*mt*St,ut[8]=.546274*(mt*mt-bt*bt)}}class LightProbe extends Light{constructor(_=new SphericalHarmonics3,ut=1){super(void 0,ut),this.isLightProbe=!0,this.sh=_}copy(_){return super.copy(_),this.sh.copy(_.sh),this}fromJSON(_){return this.intensity=_.intensity,this.sh.fromArray(_.sh),this}toJSON(_){const ut=super.toJSON(_);return ut.object.sh=this.sh.toArray(),ut}}class MaterialLoader extends Loader{constructor(_){super(_),this.textures={}}load(_,ut,mt,bt){const St=this,Mt=new FileLoader(St.manager);Mt.setPath(St.path),Mt.setRequestHeader(St.requestHeader),Mt.setWithCredentials(St.withCredentials),Mt.load(_,function(Bt){try{ut(St.parse(JSON.parse(Bt)))}catch(Ut){bt?bt(Ut):console.error(Ut),St.manager.itemError(_)}},mt,bt)}parse(_){const ut=this.textures;function mt(St){return ut[St]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",St),ut[St]}const bt=MaterialLoader.createMaterialFromType(_.type);if(_.uuid!==void 0&&(bt.uuid=_.uuid),_.name!==void 0&&(bt.name=_.name),_.color!==void 0&&bt.color!==void 0&&bt.color.setHex(_.color),_.roughness!==void 0&&(bt.roughness=_.roughness),_.metalness!==void 0&&(bt.metalness=_.metalness),_.sheen!==void 0&&(bt.sheen=_.sheen),_.sheenColor!==void 0&&(bt.sheenColor=new Color$1().setHex(_.sheenColor)),_.sheenRoughness!==void 0&&(bt.sheenRoughness=_.sheenRoughness),_.emissive!==void 0&&bt.emissive!==void 0&&bt.emissive.setHex(_.emissive),_.specular!==void 0&&bt.specular!==void 0&&bt.specular.setHex(_.specular),_.specularIntensity!==void 0&&(bt.specularIntensity=_.specularIntensity),_.specularColor!==void 0&&bt.specularColor!==void 0&&bt.specularColor.setHex(_.specularColor),_.shininess!==void 0&&(bt.shininess=_.shininess),_.clearcoat!==void 0&&(bt.clearcoat=_.clearcoat),_.clearcoatRoughness!==void 0&&(bt.clearcoatRoughness=_.clearcoatRoughness),_.iridescence!==void 0&&(bt.iridescence=_.iridescence),_.iridescenceIOR!==void 0&&(bt.iridescenceIOR=_.iridescenceIOR),_.iridescenceThicknessRange!==void 0&&(bt.iridescenceThicknessRange=_.iridescenceThicknessRange),_.transmission!==void 0&&(bt.transmission=_.transmission),_.thickness!==void 0&&(bt.thickness=_.thickness),_.attenuationDistance!==void 0&&(bt.attenuationDistance=_.attenuationDistance),_.attenuationColor!==void 0&&bt.attenuationColor!==void 0&&bt.attenuationColor.setHex(_.attenuationColor),_.fog!==void 0&&(bt.fog=_.fog),_.flatShading!==void 0&&(bt.flatShading=_.flatShading),_.blending!==void 0&&(bt.blending=_.blending),_.combine!==void 0&&(bt.combine=_.combine),_.side!==void 0&&(bt.side=_.side),_.shadowSide!==void 0&&(bt.shadowSide=_.shadowSide),_.opacity!==void 0&&(bt.opacity=_.opacity),_.transparent!==void 0&&(bt.transparent=_.transparent),_.alphaTest!==void 0&&(bt.alphaTest=_.alphaTest),_.depthTest!==void 0&&(bt.depthTest=_.depthTest),_.depthWrite!==void 0&&(bt.depthWrite=_.depthWrite),_.colorWrite!==void 0&&(bt.colorWrite=_.colorWrite),_.stencilWrite!==void 0&&(bt.stencilWrite=_.stencilWrite),_.stencilWriteMask!==void 0&&(bt.stencilWriteMask=_.stencilWriteMask),_.stencilFunc!==void 0&&(bt.stencilFunc=_.stencilFunc),_.stencilRef!==void 0&&(bt.stencilRef=_.stencilRef),_.stencilFuncMask!==void 0&&(bt.stencilFuncMask=_.stencilFuncMask),_.stencilFail!==void 0&&(bt.stencilFail=_.stencilFail),_.stencilZFail!==void 0&&(bt.stencilZFail=_.stencilZFail),_.stencilZPass!==void 0&&(bt.stencilZPass=_.stencilZPass),_.wireframe!==void 0&&(bt.wireframe=_.wireframe),_.wireframeLinewidth!==void 0&&(bt.wireframeLinewidth=_.wireframeLinewidth),_.wireframeLinecap!==void 0&&(bt.wireframeLinecap=_.wireframeLinecap),_.wireframeLinejoin!==void 0&&(bt.wireframeLinejoin=_.wireframeLinejoin),_.rotation!==void 0&&(bt.rotation=_.rotation),_.linewidth!==1&&(bt.linewidth=_.linewidth),_.dashSize!==void 0&&(bt.dashSize=_.dashSize),_.gapSize!==void 0&&(bt.gapSize=_.gapSize),_.scale!==void 0&&(bt.scale=_.scale),_.polygonOffset!==void 0&&(bt.polygonOffset=_.polygonOffset),_.polygonOffsetFactor!==void 0&&(bt.polygonOffsetFactor=_.polygonOffsetFactor),_.polygonOffsetUnits!==void 0&&(bt.polygonOffsetUnits=_.polygonOffsetUnits),_.dithering!==void 0&&(bt.dithering=_.dithering),_.alphaToCoverage!==void 0&&(bt.alphaToCoverage=_.alphaToCoverage),_.premultipliedAlpha!==void 0&&(bt.premultipliedAlpha=_.premultipliedAlpha),_.forceSinglePass!==void 0&&(bt.forceSinglePass=_.forceSinglePass),_.visible!==void 0&&(bt.visible=_.visible),_.toneMapped!==void 0&&(bt.toneMapped=_.toneMapped),_.userData!==void 0&&(bt.userData=_.userData),_.vertexColors!==void 0&&(typeof _.vertexColors=="number"?bt.vertexColors=_.vertexColors>0:bt.vertexColors=_.vertexColors),_.uniforms!==void 0)for(const St in _.uniforms){const Mt=_.uniforms[St];switch(bt.uniforms[St]={},Mt.type){case"t":bt.uniforms[St].value=mt(Mt.value);break;case"c":bt.uniforms[St].value=new Color$1().setHex(Mt.value);break;case"v2":bt.uniforms[St].value=new Vector2().fromArray(Mt.value);break;case"v3":bt.uniforms[St].value=new Vector3().fromArray(Mt.value);break;case"v4":bt.uniforms[St].value=new Vector4().fromArray(Mt.value);break;case"m3":bt.uniforms[St].value=new Matrix3().fromArray(Mt.value);break;case"m4":bt.uniforms[St].value=new Matrix4().fromArray(Mt.value);break;default:bt.uniforms[St].value=Mt.value}}if(_.defines!==void 0&&(bt.defines=_.defines),_.vertexShader!==void 0&&(bt.vertexShader=_.vertexShader),_.fragmentShader!==void 0&&(bt.fragmentShader=_.fragmentShader),_.glslVersion!==void 0&&(bt.glslVersion=_.glslVersion),_.extensions!==void 0)for(const St in _.extensions)bt.extensions[St]=_.extensions[St];if(_.size!==void 0&&(bt.size=_.size),_.sizeAttenuation!==void 0&&(bt.sizeAttenuation=_.sizeAttenuation),_.map!==void 0&&(bt.map=mt(_.map)),_.matcap!==void 0&&(bt.matcap=mt(_.matcap)),_.alphaMap!==void 0&&(bt.alphaMap=mt(_.alphaMap)),_.bumpMap!==void 0&&(bt.bumpMap=mt(_.bumpMap)),_.bumpScale!==void 0&&(bt.bumpScale=_.bumpScale),_.normalMap!==void 0&&(bt.normalMap=mt(_.normalMap)),_.normalMapType!==void 0&&(bt.normalMapType=_.normalMapType),_.normalScale!==void 0){let St=_.normalScale;Array.isArray(St)===!1&&(St=[St,St]),bt.normalScale=new Vector2().fromArray(St)}return _.displacementMap!==void 0&&(bt.displacementMap=mt(_.displacementMap)),_.displacementScale!==void 0&&(bt.displacementScale=_.displacementScale),_.displacementBias!==void 0&&(bt.displacementBias=_.displacementBias),_.roughnessMap!==void 0&&(bt.roughnessMap=mt(_.roughnessMap)),_.metalnessMap!==void 0&&(bt.metalnessMap=mt(_.metalnessMap)),_.emissiveMap!==void 0&&(bt.emissiveMap=mt(_.emissiveMap)),_.emissiveIntensity!==void 0&&(bt.emissiveIntensity=_.emissiveIntensity),_.specularMap!==void 0&&(bt.specularMap=mt(_.specularMap)),_.specularIntensityMap!==void 0&&(bt.specularIntensityMap=mt(_.specularIntensityMap)),_.specularColorMap!==void 0&&(bt.specularColorMap=mt(_.specularColorMap)),_.envMap!==void 0&&(bt.envMap=mt(_.envMap)),_.envMapIntensity!==void 0&&(bt.envMapIntensity=_.envMapIntensity),_.reflectivity!==void 0&&(bt.reflectivity=_.reflectivity),_.refractionRatio!==void 0&&(bt.refractionRatio=_.refractionRatio),_.lightMap!==void 0&&(bt.lightMap=mt(_.lightMap)),_.lightMapIntensity!==void 0&&(bt.lightMapIntensity=_.lightMapIntensity),_.aoMap!==void 0&&(bt.aoMap=mt(_.aoMap)),_.aoMapIntensity!==void 0&&(bt.aoMapIntensity=_.aoMapIntensity),_.gradientMap!==void 0&&(bt.gradientMap=mt(_.gradientMap)),_.clearcoatMap!==void 0&&(bt.clearcoatMap=mt(_.clearcoatMap)),_.clearcoatRoughnessMap!==void 0&&(bt.clearcoatRoughnessMap=mt(_.clearcoatRoughnessMap)),_.clearcoatNormalMap!==void 0&&(bt.clearcoatNormalMap=mt(_.clearcoatNormalMap)),_.clearcoatNormalScale!==void 0&&(bt.clearcoatNormalScale=new Vector2().fromArray(_.clearcoatNormalScale)),_.iridescenceMap!==void 0&&(bt.iridescenceMap=mt(_.iridescenceMap)),_.iridescenceThicknessMap!==void 0&&(bt.iridescenceThicknessMap=mt(_.iridescenceThicknessMap)),_.transmissionMap!==void 0&&(bt.transmissionMap=mt(_.transmissionMap)),_.thicknessMap!==void 0&&(bt.thicknessMap=mt(_.thicknessMap)),_.sheenColorMap!==void 0&&(bt.sheenColorMap=mt(_.sheenColorMap)),_.sheenRoughnessMap!==void 0&&(bt.sheenRoughnessMap=mt(_.sheenRoughnessMap)),bt}setTextures(_){return this.textures=_,this}static createMaterialFromType(_){const ut={ShadowMaterial,SpriteMaterial,RawShaderMaterial,ShaderMaterial,PointsMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshPhongMaterial,MeshToonMaterial,MeshNormalMaterial,MeshLambertMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshBasicMaterial,MeshMatcapMaterial,LineDashedMaterial,LineBasicMaterial,Material};return new ut[_]}}class LoaderUtils{static decodeText(_){if(typeof TextDecoder<"u")return new TextDecoder().decode(_);let ut="";for(let mt=0,bt=_.length;mt<bt;mt++)ut+=String.fromCharCode(_[mt]);try{return decodeURIComponent(escape(ut))}catch{return ut}}static extractUrlBase(_){const ut=_.lastIndexOf("/");return ut===-1?"./":_.slice(0,ut+1)}static resolveURL(_,ut){return typeof _!="string"||_===""?"":(/^https?:\/\//i.test(ut)&&/^\//.test(_)&&(ut=ut.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(_)||/^data:.*,.*$/i.test(_)||/^blob:.*$/i.test(_)?_:ut+_)}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(_){return super.copy(_),this.instanceCount=_.instanceCount,this}toJSON(){const _=super.toJSON();return _.instanceCount=this.instanceCount,_.isInstancedBufferGeometry=!0,_}}class BufferGeometryLoader extends Loader{constructor(_){super(_)}load(_,ut,mt,bt){const St=this,Mt=new FileLoader(St.manager);Mt.setPath(St.path),Mt.setRequestHeader(St.requestHeader),Mt.setWithCredentials(St.withCredentials),Mt.load(_,function(Bt){try{ut(St.parse(JSON.parse(Bt)))}catch(Ut){bt?bt(Ut):console.error(Ut),St.manager.itemError(_)}},mt,bt)}parse(_){const ut={},mt={};function bt(ar,cr){if(ut[cr]!==void 0)return ut[cr];const _r=ar.interleavedBuffers[cr],Dr=St(ar,_r.buffer),$r=getTypedArray(_r.type,Dr),Br=new InterleavedBuffer($r,_r.stride);return Br.uuid=_r.uuid,ut[cr]=Br,Br}function St(ar,cr){if(mt[cr]!==void 0)return mt[cr];const _r=ar.arrayBuffers[cr],Dr=new Uint32Array(_r).buffer;return mt[cr]=Dr,Dr}const Mt=_.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,Bt=_.data.index;if(Bt!==void 0){const ar=getTypedArray(Bt.type,Bt.array);Mt.setIndex(new BufferAttribute(ar,1))}const Ut=_.data.attributes;for(const ar in Ut){const cr=Ut[ar];let Ar;if(cr.isInterleavedBufferAttribute){const _r=bt(_.data,cr.data);Ar=new InterleavedBufferAttribute(_r,cr.itemSize,cr.offset,cr.normalized)}else{const _r=getTypedArray(cr.type,cr.array),Dr=cr.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute;Ar=new Dr(_r,cr.itemSize,cr.normalized)}cr.name!==void 0&&(Ar.name=cr.name),cr.usage!==void 0&&Ar.setUsage(cr.usage),cr.updateRange!==void 0&&(Ar.updateRange.offset=cr.updateRange.offset,Ar.updateRange.count=cr.updateRange.count),Mt.setAttribute(ar,Ar)}const Ht=_.data.morphAttributes;if(Ht)for(const ar in Ht){const cr=Ht[ar],Ar=[];for(let _r=0,Dr=cr.length;_r<Dr;_r++){const $r=cr[_r];let Br;if($r.isInterleavedBufferAttribute){const Jr=bt(_.data,$r.data);Br=new InterleavedBufferAttribute(Jr,$r.itemSize,$r.offset,$r.normalized)}else{const Jr=getTypedArray($r.type,$r.array);Br=new BufferAttribute(Jr,$r.itemSize,$r.normalized)}$r.name!==void 0&&(Br.name=$r.name),Ar.push(Br)}Mt.morphAttributes[ar]=Ar}_.data.morphTargetsRelative&&(Mt.morphTargetsRelative=!0);const rr=_.data.groups||_.data.drawcalls||_.data.offsets;if(rr!==void 0)for(let ar=0,cr=rr.length;ar!==cr;++ar){const Ar=rr[ar];Mt.addGroup(Ar.start,Ar.count,Ar.materialIndex)}const sr=_.data.boundingSphere;if(sr!==void 0){const ar=new Vector3;sr.center!==void 0&&ar.fromArray(sr.center),Mt.boundingSphere=new Sphere$1(ar,sr.radius)}return _.name&&(Mt.name=_.name),_.userData&&(Mt.userData=_.userData),Mt}}class ObjectLoader extends Loader{constructor(_){super(_)}load(_,ut,mt,bt){const St=this,Mt=this.path===""?LoaderUtils.extractUrlBase(_):this.path;this.resourcePath=this.resourcePath||Mt;const Bt=new FileLoader(this.manager);Bt.setPath(this.path),Bt.setRequestHeader(this.requestHeader),Bt.setWithCredentials(this.withCredentials),Bt.load(_,function(Ut){let Ht=null;try{Ht=JSON.parse(Ut)}catch(rr){bt!==void 0&&bt(rr),console.error("THREE:ObjectLoader: Can't parse "+_+".",rr.message);return}const tr=Ht.metadata;if(tr===void 0||tr.type===void 0||tr.type.toLowerCase()==="geometry"){bt!==void 0&&bt(new Error("THREE.ObjectLoader: Can't load "+_)),console.error("THREE.ObjectLoader: Can't load "+_);return}St.parse(Ht,ut)},mt,bt)}async loadAsync(_,ut){const mt=this,bt=this.path===""?LoaderUtils.extractUrlBase(_):this.path;this.resourcePath=this.resourcePath||bt;const St=new FileLoader(this.manager);St.setPath(this.path),St.setRequestHeader(this.requestHeader),St.setWithCredentials(this.withCredentials);const Mt=await St.loadAsync(_,ut),Bt=JSON.parse(Mt),Ut=Bt.metadata;if(Ut===void 0||Ut.type===void 0||Ut.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+_);return await mt.parseAsync(Bt)}parse(_,ut){const mt=this.parseAnimations(_.animations),bt=this.parseShapes(_.shapes),St=this.parseGeometries(_.geometries,bt),Mt=this.parseImages(_.images,function(){ut!==void 0&&ut(Ht)}),Bt=this.parseTextures(_.textures,Mt),Ut=this.parseMaterials(_.materials,Bt),Ht=this.parseObject(_.object,St,Ut,Bt,mt),tr=this.parseSkeletons(_.skeletons,Ht);if(this.bindSkeletons(Ht,tr),ut!==void 0){let rr=!1;for(const sr in Mt)if(Mt[sr].data instanceof HTMLImageElement){rr=!0;break}rr===!1&&ut(Ht)}return Ht}async parseAsync(_){const ut=this.parseAnimations(_.animations),mt=this.parseShapes(_.shapes),bt=this.parseGeometries(_.geometries,mt),St=await this.parseImagesAsync(_.images),Mt=this.parseTextures(_.textures,St),Bt=this.parseMaterials(_.materials,Mt),Ut=this.parseObject(_.object,bt,Bt,Mt,ut),Ht=this.parseSkeletons(_.skeletons,Ut);return this.bindSkeletons(Ut,Ht),Ut}parseShapes(_){const ut={};if(_!==void 0)for(let mt=0,bt=_.length;mt<bt;mt++){const St=new Shape().fromJSON(_[mt]);ut[St.uuid]=St}return ut}parseSkeletons(_,ut){const mt={},bt={};if(ut.traverse(function(St){St.isBone&&(bt[St.uuid]=St)}),_!==void 0)for(let St=0,Mt=_.length;St<Mt;St++){const Bt=new Skeleton().fromJSON(_[St],bt);mt[Bt.uuid]=Bt}return mt}parseGeometries(_,ut){const mt={};if(_!==void 0){const bt=new BufferGeometryLoader;for(let St=0,Mt=_.length;St<Mt;St++){let Bt;const Ut=_[St];switch(Ut.type){case"BufferGeometry":case"InstancedBufferGeometry":Bt=bt.parse(Ut);break;default:Ut.type in Geometries?Bt=Geometries[Ut.type].fromJSON(Ut,ut):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${Ut.type}"`)}Bt.uuid=Ut.uuid,Ut.name!==void 0&&(Bt.name=Ut.name),Ut.userData!==void 0&&(Bt.userData=Ut.userData),mt[Ut.uuid]=Bt}}return mt}parseMaterials(_,ut){const mt={},bt={};if(_!==void 0){const St=new MaterialLoader;St.setTextures(ut);for(let Mt=0,Bt=_.length;Mt<Bt;Mt++){const Ut=_[Mt];mt[Ut.uuid]===void 0&&(mt[Ut.uuid]=St.parse(Ut)),bt[Ut.uuid]=mt[Ut.uuid]}}return bt}parseAnimations(_){const ut={};if(_!==void 0)for(let mt=0;mt<_.length;mt++){const bt=_[mt],St=AnimationClip.parse(bt);ut[St.uuid]=St}return ut}parseImages(_,ut){const mt=this,bt={};let St;function Mt(Ut){return mt.manager.itemStart(Ut),St.load(Ut,function(){mt.manager.itemEnd(Ut)},void 0,function(){mt.manager.itemError(Ut),mt.manager.itemEnd(Ut)})}function Bt(Ut){if(typeof Ut=="string"){const Ht=Ut,tr=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Ht)?Ht:mt.resourcePath+Ht;return Mt(tr)}else return Ut.data?{data:getTypedArray(Ut.type,Ut.data),width:Ut.width,height:Ut.height}:null}if(_!==void 0&&_.length>0){const Ut=new LoadingManager(ut);St=new ImageLoader(Ut),St.setCrossOrigin(this.crossOrigin);for(let Ht=0,tr=_.length;Ht<tr;Ht++){const rr=_[Ht],sr=rr.url;if(Array.isArray(sr)){const ar=[];for(let cr=0,Ar=sr.length;cr<Ar;cr++){const _r=sr[cr],Dr=Bt(_r);Dr!==null&&(Dr instanceof HTMLImageElement?ar.push(Dr):ar.push(new DataTexture(Dr.data,Dr.width,Dr.height)))}bt[rr.uuid]=new Source(ar)}else{const ar=Bt(rr.url);bt[rr.uuid]=new Source(ar)}}}return bt}async parseImagesAsync(_){const ut=this,mt={};let bt;async function St(Mt){if(typeof Mt=="string"){const Bt=Mt,Ut=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Bt)?Bt:ut.resourcePath+Bt;return await bt.loadAsync(Ut)}else return Mt.data?{data:getTypedArray(Mt.type,Mt.data),width:Mt.width,height:Mt.height}:null}if(_!==void 0&&_.length>0){bt=new ImageLoader(this.manager),bt.setCrossOrigin(this.crossOrigin);for(let Mt=0,Bt=_.length;Mt<Bt;Mt++){const Ut=_[Mt],Ht=Ut.url;if(Array.isArray(Ht)){const tr=[];for(let rr=0,sr=Ht.length;rr<sr;rr++){const ar=Ht[rr],cr=await St(ar);cr!==null&&(cr instanceof HTMLImageElement?tr.push(cr):tr.push(new DataTexture(cr.data,cr.width,cr.height)))}mt[Ut.uuid]=new Source(tr)}else{const tr=await St(Ut.url);mt[Ut.uuid]=new Source(tr)}}}return mt}parseTextures(_,ut){function mt(St,Mt){return typeof St=="number"?St:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",St),Mt[St])}const bt={};if(_!==void 0)for(let St=0,Mt=_.length;St<Mt;St++){const Bt=_[St];Bt.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',Bt.uuid),ut[Bt.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",Bt.image);const Ut=ut[Bt.image],Ht=Ut.data;let tr;Array.isArray(Ht)?(tr=new CubeTexture,Ht.length===6&&(tr.needsUpdate=!0)):(Ht&&Ht.data?tr=new DataTexture:tr=new Texture,Ht&&(tr.needsUpdate=!0)),tr.source=Ut,tr.uuid=Bt.uuid,Bt.name!==void 0&&(tr.name=Bt.name),Bt.mapping!==void 0&&(tr.mapping=mt(Bt.mapping,TEXTURE_MAPPING)),Bt.offset!==void 0&&tr.offset.fromArray(Bt.offset),Bt.repeat!==void 0&&tr.repeat.fromArray(Bt.repeat),Bt.center!==void 0&&tr.center.fromArray(Bt.center),Bt.rotation!==void 0&&(tr.rotation=Bt.rotation),Bt.wrap!==void 0&&(tr.wrapS=mt(Bt.wrap[0],TEXTURE_WRAPPING),tr.wrapT=mt(Bt.wrap[1],TEXTURE_WRAPPING)),Bt.format!==void 0&&(tr.format=Bt.format),Bt.internalFormat!==void 0&&(tr.internalFormat=Bt.internalFormat),Bt.type!==void 0&&(tr.type=Bt.type),Bt.encoding!==void 0&&(tr.encoding=Bt.encoding),Bt.minFilter!==void 0&&(tr.minFilter=mt(Bt.minFilter,TEXTURE_FILTER)),Bt.magFilter!==void 0&&(tr.magFilter=mt(Bt.magFilter,TEXTURE_FILTER)),Bt.anisotropy!==void 0&&(tr.anisotropy=Bt.anisotropy),Bt.flipY!==void 0&&(tr.flipY=Bt.flipY),Bt.generateMipmaps!==void 0&&(tr.generateMipmaps=Bt.generateMipmaps),Bt.premultiplyAlpha!==void 0&&(tr.premultiplyAlpha=Bt.premultiplyAlpha),Bt.unpackAlignment!==void 0&&(tr.unpackAlignment=Bt.unpackAlignment),Bt.userData!==void 0&&(tr.userData=Bt.userData),bt[Bt.uuid]=tr}return bt}parseObject(_,ut,mt,bt,St){let Mt;function Bt(sr){return ut[sr]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",sr),ut[sr]}function Ut(sr){if(sr!==void 0){if(Array.isArray(sr)){const ar=[];for(let cr=0,Ar=sr.length;cr<Ar;cr++){const _r=sr[cr];mt[_r]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_r),ar.push(mt[_r])}return ar}return mt[sr]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",sr),mt[sr]}}function Ht(sr){return bt[sr]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",sr),bt[sr]}let tr,rr;switch(_.type){case"Scene":Mt=new Scene$3,_.background!==void 0&&(Number.isInteger(_.background)?Mt.background=new Color$1(_.background):Mt.background=Ht(_.background)),_.environment!==void 0&&(Mt.environment=Ht(_.environment)),_.fog!==void 0&&(_.fog.type==="Fog"?Mt.fog=new Fog(_.fog.color,_.fog.near,_.fog.far):_.fog.type==="FogExp2"&&(Mt.fog=new FogExp2(_.fog.color,_.fog.density))),_.backgroundBlurriness!==void 0&&(Mt.backgroundBlurriness=_.backgroundBlurriness),_.backgroundIntensity!==void 0&&(Mt.backgroundIntensity=_.backgroundIntensity);break;case"PerspectiveCamera":Mt=new PerspectiveCamera$1(_.fov,_.aspect,_.near,_.far),_.focus!==void 0&&(Mt.focus=_.focus),_.zoom!==void 0&&(Mt.zoom=_.zoom),_.filmGauge!==void 0&&(Mt.filmGauge=_.filmGauge),_.filmOffset!==void 0&&(Mt.filmOffset=_.filmOffset),_.view!==void 0&&(Mt.view=Object.assign({},_.view));break;case"OrthographicCamera":Mt=new OrthographicCamera$1(_.left,_.right,_.top,_.bottom,_.near,_.far),_.zoom!==void 0&&(Mt.zoom=_.zoom),_.view!==void 0&&(Mt.view=Object.assign({},_.view));break;case"AmbientLight":Mt=new AmbientLight(_.color,_.intensity);break;case"DirectionalLight":Mt=new DirectionalLight(_.color,_.intensity);break;case"PointLight":Mt=new PointLight(_.color,_.intensity,_.distance,_.decay);break;case"RectAreaLight":Mt=new RectAreaLight(_.color,_.intensity,_.width,_.height);break;case"SpotLight":Mt=new SpotLight(_.color,_.intensity,_.distance,_.angle,_.penumbra,_.decay);break;case"HemisphereLight":Mt=new HemisphereLight(_.color,_.groundColor,_.intensity);break;case"LightProbe":Mt=new LightProbe().fromJSON(_);break;case"SkinnedMesh":tr=Bt(_.geometry),rr=Ut(_.material),Mt=new SkinnedMesh(tr,rr),_.bindMode!==void 0&&(Mt.bindMode=_.bindMode),_.bindMatrix!==void 0&&Mt.bindMatrix.fromArray(_.bindMatrix),_.skeleton!==void 0&&(Mt.skeleton=_.skeleton);break;case"Mesh":tr=Bt(_.geometry),rr=Ut(_.material),Mt=new Mesh(tr,rr);break;case"InstancedMesh":tr=Bt(_.geometry),rr=Ut(_.material);const sr=_.count,ar=_.instanceMatrix,cr=_.instanceColor;Mt=new InstancedMesh(tr,rr,sr),Mt.instanceMatrix=new InstancedBufferAttribute(new Float32Array(ar.array),16),cr!==void 0&&(Mt.instanceColor=new InstancedBufferAttribute(new Float32Array(cr.array),cr.itemSize));break;case"LOD":Mt=new LOD;break;case"Line":Mt=new Line(Bt(_.geometry),Ut(_.material));break;case"LineLoop":Mt=new LineLoop(Bt(_.geometry),Ut(_.material));break;case"LineSegments":Mt=new LineSegments(Bt(_.geometry),Ut(_.material));break;case"PointCloud":case"Points":Mt=new Points(Bt(_.geometry),Ut(_.material));break;case"Sprite":Mt=new Sprite(Ut(_.material));break;case"Group":Mt=new Group$1;break;case"Bone":Mt=new Bone;break;default:Mt=new Object3D}if(Mt.uuid=_.uuid,_.name!==void 0&&(Mt.name=_.name),_.matrix!==void 0?(Mt.matrix.fromArray(_.matrix),_.matrixAutoUpdate!==void 0&&(Mt.matrixAutoUpdate=_.matrixAutoUpdate),Mt.matrixAutoUpdate&&Mt.matrix.decompose(Mt.position,Mt.quaternion,Mt.scale)):(_.position!==void 0&&Mt.position.fromArray(_.position),_.rotation!==void 0&&Mt.rotation.fromArray(_.rotation),_.quaternion!==void 0&&Mt.quaternion.fromArray(_.quaternion),_.scale!==void 0&&Mt.scale.fromArray(_.scale)),_.castShadow!==void 0&&(Mt.castShadow=_.castShadow),_.receiveShadow!==void 0&&(Mt.receiveShadow=_.receiveShadow),_.shadow&&(_.shadow.bias!==void 0&&(Mt.shadow.bias=_.shadow.bias),_.shadow.normalBias!==void 0&&(Mt.shadow.normalBias=_.shadow.normalBias),_.shadow.radius!==void 0&&(Mt.shadow.radius=_.shadow.radius),_.shadow.mapSize!==void 0&&Mt.shadow.mapSize.fromArray(_.shadow.mapSize),_.shadow.camera!==void 0&&(Mt.shadow.camera=this.parseObject(_.shadow.camera))),_.visible!==void 0&&(Mt.visible=_.visible),_.frustumCulled!==void 0&&(Mt.frustumCulled=_.frustumCulled),_.renderOrder!==void 0&&(Mt.renderOrder=_.renderOrder),_.userData!==void 0&&(Mt.userData=_.userData),_.layers!==void 0&&(Mt.layers.mask=_.layers),_.children!==void 0){const sr=_.children;for(let ar=0;ar<sr.length;ar++)Mt.add(this.parseObject(sr[ar],ut,mt,bt,St))}if(_.animations!==void 0){const sr=_.animations;for(let ar=0;ar<sr.length;ar++){const cr=sr[ar];Mt.animations.push(St[cr])}}if(_.type==="LOD"){_.autoUpdate!==void 0&&(Mt.autoUpdate=_.autoUpdate);const sr=_.levels;for(let ar=0;ar<sr.length;ar++){const cr=sr[ar],Ar=Mt.getObjectByProperty("uuid",cr.object);Ar!==void 0&&Mt.addLevel(Ar,cr.distance,cr.hysteresis)}}return Mt}bindSkeletons(_,ut){Object.keys(ut).length!==0&&_.traverse(function(mt){if(mt.isSkinnedMesh===!0&&mt.skeleton!==void 0){const bt=ut[mt.skeleton];bt===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",mt.skeleton):mt.bind(bt,mt.bindMatrix)}})}}const TEXTURE_MAPPING={UVMapping,CubeReflectionMapping,CubeRefractionMapping,EquirectangularReflectionMapping,EquirectangularRefractionMapping,CubeUVReflectionMapping},TEXTURE_WRAPPING={RepeatWrapping,ClampToEdgeWrapping,MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter,NearestMipmapNearestFilter,NearestMipmapLinearFilter,LinearFilter,LinearMipmapNearestFilter,LinearMipmapLinearFilter};class ImageBitmapLoader extends Loader{constructor(_){super(_),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(_){return this.options=_,this}load(_,ut,mt,bt){_===void 0&&(_=""),this.path!==void 0&&(_=this.path+_),_=this.manager.resolveURL(_);const St=this,Mt=Cache.get(_);if(Mt!==void 0)return St.manager.itemStart(_),setTimeout(function(){ut&&ut(Mt),St.manager.itemEnd(_)},0),Mt;const Bt={};Bt.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",Bt.headers=this.requestHeader,fetch(_,Bt).then(function(Ut){return Ut.blob()}).then(function(Ut){return createImageBitmap(Ut,Object.assign(St.options,{colorSpaceConversion:"none"}))}).then(function(Ut){Cache.add(_,Ut),ut&&ut(Ut),St.manager.itemEnd(_)}).catch(function(Ut){bt&&bt(Ut),St.manager.itemError(_),St.manager.itemEnd(_)}),St.manager.itemStart(_)}}let _context$1,AudioContext$1=class{static getContext(){return _context$1===void 0&&(_context$1=new(window.AudioContext||window.webkitAudioContext)),_context$1}static setContext(_){_context$1=_}};class AudioLoader extends Loader{constructor(_){super(_)}load(_,ut,mt,bt){const St=this,Mt=new FileLoader(this.manager);Mt.setResponseType("arraybuffer"),Mt.setPath(this.path),Mt.setRequestHeader(this.requestHeader),Mt.setWithCredentials(this.withCredentials),Mt.load(_,function(Bt){try{const Ut=Bt.slice(0);AudioContext$1.getContext().decodeAudioData(Ut,function(tr){ut(tr)})}catch(Ut){bt?bt(Ut):console.error(Ut),St.manager.itemError(_)}},mt,bt)}}class HemisphereLightProbe extends LightProbe{constructor(_,ut,mt=1){super(void 0,mt),this.isHemisphereLightProbe=!0;const bt=new Color$1().set(_),St=new Color$1().set(ut),Mt=new Vector3(bt.r,bt.g,bt.b),Bt=new Vector3(St.r,St.g,St.b),Ut=Math.sqrt(Math.PI),Ht=Ut*Math.sqrt(.75);this.sh.coefficients[0].copy(Mt).add(Bt).multiplyScalar(Ut),this.sh.coefficients[1].copy(Mt).sub(Bt).multiplyScalar(Ht)}}class AmbientLightProbe extends LightProbe{constructor(_,ut=1){super(void 0,ut),this.isAmbientLightProbe=!0;const mt=new Color$1().set(_);this.sh.coefficients[0].set(mt.r,mt.g,mt.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const _eyeRight=new Matrix4,_eyeLeft=new Matrix4,_projectionMatrix=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera$1,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera$1,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(_){const ut=this._cache;if(ut.focus!==_.focus||ut.fov!==_.fov||ut.aspect!==_.aspect*this.aspect||ut.near!==_.near||ut.far!==_.far||ut.zoom!==_.zoom||ut.eyeSep!==this.eyeSep){ut.focus=_.focus,ut.fov=_.fov,ut.aspect=_.aspect*this.aspect,ut.near=_.near,ut.far=_.far,ut.zoom=_.zoom,ut.eyeSep=this.eyeSep,_projectionMatrix.copy(_.projectionMatrix);const bt=ut.eyeSep/2,St=bt*ut.near/ut.focus,Mt=ut.near*Math.tan(DEG2RAD*ut.fov*.5)/ut.zoom;let Bt,Ut;_eyeLeft.elements[12]=-bt,_eyeRight.elements[12]=bt,Bt=-Mt*ut.aspect+St,Ut=Mt*ut.aspect+St,_projectionMatrix.elements[0]=2*ut.near/(Ut-Bt),_projectionMatrix.elements[8]=(Ut+Bt)/(Ut-Bt),this.cameraL.projectionMatrix.copy(_projectionMatrix),Bt=-Mt*ut.aspect-St,Ut=Mt*ut.aspect-St,_projectionMatrix.elements[0]=2*ut.near/(Ut-Bt),_projectionMatrix.elements[8]=(Ut+Bt)/(Ut-Bt),this.cameraR.projectionMatrix.copy(_projectionMatrix)}this.cameraL.matrixWorld.copy(_.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(_.matrixWorld).multiply(_eyeRight)}}let Clock$1=class{constructor(_=!0){this.autoStart=_,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=now$3(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let _=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const ut=now$3();_=(ut-this.oldTime)/1e3,this.oldTime=ut,this.elapsedTime+=_}return _}};function now$3(){return(typeof performance>"u"?Date:performance).now()}const _position$1=new Vector3,_quaternion$1=new Quaternion,_scale$1=new Vector3,_orientation$1=new Vector3;class AudioListener extends Object3D{constructor(){super(),this.type="AudioListener",this.context=AudioContext$1.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock$1}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(_){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=_,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(_){return this.gain.gain.setTargetAtTime(_,this.context.currentTime,.01),this}updateMatrixWorld(_){super.updateMatrixWorld(_);const ut=this.context.listener,mt=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$1,_quaternion$1,_scale$1),_orientation$1.set(0,0,-1).applyQuaternion(_quaternion$1),ut.positionX){const bt=this.context.currentTime+this.timeDelta;ut.positionX.linearRampToValueAtTime(_position$1.x,bt),ut.positionY.linearRampToValueAtTime(_position$1.y,bt),ut.positionZ.linearRampToValueAtTime(_position$1.z,bt),ut.forwardX.linearRampToValueAtTime(_orientation$1.x,bt),ut.forwardY.linearRampToValueAtTime(_orientation$1.y,bt),ut.forwardZ.linearRampToValueAtTime(_orientation$1.z,bt),ut.upX.linearRampToValueAtTime(mt.x,bt),ut.upY.linearRampToValueAtTime(mt.y,bt),ut.upZ.linearRampToValueAtTime(mt.z,bt)}else ut.setPosition(_position$1.x,_position$1.y,_position$1.z),ut.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z,mt.x,mt.y,mt.z)}}let Audio$1=class extends Object3D{constructor(_){super(),this.type="Audio",this.listener=_,this.context=_.context,this.gain=this.context.createGain(),this.gain.connect(_.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(_){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=_,this.connect(),this}setMediaElementSource(_){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(_),this.connect(),this}setMediaStreamSource(_){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(_),this.connect(),this}setBuffer(_){return this.buffer=_,this.sourceType="buffer",this.autoplay&&this.play(),this}play(_=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+_;const ut=this.context.createBufferSource();return ut.buffer=this.buffer,ut.loop=this.loop,ut.loopStart=this.loopStart,ut.loopEnd=this.loopEnd,ut.onended=this.onEnded.bind(this),ut.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=ut,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let _=1,ut=this.filters.length;_<ut;_++)this.filters[_-1].connect(this.filters[_]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let _=1,ut=this.filters.length;_<ut;_++)this.filters[_-1].disconnect(this.filters[_]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(_){return _||(_=[]),this._connected===!0?(this.disconnect(),this.filters=_.slice(),this.connect()):this.filters=_.slice(),this}setDetune(_){if(this.detune=_,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(_){return this.setFilters(_?[_]:[])}setPlaybackRate(_){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=_,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(_){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=_,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(_){return this.loopStart=_,this}setLoopEnd(_){return this.loopEnd=_,this}getVolume(){return this.gain.gain.value}setVolume(_){return this.gain.gain.setTargetAtTime(_,this.context.currentTime,.01),this}};const _position$4=new Vector3,_quaternion=new Quaternion,_scale=new Vector3,_orientation=new Vector3;class PositionalAudio extends Audio$1{constructor(_){super(_),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(_){return this.panner.refDistance=_,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(_){return this.panner.rolloffFactor=_,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(_){return this.panner.distanceModel=_,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(_){return this.panner.maxDistance=_,this}setDirectionalCone(_,ut,mt){return this.panner.coneInnerAngle=_,this.panner.coneOuterAngle=ut,this.panner.coneOuterGain=mt,this}updateMatrixWorld(_){if(super.updateMatrixWorld(_),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(_position$4,_quaternion,_scale),_orientation.set(0,0,1).applyQuaternion(_quaternion);const ut=this.panner;if(ut.positionX){const mt=this.context.currentTime+this.listener.timeDelta;ut.positionX.linearRampToValueAtTime(_position$4.x,mt),ut.positionY.linearRampToValueAtTime(_position$4.y,mt),ut.positionZ.linearRampToValueAtTime(_position$4.z,mt),ut.orientationX.linearRampToValueAtTime(_orientation.x,mt),ut.orientationY.linearRampToValueAtTime(_orientation.y,mt),ut.orientationZ.linearRampToValueAtTime(_orientation.z,mt)}else ut.setPosition(_position$4.x,_position$4.y,_position$4.z),ut.setOrientation(_orientation.x,_orientation.y,_orientation.z)}}class AudioAnalyser{constructor(_,ut=2048){this.analyser=_.context.createAnalyser(),this.analyser.fftSize=ut,this.data=new Uint8Array(this.analyser.frequencyBinCount),_.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let _=0;const ut=this.getFrequencyData();for(let mt=0;mt<ut.length;mt++)_+=ut[mt];return _/ut.length}}class PropertyMixer{constructor(_,ut,mt){this.binding=_,this.valueSize=mt;let bt,St,Mt;switch(ut){case"quaternion":bt=this._slerp,St=this._slerpAdditive,Mt=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(mt*6),this._workIndex=5;break;case"string":case"bool":bt=this._select,St=this._select,Mt=this._setAdditiveIdentityOther,this.buffer=new Array(mt*5);break;default:bt=this._lerp,St=this._lerpAdditive,Mt=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(mt*5)}this._mixBufferRegion=bt,this._mixBufferRegionAdditive=St,this._setIdentity=Mt,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(_,ut){const mt=this.buffer,bt=this.valueSize,St=_*bt+bt;let Mt=this.cumulativeWeight;if(Mt===0){for(let Bt=0;Bt!==bt;++Bt)mt[St+Bt]=mt[Bt];Mt=ut}else{Mt+=ut;const Bt=ut/Mt;this._mixBufferRegion(mt,St,0,Bt,bt)}this.cumulativeWeight=Mt}accumulateAdditive(_){const ut=this.buffer,mt=this.valueSize,bt=mt*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(ut,bt,0,_,mt),this.cumulativeWeightAdditive+=_}apply(_){const ut=this.valueSize,mt=this.buffer,bt=_*ut+ut,St=this.cumulativeWeight,Mt=this.cumulativeWeightAdditive,Bt=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,St<1){const Ut=ut*this._origIndex;this._mixBufferRegion(mt,bt,Ut,1-St,ut)}Mt>0&&this._mixBufferRegionAdditive(mt,bt,this._addIndex*ut,1,ut);for(let Ut=ut,Ht=ut+ut;Ut!==Ht;++Ut)if(mt[Ut]!==mt[Ut+ut]){Bt.setValue(mt,bt);break}}saveOriginalState(){const _=this.binding,ut=this.buffer,mt=this.valueSize,bt=mt*this._origIndex;_.getValue(ut,bt);for(let St=mt,Mt=bt;St!==Mt;++St)ut[St]=ut[bt+St%mt];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const _=this.valueSize*3;this.binding.setValue(this.buffer,_)}_setAdditiveIdentityNumeric(){const _=this._addIndex*this.valueSize,ut=_+this.valueSize;for(let mt=_;mt<ut;mt++)this.buffer[mt]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const _=this._origIndex*this.valueSize,ut=this._addIndex*this.valueSize;for(let mt=0;mt<this.valueSize;mt++)this.buffer[ut+mt]=this.buffer[_+mt]}_select(_,ut,mt,bt,St){if(bt>=.5)for(let Mt=0;Mt!==St;++Mt)_[ut+Mt]=_[mt+Mt]}_slerp(_,ut,mt,bt){Quaternion.slerpFlat(_,ut,_,ut,_,mt,bt)}_slerpAdditive(_,ut,mt,bt,St){const Mt=this._workIndex*St;Quaternion.multiplyQuaternionsFlat(_,Mt,_,ut,_,mt),Quaternion.slerpFlat(_,ut,_,ut,_,Mt,bt)}_lerp(_,ut,mt,bt,St){const Mt=1-bt;for(let Bt=0;Bt!==St;++Bt){const Ut=ut+Bt;_[Ut]=_[Ut]*Mt+_[mt+Bt]*bt}}_lerpAdditive(_,ut,mt,bt,St){for(let Mt=0;Mt!==St;++Mt){const Bt=ut+Mt;_[Bt]=_[Bt]+_[mt+Mt]*bt}}}const _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones","map"];class Composite{constructor(_,ut,mt){const bt=mt||PropertyBinding.parseTrackName(ut);this._targetGroup=_,this._bindings=_.subscribe_(ut,bt)}getValue(_,ut){this.bind();const mt=this._targetGroup.nCachedObjects_,bt=this._bindings[mt];bt!==void 0&&bt.getValue(_,ut)}setValue(_,ut){const mt=this._bindings;for(let bt=this._targetGroup.nCachedObjects_,St=mt.length;bt!==St;++bt)mt[bt].setValue(_,ut)}bind(){const _=this._bindings;for(let ut=this._targetGroup.nCachedObjects_,mt=_.length;ut!==mt;++ut)_[ut].bind()}unbind(){const _=this._bindings;for(let ut=this._targetGroup.nCachedObjects_,mt=_.length;ut!==mt;++ut)_[ut].unbind()}}class PropertyBinding{constructor(_,ut,mt){this.path=ut,this.parsedPath=mt||PropertyBinding.parseTrackName(ut),this.node=PropertyBinding.findNode(_,this.parsedPath.nodeName),this.rootNode=_,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(_,ut,mt){return _&&_.isAnimationObjectGroup?new PropertyBinding.Composite(_,ut,mt):new PropertyBinding(_,ut,mt)}static sanitizeNodeName(_){return _.replace(/\s/g,"_").replace(_reservedRe,"")}static parseTrackName(_){const ut=_trackRe.exec(_);if(ut===null)throw new Error("PropertyBinding: Cannot parse trackName: "+_);const mt={nodeName:ut[2],objectName:ut[3],objectIndex:ut[4],propertyName:ut[5],propertyIndex:ut[6]},bt=mt.nodeName&&mt.nodeName.lastIndexOf(".");if(bt!==void 0&&bt!==-1){const St=mt.nodeName.substring(bt+1);_supportedObjectNames.indexOf(St)!==-1&&(mt.nodeName=mt.nodeName.substring(0,bt),mt.objectName=St)}if(mt.propertyName===null||mt.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+_);return mt}static findNode(_,ut){if(ut===void 0||ut===""||ut==="."||ut===-1||ut===_.name||ut===_.uuid)return _;if(_.skeleton){const mt=_.skeleton.getBoneByName(ut);if(mt!==void 0)return mt}if(_.children){const mt=function(St){for(let Mt=0;Mt<St.length;Mt++){const Bt=St[Mt];if(Bt.name===ut||Bt.uuid===ut)return Bt;const Ut=mt(Bt.children);if(Ut)return Ut}return null},bt=mt(_.children);if(bt)return bt}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(_,ut){_[ut]=this.targetObject[this.propertyName]}_getValue_array(_,ut){const mt=this.resolvedProperty;for(let bt=0,St=mt.length;bt!==St;++bt)_[ut++]=mt[bt]}_getValue_arrayElement(_,ut){_[ut]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(_,ut){this.resolvedProperty.toArray(_,ut)}_setValue_direct(_,ut){this.targetObject[this.propertyName]=_[ut]}_setValue_direct_setNeedsUpdate(_,ut){this.targetObject[this.propertyName]=_[ut],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(_,ut){this.targetObject[this.propertyName]=_[ut],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(_,ut){const mt=this.resolvedProperty;for(let bt=0,St=mt.length;bt!==St;++bt)mt[bt]=_[ut++]}_setValue_array_setNeedsUpdate(_,ut){const mt=this.resolvedProperty;for(let bt=0,St=mt.length;bt!==St;++bt)mt[bt]=_[ut++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(_,ut){const mt=this.resolvedProperty;for(let bt=0,St=mt.length;bt!==St;++bt)mt[bt]=_[ut++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(_,ut){this.resolvedProperty[this.propertyIndex]=_[ut]}_setValue_arrayElement_setNeedsUpdate(_,ut){this.resolvedProperty[this.propertyIndex]=_[ut],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(_,ut){this.resolvedProperty[this.propertyIndex]=_[ut],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(_,ut){this.resolvedProperty.fromArray(_,ut)}_setValue_fromArray_setNeedsUpdate(_,ut){this.resolvedProperty.fromArray(_,ut),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(_,ut){this.resolvedProperty.fromArray(_,ut),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(_,ut){this.bind(),this.getValue(_,ut)}_setValue_unbound(_,ut){this.bind(),this.setValue(_,ut)}bind(){let _=this.node;const ut=this.parsedPath,mt=ut.objectName,bt=ut.propertyName;let St=ut.propertyIndex;if(_||(_=PropertyBinding.findNode(this.rootNode,ut.nodeName),this.node=_),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!_){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(mt){let Ht=ut.objectIndex;switch(mt){case"materials":if(!_.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}_=_.material.materials;break;case"bones":if(!_.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}_=_.skeleton.bones;for(let tr=0;tr<_.length;tr++)if(_[tr].name===Ht){Ht=tr;break}break;case"map":if("map"in _){_=_.map;break}if(!_.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!_.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}_=_.material.map;break;default:if(_[mt]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}_=_[mt]}if(Ht!==void 0){if(_[Ht]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,_);return}_=_[Ht]}}const Mt=_[bt];if(Mt===void 0){const Ht=ut.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+Ht+"."+bt+" but it wasn't found.",_);return}let Bt=this.Versioning.None;this.targetObject=_,_.needsUpdate!==void 0?Bt=this.Versioning.NeedsUpdate:_.matrixWorldNeedsUpdate!==void 0&&(Bt=this.Versioning.MatrixWorldNeedsUpdate);let Ut=this.BindingType.Direct;if(St!==void 0){if(bt==="morphTargetInfluences"){if(!_.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!_.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}_.morphTargetDictionary[St]!==void 0&&(St=_.morphTargetDictionary[St])}Ut=this.BindingType.ArrayElement,this.resolvedProperty=Mt,this.propertyIndex=St}else Mt.fromArray!==void 0&&Mt.toArray!==void 0?(Ut=this.BindingType.HasFromToArray,this.resolvedProperty=Mt):Array.isArray(Mt)?(Ut=this.BindingType.EntireArray,this.resolvedProperty=Mt):this.propertyName=bt;this.getValue=this.GetterByBindingType[Ut],this.setValue=this.SetterByBindingTypeAndVersioning[Ut][Bt]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=Composite;PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray];PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.isAnimationObjectGroup=!0,this.uuid=generateUUID$1(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const _={};this._indicesByUUID=_;for(let mt=0,bt=arguments.length;mt!==bt;++mt)_[arguments[mt].uuid]=mt;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const ut=this;this.stats={objects:{get total(){return ut._objects.length},get inUse(){return this.total-ut.nCachedObjects_}},get bindingsPerObject(){return ut._bindings.length}}}add(){const _=this._objects,ut=this._indicesByUUID,mt=this._paths,bt=this._parsedPaths,St=this._bindings,Mt=St.length;let Bt,Ut=_.length,Ht=this.nCachedObjects_;for(let tr=0,rr=arguments.length;tr!==rr;++tr){const sr=arguments[tr],ar=sr.uuid;let cr=ut[ar];if(cr===void 0){cr=Ut++,ut[ar]=cr,_.push(sr);for(let Ar=0,_r=Mt;Ar!==_r;++Ar)St[Ar].push(new PropertyBinding(sr,mt[Ar],bt[Ar]))}else if(cr<Ht){Bt=_[cr];const Ar=--Ht,_r=_[Ar];ut[_r.uuid]=cr,_[cr]=_r,ut[ar]=Ar,_[Ar]=sr;for(let Dr=0,$r=Mt;Dr!==$r;++Dr){const Br=St[Dr],Jr=Br[Ar];let mn=Br[cr];Br[cr]=Jr,mn===void 0&&(mn=new PropertyBinding(sr,mt[Dr],bt[Dr])),Br[Ar]=mn}}else _[cr]!==Bt&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=Ht}remove(){const _=this._objects,ut=this._indicesByUUID,mt=this._bindings,bt=mt.length;let St=this.nCachedObjects_;for(let Mt=0,Bt=arguments.length;Mt!==Bt;++Mt){const Ut=arguments[Mt],Ht=Ut.uuid,tr=ut[Ht];if(tr!==void 0&&tr>=St){const rr=St++,sr=_[rr];ut[sr.uuid]=tr,_[tr]=sr,ut[Ht]=rr,_[rr]=Ut;for(let ar=0,cr=bt;ar!==cr;++ar){const Ar=mt[ar],_r=Ar[rr],Dr=Ar[tr];Ar[tr]=_r,Ar[rr]=Dr}}}this.nCachedObjects_=St}uncache(){const _=this._objects,ut=this._indicesByUUID,mt=this._bindings,bt=mt.length;let St=this.nCachedObjects_,Mt=_.length;for(let Bt=0,Ut=arguments.length;Bt!==Ut;++Bt){const Ht=arguments[Bt],tr=Ht.uuid,rr=ut[tr];if(rr!==void 0)if(delete ut[tr],rr<St){const sr=--St,ar=_[sr],cr=--Mt,Ar=_[cr];ut[ar.uuid]=rr,_[rr]=ar,ut[Ar.uuid]=sr,_[sr]=Ar,_.pop();for(let _r=0,Dr=bt;_r!==Dr;++_r){const $r=mt[_r],Br=$r[sr],Jr=$r[cr];$r[rr]=Br,$r[sr]=Jr,$r.pop()}}else{const sr=--Mt,ar=_[sr];sr>0&&(ut[ar.uuid]=rr),_[rr]=ar,_.pop();for(let cr=0,Ar=bt;cr!==Ar;++cr){const _r=mt[cr];_r[rr]=_r[sr],_r.pop()}}}this.nCachedObjects_=St}subscribe_(_,ut){const mt=this._bindingsIndicesByPath;let bt=mt[_];const St=this._bindings;if(bt!==void 0)return St[bt];const Mt=this._paths,Bt=this._parsedPaths,Ut=this._objects,Ht=Ut.length,tr=this.nCachedObjects_,rr=new Array(Ht);bt=St.length,mt[_]=bt,Mt.push(_),Bt.push(ut),St.push(rr);for(let sr=tr,ar=Ut.length;sr!==ar;++sr){const cr=Ut[sr];rr[sr]=new PropertyBinding(cr,_,ut)}return rr}unsubscribe_(_){const ut=this._bindingsIndicesByPath,mt=ut[_];if(mt!==void 0){const bt=this._paths,St=this._parsedPaths,Mt=this._bindings,Bt=Mt.length-1,Ut=Mt[Bt],Ht=_[Bt];ut[Ht]=mt,Mt[mt]=Ut,Mt.pop(),St[mt]=St[Bt],St.pop(),bt[mt]=bt[Bt],bt.pop()}}}class AnimationAction{constructor(_,ut,mt=null,bt=ut.blendMode){this._mixer=_,this._clip=ut,this._localRoot=mt,this.blendMode=bt;const St=ut.tracks,Mt=St.length,Bt=new Array(Mt),Ut={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding};for(let Ht=0;Ht!==Mt;++Ht){const tr=St[Ht].createInterpolant(null);Bt[Ht]=tr,tr.settings=Ut}this._interpolantSettings=Ut,this._interpolants=Bt,this._propertyBindings=new Array(Mt),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(_){return this._startTime=_,this}setLoop(_,ut){return this.loop=_,this.repetitions=ut,this}setEffectiveWeight(_){return this.weight=_,this._effectiveWeight=this.enabled?_:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(_){return this._scheduleFading(_,0,1)}fadeOut(_){return this._scheduleFading(_,1,0)}crossFadeFrom(_,ut,mt){if(_.fadeOut(ut),this.fadeIn(ut),mt){const bt=this._clip.duration,St=_._clip.duration,Mt=St/bt,Bt=bt/St;_.warp(1,Mt,ut),this.warp(Bt,1,ut)}return this}crossFadeTo(_,ut,mt){return _.crossFadeFrom(this,ut,mt)}stopFading(){const _=this._weightInterpolant;return _!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(_)),this}setEffectiveTimeScale(_){return this.timeScale=_,this._effectiveTimeScale=this.paused?0:_,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(_){return this.timeScale=this._clip.duration/_,this.stopWarping()}syncWith(_){return this.time=_.time,this.timeScale=_.timeScale,this.stopWarping()}halt(_){return this.warp(this._effectiveTimeScale,0,_)}warp(_,ut,mt){const bt=this._mixer,St=bt.time,Mt=this.timeScale;let Bt=this._timeScaleInterpolant;Bt===null&&(Bt=bt._lendControlInterpolant(),this._timeScaleInterpolant=Bt);const Ut=Bt.parameterPositions,Ht=Bt.sampleValues;return Ut[0]=St,Ut[1]=St+mt,Ht[0]=_/Mt,Ht[1]=ut/Mt,this}stopWarping(){const _=this._timeScaleInterpolant;return _!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(_)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(_,ut,mt,bt){if(!this.enabled){this._updateWeight(_);return}const St=this._startTime;if(St!==null){const Ut=(_-St)*mt;Ut<0||mt===0?ut=0:(this._startTime=null,ut=mt*Ut)}ut*=this._updateTimeScale(_);const Mt=this._updateTime(ut),Bt=this._updateWeight(_);if(Bt>0){const Ut=this._interpolants,Ht=this._propertyBindings;switch(this.blendMode){case AdditiveAnimationBlendMode:for(let tr=0,rr=Ut.length;tr!==rr;++tr)Ut[tr].evaluate(Mt),Ht[tr].accumulateAdditive(Bt);break;case NormalAnimationBlendMode:default:for(let tr=0,rr=Ut.length;tr!==rr;++tr)Ut[tr].evaluate(Mt),Ht[tr].accumulate(bt,Bt)}}}_updateWeight(_){let ut=0;if(this.enabled){ut=this.weight;const mt=this._weightInterpolant;if(mt!==null){const bt=mt.evaluate(_)[0];ut*=bt,_>mt.parameterPositions[1]&&(this.stopFading(),bt===0&&(this.enabled=!1))}}return this._effectiveWeight=ut,ut}_updateTimeScale(_){let ut=0;if(!this.paused){ut=this.timeScale;const mt=this._timeScaleInterpolant;if(mt!==null){const bt=mt.evaluate(_)[0];ut*=bt,_>mt.parameterPositions[1]&&(this.stopWarping(),ut===0?this.paused=!0:this.timeScale=ut)}}return this._effectiveTimeScale=ut,ut}_updateTime(_){const ut=this._clip.duration,mt=this.loop;let bt=this.time+_,St=this._loopCount;const Mt=mt===LoopPingPong;if(_===0)return St===-1?bt:Mt&&(St&1)===1?ut-bt:bt;if(mt===LoopOnce){St===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(bt>=ut)bt=ut;else if(bt<0)bt=0;else{this.time=bt;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=bt,this._mixer.dispatchEvent({type:"finished",action:this,direction:_<0?-1:1})}}else{if(St===-1&&(_>=0?(St=0,this._setEndings(!0,this.repetitions===0,Mt)):this._setEndings(this.repetitions===0,!0,Mt)),bt>=ut||bt<0){const Bt=Math.floor(bt/ut);bt-=ut*Bt,St+=Math.abs(Bt);const Ut=this.repetitions-St;if(Ut<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,bt=_>0?ut:0,this.time=bt,this._mixer.dispatchEvent({type:"finished",action:this,direction:_>0?1:-1});else{if(Ut===1){const Ht=_<0;this._setEndings(Ht,!Ht,Mt)}else this._setEndings(!1,!1,Mt);this._loopCount=St,this.time=bt,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:Bt})}}else this.time=bt;if(Mt&&(St&1)===1)return ut-bt}return bt}_setEndings(_,ut,mt){const bt=this._interpolantSettings;mt?(bt.endingStart=ZeroSlopeEnding,bt.endingEnd=ZeroSlopeEnding):(_?bt.endingStart=this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:bt.endingStart=WrapAroundEnding,ut?bt.endingEnd=this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:bt.endingEnd=WrapAroundEnding)}_scheduleFading(_,ut,mt){const bt=this._mixer,St=bt.time;let Mt=this._weightInterpolant;Mt===null&&(Mt=bt._lendControlInterpolant(),this._weightInterpolant=Mt);const Bt=Mt.parameterPositions,Ut=Mt.sampleValues;return Bt[0]=St,Ut[0]=ut,Bt[1]=St+_,Ut[1]=mt,this}}const _controlInterpolantsResultBuffer=new Float32Array(1);class AnimationMixer extends EventDispatcher{constructor(_){super(),this._root=_,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(_,ut){const mt=_._localRoot||this._root,bt=_._clip.tracks,St=bt.length,Mt=_._propertyBindings,Bt=_._interpolants,Ut=mt.uuid,Ht=this._bindingsByRootAndName;let tr=Ht[Ut];tr===void 0&&(tr={},Ht[Ut]=tr);for(let rr=0;rr!==St;++rr){const sr=bt[rr],ar=sr.name;let cr=tr[ar];if(cr!==void 0)++cr.referenceCount,Mt[rr]=cr;else{if(cr=Mt[rr],cr!==void 0){cr._cacheIndex===null&&(++cr.referenceCount,this._addInactiveBinding(cr,Ut,ar));continue}const Ar=ut&&ut._propertyBindings[rr].binding.parsedPath;cr=new PropertyMixer(PropertyBinding.create(mt,ar,Ar),sr.ValueTypeName,sr.getValueSize()),++cr.referenceCount,this._addInactiveBinding(cr,Ut,ar),Mt[rr]=cr}Bt[rr].resultBuffer=cr.buffer}}_activateAction(_){if(!this._isActiveAction(_)){if(_._cacheIndex===null){const mt=(_._localRoot||this._root).uuid,bt=_._clip.uuid,St=this._actionsByClip[bt];this._bindAction(_,St&&St.knownActions[0]),this._addInactiveAction(_,bt,mt)}const ut=_._propertyBindings;for(let mt=0,bt=ut.length;mt!==bt;++mt){const St=ut[mt];St.useCount++===0&&(this._lendBinding(St),St.saveOriginalState())}this._lendAction(_)}}_deactivateAction(_){if(this._isActiveAction(_)){const ut=_._propertyBindings;for(let mt=0,bt=ut.length;mt!==bt;++mt){const St=ut[mt];--St.useCount===0&&(St.restoreOriginalState(),this._takeBackBinding(St))}this._takeBackAction(_)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const _=this;this.stats={actions:{get total(){return _._actions.length},get inUse(){return _._nActiveActions}},bindings:{get total(){return _._bindings.length},get inUse(){return _._nActiveBindings}},controlInterpolants:{get total(){return _._controlInterpolants.length},get inUse(){return _._nActiveControlInterpolants}}}}_isActiveAction(_){const ut=_._cacheIndex;return ut!==null&&ut<this._nActiveActions}_addInactiveAction(_,ut,mt){const bt=this._actions,St=this._actionsByClip;let Mt=St[ut];if(Mt===void 0)Mt={knownActions:[_],actionByRoot:{}},_._byClipCacheIndex=0,St[ut]=Mt;else{const Bt=Mt.knownActions;_._byClipCacheIndex=Bt.length,Bt.push(_)}_._cacheIndex=bt.length,bt.push(_),Mt.actionByRoot[mt]=_}_removeInactiveAction(_){const ut=this._actions,mt=ut[ut.length-1],bt=_._cacheIndex;mt._cacheIndex=bt,ut[bt]=mt,ut.pop(),_._cacheIndex=null;const St=_._clip.uuid,Mt=this._actionsByClip,Bt=Mt[St],Ut=Bt.knownActions,Ht=Ut[Ut.length-1],tr=_._byClipCacheIndex;Ht._byClipCacheIndex=tr,Ut[tr]=Ht,Ut.pop(),_._byClipCacheIndex=null;const rr=Bt.actionByRoot,sr=(_._localRoot||this._root).uuid;delete rr[sr],Ut.length===0&&delete Mt[St],this._removeInactiveBindingsForAction(_)}_removeInactiveBindingsForAction(_){const ut=_._propertyBindings;for(let mt=0,bt=ut.length;mt!==bt;++mt){const St=ut[mt];--St.referenceCount===0&&this._removeInactiveBinding(St)}}_lendAction(_){const ut=this._actions,mt=_._cacheIndex,bt=this._nActiveActions++,St=ut[bt];_._cacheIndex=bt,ut[bt]=_,St._cacheIndex=mt,ut[mt]=St}_takeBackAction(_){const ut=this._actions,mt=_._cacheIndex,bt=--this._nActiveActions,St=ut[bt];_._cacheIndex=bt,ut[bt]=_,St._cacheIndex=mt,ut[mt]=St}_addInactiveBinding(_,ut,mt){const bt=this._bindingsByRootAndName,St=this._bindings;let Mt=bt[ut];Mt===void 0&&(Mt={},bt[ut]=Mt),Mt[mt]=_,_._cacheIndex=St.length,St.push(_)}_removeInactiveBinding(_){const ut=this._bindings,mt=_.binding,bt=mt.rootNode.uuid,St=mt.path,Mt=this._bindingsByRootAndName,Bt=Mt[bt],Ut=ut[ut.length-1],Ht=_._cacheIndex;Ut._cacheIndex=Ht,ut[Ht]=Ut,ut.pop(),delete Bt[St],Object.keys(Bt).length===0&&delete Mt[bt]}_lendBinding(_){const ut=this._bindings,mt=_._cacheIndex,bt=this._nActiveBindings++,St=ut[bt];_._cacheIndex=bt,ut[bt]=_,St._cacheIndex=mt,ut[mt]=St}_takeBackBinding(_){const ut=this._bindings,mt=_._cacheIndex,bt=--this._nActiveBindings,St=ut[bt];_._cacheIndex=bt,ut[bt]=_,St._cacheIndex=mt,ut[mt]=St}_lendControlInterpolant(){const _=this._controlInterpolants,ut=this._nActiveControlInterpolants++;let mt=_[ut];return mt===void 0&&(mt=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,_controlInterpolantsResultBuffer),mt.__cacheIndex=ut,_[ut]=mt),mt}_takeBackControlInterpolant(_){const ut=this._controlInterpolants,mt=_.__cacheIndex,bt=--this._nActiveControlInterpolants,St=ut[bt];_.__cacheIndex=bt,ut[bt]=_,St.__cacheIndex=mt,ut[mt]=St}clipAction(_,ut,mt){const bt=ut||this._root,St=bt.uuid;let Mt=typeof _=="string"?AnimationClip.findByName(bt,_):_;const Bt=Mt!==null?Mt.uuid:_,Ut=this._actionsByClip[Bt];let Ht=null;if(mt===void 0&&(Mt!==null?mt=Mt.blendMode:mt=NormalAnimationBlendMode),Ut!==void 0){const rr=Ut.actionByRoot[St];if(rr!==void 0&&rr.blendMode===mt)return rr;Ht=Ut.knownActions[0],Mt===null&&(Mt=Ht._clip)}if(Mt===null)return null;const tr=new AnimationAction(this,Mt,ut,mt);return this._bindAction(tr,Ht),this._addInactiveAction(tr,Bt,St),tr}existingAction(_,ut){const mt=ut||this._root,bt=mt.uuid,St=typeof _=="string"?AnimationClip.findByName(mt,_):_,Mt=St?St.uuid:_,Bt=this._actionsByClip[Mt];return Bt!==void 0&&Bt.actionByRoot[bt]||null}stopAllAction(){const _=this._actions,ut=this._nActiveActions;for(let mt=ut-1;mt>=0;--mt)_[mt].stop();return this}update(_){_*=this.timeScale;const ut=this._actions,mt=this._nActiveActions,bt=this.time+=_,St=Math.sign(_),Mt=this._accuIndex^=1;for(let Ht=0;Ht!==mt;++Ht)ut[Ht]._update(bt,_,St,Mt);const Bt=this._bindings,Ut=this._nActiveBindings;for(let Ht=0;Ht!==Ut;++Ht)Bt[Ht].apply(Mt);return this}setTime(_){this.time=0;for(let ut=0;ut<this._actions.length;ut++)this._actions[ut].time=0;return this.update(_)}getRoot(){return this._root}uncacheClip(_){const ut=this._actions,mt=_.uuid,bt=this._actionsByClip,St=bt[mt];if(St!==void 0){const Mt=St.knownActions;for(let Bt=0,Ut=Mt.length;Bt!==Ut;++Bt){const Ht=Mt[Bt];this._deactivateAction(Ht);const tr=Ht._cacheIndex,rr=ut[ut.length-1];Ht._cacheIndex=null,Ht._byClipCacheIndex=null,rr._cacheIndex=tr,ut[tr]=rr,ut.pop(),this._removeInactiveBindingsForAction(Ht)}delete bt[mt]}}uncacheRoot(_){const ut=_.uuid,mt=this._actionsByClip;for(const Mt in mt){const Bt=mt[Mt].actionByRoot,Ut=Bt[ut];Ut!==void 0&&(this._deactivateAction(Ut),this._removeInactiveAction(Ut))}const bt=this._bindingsByRootAndName,St=bt[ut];if(St!==void 0)for(const Mt in St){const Bt=St[Mt];Bt.restoreOriginalState(),this._removeInactiveBinding(Bt)}}uncacheAction(_,ut){const mt=this.existingAction(_,ut);mt!==null&&(this._deactivateAction(mt),this._removeInactiveAction(mt))}}class Uniform{constructor(_){this.value=_}clone(){return new Uniform(this.value.clone===void 0?this.value:this.value.clone())}}let id$3=0;class UniformsGroup extends EventDispatcher{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:id$3++}),this.name="",this.usage=StaticDrawUsage,this.uniforms=[]}add(_){return this.uniforms.push(_),this}remove(_){const ut=this.uniforms.indexOf(_);return ut!==-1&&this.uniforms.splice(ut,1),this}setName(_){return this.name=_,this}setUsage(_){return this.usage=_,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(_){this.name=_.name,this.usage=_.usage;const ut=_.uniforms;this.uniforms.length=0;for(let mt=0,bt=ut.length;mt<bt;mt++)this.uniforms.push(ut[mt].clone());return this}clone(){return new this.constructor().copy(this)}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(_,ut,mt=1){super(_,ut),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=mt}copy(_){return super.copy(_),this.meshPerAttribute=_.meshPerAttribute,this}clone(_){const ut=super.clone(_);return ut.meshPerAttribute=this.meshPerAttribute,ut}toJSON(_){const ut=super.toJSON(_);return ut.isInstancedInterleavedBuffer=!0,ut.meshPerAttribute=this.meshPerAttribute,ut}}class GLBufferAttribute{constructor(_,ut,mt,bt,St){this.isGLBufferAttribute=!0,this.name="",this.buffer=_,this.type=ut,this.itemSize=mt,this.elementSize=bt,this.count=St,this.version=0}set needsUpdate(_){_===!0&&this.version++}setBuffer(_){return this.buffer=_,this}setType(_,ut){return this.type=_,this.elementSize=ut,this}setItemSize(_){return this.itemSize=_,this}setCount(_){return this.count=_,this}}class Raycaster{constructor(_,ut,mt=0,bt=1/0){this.ray=new Ray(_,ut),this.near=mt,this.far=bt,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(_,ut){this.ray.set(_,ut)}setFromCamera(_,ut){ut.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(ut.matrixWorld),this.ray.direction.set(_.x,_.y,.5).unproject(ut).sub(this.ray.origin).normalize(),this.camera=ut):ut.isOrthographicCamera?(this.ray.origin.set(_.x,_.y,(ut.near+ut.far)/(ut.near-ut.far)).unproject(ut),this.ray.direction.set(0,0,-1).transformDirection(ut.matrixWorld),this.camera=ut):console.error("THREE.Raycaster: Unsupported camera type: "+ut.type)}intersectObject(_,ut=!0,mt=[]){return intersectObject(_,this,mt,ut),mt.sort(ascSort),mt}intersectObjects(_,ut=!0,mt=[]){for(let bt=0,St=_.length;bt<St;bt++)intersectObject(_[bt],this,mt,ut);return mt.sort(ascSort),mt}}function ascSort(rt,_){return rt.distance-_.distance}function intersectObject(rt,_,ut,mt){if(rt.layers.test(_.layers)&&rt.raycast(_,ut),mt===!0){const bt=rt.children;for(let St=0,Mt=bt.length;St<Mt;St++)intersectObject(bt[St],_,ut,!0)}}class Spherical{constructor(_=1,ut=0,mt=0){return this.radius=_,this.phi=ut,this.theta=mt,this}set(_,ut,mt){return this.radius=_,this.phi=ut,this.theta=mt,this}copy(_){return this.radius=_.radius,this.phi=_.phi,this.theta=_.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(_){return this.setFromCartesianCoords(_.x,_.y,_.z)}setFromCartesianCoords(_,ut,mt){return this.radius=Math.sqrt(_*_+ut*ut+mt*mt),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(_,mt),this.phi=Math.acos(clamp$7(ut/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Cylindrical{constructor(_=1,ut=0,mt=0){return this.radius=_,this.theta=ut,this.y=mt,this}set(_,ut,mt){return this.radius=_,this.theta=ut,this.y=mt,this}copy(_){return this.radius=_.radius,this.theta=_.theta,this.y=_.y,this}setFromVector3(_){return this.setFromCartesianCoords(_.x,_.y,_.z)}setFromCartesianCoords(_,ut,mt){return this.radius=Math.sqrt(_*_+mt*mt),this.theta=Math.atan2(_,mt),this.y=ut,this}clone(){return new this.constructor().copy(this)}}const _vector$4=new Vector2;class Box2{constructor(_=new Vector2(1/0,1/0),ut=new Vector2(-1/0,-1/0)){this.isBox2=!0,this.min=_,this.max=ut}set(_,ut){return this.min.copy(_),this.max.copy(ut),this}setFromPoints(_){this.makeEmpty();for(let ut=0,mt=_.length;ut<mt;ut++)this.expandByPoint(_[ut]);return this}setFromCenterAndSize(_,ut){const mt=_vector$4.copy(ut).multiplyScalar(.5);return this.min.copy(_).sub(mt),this.max.copy(_).add(mt),this}clone(){return new this.constructor().copy(this)}copy(_){return this.min.copy(_.min),this.max.copy(_.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(_){return this.isEmpty()?_.set(0,0):_.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(_){return this.isEmpty()?_.set(0,0):_.subVectors(this.max,this.min)}expandByPoint(_){return this.min.min(_),this.max.max(_),this}expandByVector(_){return this.min.sub(_),this.max.add(_),this}expandByScalar(_){return this.min.addScalar(-_),this.max.addScalar(_),this}containsPoint(_){return!(_.x<this.min.x||_.x>this.max.x||_.y<this.min.y||_.y>this.max.y)}containsBox(_){return this.min.x<=_.min.x&&_.max.x<=this.max.x&&this.min.y<=_.min.y&&_.max.y<=this.max.y}getParameter(_,ut){return ut.set((_.x-this.min.x)/(this.max.x-this.min.x),(_.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(_){return!(_.max.x<this.min.x||_.min.x>this.max.x||_.max.y<this.min.y||_.min.y>this.max.y)}clampPoint(_,ut){return ut.copy(_).clamp(this.min,this.max)}distanceToPoint(_){return this.clampPoint(_,_vector$4).distanceTo(_)}intersect(_){return this.min.max(_.min),this.max.min(_.max),this.isEmpty()&&this.makeEmpty(),this}union(_){return this.min.min(_.min),this.max.max(_.max),this}translate(_){return this.min.add(_),this.max.add(_),this}equals(_){return _.min.equals(this.min)&&_.max.equals(this.max)}}const _startP=new Vector3,_startEnd=new Vector3;class Line3{constructor(_=new Vector3,ut=new Vector3){this.start=_,this.end=ut}set(_,ut){return this.start.copy(_),this.end.copy(ut),this}copy(_){return this.start.copy(_.start),this.end.copy(_.end),this}getCenter(_){return _.addVectors(this.start,this.end).multiplyScalar(.5)}delta(_){return _.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(_,ut){return this.delta(ut).multiplyScalar(_).add(this.start)}closestPointToPointParameter(_,ut){_startP.subVectors(_,this.start),_startEnd.subVectors(this.end,this.start);const mt=_startEnd.dot(_startEnd);let St=_startEnd.dot(_startP)/mt;return ut&&(St=clamp$7(St,0,1)),St}closestPointToPoint(_,ut,mt){const bt=this.closestPointToPointParameter(_,ut);return this.delta(mt).multiplyScalar(bt).add(this.start)}applyMatrix4(_){return this.start.applyMatrix4(_),this.end.applyMatrix4(_),this}equals(_){return _.start.equals(this.start)&&_.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const _vector$3=new Vector3;class SpotLightHelper extends Object3D{constructor(_,ut){super(),this.light=_,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=ut,this.type="SpotLightHelper";const mt=new BufferGeometry,bt=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let Mt=0,Bt=1,Ut=32;Mt<Ut;Mt++,Bt++){const Ht=Mt/Ut*Math.PI*2,tr=Bt/Ut*Math.PI*2;bt.push(Math.cos(Ht),Math.sin(Ht),1,Math.cos(tr),Math.sin(tr),1)}mt.setAttribute("position",new Float32BufferAttribute(bt,3));const St=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(mt,St),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const _=this.light.distance?this.light.distance:1e3,ut=_*Math.tan(this.light.angle);this.cone.scale.set(ut,ut,_),_vector$3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const _vector$2=new Vector3,_boneMatrix=new Matrix4,_matrixWorldInv=new Matrix4;class SkeletonHelper extends LineSegments{constructor(_){const ut=getBoneList(_),mt=new BufferGeometry,bt=[],St=[],Mt=new Color$1(0,0,1),Bt=new Color$1(0,1,0);for(let Ht=0;Ht<ut.length;Ht++){const tr=ut[Ht];tr.parent&&tr.parent.isBone&&(bt.push(0,0,0),bt.push(0,0,0),St.push(Mt.r,Mt.g,Mt.b),St.push(Bt.r,Bt.g,Bt.b))}mt.setAttribute("position",new Float32BufferAttribute(bt,3)),mt.setAttribute("color",new Float32BufferAttribute(St,3));const Ut=new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(mt,Ut),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=_,this.bones=ut,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(_){const ut=this.bones,mt=this.geometry,bt=mt.getAttribute("position");_matrixWorldInv.copy(this.root.matrixWorld).invert();for(let St=0,Mt=0;St<ut.length;St++){const Bt=ut[St];Bt.parent&&Bt.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv,Bt.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),bt.setXYZ(Mt,_vector$2.x,_vector$2.y,_vector$2.z),_boneMatrix.multiplyMatrices(_matrixWorldInv,Bt.parent.matrixWorld),_vector$2.setFromMatrixPosition(_boneMatrix),bt.setXYZ(Mt+1,_vector$2.x,_vector$2.y,_vector$2.z),Mt+=2)}mt.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(_)}dispose(){this.geometry.dispose(),this.material.dispose()}}function getBoneList(rt){const _=[];rt.isBone===!0&&_.push(rt);for(let ut=0;ut<rt.children.length;ut++)_.push.apply(_,getBoneList(rt.children[ut]));return _}class PointLightHelper extends Mesh{constructor(_,ut,mt){const bt=new SphereGeometry(ut,4,2),St=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1});super(bt,St),this.light=_,this.color=mt,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const _vector$1=new Vector3,_color1=new Color$1,_color2=new Color$1;class HemisphereLightHelper extends Object3D{constructor(_,ut,mt){super(),this.light=_,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=mt,this.type="HemisphereLightHelper";const bt=new OctahedronGeometry(ut);bt.rotateY(Math.PI*.5),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const St=bt.getAttribute("position"),Mt=new Float32Array(St.count*3);bt.setAttribute("color",new BufferAttribute(Mt,3)),this.add(new Mesh(bt,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const _=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const ut=_.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(let mt=0,bt=ut.count;mt<bt;mt++){const St=mt<bt/2?_color1:_color2;ut.setXYZ(mt,St.r,St.g,St.b)}ut.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),_.lookAt(_vector$1.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(_=10,ut=10,mt=4473924,bt=8947848){mt=new Color$1(mt),bt=new Color$1(bt);const St=ut/2,Mt=_/ut,Bt=_/2,Ut=[],Ht=[];for(let sr=0,ar=0,cr=-Bt;sr<=ut;sr++,cr+=Mt){Ut.push(-Bt,0,cr,Bt,0,cr),Ut.push(cr,0,-Bt,cr,0,Bt);const Ar=sr===St?mt:bt;Ar.toArray(Ht,ar),ar+=3,Ar.toArray(Ht,ar),ar+=3,Ar.toArray(Ht,ar),ar+=3,Ar.toArray(Ht,ar),ar+=3}const tr=new BufferGeometry;tr.setAttribute("position",new Float32BufferAttribute(Ut,3)),tr.setAttribute("color",new Float32BufferAttribute(Ht,3));const rr=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(tr,rr),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PolarGridHelper extends LineSegments{constructor(_=10,ut=16,mt=8,bt=64,St=4473924,Mt=8947848){St=new Color$1(St),Mt=new Color$1(Mt);const Bt=[],Ut=[];if(ut>1)for(let rr=0;rr<ut;rr++){const sr=rr/ut*(Math.PI*2),ar=Math.sin(sr)*_,cr=Math.cos(sr)*_;Bt.push(0,0,0),Bt.push(ar,0,cr);const Ar=rr&1?St:Mt;Ut.push(Ar.r,Ar.g,Ar.b),Ut.push(Ar.r,Ar.g,Ar.b)}for(let rr=0;rr<mt;rr++){const sr=rr&1?St:Mt,ar=_-_/mt*rr;for(let cr=0;cr<bt;cr++){let Ar=cr/bt*(Math.PI*2),_r=Math.sin(Ar)*ar,Dr=Math.cos(Ar)*ar;Bt.push(_r,0,Dr),Ut.push(sr.r,sr.g,sr.b),Ar=(cr+1)/bt*(Math.PI*2),_r=Math.sin(Ar)*ar,Dr=Math.cos(Ar)*ar,Bt.push(_r,0,Dr),Ut.push(sr.r,sr.g,sr.b)}}const Ht=new BufferGeometry;Ht.setAttribute("position",new Float32BufferAttribute(Bt,3)),Ht.setAttribute("color",new Float32BufferAttribute(Ut,3));const tr=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(Ht,tr),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _v1=new Vector3,_v2=new Vector3,_v3=new Vector3;class DirectionalLightHelper extends Object3D{constructor(_,ut,mt){super(),this.light=_,this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.color=mt,this.type="DirectionalLightHelper",ut===void 0&&(ut=1);let bt=new BufferGeometry;bt.setAttribute("position",new Float32BufferAttribute([-ut,ut,0,ut,ut,0,ut,-ut,0,-ut,-ut,0,-ut,ut,0],3));const St=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line(bt,St),this.add(this.lightPlane),bt=new BufferGeometry,bt.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(bt,St),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_v1.setFromMatrixPosition(this.light.matrixWorld),_v2.setFromMatrixPosition(this.light.target.matrixWorld),_v3.subVectors(_v2,_v1),this.lightPlane.lookAt(_v2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2),this.targetLine.scale.z=_v3.length()}}const _vector=new Vector3,_camera=new Camera;class CameraHelper extends LineSegments{constructor(_){const ut=new BufferGeometry,mt=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),bt=[],St=[],Mt={};Bt("n1","n2"),Bt("n2","n4"),Bt("n4","n3"),Bt("n3","n1"),Bt("f1","f2"),Bt("f2","f4"),Bt("f4","f3"),Bt("f3","f1"),Bt("n1","f1"),Bt("n2","f2"),Bt("n3","f3"),Bt("n4","f4"),Bt("p","n1"),Bt("p","n2"),Bt("p","n3"),Bt("p","n4"),Bt("u1","u2"),Bt("u2","u3"),Bt("u3","u1"),Bt("c","t"),Bt("p","c"),Bt("cn1","cn2"),Bt("cn3","cn4"),Bt("cf1","cf2"),Bt("cf3","cf4");function Bt(cr,Ar){Ut(cr),Ut(Ar)}function Ut(cr){bt.push(0,0,0),St.push(0,0,0),Mt[cr]===void 0&&(Mt[cr]=[]),Mt[cr].push(bt.length/3-1)}ut.setAttribute("position",new Float32BufferAttribute(bt,3)),ut.setAttribute("color",new Float32BufferAttribute(St,3)),super(ut,mt),this.type="CameraHelper",this.camera=_,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=_.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=Mt,this.update();const Ht=new Color$1(16755200),tr=new Color$1(16711680),rr=new Color$1(43775),sr=new Color$1(16777215),ar=new Color$1(3355443);this.setColors(Ht,tr,rr,sr,ar)}setColors(_,ut,mt,bt,St){const Bt=this.geometry.getAttribute("color");Bt.setXYZ(0,_.r,_.g,_.b),Bt.setXYZ(1,_.r,_.g,_.b),Bt.setXYZ(2,_.r,_.g,_.b),Bt.setXYZ(3,_.r,_.g,_.b),Bt.setXYZ(4,_.r,_.g,_.b),Bt.setXYZ(5,_.r,_.g,_.b),Bt.setXYZ(6,_.r,_.g,_.b),Bt.setXYZ(7,_.r,_.g,_.b),Bt.setXYZ(8,_.r,_.g,_.b),Bt.setXYZ(9,_.r,_.g,_.b),Bt.setXYZ(10,_.r,_.g,_.b),Bt.setXYZ(11,_.r,_.g,_.b),Bt.setXYZ(12,_.r,_.g,_.b),Bt.setXYZ(13,_.r,_.g,_.b),Bt.setXYZ(14,_.r,_.g,_.b),Bt.setXYZ(15,_.r,_.g,_.b),Bt.setXYZ(16,_.r,_.g,_.b),Bt.setXYZ(17,_.r,_.g,_.b),Bt.setXYZ(18,_.r,_.g,_.b),Bt.setXYZ(19,_.r,_.g,_.b),Bt.setXYZ(20,_.r,_.g,_.b),Bt.setXYZ(21,_.r,_.g,_.b),Bt.setXYZ(22,_.r,_.g,_.b),Bt.setXYZ(23,_.r,_.g,_.b),Bt.setXYZ(24,ut.r,ut.g,ut.b),Bt.setXYZ(25,ut.r,ut.g,ut.b),Bt.setXYZ(26,ut.r,ut.g,ut.b),Bt.setXYZ(27,ut.r,ut.g,ut.b),Bt.setXYZ(28,ut.r,ut.g,ut.b),Bt.setXYZ(29,ut.r,ut.g,ut.b),Bt.setXYZ(30,ut.r,ut.g,ut.b),Bt.setXYZ(31,ut.r,ut.g,ut.b),Bt.setXYZ(32,mt.r,mt.g,mt.b),Bt.setXYZ(33,mt.r,mt.g,mt.b),Bt.setXYZ(34,mt.r,mt.g,mt.b),Bt.setXYZ(35,mt.r,mt.g,mt.b),Bt.setXYZ(36,mt.r,mt.g,mt.b),Bt.setXYZ(37,mt.r,mt.g,mt.b),Bt.setXYZ(38,bt.r,bt.g,bt.b),Bt.setXYZ(39,bt.r,bt.g,bt.b),Bt.setXYZ(40,St.r,St.g,St.b),Bt.setXYZ(41,St.r,St.g,St.b),Bt.setXYZ(42,St.r,St.g,St.b),Bt.setXYZ(43,St.r,St.g,St.b),Bt.setXYZ(44,St.r,St.g,St.b),Bt.setXYZ(45,St.r,St.g,St.b),Bt.setXYZ(46,St.r,St.g,St.b),Bt.setXYZ(47,St.r,St.g,St.b),Bt.setXYZ(48,St.r,St.g,St.b),Bt.setXYZ(49,St.r,St.g,St.b),Bt.needsUpdate=!0}update(){const _=this.geometry,ut=this.pointMap,mt=1,bt=1;_camera.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",ut,_,_camera,0,0,-1),setPoint("t",ut,_,_camera,0,0,1),setPoint("n1",ut,_,_camera,-mt,-bt,-1),setPoint("n2",ut,_,_camera,mt,-bt,-1),setPoint("n3",ut,_,_camera,-mt,bt,-1),setPoint("n4",ut,_,_camera,mt,bt,-1),setPoint("f1",ut,_,_camera,-mt,-bt,1),setPoint("f2",ut,_,_camera,mt,-bt,1),setPoint("f3",ut,_,_camera,-mt,bt,1),setPoint("f4",ut,_,_camera,mt,bt,1),setPoint("u1",ut,_,_camera,mt*.7,bt*1.1,-1),setPoint("u2",ut,_,_camera,-mt*.7,bt*1.1,-1),setPoint("u3",ut,_,_camera,0,bt*2,-1),setPoint("cf1",ut,_,_camera,-mt,0,1),setPoint("cf2",ut,_,_camera,mt,0,1),setPoint("cf3",ut,_,_camera,0,-bt,1),setPoint("cf4",ut,_,_camera,0,bt,1),setPoint("cn1",ut,_,_camera,-mt,0,-1),setPoint("cn2",ut,_,_camera,mt,0,-1),setPoint("cn3",ut,_,_camera,0,-bt,-1),setPoint("cn4",ut,_,_camera,0,bt,-1),_.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function setPoint(rt,_,ut,mt,bt,St,Mt){_vector.set(bt,St,Mt).unproject(mt);const Bt=_[rt];if(Bt!==void 0){const Ut=ut.getAttribute("position");for(let Ht=0,tr=Bt.length;Ht<tr;Ht++)Ut.setXYZ(Bt[Ht],_vector.x,_vector.y,_vector.z)}}const _box=new Box3;class BoxHelper extends LineSegments{constructor(_,ut=16776960){const mt=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),bt=new Float32Array(8*3),St=new BufferGeometry;St.setIndex(new BufferAttribute(mt,1)),St.setAttribute("position",new BufferAttribute(bt,3)),super(St,new LineBasicMaterial({color:ut,toneMapped:!1})),this.object=_,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(_){if(_!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_box.setFromObject(this.object),_box.isEmpty())return;const ut=_box.min,mt=_box.max,bt=this.geometry.attributes.position,St=bt.array;St[0]=mt.x,St[1]=mt.y,St[2]=mt.z,St[3]=ut.x,St[4]=mt.y,St[5]=mt.z,St[6]=ut.x,St[7]=ut.y,St[8]=mt.z,St[9]=mt.x,St[10]=ut.y,St[11]=mt.z,St[12]=mt.x,St[13]=mt.y,St[14]=ut.z,St[15]=ut.x,St[16]=mt.y,St[17]=ut.z,St[18]=ut.x,St[19]=ut.y,St[20]=ut.z,St[21]=mt.x,St[22]=ut.y,St[23]=ut.z,bt.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(_){return this.object=_,this.update(),this}copy(_,ut){return super.copy(_,ut),this.object=_.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Box3Helper extends LineSegments{constructor(_,ut=16776960){const mt=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),bt=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],St=new BufferGeometry;St.setIndex(new BufferAttribute(mt,1)),St.setAttribute("position",new Float32BufferAttribute(bt,3)),super(St,new LineBasicMaterial({color:ut,toneMapped:!1})),this.box=_,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(_){const ut=this.box;ut.isEmpty()||(ut.getCenter(this.position),ut.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(_))}dispose(){this.geometry.dispose(),this.material.dispose()}}class PlaneHelper extends Line{constructor(_,ut=1,mt=16776960){const bt=mt,St=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],Mt=new BufferGeometry;Mt.setAttribute("position",new Float32BufferAttribute(St,3)),Mt.computeBoundingSphere(),super(Mt,new LineBasicMaterial({color:bt,toneMapped:!1})),this.type="PlaneHelper",this.plane=_,this.size=ut;const Bt=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],Ut=new BufferGeometry;Ut.setAttribute("position",new Float32BufferAttribute(Bt,3)),Ut.computeBoundingSphere(),this.add(new Mesh(Ut,new MeshBasicMaterial({color:bt,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(_){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(_)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const _axis=new Vector3;let _lineGeometry,_coneGeometry;class ArrowHelper extends Object3D{constructor(_=new Vector3(0,0,1),ut=new Vector3(0,0,0),mt=1,bt=16776960,St=mt*.2,Mt=St*.2){super(),this.type="ArrowHelper",_lineGeometry===void 0&&(_lineGeometry=new BufferGeometry,_lineGeometry.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),_coneGeometry=new CylinderGeometry(0,.5,1,5,1),_coneGeometry.translate(0,-.5,0)),this.position.copy(ut),this.line=new Line(_lineGeometry,new LineBasicMaterial({color:bt,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:bt,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(_),this.setLength(mt,St,Mt)}setDirection(_){if(_.y>.99999)this.quaternion.set(0,0,0,1);else if(_.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis.set(_.z,0,-_.x).normalize();const ut=Math.acos(_.y);this.quaternion.setFromAxisAngle(_axis,ut)}}setLength(_,ut=_*.2,mt=ut*.2){this.line.scale.set(1,Math.max(1e-4,_-ut),1),this.line.updateMatrix(),this.cone.scale.set(mt,ut,mt),this.cone.position.y=_,this.cone.updateMatrix()}setColor(_){this.line.material.color.set(_),this.cone.material.color.set(_)}copy(_){return super.copy(_,!1),this.line.copy(_.line),this.cone.copy(_.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class AxesHelper extends LineSegments{constructor(_=1){const ut=[0,0,0,_,0,0,0,0,0,0,_,0,0,0,0,0,0,_],mt=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],bt=new BufferGeometry;bt.setAttribute("position",new Float32BufferAttribute(ut,3)),bt.setAttribute("color",new Float32BufferAttribute(mt,3));const St=new LineBasicMaterial({vertexColors:!0,toneMapped:!1});super(bt,St),this.type="AxesHelper"}setColors(_,ut,mt){const bt=new Color$1,St=this.geometry.attributes.color.array;return bt.set(_),bt.toArray(St,0),bt.toArray(St,3),bt.set(ut),bt.toArray(St,6),bt.toArray(St,9),bt.set(mt),bt.toArray(St,12),bt.toArray(St,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath",this.color=new Color$1,this.subPaths=[],this.currentPath=null}moveTo(_,ut){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(_,ut),this}lineTo(_,ut){return this.currentPath.lineTo(_,ut),this}quadraticCurveTo(_,ut,mt,bt){return this.currentPath.quadraticCurveTo(_,ut,mt,bt),this}bezierCurveTo(_,ut,mt,bt,St,Mt){return this.currentPath.bezierCurveTo(_,ut,mt,bt,St,Mt),this}splineThru(_){return this.currentPath.splineThru(_),this}toShapes(_){function ut(Dr){const $r=[];for(let Br=0,Jr=Dr.length;Br<Jr;Br++){const mn=Dr[Br],Mn=new Shape;Mn.curves=mn.curves,$r.push(Mn)}return $r}function mt(Dr,$r){const Br=$r.length;let Jr=!1;for(let mn=Br-1,Mn=0;Mn<Br;mn=Mn++){let $n=$r[mn],en=$r[Mn],In=en.x-$n.x,Rn=en.y-$n.y;if(Math.abs(Rn)>Number.EPSILON){if(Rn<0&&($n=$r[Mn],In=-In,en=$r[mn],Rn=-Rn),Dr.y<$n.y||Dr.y>en.y)continue;if(Dr.y===$n.y){if(Dr.x===$n.x)return!0}else{const qn=Rn*(Dr.x-$n.x)-In*(Dr.y-$n.y);if(qn===0)return!0;if(qn<0)continue;Jr=!Jr}}else{if(Dr.y!==$n.y)continue;if(en.x<=Dr.x&&Dr.x<=$n.x||$n.x<=Dr.x&&Dr.x<=en.x)return!0}}return Jr}const bt=ShapeUtils.isClockWise,St=this.subPaths;if(St.length===0)return[];let Mt,Bt,Ut;const Ht=[];if(St.length===1)return Bt=St[0],Ut=new Shape,Ut.curves=Bt.curves,Ht.push(Ut),Ht;let tr=!bt(St[0].getPoints());tr=_?!tr:tr;const rr=[],sr=[];let ar=[],cr=0,Ar;sr[cr]=void 0,ar[cr]=[];for(let Dr=0,$r=St.length;Dr<$r;Dr++)Bt=St[Dr],Ar=Bt.getPoints(),Mt=bt(Ar),Mt=_?!Mt:Mt,Mt?(!tr&&sr[cr]&&cr++,sr[cr]={s:new Shape,p:Ar},sr[cr].s.curves=Bt.curves,tr&&cr++,ar[cr]=[]):ar[cr].push({h:Bt,p:Ar[0]});if(!sr[0])return ut(St);if(sr.length>1){let Dr=!1,$r=0;for(let Br=0,Jr=sr.length;Br<Jr;Br++)rr[Br]=[];for(let Br=0,Jr=sr.length;Br<Jr;Br++){const mn=ar[Br];for(let Mn=0;Mn<mn.length;Mn++){const $n=mn[Mn];let en=!0;for(let In=0;In<sr.length;In++)mt($n.p,sr[In].p)&&(Br!==In&&$r++,en?(en=!1,rr[In].push($n)):Dr=!0);en&&rr[Br].push($n)}}$r>0&&Dr===!1&&(ar=rr)}let _r;for(let Dr=0,$r=sr.length;Dr<$r;Dr++){Ut=sr[Dr].s,Ht.push(Ut),_r=ar[Dr];for(let Br=0,Jr=_r.length;Br<Jr;Br++)Ut.holes.push(_r[Br].h)}return Ht}}const _tables=_generateTables();function _generateTables(){const rt=new ArrayBuffer(4),_=new Float32Array(rt),ut=new Uint32Array(rt),mt=new Uint32Array(512),bt=new Uint32Array(512);for(let Ut=0;Ut<256;++Ut){const Ht=Ut-127;Ht<-27?(mt[Ut]=0,mt[Ut|256]=32768,bt[Ut]=24,bt[Ut|256]=24):Ht<-14?(mt[Ut]=1024>>-Ht-14,mt[Ut|256]=1024>>-Ht-14|32768,bt[Ut]=-Ht-1,bt[Ut|256]=-Ht-1):Ht<=15?(mt[Ut]=Ht+15<<10,mt[Ut|256]=Ht+15<<10|32768,bt[Ut]=13,bt[Ut|256]=13):Ht<128?(mt[Ut]=31744,mt[Ut|256]=64512,bt[Ut]=24,bt[Ut|256]=24):(mt[Ut]=31744,mt[Ut|256]=64512,bt[Ut]=13,bt[Ut|256]=13)}const St=new Uint32Array(2048),Mt=new Uint32Array(64),Bt=new Uint32Array(64);for(let Ut=1;Ut<1024;++Ut){let Ht=Ut<<13,tr=0;for(;!(Ht&8388608);)Ht<<=1,tr-=8388608;Ht&=-8388609,tr+=947912704,St[Ut]=Ht|tr}for(let Ut=1024;Ut<2048;++Ut)St[Ut]=939524096+(Ut-1024<<13);for(let Ut=1;Ut<31;++Ut)Mt[Ut]=Ut<<23;Mt[31]=1199570944,Mt[32]=2147483648;for(let Ut=33;Ut<63;++Ut)Mt[Ut]=2147483648+(Ut-32<<23);Mt[63]=3347054592;for(let Ut=1;Ut<64;++Ut)Ut!==32&&(Bt[Ut]=1024);return{floatView:_,uint32View:ut,baseTable:mt,shiftTable:bt,mantissaTable:St,exponentTable:Mt,offsetTable:Bt}}function toHalfFloat(rt){Math.abs(rt)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),rt=clamp$7(rt,-65504,65504),_tables.floatView[0]=rt;const _=_tables.uint32View[0],ut=_>>23&511;return _tables.baseTable[ut]+((_&8388607)>>_tables.shiftTable[ut])}function fromHalfFloat(rt){const _=rt>>10;return _tables.uint32View[0]=_tables.mantissaTable[_tables.offsetTable[_]+(rt&1023)]+_tables.exponentTable[_],_tables.floatView[0]}const DataUtils={toHalfFloat,fromHalfFloat};class BoxBufferGeometry extends BoxGeometry{constructor(_,ut,mt,bt,St,Mt){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(_,ut,mt,bt,St,Mt)}}class CapsuleBufferGeometry extends CapsuleGeometry{constructor(_,ut,mt,bt){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(_,ut,mt,bt)}}class CircleBufferGeometry extends CircleGeometry{constructor(_,ut,mt,bt){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(_,ut,mt,bt)}}class ConeBufferGeometry extends ConeGeometry{constructor(_,ut,mt,bt,St,Mt,Bt){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(_,ut,mt,bt,St,Mt,Bt)}}class CylinderBufferGeometry extends CylinderGeometry{constructor(_,ut,mt,bt,St,Mt,Bt,Ut){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(_,ut,mt,bt,St,Mt,Bt,Ut)}}class DodecahedronBufferGeometry extends DodecahedronGeometry{constructor(_,ut){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(_,ut)}}class ExtrudeBufferGeometry extends ExtrudeGeometry{constructor(_,ut){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(_,ut)}}class IcosahedronBufferGeometry extends IcosahedronGeometry{constructor(_,ut){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(_,ut)}}class LatheBufferGeometry extends LatheGeometry{constructor(_,ut,mt,bt){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(_,ut,mt,bt)}}class OctahedronBufferGeometry extends OctahedronGeometry{constructor(_,ut){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(_,ut)}}class PlaneBufferGeometry extends PlaneGeometry{constructor(_,ut,mt,bt){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(_,ut,mt,bt)}}class PolyhedronBufferGeometry extends PolyhedronGeometry{constructor(_,ut,mt,bt){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(_,ut,mt,bt)}}class RingBufferGeometry extends RingGeometry{constructor(_,ut,mt,bt,St,Mt){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(_,ut,mt,bt,St,Mt)}}class ShapeBufferGeometry extends ShapeGeometry{constructor(_,ut){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(_,ut)}}class SphereBufferGeometry extends SphereGeometry{constructor(_,ut,mt,bt,St,Mt,Bt){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(_,ut,mt,bt,St,Mt,Bt)}}class TetrahedronBufferGeometry extends TetrahedronGeometry{constructor(_,ut){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(_,ut)}}class TorusBufferGeometry extends TorusGeometry{constructor(_,ut,mt,bt,St){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(_,ut,mt,bt,St)}}class TorusKnotBufferGeometry extends TorusKnotGeometry{constructor(_,ut,mt,bt,St,Mt){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(_,ut,mt,bt,St,Mt)}}class TubeBufferGeometry extends TubeGeometry{constructor(_,ut,mt,bt,St){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(_,ut,mt,bt,St)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);const THREE=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping,AddEquation,AddOperation,AdditiveAnimationBlendMode,AdditiveBlending,AlphaFormat,AlwaysDepth,AlwaysStencilFunc,AmbientLight,AmbientLightProbe,AnimationClip,AnimationLoader,AnimationMixer,AnimationObjectGroup,AnimationUtils,ArcCurve,ArrayCamera,ArrowHelper,Audio:Audio$1,AudioAnalyser,AudioContext:AudioContext$1,AudioListener,AudioLoader,AxesHelper,BackSide,BasicDepthPacking,BasicShadowMap,Bone,BooleanKeyframeTrack,Box2,Box3,Box3Helper,BoxBufferGeometry,BoxGeometry,BoxHelper,BufferAttribute,BufferGeometry,BufferGeometryLoader,ByteType,Cache,Camera,CameraHelper,CanvasTexture,CapsuleBufferGeometry,CapsuleGeometry,CatmullRomCurve3,CineonToneMapping,CircleBufferGeometry,CircleGeometry,ClampToEdgeWrapping,Clock:Clock$1,Color:Color$1,ColorKeyframeTrack,ColorManagement,CompressedArrayTexture,CompressedTexture,CompressedTextureLoader,ConeBufferGeometry,ConeGeometry,CubeCamera,CubeReflectionMapping,CubeRefractionMapping,CubeTexture,CubeTextureLoader,CubeUVReflectionMapping,CubicBezierCurve,CubicBezierCurve3,CubicInterpolant,CullFaceBack,CullFaceFront,CullFaceFrontBack,CullFaceNone,Curve,CurvePath,CustomBlending,CustomToneMapping,CylinderBufferGeometry,CylinderGeometry,Cylindrical,Data3DTexture,DataArrayTexture,DataTexture,DataTextureLoader,DataUtils,DecrementStencilOp,DecrementWrapStencilOp,DefaultLoadingManager,DepthFormat,DepthStencilFormat,DepthTexture,DirectionalLight,DirectionalLightHelper,DiscreteInterpolant,DisplayP3ColorSpace,DodecahedronBufferGeometry,DodecahedronGeometry,DoubleSide,DstAlphaFactor,DstColorFactor,DynamicCopyUsage,DynamicDrawUsage,DynamicReadUsage,EdgesGeometry,EllipseCurve,EqualDepth,EqualStencilFunc,EquirectangularReflectionMapping,EquirectangularRefractionMapping,Euler,EventDispatcher,ExtrudeBufferGeometry,ExtrudeGeometry,FileLoader,Float16BufferAttribute,Float32BufferAttribute,Float64BufferAttribute,FloatType,Fog,FogExp2,FramebufferTexture,FrontSide,Frustum,GLBufferAttribute,GLSL1,GLSL3,GreaterDepth,GreaterEqualDepth,GreaterEqualStencilFunc,GreaterStencilFunc,GridHelper,Group:Group$1,HalfFloatType,HemisphereLight,HemisphereLightHelper,HemisphereLightProbe,IcosahedronBufferGeometry,IcosahedronGeometry,ImageBitmapLoader,ImageLoader,ImageUtils,IncrementStencilOp,IncrementWrapStencilOp,InstancedBufferAttribute,InstancedBufferGeometry,InstancedInterleavedBuffer,InstancedMesh,Int16BufferAttribute,Int32BufferAttribute,Int8BufferAttribute,IntType,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,InterpolateSmooth,InvertStencilOp,KeepStencilOp,KeyframeTrack,LOD,LatheBufferGeometry,LatheGeometry,Layers,LessDepth,LessEqualDepth,LessEqualStencilFunc,LessStencilFunc,Light,LightProbe,Line,Line3,LineBasicMaterial,LineCurve,LineCurve3,LineDashedMaterial,LineLoop,LineSegments,LinearEncoding:LinearEncoding$1,LinearFilter,LinearInterpolant,LinearMipMapLinearFilter,LinearMipMapNearestFilter,LinearMipmapLinearFilter,LinearMipmapNearestFilter,LinearSRGBColorSpace,LinearToneMapping,Loader,LoaderUtils,LoadingManager,LoopOnce,LoopPingPong,LoopRepeat,LuminanceAlphaFormat,LuminanceFormat,MOUSE,Material,MaterialLoader,MathUtils,Matrix3,Matrix4,MaxEquation,Mesh,MeshBasicMaterial,MeshDepthMaterial,MeshDistanceMaterial,MeshLambertMaterial,MeshMatcapMaterial,MeshNormalMaterial,MeshPhongMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MeshToonMaterial,MinEquation,MirroredRepeatWrapping,MixOperation,MultiplyBlending,MultiplyOperation,NearestFilter,NearestMipMapLinearFilter,NearestMipMapNearestFilter,NearestMipmapLinearFilter,NearestMipmapNearestFilter,NeverDepth,NeverStencilFunc,NoBlending,NoColorSpace,NoToneMapping,NormalAnimationBlendMode,NormalBlending,NotEqualDepth,NotEqualStencilFunc,NumberKeyframeTrack,Object3D,ObjectLoader,ObjectSpaceNormalMap,OctahedronBufferGeometry,OctahedronGeometry,OneFactor,OneMinusDstAlphaFactor,OneMinusDstColorFactor,OneMinusSrcAlphaFactor,OneMinusSrcColorFactor,OrthographicCamera:OrthographicCamera$1,PCFShadowMap,PCFSoftShadowMap,PMREMGenerator,Path,PerspectiveCamera:PerspectiveCamera$1,Plane,PlaneBufferGeometry,PlaneGeometry,PlaneHelper,PointLight,PointLightHelper,Points,PointsMaterial,PolarGridHelper,PolyhedronBufferGeometry,PolyhedronGeometry,PositionalAudio,PropertyBinding,PropertyMixer,QuadraticBezierCurve,QuadraticBezierCurve3,Quaternion,QuaternionKeyframeTrack,QuaternionLinearInterpolant,RED_GREEN_RGTC2_Format,RED_RGTC1_Format,REVISION,RGBADepthPacking,RGBAFormat,RGBAIntegerFormat,RGBA_ASTC_10x10_Format,RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format,RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format,RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format,RGBA_BPTC_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT1_Format,RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT5_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format,RGB_S3TC_DXT1_Format,RGFormat,RGIntegerFormat,RawShaderMaterial,Ray,Raycaster,RectAreaLight,RedFormat,RedIntegerFormat,ReinhardToneMapping,RepeatWrapping,ReplaceStencilOp,ReverseSubtractEquation,RingBufferGeometry,RingGeometry,SIGNED_RED_GREEN_RGTC2_Format,SIGNED_RED_RGTC1_Format,SRGBColorSpace,Scene:Scene$3,ShaderChunk,ShaderLib,ShaderMaterial,ShadowMaterial,Shape,ShapeBufferGeometry,ShapeGeometry,ShapePath,ShapeUtils,ShortType,Skeleton,SkeletonHelper,SkinnedMesh,Source,Sphere:Sphere$1,SphereBufferGeometry,SphereGeometry,Spherical,SphericalHarmonics3,SplineCurve,SpotLight,SpotLightHelper,Sprite,SpriteMaterial,SrcAlphaFactor,SrcAlphaSaturateFactor,SrcColorFactor,StaticCopyUsage,StaticDrawUsage,StaticReadUsage,StereoCamera,StreamCopyUsage,StreamDrawUsage,StreamReadUsage,StringKeyframeTrack,SubtractEquation,SubtractiveBlending,TOUCH,TangentSpaceNormalMap,TetrahedronBufferGeometry,TetrahedronGeometry,Texture,TextureLoader,TorusBufferGeometry,TorusGeometry,TorusKnotBufferGeometry,TorusKnotGeometry,Triangle,TriangleFanDrawMode,TriangleStripDrawMode,TrianglesDrawMode,TubeBufferGeometry,TubeGeometry,TwoPassDoubleSide,UVMapping,Uint16BufferAttribute,Uint32BufferAttribute,Uint8BufferAttribute,Uint8ClampedBufferAttribute,Uniform,UniformsGroup,UniformsLib,UniformsUtils,UnsignedByteType,UnsignedInt248Type,UnsignedIntType,UnsignedShort4444Type,UnsignedShort5551Type,UnsignedShortType,VSMShadowMap,Vector2,Vector3,Vector4,VectorKeyframeTrack,VideoTexture,WebGL1Renderer,WebGL3DRenderTarget,WebGLArrayRenderTarget,WebGLCubeRenderTarget,WebGLMultipleRenderTargets,WebGLRenderTarget,WebGLRenderer,WebGLUtils,WireframeGeometry,WrapAroundEnding,ZeroCurvatureEnding,ZeroFactor,ZeroSlopeEnding,ZeroStencilOp,_SRGBAFormat,sRGBEncoding:sRGBEncoding$1},Symbol.toStringTag,{value:"Module"}));var constants={exports:{}},reactReconcilerConstants_production_min={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */reactReconcilerConstants_production_min.ConcurrentRoot=1;reactReconcilerConstants_production_min.ContinuousEventPriority=4;reactReconcilerConstants_production_min.DefaultEventPriority=16;reactReconcilerConstants_production_min.DiscreteEventPriority=1;reactReconcilerConstants_production_min.IdleEventPriority=536870912;reactReconcilerConstants_production_min.LegacyRoot=0;constants.exports=reactReconcilerConstants_production_min;var constantsExports=constants.exports;function createStore$1(rt){let _;const ut=new Set,mt=(Ht,tr)=>{const rr=typeof Ht=="function"?Ht(_):Ht;if(rr!==_){const sr=_;_=tr?rr:Object.assign({},_,rr),ut.forEach(ar=>ar(_,sr))}},bt=()=>_,St=(Ht,tr=bt,rr=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let sr=tr(_);function ar(){const cr=tr(_);if(!rr(sr,cr)){const Ar=sr;Ht(sr=cr,Ar)}}return ut.add(ar),()=>ut.delete(ar)},Ut={setState:mt,getState:bt,subscribe:(Ht,tr,rr)=>tr||rr?St(Ht,tr,rr):(ut.add(Ht),()=>ut.delete(Ht)),destroy:()=>ut.clear()};return _=rt(mt,bt,Ut),Ut}const isSSR$1=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),useIsomorphicLayoutEffect$3=isSSR$1?reactExports.useEffect:reactExports.useLayoutEffect;function create$1(rt){const _=typeof rt=="function"?createStore$1(rt):rt,ut=(mt=_.getState,bt=Object.is)=>{const[,St]=reactExports.useReducer(_r=>_r+1,0),Mt=_.getState(),Bt=reactExports.useRef(Mt),Ut=reactExports.useRef(mt),Ht=reactExports.useRef(bt),tr=reactExports.useRef(!1),rr=reactExports.useRef();rr.current===void 0&&(rr.current=mt(Mt));let sr,ar=!1;(Bt.current!==Mt||Ut.current!==mt||Ht.current!==bt||tr.current)&&(sr=mt(Mt),ar=!bt(rr.current,sr)),useIsomorphicLayoutEffect$3(()=>{ar&&(rr.current=sr),Bt.current=Mt,Ut.current=mt,Ht.current=bt,tr.current=!1});const cr=reactExports.useRef(Mt);useIsomorphicLayoutEffect$3(()=>{const _r=()=>{try{const $r=_.getState(),Br=Ut.current($r);Ht.current(rr.current,Br)||(Bt.current=$r,rr.current=Br,St())}catch{tr.current=!0,St()}},Dr=_.subscribe(_r);return _.getState()!==cr.current&&_r(),Dr},[]);const Ar=ar?sr:rr.current;return reactExports.useDebugValue(Ar),Ar};return Object.assign(ut,_),ut[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const mt=[ut,_];return{next(){const bt=mt.length<=0;return{value:mt.shift(),done:bt}}}},ut}var reactReconciler={exports:{}},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(rt){function _(Ss,eo){var Ao=Ss.length;Ss.push(eo);e:for(;0<Ao;){var Oo=Ao-1>>>1,uo=Ss[Oo];if(0<bt(uo,eo))Ss[Oo]=eo,Ss[Ao]=uo,Ao=Oo;else break e}}function ut(Ss){return Ss.length===0?null:Ss[0]}function mt(Ss){if(Ss.length===0)return null;var eo=Ss[0],Ao=Ss.pop();if(Ao!==eo){Ss[0]=Ao;e:for(var Oo=0,uo=Ss.length,uu=uo>>>1;Oo<uu;){var cu=2*(Oo+1)-1,Jl=Ss[cu],mu=cu+1,pu=Ss[mu];if(0>bt(Jl,Ao))mu<uo&&0>bt(pu,Jl)?(Ss[Oo]=pu,Ss[mu]=Ao,Oo=mu):(Ss[Oo]=Jl,Ss[cu]=Ao,Oo=cu);else if(mu<uo&&0>bt(pu,Ao))Ss[Oo]=pu,Ss[mu]=Ao,Oo=mu;else break e}}return eo}function bt(Ss,eo){var Ao=Ss.sortIndex-eo.sortIndex;return Ao!==0?Ao:Ss.id-eo.id}if(typeof performance=="object"&&typeof performance.now=="function"){var St=performance;rt.unstable_now=function(){return St.now()}}else{var Mt=Date,Bt=Mt.now();rt.unstable_now=function(){return Mt.now()-Bt}}var Ut=[],Ht=[],tr=1,rr=null,sr=3,ar=!1,cr=!1,Ar=!1,_r=typeof setTimeout=="function"?setTimeout:null,Dr=typeof clearTimeout=="function"?clearTimeout:null,$r=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Br(Ss){for(var eo=ut(Ht);eo!==null;){if(eo.callback===null)mt(Ht);else if(eo.startTime<=Ss)mt(Ht),eo.sortIndex=eo.expirationTime,_(Ut,eo);else break;eo=ut(Ht)}}function Jr(Ss){if(Ar=!1,Br(Ss),!cr)if(ut(Ut)!==null)cr=!0,_o(mn);else{var eo=ut(Ht);eo!==null&&qs(Jr,eo.startTime-Ss)}}function mn(Ss,eo){cr=!1,Ar&&(Ar=!1,Dr(en),en=-1),ar=!0;var Ao=sr;try{for(Br(eo),rr=ut(Ut);rr!==null&&(!(rr.expirationTime>eo)||Ss&&!qn());){var Oo=rr.callback;if(typeof Oo=="function"){rr.callback=null,sr=rr.priorityLevel;var uo=Oo(rr.expirationTime<=eo);eo=rt.unstable_now(),typeof uo=="function"?rr.callback=uo:rr===ut(Ut)&&mt(Ut),Br(eo)}else mt(Ut);rr=ut(Ut)}if(rr!==null)var uu=!0;else{var cu=ut(Ht);cu!==null&&qs(Jr,cu.startTime-eo),uu=!1}return uu}finally{rr=null,sr=Ao,ar=!1}}var Mn=!1,$n=null,en=-1,In=5,Rn=-1;function qn(){return!(rt.unstable_now()-Rn<In)}function Qn(){if($n!==null){var Ss=rt.unstable_now();Rn=Ss;var eo=!0;try{eo=$n(!0,Ss)}finally{eo?xs():(Mn=!1,$n=null)}}else Mn=!1}var xs;if(typeof $r=="function")xs=function(){$r(Qn)};else if(typeof MessageChannel<"u"){var cs=new MessageChannel,ks=cs.port2;cs.port1.onmessage=Qn,xs=function(){ks.postMessage(null)}}else xs=function(){_r(Qn,0)};function _o(Ss){$n=Ss,Mn||(Mn=!0,xs())}function qs(Ss,eo){en=_r(function(){Ss(rt.unstable_now())},eo)}rt.unstable_IdlePriority=5,rt.unstable_ImmediatePriority=1,rt.unstable_LowPriority=4,rt.unstable_NormalPriority=3,rt.unstable_Profiling=null,rt.unstable_UserBlockingPriority=2,rt.unstable_cancelCallback=function(Ss){Ss.callback=null},rt.unstable_continueExecution=function(){cr||ar||(cr=!0,_o(mn))},rt.unstable_forceFrameRate=function(Ss){0>Ss||125<Ss?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):In=0<Ss?Math.floor(1e3/Ss):5},rt.unstable_getCurrentPriorityLevel=function(){return sr},rt.unstable_getFirstCallbackNode=function(){return ut(Ut)},rt.unstable_next=function(Ss){switch(sr){case 1:case 2:case 3:var eo=3;break;default:eo=sr}var Ao=sr;sr=eo;try{return Ss()}finally{sr=Ao}},rt.unstable_pauseExecution=function(){},rt.unstable_requestPaint=function(){},rt.unstable_runWithPriority=function(Ss,eo){switch(Ss){case 1:case 2:case 3:case 4:case 5:break;default:Ss=3}var Ao=sr;sr=Ss;try{return eo()}finally{sr=Ao}},rt.unstable_scheduleCallback=function(Ss,eo,Ao){var Oo=rt.unstable_now();switch(typeof Ao=="object"&&Ao!==null?(Ao=Ao.delay,Ao=typeof Ao=="number"&&0<Ao?Oo+Ao:Oo):Ao=Oo,Ss){case 1:var uo=-1;break;case 2:uo=250;break;case 5:uo=1073741823;break;case 4:uo=1e4;break;default:uo=5e3}return uo=Ao+uo,Ss={id:tr++,callback:eo,priorityLevel:Ss,startTime:Ao,expirationTime:uo,sortIndex:-1},Ao>Oo?(Ss.sortIndex=Ao,_(Ht,Ss),ut(Ut)===null&&Ss===ut(Ht)&&(Ar?(Dr(en),en=-1):Ar=!0,qs(Jr,Ao-Oo))):(Ss.sortIndex=uo,_(Ut,Ss),cr||ar||(cr=!0,_o(mn))),Ss},rt.unstable_shouldYield=qn,rt.unstable_wrapCallback=function(Ss){var eo=sr;return function(){var Ao=sr;sr=eo;try{return Ss.apply(this,arguments)}finally{sr=Ao}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var reactReconciler_production_min=function rt(_){var ut={},mt=reactExports,bt=schedulerExports,St=Object.assign;function Mt(Nr){for(var Xr="https://reactjs.org/docs/error-decoder.html?invariant="+Nr,Fn=1;Fn<arguments.length;Fn++)Xr+="&args[]="+encodeURIComponent(arguments[Fn]);return"Minified React error #"+Nr+"; visit "+Xr+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Bt=mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ut=Symbol.for("react.element"),Ht=Symbol.for("react.portal"),tr=Symbol.for("react.fragment"),rr=Symbol.for("react.strict_mode"),sr=Symbol.for("react.profiler"),ar=Symbol.for("react.provider"),cr=Symbol.for("react.context"),Ar=Symbol.for("react.forward_ref"),_r=Symbol.for("react.suspense"),Dr=Symbol.for("react.suspense_list"),$r=Symbol.for("react.memo"),Br=Symbol.for("react.lazy"),Jr=Symbol.for("react.offscreen"),mn=Symbol.iterator;function Mn(Nr){return Nr===null||typeof Nr!="object"?null:(Nr=mn&&Nr[mn]||Nr["@@iterator"],typeof Nr=="function"?Nr:null)}function $n(Nr){if(Nr==null)return null;if(typeof Nr=="function")return Nr.displayName||Nr.name||null;if(typeof Nr=="string")return Nr;switch(Nr){case tr:return"Fragment";case Ht:return"Portal";case sr:return"Profiler";case rr:return"StrictMode";case _r:return"Suspense";case Dr:return"SuspenseList"}if(typeof Nr=="object")switch(Nr.$$typeof){case cr:return(Nr.displayName||"Context")+".Consumer";case ar:return(Nr._context.displayName||"Context")+".Provider";case Ar:var Xr=Nr.render;return Nr=Nr.displayName,Nr||(Nr=Xr.displayName||Xr.name||"",Nr=Nr!==""?"ForwardRef("+Nr+")":"ForwardRef"),Nr;case $r:return Xr=Nr.displayName||null,Xr!==null?Xr:$n(Nr.type)||"Memo";case Br:Xr=Nr._payload,Nr=Nr._init;try{return $n(Nr(Xr))}catch{}}return null}function en(Nr){var Xr=Nr.type;switch(Nr.tag){case 24:return"Cache";case 9:return(Xr.displayName||"Context")+".Consumer";case 10:return(Xr._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return Nr=Xr.render,Nr=Nr.displayName||Nr.name||"",Xr.displayName||(Nr!==""?"ForwardRef("+Nr+")":"ForwardRef");case 7:return"Fragment";case 5:return Xr;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $n(Xr);case 8:return Xr===rr?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof Xr=="function")return Xr.displayName||Xr.name||null;if(typeof Xr=="string")return Xr}return null}function In(Nr){var Xr=Nr,Fn=Nr;if(Nr.alternate)for(;Xr.return;)Xr=Xr.return;else{Nr=Xr;do Xr=Nr,Xr.flags&4098&&(Fn=Xr.return),Nr=Xr.return;while(Nr)}return Xr.tag===3?Fn:null}function Rn(Nr){if(In(Nr)!==Nr)throw Error(Mt(188))}function qn(Nr){var Xr=Nr.alternate;if(!Xr){if(Xr=In(Nr),Xr===null)throw Error(Mt(188));return Xr!==Nr?null:Nr}for(var Fn=Nr,ss=Xr;;){var js=Fn.return;if(js===null)break;var Nl=js.alternate;if(Nl===null){if(ss=js.return,ss!==null){Fn=ss;continue}break}if(js.child===Nl.child){for(Nl=js.child;Nl;){if(Nl===Fn)return Rn(js),Nr;if(Nl===ss)return Rn(js),Xr;Nl=Nl.sibling}throw Error(Mt(188))}if(Fn.return!==ss.return)Fn=js,ss=Nl;else{for(var Op=!1,w0=js.child;w0;){if(w0===Fn){Op=!0,Fn=js,ss=Nl;break}if(w0===ss){Op=!0,ss=js,Fn=Nl;break}w0=w0.sibling}if(!Op){for(w0=Nl.child;w0;){if(w0===Fn){Op=!0,Fn=Nl,ss=js;break}if(w0===ss){Op=!0,ss=Nl,Fn=js;break}w0=w0.sibling}if(!Op)throw Error(Mt(189))}}if(Fn.alternate!==ss)throw Error(Mt(190))}if(Fn.tag!==3)throw Error(Mt(188));return Fn.stateNode.current===Fn?Nr:Xr}function Qn(Nr){return Nr=qn(Nr),Nr!==null?xs(Nr):null}function xs(Nr){if(Nr.tag===5||Nr.tag===6)return Nr;for(Nr=Nr.child;Nr!==null;){var Xr=xs(Nr);if(Xr!==null)return Xr;Nr=Nr.sibling}return null}function cs(Nr){if(Nr.tag===5||Nr.tag===6)return Nr;for(Nr=Nr.child;Nr!==null;){if(Nr.tag!==4){var Xr=cs(Nr);if(Xr!==null)return Xr}Nr=Nr.sibling}return null}var ks=Array.isArray,_o=_.getPublicInstance,qs=_.getRootHostContext,Ss=_.getChildHostContext,eo=_.prepareForCommit,Ao=_.resetAfterCommit,Oo=_.createInstance,uo=_.appendInitialChild,uu=_.finalizeInitialChildren,cu=_.prepareUpdate,Jl=_.shouldSetTextContent,mu=_.createTextInstance,pu=_.scheduleTimeout,Zu=_.cancelTimeout,Mp=_.noTimeout,Up=_.isPrimaryRenderer,Ep=_.supportsMutation,mp=_.supportsPersistence,Cp=_.supportsHydration,t0=_.getInstanceFromNode,_g=_.preparePortalMount,m0=_.getCurrentEventPriority,K0=_.detachDeletedInstance,Jp=_.supportsMicrotasks,y0=_.scheduleMicrotask,z0=_.supportsTestSelectors,jm=_.findFiberRoot,Nu=_.getBoundingRect,Co=_.getTextContent,Bp=_.isHiddenSubtree,a0=_.matchAccessibilityRole,Q0=_.setFocusIfFocusable,T0=_.setupIntersectionObserver,av=_.appendChild,lv=_.appendChildToContainer,N0=_.commitTextUpdate,zv=_.commitMount,Uv=_.commitUpdate,Gv=_.insertBefore,Dv=_.insertInContainerBefore,Cv=_.removeChild,Kp=_.removeChildFromContainer,sv=_.resetTextContent,Hv=_.hideInstance,jp=_.hideTextInstance,Fp=_.unhideInstance,nv=_.unhideTextInstance,qy=_.clearContainer,Uy=_.cloneInstance,vx=_.createContainerChildSet,qx=_.appendChildToContainerChildSet,Kx=_.finalizeContainerChildren,Mx=_.replaceContainerChildren,Ox=_.cloneHiddenInstance,E2=_.cloneHiddenTextInstance,$2=_.canHydrateInstance,X2=_.canHydrateTextInstance,_E=_.canHydrateSuspenseInstance,mE=_.isSuspenseInstancePending,Pp=_.isSuspenseInstanceFallback,tv=_.registerSuspenseInstanceRetry,ov=_.getNextHydratableSibling,p0=_.getFirstHydratableChild,bv=_.getFirstHydratableChildWithinContainer,Dx=_.getFirstHydratableChildWithinSuspenseInstance,ru=_.hydrateInstance,Iu=_.hydrateTextInstance,Hp=_.hydrateSuspenseInstance,M0=_.getNextHydratableInstanceAfterSuspenseInstance,H0=_.commitHydratedContainer,Z0=_.commitHydratedSuspenseInstance,Fv=_.clearSuspenseBoundary,kv=_.clearSuspenseBoundaryFromContainer,Dy=_.shouldDeleteUnhydratedTailInstances,Gy=_.didNotMatchHydratedContainerTextInstance,jv=_.didNotMatchHydratedTextInstance,I0;function M2(Nr){if(I0===void 0)try{throw Error()}catch(Fn){var Xr=Fn.stack.trim().match(/\n( *(at )?)/);I0=Xr&&Xr[1]||""}return`
`+I0+Nr}var dx=!1;function bx(Nr,Xr){if(!Nr||dx)return"";dx=!0;var Fn=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(Xr)if(Xr=function(){throw Error()},Object.defineProperty(Xr.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Xr,[])}catch(Zy){var ss=Zy}Reflect.construct(Nr,[],Xr)}else{try{Xr.call()}catch(Zy){ss=Zy}Nr.call(Xr.prototype)}else{try{throw Error()}catch(Zy){ss=Zy}Nr()}}catch(Zy){if(Zy&&ss&&typeof Zy.stack=="string"){for(var js=Zy.stack.split(`
`),Nl=ss.stack.split(`
`),Op=js.length-1,w0=Nl.length-1;1<=Op&&0<=w0&&js[Op]!==Nl[w0];)w0--;for(;1<=Op&&0<=w0;Op--,w0--)if(js[Op]!==Nl[w0]){if(Op!==1||w0!==1)do if(Op--,w0--,0>w0||js[Op]!==Nl[w0]){var Sv=`
`+js[Op].replace(" at new "," at ");return Nr.displayName&&Sv.includes("<anonymous>")&&(Sv=Sv.replace("<anonymous>",Nr.displayName)),Sv}while(1<=Op&&0<=w0);break}}}finally{dx=!1,Error.prepareStackTrace=Fn}return(Nr=Nr?Nr.displayName||Nr.name:"")?M2(Nr):""}var Jx=Object.prototype.hasOwnProperty,t2=[],y2=-1;function Hx(Nr){return{current:Nr}}function $x(Nr){0>y2||(Nr.current=t2[y2],t2[y2]=null,y2--)}function r2(Nr,Xr){y2++,t2[y2]=Nr.current,Nr.current=Xr}var Yx={},I2=Hx(Yx),d2=Hx(!1),V2=Yx;function iE(Nr,Xr){var Fn=Nr.type.contextTypes;if(!Fn)return Yx;var ss=Nr.stateNode;if(ss&&ss.__reactInternalMemoizedUnmaskedChildContext===Xr)return ss.__reactInternalMemoizedMaskedChildContext;var js={},Nl;for(Nl in Fn)js[Nl]=Xr[Nl];return ss&&(Nr=Nr.stateNode,Nr.__reactInternalMemoizedUnmaskedChildContext=Xr,Nr.__reactInternalMemoizedMaskedChildContext=js),js}function K2(Nr){return Nr=Nr.childContextTypes,Nr!=null}function Y2(){$x(d2),$x(I2)}function N2(Nr,Xr,Fn){if(I2.current!==Yx)throw Error(Mt(168));r2(I2,Xr),r2(d2,Fn)}function tE(Nr,Xr,Fn){var ss=Nr.stateNode;if(Xr=Xr.childContextTypes,typeof ss.getChildContext!="function")return Fn;ss=ss.getChildContext();for(var js in ss)if(!(js in Xr))throw Error(Mt(108,en(Nr)||"Unknown",js));return St({},Fn,ss)}function U2(Nr){return Nr=(Nr=Nr.stateNode)&&Nr.__reactInternalMemoizedMergedChildContext||Yx,V2=I2.current,r2(I2,Nr),r2(d2,d2.current),!0}function f2(Nr,Xr,Fn){var ss=Nr.stateNode;if(!ss)throw Error(Mt(169));Fn?(Nr=tE(Nr,Xr,V2),ss.__reactInternalMemoizedMergedChildContext=Nr,$x(d2),$x(I2),r2(I2,Nr)):$x(d2),r2(d2,Fn)}var q2=Math.clz32?Math.clz32:FE,IE=Math.log,oE=Math.LN2;function FE(Nr){return Nr>>>=0,Nr===0?32:31-(IE(Nr)/oE|0)|0}var DC=64,BC=4194304;function LC(Nr){switch(Nr&-Nr){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Nr&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return Nr&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return Nr}}function pM(Nr,Xr){var Fn=Nr.pendingLanes;if(Fn===0)return 0;var ss=0,js=Nr.suspendedLanes,Nl=Nr.pingedLanes,Op=Fn&268435455;if(Op!==0){var w0=Op&~js;w0!==0?ss=LC(w0):(Nl&=Op,Nl!==0&&(ss=LC(Nl)))}else Op=Fn&~js,Op!==0?ss=LC(Op):Nl!==0&&(ss=LC(Nl));if(ss===0)return 0;if(Xr!==0&&Xr!==ss&&!(Xr&js)&&(js=ss&-ss,Nl=Xr&-Xr,js>=Nl||js===16&&(Nl&4194240)!==0))return Xr;if(ss&4&&(ss|=Fn&16),Xr=Nr.entangledLanes,Xr!==0)for(Nr=Nr.entanglements,Xr&=ss;0<Xr;)Fn=31-q2(Xr),js=1<<Fn,ss|=Nr[Fn],Xr&=~js;return ss}function CP(Nr,Xr){switch(Nr){case 1:case 2:case 4:return Xr+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Xr+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JM(Nr,Xr){for(var Fn=Nr.suspendedLanes,ss=Nr.pingedLanes,js=Nr.expirationTimes,Nl=Nr.pendingLanes;0<Nl;){var Op=31-q2(Nl),w0=1<<Op,Sv=js[Op];Sv===-1?(!(w0&Fn)||w0&ss)&&(js[Op]=CP(w0,Xr)):Sv<=Xr&&(Nr.expiredLanes|=w0),Nl&=~w0}}function kC(Nr){return Nr=Nr.pendingLanes&-1073741825,Nr!==0?Nr:Nr&1073741824?1073741824:0}function IM(Nr){for(var Xr=[],Fn=0;31>Fn;Fn++)Xr.push(Nr);return Xr}function _C(Nr,Xr,Fn){Nr.pendingLanes|=Xr,Xr!==536870912&&(Nr.suspendedLanes=0,Nr.pingedLanes=0),Nr=Nr.eventTimes,Xr=31-q2(Xr),Nr[Xr]=Fn}function jC(Nr,Xr){var Fn=Nr.pendingLanes&~Xr;Nr.pendingLanes=Xr,Nr.suspendedLanes=0,Nr.pingedLanes=0,Nr.expiredLanes&=Xr,Nr.mutableReadLanes&=Xr,Nr.entangledLanes&=Xr,Xr=Nr.entanglements;var ss=Nr.eventTimes;for(Nr=Nr.expirationTimes;0<Fn;){var js=31-q2(Fn),Nl=1<<js;Xr[js]=0,ss[js]=-1,Nr[js]=-1,Fn&=~Nl}}function wC(Nr,Xr){var Fn=Nr.entangledLanes|=Xr;for(Nr=Nr.entanglements;Fn;){var ss=31-q2(Fn),js=1<<ss;js&Xr|Nr[ss]&Xr&&(Nr[ss]|=Xr),Fn&=~js}}var D2=0;function QM(Nr){return Nr&=-Nr,1<Nr?4<Nr?Nr&268435455?16:536870912:4:1}var FC=bt.unstable_scheduleCallback,kM=bt.unstable_cancelCallback,ZM=bt.unstable_shouldYield,MP=bt.unstable_requestPaint,rE=bt.unstable_now,mM=bt.unstable_ImmediatePriority,TP=bt.unstable_UserBlockingPriority,ME=bt.unstable_NormalPriority,iT=bt.unstable_IdlePriority,gM=null,NE=null;function sT(Nr){if(NE&&typeof NE.onCommitFiberRoot=="function")try{NE.onCommitFiberRoot(gM,Nr,void 0,(Nr.current.flags&128)===128)}catch{}}function PP(Nr,Xr){return Nr===Xr&&(Nr!==0||1/Nr===1/Xr)||Nr!==Nr&&Xr!==Xr}var UE=typeof Object.is=="function"?Object.is:PP,TE=null,EC=!1,WE=!1;function aT(Nr){TE===null?TE=[Nr]:TE.push(Nr)}function hT(Nr){EC=!0,aT(Nr)}function BE(){if(!WE&&TE!==null){WE=!0;var Nr=0,Xr=D2;try{var Fn=TE;for(D2=1;Nr<Fn.length;Nr++){var ss=Fn[Nr];do ss=ss(!0);while(ss!==null)}TE=null,EC=!1}catch(js){throw TE!==null&&(TE=TE.slice(Nr+1)),FC(mM,BE),js}finally{D2=Xr,WE=!1}}return null}var vM=Bt.ReactCurrentBatchConfig;function yM(Nr,Xr){if(UE(Nr,Xr))return!0;if(typeof Nr!="object"||Nr===null||typeof Xr!="object"||Xr===null)return!1;var Fn=Object.keys(Nr),ss=Object.keys(Xr);if(Fn.length!==ss.length)return!1;for(ss=0;ss<Fn.length;ss++){var js=Fn[ss];if(!Jx.call(Xr,js)||!UE(Nr[js],Xr[js]))return!1}return!0}function xM(Nr){switch(Nr.tag){case 5:return M2(Nr.type);case 16:return M2("Lazy");case 13:return M2("Suspense");case 19:return M2("SuspenseList");case 0:case 2:case 15:return Nr=bx(Nr.type,!1),Nr;case 11:return Nr=bx(Nr.type.render,!1),Nr;case 1:return Nr=bx(Nr.type,!0),Nr;default:return""}}function PE(Nr,Xr){if(Nr&&Nr.defaultProps){Xr=St({},Xr),Nr=Nr.defaultProps;for(var Fn in Nr)Xr[Fn]===void 0&&(Xr[Fn]=Nr[Fn]);return Xr}return Xr}var gE=Hx(null),OM=null,mC=null,HC=null;function FM(){HC=mC=OM=null}function RP(Nr,Xr,Fn){Up?(r2(gE,Xr._currentValue),Xr._currentValue=Fn):(r2(gE,Xr._currentValue2),Xr._currentValue2=Fn)}function vE(Nr){var Xr=gE.current;$x(gE),Up?Nr._currentValue=Xr:Nr._currentValue2=Xr}function RE(Nr,Xr,Fn){for(;Nr!==null;){var ss=Nr.alternate;if((Nr.childLanes&Xr)!==Xr?(Nr.childLanes|=Xr,ss!==null&&(ss.childLanes|=Xr)):ss!==null&&(ss.childLanes&Xr)!==Xr&&(ss.childLanes|=Xr),Nr===Fn)break;Nr=Nr.return}}function lE(Nr,Xr){OM=Nr,HC=mC=null,Nr=Nr.dependencies,Nr!==null&&Nr.firstContext!==null&&(Nr.lanes&Xr&&(jE=!0),Nr.firstContext=null)}function uE(Nr){var Xr=Up?Nr._currentValue:Nr._currentValue2;if(HC!==Nr)if(Nr={context:Nr,memoizedValue:Xr,next:null},mC===null){if(OM===null)throw Error(Mt(308));mC=Nr,OM.dependencies={lanes:0,firstContext:Nr}}else mC=mC.next=Nr;return Xr}var VE=null,qC=!1;function C3(Nr){Nr.updateQueue={baseState:Nr.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xR(Nr,Xr){Nr=Nr.updateQueue,Xr.updateQueue===Nr&&(Xr.updateQueue={baseState:Nr.baseState,firstBaseUpdate:Nr.firstBaseUpdate,lastBaseUpdate:Nr.lastBaseUpdate,shared:Nr.shared,effects:Nr.effects})}function NC(Nr,Xr){return{eventTime:Nr,lane:Xr,tag:0,payload:null,callback:null,next:null}}function JC(Nr,Xr){var Fn=Nr.updateQueue;Fn!==null&&(Fn=Fn.shared,dE!==null&&Nr.mode&1&&!(R2&2)?(Nr=Fn.interleaved,Nr===null?(Xr.next=Xr,VE===null?VE=[Fn]:VE.push(Fn)):(Xr.next=Nr.next,Nr.next=Xr),Fn.interleaved=Xr):(Nr=Fn.pending,Nr===null?Xr.next=Xr:(Xr.next=Nr.next,Nr.next=Xr),Fn.pending=Xr))}function DP(Nr,Xr,Fn){if(Xr=Xr.updateQueue,Xr!==null&&(Xr=Xr.shared,(Fn&4194240)!==0)){var ss=Xr.lanes;ss&=Nr.pendingLanes,Fn|=ss,Xr.lanes=Fn,wC(Nr,Fn)}}function _R(Nr,Xr){var Fn=Nr.updateQueue,ss=Nr.alternate;if(ss!==null&&(ss=ss.updateQueue,Fn===ss)){var js=null,Nl=null;if(Fn=Fn.firstBaseUpdate,Fn!==null){do{var Op={eventTime:Fn.eventTime,lane:Fn.lane,tag:Fn.tag,payload:Fn.payload,callback:Fn.callback,next:null};Nl===null?js=Nl=Op:Nl=Nl.next=Op,Fn=Fn.next}while(Fn!==null);Nl===null?js=Nl=Xr:Nl=Nl.next=Xr}else js=Nl=Xr;Fn={baseState:ss.baseState,firstBaseUpdate:js,lastBaseUpdate:Nl,shared:ss.shared,effects:ss.effects},Nr.updateQueue=Fn;return}Nr=Fn.lastBaseUpdate,Nr===null?Fn.firstBaseUpdate=Xr:Nr.next=Xr,Fn.lastBaseUpdate=Xr}function IP(Nr,Xr,Fn,ss){var js=Nr.updateQueue;qC=!1;var Nl=js.firstBaseUpdate,Op=js.lastBaseUpdate,w0=js.shared.pending;if(w0!==null){js.shared.pending=null;var Sv=w0,Zy=Sv.next;Sv.next=null,Op===null?Nl=Zy:Op.next=Zy,Op=Sv;var Ax=Nr.alternate;Ax!==null&&(Ax=Ax.updateQueue,w0=Ax.lastBaseUpdate,w0!==Op&&(w0===null?Ax.firstBaseUpdate=Zy:w0.next=Zy,Ax.lastBaseUpdate=Sv))}if(Nl!==null){var m2=js.baseState;Op=0,Ax=Zy=Sv=null,w0=Nl;do{var Qx=w0.lane,W2=w0.eventTime;if((ss&Qx)===Qx){Ax!==null&&(Ax=Ax.next={eventTime:W2,lane:0,tag:w0.tag,payload:w0.payload,callback:w0.callback,next:null});e:{var jx=Nr,CE=w0;switch(Qx=Xr,W2=Fn,CE.tag){case 1:if(jx=CE.payload,typeof jx=="function"){m2=jx.call(W2,m2,Qx);break e}m2=jx;break e;case 3:jx.flags=jx.flags&-65537|128;case 0:if(jx=CE.payload,Qx=typeof jx=="function"?jx.call(W2,m2,Qx):jx,Qx==null)break e;m2=St({},m2,Qx);break e;case 2:qC=!0}}w0.callback!==null&&w0.lane!==0&&(Nr.flags|=64,Qx=js.effects,Qx===null?js.effects=[w0]:Qx.push(w0))}else W2={eventTime:W2,lane:Qx,tag:w0.tag,payload:w0.payload,callback:w0.callback,next:null},Ax===null?(Zy=Ax=W2,Sv=m2):Ax=Ax.next=W2,Op|=Qx;if(w0=w0.next,w0===null){if(w0=js.shared.pending,w0===null)break;Qx=w0,w0=Qx.next,Qx.next=null,js.lastBaseUpdate=Qx,js.shared.pending=null}}while(!0);if(Ax===null&&(Sv=m2),js.baseState=Sv,js.firstBaseUpdate=Zy,js.lastBaseUpdate=Ax,Xr=js.shared.interleaved,Xr!==null){js=Xr;do Op|=js.lane,js=js.next;while(js!==Xr)}else Nl===null&&(js.shared.lanes=0);XM|=Op,Nr.lanes=Op,Nr.memoizedState=m2}}function bR(Nr,Xr,Fn){if(Nr=Xr.effects,Xr.effects=null,Nr!==null)for(Xr=0;Xr<Nr.length;Xr++){var ss=Nr[Xr],js=ss.callback;if(js!==null){if(ss.callback=null,ss=Fn,typeof js!="function")throw Error(Mt(191,js));js.call(ss)}}}var wR=new mt.Component().refs;function M3(Nr,Xr,Fn,ss){Xr=Nr.memoizedState,Fn=Fn(ss,Xr),Fn=Fn==null?Xr:St({},Xr,Fn),Nr.memoizedState=Fn,Nr.lanes===0&&(Nr.updateQueue.baseState=Fn)}var LP={isMounted:function(Nr){return(Nr=Nr._reactInternals)?In(Nr)===Nr:!1},enqueueSetState:function(Nr,Xr,Fn){Nr=Nr._reactInternals;var ss=$E(),js=iM(Nr),Nl=NC(ss,js);Nl.payload=Xr,Fn!=null&&(Nl.callback=Fn),JC(Nr,Nl),Xr=JE(Nr,js,ss),Xr!==null&&DP(Xr,Nr,js)},enqueueReplaceState:function(Nr,Xr,Fn){Nr=Nr._reactInternals;var ss=$E(),js=iM(Nr),Nl=NC(ss,js);Nl.tag=1,Nl.payload=Xr,Fn!=null&&(Nl.callback=Fn),JC(Nr,Nl),Xr=JE(Nr,js,ss),Xr!==null&&DP(Xr,Nr,js)},enqueueForceUpdate:function(Nr,Xr){Nr=Nr._reactInternals;var Fn=$E(),ss=iM(Nr),js=NC(Fn,ss);js.tag=2,Xr!=null&&(js.callback=Xr),JC(Nr,js),Xr=JE(Nr,ss,Fn),Xr!==null&&DP(Xr,Nr,ss)}};function SR(Nr,Xr,Fn,ss,js,Nl,Op){return Nr=Nr.stateNode,typeof Nr.shouldComponentUpdate=="function"?Nr.shouldComponentUpdate(ss,Nl,Op):Xr.prototype&&Xr.prototype.isPureReactComponent?!yM(Fn,ss)||!yM(js,Nl):!0}function ER(Nr,Xr,Fn){var ss=!1,js=Yx,Nl=Xr.contextType;return typeof Nl=="object"&&Nl!==null?Nl=uE(Nl):(js=K2(Xr)?V2:I2.current,ss=Xr.contextTypes,Nl=(ss=ss!=null)?iE(Nr,js):Yx),Xr=new Xr(Fn,Nl),Nr.memoizedState=Xr.state!==null&&Xr.state!==void 0?Xr.state:null,Xr.updater=LP,Nr.stateNode=Xr,Xr._reactInternals=Nr,ss&&(Nr=Nr.stateNode,Nr.__reactInternalMemoizedUnmaskedChildContext=js,Nr.__reactInternalMemoizedMaskedChildContext=Nl),Xr}function AR(Nr,Xr,Fn,ss){Nr=Xr.state,typeof Xr.componentWillReceiveProps=="function"&&Xr.componentWillReceiveProps(Fn,ss),typeof Xr.UNSAFE_componentWillReceiveProps=="function"&&Xr.UNSAFE_componentWillReceiveProps(Fn,ss),Xr.state!==Nr&&LP.enqueueReplaceState(Xr,Xr.state,null)}function T3(Nr,Xr,Fn,ss){var js=Nr.stateNode;js.props=Fn,js.state=Nr.memoizedState,js.refs=wR,C3(Nr);var Nl=Xr.contextType;typeof Nl=="object"&&Nl!==null?js.context=uE(Nl):(Nl=K2(Xr)?V2:I2.current,js.context=iE(Nr,Nl)),js.state=Nr.memoizedState,Nl=Xr.getDerivedStateFromProps,typeof Nl=="function"&&(M3(Nr,Xr,Nl,Fn),js.state=Nr.memoizedState),typeof Xr.getDerivedStateFromProps=="function"||typeof js.getSnapshotBeforeUpdate=="function"||typeof js.UNSAFE_componentWillMount!="function"&&typeof js.componentWillMount!="function"||(Xr=js.state,typeof js.componentWillMount=="function"&&js.componentWillMount(),typeof js.UNSAFE_componentWillMount=="function"&&js.UNSAFE_componentWillMount(),Xr!==js.state&&LP.enqueueReplaceState(js,js.state,null),IP(Nr,Fn,js,ss),js.state=Nr.memoizedState),typeof js.componentDidMount=="function"&&(Nr.flags|=4194308)}var NM=[],UM=0,kP=null,OP=0,qE=[],XE=0,_M=null,UC=1,VC="";function wM(Nr,Xr){NM[UM++]=OP,NM[UM++]=kP,kP=Nr,OP=Xr}function CR(Nr,Xr,Fn){qE[XE++]=UC,qE[XE++]=VC,qE[XE++]=_M,_M=Nr;var ss=UC;Nr=VC;var js=32-q2(ss)-1;ss&=~(1<<js),Fn+=1;var Nl=32-q2(Xr)+js;if(30<Nl){var Op=js-js%5;Nl=(ss&(1<<Op)-1).toString(32),ss>>=Op,js-=Op,UC=1<<32-q2(Xr)+js|Fn<<js|ss,VC=Nl+Nr}else UC=1<<Nl|Fn<<js|ss,VC=Nr}function P3(Nr){Nr.return!==null&&(wM(Nr,1),CR(Nr,1,0))}function R3(Nr){for(;Nr===kP;)kP=NM[--UM],NM[UM]=null,OP=NM[--UM],NM[UM]=null;for(;Nr===_M;)_M=qE[--XE],qE[XE]=null,VC=qE[--XE],qE[XE]=null,UC=qE[--XE],qE[XE]=null}var zE=null,GE=null,eE=!1,fT=!1,yC=null;function MR(Nr,Xr){var Fn=QE(5,null,null,0);Fn.elementType="DELETED",Fn.stateNode=Xr,Fn.return=Nr,Xr=Nr.deletions,Xr===null?(Nr.deletions=[Fn],Nr.flags|=16):Xr.push(Fn)}function TR(Nr,Xr){switch(Nr.tag){case 5:return Xr=$2(Xr,Nr.type,Nr.pendingProps),Xr!==null?(Nr.stateNode=Xr,zE=Nr,GE=p0(Xr),!0):!1;case 6:return Xr=X2(Xr,Nr.pendingProps),Xr!==null?(Nr.stateNode=Xr,zE=Nr,GE=null,!0):!1;case 13:if(Xr=_E(Xr),Xr!==null){var Fn=_M!==null?{id:UC,overflow:VC}:null;return Nr.memoizedState={dehydrated:Xr,treeContext:Fn,retryLane:1073741824},Fn=QE(18,null,null,0),Fn.stateNode=Xr,Fn.return=Nr,Nr.child=Fn,zE=Nr,GE=null,!0}return!1;default:return!1}}function D3(Nr){return(Nr.mode&1)!==0&&(Nr.flags&128)===0}function $3(Nr){if(eE){var Xr=GE;if(Xr){var Fn=Xr;if(!TR(Nr,Xr)){if(D3(Nr))throw Error(Mt(418));Xr=ov(Fn);var ss=zE;Xr&&TR(Nr,Xr)?MR(ss,Fn):(Nr.flags=Nr.flags&-4097|2,eE=!1,zE=Nr)}}else{if(D3(Nr))throw Error(Mt(418));Nr.flags=Nr.flags&-4097|2,eE=!1,zE=Nr}}}function PR(Nr){for(Nr=Nr.return;Nr!==null&&Nr.tag!==5&&Nr.tag!==3&&Nr.tag!==13;)Nr=Nr.return;zE=Nr}function pT(Nr){if(!Cp||Nr!==zE)return!1;if(!eE)return PR(Nr),eE=!0,!1;if(Nr.tag!==3&&(Nr.tag!==5||Dy(Nr.type)&&!Jl(Nr.type,Nr.memoizedProps))){var Xr=GE;if(Xr){if(D3(Nr)){for(Nr=GE;Nr;)Nr=ov(Nr);throw Error(Mt(418))}for(;Xr;)MR(Nr,Xr),Xr=ov(Xr)}}if(PR(Nr),Nr.tag===13){if(!Cp)throw Error(Mt(316));if(Nr=Nr.memoizedState,Nr=Nr!==null?Nr.dehydrated:null,!Nr)throw Error(Mt(317));GE=M0(Nr)}else GE=zE?ov(Nr.stateNode):null;return!0}function VM(){Cp&&(GE=zE=null,fT=eE=!1)}function I3(Nr){yC===null?yC=[Nr]:yC.push(Nr)}function mT(Nr,Xr,Fn){if(Nr=Fn.ref,Nr!==null&&typeof Nr!="function"&&typeof Nr!="object"){if(Fn._owner){if(Fn=Fn._owner,Fn){if(Fn.tag!==1)throw Error(Mt(309));var ss=Fn.stateNode}if(!ss)throw Error(Mt(147,Nr));var js=ss,Nl=""+Nr;return Xr!==null&&Xr.ref!==null&&typeof Xr.ref=="function"&&Xr.ref._stringRef===Nl?Xr.ref:(Xr=function(Op){var w0=js.refs;w0===wR&&(w0=js.refs={}),Op===null?delete w0[Nl]:w0[Nl]=Op},Xr._stringRef=Nl,Xr)}if(typeof Nr!="string")throw Error(Mt(284));if(!Fn._owner)throw Error(Mt(290,Nr))}return Nr}function FP(Nr,Xr){throw Nr=Object.prototype.toString.call(Xr),Error(Mt(31,Nr==="[object Object]"?"object with keys {"+Object.keys(Xr).join(", ")+"}":Nr))}function RR(Nr){var Xr=Nr._init;return Xr(Nr._payload)}function DR(Nr){function Xr(iv,P0){if(Nr){var wv=iv.deletions;wv===null?(iv.deletions=[P0],iv.flags|=16):wv.push(P0)}}function Fn(iv,P0){if(!Nr)return null;for(;P0!==null;)Xr(iv,P0),P0=P0.sibling;return null}function ss(iv,P0){for(iv=new Map;P0!==null;)P0.key!==null?iv.set(P0.key,P0):iv.set(P0.index,P0),P0=P0.sibling;return iv}function js(iv,P0){return iv=hM(iv,P0),iv.index=0,iv.sibling=null,iv}function Nl(iv,P0,wv){return iv.index=wv,Nr?(wv=iv.alternate,wv!==null?(wv=wv.index,wv<P0?(iv.flags|=2,P0):wv):(iv.flags|=2,P0)):(iv.flags|=1048576,P0)}function Op(iv){return Nr&&iv.alternate===null&&(iv.flags|=2),iv}function w0(iv,P0,wv,Sx){return P0===null||P0.tag!==6?(P0=gR(wv,iv.mode,Sx),P0.return=iv,P0):(P0=js(P0,wv),P0.return=iv,P0)}function Sv(iv,P0,wv,Sx){var Lx=wv.type;return Lx===tr?Ax(iv,P0,wv.props.children,Sx,wv.key):P0!==null&&(P0.elementType===Lx||typeof Lx=="object"&&Lx!==null&&Lx.$$typeof===Br&&RR(Lx)===P0.type)?(Sx=js(P0,wv.props),Sx.ref=mT(iv,P0,wv),Sx.return=iv,Sx):(Sx=S3(wv.type,wv.key,wv.props,null,iv.mode,Sx),Sx.ref=mT(iv,P0,wv),Sx.return=iv,Sx)}function Zy(iv,P0,wv,Sx){return P0===null||P0.tag!==4||P0.stateNode.containerInfo!==wv.containerInfo||P0.stateNode.implementation!==wv.implementation?(P0=vR(wv,iv.mode,Sx),P0.return=iv,P0):(P0=js(P0,wv.children||[]),P0.return=iv,P0)}function Ax(iv,P0,wv,Sx,Lx){return P0===null||P0.tag!==7?(P0=$M(wv,iv.mode,Sx,Lx),P0.return=iv,P0):(P0=js(P0,wv),P0.return=iv,P0)}function m2(iv,P0,wv){if(typeof P0=="string"&&P0!==""||typeof P0=="number")return P0=gR(""+P0,iv.mode,wv),P0.return=iv,P0;if(typeof P0=="object"&&P0!==null){switch(P0.$$typeof){case Ut:return wv=S3(P0.type,P0.key,P0.props,null,iv.mode,wv),wv.ref=mT(iv,null,P0),wv.return=iv,wv;case Ht:return P0=vR(P0,iv.mode,wv),P0.return=iv,P0;case Br:var Sx=P0._init;return m2(iv,Sx(P0._payload),wv)}if(ks(P0)||Mn(P0))return P0=$M(P0,iv.mode,wv,null),P0.return=iv,P0;FP(iv,P0)}return null}function Qx(iv,P0,wv,Sx){var Lx=P0!==null?P0.key:null;if(typeof wv=="string"&&wv!==""||typeof wv=="number")return Lx!==null?null:w0(iv,P0,""+wv,Sx);if(typeof wv=="object"&&wv!==null){switch(wv.$$typeof){case Ut:return wv.key===Lx?Sv(iv,P0,wv,Sx):null;case Ht:return wv.key===Lx?Zy(iv,P0,wv,Sx):null;case Br:return Lx=wv._init,Qx(iv,P0,Lx(wv._payload),Sx)}if(ks(wv)||Mn(wv))return Lx!==null?null:Ax(iv,P0,wv,Sx,null);FP(iv,wv)}return null}function W2(iv,P0,wv,Sx,Lx){if(typeof Sx=="string"&&Sx!==""||typeof Sx=="number")return iv=iv.get(wv)||null,w0(P0,iv,""+Sx,Lx);if(typeof Sx=="object"&&Sx!==null){switch(Sx.$$typeof){case Ut:return iv=iv.get(Sx.key===null?wv:Sx.key)||null,Sv(P0,iv,Sx,Lx);case Ht:return iv=iv.get(Sx.key===null?wv:Sx.key)||null,Zy(P0,iv,Sx,Lx);case Br:var x2=Sx._init;return W2(iv,P0,wv,x2(Sx._payload),Lx)}if(ks(Sx)||Mn(Sx))return iv=iv.get(wv)||null,Ax(P0,iv,Sx,Lx,null);FP(P0,Sx)}return null}function jx(iv,P0,wv,Sx){for(var Lx=null,x2=null,g2=P0,G2=P0=0,xE=null;g2!==null&&G2<wv.length;G2++){g2.index>G2?(xE=g2,g2=null):xE=g2.sibling;var H2=Qx(iv,g2,wv[G2],Sx);if(H2===null){g2===null&&(g2=xE);break}Nr&&g2&&H2.alternate===null&&Xr(iv,g2),P0=Nl(H2,P0,G2),x2===null?Lx=H2:x2.sibling=H2,x2=H2,g2=xE}if(G2===wv.length)return Fn(iv,g2),eE&&wM(iv,G2),Lx;if(g2===null){for(;G2<wv.length;G2++)g2=m2(iv,wv[G2],Sx),g2!==null&&(P0=Nl(g2,P0,G2),x2===null?Lx=g2:x2.sibling=g2,x2=g2);return eE&&wM(iv,G2),Lx}for(g2=ss(iv,g2);G2<wv.length;G2++)xE=W2(g2,iv,G2,wv[G2],Sx),xE!==null&&(Nr&&xE.alternate!==null&&g2.delete(xE.key===null?G2:xE.key),P0=Nl(xE,P0,G2),x2===null?Lx=xE:x2.sibling=xE,x2=xE);return Nr&&g2.forEach(function(fM){return Xr(iv,fM)}),eE&&wM(iv,G2),Lx}function CE(iv,P0,wv,Sx){var Lx=Mn(wv);if(typeof Lx!="function")throw Error(Mt(150));if(wv=Lx.call(wv),wv==null)throw Error(Mt(151));for(var x2=Lx=null,g2=P0,G2=P0=0,xE=null,H2=wv.next();g2!==null&&!H2.done;G2++,H2=wv.next()){g2.index>G2?(xE=g2,g2=null):xE=g2.sibling;var fM=Qx(iv,g2,H2.value,Sx);if(fM===null){g2===null&&(g2=xE);break}Nr&&g2&&fM.alternate===null&&Xr(iv,g2),P0=Nl(fM,P0,G2),x2===null?Lx=fM:x2.sibling=fM,x2=fM,g2=xE}if(H2.done)return Fn(iv,g2),eE&&wM(iv,G2),Lx;if(g2===null){for(;!H2.done;G2++,H2=wv.next())H2=m2(iv,H2.value,Sx),H2!==null&&(P0=Nl(H2,P0,G2),x2===null?Lx=H2:x2.sibling=H2,x2=H2);return eE&&wM(iv,G2),Lx}for(g2=ss(iv,g2);!H2.done;G2++,H2=wv.next())H2=W2(g2,iv,G2,H2.value,Sx),H2!==null&&(Nr&&H2.alternate!==null&&g2.delete(H2.key===null?G2:H2.key),P0=Nl(H2,P0,G2),x2===null?Lx=H2:x2.sibling=H2,x2=H2);return Nr&&g2.forEach(function(w$){return Xr(iv,w$)}),eE&&wM(iv,G2),Lx}function ZE(iv,P0,wv,Sx){if(typeof wv=="object"&&wv!==null&&wv.type===tr&&wv.key===null&&(wv=wv.props.children),typeof wv=="object"&&wv!==null){switch(wv.$$typeof){case Ut:e:{for(var Lx=wv.key,x2=P0;x2!==null;){if(x2.key===Lx){if(Lx=wv.type,Lx===tr){if(x2.tag===7){Fn(iv,x2.sibling),P0=js(x2,wv.props.children),P0.return=iv,iv=P0;break e}}else if(x2.elementType===Lx||typeof Lx=="object"&&Lx!==null&&Lx.$$typeof===Br&&RR(Lx)===x2.type){Fn(iv,x2.sibling),P0=js(x2,wv.props),P0.ref=mT(iv,x2,wv),P0.return=iv,iv=P0;break e}Fn(iv,x2);break}else Xr(iv,x2);x2=x2.sibling}wv.type===tr?(P0=$M(wv.props.children,iv.mode,Sx,wv.key),P0.return=iv,iv=P0):(Sx=S3(wv.type,wv.key,wv.props,null,iv.mode,Sx),Sx.ref=mT(iv,P0,wv),Sx.return=iv,iv=Sx)}return Op(iv);case Ht:e:{for(x2=wv.key;P0!==null;){if(P0.key===x2)if(P0.tag===4&&P0.stateNode.containerInfo===wv.containerInfo&&P0.stateNode.implementation===wv.implementation){Fn(iv,P0.sibling),P0=js(P0,wv.children||[]),P0.return=iv,iv=P0;break e}else{Fn(iv,P0);break}else Xr(iv,P0);P0=P0.sibling}P0=vR(wv,iv.mode,Sx),P0.return=iv,iv=P0}return Op(iv);case Br:return x2=wv._init,ZE(iv,P0,x2(wv._payload),Sx)}if(ks(wv))return jx(iv,P0,wv,Sx);if(Mn(wv))return CE(iv,P0,wv,Sx);FP(iv,wv)}return typeof wv=="string"&&wv!==""||typeof wv=="number"?(wv=""+wv,P0!==null&&P0.tag===6?(Fn(iv,P0.sibling),P0=js(P0,wv),P0.return=iv,iv=P0):(Fn(iv,P0),P0=gR(wv,iv.mode,Sx),P0.return=iv,iv=P0),Op(iv)):Fn(iv,P0)}return ZE}var zM=DR(!0),$R=DR(!1),gT={},KE=Hx(gT),yT=Hx(gT),GM=Hx(gT);function CC(Nr){if(Nr===gT)throw Error(Mt(174));return Nr}function B3(Nr,Xr){r2(GM,Xr),r2(yT,Nr),r2(KE,gT),Nr=qs(Xr),$x(KE),r2(KE,Nr)}function HM(){$x(KE),$x(yT),$x(GM)}function IR(Nr){var Xr=CC(GM.current),Fn=CC(KE.current);Xr=Ss(Fn,Nr.type,Xr),Fn!==Xr&&(r2(yT,Nr),r2(KE,Xr))}function L3(Nr){yT.current===Nr&&($x(KE),$x(yT))}var nE=Hx(0);function NP(Nr){for(var Xr=Nr;Xr!==null;){if(Xr.tag===13){var Fn=Xr.memoizedState;if(Fn!==null&&(Fn=Fn.dehydrated,Fn===null||mE(Fn)||Pp(Fn)))return Xr}else if(Xr.tag===19&&Xr.memoizedProps.revealOrder!==void 0){if(Xr.flags&128)return Xr}else if(Xr.child!==null){Xr.child.return=Xr,Xr=Xr.child;continue}if(Xr===Nr)break;for(;Xr.sibling===null;){if(Xr.return===null||Xr.return===Nr)return null;Xr=Xr.return}Xr.sibling.return=Xr.return,Xr=Xr.sibling}return null}var k3=[];function O3(){for(var Nr=0;Nr<k3.length;Nr++){var Xr=k3[Nr];Up?Xr._workInProgressVersionPrimary=null:Xr._workInProgressVersionSecondary=null}k3.length=0}var jP=Bt.ReactCurrentDispatcher,YE=Bt.ReactCurrentBatchConfig,WM=0,sE=null,SE=null,yE=null,HP=!1,hP=!1,dP=0,qD=0;function EE(){throw Error(Mt(321))}function F3(Nr,Xr){if(Xr===null)return!1;for(var Fn=0;Fn<Xr.length&&Fn<Nr.length;Fn++)if(!UE(Nr[Fn],Xr[Fn]))return!1;return!0}function N3(Nr,Xr,Fn,ss,js,Nl){if(WM=Nl,sE=Xr,Xr.memoizedState=null,Xr.updateQueue=null,Xr.lanes=0,jP.current=Nr===null||Nr.memoizedState===null?JD:QD,Nr=Fn(ss,js),hP){Nl=0;do{if(hP=!1,dP=0,25<=Nl)throw Error(Mt(301));Nl+=1,yE=SE=null,Xr.updateQueue=null,jP.current=ZD,Nr=Fn(ss,js)}while(hP)}if(jP.current=YP,Xr=SE!==null&&SE.next!==null,WM=0,yE=SE=sE=null,HP=!1,Xr)throw Error(Mt(300));return Nr}function U3(){var Nr=dP!==0;return dP=0,Nr}function zC(){var Nr={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yE===null?sE.memoizedState=yE=Nr:yE=yE.next=Nr,yE}function PC(){if(SE===null){var Nr=sE.alternate;Nr=Nr!==null?Nr.memoizedState:null}else Nr=SE.next;var Xr=yE===null?sE.memoizedState:yE.next;if(Xr!==null)yE=Xr,SE=Nr;else{if(Nr===null)throw Error(Mt(310));SE=Nr,Nr={memoizedState:SE.memoizedState,baseState:SE.baseState,baseQueue:SE.baseQueue,queue:SE.queue,next:null},yE===null?sE.memoizedState=yE=Nr:yE=yE.next=Nr}return yE}function SM(Nr,Xr){return typeof Xr=="function"?Xr(Nr):Xr}function WP(Nr){var Xr=PC(),Fn=Xr.queue;if(Fn===null)throw Error(Mt(311));Fn.lastRenderedReducer=Nr;var ss=SE,js=ss.baseQueue,Nl=Fn.pending;if(Nl!==null){if(js!==null){var Op=js.next;js.next=Nl.next,Nl.next=Op}ss.baseQueue=js=Nl,Fn.pending=null}if(js!==null){Nl=js.next,ss=ss.baseState;var w0=Op=null,Sv=null,Zy=Nl;do{var Ax=Zy.lane;if((WM&Ax)===Ax)Sv!==null&&(Sv=Sv.next={lane:0,action:Zy.action,hasEagerState:Zy.hasEagerState,eagerState:Zy.eagerState,next:null}),ss=Zy.hasEagerState?Zy.eagerState:Nr(ss,Zy.action);else{var m2={lane:Ax,action:Zy.action,hasEagerState:Zy.hasEagerState,eagerState:Zy.eagerState,next:null};Sv===null?(w0=Sv=m2,Op=ss):Sv=Sv.next=m2,sE.lanes|=Ax,XM|=Ax}Zy=Zy.next}while(Zy!==null&&Zy!==Nl);Sv===null?Op=ss:Sv.next=w0,UE(ss,Xr.memoizedState)||(jE=!0),Xr.memoizedState=ss,Xr.baseState=Op,Xr.baseQueue=Sv,Fn.lastRenderedState=ss}if(Nr=Fn.interleaved,Nr!==null){js=Nr;do Nl=js.lane,sE.lanes|=Nl,XM|=Nl,js=js.next;while(js!==Nr)}else js===null&&(Fn.lanes=0);return[Xr.memoizedState,Fn.dispatch]}function qP(Nr){var Xr=PC(),Fn=Xr.queue;if(Fn===null)throw Error(Mt(311));Fn.lastRenderedReducer=Nr;var ss=Fn.dispatch,js=Fn.pending,Nl=Xr.memoizedState;if(js!==null){Fn.pending=null;var Op=js=js.next;do Nl=Nr(Nl,Op.action),Op=Op.next;while(Op!==js);UE(Nl,Xr.memoizedState)||(jE=!0),Xr.memoizedState=Nl,Xr.baseQueue===null&&(Xr.baseState=Nl),Fn.lastRenderedState=Nl}return[Nl,ss]}function BR(){}function LR(Nr,Xr){var Fn=sE,ss=PC(),js=Xr(),Nl=!UE(ss.memoizedState,js);if(Nl&&(ss.memoizedState=js,jE=!0),ss=ss.queue,pP(FR.bind(null,Fn,ss,Nr),[Nr]),ss.getSnapshot!==Xr||Nl||yE!==null&&yE.memoizedState.tag&1){if(Fn.flags|=2048,fP(9,OR.bind(null,Fn,ss,js,Xr),void 0,null),dE===null)throw Error(Mt(349));WM&30||kR(Fn,Xr,js)}return js}function kR(Nr,Xr,Fn){Nr.flags|=16384,Nr={getSnapshot:Xr,value:Fn},Xr=sE.updateQueue,Xr===null?(Xr={lastEffect:null,stores:null},sE.updateQueue=Xr,Xr.stores=[Nr]):(Fn=Xr.stores,Fn===null?Xr.stores=[Nr]:Fn.push(Nr))}function OR(Nr,Xr,Fn,ss){Xr.value=Fn,Xr.getSnapshot=ss,NR(Xr)&&JE(Nr,1,-1)}function FR(Nr,Xr,Fn){return Fn(function(){NR(Xr)&&JE(Nr,1,-1)})}function NR(Nr){var Xr=Nr.getSnapshot;Nr=Nr.value;try{var Fn=Xr();return!UE(Nr,Fn)}catch{return!0}}function V3(Nr){var Xr=zC();return typeof Nr=="function"&&(Nr=Nr()),Xr.memoizedState=Xr.baseState=Nr,Nr={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:SM,lastRenderedState:Nr},Xr.queue=Nr,Nr=Nr.dispatch=YD.bind(null,sE,Nr),[Xr.memoizedState,Nr]}function fP(Nr,Xr,Fn,ss){return Nr={tag:Nr,create:Xr,destroy:Fn,deps:ss,next:null},Xr=sE.updateQueue,Xr===null?(Xr={lastEffect:null,stores:null},sE.updateQueue=Xr,Xr.lastEffect=Nr.next=Nr):(Fn=Xr.lastEffect,Fn===null?Xr.lastEffect=Nr.next=Nr:(ss=Fn.next,Fn.next=Nr,Nr.next=ss,Xr.lastEffect=Nr)),Nr}function UR(){return PC().memoizedState}function XP(Nr,Xr,Fn,ss){var js=zC();sE.flags|=Nr,js.memoizedState=fP(1|Xr,Fn,void 0,ss===void 0?null:ss)}function KP(Nr,Xr,Fn,ss){var js=PC();ss=ss===void 0?null:ss;var Nl=void 0;if(SE!==null){var Op=SE.memoizedState;if(Nl=Op.destroy,ss!==null&&F3(ss,Op.deps)){js.memoizedState=fP(Xr,Fn,Nl,ss);return}}sE.flags|=Nr,js.memoizedState=fP(1|Xr,Fn,Nl,ss)}function z3(Nr,Xr){return XP(8390656,8,Nr,Xr)}function pP(Nr,Xr){return KP(2048,8,Nr,Xr)}function VR(Nr,Xr){return KP(4,2,Nr,Xr)}function zR(Nr,Xr){return KP(4,4,Nr,Xr)}function GR(Nr,Xr){if(typeof Xr=="function")return Nr=Nr(),Xr(Nr),function(){Xr(null)};if(Xr!=null)return Nr=Nr(),Xr.current=Nr,function(){Xr.current=null}}function jR(Nr,Xr,Fn){return Fn=Fn!=null?Fn.concat([Nr]):null,KP(4,4,GR.bind(null,Xr,Nr),Fn)}function G3(){}function HR(Nr,Xr){var Fn=PC();Xr=Xr===void 0?null:Xr;var ss=Fn.memoizedState;return ss!==null&&Xr!==null&&F3(Xr,ss[1])?ss[0]:(Fn.memoizedState=[Nr,Xr],Nr)}function WR(Nr,Xr){var Fn=PC();Xr=Xr===void 0?null:Xr;var ss=Fn.memoizedState;return ss!==null&&Xr!==null&&F3(Xr,ss[1])?ss[0]:(Nr=Nr(),Fn.memoizedState=[Nr,Xr],Nr)}function XD(Nr,Xr){var Fn=D2;D2=Fn!==0&&4>Fn?Fn:4,Nr(!0);var ss=YE.transition;YE.transition={};try{Nr(!1),Xr()}finally{D2=Fn,YE.transition=ss}}function qR(){return PC().memoizedState}function KD(Nr,Xr,Fn){var ss=iM(Nr);Fn={lane:ss,action:Fn,hasEagerState:!1,eagerState:null,next:null},XR(Nr)?KR(Xr,Fn):(YR(Nr,Xr,Fn),Fn=$E(),Nr=JE(Nr,ss,Fn),Nr!==null&&JR(Nr,Xr,ss))}function YD(Nr,Xr,Fn){var ss=iM(Nr),js={lane:ss,action:Fn,hasEagerState:!1,eagerState:null,next:null};if(XR(Nr))KR(Xr,js);else{YR(Nr,Xr,js);var Nl=Nr.alternate;if(Nr.lanes===0&&(Nl===null||Nl.lanes===0)&&(Nl=Xr.lastRenderedReducer,Nl!==null))try{var Op=Xr.lastRenderedState,w0=Nl(Op,Fn);if(js.hasEagerState=!0,js.eagerState=w0,UE(w0,Op))return}catch{}finally{}Fn=$E(),Nr=JE(Nr,ss,Fn),Nr!==null&&JR(Nr,Xr,ss)}}function XR(Nr){var Xr=Nr.alternate;return Nr===sE||Xr!==null&&Xr===sE}function KR(Nr,Xr){hP=HP=!0;var Fn=Nr.pending;Fn===null?Xr.next=Xr:(Xr.next=Fn.next,Fn.next=Xr),Nr.pending=Xr}function YR(Nr,Xr,Fn){dE!==null&&Nr.mode&1&&!(R2&2)?(Nr=Xr.interleaved,Nr===null?(Fn.next=Fn,VE===null?VE=[Xr]:VE.push(Xr)):(Fn.next=Nr.next,Nr.next=Fn),Xr.interleaved=Fn):(Nr=Xr.pending,Nr===null?Fn.next=Fn:(Fn.next=Nr.next,Nr.next=Fn),Xr.pending=Fn)}function JR(Nr,Xr,Fn){if(Fn&4194240){var ss=Xr.lanes;ss&=Nr.pendingLanes,Fn|=ss,Xr.lanes=Fn,wC(Nr,Fn)}}var YP={readContext:uE,useCallback:EE,useContext:EE,useEffect:EE,useImperativeHandle:EE,useInsertionEffect:EE,useLayoutEffect:EE,useMemo:EE,useReducer:EE,useRef:EE,useState:EE,useDebugValue:EE,useDeferredValue:EE,useTransition:EE,useMutableSource:EE,useSyncExternalStore:EE,useId:EE,unstable_isNewReconciler:!1},JD={readContext:uE,useCallback:function(Nr,Xr){return zC().memoizedState=[Nr,Xr===void 0?null:Xr],Nr},useContext:uE,useEffect:z3,useImperativeHandle:function(Nr,Xr,Fn){return Fn=Fn!=null?Fn.concat([Nr]):null,XP(4194308,4,GR.bind(null,Xr,Nr),Fn)},useLayoutEffect:function(Nr,Xr){return XP(4194308,4,Nr,Xr)},useInsertionEffect:function(Nr,Xr){return XP(4,2,Nr,Xr)},useMemo:function(Nr,Xr){var Fn=zC();return Xr=Xr===void 0?null:Xr,Nr=Nr(),Fn.memoizedState=[Nr,Xr],Nr},useReducer:function(Nr,Xr,Fn){var ss=zC();return Xr=Fn!==void 0?Fn(Xr):Xr,ss.memoizedState=ss.baseState=Xr,Nr={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nr,lastRenderedState:Xr},ss.queue=Nr,Nr=Nr.dispatch=KD.bind(null,sE,Nr),[ss.memoizedState,Nr]},useRef:function(Nr){var Xr=zC();return Nr={current:Nr},Xr.memoizedState=Nr},useState:V3,useDebugValue:G3,useDeferredValue:function(Nr){var Xr=V3(Nr),Fn=Xr[0],ss=Xr[1];return z3(function(){var js=YE.transition;YE.transition={};try{ss(Nr)}finally{YE.transition=js}},[Nr]),Fn},useTransition:function(){var Nr=V3(!1),Xr=Nr[0];return Nr=XD.bind(null,Nr[1]),zC().memoizedState=Nr,[Xr,Nr]},useMutableSource:function(){},useSyncExternalStore:function(Nr,Xr,Fn){var ss=sE,js=zC();if(eE){if(Fn===void 0)throw Error(Mt(407));Fn=Fn()}else{if(Fn=Xr(),dE===null)throw Error(Mt(349));WM&30||kR(ss,Xr,Fn)}js.memoizedState=Fn;var Nl={value:Fn,getSnapshot:Xr};return js.queue=Nl,z3(FR.bind(null,ss,Nl,Nr),[Nr]),ss.flags|=2048,fP(9,OR.bind(null,ss,Nl,Fn,Xr),void 0,null),Fn},useId:function(){var Nr=zC(),Xr=dE.identifierPrefix;if(eE){var Fn=VC,ss=UC;Fn=(ss&~(1<<32-q2(ss)-1)).toString(32)+Fn,Xr=":"+Xr+"R"+Fn,Fn=dP++,0<Fn&&(Xr+="H"+Fn.toString(32)),Xr+=":"}else Fn=qD++,Xr=":"+Xr+"r"+Fn.toString(32)+":";return Nr.memoizedState=Xr},unstable_isNewReconciler:!1},QD={readContext:uE,useCallback:HR,useContext:uE,useEffect:pP,useImperativeHandle:jR,useInsertionEffect:VR,useLayoutEffect:zR,useMemo:WR,useReducer:WP,useRef:UR,useState:function(){return WP(SM)},useDebugValue:G3,useDeferredValue:function(Nr){var Xr=WP(SM),Fn=Xr[0],ss=Xr[1];return pP(function(){var js=YE.transition;YE.transition={};try{ss(Nr)}finally{YE.transition=js}},[Nr]),Fn},useTransition:function(){var Nr=WP(SM)[0],Xr=PC().memoizedState;return[Nr,Xr]},useMutableSource:BR,useSyncExternalStore:LR,useId:qR,unstable_isNewReconciler:!1},ZD={readContext:uE,useCallback:HR,useContext:uE,useEffect:pP,useImperativeHandle:jR,useInsertionEffect:VR,useLayoutEffect:zR,useMemo:WR,useReducer:qP,useRef:UR,useState:function(){return qP(SM)},useDebugValue:G3,useDeferredValue:function(Nr){var Xr=qP(SM),Fn=Xr[0],ss=Xr[1];return pP(function(){var js=YE.transition;YE.transition={};try{ss(Nr)}finally{YE.transition=js}},[Nr]),Fn},useTransition:function(){var Nr=qP(SM)[0],Xr=PC().memoizedState;return[Nr,Xr]},useMutableSource:BR,useSyncExternalStore:LR,useId:qR,unstable_isNewReconciler:!1};function j3(Nr,Xr){try{var Fn="",ss=Xr;do Fn+=xM(ss),ss=ss.return;while(ss);var js=Fn}catch(Nl){js=`
Error generating stack: `+Nl.message+`
`+Nl.stack}return{value:Nr,source:Xr,stack:js}}function H3(Nr,Xr){try{console.error(Xr.value)}catch(Fn){setTimeout(function(){throw Fn})}}var e$=typeof WeakMap=="function"?WeakMap:Map;function QR(Nr,Xr,Fn){Fn=NC(-1,Fn),Fn.tag=3,Fn.payload={element:null};var ss=Xr.value;return Fn.callback=function(){p3||(p3=!0,cR=ss),H3(Nr,Xr)},Fn}function ZR(Nr,Xr,Fn){Fn=NC(-1,Fn),Fn.tag=3;var ss=Nr.type.getDerivedStateFromError;if(typeof ss=="function"){var js=Xr.value;Fn.payload=function(){return ss(js)},Fn.callback=function(){H3(Nr,Xr)}}var Nl=Nr.stateNode;return Nl!==null&&typeof Nl.componentDidCatch=="function"&&(Fn.callback=function(){H3(Nr,Xr),typeof ss!="function"&&(ZC===null?ZC=new Set([this]):ZC.add(this));var Op=Xr.stack;this.componentDidCatch(Xr.value,{componentStack:Op!==null?Op:""})}),Fn}function eD(Nr,Xr,Fn){var ss=Nr.pingCache;if(ss===null){ss=Nr.pingCache=new e$;var js=new Set;ss.set(Xr,js)}else js=ss.get(Xr),js===void 0&&(js=new Set,ss.set(Xr,js));js.has(Fn)||(js.add(Fn),Nr=p$.bind(null,Nr,Xr,Fn),Xr.then(Nr,Nr))}function tD(Nr){do{var Xr;if((Xr=Nr.tag===13)&&(Xr=Nr.memoizedState,Xr=Xr!==null?Xr.dehydrated!==null:!0),Xr)return Nr;Nr=Nr.return}while(Nr!==null);return null}function rD(Nr,Xr,Fn,ss,js){return Nr.mode&1?(Nr.flags|=65536,Nr.lanes=js,Nr):(Nr===Xr?Nr.flags|=65536:(Nr.flags|=128,Fn.flags|=131072,Fn.flags&=-52805,Fn.tag===1&&(Fn.alternate===null?Fn.tag=17:(Xr=NC(-1,1),Xr.tag=2,JC(Fn,Xr))),Fn.lanes|=1),Nr)}function RC(Nr){Nr.flags|=4}function nD(Nr,Xr){if(Nr!==null&&Nr.child===Xr.child)return!0;if(Xr.flags&16)return!1;for(Nr=Xr.child;Nr!==null;){if(Nr.flags&12854||Nr.subtreeFlags&12854)return!1;Nr=Nr.sibling}return!0}var mP,gP,JP,QP;if(Ep)mP=function(Nr,Xr){for(var Fn=Xr.child;Fn!==null;){if(Fn.tag===5||Fn.tag===6)uo(Nr,Fn.stateNode);else if(Fn.tag!==4&&Fn.child!==null){Fn.child.return=Fn,Fn=Fn.child;continue}if(Fn===Xr)break;for(;Fn.sibling===null;){if(Fn.return===null||Fn.return===Xr)return;Fn=Fn.return}Fn.sibling.return=Fn.return,Fn=Fn.sibling}},gP=function(){},JP=function(Nr,Xr,Fn,ss,js){if(Nr=Nr.memoizedProps,Nr!==ss){var Nl=Xr.stateNode,Op=CC(KE.current);Fn=cu(Nl,Fn,Nr,ss,js,Op),(Xr.updateQueue=Fn)&&RC(Xr)}},QP=function(Nr,Xr,Fn,ss){Fn!==ss&&RC(Xr)};else if(mp){mP=function(Nr,Xr,Fn,ss){for(var js=Xr.child;js!==null;){if(js.tag===5){var Nl=js.stateNode;Fn&&ss&&(Nl=Ox(Nl,js.type,js.memoizedProps,js)),uo(Nr,Nl)}else if(js.tag===6)Nl=js.stateNode,Fn&&ss&&(Nl=E2(Nl,js.memoizedProps,js)),uo(Nr,Nl);else if(js.tag!==4){if(js.tag===22&&js.memoizedState!==null)Nl=js.child,Nl!==null&&(Nl.return=js),mP(Nr,js,!0,!0);else if(js.child!==null){js.child.return=js,js=js.child;continue}}if(js===Xr)break;for(;js.sibling===null;){if(js.return===null||js.return===Xr)return;js=js.return}js.sibling.return=js.return,js=js.sibling}};var iD=function(Nr,Xr,Fn,ss){for(var js=Xr.child;js!==null;){if(js.tag===5){var Nl=js.stateNode;Fn&&ss&&(Nl=Ox(Nl,js.type,js.memoizedProps,js)),qx(Nr,Nl)}else if(js.tag===6)Nl=js.stateNode,Fn&&ss&&(Nl=E2(Nl,js.memoizedProps,js)),qx(Nr,Nl);else if(js.tag!==4){if(js.tag===22&&js.memoizedState!==null)Nl=js.child,Nl!==null&&(Nl.return=js),iD(Nr,js,!0,!0);else if(js.child!==null){js.child.return=js,js=js.child;continue}}if(js===Xr)break;for(;js.sibling===null;){if(js.return===null||js.return===Xr)return;js=js.return}js.sibling.return=js.return,js=js.sibling}};gP=function(Nr,Xr){var Fn=Xr.stateNode;if(!nD(Nr,Xr)){Nr=Fn.containerInfo;var ss=vx(Nr);iD(ss,Xr,!1,!1),Fn.pendingChildren=ss,RC(Xr),Kx(Nr,ss)}},JP=function(Nr,Xr,Fn,ss,js){var Nl=Nr.stateNode,Op=Nr.memoizedProps;if((Nr=nD(Nr,Xr))&&Op===ss)Xr.stateNode=Nl;else{var w0=Xr.stateNode,Sv=CC(KE.current),Zy=null;Op!==ss&&(Zy=cu(w0,Fn,Op,ss,js,Sv)),Nr&&Zy===null?Xr.stateNode=Nl:(Nl=Uy(Nl,Zy,Fn,Op,ss,Xr,Nr,w0),uu(Nl,Fn,ss,js,Sv)&&RC(Xr),Xr.stateNode=Nl,Nr?RC(Xr):mP(Nl,Xr,!1,!1))}},QP=function(Nr,Xr,Fn,ss){Fn!==ss?(Nr=CC(GM.current),Fn=CC(KE.current),Xr.stateNode=mu(ss,Nr,Fn,Xr),RC(Xr)):Xr.stateNode=Nr.stateNode}}else gP=function(){},JP=function(){},QP=function(){};function vP(Nr,Xr){if(!eE)switch(Nr.tailMode){case"hidden":Xr=Nr.tail;for(var Fn=null;Xr!==null;)Xr.alternate!==null&&(Fn=Xr),Xr=Xr.sibling;Fn===null?Nr.tail=null:Fn.sibling=null;break;case"collapsed":Fn=Nr.tail;for(var ss=null;Fn!==null;)Fn.alternate!==null&&(ss=Fn),Fn=Fn.sibling;ss===null?Xr||Nr.tail===null?Nr.tail=null:Nr.tail.sibling=null:ss.sibling=null}}function AE(Nr){var Xr=Nr.alternate!==null&&Nr.alternate.child===Nr.child,Fn=0,ss=0;if(Xr)for(var js=Nr.child;js!==null;)Fn|=js.lanes|js.childLanes,ss|=js.subtreeFlags&14680064,ss|=js.flags&14680064,js.return=Nr,js=js.sibling;else for(js=Nr.child;js!==null;)Fn|=js.lanes|js.childLanes,ss|=js.subtreeFlags,ss|=js.flags,js.return=Nr,js=js.sibling;return Nr.subtreeFlags|=ss,Nr.childLanes=Fn,Xr}function t$(Nr,Xr,Fn){var ss=Xr.pendingProps;switch(R3(Xr),Xr.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return AE(Xr),null;case 1:return K2(Xr.type)&&Y2(),AE(Xr),null;case 3:return ss=Xr.stateNode,HM(),$x(d2),$x(I2),O3(),ss.pendingContext&&(ss.context=ss.pendingContext,ss.pendingContext=null),(Nr===null||Nr.child===null)&&(pT(Xr)?RC(Xr):Nr===null||Nr.memoizedState.isDehydrated&&!(Xr.flags&256)||(Xr.flags|=1024,yC!==null&&(dR(yC),yC=null))),gP(Nr,Xr),AE(Xr),null;case 5:L3(Xr),Fn=CC(GM.current);var js=Xr.type;if(Nr!==null&&Xr.stateNode!=null)JP(Nr,Xr,js,ss,Fn),Nr.ref!==Xr.ref&&(Xr.flags|=512,Xr.flags|=2097152);else{if(!ss){if(Xr.stateNode===null)throw Error(Mt(166));return AE(Xr),null}if(Nr=CC(KE.current),pT(Xr)){if(!Cp)throw Error(Mt(175));Nr=ru(Xr.stateNode,Xr.type,Xr.memoizedProps,Fn,Nr,Xr,!fT),Xr.updateQueue=Nr,Nr!==null&&RC(Xr)}else{var Nl=Oo(js,ss,Fn,Nr,Xr);mP(Nl,Xr,!1,!1),Xr.stateNode=Nl,uu(Nl,js,ss,Fn,Nr)&&RC(Xr)}Xr.ref!==null&&(Xr.flags|=512,Xr.flags|=2097152)}return AE(Xr),null;case 6:if(Nr&&Xr.stateNode!=null)QP(Nr,Xr,Nr.memoizedProps,ss);else{if(typeof ss!="string"&&Xr.stateNode===null)throw Error(Mt(166));if(Nr=CC(GM.current),Fn=CC(KE.current),pT(Xr)){if(!Cp)throw Error(Mt(176));if(Nr=Xr.stateNode,ss=Xr.memoizedProps,(Fn=Iu(Nr,ss,Xr,!fT))&&(js=zE,js!==null))switch(Nl=(js.mode&1)!==0,js.tag){case 3:Gy(js.stateNode.containerInfo,Nr,ss,Nl);break;case 5:jv(js.type,js.memoizedProps,js.stateNode,Nr,ss,Nl)}Fn&&RC(Xr)}else Xr.stateNode=mu(ss,Nr,Fn,Xr)}return AE(Xr),null;case 13:if($x(nE),ss=Xr.memoizedState,eE&&GE!==null&&Xr.mode&1&&!(Xr.flags&128)){for(Nr=GE;Nr;)Nr=ov(Nr);return VM(),Xr.flags|=98560,Xr}if(ss!==null&&ss.dehydrated!==null){if(ss=pT(Xr),Nr===null){if(!ss)throw Error(Mt(318));if(!Cp)throw Error(Mt(344));if(Nr=Xr.memoizedState,Nr=Nr!==null?Nr.dehydrated:null,!Nr)throw Error(Mt(317));Hp(Nr,Xr)}else VM(),!(Xr.flags&128)&&(Xr.memoizedState=null),Xr.flags|=4;return AE(Xr),null}return yC!==null&&(dR(yC),yC=null),Xr.flags&128?(Xr.lanes=Fn,Xr):(ss=ss!==null,Fn=!1,Nr===null?pT(Xr):Fn=Nr.memoizedState!==null,ss&&!Fn&&(Xr.child.flags|=8192,Xr.mode&1&&(Nr===null||nE.current&1?pE===0&&(pE=3):pR())),Xr.updateQueue!==null&&(Xr.flags|=4),AE(Xr),null);case 4:return HM(),gP(Nr,Xr),Nr===null&&_g(Xr.stateNode.containerInfo),AE(Xr),null;case 10:return vE(Xr.type._context),AE(Xr),null;case 17:return K2(Xr.type)&&Y2(),AE(Xr),null;case 19:if($x(nE),js=Xr.memoizedState,js===null)return AE(Xr),null;if(ss=(Xr.flags&128)!==0,Nl=js.rendering,Nl===null)if(ss)vP(js,!1);else{if(pE!==0||Nr!==null&&Nr.flags&128)for(Nr=Xr.child;Nr!==null;){if(Nl=NP(Nr),Nl!==null){for(Xr.flags|=128,vP(js,!1),Nr=Nl.updateQueue,Nr!==null&&(Xr.updateQueue=Nr,Xr.flags|=4),Xr.subtreeFlags=0,Nr=Fn,ss=Xr.child;ss!==null;)Fn=ss,js=Nr,Fn.flags&=14680066,Nl=Fn.alternate,Nl===null?(Fn.childLanes=0,Fn.lanes=js,Fn.child=null,Fn.subtreeFlags=0,Fn.memoizedProps=null,Fn.memoizedState=null,Fn.updateQueue=null,Fn.dependencies=null,Fn.stateNode=null):(Fn.childLanes=Nl.childLanes,Fn.lanes=Nl.lanes,Fn.child=Nl.child,Fn.subtreeFlags=0,Fn.deletions=null,Fn.memoizedProps=Nl.memoizedProps,Fn.memoizedState=Nl.memoizedState,Fn.updateQueue=Nl.updateQueue,Fn.type=Nl.type,js=Nl.dependencies,Fn.dependencies=js===null?null:{lanes:js.lanes,firstContext:js.firstContext}),ss=ss.sibling;return r2(nE,nE.current&1|2),Xr.child}Nr=Nr.sibling}js.tail!==null&&rE()>lR&&(Xr.flags|=128,ss=!0,vP(js,!1),Xr.lanes=4194304)}else{if(!ss)if(Nr=NP(Nl),Nr!==null){if(Xr.flags|=128,ss=!0,Nr=Nr.updateQueue,Nr!==null&&(Xr.updateQueue=Nr,Xr.flags|=4),vP(js,!0),js.tail===null&&js.tailMode==="hidden"&&!Nl.alternate&&!eE)return AE(Xr),null}else 2*rE()-js.renderingStartTime>lR&&Fn!==1073741824&&(Xr.flags|=128,ss=!0,vP(js,!1),Xr.lanes=4194304);js.isBackwards?(Nl.sibling=Xr.child,Xr.child=Nl):(Nr=js.last,Nr!==null?Nr.sibling=Nl:Xr.child=Nl,js.last=Nl)}return js.tail!==null?(Xr=js.tail,js.rendering=Xr,js.tail=Xr.sibling,js.renderingStartTime=rE(),Xr.sibling=null,Nr=nE.current,r2(nE,ss?Nr&1|2:Nr&1),Xr):(AE(Xr),null);case 22:case 23:return fR(),ss=Xr.memoizedState!==null,Nr!==null&&Nr.memoizedState!==null!==ss&&(Xr.flags|=8192),ss&&Xr.mode&1?HE&1073741824&&(AE(Xr),Ep&&Xr.subtreeFlags&6&&(Xr.flags|=8192)):AE(Xr),null;case 24:return null;case 25:return null}throw Error(Mt(156,Xr.tag))}var r$=Bt.ReactCurrentOwner,jE=!1;function DE(Nr,Xr,Fn,ss){Xr.child=Nr===null?$R(Xr,null,Fn,ss):zM(Xr,Nr.child,Fn,ss)}function sD(Nr,Xr,Fn,ss,js){Fn=Fn.render;var Nl=Xr.ref;return lE(Xr,js),ss=N3(Nr,Xr,Fn,ss,Nl,js),Fn=U3(),Nr!==null&&!jE?(Xr.updateQueue=Nr.updateQueue,Xr.flags&=-2053,Nr.lanes&=~js,GC(Nr,Xr,js)):(eE&&Fn&&P3(Xr),Xr.flags|=1,DE(Nr,Xr,ss,js),Xr.child)}function oD(Nr,Xr,Fn,ss,js){if(Nr===null){var Nl=Fn.type;return typeof Nl=="function"&&!mR(Nl)&&Nl.defaultProps===void 0&&Fn.compare===null&&Fn.defaultProps===void 0?(Xr.tag=15,Xr.type=Nl,aD(Nr,Xr,Nl,ss,js)):(Nr=S3(Fn.type,null,ss,Xr,Xr.mode,js),Nr.ref=Xr.ref,Nr.return=Xr,Xr.child=Nr)}if(Nl=Nr.child,!(Nr.lanes&js)){var Op=Nl.memoizedProps;if(Fn=Fn.compare,Fn=Fn!==null?Fn:yM,Fn(Op,ss)&&Nr.ref===Xr.ref)return GC(Nr,Xr,js)}return Xr.flags|=1,Nr=hM(Nl,ss),Nr.ref=Xr.ref,Nr.return=Xr,Xr.child=Nr}function aD(Nr,Xr,Fn,ss,js){if(Nr!==null&&yM(Nr.memoizedProps,ss)&&Nr.ref===Xr.ref)if(jE=!1,(Nr.lanes&js)!==0)Nr.flags&131072&&(jE=!0);else return Xr.lanes=Nr.lanes,GC(Nr,Xr,js);return W3(Nr,Xr,Fn,ss,js)}function lD(Nr,Xr,Fn){var ss=Xr.pendingProps,js=ss.children,Nl=Nr!==null?Nr.memoizedState:null;if(ss.mode==="hidden")if(!(Xr.mode&1))Xr.memoizedState={baseLanes:0,cachePool:null},r2(qM,HE),HE|=Fn;else if(Fn&1073741824)Xr.memoizedState={baseLanes:0,cachePool:null},ss=Nl!==null?Nl.baseLanes:Fn,r2(qM,HE),HE|=ss;else return Nr=Nl!==null?Nl.baseLanes|Fn:Fn,Xr.lanes=Xr.childLanes=1073741824,Xr.memoizedState={baseLanes:Nr,cachePool:null},Xr.updateQueue=null,r2(qM,HE),HE|=Nr,null;else Nl!==null?(ss=Nl.baseLanes|Fn,Xr.memoizedState=null):ss=Fn,r2(qM,HE),HE|=ss;return DE(Nr,Xr,js,Fn),Xr.child}function cD(Nr,Xr){var Fn=Xr.ref;(Nr===null&&Fn!==null||Nr!==null&&Nr.ref!==Fn)&&(Xr.flags|=512,Xr.flags|=2097152)}function W3(Nr,Xr,Fn,ss,js){var Nl=K2(Fn)?V2:I2.current;return Nl=iE(Xr,Nl),lE(Xr,js),Fn=N3(Nr,Xr,Fn,ss,Nl,js),ss=U3(),Nr!==null&&!jE?(Xr.updateQueue=Nr.updateQueue,Xr.flags&=-2053,Nr.lanes&=~js,GC(Nr,Xr,js)):(eE&&ss&&P3(Xr),Xr.flags|=1,DE(Nr,Xr,Fn,js),Xr.child)}function uD(Nr,Xr,Fn,ss,js){if(K2(Fn)){var Nl=!0;U2(Xr)}else Nl=!1;if(lE(Xr,js),Xr.stateNode===null)Nr!==null&&(Nr.alternate=null,Xr.alternate=null,Xr.flags|=2),ER(Xr,Fn,ss),T3(Xr,Fn,ss,js),ss=!0;else if(Nr===null){var Op=Xr.stateNode,w0=Xr.memoizedProps;Op.props=w0;var Sv=Op.context,Zy=Fn.contextType;typeof Zy=="object"&&Zy!==null?Zy=uE(Zy):(Zy=K2(Fn)?V2:I2.current,Zy=iE(Xr,Zy));var Ax=Fn.getDerivedStateFromProps,m2=typeof Ax=="function"||typeof Op.getSnapshotBeforeUpdate=="function";m2||typeof Op.UNSAFE_componentWillReceiveProps!="function"&&typeof Op.componentWillReceiveProps!="function"||(w0!==ss||Sv!==Zy)&&AR(Xr,Op,ss,Zy),qC=!1;var Qx=Xr.memoizedState;Op.state=Qx,IP(Xr,ss,Op,js),Sv=Xr.memoizedState,w0!==ss||Qx!==Sv||d2.current||qC?(typeof Ax=="function"&&(M3(Xr,Fn,Ax,ss),Sv=Xr.memoizedState),(w0=qC||SR(Xr,Fn,w0,ss,Qx,Sv,Zy))?(m2||typeof Op.UNSAFE_componentWillMount!="function"&&typeof Op.componentWillMount!="function"||(typeof Op.componentWillMount=="function"&&Op.componentWillMount(),typeof Op.UNSAFE_componentWillMount=="function"&&Op.UNSAFE_componentWillMount()),typeof Op.componentDidMount=="function"&&(Xr.flags|=4194308)):(typeof Op.componentDidMount=="function"&&(Xr.flags|=4194308),Xr.memoizedProps=ss,Xr.memoizedState=Sv),Op.props=ss,Op.state=Sv,Op.context=Zy,ss=w0):(typeof Op.componentDidMount=="function"&&(Xr.flags|=4194308),ss=!1)}else{Op=Xr.stateNode,xR(Nr,Xr),w0=Xr.memoizedProps,Zy=Xr.type===Xr.elementType?w0:PE(Xr.type,w0),Op.props=Zy,m2=Xr.pendingProps,Qx=Op.context,Sv=Fn.contextType,typeof Sv=="object"&&Sv!==null?Sv=uE(Sv):(Sv=K2(Fn)?V2:I2.current,Sv=iE(Xr,Sv));var W2=Fn.getDerivedStateFromProps;(Ax=typeof W2=="function"||typeof Op.getSnapshotBeforeUpdate=="function")||typeof Op.UNSAFE_componentWillReceiveProps!="function"&&typeof Op.componentWillReceiveProps!="function"||(w0!==m2||Qx!==Sv)&&AR(Xr,Op,ss,Sv),qC=!1,Qx=Xr.memoizedState,Op.state=Qx,IP(Xr,ss,Op,js);var jx=Xr.memoizedState;w0!==m2||Qx!==jx||d2.current||qC?(typeof W2=="function"&&(M3(Xr,Fn,W2,ss),jx=Xr.memoizedState),(Zy=qC||SR(Xr,Fn,Zy,ss,Qx,jx,Sv)||!1)?(Ax||typeof Op.UNSAFE_componentWillUpdate!="function"&&typeof Op.componentWillUpdate!="function"||(typeof Op.componentWillUpdate=="function"&&Op.componentWillUpdate(ss,jx,Sv),typeof Op.UNSAFE_componentWillUpdate=="function"&&Op.UNSAFE_componentWillUpdate(ss,jx,Sv)),typeof Op.componentDidUpdate=="function"&&(Xr.flags|=4),typeof Op.getSnapshotBeforeUpdate=="function"&&(Xr.flags|=1024)):(typeof Op.componentDidUpdate!="function"||w0===Nr.memoizedProps&&Qx===Nr.memoizedState||(Xr.flags|=4),typeof Op.getSnapshotBeforeUpdate!="function"||w0===Nr.memoizedProps&&Qx===Nr.memoizedState||(Xr.flags|=1024),Xr.memoizedProps=ss,Xr.memoizedState=jx),Op.props=ss,Op.state=jx,Op.context=Sv,ss=Zy):(typeof Op.componentDidUpdate!="function"||w0===Nr.memoizedProps&&Qx===Nr.memoizedState||(Xr.flags|=4),typeof Op.getSnapshotBeforeUpdate!="function"||w0===Nr.memoizedProps&&Qx===Nr.memoizedState||(Xr.flags|=1024),ss=!1)}return q3(Nr,Xr,Fn,ss,Nl,js)}function q3(Nr,Xr,Fn,ss,js,Nl){cD(Nr,Xr);var Op=(Xr.flags&128)!==0;if(!ss&&!Op)return js&&f2(Xr,Fn,!1),GC(Nr,Xr,Nl);ss=Xr.stateNode,r$.current=Xr;var w0=Op&&typeof Fn.getDerivedStateFromError!="function"?null:ss.render();return Xr.flags|=1,Nr!==null&&Op?(Xr.child=zM(Xr,Nr.child,null,Nl),Xr.child=zM(Xr,null,w0,Nl)):DE(Nr,Xr,w0,Nl),Xr.memoizedState=ss.state,js&&f2(Xr,Fn,!0),Xr.child}function hD(Nr){var Xr=Nr.stateNode;Xr.pendingContext?N2(Nr,Xr.pendingContext,Xr.pendingContext!==Xr.context):Xr.context&&N2(Nr,Xr.context,!1),B3(Nr,Xr.containerInfo)}function dD(Nr,Xr,Fn,ss,js){return VM(),I3(js),Xr.flags|=256,DE(Nr,Xr,Fn,ss),Xr.child}var ZP={dehydrated:null,treeContext:null,retryLane:0};function e3(Nr){return{baseLanes:Nr,cachePool:null}}function fD(Nr,Xr,Fn){var ss=Xr.pendingProps,js=nE.current,Nl=!1,Op=(Xr.flags&128)!==0,w0;if((w0=Op)||(w0=Nr!==null&&Nr.memoizedState===null?!1:(js&2)!==0),w0?(Nl=!0,Xr.flags&=-129):(Nr===null||Nr.memoizedState!==null)&&(js|=1),r2(nE,js&1),Nr===null)return $3(Xr),Nr=Xr.memoizedState,Nr!==null&&(Nr=Nr.dehydrated,Nr!==null)?(Xr.mode&1?Pp(Nr)?Xr.lanes=8:Xr.lanes=1073741824:Xr.lanes=1,null):(js=ss.children,Nr=ss.fallback,Nl?(ss=Xr.mode,Nl=Xr.child,js={mode:"hidden",children:js},!(ss&1)&&Nl!==null?(Nl.childLanes=0,Nl.pendingProps=js):Nl=E3(js,ss,0,null),Nr=$M(Nr,ss,Fn,null),Nl.return=Xr,Nr.return=Xr,Nl.sibling=Nr,Xr.child=Nl,Xr.child.memoizedState=e3(Fn),Xr.memoizedState=ZP,Nr):X3(Xr,js));if(js=Nr.memoizedState,js!==null){if(w0=js.dehydrated,w0!==null){if(Op)return Xr.flags&256?(Xr.flags&=-257,t3(Nr,Xr,Fn,Error(Mt(422)))):Xr.memoizedState!==null?(Xr.child=Nr.child,Xr.flags|=128,null):(Nl=ss.fallback,js=Xr.mode,ss=E3({mode:"visible",children:ss.children},js,0,null),Nl=$M(Nl,js,Fn,null),Nl.flags|=2,ss.return=Xr,Nl.return=Xr,ss.sibling=Nl,Xr.child=ss,Xr.mode&1&&zM(Xr,Nr.child,null,Fn),Xr.child.memoizedState=e3(Fn),Xr.memoizedState=ZP,Nl);if(!(Xr.mode&1))Xr=t3(Nr,Xr,Fn,null);else if(Pp(w0))Xr=t3(Nr,Xr,Fn,Error(Mt(419)));else if(ss=(Fn&Nr.childLanes)!==0,jE||ss){if(ss=dE,ss!==null){switch(Fn&-Fn){case 4:Nl=2;break;case 16:Nl=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Nl=32;break;case 536870912:Nl=268435456;break;default:Nl=0}ss=Nl&(ss.suspendedLanes|Fn)?0:Nl,ss!==0&&ss!==js.retryLane&&(js.retryLane=ss,JE(Nr,ss,-1))}pR(),Xr=t3(Nr,Xr,Fn,Error(Mt(421)))}else mE(w0)?(Xr.flags|=128,Xr.child=Nr.child,Xr=m$.bind(null,Nr),tv(w0,Xr),Xr=null):(Fn=js.treeContext,Cp&&(GE=Dx(w0),zE=Xr,eE=!0,yC=null,fT=!1,Fn!==null&&(qE[XE++]=UC,qE[XE++]=VC,qE[XE++]=_M,UC=Fn.id,VC=Fn.overflow,_M=Xr)),Xr=X3(Xr,Xr.pendingProps.children),Xr.flags|=4096);return Xr}return Nl?(ss=mD(Nr,Xr,ss.children,ss.fallback,Fn),Nl=Xr.child,js=Nr.child.memoizedState,Nl.memoizedState=js===null?e3(Fn):{baseLanes:js.baseLanes|Fn,cachePool:null},Nl.childLanes=Nr.childLanes&~Fn,Xr.memoizedState=ZP,ss):(Fn=pD(Nr,Xr,ss.children,Fn),Xr.memoizedState=null,Fn)}return Nl?(ss=mD(Nr,Xr,ss.children,ss.fallback,Fn),Nl=Xr.child,js=Nr.child.memoizedState,Nl.memoizedState=js===null?e3(Fn):{baseLanes:js.baseLanes|Fn,cachePool:null},Nl.childLanes=Nr.childLanes&~Fn,Xr.memoizedState=ZP,ss):(Fn=pD(Nr,Xr,ss.children,Fn),Xr.memoizedState=null,Fn)}function X3(Nr,Xr){return Xr=E3({mode:"visible",children:Xr},Nr.mode,0,null),Xr.return=Nr,Nr.child=Xr}function pD(Nr,Xr,Fn,ss){var js=Nr.child;return Nr=js.sibling,Fn=hM(js,{mode:"visible",children:Fn}),!(Xr.mode&1)&&(Fn.lanes=ss),Fn.return=Xr,Fn.sibling=null,Nr!==null&&(ss=Xr.deletions,ss===null?(Xr.deletions=[Nr],Xr.flags|=16):ss.push(Nr)),Xr.child=Fn}function mD(Nr,Xr,Fn,ss,js){var Nl=Xr.mode;Nr=Nr.child;var Op=Nr.sibling,w0={mode:"hidden",children:Fn};return!(Nl&1)&&Xr.child!==Nr?(Fn=Xr.child,Fn.childLanes=0,Fn.pendingProps=w0,Xr.deletions=null):(Fn=hM(Nr,w0),Fn.subtreeFlags=Nr.subtreeFlags&14680064),Op!==null?ss=hM(Op,ss):(ss=$M(ss,Nl,js,null),ss.flags|=2),ss.return=Xr,Fn.return=Xr,Fn.sibling=ss,Xr.child=Fn,ss}function t3(Nr,Xr,Fn,ss){return ss!==null&&I3(ss),zM(Xr,Nr.child,null,Fn),Nr=X3(Xr,Xr.pendingProps.children),Nr.flags|=2,Xr.memoizedState=null,Nr}function gD(Nr,Xr,Fn){Nr.lanes|=Xr;var ss=Nr.alternate;ss!==null&&(ss.lanes|=Xr),RE(Nr.return,Xr,Fn)}function K3(Nr,Xr,Fn,ss,js){var Nl=Nr.memoizedState;Nl===null?Nr.memoizedState={isBackwards:Xr,rendering:null,renderingStartTime:0,last:ss,tail:Fn,tailMode:js}:(Nl.isBackwards=Xr,Nl.rendering=null,Nl.renderingStartTime=0,Nl.last=ss,Nl.tail=Fn,Nl.tailMode=js)}function vD(Nr,Xr,Fn){var ss=Xr.pendingProps,js=ss.revealOrder,Nl=ss.tail;if(DE(Nr,Xr,ss.children,Fn),ss=nE.current,ss&2)ss=ss&1|2,Xr.flags|=128;else{if(Nr!==null&&Nr.flags&128)e:for(Nr=Xr.child;Nr!==null;){if(Nr.tag===13)Nr.memoizedState!==null&&gD(Nr,Fn,Xr);else if(Nr.tag===19)gD(Nr,Fn,Xr);else if(Nr.child!==null){Nr.child.return=Nr,Nr=Nr.child;continue}if(Nr===Xr)break e;for(;Nr.sibling===null;){if(Nr.return===null||Nr.return===Xr)break e;Nr=Nr.return}Nr.sibling.return=Nr.return,Nr=Nr.sibling}ss&=1}if(r2(nE,ss),!(Xr.mode&1))Xr.memoizedState=null;else switch(js){case"forwards":for(Fn=Xr.child,js=null;Fn!==null;)Nr=Fn.alternate,Nr!==null&&NP(Nr)===null&&(js=Fn),Fn=Fn.sibling;Fn=js,Fn===null?(js=Xr.child,Xr.child=null):(js=Fn.sibling,Fn.sibling=null),K3(Xr,!1,js,Fn,Nl);break;case"backwards":for(Fn=null,js=Xr.child,Xr.child=null;js!==null;){if(Nr=js.alternate,Nr!==null&&NP(Nr)===null){Xr.child=js;break}Nr=js.sibling,js.sibling=Fn,Fn=js,js=Nr}K3(Xr,!0,Fn,null,Nl);break;case"together":K3(Xr,!1,null,null,void 0);break;default:Xr.memoizedState=null}return Xr.child}function GC(Nr,Xr,Fn){if(Nr!==null&&(Xr.dependencies=Nr.dependencies),XM|=Xr.lanes,!(Fn&Xr.childLanes))return null;if(Nr!==null&&Xr.child!==Nr.child)throw Error(Mt(153));if(Xr.child!==null){for(Nr=Xr.child,Fn=hM(Nr,Nr.pendingProps),Xr.child=Fn,Fn.return=Xr;Nr.sibling!==null;)Nr=Nr.sibling,Fn=Fn.sibling=hM(Nr,Nr.pendingProps),Fn.return=Xr;Fn.sibling=null}return Xr.child}function n$(Nr,Xr,Fn){switch(Xr.tag){case 3:hD(Xr),VM();break;case 5:IR(Xr);break;case 1:K2(Xr.type)&&U2(Xr);break;case 4:B3(Xr,Xr.stateNode.containerInfo);break;case 10:RP(Xr,Xr.type._context,Xr.memoizedProps.value);break;case 13:var ss=Xr.memoizedState;if(ss!==null)return ss.dehydrated!==null?(r2(nE,nE.current&1),Xr.flags|=128,null):Fn&Xr.child.childLanes?fD(Nr,Xr,Fn):(r2(nE,nE.current&1),Nr=GC(Nr,Xr,Fn),Nr!==null?Nr.sibling:null);r2(nE,nE.current&1);break;case 19:if(ss=(Fn&Xr.childLanes)!==0,Nr.flags&128){if(ss)return vD(Nr,Xr,Fn);Xr.flags|=128}var js=Xr.memoizedState;if(js!==null&&(js.rendering=null,js.tail=null,js.lastEffect=null),r2(nE,nE.current),ss)break;return null;case 22:case 23:return Xr.lanes=0,lD(Nr,Xr,Fn)}return GC(Nr,Xr,Fn)}function i$(Nr,Xr){switch(R3(Xr),Xr.tag){case 1:return K2(Xr.type)&&Y2(),Nr=Xr.flags,Nr&65536?(Xr.flags=Nr&-65537|128,Xr):null;case 3:return HM(),$x(d2),$x(I2),O3(),Nr=Xr.flags,Nr&65536&&!(Nr&128)?(Xr.flags=Nr&-65537|128,Xr):null;case 5:return L3(Xr),null;case 13:if($x(nE),Nr=Xr.memoizedState,Nr!==null&&Nr.dehydrated!==null){if(Xr.alternate===null)throw Error(Mt(340));VM()}return Nr=Xr.flags,Nr&65536?(Xr.flags=Nr&-65537|128,Xr):null;case 19:return $x(nE),null;case 4:return HM(),null;case 10:return vE(Xr.type._context),null;case 22:case 23:return fR(),null;case 24:return null;default:return null}}var r3=!1,EM=!1,s$=typeof WeakSet=="function"?WeakSet:Set,xx=null;function n3(Nr,Xr){var Fn=Nr.ref;if(Fn!==null)if(typeof Fn=="function")try{Fn(null)}catch(ss){OE(Nr,Xr,ss)}else Fn.current=null}function Y3(Nr,Xr,Fn){try{Fn()}catch(ss){OE(Nr,Xr,ss)}}var yD=!1;function o$(Nr,Xr){for(eo(Nr.containerInfo),xx=Xr;xx!==null;)if(Nr=xx,Xr=Nr.child,(Nr.subtreeFlags&1028)!==0&&Xr!==null)Xr.return=Nr,xx=Xr;else for(;xx!==null;){Nr=xx;try{var Fn=Nr.alternate;if(Nr.flags&1024)switch(Nr.tag){case 0:case 11:case 15:break;case 1:if(Fn!==null){var ss=Fn.memoizedProps,js=Fn.memoizedState,Nl=Nr.stateNode,Op=Nl.getSnapshotBeforeUpdate(Nr.elementType===Nr.type?ss:PE(Nr.type,ss),js);Nl.__reactInternalSnapshotBeforeUpdate=Op}break;case 3:Ep&&qy(Nr.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(Mt(163))}}catch(w0){OE(Nr,Nr.return,w0)}if(Xr=Nr.sibling,Xr!==null){Xr.return=Nr.return,xx=Xr;break}xx=Nr.return}return Fn=yD,yD=!1,Fn}function AM(Nr,Xr,Fn){var ss=Xr.updateQueue;if(ss=ss!==null?ss.lastEffect:null,ss!==null){var js=ss=ss.next;do{if((js.tag&Nr)===Nr){var Nl=js.destroy;js.destroy=void 0,Nl!==void 0&&Y3(Xr,Fn,Nl)}js=js.next}while(js!==ss)}}function yP(Nr,Xr){if(Xr=Xr.updateQueue,Xr=Xr!==null?Xr.lastEffect:null,Xr!==null){var Fn=Xr=Xr.next;do{if((Fn.tag&Nr)===Nr){var ss=Fn.create;Fn.destroy=ss()}Fn=Fn.next}while(Fn!==Xr)}}function J3(Nr){var Xr=Nr.ref;if(Xr!==null){var Fn=Nr.stateNode;switch(Nr.tag){case 5:Nr=_o(Fn);break;default:Nr=Fn}typeof Xr=="function"?Xr(Nr):Xr.current=Nr}}function xD(Nr,Xr,Fn){if(NE&&typeof NE.onCommitFiberUnmount=="function")try{NE.onCommitFiberUnmount(gM,Xr)}catch{}switch(Xr.tag){case 0:case 11:case 14:case 15:if(Nr=Xr.updateQueue,Nr!==null&&(Nr=Nr.lastEffect,Nr!==null)){var ss=Nr=Nr.next;do{var js=ss,Nl=js.destroy;js=js.tag,Nl!==void 0&&(js&2||js&4)&&Y3(Xr,Fn,Nl),ss=ss.next}while(ss!==Nr)}break;case 1:if(n3(Xr,Fn),Nr=Xr.stateNode,typeof Nr.componentWillUnmount=="function")try{Nr.props=Xr.memoizedProps,Nr.state=Xr.memoizedState,Nr.componentWillUnmount()}catch(Op){OE(Xr,Fn,Op)}break;case 5:n3(Xr,Fn);break;case 4:Ep?AD(Nr,Xr,Fn):mp&&mp&&(Xr=Xr.stateNode.containerInfo,Fn=vx(Xr),Mx(Xr,Fn))}}function _D(Nr,Xr,Fn){for(var ss=Xr;;)if(xD(Nr,ss,Fn),ss.child===null||Ep&&ss.tag===4){if(ss===Xr)break;for(;ss.sibling===null;){if(ss.return===null||ss.return===Xr)return;ss=ss.return}ss.sibling.return=ss.return,ss=ss.sibling}else ss.child.return=ss,ss=ss.child}function bD(Nr){var Xr=Nr.alternate;Xr!==null&&(Nr.alternate=null,bD(Xr)),Nr.child=null,Nr.deletions=null,Nr.sibling=null,Nr.tag===5&&(Xr=Nr.stateNode,Xr!==null&&K0(Xr)),Nr.stateNode=null,Nr.return=null,Nr.dependencies=null,Nr.memoizedProps=null,Nr.memoizedState=null,Nr.pendingProps=null,Nr.stateNode=null,Nr.updateQueue=null}function wD(Nr){return Nr.tag===5||Nr.tag===3||Nr.tag===4}function SD(Nr){e:for(;;){for(;Nr.sibling===null;){if(Nr.return===null||wD(Nr.return))return null;Nr=Nr.return}for(Nr.sibling.return=Nr.return,Nr=Nr.sibling;Nr.tag!==5&&Nr.tag!==6&&Nr.tag!==18;){if(Nr.flags&2||Nr.child===null||Nr.tag===4)continue e;Nr.child.return=Nr,Nr=Nr.child}if(!(Nr.flags&2))return Nr.stateNode}}function ED(Nr){if(Ep){e:{for(var Xr=Nr.return;Xr!==null;){if(wD(Xr))break e;Xr=Xr.return}throw Error(Mt(160))}var Fn=Xr;switch(Fn.tag){case 5:Xr=Fn.stateNode,Fn.flags&32&&(sv(Xr),Fn.flags&=-33),Fn=SD(Nr),Z3(Nr,Fn,Xr);break;case 3:case 4:Xr=Fn.stateNode.containerInfo,Fn=SD(Nr),Q3(Nr,Fn,Xr);break;default:throw Error(Mt(161))}}}function Q3(Nr,Xr,Fn){var ss=Nr.tag;if(ss===5||ss===6)Nr=Nr.stateNode,Xr?Dv(Fn,Nr,Xr):lv(Fn,Nr);else if(ss!==4&&(Nr=Nr.child,Nr!==null))for(Q3(Nr,Xr,Fn),Nr=Nr.sibling;Nr!==null;)Q3(Nr,Xr,Fn),Nr=Nr.sibling}function Z3(Nr,Xr,Fn){var ss=Nr.tag;if(ss===5||ss===6)Nr=Nr.stateNode,Xr?Gv(Fn,Nr,Xr):av(Fn,Nr);else if(ss!==4&&(Nr=Nr.child,Nr!==null))for(Z3(Nr,Xr,Fn),Nr=Nr.sibling;Nr!==null;)Z3(Nr,Xr,Fn),Nr=Nr.sibling}function AD(Nr,Xr,Fn){for(var ss=Xr,js=!1,Nl,Op;;){if(!js){js=ss.return;e:for(;;){if(js===null)throw Error(Mt(160));switch(Nl=js.stateNode,js.tag){case 5:Op=!1;break e;case 3:Nl=Nl.containerInfo,Op=!0;break e;case 4:Nl=Nl.containerInfo,Op=!0;break e}js=js.return}js=!0}if(ss.tag===5||ss.tag===6)_D(Nr,ss,Fn),Op?Kp(Nl,ss.stateNode):Cv(Nl,ss.stateNode);else if(ss.tag===18)Op?kv(Nl,ss.stateNode):Fv(Nl,ss.stateNode);else if(ss.tag===4){if(ss.child!==null){Nl=ss.stateNode.containerInfo,Op=!0,ss.child.return=ss,ss=ss.child;continue}}else if(xD(Nr,ss,Fn),ss.child!==null){ss.child.return=ss,ss=ss.child;continue}if(ss===Xr)break;for(;ss.sibling===null;){if(ss.return===null||ss.return===Xr)return;ss=ss.return,ss.tag===4&&(js=!1)}ss.sibling.return=ss.return,ss=ss.sibling}}function eR(Nr,Xr){if(Ep){switch(Xr.tag){case 0:case 11:case 14:case 15:AM(3,Xr,Xr.return),yP(3,Xr),AM(5,Xr,Xr.return);return;case 1:return;case 5:var Fn=Xr.stateNode;if(Fn!=null){var ss=Xr.memoizedProps;Nr=Nr!==null?Nr.memoizedProps:ss;var js=Xr.type,Nl=Xr.updateQueue;Xr.updateQueue=null,Nl!==null&&Uv(Fn,Nl,js,Nr,ss,Xr)}return;case 6:if(Xr.stateNode===null)throw Error(Mt(162));Fn=Xr.memoizedProps,N0(Xr.stateNode,Nr!==null?Nr.memoizedProps:Fn,Fn);return;case 3:Cp&&Nr!==null&&Nr.memoizedState.isDehydrated&&H0(Xr.stateNode.containerInfo);return;case 12:return;case 13:i3(Xr);return;case 19:i3(Xr);return;case 17:return}throw Error(Mt(163))}switch(Xr.tag){case 0:case 11:case 14:case 15:AM(3,Xr,Xr.return),yP(3,Xr),AM(5,Xr,Xr.return);return;case 12:return;case 13:i3(Xr);return;case 19:i3(Xr);return;case 3:Cp&&Nr!==null&&Nr.memoizedState.isDehydrated&&H0(Xr.stateNode.containerInfo);break;case 22:case 23:return}e:if(mp){switch(Xr.tag){case 1:case 5:case 6:break e;case 3:case 4:Xr=Xr.stateNode,Mx(Xr.containerInfo,Xr.pendingChildren);break e}throw Error(Mt(163))}}function i3(Nr){var Xr=Nr.updateQueue;if(Xr!==null){Nr.updateQueue=null;var Fn=Nr.stateNode;Fn===null&&(Fn=Nr.stateNode=new s$),Xr.forEach(function(ss){var js=g$.bind(null,Nr,ss);Fn.has(ss)||(Fn.add(ss),ss.then(js,js))})}}function a$(Nr,Xr){for(xx=Xr;xx!==null;){Xr=xx;var Fn=Xr.deletions;if(Fn!==null)for(var ss=0;ss<Fn.length;ss++){var js=Fn[ss];try{var Nl=Nr;Ep?AD(Nl,js,Xr):_D(Nl,js,Xr);var Op=js.alternate;Op!==null&&(Op.return=null),js.return=null}catch(Lx){OE(js,Xr,Lx)}}if(Fn=Xr.child,Xr.subtreeFlags&12854&&Fn!==null)Fn.return=Xr,xx=Fn;else for(;xx!==null;){Xr=xx;try{var w0=Xr.flags;if(w0&32&&Ep&&sv(Xr.stateNode),w0&512){var Sv=Xr.alternate;if(Sv!==null){var Zy=Sv.ref;Zy!==null&&(typeof Zy=="function"?Zy(null):Zy.current=null)}}if(w0&8192)switch(Xr.tag){case 13:if(Xr.memoizedState!==null){var Ax=Xr.alternate;(Ax===null||Ax.memoizedState===null)&&(aR=rE())}break;case 22:var m2=Xr.memoizedState!==null,Qx=Xr.alternate,W2=Qx!==null&&Qx.memoizedState!==null;if(Fn=Xr,Ep){e:if(ss=Fn,js=m2,Nl=null,Ep)for(var jx=ss;;){if(jx.tag===5){if(Nl===null){Nl=jx;var CE=jx.stateNode;js?Hv(CE):Fp(jx.stateNode,jx.memoizedProps)}}else if(jx.tag===6){if(Nl===null){var ZE=jx.stateNode;js?jp(ZE):nv(ZE,jx.memoizedProps)}}else if((jx.tag!==22&&jx.tag!==23||jx.memoizedState===null||jx===ss)&&jx.child!==null){jx.child.return=jx,jx=jx.child;continue}if(jx===ss)break;for(;jx.sibling===null;){if(jx.return===null||jx.return===ss)break e;Nl===jx&&(Nl=null),jx=jx.return}Nl===jx&&(Nl=null),jx.sibling.return=jx.return,jx=jx.sibling}}if(m2&&!W2&&Fn.mode&1){xx=Fn;for(var iv=Fn.child;iv!==null;){for(Fn=xx=iv;xx!==null;){ss=xx;var P0=ss.child;switch(ss.tag){case 0:case 11:case 14:case 15:AM(4,ss,ss.return);break;case 1:n3(ss,ss.return);var wv=ss.stateNode;if(typeof wv.componentWillUnmount=="function"){var Sx=ss.return;try{wv.props=ss.memoizedProps,wv.state=ss.memoizedState,wv.componentWillUnmount()}catch(Lx){OE(ss,Sx,Lx)}}break;case 5:n3(ss,ss.return);break;case 22:if(ss.memoizedState!==null){TD(Fn);continue}}P0!==null?(P0.return=ss,xx=P0):TD(Fn)}iv=iv.sibling}}}switch(w0&4102){case 2:ED(Xr),Xr.flags&=-3;break;case 6:ED(Xr),Xr.flags&=-3,eR(Xr.alternate,Xr);break;case 4096:Xr.flags&=-4097;break;case 4100:Xr.flags&=-4097,eR(Xr.alternate,Xr);break;case 4:eR(Xr.alternate,Xr)}}catch(Lx){OE(Xr,Xr.return,Lx)}if(Fn=Xr.sibling,Fn!==null){Fn.return=Xr.return,xx=Fn;break}xx=Xr.return}}}function l$(Nr,Xr,Fn){xx=Nr,CD(Nr)}function CD(Nr,Xr,Fn){for(var ss=(Nr.mode&1)!==0;xx!==null;){var js=xx,Nl=js.child;if(js.tag===22&&ss){var Op=js.memoizedState!==null||r3;if(!Op){var w0=js.alternate,Sv=w0!==null&&w0.memoizedState!==null||EM;w0=r3;var Zy=EM;if(r3=Op,(EM=Sv)&&!Zy)for(xx=js;xx!==null;)Op=xx,Sv=Op.child,Op.tag===22&&Op.memoizedState!==null?PD(js):Sv!==null?(Sv.return=Op,xx=Sv):PD(js);for(;Nl!==null;)xx=Nl,CD(Nl),Nl=Nl.sibling;xx=js,r3=w0,EM=Zy}MD(Nr)}else js.subtreeFlags&8772&&Nl!==null?(Nl.return=js,xx=Nl):MD(Nr)}}function MD(Nr){for(;xx!==null;){var Xr=xx;if(Xr.flags&8772){var Fn=Xr.alternate;try{if(Xr.flags&8772)switch(Xr.tag){case 0:case 11:case 15:EM||yP(5,Xr);break;case 1:var ss=Xr.stateNode;if(Xr.flags&4&&!EM)if(Fn===null)ss.componentDidMount();else{var js=Xr.elementType===Xr.type?Fn.memoizedProps:PE(Xr.type,Fn.memoizedProps);ss.componentDidUpdate(js,Fn.memoizedState,ss.__reactInternalSnapshotBeforeUpdate)}var Nl=Xr.updateQueue;Nl!==null&&bR(Xr,Nl,ss);break;case 3:var Op=Xr.updateQueue;if(Op!==null){if(Fn=null,Xr.child!==null)switch(Xr.child.tag){case 5:Fn=_o(Xr.child.stateNode);break;case 1:Fn=Xr.child.stateNode}bR(Xr,Op,Fn)}break;case 5:var w0=Xr.stateNode;Fn===null&&Xr.flags&4&&zv(w0,Xr.type,Xr.memoizedProps,Xr);break;case 6:break;case 4:break;case 12:break;case 13:if(Cp&&Xr.memoizedState===null){var Sv=Xr.alternate;if(Sv!==null){var Zy=Sv.memoizedState;if(Zy!==null){var Ax=Zy.dehydrated;Ax!==null&&Z0(Ax)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(Mt(163))}EM||Xr.flags&512&&J3(Xr)}catch(m2){OE(Xr,Xr.return,m2)}}if(Xr===Nr){xx=null;break}if(Fn=Xr.sibling,Fn!==null){Fn.return=Xr.return,xx=Fn;break}xx=Xr.return}}function TD(Nr){for(;xx!==null;){var Xr=xx;if(Xr===Nr){xx=null;break}var Fn=Xr.sibling;if(Fn!==null){Fn.return=Xr.return,xx=Fn;break}xx=Xr.return}}function PD(Nr){for(;xx!==null;){var Xr=xx;try{switch(Xr.tag){case 0:case 11:case 15:var Fn=Xr.return;try{yP(4,Xr)}catch(Sv){OE(Xr,Fn,Sv)}break;case 1:var ss=Xr.stateNode;if(typeof ss.componentDidMount=="function"){var js=Xr.return;try{ss.componentDidMount()}catch(Sv){OE(Xr,js,Sv)}}var Nl=Xr.return;try{J3(Xr)}catch(Sv){OE(Xr,Nl,Sv)}break;case 5:var Op=Xr.return;try{J3(Xr)}catch(Sv){OE(Xr,Op,Sv)}}}catch(Sv){OE(Xr,Xr.return,Sv)}if(Xr===Nr){xx=null;break}var w0=Xr.sibling;if(w0!==null){w0.return=Xr.return,xx=w0;break}xx=Xr.return}}var s3=0,o3=1,l3=2,u3=3,h3=4;if(typeof Symbol=="function"&&Symbol.for){var xP=Symbol.for;s3=xP("selector.component"),o3=xP("selector.has_pseudo_class"),l3=xP("selector.role"),u3=xP("selector.test_id"),h3=xP("selector.text")}function tR(Nr){var Xr=t0(Nr);if(Xr!=null){if(typeof Xr.memoizedProps["data-testname"]!="string")throw Error(Mt(364));return Xr}if(Nr=jm(Nr),Nr===null)throw Error(Mt(362));return Nr.stateNode.current}function rR(Nr,Xr){switch(Xr.$$typeof){case s3:if(Nr.type===Xr.value)return!0;break;case o3:e:{Xr=Xr.value,Nr=[Nr,0];for(var Fn=0;Fn<Nr.length;){var ss=Nr[Fn++],js=Nr[Fn++],Nl=Xr[js];if(ss.tag!==5||!Bp(ss)){for(;Nl!=null&&rR(ss,Nl);)js++,Nl=Xr[js];if(js===Xr.length){Xr=!0;break e}else for(ss=ss.child;ss!==null;)Nr.push(ss,js),ss=ss.sibling}}Xr=!1}return Xr;case l3:if(Nr.tag===5&&a0(Nr.stateNode,Xr.value))return!0;break;case h3:if((Nr.tag===5||Nr.tag===6)&&(Nr=Co(Nr),Nr!==null&&0<=Nr.indexOf(Xr.value)))return!0;break;case u3:if(Nr.tag===5&&(Nr=Nr.memoizedProps["data-testname"],typeof Nr=="string"&&Nr.toLowerCase()===Xr.value.toLowerCase()))return!0;break;default:throw Error(Mt(365))}return!1}function nR(Nr){switch(Nr.$$typeof){case s3:return"<"+($n(Nr.value)||"Unknown")+">";case o3:return":has("+(nR(Nr)||"")+")";case l3:return'[role="'+Nr.value+'"]';case h3:return'"'+Nr.value+'"';case u3:return'[data-testname="'+Nr.value+'"]';default:throw Error(Mt(365))}}function RD(Nr,Xr){var Fn=[];Nr=[Nr,0];for(var ss=0;ss<Nr.length;){var js=Nr[ss++],Nl=Nr[ss++],Op=Xr[Nl];if(js.tag!==5||!Bp(js)){for(;Op!=null&&rR(js,Op);)Nl++,Op=Xr[Nl];if(Nl===Xr.length)Fn.push(js);else for(js=js.child;js!==null;)Nr.push(js,Nl),js=js.sibling}}return Fn}function iR(Nr,Xr){if(!z0)throw Error(Mt(363));Nr=tR(Nr),Nr=RD(Nr,Xr),Xr=[],Nr=Array.from(Nr);for(var Fn=0;Fn<Nr.length;){var ss=Nr[Fn++];if(ss.tag===5)Bp(ss)||Xr.push(ss.stateNode);else for(ss=ss.child;ss!==null;)Nr.push(ss),ss=ss.sibling}return Xr}var c$=Math.ceil,d3=Bt.ReactCurrentDispatcher,sR=Bt.ReactCurrentOwner,hE=Bt.ReactCurrentBatchConfig,R2=0,dE=null,fE=null,wE=0,HE=0,qM=Hx(0),pE=0,bP=null,XM=0,f3=0,oR=0,EP=null,LE=null,aR=0,lR=1/0;function KM(){lR=rE()+500}var p3=!1,cR=null,ZC=null,m3=!1,nM=null,g3=0,AP=0,uR=null,y3=-1,x3=0;function $E(){return R2&6?rE():y3!==-1?y3:y3=rE()}function iM(Nr){return Nr.mode&1?R2&2&&wE!==0?wE&-wE:vM.transition!==null?(x3===0&&(Nr=DC,DC<<=1,!(DC&4194240)&&(DC=64),x3=Nr),x3):(Nr=D2,Nr!==0?Nr:m0()):1}function JE(Nr,Xr,Fn){if(50<AP)throw AP=0,uR=null,Error(Mt(185));var ss=_3(Nr,Xr);return ss===null?null:(_C(ss,Xr,Fn),(!(R2&2)||ss!==dE)&&(ss===dE&&(!(R2&2)&&(f3|=Xr),pE===4&&sM(ss,wE)),kE(ss,Fn),Xr===1&&R2===0&&!(Nr.mode&1)&&(KM(),EC&&BE())),ss)}function _3(Nr,Xr){Nr.lanes|=Xr;var Fn=Nr.alternate;for(Fn!==null&&(Fn.lanes|=Xr),Fn=Nr,Nr=Nr.return;Nr!==null;)Nr.childLanes|=Xr,Fn=Nr.alternate,Fn!==null&&(Fn.childLanes|=Xr),Fn=Nr,Nr=Nr.return;return Fn.tag===3?Fn.stateNode:null}function kE(Nr,Xr){var Fn=Nr.callbackNode;JM(Nr,Xr);var ss=pM(Nr,Nr===dE?wE:0);if(ss===0)Fn!==null&&kM(Fn),Nr.callbackNode=null,Nr.callbackPriority=0;else if(Xr=ss&-ss,Nr.callbackPriority!==Xr){if(Fn!=null&&kM(Fn),Xr===1)Nr.tag===0?hT($D.bind(null,Nr)):aT($D.bind(null,Nr)),Jp?y0(function(){R2===0&&BE()}):FC(mM,BE),Fn=null;else{switch(QM(ss)){case 1:Fn=mM;break;case 4:Fn=TP;break;case 16:Fn=ME;break;case 536870912:Fn=iT;break;default:Fn=ME}Fn=VD(Fn,DD.bind(null,Nr))}Nr.callbackPriority=Xr,Nr.callbackNode=Fn}}function DD(Nr,Xr){if(y3=-1,x3=0,R2&6)throw Error(Mt(327));var Fn=Nr.callbackNode;if(PM()&&Nr.callbackNode!==Fn)return null;var ss=pM(Nr,Nr===dE?wE:0);if(ss===0)return null;if(ss&30||ss&Nr.expiredLanes||Xr)Xr=w3(Nr,ss);else{Xr=ss;var js=R2;R2|=2;var Nl=LD();(dE!==Nr||wE!==Xr)&&(KM(),CM(Nr,Xr));do try{d$();break}catch(w0){BD(Nr,w0)}while(!0);FM(),d3.current=Nl,R2=js,fE!==null?Xr=0:(dE=null,wE=0,Xr=pE)}if(Xr!==0){if(Xr===2&&(js=kC(Nr),js!==0&&(ss=js,Xr=hR(Nr,js))),Xr===1)throw Fn=bP,CM(Nr,0),sM(Nr,ss),kE(Nr,rE()),Fn;if(Xr===6)sM(Nr,ss);else{if(js=Nr.current.alternate,!(ss&30)&&!u$(js)&&(Xr=w3(Nr,ss),Xr===2&&(Nl=kC(Nr),Nl!==0&&(ss=Nl,Xr=hR(Nr,Nl))),Xr===1))throw Fn=bP,CM(Nr,0),sM(Nr,ss),kE(Nr,rE()),Fn;switch(Nr.finishedWork=js,Nr.finishedLanes=ss,Xr){case 0:case 1:throw Error(Mt(345));case 2:TM(Nr,LE);break;case 3:if(sM(Nr,ss),(ss&130023424)===ss&&(Xr=aR+500-rE(),10<Xr)){if(pM(Nr,0)!==0)break;if(js=Nr.suspendedLanes,(js&ss)!==ss){$E(),Nr.pingedLanes|=Nr.suspendedLanes&js;break}Nr.timeoutHandle=pu(TM.bind(null,Nr,LE),Xr);break}TM(Nr,LE);break;case 4:if(sM(Nr,ss),(ss&4194240)===ss)break;for(Xr=Nr.eventTimes,js=-1;0<ss;){var Op=31-q2(ss);Nl=1<<Op,Op=Xr[Op],Op>js&&(js=Op),ss&=~Nl}if(ss=js,ss=rE()-ss,ss=(120>ss?120:480>ss?480:1080>ss?1080:1920>ss?1920:3e3>ss?3e3:4320>ss?4320:1960*c$(ss/1960))-ss,10<ss){Nr.timeoutHandle=pu(TM.bind(null,Nr,LE),ss);break}TM(Nr,LE);break;case 5:TM(Nr,LE);break;default:throw Error(Mt(329))}}}return kE(Nr,rE()),Nr.callbackNode===Fn?DD.bind(null,Nr):null}function hR(Nr,Xr){var Fn=EP;return Nr.current.memoizedState.isDehydrated&&(CM(Nr,Xr).flags|=256),Nr=w3(Nr,Xr),Nr!==2&&(Xr=LE,LE=Fn,Xr!==null&&dR(Xr)),Nr}function dR(Nr){LE===null?LE=Nr:LE.push.apply(LE,Nr)}function u$(Nr){for(var Xr=Nr;;){if(Xr.flags&16384){var Fn=Xr.updateQueue;if(Fn!==null&&(Fn=Fn.stores,Fn!==null))for(var ss=0;ss<Fn.length;ss++){var js=Fn[ss],Nl=js.getSnapshot;js=js.value;try{if(!UE(Nl(),js))return!1}catch{return!1}}}if(Fn=Xr.child,Xr.subtreeFlags&16384&&Fn!==null)Fn.return=Xr,Xr=Fn;else{if(Xr===Nr)break;for(;Xr.sibling===null;){if(Xr.return===null||Xr.return===Nr)return!0;Xr=Xr.return}Xr.sibling.return=Xr.return,Xr=Xr.sibling}}return!0}function sM(Nr,Xr){for(Xr&=~oR,Xr&=~f3,Nr.suspendedLanes|=Xr,Nr.pingedLanes&=~Xr,Nr=Nr.expirationTimes;0<Xr;){var Fn=31-q2(Xr),ss=1<<Fn;Nr[Fn]=-1,Xr&=~ss}}function $D(Nr){if(R2&6)throw Error(Mt(327));PM();var Xr=pM(Nr,0);if(!(Xr&1))return kE(Nr,rE()),null;var Fn=w3(Nr,Xr);if(Nr.tag!==0&&Fn===2){var ss=kC(Nr);ss!==0&&(Xr=ss,Fn=hR(Nr,ss))}if(Fn===1)throw Fn=bP,CM(Nr,0),sM(Nr,Xr),kE(Nr,rE()),Fn;if(Fn===6)throw Error(Mt(345));return Nr.finishedWork=Nr.current.alternate,Nr.finishedLanes=Xr,TM(Nr,LE),kE(Nr,rE()),null}function ID(Nr){nM!==null&&nM.tag===0&&!(R2&6)&&PM();var Xr=R2;R2|=1;var Fn=hE.transition,ss=D2;try{if(hE.transition=null,D2=1,Nr)return Nr()}finally{D2=ss,hE.transition=Fn,R2=Xr,!(R2&6)&&BE()}}function fR(){HE=qM.current,$x(qM)}function CM(Nr,Xr){Nr.finishedWork=null,Nr.finishedLanes=0;var Fn=Nr.timeoutHandle;if(Fn!==Mp&&(Nr.timeoutHandle=Mp,Zu(Fn)),fE!==null)for(Fn=fE.return;Fn!==null;){var ss=Fn;switch(R3(ss),ss.tag){case 1:ss=ss.type.childContextTypes,ss!=null&&Y2();break;case 3:HM(),$x(d2),$x(I2),O3();break;case 5:L3(ss);break;case 4:HM();break;case 13:$x(nE);break;case 19:$x(nE);break;case 10:vE(ss.type._context);break;case 22:case 23:fR()}Fn=Fn.return}if(dE=Nr,fE=Nr=hM(Nr.current,null),wE=HE=Xr,pE=0,bP=null,oR=f3=XM=0,LE=EP=null,VE!==null){for(Xr=0;Xr<VE.length;Xr++)if(Fn=VE[Xr],ss=Fn.interleaved,ss!==null){Fn.interleaved=null;var js=ss.next,Nl=Fn.pending;if(Nl!==null){var Op=Nl.next;Nl.next=js,ss.next=Op}Fn.pending=ss}VE=null}return Nr}function BD(Nr,Xr){do{var Fn=fE;try{if(FM(),jP.current=YP,HP){for(var ss=sE.memoizedState;ss!==null;){var js=ss.queue;js!==null&&(js.pending=null),ss=ss.next}HP=!1}if(WM=0,yE=SE=sE=null,hP=!1,dP=0,sR.current=null,Fn===null||Fn.return===null){pE=1,bP=Xr,fE=null;break}e:{var Nl=Nr,Op=Fn.return,w0=Fn,Sv=Xr;if(Xr=wE,w0.flags|=32768,Sv!==null&&typeof Sv=="object"&&typeof Sv.then=="function"){var Zy=Sv,Ax=w0,m2=Ax.tag;if(!(Ax.mode&1)&&(m2===0||m2===11||m2===15)){var Qx=Ax.alternate;Qx?(Ax.updateQueue=Qx.updateQueue,Ax.memoizedState=Qx.memoizedState,Ax.lanes=Qx.lanes):(Ax.updateQueue=null,Ax.memoizedState=null)}var W2=tD(Op);if(W2!==null){W2.flags&=-257,rD(W2,Op,w0,Nl,Xr),W2.mode&1&&eD(Nl,Zy,Xr),Xr=W2,Sv=Zy;var jx=Xr.updateQueue;if(jx===null){var CE=new Set;CE.add(Sv),Xr.updateQueue=CE}else jx.add(Sv);break e}else{if(!(Xr&1)){eD(Nl,Zy,Xr),pR();break e}Sv=Error(Mt(426))}}else if(eE&&w0.mode&1){var ZE=tD(Op);if(ZE!==null){!(ZE.flags&65536)&&(ZE.flags|=256),rD(ZE,Op,w0,Nl,Xr),I3(Sv);break e}}Nl=Sv,pE!==4&&(pE=2),EP===null?EP=[Nl]:EP.push(Nl),Sv=j3(Sv,w0),w0=Op;do{switch(w0.tag){case 3:w0.flags|=65536,Xr&=-Xr,w0.lanes|=Xr;var iv=QR(w0,Sv,Xr);_R(w0,iv);break e;case 1:Nl=Sv;var P0=w0.type,wv=w0.stateNode;if(!(w0.flags&128)&&(typeof P0.getDerivedStateFromError=="function"||wv!==null&&typeof wv.componentDidCatch=="function"&&(ZC===null||!ZC.has(wv)))){w0.flags|=65536,Xr&=-Xr,w0.lanes|=Xr;var Sx=ZR(w0,Nl,Xr);_R(w0,Sx);break e}}w0=w0.return}while(w0!==null)}OD(Fn)}catch(Lx){Xr=Lx,fE===Fn&&Fn!==null&&(fE=Fn=Fn.return);continue}break}while(!0)}function LD(){var Nr=d3.current;return d3.current=YP,Nr===null?YP:Nr}function pR(){(pE===0||pE===3||pE===2)&&(pE=4),dE===null||!(XM&268435455)&&!(f3&268435455)||sM(dE,wE)}function w3(Nr,Xr){var Fn=R2;R2|=2;var ss=LD();dE===Nr&&wE===Xr||CM(Nr,Xr);do try{h$();break}catch(js){BD(Nr,js)}while(!0);if(FM(),R2=Fn,d3.current=ss,fE!==null)throw Error(Mt(261));return dE=null,wE=0,pE}function h$(){for(;fE!==null;)kD(fE)}function d$(){for(;fE!==null&&!ZM();)kD(fE)}function kD(Nr){var Xr=UD(Nr.alternate,Nr,HE);Nr.memoizedProps=Nr.pendingProps,Xr===null?OD(Nr):fE=Xr,sR.current=null}function OD(Nr){var Xr=Nr;do{var Fn=Xr.alternate;if(Nr=Xr.return,Xr.flags&32768){if(Fn=i$(Fn,Xr),Fn!==null){Fn.flags&=32767,fE=Fn;return}if(Nr!==null)Nr.flags|=32768,Nr.subtreeFlags=0,Nr.deletions=null;else{pE=6,fE=null;return}}else if(Fn=t$(Fn,Xr,HE),Fn!==null){fE=Fn;return}if(Xr=Xr.sibling,Xr!==null){fE=Xr;return}fE=Xr=Nr}while(Xr!==null);pE===0&&(pE=5)}function TM(Nr,Xr){var Fn=D2,ss=hE.transition;try{hE.transition=null,D2=1,f$(Nr,Xr,Fn)}finally{hE.transition=ss,D2=Fn}return null}function f$(Nr,Xr,Fn){do PM();while(nM!==null);if(R2&6)throw Error(Mt(327));var ss=Nr.finishedWork,js=Nr.finishedLanes;if(ss===null)return null;if(Nr.finishedWork=null,Nr.finishedLanes=0,ss===Nr.current)throw Error(Mt(177));Nr.callbackNode=null,Nr.callbackPriority=0;var Nl=ss.lanes|ss.childLanes;if(jC(Nr,Nl),Nr===dE&&(fE=dE=null,wE=0),!(ss.subtreeFlags&2064)&&!(ss.flags&2064)||m3||(m3=!0,VD(ME,function(){return PM(),null})),Nl=(ss.flags&15990)!==0,ss.subtreeFlags&15990||Nl){Nl=hE.transition,hE.transition=null;var Op=D2;D2=1;var w0=R2;R2|=4,sR.current=null,o$(Nr,ss),a$(Nr,ss),Ao(Nr.containerInfo),Nr.current=ss,l$(ss),MP(),R2=w0,D2=Op,hE.transition=Nl}else Nr.current=ss;if(m3&&(m3=!1,nM=Nr,g3=js),Nl=Nr.pendingLanes,Nl===0&&(ZC=null),sT(ss.stateNode),kE(Nr,rE()),Xr!==null)for(Fn=Nr.onRecoverableError,ss=0;ss<Xr.length;ss++)Fn(Xr[ss]);if(p3)throw p3=!1,Nr=cR,cR=null,Nr;return g3&1&&Nr.tag!==0&&PM(),Nl=Nr.pendingLanes,Nl&1?Nr===uR?AP++:(AP=0,uR=Nr):AP=0,BE(),null}function PM(){if(nM!==null){var Nr=QM(g3),Xr=hE.transition,Fn=D2;try{if(hE.transition=null,D2=16>Nr?16:Nr,nM===null)var ss=!1;else{if(Nr=nM,nM=null,g3=0,R2&6)throw Error(Mt(331));var js=R2;for(R2|=4,xx=Nr.current;xx!==null;){var Nl=xx,Op=Nl.child;if(xx.flags&16){var w0=Nl.deletions;if(w0!==null){for(var Sv=0;Sv<w0.length;Sv++){var Zy=w0[Sv];for(xx=Zy;xx!==null;){var Ax=xx;switch(Ax.tag){case 0:case 11:case 15:AM(8,Ax,Nl)}var m2=Ax.child;if(m2!==null)m2.return=Ax,xx=m2;else for(;xx!==null;){Ax=xx;var Qx=Ax.sibling,W2=Ax.return;if(bD(Ax),Ax===Zy){xx=null;break}if(Qx!==null){Qx.return=W2,xx=Qx;break}xx=W2}}}var jx=Nl.alternate;if(jx!==null){var CE=jx.child;if(CE!==null){jx.child=null;do{var ZE=CE.sibling;CE.sibling=null,CE=ZE}while(CE!==null)}}xx=Nl}}if(Nl.subtreeFlags&2064&&Op!==null)Op.return=Nl,xx=Op;else e:for(;xx!==null;){if(Nl=xx,Nl.flags&2048)switch(Nl.tag){case 0:case 11:case 15:AM(9,Nl,Nl.return)}var iv=Nl.sibling;if(iv!==null){iv.return=Nl.return,xx=iv;break e}xx=Nl.return}}var P0=Nr.current;for(xx=P0;xx!==null;){Op=xx;var wv=Op.child;if(Op.subtreeFlags&2064&&wv!==null)wv.return=Op,xx=wv;else e:for(Op=P0;xx!==null;){if(w0=xx,w0.flags&2048)try{switch(w0.tag){case 0:case 11:case 15:yP(9,w0)}}catch(Lx){OE(w0,w0.return,Lx)}if(w0===Op){xx=null;break e}var Sx=w0.sibling;if(Sx!==null){Sx.return=w0.return,xx=Sx;break e}xx=w0.return}}if(R2=js,BE(),NE&&typeof NE.onPostCommitFiberRoot=="function")try{NE.onPostCommitFiberRoot(gM,Nr)}catch{}ss=!0}return ss}finally{D2=Fn,hE.transition=Xr}}return!1}function FD(Nr,Xr,Fn){Xr=j3(Fn,Xr),Xr=QR(Nr,Xr,1),JC(Nr,Xr),Xr=$E(),Nr=_3(Nr,1),Nr!==null&&(_C(Nr,1,Xr),kE(Nr,Xr))}function OE(Nr,Xr,Fn){if(Nr.tag===3)FD(Nr,Nr,Fn);else for(;Xr!==null;){if(Xr.tag===3){FD(Xr,Nr,Fn);break}else if(Xr.tag===1){var ss=Xr.stateNode;if(typeof Xr.type.getDerivedStateFromError=="function"||typeof ss.componentDidCatch=="function"&&(ZC===null||!ZC.has(ss))){Nr=j3(Fn,Nr),Nr=ZR(Xr,Nr,1),JC(Xr,Nr),Nr=$E(),Xr=_3(Xr,1),Xr!==null&&(_C(Xr,1,Nr),kE(Xr,Nr));break}}Xr=Xr.return}}function p$(Nr,Xr,Fn){var ss=Nr.pingCache;ss!==null&&ss.delete(Xr),Xr=$E(),Nr.pingedLanes|=Nr.suspendedLanes&Fn,dE===Nr&&(wE&Fn)===Fn&&(pE===4||pE===3&&(wE&130023424)===wE&&500>rE()-aR?CM(Nr,0):oR|=Fn),kE(Nr,Xr)}function ND(Nr,Xr){Xr===0&&(Nr.mode&1?(Xr=BC,BC<<=1,!(BC&130023424)&&(BC=4194304)):Xr=1);var Fn=$E();Nr=_3(Nr,Xr),Nr!==null&&(_C(Nr,Xr,Fn),kE(Nr,Fn))}function m$(Nr){var Xr=Nr.memoizedState,Fn=0;Xr!==null&&(Fn=Xr.retryLane),ND(Nr,Fn)}function g$(Nr,Xr){var Fn=0;switch(Nr.tag){case 13:var ss=Nr.stateNode,js=Nr.memoizedState;js!==null&&(Fn=js.retryLane);break;case 19:ss=Nr.stateNode;break;default:throw Error(Mt(314))}ss!==null&&ss.delete(Xr),ND(Nr,Fn)}var UD;UD=function(Nr,Xr,Fn){if(Nr!==null)if(Nr.memoizedProps!==Xr.pendingProps||d2.current)jE=!0;else{if(!(Nr.lanes&Fn)&&!(Xr.flags&128))return jE=!1,n$(Nr,Xr,Fn);jE=!!(Nr.flags&131072)}else jE=!1,eE&&Xr.flags&1048576&&CR(Xr,OP,Xr.index);switch(Xr.lanes=0,Xr.tag){case 2:var ss=Xr.type;Nr!==null&&(Nr.alternate=null,Xr.alternate=null,Xr.flags|=2),Nr=Xr.pendingProps;var js=iE(Xr,I2.current);lE(Xr,Fn),js=N3(null,Xr,ss,Nr,js,Fn);var Nl=U3();return Xr.flags|=1,typeof js=="object"&&js!==null&&typeof js.render=="function"&&js.$$typeof===void 0?(Xr.tag=1,Xr.memoizedState=null,Xr.updateQueue=null,K2(ss)?(Nl=!0,U2(Xr)):Nl=!1,Xr.memoizedState=js.state!==null&&js.state!==void 0?js.state:null,C3(Xr),js.updater=LP,Xr.stateNode=js,js._reactInternals=Xr,T3(Xr,ss,Nr,Fn),Xr=q3(null,Xr,ss,!0,Nl,Fn)):(Xr.tag=0,eE&&Nl&&P3(Xr),DE(null,Xr,js,Fn),Xr=Xr.child),Xr;case 16:ss=Xr.elementType;e:{switch(Nr!==null&&(Nr.alternate=null,Xr.alternate=null,Xr.flags|=2),Nr=Xr.pendingProps,js=ss._init,ss=js(ss._payload),Xr.type=ss,js=Xr.tag=y$(ss),Nr=PE(ss,Nr),js){case 0:Xr=W3(null,Xr,ss,Nr,Fn);break e;case 1:Xr=uD(null,Xr,ss,Nr,Fn);break e;case 11:Xr=sD(null,Xr,ss,Nr,Fn);break e;case 14:Xr=oD(null,Xr,ss,PE(ss.type,Nr),Fn);break e}throw Error(Mt(306,ss,""))}return Xr;case 0:return ss=Xr.type,js=Xr.pendingProps,js=Xr.elementType===ss?js:PE(ss,js),W3(Nr,Xr,ss,js,Fn);case 1:return ss=Xr.type,js=Xr.pendingProps,js=Xr.elementType===ss?js:PE(ss,js),uD(Nr,Xr,ss,js,Fn);case 3:e:{if(hD(Xr),Nr===null)throw Error(Mt(387));ss=Xr.pendingProps,Nl=Xr.memoizedState,js=Nl.element,xR(Nr,Xr),IP(Xr,ss,null,Fn);var Op=Xr.memoizedState;if(ss=Op.element,Cp&&Nl.isDehydrated)if(Nl={element:ss,isDehydrated:!1,cache:Op.cache,transitions:Op.transitions},Xr.updateQueue.baseState=Nl,Xr.memoizedState=Nl,Xr.flags&256){js=Error(Mt(423)),Xr=dD(Nr,Xr,ss,Fn,js);break e}else if(ss!==js){js=Error(Mt(424)),Xr=dD(Nr,Xr,ss,Fn,js);break e}else for(Cp&&(GE=bv(Xr.stateNode.containerInfo),zE=Xr,eE=!0,yC=null,fT=!1),Fn=$R(Xr,null,ss,Fn),Xr.child=Fn;Fn;)Fn.flags=Fn.flags&-3|4096,Fn=Fn.sibling;else{if(VM(),ss===js){Xr=GC(Nr,Xr,Fn);break e}DE(Nr,Xr,ss,Fn)}Xr=Xr.child}return Xr;case 5:return IR(Xr),Nr===null&&$3(Xr),ss=Xr.type,js=Xr.pendingProps,Nl=Nr!==null?Nr.memoizedProps:null,Op=js.children,Jl(ss,js)?Op=null:Nl!==null&&Jl(ss,Nl)&&(Xr.flags|=32),cD(Nr,Xr),DE(Nr,Xr,Op,Fn),Xr.child;case 6:return Nr===null&&$3(Xr),null;case 13:return fD(Nr,Xr,Fn);case 4:return B3(Xr,Xr.stateNode.containerInfo),ss=Xr.pendingProps,Nr===null?Xr.child=zM(Xr,null,ss,Fn):DE(Nr,Xr,ss,Fn),Xr.child;case 11:return ss=Xr.type,js=Xr.pendingProps,js=Xr.elementType===ss?js:PE(ss,js),sD(Nr,Xr,ss,js,Fn);case 7:return DE(Nr,Xr,Xr.pendingProps,Fn),Xr.child;case 8:return DE(Nr,Xr,Xr.pendingProps.children,Fn),Xr.child;case 12:return DE(Nr,Xr,Xr.pendingProps.children,Fn),Xr.child;case 10:e:{if(ss=Xr.type._context,js=Xr.pendingProps,Nl=Xr.memoizedProps,Op=js.value,RP(Xr,ss,Op),Nl!==null)if(UE(Nl.value,Op)){if(Nl.children===js.children&&!d2.current){Xr=GC(Nr,Xr,Fn);break e}}else for(Nl=Xr.child,Nl!==null&&(Nl.return=Xr);Nl!==null;){var w0=Nl.dependencies;if(w0!==null){Op=Nl.child;for(var Sv=w0.firstContext;Sv!==null;){if(Sv.context===ss){if(Nl.tag===1){Sv=NC(-1,Fn&-Fn),Sv.tag=2;var Zy=Nl.updateQueue;if(Zy!==null){Zy=Zy.shared;var Ax=Zy.pending;Ax===null?Sv.next=Sv:(Sv.next=Ax.next,Ax.next=Sv),Zy.pending=Sv}}Nl.lanes|=Fn,Sv=Nl.alternate,Sv!==null&&(Sv.lanes|=Fn),RE(Nl.return,Fn,Xr),w0.lanes|=Fn;break}Sv=Sv.next}}else if(Nl.tag===10)Op=Nl.type===Xr.type?null:Nl.child;else if(Nl.tag===18){if(Op=Nl.return,Op===null)throw Error(Mt(341));Op.lanes|=Fn,w0=Op.alternate,w0!==null&&(w0.lanes|=Fn),RE(Op,Fn,Xr),Op=Nl.sibling}else Op=Nl.child;if(Op!==null)Op.return=Nl;else for(Op=Nl;Op!==null;){if(Op===Xr){Op=null;break}if(Nl=Op.sibling,Nl!==null){Nl.return=Op.return,Op=Nl;break}Op=Op.return}Nl=Op}DE(Nr,Xr,js.children,Fn),Xr=Xr.child}return Xr;case 9:return js=Xr.type,ss=Xr.pendingProps.children,lE(Xr,Fn),js=uE(js),ss=ss(js),Xr.flags|=1,DE(Nr,Xr,ss,Fn),Xr.child;case 14:return ss=Xr.type,js=PE(ss,Xr.pendingProps),js=PE(ss.type,js),oD(Nr,Xr,ss,js,Fn);case 15:return aD(Nr,Xr,Xr.type,Xr.pendingProps,Fn);case 17:return ss=Xr.type,js=Xr.pendingProps,js=Xr.elementType===ss?js:PE(ss,js),Nr!==null&&(Nr.alternate=null,Xr.alternate=null,Xr.flags|=2),Xr.tag=1,K2(ss)?(Nr=!0,U2(Xr)):Nr=!1,lE(Xr,Fn),ER(Xr,ss,js),T3(Xr,ss,js,Fn),q3(null,Xr,ss,!0,Nr,Fn);case 19:return vD(Nr,Xr,Fn);case 22:return lD(Nr,Xr,Fn)}throw Error(Mt(156,Xr.tag))};function VD(Nr,Xr){return FC(Nr,Xr)}function v$(Nr,Xr,Fn,ss){this.tag=Nr,this.key=Fn,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=Xr,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=ss,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function QE(Nr,Xr,Fn,ss){return new v$(Nr,Xr,Fn,ss)}function mR(Nr){return Nr=Nr.prototype,!(!Nr||!Nr.isReactComponent)}function y$(Nr){if(typeof Nr=="function")return mR(Nr)?1:0;if(Nr!=null){if(Nr=Nr.$$typeof,Nr===Ar)return 11;if(Nr===$r)return 14}return 2}function hM(Nr,Xr){var Fn=Nr.alternate;return Fn===null?(Fn=QE(Nr.tag,Xr,Nr.key,Nr.mode),Fn.elementType=Nr.elementType,Fn.type=Nr.type,Fn.stateNode=Nr.stateNode,Fn.alternate=Nr,Nr.alternate=Fn):(Fn.pendingProps=Xr,Fn.type=Nr.type,Fn.flags=0,Fn.subtreeFlags=0,Fn.deletions=null),Fn.flags=Nr.flags&14680064,Fn.childLanes=Nr.childLanes,Fn.lanes=Nr.lanes,Fn.child=Nr.child,Fn.memoizedProps=Nr.memoizedProps,Fn.memoizedState=Nr.memoizedState,Fn.updateQueue=Nr.updateQueue,Xr=Nr.dependencies,Fn.dependencies=Xr===null?null:{lanes:Xr.lanes,firstContext:Xr.firstContext},Fn.sibling=Nr.sibling,Fn.index=Nr.index,Fn.ref=Nr.ref,Fn}function S3(Nr,Xr,Fn,ss,js,Nl){var Op=2;if(ss=Nr,typeof Nr=="function")mR(Nr)&&(Op=1);else if(typeof Nr=="string")Op=5;else e:switch(Nr){case tr:return $M(Fn.children,js,Nl,Xr);case rr:Op=8,js|=8;break;case sr:return Nr=QE(12,Fn,Xr,js|2),Nr.elementType=sr,Nr.lanes=Nl,Nr;case _r:return Nr=QE(13,Fn,Xr,js),Nr.elementType=_r,Nr.lanes=Nl,Nr;case Dr:return Nr=QE(19,Fn,Xr,js),Nr.elementType=Dr,Nr.lanes=Nl,Nr;case Jr:return E3(Fn,js,Nl,Xr);default:if(typeof Nr=="object"&&Nr!==null)switch(Nr.$$typeof){case ar:Op=10;break e;case cr:Op=9;break e;case Ar:Op=11;break e;case $r:Op=14;break e;case Br:Op=16,ss=null;break e}throw Error(Mt(130,Nr==null?Nr:typeof Nr,""))}return Xr=QE(Op,Fn,Xr,js),Xr.elementType=Nr,Xr.type=ss,Xr.lanes=Nl,Xr}function $M(Nr,Xr,Fn,ss){return Nr=QE(7,Nr,ss,Xr),Nr.lanes=Fn,Nr}function E3(Nr,Xr,Fn,ss){return Nr=QE(22,Nr,ss,Xr),Nr.elementType=Jr,Nr.lanes=Fn,Nr.stateNode={},Nr}function gR(Nr,Xr,Fn){return Nr=QE(6,Nr,null,Xr),Nr.lanes=Fn,Nr}function vR(Nr,Xr,Fn){return Xr=QE(4,Nr.children!==null?Nr.children:[],Nr.key,Xr),Xr.lanes=Fn,Xr.stateNode={containerInfo:Nr.containerInfo,pendingChildren:null,implementation:Nr.implementation},Xr}function x$(Nr,Xr,Fn,ss,js){this.tag=Xr,this.containerInfo=Nr,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Mp,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=IM(0),this.expirationTimes=IM(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=IM(0),this.identifierPrefix=ss,this.onRecoverableError=js,Cp&&(this.mutableSourceEagerHydrationData=null)}function zD(Nr,Xr,Fn,ss,js,Nl,Op,w0,Sv){return Nr=new x$(Nr,Xr,Fn,w0,Sv),Xr===1?(Xr=1,Nl===!0&&(Xr|=8)):Xr=0,Nl=QE(3,null,null,Xr),Nr.current=Nl,Nl.stateNode=Nr,Nl.memoizedState={element:ss,isDehydrated:Fn,cache:null,transitions:null},C3(Nl),Nr}function GD(Nr){if(!Nr)return Yx;Nr=Nr._reactInternals;e:{if(In(Nr)!==Nr||Nr.tag!==1)throw Error(Mt(170));var Xr=Nr;do{switch(Xr.tag){case 3:Xr=Xr.stateNode.context;break e;case 1:if(K2(Xr.type)){Xr=Xr.stateNode.__reactInternalMemoizedMergedChildContext;break e}}Xr=Xr.return}while(Xr!==null);throw Error(Mt(171))}if(Nr.tag===1){var Fn=Nr.type;if(K2(Fn))return tE(Nr,Fn,Xr)}return Xr}function jD(Nr){var Xr=Nr._reactInternals;if(Xr===void 0)throw typeof Nr.render=="function"?Error(Mt(188)):(Nr=Object.keys(Nr).join(","),Error(Mt(268,Nr)));return Nr=Qn(Xr),Nr===null?null:Nr.stateNode}function HD(Nr,Xr){if(Nr=Nr.memoizedState,Nr!==null&&Nr.dehydrated!==null){var Fn=Nr.retryLane;Nr.retryLane=Fn!==0&&Fn<Xr?Fn:Xr}}function yR(Nr,Xr){HD(Nr,Xr),(Nr=Nr.alternate)&&HD(Nr,Xr)}function _$(Nr){return Nr=Qn(Nr),Nr===null?null:Nr.stateNode}function b$(){return null}return ut.attemptContinuousHydration=function(Nr){if(Nr.tag===13){var Xr=$E();JE(Nr,134217728,Xr),yR(Nr,134217728)}},ut.attemptHydrationAtCurrentPriority=function(Nr){if(Nr.tag===13){var Xr=$E(),Fn=iM(Nr);JE(Nr,Fn,Xr),yR(Nr,Fn)}},ut.attemptSynchronousHydration=function(Nr){switch(Nr.tag){case 3:var Xr=Nr.stateNode;if(Xr.current.memoizedState.isDehydrated){var Fn=LC(Xr.pendingLanes);Fn!==0&&(wC(Xr,Fn|1),kE(Xr,rE()),!(R2&6)&&(KM(),BE()))}break;case 13:var ss=$E();ID(function(){return JE(Nr,1,ss)}),yR(Nr,1)}},ut.batchedUpdates=function(Nr,Xr){var Fn=R2;R2|=1;try{return Nr(Xr)}finally{R2=Fn,R2===0&&(KM(),EC&&BE())}},ut.createComponentSelector=function(Nr){return{$$typeof:s3,value:Nr}},ut.createContainer=function(Nr,Xr,Fn,ss,js,Nl,Op){return zD(Nr,Xr,!1,null,Fn,ss,js,Nl,Op)},ut.createHasPseudoClassSelector=function(Nr){return{$$typeof:o3,value:Nr}},ut.createHydrationContainer=function(Nr,Xr,Fn,ss,js,Nl,Op,w0,Sv){return Nr=zD(Fn,ss,!0,Nr,js,Nl,Op,w0,Sv),Nr.context=GD(null),Fn=Nr.current,ss=$E(),js=iM(Fn),Nl=NC(ss,js),Nl.callback=Xr??null,JC(Fn,Nl),Nr.current.lanes=js,_C(Nr,js,ss),kE(Nr,ss),Nr},ut.createPortal=function(Nr,Xr,Fn){var ss=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ht,key:ss==null?null:""+ss,children:Nr,containerInfo:Xr,implementation:Fn}},ut.createRoleSelector=function(Nr){return{$$typeof:l3,value:Nr}},ut.createTestNameSelector=function(Nr){return{$$typeof:u3,value:Nr}},ut.createTextSelector=function(Nr){return{$$typeof:h3,value:Nr}},ut.deferredUpdates=function(Nr){var Xr=D2,Fn=hE.transition;try{return hE.transition=null,D2=16,Nr()}finally{D2=Xr,hE.transition=Fn}},ut.discreteUpdates=function(Nr,Xr,Fn,ss,js){var Nl=D2,Op=hE.transition;try{return hE.transition=null,D2=1,Nr(Xr,Fn,ss,js)}finally{D2=Nl,hE.transition=Op,R2===0&&KM()}},ut.findAllNodes=iR,ut.findBoundingRects=function(Nr,Xr){if(!z0)throw Error(Mt(363));Xr=iR(Nr,Xr),Nr=[];for(var Fn=0;Fn<Xr.length;Fn++)Nr.push(Nu(Xr[Fn]));for(Xr=Nr.length-1;0<Xr;Xr--){Fn=Nr[Xr];for(var ss=Fn.x,js=ss+Fn.width,Nl=Fn.y,Op=Nl+Fn.height,w0=Xr-1;0<=w0;w0--)if(Xr!==w0){var Sv=Nr[w0],Zy=Sv.x,Ax=Zy+Sv.width,m2=Sv.y,Qx=m2+Sv.height;if(ss>=Zy&&Nl>=m2&&js<=Ax&&Op<=Qx){Nr.splice(Xr,1);break}else if(ss!==Zy||Fn.width!==Sv.width||Qx<Nl||m2>Op){if(!(Nl!==m2||Fn.height!==Sv.height||Ax<ss||Zy>js)){Zy>ss&&(Sv.width+=Zy-ss,Sv.x=ss),Ax<js&&(Sv.width=js-Zy),Nr.splice(Xr,1);break}}else{m2>Nl&&(Sv.height+=m2-Nl,Sv.y=Nl),Qx<Op&&(Sv.height=Op-m2),Nr.splice(Xr,1);break}}}return Nr},ut.findHostInstance=jD,ut.findHostInstanceWithNoPortals=function(Nr){return Nr=qn(Nr),Nr=Nr!==null?cs(Nr):null,Nr===null?null:Nr.stateNode},ut.findHostInstanceWithWarning=function(Nr){return jD(Nr)},ut.flushControlled=function(Nr){var Xr=R2;R2|=1;var Fn=hE.transition,ss=D2;try{hE.transition=null,D2=1,Nr()}finally{D2=ss,hE.transition=Fn,R2=Xr,R2===0&&(KM(),BE())}},ut.flushPassiveEffects=PM,ut.flushSync=ID,ut.focusWithin=function(Nr,Xr){if(!z0)throw Error(Mt(363));for(Nr=tR(Nr),Xr=RD(Nr,Xr),Xr=Array.from(Xr),Nr=0;Nr<Xr.length;){var Fn=Xr[Nr++];if(!Bp(Fn)){if(Fn.tag===5&&Q0(Fn.stateNode))return!0;for(Fn=Fn.child;Fn!==null;)Xr.push(Fn),Fn=Fn.sibling}}return!1},ut.getCurrentUpdatePriority=function(){return D2},ut.getFindAllNodesFailureDescription=function(Nr,Xr){if(!z0)throw Error(Mt(363));var Fn=0,ss=[];Nr=[tR(Nr),0];for(var js=0;js<Nr.length;){var Nl=Nr[js++],Op=Nr[js++],w0=Xr[Op];if((Nl.tag!==5||!Bp(Nl))&&(rR(Nl,w0)&&(ss.push(nR(w0)),Op++,Op>Fn&&(Fn=Op)),Op<Xr.length))for(Nl=Nl.child;Nl!==null;)Nr.push(Nl,Op),Nl=Nl.sibling}if(Fn<Xr.length){for(Nr=[];Fn<Xr.length;Fn++)Nr.push(nR(Xr[Fn]));return`findAllNodes was able to match part of the selector:
  `+(ss.join(" > ")+`

No matching component was found for:
  `)+Nr.join(" > ")}return null},ut.getPublicRootInstance=function(Nr){if(Nr=Nr.current,!Nr.child)return null;switch(Nr.child.tag){case 5:return _o(Nr.child.stateNode);default:return Nr.child.stateNode}},ut.injectIntoDevTools=function(Nr){if(Nr={bundleType:Nr.bundleType,version:Nr.version,rendererPackageName:Nr.rendererPackageName,rendererConfig:Nr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Bt.ReactCurrentDispatcher,findHostInstanceByFiber:_$,findFiberByHostInstance:Nr.findFiberByHostInstance||b$,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")Nr=!1;else{var Xr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(Xr.isDisabled||!Xr.supportsFiber)Nr=!0;else{try{gM=Xr.inject(Nr),NE=Xr}catch{}Nr=!!Xr.checkDCE}}return Nr},ut.isAlreadyRendering=function(){return!1},ut.observeVisibleRects=function(Nr,Xr,Fn,ss){if(!z0)throw Error(Mt(363));Nr=iR(Nr,Xr);var js=T0(Nr,Fn,ss).disconnect;return{disconnect:function(){js()}}},ut.registerMutableSourceForHydration=function(Nr,Xr){var Fn=Xr._getVersion;Fn=Fn(Xr._source),Nr.mutableSourceEagerHydrationData==null?Nr.mutableSourceEagerHydrationData=[Xr,Fn]:Nr.mutableSourceEagerHydrationData.push(Xr,Fn)},ut.runWithPriority=function(Nr,Xr){var Fn=D2;try{return D2=Nr,Xr()}finally{D2=Fn}},ut.shouldError=function(){return null},ut.shouldSuspend=function(){return!1},ut.updateContainer=function(Nr,Xr,Fn,ss){var js=Xr.current,Nl=$E(),Op=iM(js);return Fn=GD(Fn),Xr.context===null?Xr.context=Fn:Xr.pendingContext=Fn,Xr=NC(Nl,Op),Xr.payload={element:Nr},ss=ss===void 0?null:ss,ss!==null&&(Xr.callback=ss),JC(js,Xr),Nr=JE(js,Op,Nl),Nr!==null&&DP(Nr,js,Op),Op},ut};reactReconciler.exports=reactReconciler_production_min;var reactReconcilerExports=reactReconciler.exports;const Reconciler=getDefaultExportFromCjs(reactReconcilerExports);function shallowEqualArrays$1(rt,_,ut=(mt,bt)=>mt===bt){if(rt===_)return!0;if(!rt||!_)return!1;const mt=rt.length;if(_.length!==mt)return!1;for(let bt=0;bt<mt;bt++)if(!ut(rt[bt],_[bt]))return!1;return!0}const globalCache$1=[];function query$1(rt,_,ut=!1,mt={}){for(const St of globalCache$1)if(shallowEqualArrays$1(_,St.keys,St.equal)){if(ut)return;if(Object.prototype.hasOwnProperty.call(St,"error"))throw St.error;if(Object.prototype.hasOwnProperty.call(St,"response"))return St.response;if(!ut)throw St.promise}const bt={keys:_,equal:mt.equal,promise:rt(..._).then(St=>bt.response=St).then(()=>{mt.lifespan&&mt.lifespan>0&&setTimeout(()=>{const St=globalCache$1.indexOf(bt);St!==-1&&globalCache$1.splice(St,1)},mt.lifespan)}).catch(St=>bt.error=St)};if(globalCache$1.push(bt),!ut)throw bt.promise}const suspend$1=(rt,_,ut)=>query$1(rt,_,!1,ut),preload=(rt,_,ut)=>void query$1(rt,_,!0,ut),clear=rt=>{if(rt===void 0||rt.length===0)globalCache$1.splice(0,globalCache$1.length);else{const _=globalCache$1.find(ut=>shallowEqualArrays$1(rt,ut.keys,ut.equal));if(_){const ut=globalCache$1.indexOf(_);ut!==-1&&globalCache$1.splice(ut,1)}}},catalogue={},extend$3=rt=>void Object.assign(catalogue,rt);function createRenderer(rt,_){function ut(tr,{args:rr=[],attach:sr,...ar},cr){let Ar=`${tr[0].toUpperCase()}${tr.slice(1)}`,_r;if(tr==="primitive"){if(ar.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const Dr=ar.object;_r=prepare(Dr,{type:tr,root:cr,attach:sr,primitive:!0})}else{const Dr=catalogue[Ar];if(!Dr)throw new Error(`R3F: ${Ar} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(rr))throw new Error("R3F: The args prop must be an array!");_r=prepare(new Dr(...rr),{type:tr,root:cr,attach:sr,memoizedProps:{args:rr}})}return _r.__r3f.attach===void 0&&(_r instanceof BufferGeometry?_r.__r3f.attach="geometry":_r instanceof Material&&(_r.__r3f.attach="material")),Ar!=="inject"&&applyProps$1(_r,ar),_r}function mt(tr,rr){let sr=!1;if(rr){var ar,cr;(ar=rr.__r3f)!=null&&ar.attach?attach(tr,rr,rr.__r3f.attach):rr.isObject3D&&tr.isObject3D&&(tr.add(rr),sr=!0),sr||(cr=tr.__r3f)==null||cr.objects.push(rr),rr.__r3f||prepare(rr,{}),rr.__r3f.parent=tr,updateInstance(rr),invalidateInstance(rr)}}function bt(tr,rr,sr){let ar=!1;if(rr){var cr,Ar;if((cr=rr.__r3f)!=null&&cr.attach)attach(tr,rr,rr.__r3f.attach);else if(rr.isObject3D&&tr.isObject3D){rr.parent=tr,rr.dispatchEvent({type:"added"});const _r=tr.children.filter($r=>$r!==rr),Dr=_r.indexOf(sr);tr.children=[..._r.slice(0,Dr),rr,..._r.slice(Dr)],ar=!0}ar||(Ar=tr.__r3f)==null||Ar.objects.push(rr),rr.__r3f||prepare(rr,{}),rr.__r3f.parent=tr,updateInstance(rr),invalidateInstance(rr)}}function St(tr,rr,sr=!1){tr&&[...tr].forEach(ar=>Mt(rr,ar,sr))}function Mt(tr,rr,sr){if(rr){var ar,cr,Ar;if(rr.__r3f&&(rr.__r3f.parent=null),(ar=tr.__r3f)!=null&&ar.objects&&(tr.__r3f.objects=tr.__r3f.objects.filter(Jr=>Jr!==rr)),(cr=rr.__r3f)!=null&&cr.attach)detach(tr,rr,rr.__r3f.attach);else if(rr.isObject3D&&tr.isObject3D){var _r;tr.remove(rr),(_r=rr.__r3f)!=null&&_r.root&&removeInteractivity(rr.__r3f.root,rr)}const $r=(Ar=rr.__r3f)==null?void 0:Ar.primitive,Br=sr===void 0?rr.dispose!==null&&!$r:sr;if(!$r){var Dr;St((Dr=rr.__r3f)==null?void 0:Dr.objects,rr,Br),St(rr.children,rr,Br)}rr.__r3f&&(delete rr.__r3f.root,delete rr.__r3f.objects,delete rr.__r3f.handlers,delete rr.__r3f.memoizedProps,$r||delete rr.__r3f),Br&&rr.dispose&&rr.type!=="Scene"&&schedulerExports.unstable_scheduleCallback(schedulerExports.unstable_IdlePriority,()=>{try{rr.dispose()}catch{}}),invalidateInstance(tr)}}function Bt(tr,rr,sr,ar){var cr;const Ar=(cr=tr.__r3f)==null?void 0:cr.parent;if(!Ar)return;const _r=ut(rr,sr,tr.__r3f.root);if(tr.children){for(const Dr of tr.children)Dr.__r3f&&mt(_r,Dr);tr.children=tr.children.filter(Dr=>!Dr.__r3f)}tr.__r3f.objects.forEach(Dr=>mt(_r,Dr)),tr.__r3f.objects=[],tr.__r3f.autoRemovedBeforeAppend||Mt(Ar,tr),_r.parent&&(_r.__r3f.autoRemovedBeforeAppend=!0),mt(Ar,_r),_r.raycast&&_r.__r3f.eventCount&&_r.__r3f.root.getState().internal.interaction.push(_r),[ar,ar.alternate].forEach(Dr=>{Dr!==null&&(Dr.stateNode=_r,Dr.ref&&(typeof Dr.ref=="function"?Dr.ref(_r):Dr.ref.current=_r))})}const Ut=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Reconciler({createInstance:ut,removeChild:Mt,appendChild:mt,appendInitialChild:mt,insertBefore:bt,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(tr,rr)=>{if(!rr)return;const sr=tr.getState().scene;sr.__r3f&&(sr.__r3f.root=tr,mt(sr,rr))},removeChildFromContainer:(tr,rr)=>{rr&&Mt(tr.getState().scene,rr)},insertInContainerBefore:(tr,rr,sr)=>{if(!rr||!sr)return;const ar=tr.getState().scene;ar.__r3f&&bt(ar,rr,sr)},getRootHostContext:()=>null,getChildHostContext:tr=>tr,finalizeInitialChildren(tr){var rr;return!!((rr=tr==null?void 0:tr.__r3f)!=null?rr:{}).handlers},prepareUpdate(tr,rr,sr,ar){if(tr.__r3f.primitive&&ar.object&&ar.object!==tr)return[!0];{const{args:cr=[],children:Ar,..._r}=ar,{args:Dr=[],children:$r,...Br}=sr;if(!Array.isArray(cr))throw new Error("R3F: the args prop must be an array!");if(cr.some((mn,Mn)=>mn!==Dr[Mn]))return[!0];const Jr=diffProps(tr,_r,Br,!0);return Jr.changes.length?[!1,Jr]:null}},commitUpdate(tr,[rr,sr],ar,cr,Ar,_r){rr?Bt(tr,ar,Ar,_r):applyProps$1(tr,sr)},commitMount(tr,rr,sr,ar){var cr;const Ar=(cr=tr.__r3f)!=null?cr:{};tr.raycast&&Ar.handlers&&Ar.eventCount&&tr.__r3f.root.getState().internal.interaction.push(tr)},getPublicInstance:tr=>tr,prepareForCommit:()=>null,preparePortalMount:tr=>prepare(tr.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(tr){var rr;const{attach:sr,parent:ar}=(rr=tr.__r3f)!=null?rr:{};sr&&ar&&detach(ar,tr,sr),tr.isObject3D&&(tr.visible=!1),invalidateInstance(tr)},unhideInstance(tr,rr){var sr;const{attach:ar,parent:cr}=(sr=tr.__r3f)!=null?sr:{};ar&&cr&&attach(cr,tr,ar),(tr.isObject3D&&rr.visible==null||rr.visible)&&(tr.visible=!0),invalidateInstance(tr)},createTextInstance:Ut,hideTextInstance:Ut,unhideTextInstance:Ut,getCurrentEventPriority:()=>_?_():constantsExports.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&is$2.fun(performance.now)?performance.now:is$2.fun(Date.now)?Date.now:()=>0,scheduleTimeout:is$2.fun(setTimeout)?setTimeout:void 0,cancelTimeout:is$2.fun(clearTimeout)?clearTimeout:void 0}),applyProps:applyProps$1}}var _window$document,_window$navigator;const getColorManagement=()=>{var rt;return(rt=catalogue.ColorManagement)!=null?rt:null},isOrthographicCamera=rt=>rt&&rt.isOrthographicCamera,isRef$1=rt=>rt&&rt.hasOwnProperty("current"),useIsomorphicLayoutEffect$2=typeof window<"u"&&((_window$document=window.document)!=null&&_window$document.createElement||((_window$navigator=window.navigator)==null?void 0:_window$navigator.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function useMutableCallback(rt){const _=reactExports.useRef(rt);return useIsomorphicLayoutEffect$2(()=>void(_.current=rt),[rt]),_}function Block({set:rt}){return useIsomorphicLayoutEffect$2(()=>(rt(new Promise(()=>null)),()=>rt(!1)),[rt]),null}class ErrorBoundary extends reactExports.Component{constructor(..._){super(..._),this.state={error:!1}}componentDidCatch(_){this.props.set(_)}render(){return this.state.error?null:this.props.children}}ErrorBoundary.getDerivedStateFromError=()=>({error:!0});const DEFAULT="__default",DEFAULTS=new Map,isDiffSet=rt=>rt&&!!rt.memoized&&!!rt.changes;function calculateDpr(rt){const _=typeof window<"u"?window.devicePixelRatio:1;return Array.isArray(rt)?Math.min(Math.max(rt[0],_),rt[1]):rt}const getRootState=rt=>{var _;return(_=rt.__r3f)==null?void 0:_.root.getState()},is$2={obj:rt=>rt===Object(rt)&&!is$2.arr(rt)&&typeof rt!="function",fun:rt=>typeof rt=="function",str:rt=>typeof rt=="string",num:rt=>typeof rt=="number",boo:rt=>typeof rt=="boolean",und:rt=>rt===void 0,arr:rt=>Array.isArray(rt),equ(rt,_,{arrays:ut="shallow",objects:mt="reference",strict:bt=!0}={}){if(typeof rt!=typeof _||!!rt!=!!_)return!1;if(is$2.str(rt)||is$2.num(rt))return rt===_;const St=is$2.obj(rt);if(St&&mt==="reference")return rt===_;const Mt=is$2.arr(rt);if(Mt&&ut==="reference")return rt===_;if((Mt||St)&&rt===_)return!0;let Bt;for(Bt in rt)if(!(Bt in _))return!1;if(St&&ut==="shallow"&&mt==="shallow"){for(Bt in bt?_:rt)if(!is$2.equ(rt[Bt],_[Bt],{strict:bt,objects:"reference"}))return!1}else for(Bt in bt?_:rt)if(rt[Bt]!==_[Bt])return!1;if(is$2.und(Bt)){if(Mt&&rt.length===0&&_.length===0||St&&Object.keys(rt).length===0&&Object.keys(_).length===0)return!0;if(rt!==_)return!1}return!0}};function buildGraph(rt){const _={nodes:{},materials:{}};return rt&&rt.traverse(ut=>{ut.name&&(_.nodes[ut.name]=ut),ut.material&&!_.materials[ut.material.name]&&(_.materials[ut.material.name]=ut.material)}),_}function dispose(rt){rt.dispose&&rt.type!=="Scene"&&rt.dispose();for(const _ in rt)_.dispose==null||_.dispose(),delete rt[_]}function prepare(rt,_){const ut=rt;return(_!=null&&_.primitive||!ut.__r3f)&&(ut.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,..._}),rt}function resolve(rt,_){let ut=rt;if(_.includes("-")){const mt=_.split("-"),bt=mt.pop();return ut=mt.reduce((St,Mt)=>St[Mt],rt),{target:ut,key:bt}}else return{target:ut,key:_}}const INDEX_REGEX=/-\d+$/;function attach(rt,_,ut){if(is$2.str(ut)){if(INDEX_REGEX.test(ut)){const St=ut.replace(INDEX_REGEX,""),{target:Mt,key:Bt}=resolve(rt,St);Array.isArray(Mt[Bt])||(Mt[Bt]=[])}const{target:mt,key:bt}=resolve(rt,ut);_.__r3f.previousAttach=mt[bt],mt[bt]=_}else _.__r3f.previousAttach=ut(rt,_)}function detach(rt,_,ut){var mt,bt;if(is$2.str(ut)){const{target:St,key:Mt}=resolve(rt,ut),Bt=_.__r3f.previousAttach;Bt===void 0?delete St[Mt]:St[Mt]=Bt}else(mt=_.__r3f)==null||mt.previousAttach==null||mt.previousAttach(rt,_);(bt=_.__r3f)==null||delete bt.previousAttach}function diffProps(rt,{children:_,key:ut,ref:mt,...bt},{children:St,key:Mt,ref:Bt,...Ut}={},Ht=!1){var tr;const rr=(tr=rt==null?void 0:rt.__r3f)!=null?tr:{},sr=Object.entries(bt),ar=[];if(Ht){const Ar=Object.keys(Ut);for(let _r=0;_r<Ar.length;_r++)bt.hasOwnProperty(Ar[_r])||sr.unshift([Ar[_r],DEFAULT+"remove"])}sr.forEach(([Ar,_r])=>{var Dr;if((Dr=rt.__r3f)!=null&&Dr.primitive&&Ar==="object"||is$2.equ(_r,Ut[Ar]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(Ar))return ar.push([Ar,_r,!0,[]]);let $r=[];Ar.includes("-")&&($r=Ar.split("-")),ar.push([Ar,_r,!1,$r]);for(const Br in bt){const Jr=bt[Br];Br.startsWith(`${Ar}-`)&&ar.push([Br,Jr,!1,Br.split("-")])}});const cr={...bt};return rr.memoizedProps&&rr.memoizedProps.args&&(cr.args=rr.memoizedProps.args),rr.memoizedProps&&rr.memoizedProps.attach&&(cr.attach=rr.memoizedProps.attach),{memoized:cr,changes:ar}}function applyProps$1(rt,_){var ut,mt,bt;const St=(ut=rt.__r3f)!=null?ut:{},Mt=St.root,Bt=(mt=Mt==null||Mt.getState==null?void 0:Mt.getState())!=null?mt:{},{memoized:Ut,changes:Ht}=isDiffSet(_)?_:diffProps(rt,_),tr=St.eventCount;rt.__r3f&&(rt.__r3f.memoizedProps=Ut);for(let sr=0;sr<Ht.length;sr++){let[ar,cr,Ar,_r]=Ht[sr],Dr=rt,$r=Dr[ar];if(_r.length&&($r=_r.reduce((Br,Jr)=>Br[Jr],rt),!($r&&$r.set))){const[Br,...Jr]=_r.reverse();Dr=Jr.reverse().reduce((mn,Mn)=>mn[Mn],rt),ar=Br}if(cr===DEFAULT+"remove")if(Dr.constructor){let Br=DEFAULTS.get(Dr.constructor);Br||(Br=new Dr.constructor,DEFAULTS.set(Dr.constructor,Br)),cr=Br[ar]}else cr=0;if(Ar)cr?St.handlers[ar]=cr:delete St.handlers[ar],St.eventCount=Object.keys(St.handlers).length;else if($r&&$r.set&&($r.copy||$r instanceof Layers)){if(Array.isArray(cr))$r.fromArray?$r.fromArray(cr):$r.set(...cr);else if($r.copy&&cr&&cr.constructor&&$r.constructor===cr.constructor)$r.copy(cr);else if(cr!==void 0){const Br=$r instanceof Color$1;!Br&&$r.setScalar?$r.setScalar(cr):$r instanceof Layers&&cr instanceof Layers?$r.mask=cr.mask:$r.set(cr),!getColorManagement()&&!Bt.linear&&Br&&$r.convertSRGBToLinear()}}else Dr[ar]=cr,!Bt.linear&&Dr[ar]instanceof Texture&&Dr[ar].format===RGBAFormat&&Dr[ar].type===UnsignedByteType&&(Dr[ar].encoding=sRGBEncoding$1);invalidateInstance(rt)}if(St.parent&&Bt.internal&&rt.raycast&&tr!==St.eventCount){const sr=Bt.internal.interaction.indexOf(rt);sr>-1&&Bt.internal.interaction.splice(sr,1),St.eventCount&&Bt.internal.interaction.push(rt)}return!(Ht.length===1&&Ht[0][0]==="onUpdate")&&Ht.length&&(bt=rt.__r3f)!=null&&bt.parent&&updateInstance(rt),rt}function invalidateInstance(rt){var _,ut;const mt=(_=rt.__r3f)==null||(ut=_.root)==null||ut.getState==null?void 0:ut.getState();mt&&mt.internal.frames===0&&mt.invalidate()}function updateInstance(rt){rt.onUpdate==null||rt.onUpdate(rt)}function updateCamera(rt,_){rt.manual||(isOrthographicCamera(rt)?(rt.left=_.width/-2,rt.right=_.width/2,rt.top=_.height/2,rt.bottom=_.height/-2):rt.aspect=_.width/_.height,rt.updateProjectionMatrix(),rt.updateMatrixWorld())}function makeId(rt){return(rt.eventObject||rt.object).uuid+"/"+rt.index+rt.instanceId}function getEventPriority(){var rt;const _=typeof self<"u"&&self||typeof window<"u"&&window;if(!_)return constantsExports.DefaultEventPriority;switch((rt=_.event)==null?void 0:rt.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return constantsExports.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return constantsExports.ContinuousEventPriority;default:return constantsExports.DefaultEventPriority}}function releaseInternalPointerCapture(rt,_,ut,mt){const bt=ut.get(_);bt&&(ut.delete(_),ut.size===0&&(rt.delete(mt),bt.target.releasePointerCapture(mt)))}function removeInteractivity(rt,_){const{internal:ut}=rt.getState();ut.interaction=ut.interaction.filter(mt=>mt!==_),ut.initialHits=ut.initialHits.filter(mt=>mt!==_),ut.hovered.forEach((mt,bt)=>{(mt.eventObject===_||mt.object===_)&&ut.hovered.delete(bt)}),ut.capturedMap.forEach((mt,bt)=>{releaseInternalPointerCapture(ut.capturedMap,_,mt,bt)})}function createEvents(rt){function _(Ut){const{internal:Ht}=rt.getState(),tr=Ut.offsetX-Ht.initialClick[0],rr=Ut.offsetY-Ht.initialClick[1];return Math.round(Math.sqrt(tr*tr+rr*rr))}function ut(Ut){return Ut.filter(Ht=>["Move","Over","Enter","Out","Leave"].some(tr=>{var rr;return(rr=Ht.__r3f)==null?void 0:rr.handlers["onPointer"+tr]}))}function mt(Ut,Ht){const tr=rt.getState(),rr=new Set,sr=[],ar=Ht?Ht(tr.internal.interaction):tr.internal.interaction;for(let Dr=0;Dr<ar.length;Dr++){const $r=getRootState(ar[Dr]);$r&&($r.raycaster.camera=void 0)}tr.previousRoot||tr.events.compute==null||tr.events.compute(Ut,tr);function cr(Dr){const $r=getRootState(Dr);if(!$r||!$r.events.enabled||$r.raycaster.camera===null)return[];if($r.raycaster.camera===void 0){var Br;$r.events.compute==null||$r.events.compute(Ut,$r,(Br=$r.previousRoot)==null?void 0:Br.getState()),$r.raycaster.camera===void 0&&($r.raycaster.camera=null)}return $r.raycaster.camera?$r.raycaster.intersectObject(Dr,!0):[]}let Ar=ar.flatMap(cr).sort((Dr,$r)=>{const Br=getRootState(Dr.object),Jr=getRootState($r.object);return!Br||!Jr?Dr.distance-$r.distance:Jr.events.priority-Br.events.priority||Dr.distance-$r.distance}).filter(Dr=>{const $r=makeId(Dr);return rr.has($r)?!1:(rr.add($r),!0)});tr.events.filter&&(Ar=tr.events.filter(Ar,tr));for(const Dr of Ar){let $r=Dr.object;for(;$r;){var _r;(_r=$r.__r3f)!=null&&_r.eventCount&&sr.push({...Dr,eventObject:$r}),$r=$r.parent}}if("pointerId"in Ut&&tr.internal.capturedMap.has(Ut.pointerId))for(let Dr of tr.internal.capturedMap.get(Ut.pointerId).values())rr.has(makeId(Dr.intersection))||sr.push(Dr.intersection);return sr}function bt(Ut,Ht,tr,rr){const sr=rt.getState();if(Ut.length){const ar={stopped:!1};for(const cr of Ut){const Ar=getRootState(cr.object)||sr,{raycaster:_r,pointer:Dr,camera:$r,internal:Br}=Ar,Jr=new Vector3(Dr.x,Dr.y,0).unproject($r),mn=Rn=>{var qn,Qn;return(qn=(Qn=Br.capturedMap.get(Rn))==null?void 0:Qn.has(cr.eventObject))!=null?qn:!1},Mn=Rn=>{const qn={intersection:cr,target:Ht.target};Br.capturedMap.has(Rn)?Br.capturedMap.get(Rn).set(cr.eventObject,qn):Br.capturedMap.set(Rn,new Map([[cr.eventObject,qn]])),Ht.target.setPointerCapture(Rn)},$n=Rn=>{const qn=Br.capturedMap.get(Rn);qn&&releaseInternalPointerCapture(Br.capturedMap,cr.eventObject,qn,Rn)};let en={};for(let Rn in Ht){let qn=Ht[Rn];typeof qn!="function"&&(en[Rn]=qn)}let In={...cr,...en,pointer:Dr,intersections:Ut,stopped:ar.stopped,delta:tr,unprojectedPoint:Jr,ray:_r.ray,camera:$r,stopPropagation(){const Rn="pointerId"in Ht&&Br.capturedMap.get(Ht.pointerId);if((!Rn||Rn.has(cr.eventObject))&&(In.stopped=ar.stopped=!0,Br.hovered.size&&Array.from(Br.hovered.values()).find(qn=>qn.eventObject===cr.eventObject))){const qn=Ut.slice(0,Ut.indexOf(cr));St([...qn,cr])}},target:{hasPointerCapture:mn,setPointerCapture:Mn,releasePointerCapture:$n},currentTarget:{hasPointerCapture:mn,setPointerCapture:Mn,releasePointerCapture:$n},nativeEvent:Ht};if(rr(In),ar.stopped===!0)break}}return Ut}function St(Ut){const{internal:Ht}=rt.getState();for(const tr of Ht.hovered.values())if(!Ut.length||!Ut.find(rr=>rr.object===tr.object&&rr.index===tr.index&&rr.instanceId===tr.instanceId)){const sr=tr.eventObject.__r3f,ar=sr==null?void 0:sr.handlers;if(Ht.hovered.delete(makeId(tr)),sr!=null&&sr.eventCount){const cr={...tr,intersections:Ut};ar.onPointerOut==null||ar.onPointerOut(cr),ar.onPointerLeave==null||ar.onPointerLeave(cr)}}}function Mt(Ut,Ht){for(let tr=0;tr<Ht.length;tr++){const rr=Ht[tr].__r3f;rr==null||rr.handlers.onPointerMissed==null||rr.handlers.onPointerMissed(Ut)}}function Bt(Ut){switch(Ut){case"onPointerLeave":case"onPointerCancel":return()=>St([]);case"onLostPointerCapture":return Ht=>{const{internal:tr}=rt.getState();"pointerId"in Ht&&tr.capturedMap.has(Ht.pointerId)&&requestAnimationFrame(()=>{tr.capturedMap.has(Ht.pointerId)&&(tr.capturedMap.delete(Ht.pointerId),St([]))})}}return function(tr){const{onPointerMissed:rr,internal:sr}=rt.getState();sr.lastEvent.current=tr;const ar=Ut==="onPointerMove",cr=Ut==="onClick"||Ut==="onContextMenu"||Ut==="onDoubleClick",_r=mt(tr,ar?ut:void 0),Dr=cr?_(tr):0;Ut==="onPointerDown"&&(sr.initialClick=[tr.offsetX,tr.offsetY],sr.initialHits=_r.map(Br=>Br.eventObject)),cr&&!_r.length&&Dr<=2&&(Mt(tr,sr.interaction),rr&&rr(tr)),ar&&St(_r);function $r(Br){const Jr=Br.eventObject,mn=Jr.__r3f,Mn=mn==null?void 0:mn.handlers;if(mn!=null&&mn.eventCount)if(ar){if(Mn.onPointerOver||Mn.onPointerEnter||Mn.onPointerOut||Mn.onPointerLeave){const $n=makeId(Br),en=sr.hovered.get($n);en?en.stopped&&Br.stopPropagation():(sr.hovered.set($n,Br),Mn.onPointerOver==null||Mn.onPointerOver(Br),Mn.onPointerEnter==null||Mn.onPointerEnter(Br))}Mn.onPointerMove==null||Mn.onPointerMove(Br)}else{const $n=Mn[Ut];$n?(!cr||sr.initialHits.includes(Jr))&&(Mt(tr,sr.interaction.filter(en=>!sr.initialHits.includes(en))),$n(Br)):cr&&sr.initialHits.includes(Jr)&&Mt(tr,sr.interaction.filter(en=>!sr.initialHits.includes(en)))}}bt(_r,tr,Dr,$r)}}return{handlePointer:Bt}}const privateKeys=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],isRenderer=rt=>!!(rt!=null&&rt.render),context$1=reactExports.createContext(null),createStore=(rt,_)=>{const ut=create$1((Bt,Ut)=>{const Ht=new Vector3,tr=new Vector3,rr=new Vector3;function sr(Dr=Ut().camera,$r=tr,Br=Ut().size){const{width:Jr,height:mn,top:Mn,left:$n}=Br,en=Jr/mn;$r instanceof Vector3?rr.copy($r):rr.set(...$r);const In=Dr.getWorldPosition(Ht).distanceTo(rr);if(isOrthographicCamera(Dr))return{width:Jr/Dr.zoom,height:mn/Dr.zoom,top:Mn,left:$n,factor:1,distance:In,aspect:en};{const Rn=Dr.fov*Math.PI/180,qn=2*Math.tan(Rn/2)*In,Qn=qn*(Jr/mn);return{width:Qn,height:qn,top:Mn,left:$n,factor:Jr/Qn,distance:In,aspect:en}}}let ar;const cr=Dr=>Bt($r=>({performance:{...$r.performance,current:Dr}})),Ar=new Vector2;return{set:Bt,get:Ut,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(Dr=1)=>rt(Ut(),Dr),advance:(Dr,$r)=>_(Dr,$r,Ut()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Clock$1,pointer:Ar,mouse:Ar,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const Dr=Ut();ar&&clearTimeout(ar),Dr.performance.current!==Dr.performance.min&&cr(Dr.performance.min),ar=setTimeout(()=>cr(Ut().performance.max),Dr.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:sr},setEvents:Dr=>Bt($r=>({...$r,events:{...$r.events,...Dr}})),setSize:(Dr,$r,Br,Jr,mn)=>{const Mn=Ut().camera,$n={width:Dr,height:$r,top:Jr||0,left:mn||0,updateStyle:Br};Bt(en=>({size:$n,viewport:{...en.viewport,...sr(Mn,tr,$n)}}))},setDpr:Dr=>Bt($r=>{const Br=calculateDpr(Dr);return{viewport:{...$r.viewport,dpr:Br,initialDpr:$r.viewport.initialDpr||Br}}}),setFrameloop:(Dr="always")=>{const $r=Ut().clock;$r.stop(),$r.elapsedTime=0,Dr!=="never"&&($r.start(),$r.elapsedTime=0),Bt(()=>({frameloop:Dr}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:reactExports.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(Dr,$r,Br)=>{const Jr=Ut().internal;return Jr.priority=Jr.priority+($r>0?1:0),Jr.subscribers.push({ref:Dr,priority:$r,store:Br}),Jr.subscribers=Jr.subscribers.sort((mn,Mn)=>mn.priority-Mn.priority),()=>{const mn=Ut().internal;mn!=null&&mn.subscribers&&(mn.priority=mn.priority-($r>0?1:0),mn.subscribers=mn.subscribers.filter(Mn=>Mn.ref!==Dr))}}}}}),mt=ut.getState();let bt=mt.size,St=mt.viewport.dpr,Mt=mt.camera;return ut.subscribe(()=>{const{camera:Bt,size:Ut,viewport:Ht,gl:tr,set:rr}=ut.getState();if(Ut!==bt||Ht.dpr!==St){var sr;bt=Ut,St=Ht.dpr,updateCamera(Bt,Ut),tr.setPixelRatio(Ht.dpr);const ar=(sr=Ut.updateStyle)!=null?sr:typeof HTMLCanvasElement<"u"&&tr.domElement instanceof HTMLCanvasElement;tr.setSize(Ut.width,Ut.height,ar)}Bt!==Mt&&(Mt=Bt,rr(ar=>({viewport:{...ar.viewport,...ar.viewport.getCurrentViewport(Bt)}})))}),ut.subscribe(Bt=>rt(Bt)),ut};function createSubs(rt,_){const ut={callback:rt};return _.add(ut),()=>void _.delete(ut)}let i$6,globalEffects=new Set,globalAfterEffects=new Set,globalTailEffects=new Set;const addEffect=rt=>createSubs(rt,globalEffects);function run(rt,_){if(rt.size)for(const{callback:ut}of rt.values())ut(_)}function flushGlobalEffects(rt,_){switch(rt){case"before":return run(globalEffects,_);case"after":return run(globalAfterEffects,_);case"tail":return run(globalTailEffects,_)}}let subscribers,subscription;function render$1(rt,_,ut){let mt=_.clock.getDelta();for(_.frameloop==="never"&&typeof rt=="number"&&(mt=rt-_.clock.elapsedTime,_.clock.oldTime=_.clock.elapsedTime,_.clock.elapsedTime=rt),subscribers=_.internal.subscribers,i$6=0;i$6<subscribers.length;i$6++)subscription=subscribers[i$6],subscription.ref.current(subscription.store.getState(),mt,ut);return!_.internal.priority&&_.gl.render&&_.gl.render(_.scene,_.camera),_.internal.frames=Math.max(0,_.internal.frames-1),_.frameloop==="always"?1:_.internal.frames}function createLoop(rt){let _=!1,ut,mt,bt;function St(Ut){mt=requestAnimationFrame(St),_=!0,ut=0,flushGlobalEffects("before",Ut);for(const tr of rt.values()){var Ht;bt=tr.store.getState(),bt.internal.active&&(bt.frameloop==="always"||bt.internal.frames>0)&&!((Ht=bt.gl.xr)!=null&&Ht.isPresenting)&&(ut+=render$1(Ut,bt))}if(flushGlobalEffects("after",Ut),ut===0)return flushGlobalEffects("tail",Ut),_=!1,cancelAnimationFrame(mt)}function Mt(Ut,Ht=1){var tr;if(!Ut)return rt.forEach(rr=>Mt(rr.store.getState()),Ht);(tr=Ut.gl.xr)!=null&&tr.isPresenting||!Ut.internal.active||Ut.frameloop==="never"||(Ut.internal.frames=Math.min(60,Ut.internal.frames+Ht),_||(_=!0,requestAnimationFrame(St)))}function Bt(Ut,Ht=!0,tr,rr){if(Ht&&flushGlobalEffects("before",Ut),tr)render$1(Ut,tr,rr);else for(const sr of rt.values())render$1(Ut,sr.store.getState());Ht&&flushGlobalEffects("after",Ut)}return{loop:St,invalidate:Mt,advance:Bt}}function useInstanceHandle(rt){const _=reactExports.useRef(null);return useIsomorphicLayoutEffect$2(()=>void(_.current=rt.current.__r3f),[rt]),_}function useStore(){const rt=reactExports.useContext(context$1);if(!rt)throw new Error("R3F: Hooks can only be used within the Canvas component!");return rt}function useThree(rt=ut=>ut,_){return useStore()(rt,_)}function useFrame(rt,_=0){const ut=useStore(),mt=ut.getState().internal.subscribe,bt=useMutableCallback(rt);return useIsomorphicLayoutEffect$2(()=>mt(bt,_,ut),[_,mt,ut]),null}function useGraph(rt){return reactExports.useMemo(()=>buildGraph(rt),[rt])}function loadingFn(rt,_){return function(ut,...mt){const bt=new ut;return rt&&rt(bt),Promise.all(mt.map(St=>new Promise((Mt,Bt)=>bt.load(St,Ut=>{Ut.scene&&Object.assign(Ut,buildGraph(Ut.scene)),Mt(Ut)},_,Ut=>Bt(new Error(`Could not load ${St}: ${Ut.message})`))))))}}function useLoader(rt,_,ut,mt){const bt=Array.isArray(_)?_:[_],St=suspend$1(loadingFn(ut,mt),[rt,...bt],{equal:is$2.equ});return Array.isArray(_)?St:St[0]}useLoader.preload=function(rt,_,ut){const mt=Array.isArray(_)?_:[_];return preload(loadingFn(ut),[rt,...mt])};useLoader.clear=function(rt,_){const ut=Array.isArray(_)?_:[_];return clear([rt,...ut])};const roots=new Map,{invalidate,advance:advance$1}=createLoop(roots),{reconciler,applyProps}=createRenderer(roots,getEventPriority),shallowLoose={objects:"shallow",strict:!1},createRendererInstance=(rt,_)=>{const ut=typeof rt=="function"?rt(_):rt;return isRenderer(ut)?ut:new WebGLRenderer({powerPreference:"high-performance",canvas:_,antialias:!0,alpha:!0,...rt})};function computeInitialSize(rt,_){if(_)return _;if(typeof HTMLCanvasElement<"u"&&rt instanceof HTMLCanvasElement&&rt.parentElement){const{width:ut,height:mt,top:bt,left:St}=rt.parentElement.getBoundingClientRect();return{width:ut,height:mt,top:bt,left:St}}else if(typeof OffscreenCanvas<"u"&&rt instanceof OffscreenCanvas)return{width:rt.width,height:rt.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function createRoot(rt){const _=roots.get(rt),ut=_==null?void 0:_.fiber,mt=_==null?void 0:_.store;_&&console.warn("R3F.createRoot should only be called once!");const bt=typeof reportError=="function"?reportError:console.error,St=mt||createStore(invalidate,advance$1),Mt=ut||reconciler.createContainer(St,constantsExports.ConcurrentRoot,null,!1,null,"",bt,null);_||roots.set(rt,{fiber:Mt,store:St});let Bt,Ut=!1,Ht;return{configure(tr={}){let{gl:rr,size:sr,scene:ar,events:cr,onCreated:Ar,shadows:_r=!1,linear:Dr=!1,flat:$r=!1,legacy:Br=!1,orthographic:Jr=!1,frameloop:mn="always",dpr:Mn=[1,2],performance:$n,raycaster:en,camera:In,onPointerMissed:Rn}=tr,qn=St.getState(),Qn=qn.gl;qn.gl||qn.set({gl:Qn=createRendererInstance(rr,rt)});let xs=qn.raycaster;xs||qn.set({raycaster:xs=new Raycaster});const{params:cs,...ks}=en||{};if(is$2.equ(ks,xs,shallowLoose)||applyProps(xs,{...ks}),is$2.equ(cs,xs.params,shallowLoose)||applyProps(xs,{params:{...xs.params,...cs}}),!qn.camera||qn.camera===Ht&&!is$2.equ(Ht,In,shallowLoose)){Ht=In;const Oo=In instanceof Camera,uo=Oo?In:Jr?new OrthographicCamera$1(0,0,0,0,.1,1e3):new PerspectiveCamera$1(75,0,.1,1e3);Oo||(uo.position.z=5,In&&applyProps(uo,In),!qn.camera&&!(In!=null&&In.rotation)&&uo.lookAt(0,0,0)),qn.set({camera:uo})}if(!qn.scene){let Oo;ar instanceof Scene$3?Oo=ar:(Oo=new Scene$3,ar&&applyProps(Oo,ar)),qn.set({scene:prepare(Oo)})}if(!qn.xr){const Oo=(cu,Jl)=>{const mu=St.getState();mu.frameloop!=="never"&&advance$1(cu,!0,mu,Jl)},uo=()=>{const cu=St.getState();cu.gl.xr.enabled=cu.gl.xr.isPresenting,cu.gl.xr.setAnimationLoop(cu.gl.xr.isPresenting?Oo:null),cu.gl.xr.isPresenting||invalidate(cu)},uu={connect(){const cu=St.getState().gl;cu.xr.addEventListener("sessionstart",uo),cu.xr.addEventListener("sessionend",uo)},disconnect(){const cu=St.getState().gl;cu.xr.removeEventListener("sessionstart",uo),cu.xr.removeEventListener("sessionend",uo)}};Qn.xr&&uu.connect(),qn.set({xr:uu})}if(Qn.shadowMap){const Oo=Qn.shadowMap.enabled,uo=Qn.shadowMap.type;if(Qn.shadowMap.enabled=!!_r,is$2.boo(_r))Qn.shadowMap.type=PCFSoftShadowMap;else if(is$2.str(_r)){var _o;const uu={basic:BasicShadowMap,percentage:PCFShadowMap,soft:PCFSoftShadowMap,variance:VSMShadowMap};Qn.shadowMap.type=(_o=uu[_r])!=null?_o:PCFSoftShadowMap}else is$2.obj(_r)&&Object.assign(Qn.shadowMap,_r);(Oo!==Qn.shadowMap.enabled||uo!==Qn.shadowMap.type)&&(Qn.shadowMap.needsUpdate=!0)}const qs=getColorManagement();qs&&("enabled"in qs?qs.enabled=!Br:"legacyMode"in qs&&(qs.legacyMode=Br));const Ss=Dr?LinearEncoding$1:sRGBEncoding$1,eo=$r?NoToneMapping:ACESFilmicToneMapping;Qn.outputEncoding!==Ss&&(Qn.outputEncoding=Ss),Qn.toneMapping!==eo&&(Qn.toneMapping=eo),qn.legacy!==Br&&qn.set(()=>({legacy:Br})),qn.linear!==Dr&&qn.set(()=>({linear:Dr})),qn.flat!==$r&&qn.set(()=>({flat:$r})),rr&&!is$2.fun(rr)&&!isRenderer(rr)&&!is$2.equ(rr,Qn,shallowLoose)&&applyProps(Qn,rr),cr&&!qn.events.handlers&&qn.set({events:cr(St)});const Ao=computeInitialSize(rt,sr);return is$2.equ(Ao,qn.size,shallowLoose)||qn.setSize(Ao.width,Ao.height,Ao.updateStyle,Ao.top,Ao.left),Mn&&qn.viewport.dpr!==calculateDpr(Mn)&&qn.setDpr(Mn),qn.frameloop!==mn&&qn.setFrameloop(mn),qn.onPointerMissed||qn.set({onPointerMissed:Rn}),$n&&!is$2.equ($n,qn.performance,shallowLoose)&&qn.set(Oo=>({performance:{...Oo.performance,...$n}})),Bt=Ar,Ut=!0,this},render(tr){return Ut||this.configure(),reconciler.updateContainer(reactExports.createElement(Provider,{store:St,children:tr,onCreated:Bt,rootElement:rt}),Mt,null,()=>{}),St},unmount(){unmountComponentAtNode(rt)}}}function Provider({store:rt,children:_,onCreated:ut,rootElement:mt}){return useIsomorphicLayoutEffect$2(()=>{const bt=rt.getState();bt.set(St=>({internal:{...St.internal,active:!0}})),ut&&ut(bt),rt.getState().events.connected||bt.events.connect==null||bt.events.connect(mt)},[]),reactExports.createElement(context$1.Provider,{value:rt},_)}function unmountComponentAtNode(rt,_){const ut=roots.get(rt),mt=ut==null?void 0:ut.fiber;if(mt){const bt=ut==null?void 0:ut.store.getState();bt&&(bt.internal.active=!1),reconciler.updateContainer(null,mt,null,()=>{bt&&setTimeout(()=>{try{var St,Mt,Bt,Ut;bt.events.disconnect==null||bt.events.disconnect(),(St=bt.gl)==null||(Mt=St.renderLists)==null||Mt.dispose==null||Mt.dispose(),(Bt=bt.gl)==null||Bt.forceContextLoss==null||Bt.forceContextLoss(),(Ut=bt.gl)!=null&&Ut.xr&&bt.xr.disconnect(),dispose(bt),roots.delete(rt)}catch{}},500)})}}function createPortal(rt,_,ut){return reactExports.createElement(Portal$1,{key:_.uuid,children:rt,container:_,state:ut})}function Portal$1({state:rt={},children:_,container:ut}){const{events:mt,size:bt,...St}=rt,Mt=useStore(),[Bt]=reactExports.useState(()=>new Raycaster),[Ut]=reactExports.useState(()=>new Vector2),Ht=reactExports.useCallback((rr,sr)=>{const ar={...rr};Object.keys(rr).forEach(Ar=>{(privateKeys.includes(Ar)||rr[Ar]!==sr[Ar]&&sr[Ar])&&delete ar[Ar]});let cr;if(sr&&bt){const Ar=sr.camera;cr=rr.viewport.getCurrentViewport(Ar,new Vector3,bt),Ar!==rr.camera&&updateCamera(Ar,bt)}return{...ar,scene:ut,raycaster:Bt,pointer:Ut,mouse:Ut,previousRoot:Mt,events:{...rr.events,...sr==null?void 0:sr.events,...mt},size:{...rr.size,...bt},viewport:{...rr.viewport,...cr},...St}},[rt]),[tr]=reactExports.useState(()=>{const rr=Mt.getState();return create$1((ar,cr)=>({...rr,scene:ut,raycaster:Bt,pointer:Ut,mouse:Ut,previousRoot:Mt,events:{...rr.events,...mt},size:{...rr.size,...bt},...St,set:ar,get:cr,setEvents:Ar=>ar(_r=>({..._r,events:{..._r.events,...Ar}}))}))});return reactExports.useEffect(()=>{const rr=Mt.subscribe(sr=>tr.setState(ar=>Ht(sr,ar)));return()=>{rr(),tr.destroy()}},[]),reactExports.useEffect(()=>{tr.setState(rr=>Ht(Mt.getState(),rr))},[Ht]),reactExports.createElement(reactExports.Fragment,null,reconciler.createPortal(reactExports.createElement(context$1.Provider,{value:tr},_),tr,null))}reconciler.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:reactExports.version});function _extends$4(){return _extends$4=Object.assign?Object.assign.bind():function(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_];for(var mt in ut)Object.prototype.hasOwnProperty.call(ut,mt)&&(rt[mt]=ut[mt])}return rt},_extends$4.apply(this,arguments)}function debounce$1(rt,_,ut){var mt,bt,St,Mt,Bt;_==null&&(_=100);function Ut(){var tr=Date.now()-Mt;tr<_&&tr>=0?mt=setTimeout(Ut,_-tr):(mt=null,ut||(Bt=rt.apply(St,bt),St=bt=null))}var Ht=function(){St=this,bt=arguments,Mt=Date.now();var tr=ut&&!mt;return mt||(mt=setTimeout(Ut,_)),tr&&(Bt=rt.apply(St,bt),St=bt=null),Bt};return Ht.clear=function(){mt&&(clearTimeout(mt),mt=null)},Ht.flush=function(){mt&&(Bt=rt.apply(St,bt),St=bt=null,clearTimeout(mt),mt=null)},Ht}debounce$1.debounce=debounce$1;var debounce_1=debounce$1;const createDebounce=getDefaultExportFromCjs(debounce_1);function useMeasure(rt){let{debounce:_,scroll:ut,polyfill:mt,offsetSize:bt}=rt===void 0?{debounce:0,scroll:!1,offsetSize:!1}:rt;const St=mt||(typeof window>"u"?class{}:window.ResizeObserver);if(!St)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[Mt,Bt]=reactExports.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),Ut=reactExports.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:Mt}),Ht=_?typeof _=="number"?_:_.scroll:null,tr=_?typeof _=="number"?_:_.resize:null,rr=reactExports.useRef(!1);reactExports.useEffect(()=>(rr.current=!0,()=>void(rr.current=!1)));const[sr,ar,cr]=reactExports.useMemo(()=>{const $r=()=>{if(!Ut.current.element)return;const{left:Br,top:Jr,width:mn,height:Mn,bottom:$n,right:en,x:In,y:Rn}=Ut.current.element.getBoundingClientRect(),qn={left:Br,top:Jr,width:mn,height:Mn,bottom:$n,right:en,x:In,y:Rn};Ut.current.element instanceof HTMLElement&&bt&&(qn.height=Ut.current.element.offsetHeight,qn.width=Ut.current.element.offsetWidth),Object.freeze(qn),rr.current&&!areBoundsEqual(Ut.current.lastBounds,qn)&&Bt(Ut.current.lastBounds=qn)};return[$r,tr?createDebounce($r,tr):$r,Ht?createDebounce($r,Ht):$r]},[Bt,bt,Ht,tr]);function Ar(){Ut.current.scrollContainers&&(Ut.current.scrollContainers.forEach($r=>$r.removeEventListener("scroll",cr,!0)),Ut.current.scrollContainers=null),Ut.current.resizeObserver&&(Ut.current.resizeObserver.disconnect(),Ut.current.resizeObserver=null)}function _r(){Ut.current.element&&(Ut.current.resizeObserver=new St(cr),Ut.current.resizeObserver.observe(Ut.current.element),ut&&Ut.current.scrollContainers&&Ut.current.scrollContainers.forEach($r=>$r.addEventListener("scroll",cr,{capture:!0,passive:!0})))}const Dr=$r=>{!$r||$r===Ut.current.element||(Ar(),Ut.current.element=$r,Ut.current.scrollContainers=findScrollContainers($r),_r())};return useOnWindowScroll(cr,!!ut),useOnWindowResize(ar),reactExports.useEffect(()=>{Ar(),_r()},[ut,cr,ar]),reactExports.useEffect(()=>Ar,[]),[Dr,Mt,sr]}function useOnWindowResize(rt){reactExports.useEffect(()=>{const _=rt;return window.addEventListener("resize",_),()=>void window.removeEventListener("resize",_)},[rt])}function useOnWindowScroll(rt,_){reactExports.useEffect(()=>{if(_){const ut=rt;return window.addEventListener("scroll",ut,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",ut,!0)}},[rt,_])}function findScrollContainers(rt){const _=[];if(!rt||rt===document.body)return _;const{overflow:ut,overflowX:mt,overflowY:bt}=window.getComputedStyle(rt);return[ut,mt,bt].some(St=>St==="auto"||St==="scroll")&&_.push(rt),[..._,...findScrollContainers(rt.parentElement)]}const keys=["x","y","top","bottom","left","right","width","height"],areBoundsEqual=(rt,_)=>keys.every(ut=>rt[ut]===_[ut]);var __defProp$2=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp$2=(rt,_,ut)=>_ in rt?__defProp$2(rt,_,{enumerable:!0,configurable:!0,writable:!0,value:ut}):rt[_]=ut,__spreadValues=(rt,_)=>{for(var ut in _||(_={}))__hasOwnProp.call(_,ut)&&__defNormalProp$2(rt,ut,_[ut]);if(__getOwnPropSymbols)for(var ut of __getOwnPropSymbols(_))__propIsEnum.call(_,ut)&&__defNormalProp$2(rt,ut,_[ut]);return rt},__spreadProps=(rt,_)=>__defProps(rt,__getOwnPropDescs(_)),_a$2,_b$2;typeof window<"u"&&((_a$2=window.document)!=null&&_a$2.createElement||((_b$2=window.navigator)==null?void 0:_b$2.product)==="ReactNative")?reactExports.useLayoutEffect:reactExports.useEffect;function traverseFiber(rt,_,ut){if(!rt)return;if(ut(rt)===!0)return rt;let mt=rt.child;for(;mt;){const bt=traverseFiber(mt,_,ut);if(bt)return bt;mt=mt.sibling}}function wrapContext(rt){try{return Object.defineProperties(rt,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return rt}}const error=console.error;console.error=function(){const rt=[...arguments].join("");if(rt!=null&&rt.startsWith("Warning:")&&rt.includes("useContext")){console.error=error;return}return error.apply(this,arguments)};const FiberContext=wrapContext(reactExports.createContext(null));class FiberProvider extends reactExports.Component{render(){return reactExports.createElement(FiberContext.Provider,{value:this._reactInternals},this.props.children)}}function useFiber(){const rt=reactExports.useContext(FiberContext);if(rt===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const _=reactExports.useId();return reactExports.useMemo(()=>{for(const mt of[rt,rt==null?void 0:rt.alternate]){if(!mt)continue;const bt=traverseFiber(mt,!1,St=>{let Mt=St.memoizedState;for(;Mt;){if(Mt.memoizedState===_)return!0;Mt=Mt.next}});if(bt)return bt}},[rt,_])}function useContextMap(){const rt=useFiber(),[_]=reactExports.useState(()=>new Map);_.clear();let ut=rt;for(;ut;){if(ut.type&&typeof ut.type=="object"){const bt=ut.type._context===void 0&&ut.type.Provider===ut.type?ut.type:ut.type._context;bt&&bt!==FiberContext&&!_.has(bt)&&_.set(bt,reactExports.useContext(wrapContext(bt)))}ut=ut.return}return _}function useContextBridge(){const rt=useContextMap();return reactExports.useMemo(()=>Array.from(rt.keys()).reduce((_,ut)=>mt=>reactExports.createElement(_,null,reactExports.createElement(ut.Provider,__spreadProps(__spreadValues({},mt),{value:rt.get(ut)}))),_=>reactExports.createElement(FiberProvider,__spreadValues({},_))),[rt])}const DOM_EVENTS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function createPointerEvents(rt){const{handlePointer:_}=createEvents(rt);return{priority:1,enabled:!0,compute(ut,mt,bt){mt.pointer.set(ut.offsetX/mt.size.width*2-1,-(ut.offsetY/mt.size.height)*2+1),mt.raycaster.setFromCamera(mt.pointer,mt.camera)},connected:void 0,handlers:Object.keys(DOM_EVENTS).reduce((ut,mt)=>({...ut,[mt]:_(mt)}),{}),update:()=>{var ut;const{events:mt,internal:bt}=rt.getState();(ut=bt.lastEvent)!=null&&ut.current&&mt.handlers&&mt.handlers.onPointerMove(bt.lastEvent.current)},connect:ut=>{var mt;const{set:bt,events:St}=rt.getState();St.disconnect==null||St.disconnect(),bt(Mt=>({events:{...Mt.events,connected:ut}})),Object.entries((mt=St.handlers)!=null?mt:[]).forEach(([Mt,Bt])=>{const[Ut,Ht]=DOM_EVENTS[Mt];ut.addEventListener(Ut,Bt,{passive:Ht})})},disconnect:()=>{const{set:ut,events:mt}=rt.getState();if(mt.connected){var bt;Object.entries((bt=mt.handlers)!=null?bt:[]).forEach(([St,Mt])=>{if(mt&&mt.connected instanceof HTMLElement){const[Bt]=DOM_EVENTS[St];mt.connected.removeEventListener(Bt,Mt)}}),ut(St=>({events:{...St.events,connected:void 0}}))}}}}const CanvasImpl=reactExports.forwardRef(function rt({children:_,fallback:ut,resize:mt,style:bt,gl:St,events:Mt=createPointerEvents,eventSource:Bt,eventPrefix:Ut,shadows:Ht,linear:tr,flat:rr,legacy:sr,orthographic:ar,frameloop:cr,dpr:Ar,performance:_r,raycaster:Dr,camera:$r,onPointerMissed:Br,onCreated:Jr,...mn},Mn){reactExports.useMemo(()=>extend$3(THREE),[]);const $n=useContextBridge(),[en,In]=useMeasure({scroll:!0,debounce:{scroll:50,resize:0},...mt}),Rn=reactExports.useRef(null),qn=reactExports.useRef(null);reactExports.useImperativeHandle(Mn,()=>Rn.current);const Qn=useMutableCallback(Br),[xs,cs]=reactExports.useState(!1),[ks,_o]=reactExports.useState(!1);if(xs)throw xs;if(ks)throw ks;const qs=reactExports.useRef(null);useIsomorphicLayoutEffect$2(()=>{const eo=Rn.current;In.width>0&&In.height>0&&eo&&(qs.current||(qs.current=createRoot(eo)),qs.current.configure({gl:St,events:Mt,shadows:Ht,linear:tr,flat:rr,legacy:sr,orthographic:ar,frameloop:cr,dpr:Ar,performance:_r,raycaster:Dr,camera:$r,size:In,onPointerMissed:(...Ao)=>Qn.current==null?void 0:Qn.current(...Ao),onCreated:Ao=>{Ao.events.connect==null||Ao.events.connect(Bt?isRef$1(Bt)?Bt.current:Bt:qn.current),Ut&&Ao.setEvents({compute:(Oo,uo)=>{const uu=Oo[Ut+"X"],cu=Oo[Ut+"Y"];uo.pointer.set(uu/uo.size.width*2-1,-(cu/uo.size.height)*2+1),uo.raycaster.setFromCamera(uo.pointer,uo.camera)}}),Jr==null||Jr(Ao)}}),qs.current.render(reactExports.createElement($n,null,reactExports.createElement(ErrorBoundary,{set:_o},reactExports.createElement(reactExports.Suspense,{fallback:reactExports.createElement(Block,{set:cs})},_)))))}),reactExports.useEffect(()=>{const eo=Rn.current;if(eo)return()=>unmountComponentAtNode(eo)},[]);const Ss=Bt?"none":"auto";return reactExports.createElement("div",_extends$4({ref:qn,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Ss,...bt}},mn),reactExports.createElement("div",{ref:en,style:{width:"100%",height:"100%"}},reactExports.createElement("canvas",{ref:Rn,style:{display:"block"}},ut)))}),Canvas$1=reactExports.forwardRef(function rt(_,ut){return reactExports.createElement(FiberProvider,null,reactExports.createElement(CanvasImpl,_extends$4({},_,{ref:ut})))}),v1$1=new Vector3,v2=new Vector3,v3=new Vector3,v4=new Vector2;function defaultCalculatePosition(rt,_,ut){const mt=v1$1.setFromMatrixPosition(rt.matrixWorld);mt.project(_);const bt=ut.width/2,St=ut.height/2;return[mt.x*bt+bt,-(mt.y*St)+St]}function isObjectBehindCamera(rt,_){const ut=v1$1.setFromMatrixPosition(rt.matrixWorld),mt=v2.setFromMatrixPosition(_.matrixWorld),bt=ut.sub(mt),St=_.getWorldDirection(v3);return bt.angleTo(St)>Math.PI/2}function isObjectVisible(rt,_,ut,mt){const bt=v1$1.setFromMatrixPosition(rt.matrixWorld),St=bt.clone();St.project(_),v4.set(St.x,St.y),ut.setFromCamera(v4,_);const Mt=ut.intersectObjects(mt,!0);if(Mt.length){const Bt=Mt[0].distance;return bt.distanceTo(ut.ray.origin)<Bt}return!0}function objectScale(rt,_){if(_ instanceof OrthographicCamera$1)return _.zoom;if(_ instanceof PerspectiveCamera$1){const ut=v1$1.setFromMatrixPosition(rt.matrixWorld),mt=v2.setFromMatrixPosition(_.matrixWorld),bt=_.fov*Math.PI/180,St=ut.distanceTo(mt);return 1/(2*Math.tan(bt/2)*St)}else return 1}function objectZIndex(rt,_,ut){if(_ instanceof PerspectiveCamera$1||_ instanceof OrthographicCamera$1){const mt=v1$1.setFromMatrixPosition(rt.matrixWorld),bt=v2.setFromMatrixPosition(_.matrixWorld),St=mt.distanceTo(bt),Mt=(ut[1]-ut[0])/(_.far-_.near),Bt=ut[1]-Mt*_.far;return Math.round(Mt*St+Bt)}}const epsilon=rt=>Math.abs(rt)<1e-10?0:rt;function getCSSMatrix(rt,_,ut=""){let mt="matrix3d(";for(let bt=0;bt!==16;bt++)mt+=epsilon(_[bt]*rt.elements[bt])+(bt!==15?",":")");return ut+mt}const getCameraCSSMatrix=(rt=>_=>getCSSMatrix(_,rt))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),getObjectCSSMatrix=(rt=>(_,ut)=>getCSSMatrix(_,rt(ut),"translate(-50%,-50%)"))(rt=>[1/rt,1/rt,1/rt,1,-1/rt,-1/rt,-1/rt,-1,1/rt,1/rt,1/rt,1,1,1,1,1]);function isRefObject$1(rt){return rt&&typeof rt=="object"&&"current"in rt}const Html=reactExports.forwardRef(({children:rt,eps:_=.001,style:ut,className:mt,prepend:bt,center:St,fullscreen:Mt,portal:Bt,distanceFactor:Ut,sprite:Ht=!1,transform:tr=!1,occlude:rr,onOcclude:sr,castShadow:ar,receiveShadow:cr,material:Ar,geometry:_r,zIndexRange:Dr=[16777271,0],calculatePosition:$r=defaultCalculatePosition,as:Br="div",wrapperClass:Jr,pointerEvents:mn="auto",...Mn},$n)=>{const{gl:en,camera:In,scene:Rn,size:qn,raycaster:Qn,events:xs,viewport:cs}=useThree(),[ks]=reactExports.useState(()=>document.createElement(Br)),_o=reactExports.useRef(),qs=reactExports.useRef(null),Ss=reactExports.useRef(0),eo=reactExports.useRef([0,0]),Ao=reactExports.useRef(null),Oo=reactExports.useRef(null),uo=(Bt==null?void 0:Bt.current)||xs.connected||en.domElement.parentNode,uu=reactExports.useRef(null),cu=reactExports.useRef(!1),Jl=reactExports.useMemo(()=>rr&&rr!=="blending"||Array.isArray(rr)&&rr.length&&isRefObject$1(rr[0]),[rr]);reactExports.useLayoutEffect(()=>{const Up=en.domElement;rr&&rr==="blending"?(Up.style.zIndex=`${Math.floor(Dr[0]/2)}`,Up.style.position="absolute",Up.style.pointerEvents="none"):(Up.style.zIndex=null,Up.style.position=null,Up.style.pointerEvents=null)},[rr]),reactExports.useLayoutEffect(()=>{if(qs.current){const Up=_o.current=createRoot$1(ks);if(Rn.updateMatrixWorld(),tr)ks.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Ep=$r(qs.current,In,qn);ks.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Ep[0]}px,${Ep[1]}px,0);transform-origin:0 0;`}return uo&&(bt?uo.prepend(ks):uo.appendChild(ks)),()=>{uo&&uo.removeChild(ks),Up.unmount()}}},[uo,tr]),reactExports.useLayoutEffect(()=>{Jr&&(ks.className=Jr)},[Jr]);const mu=reactExports.useMemo(()=>tr?{position:"absolute",top:0,left:0,width:qn.width,height:qn.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:St?"translate3d(-50%,-50%,0)":"none",...Mt&&{top:-qn.height/2,left:-qn.width/2,width:qn.width,height:qn.height},...ut},[ut,St,Mt,qn,tr]),pu=reactExports.useMemo(()=>({position:"absolute",pointerEvents:mn}),[mn]);reactExports.useLayoutEffect(()=>{if(cu.current=!1,tr){var Up;(Up=_o.current)==null||Up.render(reactExports.createElement("div",{ref:Ao,style:mu},reactExports.createElement("div",{ref:Oo,style:pu},reactExports.createElement("div",{ref:$n,className:mt,style:ut,children:rt}))))}else{var Ep;(Ep=_o.current)==null||Ep.render(reactExports.createElement("div",{ref:$n,style:mu,className:mt,children:rt}))}});const Zu=reactExports.useRef(!0);useFrame(Up=>{if(qs.current){In.updateMatrixWorld(),qs.current.updateWorldMatrix(!0,!1);const Ep=tr?eo.current:$r(qs.current,In,qn);if(tr||Math.abs(Ss.current-In.zoom)>_||Math.abs(eo.current[0]-Ep[0])>_||Math.abs(eo.current[1]-Ep[1])>_){const mp=isObjectBehindCamera(qs.current,In);let Cp=!1;Jl&&(Array.isArray(rr)?Cp=rr.map(K0=>K0.current):rr!=="blending"&&(Cp=[Rn]));const t0=Zu.current;if(Cp){const K0=isObjectVisible(qs.current,In,Qn,Cp);Zu.current=K0&&!mp}else Zu.current=!mp;t0!==Zu.current&&(sr?sr(!Zu.current):ks.style.display=Zu.current?"block":"none");const _g=Math.floor(Dr[0]/2),m0=rr?Jl?[Dr[0],_g]:[_g-1,0]:Dr;if(ks.style.zIndex=`${objectZIndex(qs.current,In,m0)}`,tr){const[K0,Jp]=[qn.width/2,qn.height/2],y0=In.projectionMatrix.elements[5]*Jp,{isOrthographicCamera:z0,top:jm,left:Nu,bottom:Co,right:Bp}=In,a0=getCameraCSSMatrix(In.matrixWorldInverse),Q0=z0?`scale(${y0})translate(${epsilon(-(Bp+Nu)/2)}px,${epsilon((jm+Co)/2)}px)`:`translateZ(${y0}px)`;let T0=qs.current.matrixWorld;Ht&&(T0=In.matrixWorldInverse.clone().transpose().copyPosition(T0).scale(qs.current.scale),T0.elements[3]=T0.elements[7]=T0.elements[11]=0,T0.elements[15]=1),ks.style.width=qn.width+"px",ks.style.height=qn.height+"px",ks.style.perspective=z0?"":`${y0}px`,Ao.current&&Oo.current&&(Ao.current.style.transform=`${Q0}${a0}translate(${K0}px,${Jp}px)`,Oo.current.style.transform=getObjectCSSMatrix(T0,1/((Ut||10)/400)))}else{const K0=Ut===void 0?1:objectScale(qs.current,In)*Ut;ks.style.transform=`translate3d(${Ep[0]}px,${Ep[1]}px,0) scale(${K0})`}eo.current=Ep,Ss.current=In.zoom}}if(!Jl&&uu.current&&!cu.current)if(tr){if(Ao.current){const Ep=Ao.current.children[0];if(Ep!=null&&Ep.clientWidth&&Ep!=null&&Ep.clientHeight){const{isOrthographicCamera:mp}=In;if(mp||_r)Mn.scale&&(Array.isArray(Mn.scale)?Mn.scale instanceof Vector3?uu.current.scale.copy(Mn.scale.clone().divideScalar(1)):uu.current.scale.set(1/Mn.scale[0],1/Mn.scale[1],1/Mn.scale[2]):uu.current.scale.setScalar(1/Mn.scale));else{const Cp=(Ut||10)/400,t0=Ep.clientWidth*Cp,_g=Ep.clientHeight*Cp;uu.current.scale.set(t0,_g,1)}cu.current=!0}}}else{const Ep=ks.children[0];if(Ep!=null&&Ep.clientWidth&&Ep!=null&&Ep.clientHeight){const mp=1/cs.factor,Cp=Ep.clientWidth*mp,t0=Ep.clientHeight*mp;uu.current.scale.set(Cp,t0,1),cu.current=!0}uu.current.lookAt(Up.camera.position)}});const Mp=reactExports.useMemo(()=>({vertexShader:tr?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[tr]);return reactExports.createElement("group",_extends$4({},Mn,{ref:qs}),rr&&!Jl&&reactExports.createElement("mesh",{castShadow:ar,receiveShadow:cr,ref:uu},_r||reactExports.createElement("planeGeometry",null),Ar||reactExports.createElement("shaderMaterial",{side:DoubleSide,vertexShader:Mp.vertexShader,fragmentShader:Mp.fragmentShader})))});function clamp$6(rt,_,ut){return Math.max(_,Math.min(rt,ut))}const V$2={toVector(rt,_){return rt===void 0&&(rt=_),Array.isArray(rt)?rt:[rt,rt]},add(rt,_){return[rt[0]+_[0],rt[1]+_[1]]},sub(rt,_){return[rt[0]-_[0],rt[1]-_[1]]},addTo(rt,_){rt[0]+=_[0],rt[1]+=_[1]},subTo(rt,_){rt[0]-=_[0],rt[1]-=_[1]}};function rubberband(rt,_,ut){return _===0||Math.abs(_)===1/0?Math.pow(rt,ut*5):rt*_*ut/(_+ut*rt)}function rubberbandIfOutOfBounds(rt,_,ut,mt=.15){return mt===0?clamp$6(rt,_,ut):rt<_?-rubberband(_-rt,ut-_,mt)+_:rt>ut?+rubberband(rt-ut,ut-_,mt)+ut:rt}function computeRubberband(rt,[_,ut],[mt,bt]){const[[St,Mt],[Bt,Ut]]=rt;return[rubberbandIfOutOfBounds(_,St,Mt,mt),rubberbandIfOutOfBounds(ut,Bt,Ut,bt)]}function _toPrimitive(rt,_){if(typeof rt!="object"||rt===null)return rt;var ut=rt[Symbol.toPrimitive];if(ut!==void 0){var mt=ut.call(rt,_||"default");if(typeof mt!="object")return mt;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(rt)}function _toPropertyKey(rt){var _=_toPrimitive(rt,"string");return typeof _=="symbol"?_:String(_)}function _defineProperty$4(rt,_,ut){return _=_toPropertyKey(_),_ in rt?Object.defineProperty(rt,_,{value:ut,enumerable:!0,configurable:!0,writable:!0}):rt[_]=ut,rt}function ownKeys$3(rt,_){var ut=Object.keys(rt);if(Object.getOwnPropertySymbols){var mt=Object.getOwnPropertySymbols(rt);_&&(mt=mt.filter(function(bt){return Object.getOwnPropertyDescriptor(rt,bt).enumerable})),ut.push.apply(ut,mt)}return ut}function _objectSpread2$1(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_]!=null?arguments[_]:{};_%2?ownKeys$3(Object(ut),!0).forEach(function(mt){_defineProperty$4(rt,mt,ut[mt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(rt,Object.getOwnPropertyDescriptors(ut)):ownKeys$3(Object(ut)).forEach(function(mt){Object.defineProperty(rt,mt,Object.getOwnPropertyDescriptor(ut,mt))})}return rt}const EVENT_TYPE_MAP={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function capitalize(rt){return rt?rt[0].toUpperCase()+rt.slice(1):""}const actionsWithoutCaptureSupported=["enter","leave"];function hasCapture(rt=!1,_){return rt&&!actionsWithoutCaptureSupported.includes(_)}function toHandlerProp(rt,_="",ut=!1){const mt=EVENT_TYPE_MAP[rt],bt=mt&&mt[_]||_;return"on"+capitalize(rt)+capitalize(bt)+(hasCapture(ut,bt)?"Capture":"")}const pointerCaptureEvents=["gotpointercapture","lostpointercapture"];function parseProp(rt){let _=rt.substring(2).toLowerCase();const ut=!!~_.indexOf("passive");ut&&(_=_.replace("passive",""));const mt=pointerCaptureEvents.includes(_)?"capturecapture":"capture",bt=!!~_.indexOf(mt);return bt&&(_=_.replace("capture","")),{device:_,capture:bt,passive:ut}}function toDomEventType(rt,_=""){const ut=EVENT_TYPE_MAP[rt],mt=ut&&ut[_]||_;return rt+mt}function isTouch(rt){return"touches"in rt}function getPointerType(rt){return isTouch(rt)?"touch":"pointerType"in rt?rt.pointerType:"mouse"}function getCurrentTargetTouchList(rt){return Array.from(rt.touches).filter(_=>{var ut,mt;return _.target===rt.currentTarget||((ut=rt.currentTarget)===null||ut===void 0||(mt=ut.contains)===null||mt===void 0?void 0:mt.call(ut,_.target))})}function getTouchList(rt){return rt.type==="touchend"||rt.type==="touchcancel"?rt.changedTouches:rt.targetTouches}function getValueEvent(rt){return isTouch(rt)?getTouchList(rt)[0]:rt}function touchIds(rt){return getCurrentTargetTouchList(rt).map(_=>_.identifier)}function pointerId(rt){const _=getValueEvent(rt);return isTouch(rt)?_.identifier:_.pointerId}function pointerValues(rt){const _=getValueEvent(rt);return[_.clientX,_.clientY]}function getEventDetails(rt){const _={};if("buttons"in rt&&(_.buttons=rt.buttons),"shiftKey"in rt){const{shiftKey:ut,altKey:mt,metaKey:bt,ctrlKey:St}=rt;Object.assign(_,{shiftKey:ut,altKey:mt,metaKey:bt,ctrlKey:St})}return _}function call$1(rt,..._){return typeof rt=="function"?rt(..._):rt}function noop$4(){}function chain(...rt){return rt.length===0?noop$4:rt.length===1?rt[0]:function(){let _;for(const ut of rt)_=ut.apply(this,arguments)||_;return _}}function assignDefault(rt,_){return Object.assign({},_,rt||{})}const BEFORE_LAST_KINEMATICS_DELAY=32;class Engine{constructor(_,ut,mt){this.ctrl=_,this.args=ut,this.key=mt,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(_){this.ctrl.state[this.key]=_}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:_,shared:ut,ingKey:mt,args:bt}=this;ut[mt]=_._active=_.active=_._blocked=_._force=!1,_._step=[!1,!1],_.intentional=!1,_._movement=[0,0],_._distance=[0,0],_._direction=[0,0],_._delta=[0,0],_._bounds=[[-1/0,1/0],[-1/0,1/0]],_.args=bt,_.axis=void 0,_.memo=void 0,_.elapsedTime=_.timeDelta=0,_.direction=[0,0],_.distance=[0,0],_.overflow=[0,0],_._movementBound=[!1,!1],_.velocity=[0,0],_.movement=[0,0],_.delta=[0,0],_.timeStamp=0}start(_){const ut=this.state,mt=this.config;ut._active||(this.reset(),this.computeInitial(),ut._active=!0,ut.target=_.target,ut.currentTarget=_.currentTarget,ut.lastOffset=mt.from?call$1(mt.from,ut):ut.offset,ut.offset=ut.lastOffset,ut.startTime=ut.timeStamp=_.timeStamp)}computeValues(_){const ut=this.state;ut._values=_,ut.values=this.config.transform(_)}computeInitial(){const _=this.state;_._initial=_._values,_.initial=_.values}compute(_){const{state:ut,config:mt,shared:bt}=this;ut.args=this.args;let St=0;if(_&&(ut.event=_,mt.preventDefault&&_.cancelable&&ut.event.preventDefault(),ut.type=_.type,bt.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,bt.locked=!!document.pointerLockElement,Object.assign(bt,getEventDetails(_)),bt.down=bt.pressed=bt.buttons%2===1||bt.touches>0,St=_.timeStamp-ut.timeStamp,ut.timeStamp=_.timeStamp,ut.elapsedTime=ut.timeStamp-ut.startTime),ut._active){const Mn=ut._delta.map(Math.abs);V$2.addTo(ut._distance,Mn)}this.axisIntent&&this.axisIntent(_);const[Mt,Bt]=ut._movement,[Ut,Ht]=mt.threshold,{_step:tr,values:rr}=ut;if(mt.hasCustomTransform?(tr[0]===!1&&(tr[0]=Math.abs(Mt)>=Ut&&rr[0]),tr[1]===!1&&(tr[1]=Math.abs(Bt)>=Ht&&rr[1])):(tr[0]===!1&&(tr[0]=Math.abs(Mt)>=Ut&&Math.sign(Mt)*Ut),tr[1]===!1&&(tr[1]=Math.abs(Bt)>=Ht&&Math.sign(Bt)*Ht)),ut.intentional=tr[0]!==!1||tr[1]!==!1,!ut.intentional)return;const sr=[0,0];if(mt.hasCustomTransform){const[Mn,$n]=rr;sr[0]=tr[0]!==!1?Mn-tr[0]:0,sr[1]=tr[1]!==!1?$n-tr[1]:0}else sr[0]=tr[0]!==!1?Mt-tr[0]:0,sr[1]=tr[1]!==!1?Bt-tr[1]:0;this.restrictToAxis&&!ut._blocked&&this.restrictToAxis(sr);const ar=ut.offset,cr=ut._active&&!ut._blocked||ut.active;cr&&(ut.first=ut._active&&!ut.active,ut.last=!ut._active&&ut.active,ut.active=bt[this.ingKey]=ut._active,_&&(ut.first&&("bounds"in mt&&(ut._bounds=call$1(mt.bounds,ut)),this.setup&&this.setup()),ut.movement=sr,this.computeOffset()));const[Ar,_r]=ut.offset,[[Dr,$r],[Br,Jr]]=ut._bounds;ut.overflow=[Ar<Dr?-1:Ar>$r?1:0,_r<Br?-1:_r>Jr?1:0],ut._movementBound[0]=ut.overflow[0]?ut._movementBound[0]===!1?ut._movement[0]:ut._movementBound[0]:!1,ut._movementBound[1]=ut.overflow[1]?ut._movementBound[1]===!1?ut._movement[1]:ut._movementBound[1]:!1;const mn=ut._active?mt.rubberband||[0,0]:[0,0];if(ut.offset=computeRubberband(ut._bounds,ut.offset,mn),ut.delta=V$2.sub(ut.offset,ar),this.computeMovement(),cr&&(!ut.last||St>BEFORE_LAST_KINEMATICS_DELAY)){ut.delta=V$2.sub(ut.offset,ar);const Mn=ut.delta.map(Math.abs);V$2.addTo(ut.distance,Mn),ut.direction=ut.delta.map(Math.sign),ut._direction=ut._delta.map(Math.sign),!ut.first&&St>0&&(ut.velocity=[Mn[0]/St,Mn[1]/St],ut.timeDelta=St)}}emit(){const _=this.state,ut=this.shared,mt=this.config;if(_._active||this.clean(),(_._blocked||!_.intentional)&&!_._force&&!mt.triggerAllEvents)return;const bt=this.handler(_objectSpread2$1(_objectSpread2$1(_objectSpread2$1({},ut),_),{},{[this.aliasKey]:_.values}));bt!==void 0&&(_.memo=bt)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function selectAxis([rt,_],ut){const mt=Math.abs(rt),bt=Math.abs(_);if(mt>bt&&mt>ut)return"x";if(bt>mt&&bt>ut)return"y"}class CoordinatesEngine extends Engine{constructor(..._){super(..._),_defineProperty$4(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=V$2.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=V$2.sub(this.state.offset,this.state.lastOffset)}axisIntent(_){const ut=this.state,mt=this.config;if(!ut.axis&&_){const bt=typeof mt.axisThreshold=="object"?mt.axisThreshold[getPointerType(_)]:mt.axisThreshold;ut.axis=selectAxis(ut._movement,bt)}ut._blocked=(mt.lockDirection||!!mt.axis)&&!ut.axis||!!mt.axis&&mt.axis!==ut.axis}restrictToAxis(_){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":_[1]=0;break;case"y":_[0]=0;break}}}const identity=rt=>rt,DEFAULT_RUBBERBAND=.15,commonConfigResolver={enabled(rt=!0){return rt},eventOptions(rt,_,ut){return _objectSpread2$1(_objectSpread2$1({},ut.shared.eventOptions),rt)},preventDefault(rt=!1){return rt},triggerAllEvents(rt=!1){return rt},rubberband(rt=0){switch(rt){case!0:return[DEFAULT_RUBBERBAND,DEFAULT_RUBBERBAND];case!1:return[0,0];default:return V$2.toVector(rt)}},from(rt){if(typeof rt=="function")return rt;if(rt!=null)return V$2.toVector(rt)},transform(rt,_,ut){const mt=rt||ut.shared.transform;return this.hasCustomTransform=!!mt,mt||identity},threshold(rt){return V$2.toVector(rt,0)}},DEFAULT_AXIS_THRESHOLD=0,coordinatesConfigResolver=_objectSpread2$1(_objectSpread2$1({},commonConfigResolver),{},{axis(rt,_,{axis:ut}){if(this.lockDirection=ut==="lock",!this.lockDirection)return ut},axisThreshold(rt=DEFAULT_AXIS_THRESHOLD){return rt},bounds(rt={}){if(typeof rt=="function")return St=>coordinatesConfigResolver.bounds(rt(St));if("current"in rt)return()=>rt.current;if(typeof HTMLElement=="function"&&rt instanceof HTMLElement)return rt;const{left:_=-1/0,right:ut=1/0,top:mt=-1/0,bottom:bt=1/0}=rt;return[[_,ut],[mt,bt]]}}),KEYS_DELTA_MAP={ArrowRight:(rt,_=1)=>[rt*_,0],ArrowLeft:(rt,_=1)=>[-1*rt*_,0],ArrowUp:(rt,_=1)=>[0,-1*rt*_],ArrowDown:(rt,_=1)=>[0,rt*_]};class DragEngine extends CoordinatesEngine{constructor(..._){super(..._),_defineProperty$4(this,"ingKey","dragging")}reset(){super.reset();const _=this.state;_._pointerId=void 0,_._pointerActive=!1,_._keyboardActive=!1,_._preventScroll=!1,_._delayed=!1,_.swipe=[0,0],_.tap=!1,_.canceled=!1,_.cancel=this.cancel.bind(this)}setup(){const _=this.state;if(_._bounds instanceof HTMLElement){const ut=_._bounds.getBoundingClientRect(),mt=_.currentTarget.getBoundingClientRect(),bt={left:ut.left-mt.left+_.offset[0],right:ut.right-mt.right+_.offset[0],top:ut.top-mt.top+_.offset[1],bottom:ut.bottom-mt.bottom+_.offset[1]};_._bounds=coordinatesConfigResolver.bounds(bt)}}cancel(){const _=this.state;_.canceled||(_.canceled=!0,_._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(_){const ut=this.config,mt=this.state;if(_.buttons!=null&&(Array.isArray(ut.pointerButtons)?!ut.pointerButtons.includes(_.buttons):ut.pointerButtons!==-1&&ut.pointerButtons!==_.buttons))return;const bt=this.ctrl.setEventIds(_);ut.pointerCapture&&_.target.setPointerCapture(_.pointerId),!(bt&&bt.size>1&&mt._pointerActive)&&(this.start(_),this.setupPointer(_),mt._pointerId=pointerId(_),mt._pointerActive=!0,this.computeValues(pointerValues(_)),this.computeInitial(),ut.preventScrollAxis&&getPointerType(_)!=="mouse"?(mt._active=!1,this.setupScrollPrevention(_)):ut.delay>0?(this.setupDelayTrigger(_),ut.triggerAllEvents&&(this.compute(_),this.emit())):this.startPointerDrag(_))}startPointerDrag(_){const ut=this.state;ut._active=!0,ut._preventScroll=!0,ut._delayed=!1,this.compute(_),this.emit()}pointerMove(_){const ut=this.state,mt=this.config;if(!ut._pointerActive)return;const bt=pointerId(_);if(ut._pointerId!==void 0&&bt!==ut._pointerId)return;const St=pointerValues(_);if(document.pointerLockElement===_.target?ut._delta=[_.movementX,_.movementY]:(ut._delta=V$2.sub(St,ut._values),this.computeValues(St)),V$2.addTo(ut._movement,ut._delta),this.compute(_),ut._delayed&&ut.intentional){this.timeoutStore.remove("dragDelay"),ut.active=!1,this.startPointerDrag(_);return}if(mt.preventScrollAxis&&!ut._preventScroll)if(ut.axis)if(ut.axis===mt.preventScrollAxis||mt.preventScrollAxis==="xy"){ut._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(_);return}else return;this.emit()}pointerUp(_){this.ctrl.setEventIds(_);try{this.config.pointerCapture&&_.target.hasPointerCapture(_.pointerId)&&_.target.releasePointerCapture(_.pointerId)}catch{}const ut=this.state,mt=this.config;if(!ut._active||!ut._pointerActive)return;const bt=pointerId(_);if(ut._pointerId!==void 0&&bt!==ut._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(_);const[St,Mt]=ut._distance;if(ut.tap=St<=mt.tapsThreshold&&Mt<=mt.tapsThreshold,ut.tap&&mt.filterTaps)ut._force=!0;else{const[Bt,Ut]=ut._delta,[Ht,tr]=ut._movement,[rr,sr]=mt.swipe.velocity,[ar,cr]=mt.swipe.distance,Ar=mt.swipe.duration;if(ut.elapsedTime<Ar){const _r=Math.abs(Bt/ut.timeDelta),Dr=Math.abs(Ut/ut.timeDelta);_r>rr&&Math.abs(Ht)>ar&&(ut.swipe[0]=Math.sign(Bt)),Dr>sr&&Math.abs(tr)>cr&&(ut.swipe[1]=Math.sign(Ut))}}this.emit()}pointerClick(_){!this.state.tap&&_.detail>0&&(_.preventDefault(),_.stopPropagation())}setupPointer(_){const ut=this.config,mt=ut.device;ut.pointerLock&&_.currentTarget.requestPointerLock(),ut.pointerCapture||(this.eventStore.add(this.sharedConfig.window,mt,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,mt,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,mt,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(_){this.state._preventScroll&&_.cancelable&&_.preventDefault()}setupScrollPrevention(_){this.state._preventScroll=!1,persistEvent(_);const ut=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",ut),this.eventStore.add(this.sharedConfig.window,"touch","cancel",ut),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,_)}setupDelayTrigger(_){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(_)},this.config.delay)}keyDown(_){const ut=KEYS_DELTA_MAP[_.key];if(ut){const mt=this.state,bt=_.shiftKey?10:_.altKey?.1:1;this.start(_),mt._delta=ut(this.config.keyboardDisplacement,bt),mt._keyboardActive=!0,V$2.addTo(mt._movement,mt._delta),this.compute(_),this.emit()}}keyUp(_){_.key in KEYS_DELTA_MAP&&(this.state._keyboardActive=!1,this.setActive(),this.compute(_),this.emit())}bind(_){const ut=this.config.device;_(ut,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(_(ut,"change",this.pointerMove.bind(this)),_(ut,"end",this.pointerUp.bind(this)),_(ut,"cancel",this.pointerUp.bind(this)),_("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(_("key","down",this.keyDown.bind(this)),_("key","up",this.keyUp.bind(this))),this.config.filterTaps&&_("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function persistEvent(rt){"persist"in rt&&typeof rt.persist=="function"&&rt.persist()}const isBrowser$1=typeof window<"u"&&window.document&&window.document.createElement;function supportsTouchEvents(){return isBrowser$1&&"ontouchstart"in window}function isTouchScreen(){return supportsTouchEvents()||isBrowser$1&&window.navigator.maxTouchPoints>1}function supportsPointerEvents(){return isBrowser$1&&"onpointerdown"in window}function supportsPointerLock(){return isBrowser$1&&"exitPointerLock"in window.document}function supportsGestureEvents(){try{return"constructor"in GestureEvent}catch{return!1}}const SUPPORT={isBrowser:isBrowser$1,gesture:supportsGestureEvents(),touch:supportsTouchEvents(),touchscreen:isTouchScreen(),pointer:supportsPointerEvents(),pointerLock:supportsPointerLock()},DEFAULT_PREVENT_SCROLL_DELAY=250,DEFAULT_DRAG_DELAY=180,DEFAULT_SWIPE_VELOCITY=.5,DEFAULT_SWIPE_DISTANCE=50,DEFAULT_SWIPE_DURATION=250,DEFAULT_KEYBOARD_DISPLACEMENT=10,DEFAULT_DRAG_AXIS_THRESHOLD={mouse:0,touch:0,pen:8},dragConfigResolver=_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{device(rt,_,{pointer:{touch:ut=!1,lock:mt=!1,mouse:bt=!1}={}}){return this.pointerLock=mt&&SUPPORT.pointerLock,SUPPORT.touch&&ut?"touch":this.pointerLock?"mouse":SUPPORT.pointer&&!bt?"pointer":SUPPORT.touch?"touch":"mouse"},preventScrollAxis(rt,_,{preventScroll:ut}){if(this.preventScrollDelay=typeof ut=="number"?ut:ut||ut===void 0&&rt?DEFAULT_PREVENT_SCROLL_DELAY:void 0,!(!SUPPORT.touchscreen||ut===!1))return rt||(ut!==void 0?"y":void 0)},pointerCapture(rt,_,{pointer:{capture:ut=!0,buttons:mt=1,keys:bt=!0}={}}){return this.pointerButtons=mt,this.keys=bt,!this.pointerLock&&this.device==="pointer"&&ut},threshold(rt,_,{filterTaps:ut=!1,tapsThreshold:mt=3,axis:bt=void 0}){const St=V$2.toVector(rt,ut?mt:bt?1:0);return this.filterTaps=ut,this.tapsThreshold=mt,St},swipe({velocity:rt=DEFAULT_SWIPE_VELOCITY,distance:_=DEFAULT_SWIPE_DISTANCE,duration:ut=DEFAULT_SWIPE_DURATION}={}){return{velocity:this.transform(V$2.toVector(rt)),distance:this.transform(V$2.toVector(_)),duration:ut}},delay(rt=0){switch(rt){case!0:return DEFAULT_DRAG_DELAY;case!1:return 0;default:return rt}},axisThreshold(rt){return rt?_objectSpread2$1(_objectSpread2$1({},DEFAULT_DRAG_AXIS_THRESHOLD),rt):DEFAULT_DRAG_AXIS_THRESHOLD},keyboardDisplacement(rt=DEFAULT_KEYBOARD_DISPLACEMENT){return rt}});_objectSpread2$1(_objectSpread2$1({},commonConfigResolver),{},{device(rt,_,{shared:ut,pointer:{touch:mt=!1}={}}){if(ut.target&&!SUPPORT.touch&&SUPPORT.gesture)return"gesture";if(SUPPORT.touch&&mt)return"touch";if(SUPPORT.touchscreen){if(SUPPORT.pointer)return"pointer";if(SUPPORT.touch)return"touch"}},bounds(rt,_,{scaleBounds:ut={},angleBounds:mt={}}){const bt=Mt=>{const Bt=assignDefault(call$1(ut,Mt),{min:-1/0,max:1/0});return[Bt.min,Bt.max]},St=Mt=>{const Bt=assignDefault(call$1(mt,Mt),{min:-1/0,max:1/0});return[Bt.min,Bt.max]};return typeof ut!="function"&&typeof mt!="function"?[bt(),St()]:Mt=>[bt(Mt),St(Mt)]},threshold(rt,_,ut){return this.lockDirection=ut.axis==="lock",V$2.toVector(rt,this.lockDirection?[.1,3]:0)},modifierKey(rt){return rt===void 0?"ctrlKey":rt},pinchOnWheel(rt=!0){return rt}});_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{mouseOnly:(rt=!0)=>rt});_objectSpread2$1(_objectSpread2$1({},coordinatesConfigResolver),{},{mouseOnly:(rt=!0)=>rt});const EngineMap=new Map,ConfigResolverMap=new Map;function registerAction(rt){EngineMap.set(rt.key,rt.engine),ConfigResolverMap.set(rt.key,rt.resolver)}const dragAction={key:"drag",engine:DragEngine,resolver:dragConfigResolver};function _objectWithoutPropertiesLoose$3(rt,_){if(rt==null)return{};var ut={},mt=Object.keys(rt),bt,St;for(St=0;St<mt.length;St++)bt=mt[St],!(_.indexOf(bt)>=0)&&(ut[bt]=rt[bt]);return ut}function _objectWithoutProperties$2(rt,_){if(rt==null)return{};var ut=_objectWithoutPropertiesLoose$3(rt,_),mt,bt;if(Object.getOwnPropertySymbols){var St=Object.getOwnPropertySymbols(rt);for(bt=0;bt<St.length;bt++)mt=St[bt],!(_.indexOf(mt)>=0)&&Object.prototype.propertyIsEnumerable.call(rt,mt)&&(ut[mt]=rt[mt])}return ut}const sharedConfigResolver={target(rt){if(rt)return()=>"current"in rt?rt.current:rt},enabled(rt=!0){return rt},window(rt=SUPPORT.isBrowser?window:void 0){return rt},eventOptions({passive:rt=!0,capture:_=!1}={}){return{passive:rt,capture:_}},transform(rt){return rt}},_excluded$c=["target","eventOptions","window","enabled","transform"];function resolveWith(rt={},_){const ut={};for(const[mt,bt]of Object.entries(_))switch(typeof bt){case"function":ut[mt]=bt.call(ut,rt[mt],mt,rt);break;case"object":ut[mt]=resolveWith(rt[mt],bt);break;case"boolean":bt&&(ut[mt]=rt[mt]);break}return ut}function parse$2(rt,_,ut={}){const mt=rt,{target:bt,eventOptions:St,window:Mt,enabled:Bt,transform:Ut}=mt,Ht=_objectWithoutProperties$2(mt,_excluded$c);if(ut.shared=resolveWith({target:bt,eventOptions:St,window:Mt,enabled:Bt,transform:Ut},sharedConfigResolver),_){const tr=ConfigResolverMap.get(_);ut[_]=resolveWith(_objectSpread2$1({shared:ut.shared},Ht),tr)}else for(const tr in Ht){const rr=ConfigResolverMap.get(tr);rr&&(ut[tr]=resolveWith(_objectSpread2$1({shared:ut.shared},Ht[tr]),rr))}return ut}class EventStore{constructor(_,ut){_defineProperty$4(this,"_listeners",new Set),this._ctrl=_,this._gestureKey=ut}add(_,ut,mt,bt,St){const Mt=this._listeners,Bt=toDomEventType(ut,mt),Ut=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},Ht=_objectSpread2$1(_objectSpread2$1({},Ut),St);_.addEventListener(Bt,bt,Ht);const tr=()=>{_.removeEventListener(Bt,bt,Ht),Mt.delete(tr)};return Mt.add(tr),tr}clean(){this._listeners.forEach(_=>_()),this._listeners.clear()}}class TimeoutStore{constructor(){_defineProperty$4(this,"_timeouts",new Map)}add(_,ut,mt=140,...bt){this.remove(_),this._timeouts.set(_,window.setTimeout(ut,mt,...bt))}remove(_){const ut=this._timeouts.get(_);ut&&window.clearTimeout(ut)}clean(){this._timeouts.forEach(_=>void window.clearTimeout(_)),this._timeouts.clear()}}let Controller$1=class{constructor(_){_defineProperty$4(this,"gestures",new Set),_defineProperty$4(this,"_targetEventStore",new EventStore(this)),_defineProperty$4(this,"gestureEventStores",{}),_defineProperty$4(this,"gestureTimeoutStores",{}),_defineProperty$4(this,"handlers",{}),_defineProperty$4(this,"config",{}),_defineProperty$4(this,"pointerIds",new Set),_defineProperty$4(this,"touchIds",new Set),_defineProperty$4(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),resolveGestures(this,_)}setEventIds(_){if(isTouch(_))return this.touchIds=new Set(touchIds(_)),this.touchIds;if("pointerId"in _)return _.type==="pointerup"||_.type==="pointercancel"?this.pointerIds.delete(_.pointerId):_.type==="pointerdown"&&this.pointerIds.add(_.pointerId),this.pointerIds}applyHandlers(_,ut){this.handlers=_,this.nativeHandlers=ut}applyConfig(_,ut){this.config=parse$2(_,ut,this.config)}clean(){this._targetEventStore.clean();for(const _ of this.gestures)this.gestureEventStores[_].clean(),this.gestureTimeoutStores[_].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(..._){const ut=this.config.shared,mt={};let bt;if(!(ut.target&&(bt=ut.target(),!bt))){if(ut.enabled){for(const Mt of this.gestures){const Bt=this.config[Mt],Ut=bindToProps(mt,Bt.eventOptions,!!bt);if(Bt.enabled){const Ht=EngineMap.get(Mt);new Ht(this,_,Mt).bind(Ut)}}const St=bindToProps(mt,ut.eventOptions,!!bt);for(const Mt in this.nativeHandlers)St(Mt,"",Bt=>this.nativeHandlers[Mt](_objectSpread2$1(_objectSpread2$1({},this.state.shared),{},{event:Bt,args:_})),void 0,!0)}for(const St in mt)mt[St]=chain(...mt[St]);if(!bt)return mt;for(const St in mt){const{device:Mt,capture:Bt,passive:Ut}=parseProp(St);this._targetEventStore.add(bt,Mt,"",mt[St],{capture:Bt,passive:Ut})}}}};function setupGesture(rt,_){rt.gestures.add(_),rt.gestureEventStores[_]=new EventStore(rt,_),rt.gestureTimeoutStores[_]=new TimeoutStore}function resolveGestures(rt,_){_.drag&&setupGesture(rt,"drag"),_.wheel&&setupGesture(rt,"wheel"),_.scroll&&setupGesture(rt,"scroll"),_.move&&setupGesture(rt,"move"),_.pinch&&setupGesture(rt,"pinch"),_.hover&&setupGesture(rt,"hover")}const bindToProps=(rt,_,ut)=>(mt,bt,St,Mt={},Bt=!1)=>{var Ut,Ht;const tr=(Ut=Mt.capture)!==null&&Ut!==void 0?Ut:_.capture,rr=(Ht=Mt.passive)!==null&&Ht!==void 0?Ht:_.passive;let sr=Bt?mt:toHandlerProp(mt,bt,tr);ut&&rr&&(sr+="Passive"),rt[sr]=rt[sr]||[],rt[sr].push(St)};function useRecognizers(rt,_={},ut,mt){const bt=React.useMemo(()=>new Controller$1(rt),[]);if(bt.applyHandlers(rt,mt),bt.applyConfig(_,ut),React.useEffect(bt.effect.bind(bt)),React.useEffect(()=>bt.clean.bind(bt),[]),_.target===void 0)return bt.bind.bind(bt)}function useDrag$1(rt,_){return registerAction(dragAction),useRecognizers({drag:rt},_||{},"drag")}function _defineProperty$3(rt,_,ut){return _ in rt?Object.defineProperty(rt,_,{value:ut,enumerable:!0,configurable:!0,writable:!0}):rt[_]=ut,rt}function _arrayLikeToArray$2(rt,_){(_==null||_>rt.length)&&(_=rt.length);for(var ut=0,mt=new Array(_);ut<_;ut++)mt[ut]=rt[ut];return mt}function _unsupportedIterableToArray$2(rt,_){if(rt){if(typeof rt=="string")return _arrayLikeToArray$2(rt,_);var ut=Object.prototype.toString.call(rt).slice(8,-1);if(ut==="Object"&&rt.constructor&&(ut=rt.constructor.name),ut==="Map"||ut==="Set")return Array.from(rt);if(ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ut))return _arrayLikeToArray$2(rt,_)}}function _arrayWithoutHoles$1(rt){if(Array.isArray(rt))return _arrayLikeToArray$2(rt)}function _iterableToArray$1(rt){if(typeof Symbol<"u"&&rt[Symbol.iterator]!=null||rt["@@iterator"]!=null)return Array.from(rt)}function _nonIterableSpread$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toConsumableArray$1(rt){return _arrayWithoutHoles$1(rt)||_iterableToArray$1(rt)||_unsupportedIterableToArray$2(rt)||_nonIterableSpread$1()}new Vector2;new Vector2;function clamp$5(rt,_,ut){return Math.max(_,Math.min(ut,rt))}function repeat(rt,_){return clamp$5(rt-Math.floor(rt/_)*_,0,_)}function deltaAngle(rt,_){var ut=repeat(_-rt,Math.PI*2);return ut>Math.PI&&(ut-=Math.PI*2),ut}function _classCallCheck(rt,_){if(!(rt instanceof _))throw new TypeError("Cannot call a class as a function")}var Grad=function rt(_,ut,mt){var bt=this;_classCallCheck(this,rt),_defineProperty$3(this,"dot2",function(St,Mt){return bt.x*St+bt.y*Mt}),_defineProperty$3(this,"dot3",function(St,Mt,Bt){return bt.x*St+bt.y*Mt+bt.z*Bt}),this.x=_,this.y=ut,this.z=mt},grad3=[new Grad(1,1,0),new Grad(-1,1,0),new Grad(1,-1,0),new Grad(-1,-1,0),new Grad(1,0,1),new Grad(-1,0,1),new Grad(1,0,-1),new Grad(-1,0,-1),new Grad(0,1,1),new Grad(0,-1,1),new Grad(0,1,-1),new Grad(0,-1,-1)],p$3=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],perm=new Array(512),gradP=new Array(512),seed$1=function rt(_){_>0&&_<1&&(_*=65536),_=Math.floor(_),_<256&&(_|=_<<8);for(var ut=0;ut<256;ut++){var mt;ut&1?mt=p$3[ut]^_&255:mt=p$3[ut]^_>>8&255,perm[ut]=perm[ut+256]=mt,gradP[ut]=gradP[ut+256]=grad3[mt%12]}};seed$1(0);function normalizeSeed(rt){if(typeof rt=="number")rt=Math.abs(rt);else if(typeof rt=="string"){var _=rt;rt=0;for(var ut=0;ut<_.length;ut++)rt=(rt+(ut+1)*(_.charCodeAt(ut)%96))%2147483647}return rt===0&&(rt=311),rt}function lcgRandom(rt){var _=normalizeSeed(rt);return function(){var ut=_*48271%2147483647;return _=ut,ut/2147483647}}var Generator=function rt(_){var ut=this;_classCallCheck(this,rt),_defineProperty$3(this,"seed",0),_defineProperty$3(this,"init",function(mt){ut.seed=mt,ut.value=lcgRandom(mt)}),_defineProperty$3(this,"value",lcgRandom(this.seed)),this.init(_)};new Generator(Math.random());var rsqw=function rt(_){var ut=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.01,mt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,bt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/(2*Math.PI);return mt/Math.atan(1/ut)*Math.atan(Math.sin(2*Math.PI*_*bt)/ut)},exp$1=function rt(_){return 1/(1+_+.48*_*_+.235*_*_*_)},linear=function rt(_){return _},sine={in:function rt(_){return 1-Math.cos(_*Math.PI/2)},out:function rt(_){return Math.sin(_*Math.PI/2)},inOut:function rt(_){return-(Math.cos(Math.PI*_)-1)/2}},cubic={in:function rt(_){return _*_*_},out:function rt(_){return 1-Math.pow(1-_,3)},inOut:function rt(_){return _<.5?4*_*_*_:1-Math.pow(-2*_+2,3)/2}},quint={in:function rt(_){return _*_*_*_*_},out:function rt(_){return 1-Math.pow(1-_,5)},inOut:function rt(_){return _<.5?16*_*_*_*_*_:1-Math.pow(-2*_+2,5)/2}},circ={in:function rt(_){return 1-Math.sqrt(1-Math.pow(_,2))},out:function rt(_){return Math.sqrt(1-Math.pow(_-1,2))},inOut:function rt(_){return _<.5?(1-Math.sqrt(1-Math.pow(2*_,2)))/2:(Math.sqrt(1-Math.pow(-2*_+2,2))+1)/2}},quart={in:function rt(_){return _*_*_*_},out:function rt(_){return 1- --_*_*_*_},inOut:function rt(_){return _<.5?8*_*_*_*_:1-8*--_*_*_*_}},expo={in:function rt(_){return _===0?0:Math.pow(2,10*_-10)},out:function rt(_){return _===1?1:1-Math.pow(2,-10*_)},inOut:function rt(_){return _===0?0:_===1?1:_<.5?Math.pow(2,20*_-10)/2:(2-Math.pow(2,-20*_+10))/2}};function damp(rt,_,ut){var mt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.25,bt=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.01,St=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,Mt=arguments.length>6&&arguments[6]!==void 0?arguments[6]:exp$1,Bt=arguments.length>7&&arguments[7]!==void 0?arguments[7]:.001,Ut="velocity_"+_;if(rt.__damp===void 0&&(rt.__damp={}),rt.__damp[Ut]===void 0&&(rt.__damp[Ut]=0),Math.abs(rt[_]-ut)<=Bt)return rt[_]=ut,!1;mt=Math.max(1e-4,mt);var Ht=2/mt,tr=Mt(Ht*bt),rr=rt[_]-ut,sr=ut,ar=St*mt;rr=Math.min(Math.max(rr,-ar),ar),ut=rt[_]-rr;var cr=(rt.__damp[Ut]+Ht*rr)*bt;rt.__damp[Ut]=(rt.__damp[Ut]-Ht*cr)*tr;var Ar=ut+(rr+cr)*tr;return sr-rt[_]>0==Ar>sr&&(Ar=sr,rt.__damp[Ut]=(Ar-sr)/bt),rt[_]=Ar,!0}var isCamera=function rt(_){return _&&_.isCamera},isLight=function rt(_){return _&&_.isLight},vl3d=new Vector3,_q1=new Quaternion,_q2=new Quaternion,_m1=new Matrix4,_position=new Vector3;function dampLookAt(rt,_,ut,mt,bt,St,Mt){typeof _=="number"?vl3d.setScalar(_):Array.isArray(_)?vl3d.set(_[0],_[1],_[2]):vl3d.copy(_);var Bt=rt.parent;rt.updateWorldMatrix(!0,!1),_position.setFromMatrixPosition(rt.matrixWorld),isCamera(rt)||isLight(rt)?_m1.lookAt(_position,vl3d,rt.up):_m1.lookAt(vl3d,_position,rt.up),dampQ(rt.quaternion,_q2.setFromRotationMatrix(_m1),ut,mt,bt,St,Mt),Bt&&(_m1.extractRotation(Bt.matrixWorld),_q1.setFromRotationMatrix(_m1),dampQ(rt.quaternion,_q2.copy(rt.quaternion).premultiply(_q1.invert()),ut,mt,bt,St,Mt))}function dampAngle(rt,_,ut,mt,bt,St,Mt,Bt){return damp(rt,_,rt[_]+deltaAngle(rt[_],ut),mt,bt,St,Mt,Bt)}var v2d=new Vector2,a2,b2;function damp2(rt,_,ut,mt,bt,St,Mt){return typeof _=="number"?v2d.setScalar(_):Array.isArray(_)?v2d.set(_[0],_[1]):v2d.copy(_),a2=damp(rt,"x",v2d.x,ut,mt,bt,St,Mt),b2=damp(rt,"y",v2d.y,ut,mt,bt,St,Mt),a2||b2}var v3d=new Vector3,a3,b3,c3$1;function damp3(rt,_,ut,mt,bt,St,Mt){return typeof _=="number"?v3d.setScalar(_):Array.isArray(_)?v3d.set(_[0],_[1],_[2]):v3d.copy(_),a3=damp(rt,"x",v3d.x,ut,mt,bt,St,Mt),b3=damp(rt,"y",v3d.y,ut,mt,bt,St,Mt),c3$1=damp(rt,"z",v3d.z,ut,mt,bt,St,Mt),a3||b3||c3$1}var v4d=new Vector4,a4,b4,c4$1,d4;function damp4(rt,_,ut,mt,bt,St,Mt){return typeof _=="number"?v4d.setScalar(_):Array.isArray(_)?v4d.set(_[0],_[1],_[2],_[3]):v4d.copy(_),a4=damp(rt,"x",v4d.x,ut,mt,bt,St,Mt),b4=damp(rt,"y",v4d.y,ut,mt,bt,St,Mt),c4$1=damp(rt,"z",v4d.z,ut,mt,bt,St,Mt),d4=damp(rt,"w",v4d.w,ut,mt,bt,St,Mt),a4||b4||c4$1||d4}var rot=new Euler,aE,bE,cE;function dampE(rt,_,ut,mt,bt,St,Mt){return Array.isArray(_)?rot.set(_[0],_[1],_[2],_[3]):rot.copy(_),aE=dampAngle(rt,"x",rot.x,ut,mt,bt,St,Mt),bE=dampAngle(rt,"y",rot.y,ut,mt,bt,St,Mt),cE=dampAngle(rt,"z",rot.z,ut,mt,bt,St,Mt),aE||bE||cE}var col=new Color$1,aC$1,bC,cC$1;function dampC(rt,_,ut,mt,bt,St,Mt){return _ instanceof Color$1?col.copy(_):Array.isArray(_)?col.setRGB(_[0],_[1],_[2]):col.set(_),aC$1=damp(rt,"r",col.r,ut,mt,bt,St,Mt),bC=damp(rt,"g",col.g,ut,mt,bt,St,Mt),cC$1=damp(rt,"b",col.b,ut,mt,bt,St,Mt),aC$1||bC||cC$1}var qt$1=new Quaternion,v4result=new Vector4,v4velocity=new Vector4,v4error=new Vector4,aQ,bQ,cQ,dQ;function dampQ(rt,_,ut,mt,bt,St,Mt){var Bt=rt;Array.isArray(_)?qt$1.set(_[0],_[1],_[2],_[3]):qt$1.copy(_);var Ut=rt.dot(qt$1)>0?1:-1;return qt$1.x*=Ut,qt$1.y*=Ut,qt$1.z*=Ut,qt$1.w*=Ut,aQ=damp(rt,"x",qt$1.x,ut,mt,bt,St,Mt),bQ=damp(rt,"y",qt$1.y,ut,mt,bt,St,Mt),cQ=damp(rt,"z",qt$1.z,ut,mt,bt,St,Mt),dQ=damp(rt,"w",qt$1.w,ut,mt,bt,St,Mt),v4result.set(rt.x,rt.y,rt.z,rt.w).normalize(),v4velocity.set(Bt.__damp.velocity_x,Bt.__damp.velocity_y,Bt.__damp.velocity_z,Bt.__damp.velocity_w),v4error.copy(v4result).multiplyScalar(v4velocity.dot(v4result)/v4result.dot(v4result)),Bt.__damp.velocity_x-=v4error.x,Bt.__damp.velocity_y-=v4error.y,Bt.__damp.velocity_z-=v4error.z,Bt.__damp.velocity_w-=v4error.w,rt.set(v4result.x,v4result.y,v4result.z,v4result.w),aQ||bQ||cQ||dQ}var spherical=new Spherical,aS$1,bS$1,cS$1;function dampS(rt,_,ut,mt,bt,St,Mt){return Array.isArray(_)?spherical.set(_[0],_[1],_[2]):spherical.copy(_),aS$1=damp(rt,"radius",spherical.radius,ut,mt,bt,St,Mt),bS$1=dampAngle(rt,"phi",spherical.phi,ut,mt,bt,St,Mt),cS$1=dampAngle(rt,"theta",spherical.theta,ut,mt,bt,St,Mt),aS$1||bS$1||cS$1}var mat=new Matrix4,mPos=new Vector3,mRot=new Quaternion,mSca=new Vector3,aM,bM,cM$1;function dampM(rt,_,ut,mt,bt,St,Mt){var Bt=rt;return Bt.__damp===void 0&&(Bt.__damp={position:new Vector3,rotation:new Quaternion,scale:new Vector3},rt.decompose(Bt.__damp.position,Bt.__damp.rotation,Bt.__damp.scale)),Array.isArray(_)?mat.set.apply(mat,_toConsumableArray$1(_)):mat.copy(_),mat.decompose(mPos,mRot,mSca),aM=damp3(Bt.__damp.position,mPos,ut,mt,bt,St,Mt),bM=dampQ(Bt.__damp.rotation,mRot,ut,mt,bt,St,Mt),cM$1=damp3(Bt.__damp.scale,mSca,ut,mt,bt,St,Mt),rt.compose(Bt.__damp.position,Bt.__damp.rotation,Bt.__damp.scale),aM||bM||cM$1}var easing=Object.freeze({__proto__:null,rsqw,exp:exp$1,linear,sine,cubic,quint,circ,quart,expo,damp,dampLookAt,dampAngle,damp2,damp3,damp4,dampE,dampC,dampQ,dampS,dampM});const context=reactExports.createContext(null);function useScroll(){return reactExports.useContext(context)}function ScrollControls({eps:rt=1e-5,enabled:_=!0,infinite:ut,horizontal:mt,pages:bt=1,distance:St=1,damping:Mt=.25,maxSpeed:Bt=1/0,style:Ut={},children:Ht}){const{get:tr,setEvents:rr,gl:sr,size:ar,invalidate:cr,events:Ar}=useThree(),[_r]=reactExports.useState(()=>document.createElement("div")),[Dr]=reactExports.useState(()=>document.createElement("div")),[$r]=reactExports.useState(()=>document.createElement("div")),Br=sr.domElement.parentNode,Jr=reactExports.useRef(0),mn=reactExports.useMemo(()=>({el:_r,eps:rt,fill:Dr,fixed:$r,horizontal:mt,damping:Mt,offset:0,delta:0,scroll:Jr,pages:bt,range(en,In,Rn=0){const qn=en-Rn,Qn=qn+In+Rn*2;return this.offset<qn?0:this.offset>Qn?1:(this.offset-qn)/(Qn-qn)},curve(en,In,Rn=0){return Math.sin(this.range(en,In,Rn)*Math.PI)},visible(en,In,Rn=0){const qn=en-Rn,Qn=qn+In+Rn*2;return this.offset>=qn&&this.offset<=Qn}}),[rt,Mt,mt,bt]);reactExports.useEffect(()=>{_r.style.position="absolute",_r.style.width="100%",_r.style.height="100%",_r.style[mt?"overflowX":"overflowY"]="auto",_r.style[mt?"overflowY":"overflowX"]="hidden",_r.style.top="0px",_r.style.left="0px";for(const In in Ut)_r.style[In]=Ut[In];$r.style.position="sticky",$r.style.top="0px",$r.style.left="0px",$r.style.width="100%",$r.style.height="100%",$r.style.overflow="hidden",_r.appendChild($r),Dr.style.height=mt?"100%":`${bt*St*100}%`,Dr.style.width=mt?`${bt*St*100}%`:"100%",Dr.style.pointerEvents="none",_r.appendChild(Dr),Br.appendChild(_r),_r[mt?"scrollLeft":"scrollTop"]=1;const $n=Ar.connected||sr.domElement;requestAnimationFrame(()=>Ar.connect==null?void 0:Ar.connect(_r));const en=tr().events.compute;return rr({compute(In,Rn){const{left:qn,top:Qn}=Br.getBoundingClientRect(),xs=In.clientX-qn,cs=In.clientY-Qn;Rn.pointer.set(xs/Rn.size.width*2-1,-(cs/Rn.size.height)*2+1),Rn.raycaster.setFromCamera(Rn.pointer,Rn.camera)}}),()=>{Br.removeChild(_r),rr({compute:en}),Ar.connect==null||Ar.connect($n)}},[bt,St,mt,_r,Dr,$r,Br]),reactExports.useEffect(()=>{if(Ar.connected===_r){const $n=ar[mt?"width":"height"],en=_r[mt?"scrollWidth":"scrollHeight"],In=en-$n;let Rn=0,qn=!0,Qn=!0;const xs=()=>{if(!(!_||Qn)&&(cr(),Rn=_r[mt?"scrollLeft":"scrollTop"],Jr.current=Rn/In,ut)){if(!qn){if(Rn>=In){const ks=1-mn.offset;_r[mt?"scrollLeft":"scrollTop"]=1,Jr.current=mn.offset=-ks,qn=!0}else if(Rn<=0){const ks=1+mn.offset;_r[mt?"scrollLeft":"scrollTop"]=en,Jr.current=mn.offset=ks,qn=!0}}qn&&setTimeout(()=>qn=!1,40)}};_r.addEventListener("scroll",xs,{passive:!0}),requestAnimationFrame(()=>Qn=!1);const cs=ks=>_r.scrollLeft+=ks.deltaY/2;return mt&&_r.addEventListener("wheel",cs,{passive:!0}),()=>{_r.removeEventListener("scroll",xs),mt&&_r.removeEventListener("wheel",cs)}}},[_r,Ar,ar,ut,mn,cr,mt,_]);let Mn=0;return useFrame(($n,en)=>{Mn=mn.offset,easing.damp(mn,"offset",Jr.current,Mt,en,Bt,void 0,rt),easing.damp(mn,"delta",Math.abs(Mn-mn.offset),Mt,en,Bt,void 0,rt),mn.delta>rt&&cr()}),reactExports.createElement(context.Provider,{value:mn},Ht)}const ScrollCanvas=reactExports.forwardRef(({children:rt},_)=>{const ut=reactExports.useRef(null);reactExports.useImperativeHandle(_,()=>ut.current,[]);const mt=useScroll(),{width:bt,height:St}=useThree(Mt=>Mt.viewport);return useFrame(()=>{ut.current.position.x=mt.horizontal?-bt*(mt.pages-1)*mt.offset:0,ut.current.position.y=mt.horizontal?0:St*(mt.pages-1)*mt.offset}),reactExports.createElement("group",{ref:ut},rt)}),ScrollHtml=reactExports.forwardRef(({children:rt,style:_,...ut},mt)=>{const bt=useScroll(),St=reactExports.useRef(null);reactExports.useImperativeHandle(mt,()=>St.current,[]);const{width:Mt,height:Bt}=useThree(tr=>tr.size),Ut=reactExports.useContext(context$1),Ht=reactExports.useMemo(()=>createRoot$1(bt.fixed),[bt.fixed]);return useFrame(()=>{bt.delta>bt.eps&&(St.current.style.transform=`translate3d(${bt.horizontal?-Mt*(bt.pages-1)*bt.offset:0}px,${bt.horizontal?0:Bt*(bt.pages-1)*-bt.offset}px,0)`)}),Ht.render(reactExports.createElement("div",_extends$4({ref:St,style:{..._,position:"absolute",top:0,left:0,willChange:"transform"}},ut),reactExports.createElement(context.Provider,{value:bt},reactExports.createElement(context$1.Provider,{value:Ut},rt)))),null}),Scroll=reactExports.forwardRef(({html:rt,..._},ut)=>{const mt=rt?ScrollHtml:ScrollCanvas;return reactExports.createElement(mt,_extends$4({ref:ut},_))});let updateQueue=makeQueue();const raf=rt=>schedule(rt,updateQueue);let writeQueue=makeQueue();raf.write=rt=>schedule(rt,writeQueue);let onStartQueue=makeQueue();raf.onStart=rt=>schedule(rt,onStartQueue);let onFrameQueue=makeQueue();raf.onFrame=rt=>schedule(rt,onFrameQueue);let onFinishQueue=makeQueue();raf.onFinish=rt=>schedule(rt,onFinishQueue);let timeouts=[];raf.setTimeout=(rt,_)=>{let ut=raf.now()+_,mt=()=>{let St=timeouts.findIndex(Mt=>Mt.cancel==mt);~St&&timeouts.splice(St,1),pendingCount-=~St?1:0},bt={time:ut,handler:rt,cancel:mt};return timeouts.splice(findTimeout(ut),0,bt),pendingCount+=1,start(),bt};let findTimeout=rt=>~(~timeouts.findIndex(_=>_.time>rt)||~timeouts.length);raf.cancel=rt=>{onStartQueue.delete(rt),onFrameQueue.delete(rt),onFinishQueue.delete(rt),updateQueue.delete(rt),writeQueue.delete(rt)};raf.sync=rt=>{sync=!0,raf.batchedUpdates(rt),sync=!1};raf.throttle=rt=>{let _;function ut(){try{rt(..._)}finally{_=null}}function mt(...bt){_=bt,raf.onStart(ut)}return mt.handler=rt,mt.cancel=()=>{onStartQueue.delete(ut),_=null},mt};let nativeRaf=typeof window<"u"?window.requestAnimationFrame:()=>{};raf.use=rt=>nativeRaf=rt;raf.now=typeof performance<"u"?()=>performance.now():Date.now;raf.batchedUpdates=rt=>rt();raf.catch=console.error;raf.frameLoop="always";raf.advance=()=>{raf.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):update$1()};let ts$1=-1,pendingCount=0,sync=!1;function schedule(rt,_){sync?(_.delete(rt),rt(0)):(_.add(rt),start())}function start(){ts$1<0&&(ts$1=0,raf.frameLoop!=="demand"&&nativeRaf(loop))}function stop(){ts$1=-1}function loop(){~ts$1&&(nativeRaf(loop),raf.batchedUpdates(update$1))}function update$1(){let rt=ts$1;ts$1=raf.now();let _=findTimeout(ts$1);if(_&&(eachSafely(timeouts.splice(0,_),ut=>ut.handler()),pendingCount-=_),!pendingCount){stop();return}onStartQueue.flush(),updateQueue.flush(rt?Math.min(64,ts$1-rt):16.667),onFrameQueue.flush(),writeQueue.flush(),onFinishQueue.flush()}function makeQueue(){let rt=new Set,_=rt;return{add(ut){pendingCount+=_==rt&&!rt.has(ut)?1:0,rt.add(ut)},delete(ut){return pendingCount-=_==rt&&rt.has(ut)?1:0,rt.delete(ut)},flush(ut){_.size&&(rt=new Set,pendingCount-=_.size,eachSafely(_,mt=>mt(ut)&&rt.add(mt)),pendingCount+=rt.size,_=rt)}}}function eachSafely(rt,_){rt.forEach(ut=>{try{_(ut)}catch(mt){raf.catch(mt)}})}function noop$3(){}const defineHidden=(rt,_,ut)=>Object.defineProperty(rt,_,{value:ut,writable:!0,configurable:!0}),is$1={arr:Array.isArray,obj:rt=>!!rt&&rt.constructor.name==="Object",fun:rt=>typeof rt=="function",str:rt=>typeof rt=="string",num:rt=>typeof rt=="number",und:rt=>rt===void 0};function isEqual(rt,_){if(is$1.arr(rt)){if(!is$1.arr(_)||rt.length!==_.length)return!1;for(let ut=0;ut<rt.length;ut++)if(rt[ut]!==_[ut])return!1;return!0}return rt===_}const each=(rt,_)=>rt.forEach(_);function eachProp(rt,_,ut){if(is$1.arr(rt)){for(let mt=0;mt<rt.length;mt++)_.call(ut,rt[mt],`${mt}`);return}for(const mt in rt)rt.hasOwnProperty(mt)&&_.call(ut,rt[mt],mt)}const toArray$3=rt=>is$1.und(rt)?[]:is$1.arr(rt)?rt:[rt];function flush(rt,_){if(rt.size){const ut=Array.from(rt);rt.clear(),each(ut,_)}}const flushCalls=(rt,..._)=>flush(rt,ut=>ut(..._)),isSSR=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let createStringInterpolator$1,to$1,colors$1=null,skipAnimation=!1,willAdvance=noop$3;const assign$4=rt=>{rt.to&&(to$1=rt.to),rt.now&&(raf.now=rt.now),rt.colors!==void 0&&(colors$1=rt.colors),rt.skipAnimation!=null&&(skipAnimation=rt.skipAnimation),rt.createStringInterpolator&&(createStringInterpolator$1=rt.createStringInterpolator),rt.requestAnimationFrame&&raf.use(rt.requestAnimationFrame),rt.batchedUpdates&&(raf.batchedUpdates=rt.batchedUpdates),rt.willAdvance&&(willAdvance=rt.willAdvance),rt.frameLoop&&(raf.frameLoop=rt.frameLoop)};var globals=Object.freeze({__proto__:null,get createStringInterpolator(){return createStringInterpolator$1},get to(){return to$1},get colors(){return colors$1},get skipAnimation(){return skipAnimation},get willAdvance(){return willAdvance},assign:assign$4});const startQueue=new Set;let currentFrame=[],prevFrame=[],priority=0;const frameLoop={get idle(){return!startQueue.size&&!currentFrame.length},start(rt){priority>rt.priority?(startQueue.add(rt),raf.onStart(flushStartQueue)):(startSafely(rt),raf(advance))},advance,sort(rt){if(priority)raf.onFrame(()=>frameLoop.sort(rt));else{const _=currentFrame.indexOf(rt);~_&&(currentFrame.splice(_,1),startUnsafely(rt))}},clear(){currentFrame=[],startQueue.clear()}};function flushStartQueue(){startQueue.forEach(startSafely),startQueue.clear(),raf(advance)}function startSafely(rt){currentFrame.includes(rt)||startUnsafely(rt)}function startUnsafely(rt){currentFrame.splice(findIndex(currentFrame,_=>_.priority>rt.priority),0,rt)}function advance(rt){const _=prevFrame;for(let ut=0;ut<currentFrame.length;ut++){const mt=currentFrame[ut];priority=mt.priority,mt.idle||(willAdvance(mt),mt.advance(rt),mt.idle||_.push(mt))}return priority=0,prevFrame=currentFrame,prevFrame.length=0,currentFrame=_,currentFrame.length>0}function findIndex(rt,_){const ut=rt.findIndex(_);return ut<0?rt.length:ut}const clamp$4=(rt,_,ut)=>Math.min(Math.max(ut,rt),_),colors={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},NUMBER="[-+]?\\d*\\.?\\d+",PERCENTAGE=NUMBER+"%";function call(...rt){return"\\(\\s*("+rt.join(")\\s*,\\s*(")+")\\s*\\)"}const rgb=new RegExp("rgb"+call(NUMBER,NUMBER,NUMBER)),rgba$1=new RegExp("rgba"+call(NUMBER,NUMBER,NUMBER,NUMBER)),hsl=new RegExp("hsl"+call(NUMBER,PERCENTAGE,PERCENTAGE)),hsla$1=new RegExp("hsla"+call(NUMBER,PERCENTAGE,PERCENTAGE,NUMBER)),hex3=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex4=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6=/^#([0-9a-fA-F]{6})$/,hex8=/^#([0-9a-fA-F]{8})$/;function normalizeColor(rt){let _;return typeof rt=="number"?rt>>>0===rt&&rt>=0&&rt<=4294967295?rt:null:(_=hex6.exec(rt))?parseInt(_[1]+"ff",16)>>>0:colors$1&&colors$1[rt]!==void 0?colors$1[rt]:(_=rgb.exec(rt))?(parse255(_[1])<<24|parse255(_[2])<<16|parse255(_[3])<<8|255)>>>0:(_=rgba$1.exec(rt))?(parse255(_[1])<<24|parse255(_[2])<<16|parse255(_[3])<<8|parse1(_[4]))>>>0:(_=hex3.exec(rt))?parseInt(_[1]+_[1]+_[2]+_[2]+_[3]+_[3]+"ff",16)>>>0:(_=hex8.exec(rt))?parseInt(_[1],16)>>>0:(_=hex4.exec(rt))?parseInt(_[1]+_[1]+_[2]+_[2]+_[3]+_[3]+_[4]+_[4],16)>>>0:(_=hsl.exec(rt))?(hslToRgb(parse360(_[1]),parsePercentage(_[2]),parsePercentage(_[3]))|255)>>>0:(_=hsla$1.exec(rt))?(hslToRgb(parse360(_[1]),parsePercentage(_[2]),parsePercentage(_[3]))|parse1(_[4]))>>>0:null}function hue2rgb(rt,_,ut){return ut<0&&(ut+=1),ut>1&&(ut-=1),ut<1/6?rt+(_-rt)*6*ut:ut<1/2?_:ut<2/3?rt+(_-rt)*(2/3-ut)*6:rt}function hslToRgb(rt,_,ut){const mt=ut<.5?ut*(1+_):ut+_-ut*_,bt=2*ut-mt,St=hue2rgb(bt,mt,rt+1/3),Mt=hue2rgb(bt,mt,rt),Bt=hue2rgb(bt,mt,rt-1/3);return Math.round(St*255)<<24|Math.round(Mt*255)<<16|Math.round(Bt*255)<<8}function parse255(rt){const _=parseInt(rt,10);return _<0?0:_>255?255:_}function parse360(rt){return(parseFloat(rt)%360+360)%360/360}function parse1(rt){const _=parseFloat(rt);return _<0?0:_>1?255:Math.round(_*255)}function parsePercentage(rt){const _=parseFloat(rt);return _<0?0:_>100?1:_/100}function colorToRgba(rt){let _=normalizeColor(rt);if(_===null)return rt;_=_||0;let ut=(_&4278190080)>>>24,mt=(_&16711680)>>>16,bt=(_&65280)>>>8,St=(_&255)/255;return`rgba(${ut}, ${mt}, ${bt}, ${St})`}const createInterpolator=(rt,_,ut)=>{if(is$1.fun(rt))return rt;if(is$1.arr(rt))return createInterpolator({range:rt,output:_,extrapolate:ut});if(is$1.str(rt.output[0]))return createStringInterpolator$1(rt);const mt=rt,bt=mt.output,St=mt.range||[0,1],Mt=mt.extrapolateLeft||mt.extrapolate||"extend",Bt=mt.extrapolateRight||mt.extrapolate||"extend",Ut=mt.easing||(Ht=>Ht);return Ht=>{const tr=findRange(Ht,St);return interpolate$2(Ht,St[tr],St[tr+1],bt[tr],bt[tr+1],Ut,Mt,Bt,mt.map)}};function interpolate$2(rt,_,ut,mt,bt,St,Mt,Bt,Ut){let Ht=Ut?Ut(rt):rt;if(Ht<_){if(Mt==="identity")return Ht;Mt==="clamp"&&(Ht=_)}if(Ht>ut){if(Bt==="identity")return Ht;Bt==="clamp"&&(Ht=ut)}return mt===bt?mt:_===ut?rt<=_?mt:bt:(_===-1/0?Ht=-Ht:ut===1/0?Ht=Ht-_:Ht=(Ht-_)/(ut-_),Ht=St(Ht),mt===-1/0?Ht=-Ht:bt===1/0?Ht=Ht+mt:Ht=Ht*(bt-mt)+mt,Ht)}function findRange(rt,_){for(var ut=1;ut<_.length-1&&!(_[ut]>=rt);++ut);return ut-1}const steps$1=(rt,_="end")=>ut=>{ut=_==="end"?Math.min(ut,.999):Math.max(ut,.001);const mt=ut*rt,bt=_==="end"?Math.floor(mt):Math.ceil(mt);return clamp$4(0,1,bt/rt)},c1$1=1.70158,c2$1=c1$1*1.525,c3=c1$1+1,c4=2*Math.PI/3,c5=2*Math.PI/4.5,bounceOut=rt=>rt<1/2.75?7.5625*rt*rt:rt<2/2.75?7.5625*(rt-=1.5/2.75)*rt+.75:rt<2.5/2.75?7.5625*(rt-=2.25/2.75)*rt+.9375:7.5625*(rt-=2.625/2.75)*rt+.984375,easings={linear:rt=>rt,easeInQuad:rt=>rt*rt,easeOutQuad:rt=>1-(1-rt)*(1-rt),easeInOutQuad:rt=>rt<.5?2*rt*rt:1-Math.pow(-2*rt+2,2)/2,easeInCubic:rt=>rt*rt*rt,easeOutCubic:rt=>1-Math.pow(1-rt,3),easeInOutCubic:rt=>rt<.5?4*rt*rt*rt:1-Math.pow(-2*rt+2,3)/2,easeInQuart:rt=>rt*rt*rt*rt,easeOutQuart:rt=>1-Math.pow(1-rt,4),easeInOutQuart:rt=>rt<.5?8*rt*rt*rt*rt:1-Math.pow(-2*rt+2,4)/2,easeInQuint:rt=>rt*rt*rt*rt*rt,easeOutQuint:rt=>1-Math.pow(1-rt,5),easeInOutQuint:rt=>rt<.5?16*rt*rt*rt*rt*rt:1-Math.pow(-2*rt+2,5)/2,easeInSine:rt=>1-Math.cos(rt*Math.PI/2),easeOutSine:rt=>Math.sin(rt*Math.PI/2),easeInOutSine:rt=>-(Math.cos(Math.PI*rt)-1)/2,easeInExpo:rt=>rt===0?0:Math.pow(2,10*rt-10),easeOutExpo:rt=>rt===1?1:1-Math.pow(2,-10*rt),easeInOutExpo:rt=>rt===0?0:rt===1?1:rt<.5?Math.pow(2,20*rt-10)/2:(2-Math.pow(2,-20*rt+10))/2,easeInCirc:rt=>1-Math.sqrt(1-Math.pow(rt,2)),easeOutCirc:rt=>Math.sqrt(1-Math.pow(rt-1,2)),easeInOutCirc:rt=>rt<.5?(1-Math.sqrt(1-Math.pow(2*rt,2)))/2:(Math.sqrt(1-Math.pow(-2*rt+2,2))+1)/2,easeInBack:rt=>c3*rt*rt*rt-c1$1*rt*rt,easeOutBack:rt=>1+c3*Math.pow(rt-1,3)+c1$1*Math.pow(rt-1,2),easeInOutBack:rt=>rt<.5?Math.pow(2*rt,2)*((c2$1+1)*2*rt-c2$1)/2:(Math.pow(2*rt-2,2)*((c2$1+1)*(rt*2-2)+c2$1)+2)/2,easeInElastic:rt=>rt===0?0:rt===1?1:-Math.pow(2,10*rt-10)*Math.sin((rt*10-10.75)*c4),easeOutElastic:rt=>rt===0?0:rt===1?1:Math.pow(2,-10*rt)*Math.sin((rt*10-.75)*c4)+1,easeInOutElastic:rt=>rt===0?0:rt===1?1:rt<.5?-(Math.pow(2,20*rt-10)*Math.sin((20*rt-11.125)*c5))/2:Math.pow(2,-20*rt+10)*Math.sin((20*rt-11.125)*c5)/2+1,easeInBounce:rt=>1-bounceOut(1-rt),easeOutBounce:bounceOut,easeInOutBounce:rt=>rt<.5?(1-bounceOut(1-2*rt))/2:(1+bounceOut(2*rt-1))/2,steps:steps$1};function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_];for(var mt in ut)Object.prototype.hasOwnProperty.call(ut,mt)&&(rt[mt]=ut[mt])}return rt},_extends$3.apply(this,arguments)}const $get=Symbol.for("FluidValue.get"),$observers=Symbol.for("FluidValue.observers"),hasFluidValue=rt=>!!(rt&&rt[$get]),getFluidValue=rt=>rt&&rt[$get]?rt[$get]():rt,getFluidObservers=rt=>rt[$observers]||null;function callFluidObserver(rt,_){rt.eventObserved?rt.eventObserved(_):rt(_)}function callFluidObservers(rt,_){let ut=rt[$observers];ut&&ut.forEach(mt=>{callFluidObserver(mt,_)})}class FluidValue{constructor(_){if(this[$get]=void 0,this[$observers]=void 0,!_&&!(_=this.get))throw Error("Unknown getter");setFluidGetter(this,_)}}const setFluidGetter=(rt,_)=>setHidden(rt,$get,_);function addFluidObserver(rt,_){if(rt[$get]){let ut=rt[$observers];ut||setHidden(rt,$observers,ut=new Set),ut.has(_)||(ut.add(_),rt.observerAdded&&rt.observerAdded(ut.size,_))}return _}function removeFluidObserver(rt,_){let ut=rt[$observers];if(ut&&ut.has(_)){const mt=ut.size-1;mt?ut.delete(_):rt[$observers]=null,rt.observerRemoved&&rt.observerRemoved(mt,_)}}const setHidden=(rt,_,ut)=>Object.defineProperty(rt,_,{value:ut,writable:!0,configurable:!0}),numberRegex=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,colorRegex$1=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,unitRegex=new RegExp(`(${numberRegex.source})(%|[a-z]+)`,"i"),rgbaRegex=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,cssVariableRegex=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,variableToRgba=rt=>{const[_,ut]=parseCSSVariable$1(rt);if(!_||isSSR())return rt;const mt=window.getComputedStyle(document.documentElement).getPropertyValue(_);if(mt)return mt.trim();if(ut&&ut.startsWith("--")){const bt=window.getComputedStyle(document.documentElement).getPropertyValue(ut);return bt||rt}else{if(ut&&cssVariableRegex.test(ut))return variableToRgba(ut);if(ut)return ut}return rt},parseCSSVariable$1=rt=>{const _=cssVariableRegex.exec(rt);if(!_)return[,];const[,ut,mt]=_;return[ut,mt]};let namedColorRegex;const rgbaRound=(rt,_,ut,mt,bt)=>`rgba(${Math.round(_)}, ${Math.round(ut)}, ${Math.round(mt)}, ${bt})`,createStringInterpolator=rt=>{namedColorRegex||(namedColorRegex=colors$1?new RegExp(`(${Object.keys(colors$1).join("|")})(?!\\w)`,"g"):/^\b$/);const _=rt.output.map(St=>getFluidValue(St).replace(cssVariableRegex,variableToRgba).replace(colorRegex$1,colorToRgba).replace(namedColorRegex,colorToRgba)),ut=_.map(St=>St.match(numberRegex).map(Number)),bt=ut[0].map((St,Mt)=>ut.map(Bt=>{if(!(Mt in Bt))throw Error('The arity of each "output" value must be equal');return Bt[Mt]})).map(St=>createInterpolator(_extends$3({},rt,{output:St})));return St=>{var Mt;const Bt=!unitRegex.test(_[0])&&((Mt=_.find(Ht=>unitRegex.test(Ht)))==null?void 0:Mt.replace(numberRegex,""));let Ut=0;return _[0].replace(numberRegex,()=>`${bt[Ut++](St)}${Bt||""}`).replace(rgbaRegex,rgbaRound)}},prefix="react-spring: ",once=rt=>{const _=rt;let ut=!1;if(typeof _!="function")throw new TypeError(`${prefix}once requires a function parameter`);return(...mt)=>{ut||(_(...mt),ut=!0)}},warnInterpolate=once(console.warn);function deprecateInterpolate(){warnInterpolate(`${prefix}The "interpolate" function is deprecated in v9 (use "to" instead)`)}const warnDirectCall=once(console.warn);function deprecateDirectCall(){warnDirectCall(`${prefix}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function isAnimatedString(rt){return is$1.str(rt)&&(rt[0]=="#"||/\d/.test(rt)||!isSSR()&&cssVariableRegex.test(rt)||rt in(colors$1||{}))}const useIsomorphicLayoutEffect$1=isSSR()?reactExports.useEffect:reactExports.useLayoutEffect,useIsMounted=()=>{const rt=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>(rt.current=!0,()=>{rt.current=!1}),[]),rt};function useForceUpdate(){const rt=reactExports.useState()[1],_=useIsMounted();return()=>{_.current&&rt(Math.random())}}function useMemoOne(rt,_){const[ut]=reactExports.useState(()=>({inputs:_,result:rt()})),mt=reactExports.useRef(),bt=mt.current;let St=bt;return St?_&&St.inputs&&areInputsEqual(_,St.inputs)||(St={inputs:_,result:rt()}):St=ut,reactExports.useEffect(()=>{mt.current=St,bt==ut&&(ut.inputs=ut.result=void 0)},[St]),St.result}function areInputsEqual(rt,_){if(rt.length!==_.length)return!1;for(let ut=0;ut<rt.length;ut++)if(rt[ut]!==_[ut])return!1;return!0}const useOnce=rt=>reactExports.useEffect(rt,emptyDeps),emptyDeps=[];function usePrev(rt){const _=reactExports.useRef();return reactExports.useEffect(()=>{_.current=rt}),_.current}const $node=Symbol.for("Animated:node"),isAnimated=rt=>!!rt&&rt[$node]===rt,getAnimated=rt=>rt&&rt[$node],setAnimated=(rt,_)=>defineHidden(rt,$node,_),getPayload=rt=>rt&&rt[$node]&&rt[$node].getPayload();class Animated{constructor(){this.payload=void 0,setAnimated(this,this)}getPayload(){return this.payload||[]}}class AnimatedValue extends Animated{constructor(_){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=_,is$1.num(this._value)&&(this.lastPosition=this._value)}static create(_){return new AnimatedValue(_)}getPayload(){return[this]}getValue(){return this._value}setValue(_,ut){return is$1.num(_)&&(this.lastPosition=_,ut&&(_=Math.round(_/ut)*ut,this.done&&(this.lastPosition=_))),this._value===_?!1:(this._value=_,!0)}reset(){const{done:_}=this;this.done=!1,is$1.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,_&&(this.lastVelocity=null),this.v0=null)}}class AnimatedString extends AnimatedValue{constructor(_){super(0),this._string=null,this._toString=void 0,this._toString=createInterpolator({output:[_,_]})}static create(_){return new AnimatedString(_)}getValue(){let _=this._string;return _??(this._string=this._toString(this._value))}setValue(_){if(is$1.str(_)){if(_==this._string)return!1;this._string=_,this._value=1}else if(super.setValue(_))this._string=null;else return!1;return!0}reset(_){_&&(this._toString=createInterpolator({output:[this.getValue(),_]})),this._value=0,super.reset()}}const TreeContext={dependencies:null};class AnimatedObject extends Animated{constructor(_){super(),this.source=_,this.setValue(_)}getValue(_){const ut={};return eachProp(this.source,(mt,bt)=>{isAnimated(mt)?ut[bt]=mt.getValue(_):hasFluidValue(mt)?ut[bt]=getFluidValue(mt):_||(ut[bt]=mt)}),ut}setValue(_){this.source=_,this.payload=this._makePayload(_)}reset(){this.payload&&each(this.payload,_=>_.reset())}_makePayload(_){if(_){const ut=new Set;return eachProp(_,this._addToPayload,ut),Array.from(ut)}}_addToPayload(_){TreeContext.dependencies&&hasFluidValue(_)&&TreeContext.dependencies.add(_);const ut=getPayload(_);ut&&each(ut,mt=>this.add(mt))}}class AnimatedArray extends AnimatedObject{constructor(_){super(_)}static create(_){return new AnimatedArray(_)}getValue(){return this.source.map(_=>_.getValue())}setValue(_){const ut=this.getPayload();return _.length==ut.length?ut.map((mt,bt)=>mt.setValue(_[bt])).some(Boolean):(super.setValue(_.map(makeAnimated)),!0)}}function makeAnimated(rt){return(isAnimatedString(rt)?AnimatedString:AnimatedValue).create(rt)}function getAnimatedType(rt){const _=getAnimated(rt);return _?_.constructor:is$1.arr(rt)?AnimatedArray:isAnimatedString(rt)?AnimatedString:AnimatedValue}function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_];for(var mt in ut)Object.prototype.hasOwnProperty.call(ut,mt)&&(rt[mt]=ut[mt])}return rt},_extends$2.apply(this,arguments)}const withAnimated=(rt,_)=>{const ut=!is$1.fun(rt)||rt.prototype&&rt.prototype.isReactComponent;return reactExports.forwardRef((mt,bt)=>{const St=reactExports.useRef(null),Mt=ut&&reactExports.useCallback(cr=>{St.current=updateRef(bt,cr)},[bt]),[Bt,Ut]=getAnimatedState(mt,_),Ht=useForceUpdate(),tr=()=>{const cr=St.current;if(ut&&!cr)return;(cr?_.applyAnimatedValues(cr,Bt.getValue(!0)):!1)===!1&&Ht()},rr=new PropsObserver(tr,Ut),sr=reactExports.useRef();useIsomorphicLayoutEffect$1(()=>(sr.current=rr,each(Ut,cr=>addFluidObserver(cr,rr)),()=>{sr.current&&(each(sr.current.deps,cr=>removeFluidObserver(cr,sr.current)),raf.cancel(sr.current.update))})),reactExports.useEffect(tr,[]),useOnce(()=>()=>{const cr=sr.current;each(cr.deps,Ar=>removeFluidObserver(Ar,cr))});const ar=_.getComponentProps(Bt.getValue());return reactExports.createElement(rt,_extends$2({},ar,{ref:Mt}))})};class PropsObserver{constructor(_,ut){this.update=_,this.deps=ut}eventObserved(_){_.type=="change"&&raf.write(this.update)}}function getAnimatedState(rt,_){const ut=new Set;return TreeContext.dependencies=ut,rt.style&&(rt=_extends$2({},rt,{style:_.createAnimatedStyle(rt.style)})),rt=new AnimatedObject(rt),TreeContext.dependencies=null,[rt,ut]}function updateRef(rt,_){return rt&&(is$1.fun(rt)?rt(_):rt.current=_),_}const cacheKey=Symbol.for("AnimatedComponent"),createHost=(rt,{applyAnimatedValues:_=()=>!1,createAnimatedStyle:ut=bt=>new AnimatedObject(bt),getComponentProps:mt=bt=>bt}={})=>{const bt={applyAnimatedValues:_,createAnimatedStyle:ut,getComponentProps:mt},St=Mt=>{const Bt=getDisplayName(Mt)||"Anonymous";return is$1.str(Mt)?Mt=St[Mt]||(St[Mt]=withAnimated(Mt,bt)):Mt=Mt[cacheKey]||(Mt[cacheKey]=withAnimated(Mt,bt)),Mt.displayName=`Animated(${Bt})`,Mt};return eachProp(rt,(Mt,Bt)=>{is$1.arr(rt)&&(Bt=getDisplayName(Mt)),St[Bt]=St(Mt)}),{animated:St}},getDisplayName=rt=>is$1.str(rt)?rt:rt&&is$1.str(rt.displayName)?rt.displayName:is$1.fun(rt)&&rt.name||null;function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_];for(var mt in ut)Object.prototype.hasOwnProperty.call(ut,mt)&&(rt[mt]=ut[mt])}return rt},_extends$1.apply(this,arguments)}function callProp(rt,..._){return is$1.fun(rt)?rt(..._):rt}const matchProp=(rt,_)=>rt===!0||!!(_&&rt&&(is$1.fun(rt)?rt(_):toArray$3(rt).includes(_))),resolveProp=(rt,_)=>is$1.obj(rt)?_&&rt[_]:rt,getDefaultProp=(rt,_)=>rt.default===!0?rt[_]:rt.default?rt.default[_]:void 0,noopTransform=rt=>rt,getDefaultProps=(rt,_=noopTransform)=>{let ut=DEFAULT_PROPS;rt.default&&rt.default!==!0&&(rt=rt.default,ut=Object.keys(rt));const mt={};for(const bt of ut){const St=_(rt[bt],bt);is$1.und(St)||(mt[bt]=St)}return mt},DEFAULT_PROPS=["config","onProps","onStart","onChange","onPause","onResume","onRest"],RESERVED_PROPS={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function getForwardProps(rt){const _={};let ut=0;if(eachProp(rt,(mt,bt)=>{RESERVED_PROPS[bt]||(_[bt]=mt,ut++)}),ut)return _}function inferTo(rt){const _=getForwardProps(rt);if(_){const ut={to:_};return eachProp(rt,(mt,bt)=>bt in _||(ut[bt]=mt)),ut}return _extends$1({},rt)}function computeGoal(rt){return rt=getFluidValue(rt),is$1.arr(rt)?rt.map(computeGoal):isAnimatedString(rt)?globals.createStringInterpolator({range:[0,1],output:[rt,rt]})(1):rt}function hasProps(rt){for(const _ in rt)return!0;return!1}function isAsyncTo(rt){return is$1.fun(rt)||is$1.arr(rt)&&is$1.obj(rt[0])}function detachRefs(rt,_){var ut;(ut=rt.ref)==null||ut.delete(rt),_==null||_.delete(rt)}function replaceRef(rt,_){if(_&&rt.ref!==_){var ut;(ut=rt.ref)==null||ut.delete(rt),_.add(rt),rt.ref=_}}const config={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},defaults$1=_extends$1({},config.default,{mass:1,damping:1,easing:easings.linear,clamp:!1});class AnimationConfig{constructor(){this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,defaults$1)}}function mergeConfig$1(rt,_,ut){ut&&(ut=_extends$1({},ut),sanitizeConfig(ut,_),_=_extends$1({},ut,_)),sanitizeConfig(rt,_),Object.assign(rt,_);for(const Mt in defaults$1)rt[Mt]==null&&(rt[Mt]=defaults$1[Mt]);let{mass:mt,frequency:bt,damping:St}=rt;return is$1.und(bt)||(bt<.01&&(bt=.01),St<0&&(St=0),rt.tension=Math.pow(2*Math.PI/bt,2)*mt,rt.friction=4*Math.PI*St*mt/bt),rt}function sanitizeConfig(rt,_){if(!is$1.und(_.decay))rt.duration=void 0;else{const ut=!is$1.und(_.tension)||!is$1.und(_.friction);(ut||!is$1.und(_.frequency)||!is$1.und(_.damping)||!is$1.und(_.mass))&&(rt.duration=void 0,rt.decay=void 0),ut&&(rt.frequency=void 0)}}const emptyArray=[];let Animation$1=class{constructor(){this.changed=!1,this.values=emptyArray,this.toValues=null,this.fromValues=emptyArray,this.to=void 0,this.from=void 0,this.config=new AnimationConfig,this.immediate=!1}};function scheduleProps(rt,{key:_,props:ut,defaultProps:mt,state:bt,actions:St}){return new Promise((Mt,Bt)=>{var Ut;let Ht,tr,rr=matchProp((Ut=ut.cancel)!=null?Ut:mt==null?void 0:mt.cancel,_);if(rr)cr();else{is$1.und(ut.pause)||(bt.paused=matchProp(ut.pause,_));let Ar=mt==null?void 0:mt.pause;Ar!==!0&&(Ar=bt.paused||matchProp(Ar,_)),Ht=callProp(ut.delay||0,_),Ar?(bt.resumeQueue.add(ar),St.pause()):(St.resume(),ar())}function sr(){bt.resumeQueue.add(ar),bt.timeouts.delete(tr),tr.cancel(),Ht=tr.time-raf.now()}function ar(){Ht>0&&!globals.skipAnimation?(bt.delayed=!0,tr=raf.setTimeout(cr,Ht),bt.pauseQueue.add(sr),bt.timeouts.add(tr)):cr()}function cr(){bt.delayed&&(bt.delayed=!1),bt.pauseQueue.delete(sr),bt.timeouts.delete(tr),rt<=(bt.cancelId||0)&&(rr=!0);try{St.start(_extends$1({},ut,{callId:rt,cancel:rr}),Mt)}catch(Ar){Bt(Ar)}}})}const getCombinedResult=(rt,_)=>_.length==1?_[0]:_.some(ut=>ut.cancelled)?getCancelledResult(rt.get()):_.every(ut=>ut.noop)?getNoopResult(rt.get()):getFinishedResult(rt.get(),_.every(ut=>ut.finished)),getNoopResult=rt=>({value:rt,noop:!0,finished:!0,cancelled:!1}),getFinishedResult=(rt,_,ut=!1)=>({value:rt,finished:_,cancelled:ut}),getCancelledResult=rt=>({value:rt,cancelled:!0,finished:!1});function runAsync(rt,_,ut,mt){const{callId:bt,parentId:St,onRest:Mt}=_,{asyncTo:Bt,promise:Ut}=ut;return!St&&rt===Bt&&!_.reset?Ut:ut.promise=(async()=>{ut.asyncId=bt,ut.asyncTo=rt;const Ht=getDefaultProps(_,(_r,Dr)=>Dr==="onRest"?void 0:_r);let tr,rr;const sr=new Promise((_r,Dr)=>(tr=_r,rr=Dr)),ar=_r=>{const Dr=bt<=(ut.cancelId||0)&&getCancelledResult(mt)||bt!==ut.asyncId&&getFinishedResult(mt,!1);if(Dr)throw _r.result=Dr,rr(_r),_r},cr=(_r,Dr)=>{const $r=new BailSignal,Br=new SkipAnimationSignal;return(async()=>{if(globals.skipAnimation)throw stopAsync(ut),Br.result=getFinishedResult(mt,!1),rr(Br),Br;ar($r);const Jr=is$1.obj(_r)?_extends$1({},_r):_extends$1({},Dr,{to:_r});Jr.parentId=bt,eachProp(Ht,(Mn,$n)=>{is$1.und(Jr[$n])&&(Jr[$n]=Mn)});const mn=await mt.start(Jr);return ar($r),ut.paused&&await new Promise(Mn=>{ut.resumeQueue.add(Mn)}),mn})()};let Ar;if(globals.skipAnimation)return stopAsync(ut),getFinishedResult(mt,!1);try{let _r;is$1.arr(rt)?_r=(async Dr=>{for(const $r of Dr)await cr($r)})(rt):_r=Promise.resolve(rt(cr,mt.stop.bind(mt))),await Promise.all([_r.then(tr),sr]),Ar=getFinishedResult(mt.get(),!0,!1)}catch(_r){if(_r instanceof BailSignal)Ar=_r.result;else if(_r instanceof SkipAnimationSignal)Ar=_r.result;else throw _r}finally{bt==ut.asyncId&&(ut.asyncId=St,ut.asyncTo=St?Bt:void 0,ut.promise=St?Ut:void 0)}return is$1.fun(Mt)&&raf.batchedUpdates(()=>{Mt(Ar,mt,mt.item)}),Ar})()}function stopAsync(rt,_){flush(rt.timeouts,ut=>ut.cancel()),rt.pauseQueue.clear(),rt.resumeQueue.clear(),rt.asyncId=rt.asyncTo=rt.promise=void 0,_&&(rt.cancelId=_)}class BailSignal extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise."),this.result=void 0}}class SkipAnimationSignal extends Error{constructor(){super("SkipAnimationSignal"),this.result=void 0}}const isFrameValue=rt=>rt instanceof FrameValue;let nextId$1=1;class FrameValue extends FluidValue{constructor(..._){super(..._),this.id=nextId$1++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(_){this._priority!=_&&(this._priority=_,this._onPriorityChange(_))}get(){const _=getAnimated(this);return _&&_.getValue()}to(..._){return globals.to(this,_)}interpolate(..._){return deprecateInterpolate(),globals.to(this,_)}toJSON(){return this.get()}observerAdded(_){_==1&&this._attach()}observerRemoved(_){_==0&&this._detach()}_attach(){}_detach(){}_onChange(_,ut=!1){callFluidObservers(this,{type:"change",parent:this,value:_,idle:ut})}_onPriorityChange(_){this.idle||frameLoop.sort(this),callFluidObservers(this,{type:"priority",parent:this,priority:_})}}const $P=Symbol.for("SpringPhase"),HAS_ANIMATED=1,IS_ANIMATING=2,IS_PAUSED=4,hasAnimated=rt=>(rt[$P]&HAS_ANIMATED)>0,isAnimating=rt=>(rt[$P]&IS_ANIMATING)>0,isPaused=rt=>(rt[$P]&IS_PAUSED)>0,setActiveBit=(rt,_)=>_?rt[$P]|=IS_ANIMATING|HAS_ANIMATED:rt[$P]&=~IS_ANIMATING,setPausedBit=(rt,_)=>_?rt[$P]|=IS_PAUSED:rt[$P]&=~IS_PAUSED;class SpringValue extends FrameValue{constructor(_,ut){if(super(),this.key=void 0,this.animation=new Animation$1,this.queue=void 0,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!is$1.und(_)||!is$1.und(ut)){const mt=is$1.obj(_)?_extends$1({},_):_extends$1({},ut,{from:_});is$1.und(mt.default)&&(mt.default=!0),this.start(mt)}}get idle(){return!(isAnimating(this)||this._state.asyncTo)||isPaused(this)}get goal(){return getFluidValue(this.animation.to)}get velocity(){const _=getAnimated(this);return _ instanceof AnimatedValue?_.lastVelocity||0:_.getPayload().map(ut=>ut.lastVelocity||0)}get hasAnimated(){return hasAnimated(this)}get isAnimating(){return isAnimating(this)}get isPaused(){return isPaused(this)}get isDelayed(){return this._state.delayed}advance(_){let ut=!0,mt=!1;const bt=this.animation;let{config:St,toValues:Mt}=bt;const Bt=getPayload(bt.to);!Bt&&hasFluidValue(bt.to)&&(Mt=toArray$3(getFluidValue(bt.to))),bt.values.forEach((tr,rr)=>{if(tr.done)return;const sr=tr.constructor==AnimatedString?1:Bt?Bt[rr].lastPosition:Mt[rr];let ar=bt.immediate,cr=sr;if(!ar){if(cr=tr.lastPosition,St.tension<=0){tr.done=!0;return}let Ar=tr.elapsedTime+=_;const _r=bt.fromValues[rr],Dr=tr.v0!=null?tr.v0:tr.v0=is$1.arr(St.velocity)?St.velocity[rr]:St.velocity;let $r;const Br=St.precision||(_r==sr?.005:Math.min(1,Math.abs(sr-_r)*.001));if(is$1.und(St.duration))if(St.decay){const Jr=St.decay===!0?.998:St.decay,mn=Math.exp(-(1-Jr)*Ar);cr=_r+Dr/(1-Jr)*(1-mn),ar=Math.abs(tr.lastPosition-cr)<=Br,$r=Dr*mn}else{$r=tr.lastVelocity==null?Dr:tr.lastVelocity;const Jr=St.restVelocity||Br/10,mn=St.clamp?0:St.bounce,Mn=!is$1.und(mn),$n=_r==sr?tr.v0>0:_r<sr;let en,In=!1;const Rn=1,qn=Math.ceil(_/Rn);for(let Qn=0;Qn<qn&&(en=Math.abs($r)>Jr,!(!en&&(ar=Math.abs(sr-cr)<=Br,ar)));++Qn){Mn&&(In=cr==sr||cr>sr==$n,In&&($r=-$r*mn,cr=sr));const xs=-St.tension*1e-6*(cr-sr),cs=-St.friction*.001*$r,ks=(xs+cs)/St.mass;$r=$r+ks*Rn,cr=cr+$r*Rn}}else{let Jr=1;St.duration>0&&(this._memoizedDuration!==St.duration&&(this._memoizedDuration=St.duration,tr.durationProgress>0&&(tr.elapsedTime=St.duration*tr.durationProgress,Ar=tr.elapsedTime+=_)),Jr=(St.progress||0)+Ar/this._memoizedDuration,Jr=Jr>1?1:Jr<0?0:Jr,tr.durationProgress=Jr),cr=_r+St.easing(Jr)*(sr-_r),$r=(cr-tr.lastPosition)/_,ar=Jr==1}tr.lastVelocity=$r,Number.isNaN(cr)&&(console.warn("Got NaN while animating:",this),ar=!0)}Bt&&!Bt[rr].done&&(ar=!1),ar?tr.done=!0:ut=!1,tr.setValue(cr,St.round)&&(mt=!0)});const Ut=getAnimated(this),Ht=Ut.getValue();if(ut){const tr=getFluidValue(bt.to);(Ht!==tr||mt)&&!St.decay?(Ut.setValue(tr),this._onChange(tr)):mt&&St.decay&&this._onChange(Ht),this._stop()}else mt&&this._onChange(Ht)}set(_){return raf.batchedUpdates(()=>{this._stop(),this._focus(_),this._set(_)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(isAnimating(this)){const{to:_,config:ut}=this.animation;raf.batchedUpdates(()=>{this._onStart(),ut.decay||this._set(_,!1),this._stop()})}return this}update(_){return(this.queue||(this.queue=[])).push(_),this}start(_,ut){let mt;return is$1.und(_)?(mt=this.queue||[],this.queue=[]):mt=[is$1.obj(_)?_:_extends$1({},ut,{to:_})],Promise.all(mt.map(bt=>this._update(bt))).then(bt=>getCombinedResult(this,bt))}stop(_){const{to:ut}=this.animation;return this._focus(this.get()),stopAsync(this._state,_&&this._lastCallId),raf.batchedUpdates(()=>this._stop(ut,_)),this}reset(){this._update({reset:!0})}eventObserved(_){_.type=="change"?this._start():_.type=="priority"&&(this.priority=_.priority+1)}_prepareNode(_){const ut=this.key||"";let{to:mt,from:bt}=_;mt=is$1.obj(mt)?mt[ut]:mt,(mt==null||isAsyncTo(mt))&&(mt=void 0),bt=is$1.obj(bt)?bt[ut]:bt,bt==null&&(bt=void 0);const St={to:mt,from:bt};return hasAnimated(this)||(_.reverse&&([mt,bt]=[bt,mt]),bt=getFluidValue(bt),is$1.und(bt)?getAnimated(this)||this._set(mt):this._set(bt)),St}_update(_,ut){let mt=_extends$1({},_);const{key:bt,defaultProps:St}=this;mt.default&&Object.assign(St,getDefaultProps(mt,(Ut,Ht)=>/^on/.test(Ht)?resolveProp(Ut,bt):Ut)),mergeActiveFn(this,mt,"onProps"),sendEvent(this,"onProps",mt,this);const Mt=this._prepareNode(mt);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const Bt=this._state;return scheduleProps(++this._lastCallId,{key:bt,props:mt,defaultProps:St,state:Bt,actions:{pause:()=>{isPaused(this)||(setPausedBit(this,!0),flushCalls(Bt.pauseQueue),sendEvent(this,"onPause",getFinishedResult(this,checkFinished(this,this.animation.to)),this))},resume:()=>{isPaused(this)&&(setPausedBit(this,!1),isAnimating(this)&&this._resume(),flushCalls(Bt.resumeQueue),sendEvent(this,"onResume",getFinishedResult(this,checkFinished(this,this.animation.to)),this))},start:this._merge.bind(this,Mt)}}).then(Ut=>{if(mt.loop&&Ut.finished&&!(ut&&Ut.noop)){const Ht=createLoopUpdate(mt);if(Ht)return this._update(Ht,!0)}return Ut})}_merge(_,ut,mt){if(ut.cancel)return this.stop(!0),mt(getCancelledResult(this));const bt=!is$1.und(_.to),St=!is$1.und(_.from);if(bt||St)if(ut.callId>this._lastToId)this._lastToId=ut.callId;else return mt(getCancelledResult(this));const{key:Mt,defaultProps:Bt,animation:Ut}=this,{to:Ht,from:tr}=Ut;let{to:rr=Ht,from:sr=tr}=_;St&&!bt&&(!ut.default||is$1.und(rr))&&(rr=sr),ut.reverse&&([rr,sr]=[sr,rr]);const ar=!isEqual(sr,tr);ar&&(Ut.from=sr),sr=getFluidValue(sr);const cr=!isEqual(rr,Ht);cr&&this._focus(rr);const Ar=isAsyncTo(ut.to),{config:_r}=Ut,{decay:Dr,velocity:$r}=_r;(bt||St)&&(_r.velocity=0),ut.config&&!Ar&&mergeConfig$1(_r,callProp(ut.config,Mt),ut.config!==Bt.config?callProp(Bt.config,Mt):void 0);let Br=getAnimated(this);if(!Br||is$1.und(rr))return mt(getFinishedResult(this,!0));const Jr=is$1.und(ut.reset)?St&&!ut.default:!is$1.und(sr)&&matchProp(ut.reset,Mt),mn=Jr?sr:this.get(),Mn=computeGoal(rr),$n=is$1.num(Mn)||is$1.arr(Mn)||isAnimatedString(Mn),en=!Ar&&(!$n||matchProp(Bt.immediate||ut.immediate,Mt));if(cr){const Qn=getAnimatedType(rr);if(Qn!==Br.constructor)if(en)Br=this._set(Mn);else throw Error(`Cannot animate between ${Br.constructor.name} and ${Qn.name}, as the "to" prop suggests`)}const In=Br.constructor;let Rn=hasFluidValue(rr),qn=!1;if(!Rn){const Qn=Jr||!hasAnimated(this)&&ar;(cr||Qn)&&(qn=isEqual(computeGoal(mn),Mn),Rn=!qn),(!isEqual(Ut.immediate,en)&&!en||!isEqual(_r.decay,Dr)||!isEqual(_r.velocity,$r))&&(Rn=!0)}if(qn&&isAnimating(this)&&(Ut.changed&&!Jr?Rn=!0:Rn||this._stop(Ht)),!Ar&&((Rn||hasFluidValue(Ht))&&(Ut.values=Br.getPayload(),Ut.toValues=hasFluidValue(rr)?null:In==AnimatedString?[1]:toArray$3(Mn)),Ut.immediate!=en&&(Ut.immediate=en,!en&&!Jr&&this._set(Ht)),Rn)){const{onRest:Qn}=Ut;each(ACTIVE_EVENTS,cs=>mergeActiveFn(this,ut,cs));const xs=getFinishedResult(this,checkFinished(this,Ht));flushCalls(this._pendingCalls,xs),this._pendingCalls.add(mt),Ut.changed&&raf.batchedUpdates(()=>{Ut.changed=!Jr,Qn==null||Qn(xs,this),Jr?callProp(Bt.onRest,xs):Ut.onStart==null||Ut.onStart(xs,this)})}Jr&&this._set(mn),Ar?mt(runAsync(ut.to,ut,this._state,this)):Rn?this._start():isAnimating(this)&&!cr?this._pendingCalls.add(mt):mt(getNoopResult(mn))}_focus(_){const ut=this.animation;_!==ut.to&&(getFluidObservers(this)&&this._detach(),ut.to=_,getFluidObservers(this)&&this._attach())}_attach(){let _=0;const{to:ut}=this.animation;hasFluidValue(ut)&&(addFluidObserver(ut,this),isFrameValue(ut)&&(_=ut.priority+1)),this.priority=_}_detach(){const{to:_}=this.animation;hasFluidValue(_)&&removeFluidObserver(_,this)}_set(_,ut=!0){const mt=getFluidValue(_);if(!is$1.und(mt)){const bt=getAnimated(this);if(!bt||!isEqual(mt,bt.getValue())){const St=getAnimatedType(mt);!bt||bt.constructor!=St?setAnimated(this,St.create(mt)):bt.setValue(mt),bt&&raf.batchedUpdates(()=>{this._onChange(mt,ut)})}}return getAnimated(this)}_onStart(){const _=this.animation;_.changed||(_.changed=!0,sendEvent(this,"onStart",getFinishedResult(this,checkFinished(this,_.to)),this))}_onChange(_,ut){ut||(this._onStart(),callProp(this.animation.onChange,_,this)),callProp(this.defaultProps.onChange,_,this),super._onChange(_,ut)}_start(){const _=this.animation;getAnimated(this).reset(getFluidValue(_.to)),_.immediate||(_.fromValues=_.values.map(ut=>ut.lastPosition)),isAnimating(this)||(setActiveBit(this,!0),isPaused(this)||this._resume())}_resume(){globals.skipAnimation?this.finish():frameLoop.start(this)}_stop(_,ut){if(isAnimating(this)){setActiveBit(this,!1);const mt=this.animation;each(mt.values,St=>{St.done=!0}),mt.toValues&&(mt.onChange=mt.onPause=mt.onResume=void 0),callFluidObservers(this,{type:"idle",parent:this});const bt=ut?getCancelledResult(this.get()):getFinishedResult(this.get(),checkFinished(this,_??mt.to));flushCalls(this._pendingCalls,bt),mt.changed&&(mt.changed=!1,sendEvent(this,"onRest",bt,this))}}}function checkFinished(rt,_){const ut=computeGoal(_),mt=computeGoal(rt.get());return isEqual(mt,ut)}function createLoopUpdate(rt,_=rt.loop,ut=rt.to){let mt=callProp(_);if(mt){const bt=mt!==!0&&inferTo(mt),St=(bt||rt).reverse,Mt=!bt||bt.reset;return createUpdate(_extends$1({},rt,{loop:_,default:!1,pause:void 0,to:!St||isAsyncTo(ut)?ut:void 0,from:Mt?rt.from:void 0,reset:Mt},bt))}}function createUpdate(rt){const{to:_,from:ut}=rt=inferTo(rt),mt=new Set;return is$1.obj(_)&&findDefined(_,mt),is$1.obj(ut)&&findDefined(ut,mt),rt.keys=mt.size?Array.from(mt):null,rt}function declareUpdate(rt){const _=createUpdate(rt);return is$1.und(_.default)&&(_.default=getDefaultProps(_)),_}function findDefined(rt,_){eachProp(rt,(ut,mt)=>ut!=null&&_.add(mt))}const ACTIVE_EVENTS=["onStart","onRest","onChange","onPause","onResume"];function mergeActiveFn(rt,_,ut){rt.animation[ut]=_[ut]!==getDefaultProp(_,ut)?resolveProp(_[ut],rt.key):void 0}function sendEvent(rt,_,...ut){var mt,bt,St,Mt;(mt=(bt=rt.animation)[_])==null||mt.call(bt,...ut),(St=(Mt=rt.defaultProps)[_])==null||St.call(Mt,...ut)}const BATCHED_EVENTS=["onStart","onChange","onRest"];let nextId$2=1;class Controller{constructor(_,ut){this.id=nextId$2++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),ut&&(this._flush=ut),_&&this.start(_extends$1({default:!0},_))}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(_=>_.idle&&!_.isDelayed&&!_.isPaused)}get item(){return this._item}set item(_){this._item=_}get(){const _={};return this.each((ut,mt)=>_[mt]=ut.get()),_}set(_){for(const ut in _){const mt=_[ut];is$1.und(mt)||this.springs[ut].set(mt)}}update(_){return _&&this.queue.push(createUpdate(_)),this}start(_){let{queue:ut}=this;return _?ut=toArray$3(_).map(createUpdate):this.queue=[],this._flush?this._flush(this,ut):(prepareKeys(this,ut),flushUpdateQueue(this,ut))}stop(_,ut){if(_!==!!_&&(ut=_),ut){const mt=this.springs;each(toArray$3(ut),bt=>mt[bt].stop(!!_))}else stopAsync(this._state,this._lastAsyncId),this.each(mt=>mt.stop(!!_));return this}pause(_){if(is$1.und(_))this.start({pause:!0});else{const ut=this.springs;each(toArray$3(_),mt=>ut[mt].pause())}return this}resume(_){if(is$1.und(_))this.start({pause:!1});else{const ut=this.springs;each(toArray$3(_),mt=>ut[mt].resume())}return this}each(_){eachProp(this.springs,_)}_onFrame(){const{onStart:_,onChange:ut,onRest:mt}=this._events,bt=this._active.size>0,St=this._changed.size>0;(bt&&!this._started||St&&!this._started)&&(this._started=!0,flush(_,([Ut,Ht])=>{Ht.value=this.get(),Ut(Ht,this,this._item)}));const Mt=!bt&&this._started,Bt=St||Mt&&mt.size?this.get():null;St&&ut.size&&flush(ut,([Ut,Ht])=>{Ht.value=Bt,Ut(Ht,this,this._item)}),Mt&&(this._started=!1,flush(mt,([Ut,Ht])=>{Ht.value=Bt,Ut(Ht,this,this._item)}))}eventObserved(_){if(_.type=="change")this._changed.add(_.parent),_.idle||this._active.add(_.parent);else if(_.type=="idle")this._active.delete(_.parent);else return;raf.onFrame(this._onFrame)}}function flushUpdateQueue(rt,_){return Promise.all(_.map(ut=>flushUpdate(rt,ut))).then(ut=>getCombinedResult(rt,ut))}async function flushUpdate(rt,_,ut){const{keys:mt,to:bt,from:St,loop:Mt,onRest:Bt,onResolve:Ut}=_,Ht=is$1.obj(_.default)&&_.default;Mt&&(_.loop=!1),bt===!1&&(_.to=null),St===!1&&(_.from=null);const tr=is$1.arr(bt)||is$1.fun(bt)?bt:void 0;tr?(_.to=void 0,_.onRest=void 0,Ht&&(Ht.onRest=void 0)):each(BATCHED_EVENTS,Ar=>{const _r=_[Ar];if(is$1.fun(_r)){const Dr=rt._events[Ar];_[Ar]=({finished:$r,cancelled:Br})=>{const Jr=Dr.get(_r);Jr?($r||(Jr.finished=!1),Br&&(Jr.cancelled=!0)):Dr.set(_r,{value:null,finished:$r||!1,cancelled:Br||!1})},Ht&&(Ht[Ar]=_[Ar])}});const rr=rt._state;_.pause===!rr.paused?(rr.paused=_.pause,flushCalls(_.pause?rr.pauseQueue:rr.resumeQueue)):rr.paused&&(_.pause=!0);const sr=(mt||Object.keys(rt.springs)).map(Ar=>rt.springs[Ar].start(_)),ar=_.cancel===!0||getDefaultProp(_,"cancel")===!0;(tr||ar&&rr.asyncId)&&sr.push(scheduleProps(++rt._lastAsyncId,{props:_,state:rr,actions:{pause:noop$3,resume:noop$3,start(Ar,_r){ar?(stopAsync(rr,rt._lastAsyncId),_r(getCancelledResult(rt))):(Ar.onRest=Bt,_r(runAsync(tr,Ar,rr,rt)))}}})),rr.paused&&await new Promise(Ar=>{rr.resumeQueue.add(Ar)});const cr=getCombinedResult(rt,await Promise.all(sr));if(Mt&&cr.finished&&!(ut&&cr.noop)){const Ar=createLoopUpdate(_,Mt,bt);if(Ar)return prepareKeys(rt,[Ar]),flushUpdate(rt,Ar,!0)}return Ut&&raf.batchedUpdates(()=>Ut(cr,rt,rt.item)),cr}function getSprings(rt,_){const ut=_extends$1({},rt.springs);return _&&each(toArray$3(_),mt=>{is$1.und(mt.keys)&&(mt=createUpdate(mt)),is$1.obj(mt.to)||(mt=_extends$1({},mt,{to:void 0})),prepareSprings(ut,mt,bt=>createSpring(bt))}),setSprings(rt,ut),ut}function setSprings(rt,_){eachProp(_,(ut,mt)=>{rt.springs[mt]||(rt.springs[mt]=ut,addFluidObserver(ut,rt))})}function createSpring(rt,_){const ut=new SpringValue;return ut.key=rt,_&&addFluidObserver(ut,_),ut}function prepareSprings(rt,_,ut){_.keys&&each(_.keys,mt=>{(rt[mt]||(rt[mt]=ut(mt)))._prepareNode(_)})}function prepareKeys(rt,_){each(_,ut=>{prepareSprings(rt.springs,ut,mt=>createSpring(mt,rt))})}function _objectWithoutPropertiesLoose$2(rt,_){if(rt==null)return{};var ut={},mt=Object.keys(rt),bt,St;for(St=0;St<mt.length;St++)bt=mt[St],!(_.indexOf(bt)>=0)&&(ut[bt]=rt[bt]);return ut}const _excluded$6$2=["children"],SpringContext=rt=>{let{children:_}=rt,ut=_objectWithoutPropertiesLoose$2(rt,_excluded$6$2);const mt=reactExports.useContext(ctx),bt=ut.pause||!!mt.pause,St=ut.immediate||!!mt.immediate;ut=useMemoOne(()=>({pause:bt,immediate:St}),[bt,St]);const{Provider:Mt}=ctx;return reactExports.createElement(Mt,{value:ut},_)},ctx=makeContext(SpringContext,{});SpringContext.Provider=ctx.Provider;SpringContext.Consumer=ctx.Consumer;function makeContext(rt,_){return Object.assign(rt,reactExports.createContext(_)),rt.Provider._context=rt,rt.Consumer._context=rt,rt}const SpringRef=()=>{const rt=[],_=function(bt){deprecateDirectCall();const St=[];return each(rt,(Mt,Bt)=>{if(is$1.und(bt))St.push(Mt.start());else{const Ut=ut(bt,Mt,Bt);Ut&&St.push(Mt.start(Ut))}}),St};_.current=rt,_.add=function(mt){rt.includes(mt)||rt.push(mt)},_.delete=function(mt){const bt=rt.indexOf(mt);~bt&&rt.splice(bt,1)},_.pause=function(){return each(rt,mt=>mt.pause(...arguments)),this},_.resume=function(){return each(rt,mt=>mt.resume(...arguments)),this},_.set=function(mt){each(rt,bt=>bt.set(mt))},_.start=function(mt){const bt=[];return each(rt,(St,Mt)=>{if(is$1.und(mt))bt.push(St.start());else{const Bt=this._getProps(mt,St,Mt);Bt&&bt.push(St.start(Bt))}}),bt},_.stop=function(){return each(rt,mt=>mt.stop(...arguments)),this},_.update=function(mt){return each(rt,(bt,St)=>bt.update(this._getProps(mt,bt,St))),this};const ut=function(bt,St,Mt){return is$1.fun(bt)?bt(Mt,St):bt};return _._getProps=ut,_};function useSprings(rt,_,ut){const mt=is$1.fun(_)&&_;mt&&!ut&&(ut=[]);const bt=reactExports.useMemo(()=>mt||arguments.length==3?SpringRef():void 0,[]),St=reactExports.useRef(0),Mt=useForceUpdate(),Bt=reactExports.useMemo(()=>({ctrls:[],queue:[],flush(Dr,$r){const Br=getSprings(Dr,$r);return St.current>0&&!Bt.queue.length&&!Object.keys(Br).some(mn=>!Dr.springs[mn])?flushUpdateQueue(Dr,$r):new Promise(mn=>{setSprings(Dr,Br),Bt.queue.push(()=>{mn(flushUpdateQueue(Dr,$r))}),Mt()})}}),[]),Ut=reactExports.useRef([...Bt.ctrls]),Ht=[],tr=usePrev(rt)||0;reactExports.useMemo(()=>{each(Ut.current.slice(rt,tr),Dr=>{detachRefs(Dr,bt),Dr.stop(!0)}),Ut.current.length=rt,rr(tr,rt)},[rt]),reactExports.useMemo(()=>{rr(0,Math.min(tr,rt))},ut);function rr(Dr,$r){for(let Br=Dr;Br<$r;Br++){const Jr=Ut.current[Br]||(Ut.current[Br]=new Controller(null,Bt.flush)),mn=mt?mt(Br,Jr):_[Br];mn&&(Ht[Br]=declareUpdate(mn))}}const sr=Ut.current.map((Dr,$r)=>getSprings(Dr,Ht[$r])),ar=reactExports.useContext(SpringContext),cr=usePrev(ar),Ar=ar!==cr&&hasProps(ar);useIsomorphicLayoutEffect$1(()=>{St.current++,Bt.ctrls=Ut.current;const{queue:Dr}=Bt;Dr.length&&(Bt.queue=[],each(Dr,$r=>$r())),each(Ut.current,($r,Br)=>{bt==null||bt.add($r),Ar&&$r.start({default:ar});const Jr=Ht[Br];Jr&&(replaceRef($r,Jr.ref),$r.ref?$r.queue.push(Jr):$r.start(Jr))})}),useOnce(()=>()=>{each(Bt.ctrls,Dr=>Dr.stop(!0))});const _r=sr.map(Dr=>_extends$1({},Dr));return bt?[_r,bt]:_r}function useSpring(rt,_){const ut=is$1.fun(rt),[[mt],bt]=useSprings(1,ut?rt:[rt],ut?[]:_);return ut||arguments.length==2?[mt,bt]:mt}let TransitionPhase;(function(rt){rt.MOUNT="mount",rt.ENTER="enter",rt.UPDATE="update",rt.LEAVE="leave"})(TransitionPhase||(TransitionPhase={}));let Interpolation$1=class extends FrameValue{constructor(_,ut){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=_,this.calc=createInterpolator(...ut);const mt=this._get(),bt=getAnimatedType(mt);setAnimated(this,bt.create(mt))}advance(_){const ut=this._get(),mt=this.get();isEqual(ut,mt)||(getAnimated(this).setValue(ut),this._onChange(ut,this.idle)),!this.idle&&checkIdle(this._active)&&becomeIdle(this)}_get(){const _=is$1.arr(this.source)?this.source.map(getFluidValue):toArray$3(getFluidValue(this.source));return this.calc(..._)}_start(){this.idle&&!checkIdle(this._active)&&(this.idle=!1,each(getPayload(this),_=>{_.done=!1}),globals.skipAnimation?(raf.batchedUpdates(()=>this.advance()),becomeIdle(this)):frameLoop.start(this))}_attach(){let _=1;each(toArray$3(this.source),ut=>{hasFluidValue(ut)&&addFluidObserver(ut,this),isFrameValue(ut)&&(ut.idle||this._active.add(ut),_=Math.max(_,ut.priority+1))}),this.priority=_,this._start()}_detach(){each(toArray$3(this.source),_=>{hasFluidValue(_)&&removeFluidObserver(_,this)}),this._active.clear(),becomeIdle(this)}eventObserved(_){_.type=="change"?_.idle?this.advance():(this._active.add(_.parent),this._start()):_.type=="idle"?this._active.delete(_.parent):_.type=="priority"&&(this.priority=toArray$3(this.source).reduce((ut,mt)=>Math.max(ut,(isFrameValue(mt)?mt.priority:0)+1),0))}};function isIdle(rt){return rt.idle!==!1}function checkIdle(rt){return!rt.size||Array.from(rt).every(isIdle)}function becomeIdle(rt){rt.idle||(rt.idle=!0,each(getPayload(rt),_=>{_.done=!0}),callFluidObservers(rt,{type:"idle",parent:rt}))}globals.assign({createStringInterpolator,to:(rt,_)=>new Interpolation$1(rt,_)});const primitives=["primitive"].concat(Object.keys(THREE).filter(rt=>/^[A-Z]/.test(rt)).map(rt=>rt[0].toLowerCase()+rt.slice(1)));globals.assign({createStringInterpolator,colors,frameLoop:"demand"});addEffect(()=>{raf.advance()});const host=createHost(primitives,{applyAnimatedValues:applyProps}),animated=host.animated,subscribeWithSelector=rt=>(_,ut,mt)=>{const bt=mt.subscribe;return mt.subscribe=(Mt,Bt,Ut)=>{let Ht=Mt;if(Bt){const tr=(Ut==null?void 0:Ut.equalityFn)||Object.is;let rr=Mt(mt.getState());Ht=sr=>{const ar=Mt(sr);if(!tr(rr,ar)){const cr=rr;Bt(rr=ar,cr)}},Ut!=null&&Ut.fireImmediately&&Bt(rr,rr)}return bt(Ht)},rt(_,ut,mt)};function toTrianglesDrawMode(rt,_){if(_===TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),rt;if(_===TriangleFanDrawMode||_===TriangleStripDrawMode){let ut=rt.getIndex();if(ut===null){const Mt=[],Bt=rt.getAttribute("position");if(Bt!==void 0){for(let Ut=0;Ut<Bt.count;Ut++)Mt.push(Ut);rt.setIndex(Mt),ut=rt.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),rt}const mt=ut.count-2,bt=[];if(ut)if(_===TriangleFanDrawMode)for(let Mt=1;Mt<=mt;Mt++)bt.push(ut.getX(0)),bt.push(ut.getX(Mt)),bt.push(ut.getX(Mt+1));else for(let Mt=0;Mt<mt;Mt++)Mt%2===0?(bt.push(ut.getX(Mt)),bt.push(ut.getX(Mt+1)),bt.push(ut.getX(Mt+2))):(bt.push(ut.getX(Mt+2)),bt.push(ut.getX(Mt+1)),bt.push(ut.getX(Mt)));bt.length/3!==mt&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const St=rt.clone();return St.setIndex(bt),St.clearGroups(),St}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_),rt}const version$1=parseInt(REVISION.replace(/\D+/g,""));var u8=Uint8Array,u16=Uint16Array,u32=Uint32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(rt,_){for(var ut=new u16(31),mt=0;mt<31;++mt)ut[mt]=_+=1<<rt[mt-1];for(var bt=new u32(ut[30]),mt=1;mt<30;++mt)for(var St=ut[mt];St<ut[mt+1];++St)bt[St]=St-ut[mt]<<5|mt;return[ut,bt]},_a$1=freb(fleb,2),fl$1=_a$1[0],revfl=_a$1[1];fl$1[28]=258,revfl[258]=28;var _b$1=freb(fdeb,0),fd$1=_b$1[0],rev=new u16(32768);for(var i$5=0;i$5<32768;++i$5){var x$2=(i$5&43690)>>>1|(i$5&21845)<<1;x$2=(x$2&52428)>>>2|(x$2&13107)<<2,x$2=(x$2&61680)>>>4|(x$2&3855)<<4,rev[i$5]=((x$2&65280)>>>8|(x$2&255)<<8)>>>1}var hMap=function(rt,_,ut){for(var mt=rt.length,bt=0,St=new u16(_);bt<mt;++bt)++St[rt[bt]-1];var Mt=new u16(_);for(bt=0;bt<_;++bt)Mt[bt]=Mt[bt-1]+St[bt-1]<<1;var Bt;if(ut){Bt=new u16(1<<_);var Ut=15-_;for(bt=0;bt<mt;++bt)if(rt[bt])for(var Ht=bt<<4|rt[bt],tr=_-rt[bt],rr=Mt[rt[bt]-1]++<<tr,sr=rr|(1<<tr)-1;rr<=sr;++rr)Bt[rev[rr]>>>Ut]=Ht}else for(Bt=new u16(mt),bt=0;bt<mt;++bt)rt[bt]&&(Bt[bt]=rev[Mt[rt[bt]-1]++]>>>15-rt[bt]);return Bt},flt=new u8(288);for(var i$5=0;i$5<144;++i$5)flt[i$5]=8;for(var i$5=144;i$5<256;++i$5)flt[i$5]=9;for(var i$5=256;i$5<280;++i$5)flt[i$5]=7;for(var i$5=280;i$5<288;++i$5)flt[i$5]=8;var fdt=new u8(32);for(var i$5=0;i$5<32;++i$5)fdt[i$5]=5;var flrm=hMap(flt,9,1),fdrm=hMap(fdt,5,1),max$1=function(rt){for(var _=rt[0],ut=1;ut<rt.length;++ut)rt[ut]>_&&(_=rt[ut]);return _},bits=function(rt,_,ut){var mt=_/8|0;return(rt[mt]|rt[mt+1]<<8)>>(_&7)&ut},bits16=function(rt,_){var ut=_/8|0;return(rt[ut]|rt[ut+1]<<8|rt[ut+2]<<16)>>(_&7)},shft=function(rt){return(rt/8|0)+(rt&7&&1)},slc=function(rt,_,ut){(ut==null||ut>rt.length)&&(ut=rt.length);var mt=new(rt instanceof u16?u16:rt instanceof u32?u32:u8)(ut-_);return mt.set(rt.subarray(_,ut)),mt},inflt=function(rt,_,ut){var mt=rt.length;if(!mt||ut&&!ut.l&&mt<5)return _||new u8(0);var bt=!_||ut,St=!ut||ut.i;ut||(ut={}),_||(_=new u8(mt*3));var Mt=function(mu){var pu=_.length;if(mu>pu){var Zu=new u8(Math.max(pu*2,mu));Zu.set(_),_=Zu}},Bt=ut.f||0,Ut=ut.p||0,Ht=ut.b||0,tr=ut.l,rr=ut.d,sr=ut.m,ar=ut.n,cr=mt*8;do{if(!tr){ut.f=Bt=bits(rt,Ut,1);var Ar=bits(rt,Ut+1,3);if(Ut+=3,Ar)if(Ar==1)tr=flrm,rr=fdrm,sr=9,ar=5;else if(Ar==2){var Br=bits(rt,Ut,31)+257,Jr=bits(rt,Ut+10,15)+4,mn=Br+bits(rt,Ut+5,31)+1;Ut+=14;for(var Mn=new u8(mn),$n=new u8(19),en=0;en<Jr;++en)$n[clim[en]]=bits(rt,Ut+en*3,7);Ut+=Jr*3;for(var In=max$1($n),Rn=(1<<In)-1,qn=hMap($n,In,1),en=0;en<mn;){var Qn=qn[bits(rt,Ut,Rn)];Ut+=Qn&15;var _r=Qn>>>4;if(_r<16)Mn[en++]=_r;else{var xs=0,cs=0;for(_r==16?(cs=3+bits(rt,Ut,3),Ut+=2,xs=Mn[en-1]):_r==17?(cs=3+bits(rt,Ut,7),Ut+=3):_r==18&&(cs=11+bits(rt,Ut,127),Ut+=7);cs--;)Mn[en++]=xs}}var ks=Mn.subarray(0,Br),_o=Mn.subarray(Br);sr=max$1(ks),ar=max$1(_o),tr=hMap(ks,sr,1),rr=hMap(_o,ar,1)}else throw"invalid block type";else{var _r=shft(Ut)+4,Dr=rt[_r-4]|rt[_r-3]<<8,$r=_r+Dr;if($r>mt){if(St)throw"unexpected EOF";break}bt&&Mt(Ht+Dr),_.set(rt.subarray(_r,$r),Ht),ut.b=Ht+=Dr,ut.p=Ut=$r*8;continue}if(Ut>cr){if(St)throw"unexpected EOF";break}}bt&&Mt(Ht+131072);for(var qs=(1<<sr)-1,Ss=(1<<ar)-1,eo=Ut;;eo=Ut){var xs=tr[bits16(rt,Ut)&qs],Ao=xs>>>4;if(Ut+=xs&15,Ut>cr){if(St)throw"unexpected EOF";break}if(!xs)throw"invalid length/literal";if(Ao<256)_[Ht++]=Ao;else if(Ao==256){eo=Ut,tr=null;break}else{var Oo=Ao-254;if(Ao>264){var en=Ao-257,uo=fleb[en];Oo=bits(rt,Ut,(1<<uo)-1)+fl$1[en],Ut+=uo}var uu=rr[bits16(rt,Ut)&Ss],cu=uu>>>4;if(!uu)throw"invalid distance";Ut+=uu&15;var _o=fd$1[cu];if(cu>3){var uo=fdeb[cu];_o+=bits16(rt,Ut)&(1<<uo)-1,Ut+=uo}if(Ut>cr){if(St)throw"unexpected EOF";break}bt&&Mt(Ht+131072);for(var Jl=Ht+Oo;Ht<Jl;Ht+=4)_[Ht]=_[Ht-_o],_[Ht+1]=_[Ht+1-_o],_[Ht+2]=_[Ht+2-_o],_[Ht+3]=_[Ht+3-_o];Ht=Jl}}ut.l=tr,ut.p=eo,ut.b=Ht,tr&&(Bt=1,ut.m=sr,ut.d=rr,ut.n=ar)}while(!Bt);return Ht==_.length?_:slc(_,0,Ht)},et$1=new u8(0),zlv=function(rt){if((rt[0]&15)!=8||rt[0]>>>4>7||(rt[0]<<8|rt[1])%31)throw"invalid zlib data";if(rt[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function unzlibSync(rt,_){return inflt((zlv(rt),rt.subarray(2,-4)),_)}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et$1,{stream:!0}),tds=1}catch(rt){}var __defProp$1=Object.defineProperty,__defNormalProp$1=(rt,_,ut)=>_ in rt?__defProp$1(rt,_,{enumerable:!0,configurable:!0,writable:!0,value:ut}):rt[_]=ut,__publicField$1=(rt,_,ut)=>(__defNormalProp$1(rt,typeof _!="symbol"?_+"":_,ut),ut);const SkyShader={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Vector3},up:{value:new Vector3(0,1,0)}},vertexShader:`
      uniform vec3 sunPosition;
      uniform float rayleigh;
      uniform float turbidity;
      uniform float mieCoefficient;
      uniform vec3 up;

      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      // constants for atmospheric scattering
      const float e = 2.71828182845904523536028747135266249775724709369995957;
      const float pi = 3.141592653589793238462643383279502884197169;

      // wavelength of used primaries, according to preetham
      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

      // mie stuff
      // K coefficient for the primaries
      const float v = 4.0;
      const vec3 K = vec3( 0.686, 0.678, 0.666 );
      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

      // earth shadow hack
      // cutoffAngle = pi / 1.95;
      const float cutoffAngle = 1.6110731556870734;
      const float steepness = 1.5;
      const float EE = 1000.0;

      float sunIntensity( float zenithAngleCos ) {
        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
      }

      vec3 totalMie( float T ) {
        float c = ( 0.2 * T ) * 10E-18;
        return 0.434 * c * MieConst;
      }

      void main() {

        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
        vWorldPosition = worldPosition.xyz;

        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        gl_Position.z = gl_Position.w; // set z to camera.far

        vSunDirection = normalize( sunPosition );

        vSunE = sunIntensity( dot( vSunDirection, up ) );

        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

      // extinction (absorbtion + out scattering)
      // rayleigh coefficients
        vBetaR = totalRayleigh * rayleighCoefficient;

      // mie coefficients
        vBetaM = totalMie( turbidity ) * mieCoefficient;

      }
    `,fragmentShader:`
      varying vec3 vWorldPosition;
      varying vec3 vSunDirection;
      varying float vSunfade;
      varying vec3 vBetaR;
      varying vec3 vBetaM;
      varying float vSunE;

      uniform float mieDirectionalG;
      uniform vec3 up;

      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );

      // constants for atmospheric scattering
      const float pi = 3.141592653589793238462643383279502884197169;

      const float n = 1.0003; // refractive index of air
      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

      // optical length at zenith for molecules
      const float rayleighZenithLength = 8.4E3;
      const float mieZenithLength = 1.25E3;
      // 66 arc seconds -> degrees, and the cosine of that
      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

      // 3.0 / ( 16.0 * pi )
      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
      // 1.0 / ( 4.0 * pi )
      const float ONE_OVER_FOURPI = 0.07957747154594767;

      float rayleighPhase( float cosTheta ) {
        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
      }

      float hgPhase( float cosTheta, float g ) {
        float g2 = pow( g, 2.0 );
        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
      }

      void main() {

        vec3 direction = normalize( vWorldPosition - cameraPos );

      // optical length
      // cutoff angle at 90 to avoid singularity in next formula.
        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
        float sR = rayleighZenithLength * inverse;
        float sM = mieZenithLength * inverse;

      // combined extinction factor
        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

      // in scattering
        float cosTheta = dot( direction, vSunDirection );

        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
        vec3 betaRTheta = vBetaR * rPhase;

        float mPhase = hgPhase( cosTheta, mieDirectionalG );
        vec3 betaMTheta = vBetaM * mPhase;

        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

      // nightsky
        float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
        float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
        vec3 L0 = vec3( 0.1 ) * Fex;

      // composition + solar disc
        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

        gl_FragColor = vec4( retColor, 1.0 );

      #include <tonemapping_fragment>
      #include <${version$1>=154?"colorspace_fragment":"encodings_fragment"}>

      }
    `},material=new ShaderMaterial({name:"SkyShader",fragmentShader:SkyShader.fragmentShader,vertexShader:SkyShader.vertexShader,uniforms:UniformsUtils.clone(SkyShader.uniforms),side:BackSide,depthWrite:!1});let Sky$1=class extends Mesh{constructor(){super(new BoxGeometry(1,1,1),material)}};__publicField$1(Sky$1,"SkyShader",SkyShader);__publicField$1(Sky$1,"material",material);const isCubeTexture=rt=>rt&&rt.isCubeTexture;class GroundProjectedEnv extends Mesh{constructor(_,ut){var mt,bt;const St=isCubeTexture(_),Bt=((bt=St?(mt=_.image[0])==null?void 0:mt.width:_.image.width)!=null?bt:1024)/4,Ut=Math.floor(Math.log2(Bt)),Ht=Math.pow(2,Ut),tr=3*Math.max(Ht,16*7),rr=4*Ht,sr=[St?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/tr}`,`#define CUBEUV_TEXEL_HEIGHT ${1/rr}`,`#define CUBEUV_MAX_MIP ${Ut}.0`],ar=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,cr=sr.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${parseInt(REVISION.replace(/\D+/g,""))>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,Ar={map:{value:_},height:{value:(ut==null?void 0:ut.height)||15},radius:{value:(ut==null?void 0:ut.radius)||100}},_r=new IcosahedronGeometry(1,16),Dr=new ShaderMaterial({uniforms:Ar,fragmentShader:cr,vertexShader:ar,side:DoubleSide});super(_r,Dr)}set radius(_){this.material.uniforms.radius.value=_}get radius(){return this.material.uniforms.radius.value}set height(_){this.material.uniforms.height.value=_}get height(){return this.material.uniforms.height.value}}function retarget(rt,_,ut={}){const mt=new Vector3,bt=new Quaternion,St=new Vector3,Mt=new Matrix4,Bt=new Matrix4,Ut=new Matrix4;ut.preserveMatrix=ut.preserveMatrix!==void 0?ut.preserveMatrix:!0,ut.preservePosition=ut.preservePosition!==void 0?ut.preservePosition:!0,ut.preserveHipPosition=ut.preserveHipPosition!==void 0?ut.preserveHipPosition:!1,ut.useTargetMatrix=ut.useTargetMatrix!==void 0?ut.useTargetMatrix:!1,ut.hip=ut.hip!==void 0?ut.hip:"hip",ut.names=ut.names||{};const Ht=_.isObject3D?_.skeleton.bones:getBones(_),tr=rt.isObject3D?rt.skeleton.bones:getBones(rt);let rr,sr,ar,cr,Ar;if(rt.isObject3D?rt.skeleton.pose():(ut.useTargetMatrix=!0,ut.preserveMatrix=!1),ut.preservePosition){Ar=[];for(let _r=0;_r<tr.length;_r++)Ar.push(tr[_r].position.clone())}if(ut.preserveMatrix){rt.updateMatrixWorld(),rt.matrixWorld.identity();for(let _r=0;_r<rt.children.length;++_r)rt.children[_r].updateMatrixWorld(!0)}if(ut.offsets){rr=[];for(let _r=0;_r<tr.length;++_r)sr=tr[_r],ar=ut.names[sr.name]||sr.name,ut.offsets[ar]&&(sr.matrix.multiply(ut.offsets[ar]),sr.matrix.decompose(sr.position,sr.quaternion,sr.scale),sr.updateMatrixWorld()),rr.push(sr.matrixWorld.clone())}for(let _r=0;_r<tr.length;++_r){if(sr=tr[_r],ar=ut.names[sr.name]||sr.name,cr=getBoneByName(ar,Ht),Ut.copy(sr.matrixWorld),cr){if(cr.updateMatrixWorld(),ut.useTargetMatrix?Bt.copy(cr.matrixWorld):(Bt.copy(rt.matrixWorld).invert(),Bt.multiply(cr.matrixWorld)),St.setFromMatrixScale(Bt),Bt.scale(St.set(1/St.x,1/St.y,1/St.z)),Ut.makeRotationFromQuaternion(bt.setFromRotationMatrix(Bt)),rt.isObject3D){const Dr=tr.indexOf(sr),$r=rr?rr[Dr]:Mt.copy(rt.skeleton.boneInverses[Dr]).invert();Ut.multiply($r)}Ut.copyPosition(Bt)}sr.parent&&sr.parent.isBone?(sr.matrix.copy(sr.parent.matrixWorld).invert(),sr.matrix.multiply(Ut)):sr.matrix.copy(Ut),ut.preserveHipPosition&&ar===ut.hip&&sr.matrix.setPosition(mt.set(0,sr.position.y,0)),sr.matrix.decompose(sr.position,sr.quaternion,sr.scale),sr.updateMatrixWorld()}if(ut.preservePosition)for(let _r=0;_r<tr.length;++_r)sr=tr[_r],ar=ut.names[sr.name]||sr.name,ar!==ut.hip&&sr.position.copy(Ar[_r]);ut.preserveMatrix&&rt.updateMatrixWorld(!0)}function retargetClip(rt,_,ut,mt={}){mt.useFirstFramePosition=mt.useFirstFramePosition!==void 0?mt.useFirstFramePosition:!1,mt.fps=mt.fps!==void 0?mt.fps:30,mt.names=mt.names||[],_.isObject3D||(_=getHelperFromSkeleton(_));const bt=Math.round(ut.duration*(mt.fps/1e3)*1e3),St=1/mt.fps,Mt=[],Bt=new AnimationMixer(_),Ut=getBones(rt.skeleton),Ht=[];let tr,rr,sr,ar,cr;Bt.clipAction(ut).play(),Bt.update(0),_.updateMatrixWorld();for(let Ar=0;Ar<bt;++Ar){const _r=Ar*St;retarget(rt,_,mt);for(let Dr=0;Dr<Ut.length;++Dr)cr=mt.names[Ut[Dr].name]||Ut[Dr].name,sr=getBoneByName(cr,_.skeleton),sr&&(rr=Ut[Dr],ar=Ht[Dr]=Ht[Dr]||{bone:rr},mt.hip===cr&&(ar.pos||(ar.pos={times:new Float32Array(bt),values:new Float32Array(bt*3)}),mt.useFirstFramePosition&&(Ar===0&&(tr=rr.position.clone()),rr.position.sub(tr)),ar.pos.times[Ar]=_r,rr.position.toArray(ar.pos.values,Ar*3)),ar.quat||(ar.quat={times:new Float32Array(bt),values:new Float32Array(bt*4)}),ar.quat.times[Ar]=_r,rr.quaternion.toArray(ar.quat.values,Ar*4));Bt.update(St),_.updateMatrixWorld()}for(let Ar=0;Ar<Ht.length;++Ar)ar=Ht[Ar],ar&&(ar.pos&&Mt.push(new VectorKeyframeTrack(".bones["+ar.bone.name+"].position",ar.pos.times,ar.pos.values)),Mt.push(new QuaternionKeyframeTrack(".bones["+ar.bone.name+"].quaternion",ar.quat.times,ar.quat.values)));return Bt.uncacheAction(ut),new AnimationClip(ut.name,-1,Mt)}function clone(rt){const _=new Map,ut=new Map,mt=rt.clone();return parallelTraverse(rt,mt,function(bt,St){_.set(St,bt),ut.set(bt,St)}),mt.traverse(function(bt){if(!bt.isSkinnedMesh)return;const St=bt,Mt=_.get(bt),Bt=Mt.skeleton.bones;St.skeleton=Mt.skeleton.clone(),St.bindMatrix.copy(Mt.bindMatrix),St.skeleton.bones=Bt.map(function(Ut){return ut.get(Ut)}),St.bind(St.skeleton,St.bindMatrix)}),mt}function getBoneByName(rt,_){for(let ut=0,mt=getBones(_);ut<mt.length;ut++)if(rt===mt[ut].name)return mt[ut]}function getBones(rt){return Array.isArray(rt)?rt:rt.bones}function getHelperFromSkeleton(rt){const _=new SkeletonHelper(rt.bones[0]);return _.skeleton=rt,_}function parallelTraverse(rt,_,ut){ut(rt,_);for(let mt=0;mt<rt.children.length;mt++)parallelTraverse(rt.children[mt],_.children[mt],ut)}const SkeletonUtils={retarget,retargetClip,clone};var __defProp=Object.defineProperty,__defNormalProp=(rt,_,ut)=>_ in rt?__defProp(rt,_,{enumerable:!0,configurable:!0,writable:!0,value:ut}):rt[_]=ut,__publicField=(rt,_,ut)=>(__defNormalProp(rt,typeof _!="symbol"?_+"":_,ut),ut);const _ray=new Ray,_plane=new Plane,TILT_LIMIT=Math.cos(70*(Math.PI/180)),moduloWrapAround=(rt,_)=>(rt%_+_)%_;let OrbitControls$1=class extends EventDispatcher{constructor(_,ut){super(),__publicField(this,"object"),__publicField(this,"domElement"),__publicField(this,"enabled",!0),__publicField(this,"target",new Vector3),__publicField(this,"minDistance",0),__publicField(this,"maxDistance",1/0),__publicField(this,"minZoom",0),__publicField(this,"maxZoom",1/0),__publicField(this,"minPolarAngle",0),__publicField(this,"maxPolarAngle",Math.PI),__publicField(this,"minAzimuthAngle",-1/0),__publicField(this,"maxAzimuthAngle",1/0),__publicField(this,"enableDamping",!1),__publicField(this,"dampingFactor",.05),__publicField(this,"enableZoom",!0),__publicField(this,"zoomSpeed",1),__publicField(this,"enableRotate",!0),__publicField(this,"rotateSpeed",1),__publicField(this,"enablePan",!0),__publicField(this,"panSpeed",1),__publicField(this,"screenSpacePanning",!0),__publicField(this,"keyPanSpeed",7),__publicField(this,"zoomToCursor",!1),__publicField(this,"autoRotate",!1),__publicField(this,"autoRotateSpeed",2),__publicField(this,"reverseOrbit",!1),__publicField(this,"reverseHorizontalOrbit",!1),__publicField(this,"reverseVerticalOrbit",!1),__publicField(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),__publicField(this,"mouseButtons",{LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN}),__publicField(this,"touches",{ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN}),__publicField(this,"target0"),__publicField(this,"position0"),__publicField(this,"zoom0"),__publicField(this,"_domElementKeyEvents",null),__publicField(this,"getPolarAngle"),__publicField(this,"getAzimuthalAngle"),__publicField(this,"setPolarAngle"),__publicField(this,"setAzimuthalAngle"),__publicField(this,"getDistance"),__publicField(this,"listenToKeyEvents"),__publicField(this,"stopListenToKeyEvents"),__publicField(this,"saveState"),__publicField(this,"reset"),__publicField(this,"update"),__publicField(this,"connect"),__publicField(this,"dispose"),this.object=_,this.domElement=ut,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>tr.phi,this.getAzimuthalAngle=()=>tr.theta,this.setPolarAngle=Kp=>{let sv=moduloWrapAround(Kp,2*Math.PI),Hv=tr.phi;Hv<0&&(Hv+=2*Math.PI),sv<0&&(sv+=2*Math.PI);let jp=Math.abs(sv-Hv);2*Math.PI-jp<jp&&(sv<Hv?sv+=2*Math.PI:Hv+=2*Math.PI),rr.phi=sv-Hv,mt.update()},this.setAzimuthalAngle=Kp=>{let sv=moduloWrapAround(Kp,2*Math.PI),Hv=tr.theta;Hv<0&&(Hv+=2*Math.PI),sv<0&&(sv+=2*Math.PI);let jp=Math.abs(sv-Hv);2*Math.PI-jp<jp&&(sv<Hv?sv+=2*Math.PI:Hv+=2*Math.PI),rr.theta=sv-Hv,mt.update()},this.getDistance=()=>mt.object.position.distanceTo(mt.target),this.listenToKeyEvents=Kp=>{Kp.addEventListener("keydown",av),this._domElementKeyEvents=Kp},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",av),this._domElementKeyEvents=null},this.saveState=()=>{mt.target0.copy(mt.target),mt.position0.copy(mt.object.position),mt.zoom0=mt.object.zoom},this.reset=()=>{mt.target.copy(mt.target0),mt.object.position.copy(mt.position0),mt.object.zoom=mt.zoom0,mt.object.updateProjectionMatrix(),mt.dispatchEvent(bt),mt.update(),Ut=Bt.NONE},this.update=(()=>{const Kp=new Vector3,sv=new Vector3(0,1,0),Hv=new Quaternion().setFromUnitVectors(_.up,sv),jp=Hv.clone().invert(),Fp=new Vector3,nv=new Quaternion,qy=2*Math.PI;return function(){const vx=mt.object.position;Hv.setFromUnitVectors(_.up,sv),jp.copy(Hv).invert(),Kp.copy(vx).sub(mt.target),Kp.applyQuaternion(Hv),tr.setFromVector3(Kp),mt.autoRotate&&Ut===Bt.NONE&&cs(Qn()),mt.enableDamping?(tr.theta+=rr.theta*mt.dampingFactor,tr.phi+=rr.phi*mt.dampingFactor):(tr.theta+=rr.theta,tr.phi+=rr.phi);let qx=mt.minAzimuthAngle,Kx=mt.maxAzimuthAngle;isFinite(qx)&&isFinite(Kx)&&(qx<-Math.PI?qx+=qy:qx>Math.PI&&(qx-=qy),Kx<-Math.PI?Kx+=qy:Kx>Math.PI&&(Kx-=qy),qx<=Kx?tr.theta=Math.max(qx,Math.min(Kx,tr.theta)):tr.theta=tr.theta>(qx+Kx)/2?Math.max(qx,tr.theta):Math.min(Kx,tr.theta)),tr.phi=Math.max(mt.minPolarAngle,Math.min(mt.maxPolarAngle,tr.phi)),tr.makeSafe(),mt.enableDamping===!0?mt.target.addScaledVector(ar,mt.dampingFactor):mt.target.add(ar),mt.zoomToCursor&&In||mt.object.isOrthographicCamera?tr.radius=uo(tr.radius):tr.radius=uo(tr.radius*sr),Kp.setFromSpherical(tr),Kp.applyQuaternion(jp),vx.copy(mt.target).add(Kp),mt.object.matrixAutoUpdate||mt.object.updateMatrix(),mt.object.lookAt(mt.target),mt.enableDamping===!0?(rr.theta*=1-mt.dampingFactor,rr.phi*=1-mt.dampingFactor,ar.multiplyScalar(1-mt.dampingFactor)):(rr.set(0,0,0),ar.set(0,0,0));let Mx=!1;if(mt.zoomToCursor&&In){let Ox=null;if(mt.object instanceof PerspectiveCamera$1&&mt.object.isPerspectiveCamera){const E2=Kp.length();Ox=uo(E2*sr);const $2=E2-Ox;mt.object.position.addScaledVector($n,$2),mt.object.updateMatrixWorld()}else if(mt.object.isOrthographicCamera){const E2=new Vector3(en.x,en.y,0);E2.unproject(mt.object),mt.object.zoom=Math.max(mt.minZoom,Math.min(mt.maxZoom,mt.object.zoom/sr)),mt.object.updateProjectionMatrix(),Mx=!0;const $2=new Vector3(en.x,en.y,0);$2.unproject(mt.object),mt.object.position.sub($2).add(E2),mt.object.updateMatrixWorld(),Ox=Kp.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),mt.zoomToCursor=!1;Ox!==null&&(mt.screenSpacePanning?mt.target.set(0,0,-1).transformDirection(mt.object.matrix).multiplyScalar(Ox).add(mt.object.position):(_ray.origin.copy(mt.object.position),_ray.direction.set(0,0,-1).transformDirection(mt.object.matrix),Math.abs(mt.object.up.dot(_ray.direction))<TILT_LIMIT?_.lookAt(mt.target):(_plane.setFromNormalAndCoplanarPoint(mt.object.up,mt.target),_ray.intersectPlane(_plane,mt.target))))}else mt.object instanceof OrthographicCamera$1&&mt.object.isOrthographicCamera&&(Mx=sr!==1,Mx&&(mt.object.zoom=Math.max(mt.minZoom,Math.min(mt.maxZoom,mt.object.zoom/sr)),mt.object.updateProjectionMatrix()));return sr=1,In=!1,Mx||Fp.distanceToSquared(mt.object.position)>Ht||8*(1-nv.dot(mt.object.quaternion))>Ht?(mt.dispatchEvent(bt),Fp.copy(mt.object.position),nv.copy(mt.object.quaternion),Mx=!1,!0):!1}})(),this.connect=Kp=>{Kp===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),mt.domElement=Kp,mt.domElement.style.touchAction="none",mt.domElement.addEventListener("contextmenu",zv),mt.domElement.addEventListener("pointerdown",jm),mt.domElement.addEventListener("pointercancel",Bp),mt.domElement.addEventListener("wheel",T0)},this.dispose=()=>{var Kp,sv,Hv,jp,Fp,nv;mt.domElement&&(mt.domElement.style.touchAction="auto"),(Kp=mt.domElement)==null||Kp.removeEventListener("contextmenu",zv),(sv=mt.domElement)==null||sv.removeEventListener("pointerdown",jm),(Hv=mt.domElement)==null||Hv.removeEventListener("pointercancel",Bp),(jp=mt.domElement)==null||jp.removeEventListener("wheel",T0),(Fp=mt.domElement)==null||Fp.ownerDocument.removeEventListener("pointermove",Nu),(nv=mt.domElement)==null||nv.ownerDocument.removeEventListener("pointerup",Co),mt._domElementKeyEvents!==null&&mt._domElementKeyEvents.removeEventListener("keydown",av)};const mt=this,bt={type:"change"},St={type:"start"},Mt={type:"end"},Bt={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let Ut=Bt.NONE;const Ht=1e-6,tr=new Spherical,rr=new Spherical;let sr=1;const ar=new Vector3,cr=new Vector2,Ar=new Vector2,_r=new Vector2,Dr=new Vector2,$r=new Vector2,Br=new Vector2,Jr=new Vector2,mn=new Vector2,Mn=new Vector2,$n=new Vector3,en=new Vector2;let In=!1;const Rn=[],qn={};function Qn(){return 2*Math.PI/60/60*mt.autoRotateSpeed}function xs(){return Math.pow(.95,mt.zoomSpeed)}function cs(Kp){mt.reverseOrbit||mt.reverseHorizontalOrbit?rr.theta+=Kp:rr.theta-=Kp}function ks(Kp){mt.reverseOrbit||mt.reverseVerticalOrbit?rr.phi+=Kp:rr.phi-=Kp}const _o=(()=>{const Kp=new Vector3;return function(Hv,jp){Kp.setFromMatrixColumn(jp,0),Kp.multiplyScalar(-Hv),ar.add(Kp)}})(),qs=(()=>{const Kp=new Vector3;return function(Hv,jp){mt.screenSpacePanning===!0?Kp.setFromMatrixColumn(jp,1):(Kp.setFromMatrixColumn(jp,0),Kp.crossVectors(mt.object.up,Kp)),Kp.multiplyScalar(Hv),ar.add(Kp)}})(),Ss=(()=>{const Kp=new Vector3;return function(Hv,jp){const Fp=mt.domElement;if(Fp&&mt.object instanceof PerspectiveCamera$1&&mt.object.isPerspectiveCamera){const nv=mt.object.position;Kp.copy(nv).sub(mt.target);let qy=Kp.length();qy*=Math.tan(mt.object.fov/2*Math.PI/180),_o(2*Hv*qy/Fp.clientHeight,mt.object.matrix),qs(2*jp*qy/Fp.clientHeight,mt.object.matrix)}else Fp&&mt.object instanceof OrthographicCamera$1&&mt.object.isOrthographicCamera?(_o(Hv*(mt.object.right-mt.object.left)/mt.object.zoom/Fp.clientWidth,mt.object.matrix),qs(jp*(mt.object.top-mt.object.bottom)/mt.object.zoom/Fp.clientHeight,mt.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),mt.enablePan=!1)}})();function eo(Kp){mt.object instanceof PerspectiveCamera$1&&mt.object.isPerspectiveCamera||mt.object instanceof OrthographicCamera$1&&mt.object.isOrthographicCamera?sr/=Kp:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),mt.enableZoom=!1)}function Ao(Kp){mt.object instanceof PerspectiveCamera$1&&mt.object.isPerspectiveCamera||mt.object instanceof OrthographicCamera$1&&mt.object.isOrthographicCamera?sr*=Kp:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),mt.enableZoom=!1)}function Oo(Kp){if(!mt.zoomToCursor||!mt.domElement)return;In=!0;const sv=mt.domElement.getBoundingClientRect(),Hv=Kp.clientX-sv.left,jp=Kp.clientY-sv.top,Fp=sv.width,nv=sv.height;en.x=Hv/Fp*2-1,en.y=-(jp/nv)*2+1,$n.set(en.x,en.y,1).unproject(mt.object).sub(mt.object.position).normalize()}function uo(Kp){return Math.max(mt.minDistance,Math.min(mt.maxDistance,Kp))}function uu(Kp){cr.set(Kp.clientX,Kp.clientY)}function cu(Kp){Oo(Kp),Jr.set(Kp.clientX,Kp.clientY)}function Jl(Kp){Dr.set(Kp.clientX,Kp.clientY)}function mu(Kp){Ar.set(Kp.clientX,Kp.clientY),_r.subVectors(Ar,cr).multiplyScalar(mt.rotateSpeed);const sv=mt.domElement;sv&&(cs(2*Math.PI*_r.x/sv.clientHeight),ks(2*Math.PI*_r.y/sv.clientHeight)),cr.copy(Ar),mt.update()}function pu(Kp){mn.set(Kp.clientX,Kp.clientY),Mn.subVectors(mn,Jr),Mn.y>0?eo(xs()):Mn.y<0&&Ao(xs()),Jr.copy(mn),mt.update()}function Zu(Kp){$r.set(Kp.clientX,Kp.clientY),Br.subVectors($r,Dr).multiplyScalar(mt.panSpeed),Ss(Br.x,Br.y),Dr.copy($r),mt.update()}function Mp(Kp){Oo(Kp),Kp.deltaY<0?Ao(xs()):Kp.deltaY>0&&eo(xs()),mt.update()}function Up(Kp){let sv=!1;switch(Kp.code){case mt.keys.UP:Ss(0,mt.keyPanSpeed),sv=!0;break;case mt.keys.BOTTOM:Ss(0,-mt.keyPanSpeed),sv=!0;break;case mt.keys.LEFT:Ss(mt.keyPanSpeed,0),sv=!0;break;case mt.keys.RIGHT:Ss(-mt.keyPanSpeed,0),sv=!0;break}sv&&(Kp.preventDefault(),mt.update())}function Ep(){if(Rn.length==1)cr.set(Rn[0].pageX,Rn[0].pageY);else{const Kp=.5*(Rn[0].pageX+Rn[1].pageX),sv=.5*(Rn[0].pageY+Rn[1].pageY);cr.set(Kp,sv)}}function mp(){if(Rn.length==1)Dr.set(Rn[0].pageX,Rn[0].pageY);else{const Kp=.5*(Rn[0].pageX+Rn[1].pageX),sv=.5*(Rn[0].pageY+Rn[1].pageY);Dr.set(Kp,sv)}}function Cp(){const Kp=Rn[0].pageX-Rn[1].pageX,sv=Rn[0].pageY-Rn[1].pageY,Hv=Math.sqrt(Kp*Kp+sv*sv);Jr.set(0,Hv)}function t0(){mt.enableZoom&&Cp(),mt.enablePan&&mp()}function _g(){mt.enableZoom&&Cp(),mt.enableRotate&&Ep()}function m0(Kp){if(Rn.length==1)Ar.set(Kp.pageX,Kp.pageY);else{const Hv=Cv(Kp),jp=.5*(Kp.pageX+Hv.x),Fp=.5*(Kp.pageY+Hv.y);Ar.set(jp,Fp)}_r.subVectors(Ar,cr).multiplyScalar(mt.rotateSpeed);const sv=mt.domElement;sv&&(cs(2*Math.PI*_r.x/sv.clientHeight),ks(2*Math.PI*_r.y/sv.clientHeight)),cr.copy(Ar)}function K0(Kp){if(Rn.length==1)$r.set(Kp.pageX,Kp.pageY);else{const sv=Cv(Kp),Hv=.5*(Kp.pageX+sv.x),jp=.5*(Kp.pageY+sv.y);$r.set(Hv,jp)}Br.subVectors($r,Dr).multiplyScalar(mt.panSpeed),Ss(Br.x,Br.y),Dr.copy($r)}function Jp(Kp){const sv=Cv(Kp),Hv=Kp.pageX-sv.x,jp=Kp.pageY-sv.y,Fp=Math.sqrt(Hv*Hv+jp*jp);mn.set(0,Fp),Mn.set(0,Math.pow(mn.y/Jr.y,mt.zoomSpeed)),eo(Mn.y),Jr.copy(mn)}function y0(Kp){mt.enableZoom&&Jp(Kp),mt.enablePan&&K0(Kp)}function z0(Kp){mt.enableZoom&&Jp(Kp),mt.enableRotate&&m0(Kp)}function jm(Kp){var sv,Hv;mt.enabled!==!1&&(Rn.length===0&&((sv=mt.domElement)==null||sv.ownerDocument.addEventListener("pointermove",Nu),(Hv=mt.domElement)==null||Hv.ownerDocument.addEventListener("pointerup",Co)),Uv(Kp),Kp.pointerType==="touch"?lv(Kp):a0(Kp))}function Nu(Kp){mt.enabled!==!1&&(Kp.pointerType==="touch"?N0(Kp):Q0(Kp))}function Co(Kp){var sv,Hv,jp;Gv(Kp),Rn.length===0&&((sv=mt.domElement)==null||sv.releasePointerCapture(Kp.pointerId),(Hv=mt.domElement)==null||Hv.ownerDocument.removeEventListener("pointermove",Nu),(jp=mt.domElement)==null||jp.ownerDocument.removeEventListener("pointerup",Co)),mt.dispatchEvent(Mt),Ut=Bt.NONE}function Bp(Kp){Gv(Kp)}function a0(Kp){let sv;switch(Kp.button){case 0:sv=mt.mouseButtons.LEFT;break;case 1:sv=mt.mouseButtons.MIDDLE;break;case 2:sv=mt.mouseButtons.RIGHT;break;default:sv=-1}switch(sv){case MOUSE.DOLLY:if(mt.enableZoom===!1)return;cu(Kp),Ut=Bt.DOLLY;break;case MOUSE.ROTATE:if(Kp.ctrlKey||Kp.metaKey||Kp.shiftKey){if(mt.enablePan===!1)return;Jl(Kp),Ut=Bt.PAN}else{if(mt.enableRotate===!1)return;uu(Kp),Ut=Bt.ROTATE}break;case MOUSE.PAN:if(Kp.ctrlKey||Kp.metaKey||Kp.shiftKey){if(mt.enableRotate===!1)return;uu(Kp),Ut=Bt.ROTATE}else{if(mt.enablePan===!1)return;Jl(Kp),Ut=Bt.PAN}break;default:Ut=Bt.NONE}Ut!==Bt.NONE&&mt.dispatchEvent(St)}function Q0(Kp){if(mt.enabled!==!1)switch(Ut){case Bt.ROTATE:if(mt.enableRotate===!1)return;mu(Kp);break;case Bt.DOLLY:if(mt.enableZoom===!1)return;pu(Kp);break;case Bt.PAN:if(mt.enablePan===!1)return;Zu(Kp);break}}function T0(Kp){mt.enabled===!1||mt.enableZoom===!1||Ut!==Bt.NONE&&Ut!==Bt.ROTATE||(Kp.preventDefault(),mt.dispatchEvent(St),Mp(Kp),mt.dispatchEvent(Mt))}function av(Kp){mt.enabled===!1||mt.enablePan===!1||Up(Kp)}function lv(Kp){switch(Dv(Kp),Rn.length){case 1:switch(mt.touches.ONE){case TOUCH.ROTATE:if(mt.enableRotate===!1)return;Ep(),Ut=Bt.TOUCH_ROTATE;break;case TOUCH.PAN:if(mt.enablePan===!1)return;mp(),Ut=Bt.TOUCH_PAN;break;default:Ut=Bt.NONE}break;case 2:switch(mt.touches.TWO){case TOUCH.DOLLY_PAN:if(mt.enableZoom===!1&&mt.enablePan===!1)return;t0(),Ut=Bt.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(mt.enableZoom===!1&&mt.enableRotate===!1)return;_g(),Ut=Bt.TOUCH_DOLLY_ROTATE;break;default:Ut=Bt.NONE}break;default:Ut=Bt.NONE}Ut!==Bt.NONE&&mt.dispatchEvent(St)}function N0(Kp){switch(Dv(Kp),Ut){case Bt.TOUCH_ROTATE:if(mt.enableRotate===!1)return;m0(Kp),mt.update();break;case Bt.TOUCH_PAN:if(mt.enablePan===!1)return;K0(Kp),mt.update();break;case Bt.TOUCH_DOLLY_PAN:if(mt.enableZoom===!1&&mt.enablePan===!1)return;y0(Kp),mt.update();break;case Bt.TOUCH_DOLLY_ROTATE:if(mt.enableZoom===!1&&mt.enableRotate===!1)return;z0(Kp),mt.update();break;default:Ut=Bt.NONE}}function zv(Kp){mt.enabled!==!1&&Kp.preventDefault()}function Uv(Kp){Rn.push(Kp)}function Gv(Kp){delete qn[Kp.pointerId];for(let sv=0;sv<Rn.length;sv++)if(Rn[sv].pointerId==Kp.pointerId){Rn.splice(sv,1);return}}function Dv(Kp){let sv=qn[Kp.pointerId];sv===void 0&&(sv=new Vector2,qn[Kp.pointerId]=sv),sv.set(Kp.pageX,Kp.pageY)}function Cv(Kp){const sv=Kp.pointerId===Rn[0].pointerId?Rn[1]:Rn[0];return qn[sv.pointerId]}ut!==void 0&&this.connect(ut),this.update()}};class GLTFLoader extends Loader{constructor(_){super(_),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(ut){return new GLTFMaterialsClearcoatExtension(ut)}),this.register(function(ut){return new GLTFTextureBasisUExtension(ut)}),this.register(function(ut){return new GLTFTextureWebPExtension(ut)}),this.register(function(ut){return new GLTFTextureAVIFExtension(ut)}),this.register(function(ut){return new GLTFMaterialsSheenExtension(ut)}),this.register(function(ut){return new GLTFMaterialsTransmissionExtension(ut)}),this.register(function(ut){return new GLTFMaterialsVolumeExtension(ut)}),this.register(function(ut){return new GLTFMaterialsIorExtension(ut)}),this.register(function(ut){return new GLTFMaterialsEmissiveStrengthExtension(ut)}),this.register(function(ut){return new GLTFMaterialsSpecularExtension(ut)}),this.register(function(ut){return new GLTFMaterialsIridescenceExtension(ut)}),this.register(function(ut){return new GLTFMaterialsAnisotropyExtension(ut)}),this.register(function(ut){return new GLTFLightsExtension(ut)}),this.register(function(ut){return new GLTFMeshoptCompression(ut)}),this.register(function(ut){return new GLTFMeshGpuInstancing(ut)})}load(_,ut,mt,bt){const St=this;let Mt;this.resourcePath!==""?Mt=this.resourcePath:this.path!==""?Mt=this.path:Mt=LoaderUtils.extractUrlBase(_),this.manager.itemStart(_);const Bt=function(Ht){bt?bt(Ht):console.error(Ht),St.manager.itemError(_),St.manager.itemEnd(_)},Ut=new FileLoader(this.manager);Ut.setPath(this.path),Ut.setResponseType("arraybuffer"),Ut.setRequestHeader(this.requestHeader),Ut.setWithCredentials(this.withCredentials),Ut.load(_,function(Ht){try{St.parse(Ht,Mt,function(tr){ut(tr),St.manager.itemEnd(_)},Bt)}catch(tr){Bt(tr)}},mt,Bt)}setDRACOLoader(_){return this.dracoLoader=_,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(_){return this.ktx2Loader=_,this}setMeshoptDecoder(_){return this.meshoptDecoder=_,this}register(_){return this.pluginCallbacks.indexOf(_)===-1&&this.pluginCallbacks.push(_),this}unregister(_){return this.pluginCallbacks.indexOf(_)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_),1),this}parse(_,ut,mt,bt){let St;const Mt={},Bt={};if(typeof _=="string")St=JSON.parse(_);else if(_ instanceof ArrayBuffer)if(LoaderUtils.decodeText(new Uint8Array(_.slice(0,4)))===BINARY_EXTENSION_HEADER_MAGIC){try{Mt[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(_)}catch(tr){bt&&bt(tr);return}St=JSON.parse(Mt[EXTENSIONS.KHR_BINARY_GLTF].content)}else St=JSON.parse(LoaderUtils.decodeText(new Uint8Array(_)));else St=_;if(St.asset===void 0||St.asset.version[0]<2){bt&&bt(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const Ut=new GLTFParser(St,{path:ut||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});Ut.fileLoader.setRequestHeader(this.requestHeader);for(let Ht=0;Ht<this.pluginCallbacks.length;Ht++){const tr=this.pluginCallbacks[Ht](Ut);Bt[tr.name]=tr,Mt[tr.name]=!0}if(St.extensionsUsed)for(let Ht=0;Ht<St.extensionsUsed.length;++Ht){const tr=St.extensionsUsed[Ht],rr=St.extensionsRequired||[];switch(tr){case EXTENSIONS.KHR_MATERIALS_UNLIT:Mt[tr]=new GLTFMaterialsUnlitExtension;break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:Mt[tr]=new GLTFDracoMeshCompressionExtension(St,this.dracoLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:Mt[tr]=new GLTFTextureTransformExtension;break;case EXTENSIONS.KHR_MESH_QUANTIZATION:Mt[tr]=new GLTFMeshQuantizationExtension;break;default:rr.indexOf(tr)>=0&&Bt[tr]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+tr+'".')}}Ut.setExtensions(Mt),Ut.setPlugins(Bt),Ut.parse(mt,bt)}parseAsync(_,ut){const mt=this;return new Promise(function(bt,St){mt.parse(_,ut,bt,St)})}}function GLTFRegistry(){let rt={};return{get:function(_){return rt[_]},add:function(_,ut){rt[_]=ut},remove:function(_){delete rt[_]},removeAll:function(){rt={}}}}const EXTENSIONS={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const _=this.parser,ut=this.parser.json.nodes||[];for(let mt=0,bt=ut.length;mt<bt;mt++){const St=ut[mt];St.extensions&&St.extensions[this.name]&&St.extensions[this.name].light!==void 0&&_._addNodeRef(this.cache,St.extensions[this.name].light)}}_loadLight(_){const ut=this.parser,mt="light:"+_;let bt=ut.cache.get(mt);if(bt)return bt;const St=ut.json,Ut=((St.extensions&&St.extensions[this.name]||{}).lights||[])[_];let Ht;const tr=new Color$1(16777215);Ut.color!==void 0&&tr.fromArray(Ut.color);const rr=Ut.range!==void 0?Ut.range:0;switch(Ut.type){case"directional":Ht=new DirectionalLight(tr),Ht.target.position.set(0,0,-1),Ht.add(Ht.target);break;case"point":Ht=new PointLight(tr),Ht.distance=rr;break;case"spot":Ht=new SpotLight(tr),Ht.distance=rr,Ut.spot=Ut.spot||{},Ut.spot.innerConeAngle=Ut.spot.innerConeAngle!==void 0?Ut.spot.innerConeAngle:0,Ut.spot.outerConeAngle=Ut.spot.outerConeAngle!==void 0?Ut.spot.outerConeAngle:Math.PI/4,Ht.angle=Ut.spot.outerConeAngle,Ht.penumbra=1-Ut.spot.innerConeAngle/Ut.spot.outerConeAngle,Ht.target.position.set(0,0,-1),Ht.add(Ht.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+Ut.type)}return Ht.position.set(0,0,0),Ht.decay=2,assignExtrasToUserData(Ht,Ut),Ut.intensity!==void 0&&(Ht.intensity=Ut.intensity),Ht.name=ut.createUniqueName(Ut.name||"light_"+_),bt=Promise.resolve(Ht),ut.cache.add(mt,bt),bt}getDependency(_,ut){if(_==="light")return this._loadLight(ut)}createNodeAttachment(_){const ut=this,mt=this.parser,St=mt.json.nodes[_],Bt=(St.extensions&&St.extensions[this.name]||{}).light;return Bt===void 0?null:this._loadLight(Bt).then(function(Ut){return mt._getNodeRef(ut.cache,Bt,Ut)})}}class GLTFMaterialsUnlitExtension{constructor(){this.name=EXTENSIONS.KHR_MATERIALS_UNLIT}getMaterialType(){return MeshBasicMaterial}extendParams(_,ut,mt){const bt=[];_.color=new Color$1(1,1,1),_.opacity=1;const St=ut.pbrMetallicRoughness;if(St){if(Array.isArray(St.baseColorFactor)){const Mt=St.baseColorFactor;_.color.fromArray(Mt),_.opacity=Mt[3]}St.baseColorTexture!==void 0&&bt.push(mt.assignTexture(_,"map",St.baseColorTexture,3001))}return Promise.all(bt)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(_,ut){const bt=this.parser.json.materials[_];if(!bt.extensions||!bt.extensions[this.name])return Promise.resolve();const St=bt.extensions[this.name].emissiveStrength;return St!==void 0&&(ut.emissiveIntensity=St),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT}getMaterialType(_){const mt=this.parser.json.materials[_];return!mt.extensions||!mt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,ut){const mt=this.parser,bt=mt.json.materials[_];if(!bt.extensions||!bt.extensions[this.name])return Promise.resolve();const St=[],Mt=bt.extensions[this.name];if(Mt.clearcoatFactor!==void 0&&(ut.clearcoat=Mt.clearcoatFactor),Mt.clearcoatTexture!==void 0&&St.push(mt.assignTexture(ut,"clearcoatMap",Mt.clearcoatTexture)),Mt.clearcoatRoughnessFactor!==void 0&&(ut.clearcoatRoughness=Mt.clearcoatRoughnessFactor),Mt.clearcoatRoughnessTexture!==void 0&&St.push(mt.assignTexture(ut,"clearcoatRoughnessMap",Mt.clearcoatRoughnessTexture)),Mt.clearcoatNormalTexture!==void 0&&(St.push(mt.assignTexture(ut,"clearcoatNormalMap",Mt.clearcoatNormalTexture)),Mt.clearcoatNormalTexture.scale!==void 0)){const Bt=Mt.clearcoatNormalTexture.scale;ut.clearcoatNormalScale=new Vector2(Bt,Bt)}return Promise.all(St)}}class GLTFMaterialsIridescenceExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_IRIDESCENCE}getMaterialType(_){const mt=this.parser.json.materials[_];return!mt.extensions||!mt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,ut){const mt=this.parser,bt=mt.json.materials[_];if(!bt.extensions||!bt.extensions[this.name])return Promise.resolve();const St=[],Mt=bt.extensions[this.name];return Mt.iridescenceFactor!==void 0&&(ut.iridescence=Mt.iridescenceFactor),Mt.iridescenceTexture!==void 0&&St.push(mt.assignTexture(ut,"iridescenceMap",Mt.iridescenceTexture)),Mt.iridescenceIor!==void 0&&(ut.iridescenceIOR=Mt.iridescenceIor),ut.iridescenceThicknessRange===void 0&&(ut.iridescenceThicknessRange=[100,400]),Mt.iridescenceThicknessMinimum!==void 0&&(ut.iridescenceThicknessRange[0]=Mt.iridescenceThicknessMinimum),Mt.iridescenceThicknessMaximum!==void 0&&(ut.iridescenceThicknessRange[1]=Mt.iridescenceThicknessMaximum),Mt.iridescenceThicknessTexture!==void 0&&St.push(mt.assignTexture(ut,"iridescenceThicknessMap",Mt.iridescenceThicknessTexture)),Promise.all(St)}}class GLTFMaterialsSheenExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_SHEEN}getMaterialType(_){const mt=this.parser.json.materials[_];return!mt.extensions||!mt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,ut){const mt=this.parser,bt=mt.json.materials[_];if(!bt.extensions||!bt.extensions[this.name])return Promise.resolve();const St=[];ut.sheenColor=new Color$1(0,0,0),ut.sheenRoughness=0,ut.sheen=1;const Mt=bt.extensions[this.name];return Mt.sheenColorFactor!==void 0&&ut.sheenColor.fromArray(Mt.sheenColorFactor),Mt.sheenRoughnessFactor!==void 0&&(ut.sheenRoughness=Mt.sheenRoughnessFactor),Mt.sheenColorTexture!==void 0&&St.push(mt.assignTexture(ut,"sheenColorMap",Mt.sheenColorTexture,3001)),Mt.sheenRoughnessTexture!==void 0&&St.push(mt.assignTexture(ut,"sheenRoughnessMap",Mt.sheenRoughnessTexture)),Promise.all(St)}}class GLTFMaterialsTransmissionExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION}getMaterialType(_){const mt=this.parser.json.materials[_];return!mt.extensions||!mt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,ut){const mt=this.parser,bt=mt.json.materials[_];if(!bt.extensions||!bt.extensions[this.name])return Promise.resolve();const St=[],Mt=bt.extensions[this.name];return Mt.transmissionFactor!==void 0&&(ut.transmission=Mt.transmissionFactor),Mt.transmissionTexture!==void 0&&St.push(mt.assignTexture(ut,"transmissionMap",Mt.transmissionTexture)),Promise.all(St)}}class GLTFMaterialsVolumeExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_VOLUME}getMaterialType(_){const mt=this.parser.json.materials[_];return!mt.extensions||!mt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,ut){const mt=this.parser,bt=mt.json.materials[_];if(!bt.extensions||!bt.extensions[this.name])return Promise.resolve();const St=[],Mt=bt.extensions[this.name];ut.thickness=Mt.thicknessFactor!==void 0?Mt.thicknessFactor:0,Mt.thicknessTexture!==void 0&&St.push(mt.assignTexture(ut,"thicknessMap",Mt.thicknessTexture)),ut.attenuationDistance=Mt.attenuationDistance||1/0;const Bt=Mt.attenuationColor||[1,1,1];return ut.attenuationColor=new Color$1(Bt[0],Bt[1],Bt[2]),Promise.all(St)}}class GLTFMaterialsIorExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_IOR}getMaterialType(_){const mt=this.parser.json.materials[_];return!mt.extensions||!mt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,ut){const bt=this.parser.json.materials[_];if(!bt.extensions||!bt.extensions[this.name])return Promise.resolve();const St=bt.extensions[this.name];return ut.ior=St.ior!==void 0?St.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_SPECULAR}getMaterialType(_){const mt=this.parser.json.materials[_];return!mt.extensions||!mt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,ut){const mt=this.parser,bt=mt.json.materials[_];if(!bt.extensions||!bt.extensions[this.name])return Promise.resolve();const St=[],Mt=bt.extensions[this.name];ut.specularIntensity=Mt.specularFactor!==void 0?Mt.specularFactor:1,Mt.specularTexture!==void 0&&St.push(mt.assignTexture(ut,"specularIntensityMap",Mt.specularTexture));const Bt=Mt.specularColorFactor||[1,1,1];return ut.specularColor=new Color$1(Bt[0],Bt[1],Bt[2]),Mt.specularColorTexture!==void 0&&St.push(mt.assignTexture(ut,"specularColorMap",Mt.specularColorTexture,3001)),Promise.all(St)}}class GLTFMaterialsAnisotropyExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_MATERIALS_ANISOTROPY}getMaterialType(_){const mt=this.parser.json.materials[_];return!mt.extensions||!mt.extensions[this.name]?null:MeshPhysicalMaterial}extendMaterialParams(_,ut){const mt=this.parser,bt=mt.json.materials[_];if(!bt.extensions||!bt.extensions[this.name])return Promise.resolve();const St=[],Mt=bt.extensions[this.name];return Mt.anisotropyStrength!==void 0&&(ut.anisotropy=Mt.anisotropyStrength),Mt.anisotropyRotation!==void 0&&(ut.anisotropyRotation=Mt.anisotropyRotation),Mt.anisotropyTexture!==void 0&&St.push(mt.assignTexture(ut,"anisotropyMap",Mt.anisotropyTexture)),Promise.all(St)}}class GLTFTextureBasisUExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.KHR_TEXTURE_BASISU}loadTexture(_){const ut=this.parser,mt=ut.json,bt=mt.textures[_];if(!bt.extensions||!bt.extensions[this.name])return null;const St=bt.extensions[this.name],Mt=ut.options.ktx2Loader;if(!Mt){if(mt.extensionsRequired&&mt.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return ut.loadTextureImage(_,St.source,Mt)}}class GLTFTextureWebPExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(_){const ut=this.name,mt=this.parser,bt=mt.json,St=bt.textures[_];if(!St.extensions||!St.extensions[ut])return null;const Mt=St.extensions[ut],Bt=bt.images[Mt.source];let Ut=mt.textureLoader;if(Bt.uri){const Ht=mt.options.manager.getHandler(Bt.uri);Ht!==null&&(Ut=Ht)}return this.detectSupport().then(function(Ht){if(Ht)return mt.loadTextureImage(_,Mt.source,Ut);if(bt.extensionsRequired&&bt.extensionsRequired.indexOf(ut)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return mt.loadTexture(_)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_){const ut=new Image;ut.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",ut.onload=ut.onerror=function(){_(ut.height===1)}})),this.isSupported}}class GLTFTextureAVIFExtension{constructor(_){this.parser=_,this.name=EXTENSIONS.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(_){const ut=this.name,mt=this.parser,bt=mt.json,St=bt.textures[_];if(!St.extensions||!St.extensions[ut])return null;const Mt=St.extensions[ut],Bt=bt.images[Mt.source];let Ut=mt.textureLoader;if(Bt.uri){const Ht=mt.options.manager.getHandler(Bt.uri);Ht!==null&&(Ut=Ht)}return this.detectSupport().then(function(Ht){if(Ht)return mt.loadTextureImage(_,Mt.source,Ut);if(bt.extensionsRequired&&bt.extensionsRequired.indexOf(ut)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return mt.loadTexture(_)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_){const ut=new Image;ut.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",ut.onload=ut.onerror=function(){_(ut.height===1)}})),this.isSupported}}class GLTFMeshoptCompression{constructor(_){this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION,this.parser=_}loadBufferView(_){const ut=this.parser.json,mt=ut.bufferViews[_];if(mt.extensions&&mt.extensions[this.name]){const bt=mt.extensions[this.name],St=this.parser.getDependency("buffer",bt.buffer),Mt=this.parser.options.meshoptDecoder;if(!Mt||!Mt.supported){if(ut.extensionsRequired&&ut.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return St.then(function(Bt){const Ut=bt.byteOffset||0,Ht=bt.byteLength||0,tr=bt.count,rr=bt.byteStride,sr=new Uint8Array(Bt,Ut,Ht);return Mt.decodeGltfBufferAsync?Mt.decodeGltfBufferAsync(tr,rr,sr,bt.mode,bt.filter).then(function(ar){return ar.buffer}):Mt.ready.then(function(){const ar=new ArrayBuffer(tr*rr);return Mt.decodeGltfBuffer(new Uint8Array(ar),tr,rr,sr,bt.mode,bt.filter),ar})})}else return null}}class GLTFMeshGpuInstancing{constructor(_){this.name=EXTENSIONS.EXT_MESH_GPU_INSTANCING,this.parser=_}createNodeMesh(_){const ut=this.parser.json,mt=ut.nodes[_];if(!mt.extensions||!mt.extensions[this.name]||mt.mesh===void 0)return null;const bt=ut.meshes[mt.mesh];for(const Ht of bt.primitives)if(Ht.mode!==WEBGL_CONSTANTS.TRIANGLES&&Ht.mode!==WEBGL_CONSTANTS.TRIANGLE_STRIP&&Ht.mode!==WEBGL_CONSTANTS.TRIANGLE_FAN&&Ht.mode!==void 0)return null;const Mt=mt.extensions[this.name].attributes,Bt=[],Ut={};for(const Ht in Mt)Bt.push(this.parser.getDependency("accessor",Mt[Ht]).then(tr=>(Ut[Ht]=tr,Ut[Ht])));return Bt.length<1?null:(Bt.push(this.parser.createNodeMesh(_)),Promise.all(Bt).then(Ht=>{const tr=Ht.pop(),rr=tr.isGroup?tr.children:[tr],sr=Ht[0].count,ar=[];for(const cr of rr){const Ar=new Matrix4,_r=new Vector3,Dr=new Quaternion,$r=new Vector3(1,1,1),Br=new InstancedMesh(cr.geometry,cr.material,sr);for(let Jr=0;Jr<sr;Jr++)Ut.TRANSLATION&&_r.fromBufferAttribute(Ut.TRANSLATION,Jr),Ut.ROTATION&&Dr.fromBufferAttribute(Ut.ROTATION,Jr),Ut.SCALE&&$r.fromBufferAttribute(Ut.SCALE,Jr),Br.setMatrixAt(Jr,Ar.compose(_r,Dr,$r));for(const Jr in Ut)Jr!=="TRANSLATION"&&Jr!=="ROTATION"&&Jr!=="SCALE"&&cr.geometry.setAttribute(Jr,Ut[Jr]);Object3D.prototype.copy.call(Br,cr),this.parser.assignFinalMaterial(Br),ar.push(Br)}return tr.isGroup?(tr.clear(),tr.add(...ar),tr):ar[0]}))}}const BINARY_EXTENSION_HEADER_MAGIC="glTF",BINARY_EXTENSION_HEADER_LENGTH=12,BINARY_EXTENSION_CHUNK_TYPES={JSON:1313821514,BIN:5130562};class GLTFBinaryExtension{constructor(_){this.name=EXTENSIONS.KHR_BINARY_GLTF,this.content=null,this.body=null;const ut=new DataView(_,0,BINARY_EXTENSION_HEADER_LENGTH);if(this.header={magic:LoaderUtils.decodeText(new Uint8Array(_.slice(0,4))),version:ut.getUint32(4,!0),length:ut.getUint32(8,!0)},this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const mt=this.header.length-BINARY_EXTENSION_HEADER_LENGTH,bt=new DataView(_,BINARY_EXTENSION_HEADER_LENGTH);let St=0;for(;St<mt;){const Mt=bt.getUint32(St,!0);St+=4;const Bt=bt.getUint32(St,!0);if(St+=4,Bt===BINARY_EXTENSION_CHUNK_TYPES.JSON){const Ut=new Uint8Array(_,BINARY_EXTENSION_HEADER_LENGTH+St,Mt);this.content=LoaderUtils.decodeText(Ut)}else if(Bt===BINARY_EXTENSION_CHUNK_TYPES.BIN){const Ut=BINARY_EXTENSION_HEADER_LENGTH+St;this.body=_.slice(Ut,Ut+Mt)}St+=Mt}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(_,ut){if(!ut)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION,this.json=_,this.dracoLoader=ut,this.dracoLoader.preload()}decodePrimitive(_,ut){const mt=this.json,bt=this.dracoLoader,St=_.extensions[this.name].bufferView,Mt=_.extensions[this.name].attributes,Bt={},Ut={},Ht={};for(const tr in Mt){const rr=ATTRIBUTES[tr]||tr.toLowerCase();Bt[rr]=Mt[tr]}for(const tr in _.attributes){const rr=ATTRIBUTES[tr]||tr.toLowerCase();if(Mt[tr]!==void 0){const sr=mt.accessors[_.attributes[tr]],ar=WEBGL_COMPONENT_TYPES[sr.componentType];Ht[rr]=ar.name,Ut[rr]=sr.normalized===!0}}return ut.getDependency("bufferView",St).then(function(tr){return new Promise(function(rr){bt.decodeDracoFile(tr,function(sr){for(const ar in sr.attributes){const cr=sr.attributes[ar],Ar=Ut[ar];Ar!==void 0&&(cr.normalized=Ar)}rr(sr)},Bt,Ht)})})}}class GLTFTextureTransformExtension{constructor(){this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM}extendTexture(_,ut){return(ut.texCoord===void 0||ut.texCoord===_.channel)&&ut.offset===void 0&&ut.rotation===void 0&&ut.scale===void 0||(_=_.clone(),ut.texCoord!==void 0&&(_.channel=ut.texCoord),ut.offset!==void 0&&_.offset.fromArray(ut.offset),ut.rotation!==void 0&&(_.rotation=ut.rotation),ut.scale!==void 0&&_.repeat.fromArray(ut.scale),_.needsUpdate=!0),_}}class GLTFMeshQuantizationExtension{constructor(){this.name=EXTENSIONS.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Interpolant{constructor(_,ut,mt,bt){super(_,ut,mt,bt)}copySampleValue_(_){const ut=this.resultBuffer,mt=this.sampleValues,bt=this.valueSize,St=_*bt*3+bt;for(let Mt=0;Mt!==bt;Mt++)ut[Mt]=mt[St+Mt];return ut}interpolate_(_,ut,mt,bt){const St=this.resultBuffer,Mt=this.sampleValues,Bt=this.valueSize,Ut=Bt*2,Ht=Bt*3,tr=bt-ut,rr=(mt-ut)/tr,sr=rr*rr,ar=sr*rr,cr=_*Ht,Ar=cr-Ht,_r=-2*ar+3*sr,Dr=ar-sr,$r=1-_r,Br=Dr-sr+rr;for(let Jr=0;Jr!==Bt;Jr++){const mn=Mt[Ar+Jr+Bt],Mn=Mt[Ar+Jr+Ut]*tr,$n=Mt[cr+Jr+Bt],en=Mt[cr+Jr]*tr;St[Jr]=$r*mn+Br*Mn+_r*$n+Dr*en}return St}}const _q=new Quaternion;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(_,ut,mt,bt){const St=super.interpolate_(_,ut,mt,bt);return _q.fromArray(St).normalize().toArray(St),St}}const WEBGL_CONSTANTS={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},WEBGL_FILTERS={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},WEBGL_TYPE_SIZES={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ATTRIBUTES={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...version$1>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},PATH_PROPERTIES={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},INTERPOLATION={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},ALPHA_MODES={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function createDefaultMaterial(rt){return rt.DefaultMaterial===void 0&&(rt.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),rt.DefaultMaterial}function addUnknownExtensionsToUserData(rt,_,ut){for(const mt in ut.extensions)rt[mt]===void 0&&(_.userData.gltfExtensions=_.userData.gltfExtensions||{},_.userData.gltfExtensions[mt]=ut.extensions[mt])}function assignExtrasToUserData(rt,_){_.extras!==void 0&&(typeof _.extras=="object"?Object.assign(rt.userData,_.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+_.extras))}function addMorphTargets(rt,_,ut){let mt=!1,bt=!1,St=!1;for(let Ht=0,tr=_.length;Ht<tr;Ht++){const rr=_[Ht];if(rr.POSITION!==void 0&&(mt=!0),rr.NORMAL!==void 0&&(bt=!0),rr.COLOR_0!==void 0&&(St=!0),mt&&bt&&St)break}if(!mt&&!bt&&!St)return Promise.resolve(rt);const Mt=[],Bt=[],Ut=[];for(let Ht=0,tr=_.length;Ht<tr;Ht++){const rr=_[Ht];if(mt){const sr=rr.POSITION!==void 0?ut.getDependency("accessor",rr.POSITION):rt.attributes.position;Mt.push(sr)}if(bt){const sr=rr.NORMAL!==void 0?ut.getDependency("accessor",rr.NORMAL):rt.attributes.normal;Bt.push(sr)}if(St){const sr=rr.COLOR_0!==void 0?ut.getDependency("accessor",rr.COLOR_0):rt.attributes.color;Ut.push(sr)}}return Promise.all([Promise.all(Mt),Promise.all(Bt),Promise.all(Ut)]).then(function(Ht){const tr=Ht[0],rr=Ht[1],sr=Ht[2];return mt&&(rt.morphAttributes.position=tr),bt&&(rt.morphAttributes.normal=rr),St&&(rt.morphAttributes.color=sr),rt.morphTargetsRelative=!0,rt})}function updateMorphTargets(rt,_){if(rt.updateMorphTargets(),_.weights!==void 0)for(let ut=0,mt=_.weights.length;ut<mt;ut++)rt.morphTargetInfluences[ut]=_.weights[ut];if(_.extras&&Array.isArray(_.extras.targetNames)){const ut=_.extras.targetNames;if(rt.morphTargetInfluences.length===ut.length){rt.morphTargetDictionary={};for(let mt=0,bt=ut.length;mt<bt;mt++)rt.morphTargetDictionary[ut[mt]]=mt}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(rt){let _;const ut=rt.extensions&&rt.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];if(ut?_="draco:"+ut.bufferView+":"+ut.indices+":"+createAttributesKey(ut.attributes):_=rt.indices+":"+createAttributesKey(rt.attributes)+":"+rt.mode,rt.targets!==void 0)for(let mt=0,bt=rt.targets.length;mt<bt;mt++)_+=":"+createAttributesKey(rt.targets[mt]);return _}function createAttributesKey(rt){let _="";const ut=Object.keys(rt).sort();for(let mt=0,bt=ut.length;mt<bt;mt++)_+=ut[mt]+":"+rt[ut[mt]]+";";return _}function getNormalizedComponentScale(rt){switch(rt){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function getImageURIMimeType(rt){return rt.search(/\.jpe?g($|\?)/i)>0||rt.search(/^data\:image\/jpeg/)===0?"image/jpeg":rt.search(/\.webp($|\?)/i)>0||rt.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const _identityMatrix=new Matrix4;class GLTFParser{constructor(_={},ut={}){this.json=_,this.extensions={},this.plugins={},this.options=ut,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let mt=!1,bt=!1,St=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(mt=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,bt=navigator.userAgent.indexOf("Firefox")>-1,St=bt?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||mt||bt&&St<98?this.textureLoader=new TextureLoader(this.options.manager):this.textureLoader=new ImageBitmapLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(_){this.extensions=_}setPlugins(_){this.plugins=_}parse(_,ut){const mt=this,bt=this.json,St=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(Mt){return Mt._markDefs&&Mt._markDefs()}),Promise.all(this._invokeAll(function(Mt){return Mt.beforeRoot&&Mt.beforeRoot()})).then(function(){return Promise.all([mt.getDependencies("scene"),mt.getDependencies("animation"),mt.getDependencies("camera")])}).then(function(Mt){const Bt={scene:Mt[0][bt.scene||0],scenes:Mt[0],animations:Mt[1],cameras:Mt[2],asset:bt.asset,parser:mt,userData:{}};addUnknownExtensionsToUserData(St,Bt,bt),assignExtrasToUserData(Bt,bt),Promise.all(mt._invokeAll(function(Ut){return Ut.afterRoot&&Ut.afterRoot(Bt)})).then(function(){_(Bt)})}).catch(ut)}_markDefs(){const _=this.json.nodes||[],ut=this.json.skins||[],mt=this.json.meshes||[];for(let bt=0,St=ut.length;bt<St;bt++){const Mt=ut[bt].joints;for(let Bt=0,Ut=Mt.length;Bt<Ut;Bt++)_[Mt[Bt]].isBone=!0}for(let bt=0,St=_.length;bt<St;bt++){const Mt=_[bt];Mt.mesh!==void 0&&(this._addNodeRef(this.meshCache,Mt.mesh),Mt.skin!==void 0&&(mt[Mt.mesh].isSkinnedMesh=!0)),Mt.camera!==void 0&&this._addNodeRef(this.cameraCache,Mt.camera)}}_addNodeRef(_,ut){ut!==void 0&&(_.refs[ut]===void 0&&(_.refs[ut]=_.uses[ut]=0),_.refs[ut]++)}_getNodeRef(_,ut,mt){if(_.refs[ut]<=1)return mt;const bt=mt.clone(),St=(Mt,Bt)=>{const Ut=this.associations.get(Mt);Ut!=null&&this.associations.set(Bt,Ut);for(const[Ht,tr]of Mt.children.entries())St(tr,Bt.children[Ht])};return St(mt,bt),bt.name+="_instance_"+_.uses[ut]++,bt}_invokeOne(_){const ut=Object.values(this.plugins);ut.push(this);for(let mt=0;mt<ut.length;mt++){const bt=_(ut[mt]);if(bt)return bt}return null}_invokeAll(_){const ut=Object.values(this.plugins);ut.unshift(this);const mt=[];for(let bt=0;bt<ut.length;bt++){const St=_(ut[bt]);St&&mt.push(St)}return mt}getDependency(_,ut){const mt=_+":"+ut;let bt=this.cache.get(mt);if(!bt){switch(_){case"scene":bt=this.loadScene(ut);break;case"node":bt=this._invokeOne(function(St){return St.loadNode&&St.loadNode(ut)});break;case"mesh":bt=this._invokeOne(function(St){return St.loadMesh&&St.loadMesh(ut)});break;case"accessor":bt=this.loadAccessor(ut);break;case"bufferView":bt=this._invokeOne(function(St){return St.loadBufferView&&St.loadBufferView(ut)});break;case"buffer":bt=this.loadBuffer(ut);break;case"material":bt=this._invokeOne(function(St){return St.loadMaterial&&St.loadMaterial(ut)});break;case"texture":bt=this._invokeOne(function(St){return St.loadTexture&&St.loadTexture(ut)});break;case"skin":bt=this.loadSkin(ut);break;case"animation":bt=this._invokeOne(function(St){return St.loadAnimation&&St.loadAnimation(ut)});break;case"camera":bt=this.loadCamera(ut);break;default:if(bt=this._invokeOne(function(St){return St!=this&&St.getDependency&&St.getDependency(_,ut)}),!bt)throw new Error("Unknown type: "+_);break}this.cache.add(mt,bt)}return bt}getDependencies(_){let ut=this.cache.get(_);if(!ut){const mt=this,bt=this.json[_+(_==="mesh"?"es":"s")]||[];ut=Promise.all(bt.map(function(St,Mt){return mt.getDependency(_,Mt)})),this.cache.add(_,ut)}return ut}loadBuffer(_){const ut=this.json.buffers[_],mt=this.fileLoader;if(ut.type&&ut.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+ut.type+" buffer type is not supported.");if(ut.uri===void 0&&_===0)return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);const bt=this.options;return new Promise(function(St,Mt){mt.load(LoaderUtils.resolveURL(ut.uri,bt.path),St,void 0,function(){Mt(new Error('THREE.GLTFLoader: Failed to load buffer "'+ut.uri+'".'))})})}loadBufferView(_){const ut=this.json.bufferViews[_];return this.getDependency("buffer",ut.buffer).then(function(mt){const bt=ut.byteLength||0,St=ut.byteOffset||0;return mt.slice(St,St+bt)})}loadAccessor(_){const ut=this,mt=this.json,bt=this.json.accessors[_];if(bt.bufferView===void 0&&bt.sparse===void 0){const Mt=WEBGL_TYPE_SIZES[bt.type],Bt=WEBGL_COMPONENT_TYPES[bt.componentType],Ut=bt.normalized===!0,Ht=new Bt(bt.count*Mt);return Promise.resolve(new BufferAttribute(Ht,Mt,Ut))}const St=[];return bt.bufferView!==void 0?St.push(this.getDependency("bufferView",bt.bufferView)):St.push(null),bt.sparse!==void 0&&(St.push(this.getDependency("bufferView",bt.sparse.indices.bufferView)),St.push(this.getDependency("bufferView",bt.sparse.values.bufferView))),Promise.all(St).then(function(Mt){const Bt=Mt[0],Ut=WEBGL_TYPE_SIZES[bt.type],Ht=WEBGL_COMPONENT_TYPES[bt.componentType],tr=Ht.BYTES_PER_ELEMENT,rr=tr*Ut,sr=bt.byteOffset||0,ar=bt.bufferView!==void 0?mt.bufferViews[bt.bufferView].byteStride:void 0,cr=bt.normalized===!0;let Ar,_r;if(ar&&ar!==rr){const Dr=Math.floor(sr/ar),$r="InterleavedBuffer:"+bt.bufferView+":"+bt.componentType+":"+Dr+":"+bt.count;let Br=ut.cache.get($r);Br||(Ar=new Ht(Bt,Dr*ar,bt.count*ar/tr),Br=new InterleavedBuffer(Ar,ar/tr),ut.cache.add($r,Br)),_r=new InterleavedBufferAttribute(Br,Ut,sr%ar/tr,cr)}else Bt===null?Ar=new Ht(bt.count*Ut):Ar=new Ht(Bt,sr,bt.count*Ut),_r=new BufferAttribute(Ar,Ut,cr);if(bt.sparse!==void 0){const Dr=WEBGL_TYPE_SIZES.SCALAR,$r=WEBGL_COMPONENT_TYPES[bt.sparse.indices.componentType],Br=bt.sparse.indices.byteOffset||0,Jr=bt.sparse.values.byteOffset||0,mn=new $r(Mt[1],Br,bt.sparse.count*Dr),Mn=new Ht(Mt[2],Jr,bt.sparse.count*Ut);Bt!==null&&(_r=new BufferAttribute(_r.array.slice(),_r.itemSize,_r.normalized));for(let $n=0,en=mn.length;$n<en;$n++){const In=mn[$n];if(_r.setX(In,Mn[$n*Ut]),Ut>=2&&_r.setY(In,Mn[$n*Ut+1]),Ut>=3&&_r.setZ(In,Mn[$n*Ut+2]),Ut>=4&&_r.setW(In,Mn[$n*Ut+3]),Ut>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return _r})}loadTexture(_){const ut=this.json,mt=this.options,St=ut.textures[_].source,Mt=ut.images[St];let Bt=this.textureLoader;if(Mt.uri){const Ut=mt.manager.getHandler(Mt.uri);Ut!==null&&(Bt=Ut)}return this.loadTextureImage(_,St,Bt)}loadTextureImage(_,ut,mt){const bt=this,St=this.json,Mt=St.textures[_],Bt=St.images[ut],Ut=(Bt.uri||Bt.bufferView)+":"+Mt.sampler;if(this.textureCache[Ut])return this.textureCache[Ut];const Ht=this.loadImageSource(ut,mt).then(function(tr){tr.flipY=!1,tr.name=Mt.name||Bt.name||"",tr.name===""&&typeof Bt.uri=="string"&&Bt.uri.startsWith("data:image/")===!1&&(tr.name=Bt.uri);const sr=(St.samplers||{})[Mt.sampler]||{};return tr.magFilter=WEBGL_FILTERS[sr.magFilter]||LinearFilter,tr.minFilter=WEBGL_FILTERS[sr.minFilter]||LinearMipmapLinearFilter,tr.wrapS=WEBGL_WRAPPINGS[sr.wrapS]||RepeatWrapping,tr.wrapT=WEBGL_WRAPPINGS[sr.wrapT]||RepeatWrapping,bt.associations.set(tr,{textures:_}),tr}).catch(function(){return null});return this.textureCache[Ut]=Ht,Ht}loadImageSource(_,ut){const mt=this,bt=this.json,St=this.options;if(this.sourceCache[_]!==void 0)return this.sourceCache[_].then(rr=>rr.clone());const Mt=bt.images[_],Bt=self.URL||self.webkitURL;let Ut=Mt.uri||"",Ht=!1;if(Mt.bufferView!==void 0)Ut=mt.getDependency("bufferView",Mt.bufferView).then(function(rr){Ht=!0;const sr=new Blob([rr],{type:Mt.mimeType});return Ut=Bt.createObjectURL(sr),Ut});else if(Mt.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_+" is missing URI and bufferView");const tr=Promise.resolve(Ut).then(function(rr){return new Promise(function(sr,ar){let cr=sr;ut.isImageBitmapLoader===!0&&(cr=function(Ar){const _r=new Texture(Ar);_r.needsUpdate=!0,sr(_r)}),ut.load(LoaderUtils.resolveURL(rr,St.path),cr,void 0,ar)})}).then(function(rr){return Ht===!0&&Bt.revokeObjectURL(Ut),rr.userData.mimeType=Mt.mimeType||getImageURIMimeType(Mt.uri),rr}).catch(function(rr){throw console.error("THREE.GLTFLoader: Couldn't load texture",Ut),rr});return this.sourceCache[_]=tr,tr}assignTexture(_,ut,mt,bt){const St=this;return this.getDependency("texture",mt.index).then(function(Mt){if(!Mt)return null;if(mt.texCoord!==void 0&&mt.texCoord>0&&(Mt=Mt.clone(),Mt.channel=mt.texCoord),St.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){const Bt=mt.extensions!==void 0?mt.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;if(Bt){const Ut=St.associations.get(Mt);Mt=St.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(Mt,Bt),St.associations.set(Mt,Ut)}}return bt!==void 0&&("colorSpace"in Mt?Mt.colorSpace=bt===3001?"srgb":"srgb-linear":Mt.encoding=bt),_[ut]=Mt,Mt})}assignFinalMaterial(_){const ut=_.geometry;let mt=_.material;const bt=ut.attributes.tangent===void 0,St=ut.attributes.color!==void 0,Mt=ut.attributes.normal===void 0;if(_.isPoints){const Bt="PointsMaterial:"+mt.uuid;let Ut=this.cache.get(Bt);Ut||(Ut=new PointsMaterial,Material.prototype.copy.call(Ut,mt),Ut.color.copy(mt.color),Ut.map=mt.map,Ut.sizeAttenuation=!1,this.cache.add(Bt,Ut)),mt=Ut}else if(_.isLine){const Bt="LineBasicMaterial:"+mt.uuid;let Ut=this.cache.get(Bt);Ut||(Ut=new LineBasicMaterial,Material.prototype.copy.call(Ut,mt),Ut.color.copy(mt.color),Ut.map=mt.map,this.cache.add(Bt,Ut)),mt=Ut}if(bt||St||Mt){let Bt="ClonedMaterial:"+mt.uuid+":";bt&&(Bt+="derivative-tangents:"),St&&(Bt+="vertex-colors:"),Mt&&(Bt+="flat-shading:");let Ut=this.cache.get(Bt);Ut||(Ut=mt.clone(),St&&(Ut.vertexColors=!0),Mt&&(Ut.flatShading=!0),bt&&(Ut.normalScale&&(Ut.normalScale.y*=-1),Ut.clearcoatNormalScale&&(Ut.clearcoatNormalScale.y*=-1)),this.cache.add(Bt,Ut),this.associations.set(Ut,this.associations.get(mt))),mt=Ut}_.material=mt}getMaterialType(){return MeshStandardMaterial}loadMaterial(_){const ut=this,mt=this.json,bt=this.extensions,St=mt.materials[_];let Mt;const Bt={},Ut=St.extensions||{},Ht=[];if(Ut[EXTENSIONS.KHR_MATERIALS_UNLIT]){const rr=bt[EXTENSIONS.KHR_MATERIALS_UNLIT];Mt=rr.getMaterialType(),Ht.push(rr.extendParams(Bt,St,ut))}else{const rr=St.pbrMetallicRoughness||{};if(Bt.color=new Color$1(1,1,1),Bt.opacity=1,Array.isArray(rr.baseColorFactor)){const sr=rr.baseColorFactor;Bt.color.fromArray(sr),Bt.opacity=sr[3]}rr.baseColorTexture!==void 0&&Ht.push(ut.assignTexture(Bt,"map",rr.baseColorTexture,3001)),Bt.metalness=rr.metallicFactor!==void 0?rr.metallicFactor:1,Bt.roughness=rr.roughnessFactor!==void 0?rr.roughnessFactor:1,rr.metallicRoughnessTexture!==void 0&&(Ht.push(ut.assignTexture(Bt,"metalnessMap",rr.metallicRoughnessTexture)),Ht.push(ut.assignTexture(Bt,"roughnessMap",rr.metallicRoughnessTexture))),Mt=this._invokeOne(function(sr){return sr.getMaterialType&&sr.getMaterialType(_)}),Ht.push(Promise.all(this._invokeAll(function(sr){return sr.extendMaterialParams&&sr.extendMaterialParams(_,Bt)})))}St.doubleSided===!0&&(Bt.side=DoubleSide);const tr=St.alphaMode||ALPHA_MODES.OPAQUE;if(tr===ALPHA_MODES.BLEND?(Bt.transparent=!0,Bt.depthWrite=!1):(Bt.transparent=!1,tr===ALPHA_MODES.MASK&&(Bt.alphaTest=St.alphaCutoff!==void 0?St.alphaCutoff:.5)),St.normalTexture!==void 0&&Mt!==MeshBasicMaterial&&(Ht.push(ut.assignTexture(Bt,"normalMap",St.normalTexture)),Bt.normalScale=new Vector2(1,1),St.normalTexture.scale!==void 0)){const rr=St.normalTexture.scale;Bt.normalScale.set(rr,rr)}return St.occlusionTexture!==void 0&&Mt!==MeshBasicMaterial&&(Ht.push(ut.assignTexture(Bt,"aoMap",St.occlusionTexture)),St.occlusionTexture.strength!==void 0&&(Bt.aoMapIntensity=St.occlusionTexture.strength)),St.emissiveFactor!==void 0&&Mt!==MeshBasicMaterial&&(Bt.emissive=new Color$1().fromArray(St.emissiveFactor)),St.emissiveTexture!==void 0&&Mt!==MeshBasicMaterial&&Ht.push(ut.assignTexture(Bt,"emissiveMap",St.emissiveTexture,3001)),Promise.all(Ht).then(function(){const rr=new Mt(Bt);return St.name&&(rr.name=St.name),assignExtrasToUserData(rr,St),ut.associations.set(rr,{materials:_}),St.extensions&&addUnknownExtensionsToUserData(bt,rr,St),rr})}createUniqueName(_){const ut=PropertyBinding.sanitizeNodeName(_||"");return ut in this.nodeNamesUsed?ut+"_"+ ++this.nodeNamesUsed[ut]:(this.nodeNamesUsed[ut]=0,ut)}loadGeometries(_){const ut=this,mt=this.extensions,bt=this.primitiveCache;function St(Bt){return mt[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Bt,ut).then(function(Ut){return addPrimitiveAttributes(Ut,Bt,ut)})}const Mt=[];for(let Bt=0,Ut=_.length;Bt<Ut;Bt++){const Ht=_[Bt],tr=createPrimitiveKey(Ht),rr=bt[tr];if(rr)Mt.push(rr.promise);else{let sr;Ht.extensions&&Ht.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]?sr=St(Ht):sr=addPrimitiveAttributes(new BufferGeometry,Ht,ut),bt[tr]={primitive:Ht,promise:sr},Mt.push(sr)}}return Promise.all(Mt)}loadMesh(_){const ut=this,mt=this.json,bt=this.extensions,St=mt.meshes[_],Mt=St.primitives,Bt=[];for(let Ut=0,Ht=Mt.length;Ut<Ht;Ut++){const tr=Mt[Ut].material===void 0?createDefaultMaterial(this.cache):this.getDependency("material",Mt[Ut].material);Bt.push(tr)}return Bt.push(ut.loadGeometries(Mt)),Promise.all(Bt).then(function(Ut){const Ht=Ut.slice(0,Ut.length-1),tr=Ut[Ut.length-1],rr=[];for(let ar=0,cr=tr.length;ar<cr;ar++){const Ar=tr[ar],_r=Mt[ar];let Dr;const $r=Ht[ar];if(_r.mode===WEBGL_CONSTANTS.TRIANGLES||_r.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP||_r.mode===WEBGL_CONSTANTS.TRIANGLE_FAN||_r.mode===void 0)Dr=St.isSkinnedMesh===!0?new SkinnedMesh(Ar,$r):new Mesh(Ar,$r),Dr.isSkinnedMesh===!0&&Dr.normalizeSkinWeights(),_r.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP?Dr.geometry=toTrianglesDrawMode(Dr.geometry,TriangleStripDrawMode):_r.mode===WEBGL_CONSTANTS.TRIANGLE_FAN&&(Dr.geometry=toTrianglesDrawMode(Dr.geometry,TriangleFanDrawMode));else if(_r.mode===WEBGL_CONSTANTS.LINES)Dr=new LineSegments(Ar,$r);else if(_r.mode===WEBGL_CONSTANTS.LINE_STRIP)Dr=new Line(Ar,$r);else if(_r.mode===WEBGL_CONSTANTS.LINE_LOOP)Dr=new LineLoop(Ar,$r);else if(_r.mode===WEBGL_CONSTANTS.POINTS)Dr=new Points(Ar,$r);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_r.mode);Object.keys(Dr.geometry.morphAttributes).length>0&&updateMorphTargets(Dr,St),Dr.name=ut.createUniqueName(St.name||"mesh_"+_),assignExtrasToUserData(Dr,St),_r.extensions&&addUnknownExtensionsToUserData(bt,Dr,_r),ut.assignFinalMaterial(Dr),rr.push(Dr)}for(let ar=0,cr=rr.length;ar<cr;ar++)ut.associations.set(rr[ar],{meshes:_,primitives:ar});if(rr.length===1)return St.extensions&&addUnknownExtensionsToUserData(bt,rr[0],St),rr[0];const sr=new Group$1;St.extensions&&addUnknownExtensionsToUserData(bt,sr,St),ut.associations.set(sr,{meshes:_});for(let ar=0,cr=rr.length;ar<cr;ar++)sr.add(rr[ar]);return sr})}loadCamera(_){let ut;const mt=this.json.cameras[_],bt=mt[mt.type];if(!bt){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return mt.type==="perspective"?ut=new PerspectiveCamera$1(MathUtils.radToDeg(bt.yfov),bt.aspectRatio||1,bt.znear||1,bt.zfar||2e6):mt.type==="orthographic"&&(ut=new OrthographicCamera$1(-bt.xmag,bt.xmag,bt.ymag,-bt.ymag,bt.znear,bt.zfar)),mt.name&&(ut.name=this.createUniqueName(mt.name)),assignExtrasToUserData(ut,mt),Promise.resolve(ut)}loadSkin(_){const ut=this.json.skins[_],mt=[];for(let bt=0,St=ut.joints.length;bt<St;bt++)mt.push(this._loadNodeShallow(ut.joints[bt]));return ut.inverseBindMatrices!==void 0?mt.push(this.getDependency("accessor",ut.inverseBindMatrices)):mt.push(null),Promise.all(mt).then(function(bt){const St=bt.pop(),Mt=bt,Bt=[],Ut=[];for(let Ht=0,tr=Mt.length;Ht<tr;Ht++){const rr=Mt[Ht];if(rr){Bt.push(rr);const sr=new Matrix4;St!==null&&sr.fromArray(St.array,Ht*16),Ut.push(sr)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',ut.joints[Ht])}return new Skeleton(Bt,Ut)})}loadAnimation(_){const mt=this.json.animations[_],bt=mt.name?mt.name:"animation_"+_,St=[],Mt=[],Bt=[],Ut=[],Ht=[];for(let tr=0,rr=mt.channels.length;tr<rr;tr++){const sr=mt.channels[tr],ar=mt.samplers[sr.sampler],cr=sr.target,Ar=cr.node,_r=mt.parameters!==void 0?mt.parameters[ar.input]:ar.input,Dr=mt.parameters!==void 0?mt.parameters[ar.output]:ar.output;cr.node!==void 0&&(St.push(this.getDependency("node",Ar)),Mt.push(this.getDependency("accessor",_r)),Bt.push(this.getDependency("accessor",Dr)),Ut.push(ar),Ht.push(cr))}return Promise.all([Promise.all(St),Promise.all(Mt),Promise.all(Bt),Promise.all(Ut),Promise.all(Ht)]).then(function(tr){const rr=tr[0],sr=tr[1],ar=tr[2],cr=tr[3],Ar=tr[4],_r=[];for(let Dr=0,$r=rr.length;Dr<$r;Dr++){const Br=rr[Dr],Jr=sr[Dr],mn=ar[Dr],Mn=cr[Dr],$n=Ar[Dr];if(Br===void 0)continue;Br.updateMatrix();let en;switch(PATH_PROPERTIES[$n.path]){case PATH_PROPERTIES.weights:en=NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:en=QuaternionKeyframeTrack;break;case PATH_PROPERTIES.position:case PATH_PROPERTIES.scale:default:en=VectorKeyframeTrack;break}const In=Br.name?Br.name:Br.uuid,Rn=Mn.interpolation!==void 0?INTERPOLATION[Mn.interpolation]:InterpolateLinear,qn=[];PATH_PROPERTIES[$n.path]===PATH_PROPERTIES.weights?Br.traverse(function(xs){xs.morphTargetInfluences&&qn.push(xs.name?xs.name:xs.uuid)}):qn.push(In);let Qn=mn.array;if(mn.normalized){const xs=getNormalizedComponentScale(Qn.constructor),cs=new Float32Array(Qn.length);for(let ks=0,_o=Qn.length;ks<_o;ks++)cs[ks]=Qn[ks]*xs;Qn=cs}for(let xs=0,cs=qn.length;xs<cs;xs++){const ks=new en(qn[xs]+"."+PATH_PROPERTIES[$n.path],Jr.array,Qn,Rn);Mn.interpolation==="CUBICSPLINE"&&(ks.createInterpolant=function(qs){const Ss=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new Ss(this.times,this.values,this.getValueSize()/3,qs)},ks.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),_r.push(ks)}}return new AnimationClip(bt,void 0,_r)})}createNodeMesh(_){const ut=this.json,mt=this,bt=ut.nodes[_];return bt.mesh===void 0?null:mt.getDependency("mesh",bt.mesh).then(function(St){const Mt=mt._getNodeRef(mt.meshCache,bt.mesh,St);return bt.weights!==void 0&&Mt.traverse(function(Bt){if(Bt.isMesh)for(let Ut=0,Ht=bt.weights.length;Ut<Ht;Ut++)Bt.morphTargetInfluences[Ut]=bt.weights[Ut]}),Mt})}loadNode(_){const ut=this.json,mt=this,bt=ut.nodes[_],St=mt._loadNodeShallow(_),Mt=[],Bt=bt.children||[];for(let Ht=0,tr=Bt.length;Ht<tr;Ht++)Mt.push(mt.getDependency("node",Bt[Ht]));const Ut=bt.skin===void 0?Promise.resolve(null):mt.getDependency("skin",bt.skin);return Promise.all([St,Promise.all(Mt),Ut]).then(function(Ht){const tr=Ht[0],rr=Ht[1],sr=Ht[2];sr!==null&&tr.traverse(function(ar){ar.isSkinnedMesh&&ar.bind(sr,_identityMatrix)});for(let ar=0,cr=rr.length;ar<cr;ar++)tr.add(rr[ar]);return tr})}_loadNodeShallow(_){const ut=this.json,mt=this.extensions,bt=this;if(this.nodeCache[_]!==void 0)return this.nodeCache[_];const St=ut.nodes[_],Mt=St.name?bt.createUniqueName(St.name):"",Bt=[],Ut=bt._invokeOne(function(Ht){return Ht.createNodeMesh&&Ht.createNodeMesh(_)});return Ut&&Bt.push(Ut),St.camera!==void 0&&Bt.push(bt.getDependency("camera",St.camera).then(function(Ht){return bt._getNodeRef(bt.cameraCache,St.camera,Ht)})),bt._invokeAll(function(Ht){return Ht.createNodeAttachment&&Ht.createNodeAttachment(_)}).forEach(function(Ht){Bt.push(Ht)}),this.nodeCache[_]=Promise.all(Bt).then(function(Ht){let tr;if(St.isBone===!0?tr=new Bone:Ht.length>1?tr=new Group$1:Ht.length===1?tr=Ht[0]:tr=new Object3D,tr!==Ht[0])for(let rr=0,sr=Ht.length;rr<sr;rr++)tr.add(Ht[rr]);if(St.name&&(tr.userData.name=St.name,tr.name=Mt),assignExtrasToUserData(tr,St),St.extensions&&addUnknownExtensionsToUserData(mt,tr,St),St.matrix!==void 0){const rr=new Matrix4;rr.fromArray(St.matrix),tr.applyMatrix4(rr)}else St.translation!==void 0&&tr.position.fromArray(St.translation),St.rotation!==void 0&&tr.quaternion.fromArray(St.rotation),St.scale!==void 0&&tr.scale.fromArray(St.scale);return bt.associations.has(tr)||bt.associations.set(tr,{}),bt.associations.get(tr).nodes=_,tr}),this.nodeCache[_]}loadScene(_){const ut=this.extensions,mt=this.json.scenes[_],bt=this,St=new Group$1;mt.name&&(St.name=bt.createUniqueName(mt.name)),assignExtrasToUserData(St,mt),mt.extensions&&addUnknownExtensionsToUserData(ut,St,mt);const Mt=mt.nodes||[],Bt=[];for(let Ut=0,Ht=Mt.length;Ut<Ht;Ut++)Bt.push(bt.getDependency("node",Mt[Ut]));return Promise.all(Bt).then(function(Ut){for(let tr=0,rr=Ut.length;tr<rr;tr++)St.add(Ut[tr]);const Ht=tr=>{const rr=new Map;for(const[sr,ar]of bt.associations)(sr instanceof Material||sr instanceof Texture)&&rr.set(sr,ar);return tr.traverse(sr=>{const ar=bt.associations.get(sr);ar!=null&&rr.set(sr,ar)}),rr};return bt.associations=Ht(St),St})}}function computeBounds(rt,_,ut){const mt=_.attributes,bt=new Box3;if(mt.POSITION!==void 0){const Bt=ut.json.accessors[mt.POSITION],Ut=Bt.min,Ht=Bt.max;if(Ut!==void 0&&Ht!==void 0){if(bt.set(new Vector3(Ut[0],Ut[1],Ut[2]),new Vector3(Ht[0],Ht[1],Ht[2])),Bt.normalized){const tr=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[Bt.componentType]);bt.min.multiplyScalar(tr),bt.max.multiplyScalar(tr)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const St=_.targets;if(St!==void 0){const Bt=new Vector3,Ut=new Vector3;for(let Ht=0,tr=St.length;Ht<tr;Ht++){const rr=St[Ht];if(rr.POSITION!==void 0){const sr=ut.json.accessors[rr.POSITION],ar=sr.min,cr=sr.max;if(ar!==void 0&&cr!==void 0){if(Ut.setX(Math.max(Math.abs(ar[0]),Math.abs(cr[0]))),Ut.setY(Math.max(Math.abs(ar[1]),Math.abs(cr[1]))),Ut.setZ(Math.max(Math.abs(ar[2]),Math.abs(cr[2]))),sr.normalized){const Ar=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[sr.componentType]);Ut.multiplyScalar(Ar)}Bt.max(Ut)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}bt.expandByVector(Bt)}rt.boundingBox=bt;const Mt=new Sphere$1;bt.getCenter(Mt.center),Mt.radius=bt.min.distanceTo(bt.max)/2,rt.boundingSphere=Mt}function addPrimitiveAttributes(rt,_,ut){const mt=_.attributes,bt=[];function St(Mt,Bt){return ut.getDependency("accessor",Mt).then(function(Ut){rt.setAttribute(Bt,Ut)})}for(const Mt in mt){const Bt=ATTRIBUTES[Mt]||Mt.toLowerCase();Bt in rt.attributes||bt.push(St(mt[Mt],Bt))}if(_.indices!==void 0&&!rt.index){const Mt=ut.getDependency("accessor",_.indices).then(function(Bt){rt.setIndex(Bt)});bt.push(Mt)}return assignExtrasToUserData(rt,_),computeBounds(rt,_,ut),Promise.all(bt).then(function(){return _.targets!==void 0?addMorphTargets(rt,_.targets,ut):rt})}function findSpan(rt,_,ut){const mt=ut.length-rt-1;if(_>=ut[mt])return mt-1;if(_<=ut[rt])return rt;let bt=rt,St=mt,Mt=Math.floor((bt+St)/2);for(;_<ut[Mt]||_>=ut[Mt+1];)_<ut[Mt]?St=Mt:bt=Mt,Mt=Math.floor((bt+St)/2);return Mt}function calcBasisFunctions(rt,_,ut,mt){const bt=[],St=[],Mt=[];bt[0]=1;for(let Bt=1;Bt<=ut;++Bt){St[Bt]=_-mt[rt+1-Bt],Mt[Bt]=mt[rt+Bt]-_;let Ut=0;for(let Ht=0;Ht<Bt;++Ht){const tr=Mt[Ht+1],rr=St[Bt-Ht],sr=bt[Ht]/(tr+rr);bt[Ht]=Ut+tr*sr,Ut=rr*sr}bt[Bt]=Ut}return bt}function calcBSplinePoint(rt,_,ut,mt){const bt=findSpan(rt,mt,_),St=calcBasisFunctions(bt,mt,rt,_),Mt=new Vector4(0,0,0,0);for(let Bt=0;Bt<=rt;++Bt){const Ut=ut[bt-rt+Bt],Ht=St[Bt],tr=Ut.w*Ht;Mt.x+=Ut.x*tr,Mt.y+=Ut.y*tr,Mt.z+=Ut.z*tr,Mt.w+=Ut.w*Ht}return Mt}function calcBasisFunctionDerivatives(rt,_,ut,mt,bt){const St=[];for(let rr=0;rr<=ut;++rr)St[rr]=0;const Mt=[];for(let rr=0;rr<=mt;++rr)Mt[rr]=St.slice(0);const Bt=[];for(let rr=0;rr<=ut;++rr)Bt[rr]=St.slice(0);Bt[0][0]=1;const Ut=St.slice(0),Ht=St.slice(0);for(let rr=1;rr<=ut;++rr){Ut[rr]=_-bt[rt+1-rr],Ht[rr]=bt[rt+rr]-_;let sr=0;for(let ar=0;ar<rr;++ar){const cr=Ht[ar+1],Ar=Ut[rr-ar];Bt[rr][ar]=cr+Ar;const _r=Bt[ar][rr-1]/Bt[rr][ar];Bt[ar][rr]=sr+cr*_r,sr=Ar*_r}Bt[rr][rr]=sr}for(let rr=0;rr<=ut;++rr)Mt[0][rr]=Bt[rr][ut];for(let rr=0;rr<=ut;++rr){let sr=0,ar=1;const cr=[];for(let Ar=0;Ar<=ut;++Ar)cr[Ar]=St.slice(0);cr[0][0]=1;for(let Ar=1;Ar<=mt;++Ar){let _r=0;const Dr=rr-Ar,$r=ut-Ar;rr>=Ar&&(cr[ar][0]=cr[sr][0]/Bt[$r+1][Dr],_r=cr[ar][0]*Bt[Dr][$r]);const Br=Dr>=-1?1:-Dr,Jr=rr-1<=$r?Ar-1:ut-rr;for(let Mn=Br;Mn<=Jr;++Mn)cr[ar][Mn]=(cr[sr][Mn]-cr[sr][Mn-1])/Bt[$r+1][Dr+Mn],_r+=cr[ar][Mn]*Bt[Dr+Mn][$r];rr<=$r&&(cr[ar][Ar]=-cr[sr][Ar-1]/Bt[$r+1][rr],_r+=cr[ar][Ar]*Bt[rr][$r]),Mt[Ar][rr]=_r;const mn=sr;sr=ar,ar=mn}}let tr=ut;for(let rr=1;rr<=mt;++rr){for(let sr=0;sr<=ut;++sr)Mt[rr][sr]*=tr;tr*=ut-rr}return Mt}function calcBSplineDerivatives(rt,_,ut,mt,bt){const St=bt<rt?bt:rt,Mt=[],Bt=findSpan(rt,mt,_),Ut=calcBasisFunctionDerivatives(Bt,mt,rt,St,_),Ht=[];for(let tr=0;tr<ut.length;++tr){const rr=ut[tr].clone(),sr=rr.w;rr.x*=sr,rr.y*=sr,rr.z*=sr,Ht[tr]=rr}for(let tr=0;tr<=St;++tr){const rr=Ht[Bt-rt].clone().multiplyScalar(Ut[tr][0]);for(let sr=1;sr<=rt;++sr)rr.add(Ht[Bt-rt+sr].clone().multiplyScalar(Ut[tr][sr]));Mt[tr]=rr}for(let tr=St+1;tr<=bt+1;++tr)Mt[tr]=new Vector4(0,0,0);return Mt}function calcKoverI(rt,_){let ut=1;for(let bt=2;bt<=rt;++bt)ut*=bt;let mt=1;for(let bt=2;bt<=_;++bt)mt*=bt;for(let bt=2;bt<=rt-_;++bt)mt*=bt;return ut/mt}function calcRationalCurveDerivatives(rt){const _=rt.length,ut=[],mt=[];for(let St=0;St<_;++St){const Mt=rt[St];ut[St]=new Vector3(Mt.x,Mt.y,Mt.z),mt[St]=Mt.w}const bt=[];for(let St=0;St<_;++St){const Mt=ut[St].clone();for(let Bt=1;Bt<=St;++Bt)Mt.sub(bt[St-Bt].clone().multiplyScalar(calcKoverI(St,Bt)*mt[Bt]));bt[St]=Mt.divideScalar(mt[0])}return bt}function calcNURBSDerivatives(rt,_,ut,mt,bt){const St=calcBSplineDerivatives(rt,_,ut,mt,bt);return calcRationalCurveDerivatives(St)}class NURBSCurve extends Curve{constructor(_,ut,mt,bt,St){super(),this.degree=_,this.knots=ut,this.controlPoints=[],this.startKnot=bt||0,this.endKnot=St||this.knots.length-1;for(let Mt=0;Mt<mt.length;++Mt){const Bt=mt[Mt];this.controlPoints[Mt]=new Vector4(Bt.x,Bt.y,Bt.z,Bt.w)}}getPoint(_,ut){const mt=ut||new Vector3,bt=this.knots[this.startKnot]+_*(this.knots[this.endKnot]-this.knots[this.startKnot]),St=calcBSplinePoint(this.degree,this.knots,this.controlPoints,bt);return St.w!=1&&St.divideScalar(St.w),mt.set(St.x,St.y,St.z)}getTangent(_,ut){const mt=ut||new Vector3,bt=this.knots[0]+_*(this.knots[this.knots.length-1]-this.knots[0]),St=calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,bt,1);return mt.copy(St[1]).normalize(),mt}}let fbxTree,connections,sceneGraph;class FBXLoader extends Loader{constructor(_){super(_)}load(_,ut,mt,bt){const St=this,Mt=St.path===""?LoaderUtils.extractUrlBase(_):St.path,Bt=new FileLoader(this.manager);Bt.setPath(St.path),Bt.setResponseType("arraybuffer"),Bt.setRequestHeader(St.requestHeader),Bt.setWithCredentials(St.withCredentials),Bt.load(_,function(Ut){try{ut(St.parse(Ut,Mt))}catch(Ht){bt?bt(Ht):console.error(Ht),St.manager.itemError(_)}},mt,bt)}parse(_,ut){if(isFbxFormatBinary(_))fbxTree=new BinaryParser().parse(_);else{const bt=convertArrayBufferToString(_);if(!isFbxFormatASCII(bt))throw new Error("THREE.FBXLoader: Unknown format.");if(getFbxVersion(bt)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+getFbxVersion(bt));fbxTree=new TextParser().parse(bt)}const mt=new TextureLoader(this.manager).setPath(this.resourcePath||ut).setCrossOrigin(this.crossOrigin);return new FBXTreeParser(mt,this.manager).parse(fbxTree)}}class FBXTreeParser{constructor(_,ut){this.textureLoader=_,this.manager=ut}parse(){connections=this.parseConnections();const _=this.parseImages(),ut=this.parseTextures(_),mt=this.parseMaterials(ut),bt=this.parseDeformers(),St=new GeometryParser().parse(bt);return this.parseScene(bt,St,mt),sceneGraph}parseConnections(){const _=new Map;return"Connections"in fbxTree&&fbxTree.Connections.connections.forEach(function(mt){const bt=mt[0],St=mt[1],Mt=mt[2];_.has(bt)||_.set(bt,{parents:[],children:[]});const Bt={ID:St,relationship:Mt};_.get(bt).parents.push(Bt),_.has(St)||_.set(St,{parents:[],children:[]});const Ut={ID:bt,relationship:Mt};_.get(St).children.push(Ut)}),_}parseImages(){const _={},ut={};if("Video"in fbxTree.Objects){const mt=fbxTree.Objects.Video;for(const bt in mt){const St=mt[bt],Mt=parseInt(bt);if(_[Mt]=St.RelativeFilename||St.Filename,"Content"in St){const Bt=St.Content instanceof ArrayBuffer&&St.Content.byteLength>0,Ut=typeof St.Content=="string"&&St.Content!=="";if(Bt||Ut){const Ht=this.parseImage(mt[bt]);ut[St.RelativeFilename||St.Filename]=Ht}}}}for(const mt in _){const bt=_[mt];ut[bt]!==void 0?_[mt]=ut[bt]:_[mt]=_[mt].split("\\").pop()}return _}parseImage(_){const ut=_.Content,mt=_.RelativeFilename||_.Filename,bt=mt.slice(mt.lastIndexOf(".")+1).toLowerCase();let St;switch(bt){case"bmp":St="image/bmp";break;case"jpg":case"jpeg":St="image/jpeg";break;case"png":St="image/png";break;case"tif":St="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",mt),St="image/tga";break;default:console.warn('FBXLoader: Image type "'+bt+'" is not supported.');return}if(typeof ut=="string")return"data:"+St+";base64,"+ut;{const Mt=new Uint8Array(ut);return window.URL.createObjectURL(new Blob([Mt],{type:St}))}}parseTextures(_){const ut=new Map;if("Texture"in fbxTree.Objects){const mt=fbxTree.Objects.Texture;for(const bt in mt){const St=this.parseTexture(mt[bt],_);ut.set(parseInt(bt),St)}}return ut}parseTexture(_,ut){const mt=this.loadTexture(_,ut);mt.ID=_.id,mt.name=_.attrName;const bt=_.WrapModeU,St=_.WrapModeV,Mt=bt!==void 0?bt.value:0,Bt=St!==void 0?St.value:0;if(mt.wrapS=Mt===0?RepeatWrapping:ClampToEdgeWrapping,mt.wrapT=Bt===0?RepeatWrapping:ClampToEdgeWrapping,"Scaling"in _){const Ut=_.Scaling.value;mt.repeat.x=Ut[0],mt.repeat.y=Ut[1]}return mt}loadTexture(_,ut){let mt;const bt=this.textureLoader.path,St=connections.get(_.id).children;St!==void 0&&St.length>0&&ut[St[0].ID]!==void 0&&(mt=ut[St[0].ID],(mt.indexOf("blob:")===0||mt.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let Mt;const Bt=_.FileName.slice(-3).toLowerCase();if(Bt==="tga"){const Ut=this.manager.getHandler(".tga");Ut===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",_.RelativeFilename),Mt=new Texture):(Ut.setPath(this.textureLoader.path),Mt=Ut.load(mt))}else Bt==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",_.RelativeFilename),Mt=new Texture):Mt=this.textureLoader.load(mt);return this.textureLoader.setPath(bt),Mt}parseMaterials(_){const ut=new Map;if("Material"in fbxTree.Objects){const mt=fbxTree.Objects.Material;for(const bt in mt){const St=this.parseMaterial(mt[bt],_);St!==null&&ut.set(parseInt(bt),St)}}return ut}parseMaterial(_,ut){const mt=_.id,bt=_.attrName;let St=_.ShadingModel;if(typeof St=="object"&&(St=St.value),!connections.has(mt))return null;const Mt=this.parseParameters(_,ut,mt);let Bt;switch(St.toLowerCase()){case"phong":Bt=new MeshPhongMaterial;break;case"lambert":Bt=new MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',St),Bt=new MeshPhongMaterial;break}return Bt.setValues(Mt),Bt.name=bt,Bt}parseParameters(_,ut,mt){const bt={};_.BumpFactor&&(bt.bumpScale=_.BumpFactor.value),_.Diffuse?bt.color=new Color$1().fromArray(_.Diffuse.value):_.DiffuseColor&&(_.DiffuseColor.type==="Color"||_.DiffuseColor.type==="ColorRGB")&&(bt.color=new Color$1().fromArray(_.DiffuseColor.value)),_.DisplacementFactor&&(bt.displacementScale=_.DisplacementFactor.value),_.Emissive?bt.emissive=new Color$1().fromArray(_.Emissive.value):_.EmissiveColor&&(_.EmissiveColor.type==="Color"||_.EmissiveColor.type==="ColorRGB")&&(bt.emissive=new Color$1().fromArray(_.EmissiveColor.value)),_.EmissiveFactor&&(bt.emissiveIntensity=parseFloat(_.EmissiveFactor.value)),_.Opacity&&(bt.opacity=parseFloat(_.Opacity.value)),bt.opacity<1&&(bt.transparent=!0),_.ReflectionFactor&&(bt.reflectivity=_.ReflectionFactor.value),_.Shininess&&(bt.shininess=_.Shininess.value),_.Specular?bt.specular=new Color$1().fromArray(_.Specular.value):_.SpecularColor&&_.SpecularColor.type==="Color"&&(bt.specular=new Color$1().fromArray(_.SpecularColor.value));const St=this;return connections.get(mt).children.forEach(function(Mt){const Bt=Mt.relationship;switch(Bt){case"Bump":bt.bumpMap=St.getTexture(ut,Mt.ID);break;case"Maya|TEX_ao_map":bt.aoMap=St.getTexture(ut,Mt.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":bt.map=St.getTexture(ut,Mt.ID),bt.map!==void 0&&("colorSpace"in bt.map?bt.map.colorSpace="srgb":bt.map.encoding=3001);break;case"DisplacementColor":bt.displacementMap=St.getTexture(ut,Mt.ID);break;case"EmissiveColor":bt.emissiveMap=St.getTexture(ut,Mt.ID),bt.emissiveMap!==void 0&&("colorSpace"in bt.emissiveMap?bt.emissiveMap.colorSpace="srgb":bt.emissiveMap.encoding=3001);break;case"NormalMap":case"Maya|TEX_normal_map":bt.normalMap=St.getTexture(ut,Mt.ID);break;case"ReflectionColor":bt.envMap=St.getTexture(ut,Mt.ID),bt.envMap!==void 0&&(bt.envMap.mapping=EquirectangularReflectionMapping,"colorSpace"in bt.envMap?bt.envMap.colorSpace="srgb":bt.envMap.encoding=3001);break;case"SpecularColor":bt.specularMap=St.getTexture(ut,Mt.ID),bt.specularMap!==void 0&&("colorSpace"in bt.specularMap?bt.specularMap.colorSpace="srgb":bt.specularMap.encoding=3001);break;case"TransparentColor":case"TransparencyFactor":bt.alphaMap=St.getTexture(ut,Mt.ID),bt.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",Bt);break}}),bt}getTexture(_,ut){return"LayeredTexture"in fbxTree.Objects&&ut in fbxTree.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),ut=connections.get(ut).children[0].ID),_.get(ut)}parseDeformers(){const _={},ut={};if("Deformer"in fbxTree.Objects){const mt=fbxTree.Objects.Deformer;for(const bt in mt){const St=mt[bt],Mt=connections.get(parseInt(bt));if(St.attrType==="Skin"){const Bt=this.parseSkeleton(Mt,mt);Bt.ID=bt,Mt.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),Bt.geometryID=Mt.parents[0].ID,_[bt]=Bt}else if(St.attrType==="BlendShape"){const Bt={id:bt};Bt.rawTargets=this.parseMorphTargets(Mt,mt),Bt.id=bt,Mt.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),ut[bt]=Bt}}}return{skeletons:_,morphTargets:ut}}parseSkeleton(_,ut){const mt=[];return _.children.forEach(function(bt){const St=ut[bt.ID];if(St.attrType!=="Cluster")return;const Mt={ID:bt.ID,indices:[],weights:[],transformLink:new Matrix4().fromArray(St.TransformLink.a)};"Indexes"in St&&(Mt.indices=St.Indexes.a,Mt.weights=St.Weights.a),mt.push(Mt)}),{rawBones:mt,bones:[]}}parseMorphTargets(_,ut){const mt=[];for(let bt=0;bt<_.children.length;bt++){const St=_.children[bt],Mt=ut[St.ID],Bt={name:Mt.attrName,initialWeight:Mt.DeformPercent,id:Mt.id,fullWeights:Mt.FullWeights.a};if(Mt.attrType!=="BlendShapeChannel")return;Bt.geoID=connections.get(parseInt(St.ID)).children.filter(function(Ut){return Ut.relationship===void 0})[0].ID,mt.push(Bt)}return mt}parseScene(_,ut,mt){sceneGraph=new Group$1;const bt=this.parseModels(_.skeletons,ut,mt),St=fbxTree.Objects.Model,Mt=this;bt.forEach(function(Ut){const Ht=St[Ut.ID];Mt.setLookAtProperties(Ut,Ht),connections.get(Ut.ID).parents.forEach(function(rr){const sr=bt.get(rr.ID);sr!==void 0&&sr.add(Ut)}),Ut.parent===null&&sceneGraph.add(Ut)}),this.bindSkeleton(_.skeletons,ut,bt),this.createAmbientLight(),sceneGraph.traverse(function(Ut){if(Ut.userData.transformData){Ut.parent&&(Ut.userData.transformData.parentMatrix=Ut.parent.matrix,Ut.userData.transformData.parentMatrixWorld=Ut.parent.matrixWorld);const Ht=generateTransform(Ut.userData.transformData);Ut.applyMatrix4(Ht),Ut.updateWorldMatrix()}});const Bt=new AnimationParser().parse();sceneGraph.children.length===1&&sceneGraph.children[0].isGroup&&(sceneGraph.children[0].animations=Bt,sceneGraph=sceneGraph.children[0]),sceneGraph.animations=Bt}parseModels(_,ut,mt){const bt=new Map,St=fbxTree.Objects.Model;for(const Mt in St){const Bt=parseInt(Mt),Ut=St[Mt],Ht=connections.get(Bt);let tr=this.buildSkeleton(Ht,_,Bt,Ut.attrName);if(!tr){switch(Ut.attrType){case"Camera":tr=this.createCamera(Ht);break;case"Light":tr=this.createLight(Ht);break;case"Mesh":tr=this.createMesh(Ht,ut,mt);break;case"NurbsCurve":tr=this.createCurve(Ht,ut);break;case"LimbNode":case"Root":tr=new Bone;break;case"Null":default:tr=new Group$1;break}tr.name=Ut.attrName?PropertyBinding.sanitizeNodeName(Ut.attrName):"",tr.ID=Bt}this.getTransformData(tr,Ut),bt.set(Bt,tr)}return bt}buildSkeleton(_,ut,mt,bt){let St=null;return _.parents.forEach(function(Mt){for(const Bt in ut){const Ut=ut[Bt];Ut.rawBones.forEach(function(Ht,tr){if(Ht.ID===Mt.ID){const rr=St;St=new Bone,St.matrixWorld.copy(Ht.transformLink),St.name=bt?PropertyBinding.sanitizeNodeName(bt):"",St.ID=mt,Ut.bones[tr]=St,rr!==null&&St.add(rr)}})}}),St}createCamera(_){let ut,mt;if(_.children.forEach(function(bt){const St=fbxTree.Objects.NodeAttribute[bt.ID];St!==void 0&&(mt=St)}),mt===void 0)ut=new Object3D;else{let bt=0;mt.CameraProjectionType!==void 0&&mt.CameraProjectionType.value===1&&(bt=1);let St=1;mt.NearPlane!==void 0&&(St=mt.NearPlane.value/1e3);let Mt=1e3;mt.FarPlane!==void 0&&(Mt=mt.FarPlane.value/1e3);let Bt=window.innerWidth,Ut=window.innerHeight;mt.AspectWidth!==void 0&&mt.AspectHeight!==void 0&&(Bt=mt.AspectWidth.value,Ut=mt.AspectHeight.value);const Ht=Bt/Ut;let tr=45;mt.FieldOfView!==void 0&&(tr=mt.FieldOfView.value);const rr=mt.FocalLength?mt.FocalLength.value:null;switch(bt){case 0:ut=new PerspectiveCamera$1(tr,Ht,St,Mt),rr!==null&&ut.setFocalLength(rr);break;case 1:ut=new OrthographicCamera$1(-Bt/2,Bt/2,Ut/2,-Ut/2,St,Mt);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+bt+"."),ut=new Object3D;break}}return ut}createLight(_){let ut,mt;if(_.children.forEach(function(bt){const St=fbxTree.Objects.NodeAttribute[bt.ID];St!==void 0&&(mt=St)}),mt===void 0)ut=new Object3D;else{let bt;mt.LightType===void 0?bt=0:bt=mt.LightType.value;let St=16777215;mt.Color!==void 0&&(St=new Color$1().fromArray(mt.Color.value));let Mt=mt.Intensity===void 0?1:mt.Intensity.value/100;mt.CastLightOnObject!==void 0&&mt.CastLightOnObject.value===0&&(Mt=0);let Bt=0;mt.FarAttenuationEnd!==void 0&&(mt.EnableFarAttenuation!==void 0&&mt.EnableFarAttenuation.value===0?Bt=0:Bt=mt.FarAttenuationEnd.value);const Ut=1;switch(bt){case 0:ut=new PointLight(St,Mt,Bt,Ut);break;case 1:ut=new DirectionalLight(St,Mt);break;case 2:let Ht=Math.PI/3;mt.InnerAngle!==void 0&&(Ht=MathUtils.degToRad(mt.InnerAngle.value));let tr=0;mt.OuterAngle!==void 0&&(tr=MathUtils.degToRad(mt.OuterAngle.value),tr=Math.max(tr,1)),ut=new SpotLight(St,Mt,Bt,Ht,tr,Ut);break;default:console.warn("THREE.FBXLoader: Unknown light type "+mt.LightType.value+", defaulting to a PointLight."),ut=new PointLight(St,Mt);break}mt.CastShadows!==void 0&&mt.CastShadows.value===1&&(ut.castShadow=!0)}return ut}createMesh(_,ut,mt){let bt,St=null,Mt=null;const Bt=[];return _.children.forEach(function(Ut){ut.has(Ut.ID)&&(St=ut.get(Ut.ID)),mt.has(Ut.ID)&&Bt.push(mt.get(Ut.ID))}),Bt.length>1?Mt=Bt:Bt.length>0?Mt=Bt[0]:(Mt=new MeshPhongMaterial({color:13421772}),Bt.push(Mt)),"color"in St.attributes&&Bt.forEach(function(Ut){Ut.vertexColors=!0}),St.FBX_Deformer?(bt=new SkinnedMesh(St,Mt),bt.normalizeSkinWeights()):bt=new Mesh(St,Mt),bt}createCurve(_,ut){const mt=_.children.reduce(function(St,Mt){return ut.has(Mt.ID)&&(St=ut.get(Mt.ID)),St},null),bt=new LineBasicMaterial({color:3342591,linewidth:1});return new Line(mt,bt)}getTransformData(_,ut){const mt={};"InheritType"in ut&&(mt.inheritType=parseInt(ut.InheritType.value)),"RotationOrder"in ut?mt.eulerOrder=getEulerOrder(ut.RotationOrder.value):mt.eulerOrder="ZYX","Lcl_Translation"in ut&&(mt.translation=ut.Lcl_Translation.value),"PreRotation"in ut&&(mt.preRotation=ut.PreRotation.value),"Lcl_Rotation"in ut&&(mt.rotation=ut.Lcl_Rotation.value),"PostRotation"in ut&&(mt.postRotation=ut.PostRotation.value),"Lcl_Scaling"in ut&&(mt.scale=ut.Lcl_Scaling.value),"ScalingOffset"in ut&&(mt.scalingOffset=ut.ScalingOffset.value),"ScalingPivot"in ut&&(mt.scalingPivot=ut.ScalingPivot.value),"RotationOffset"in ut&&(mt.rotationOffset=ut.RotationOffset.value),"RotationPivot"in ut&&(mt.rotationPivot=ut.RotationPivot.value),_.userData.transformData=mt}setLookAtProperties(_,ut){"LookAtProperty"in ut&&connections.get(_.ID).children.forEach(function(bt){if(bt.relationship==="LookAtProperty"){const St=fbxTree.Objects.Model[bt.ID];if("Lcl_Translation"in St){const Mt=St.Lcl_Translation.value;_.target!==void 0?(_.target.position.fromArray(Mt),sceneGraph.add(_.target)):_.lookAt(new Vector3().fromArray(Mt))}}})}bindSkeleton(_,ut,mt){const bt=this.parsePoseNodes();for(const St in _){const Mt=_[St];connections.get(parseInt(Mt.ID)).parents.forEach(function(Ut){if(ut.has(Ut.ID)){const Ht=Ut.ID;connections.get(Ht).parents.forEach(function(rr){mt.has(rr.ID)&&mt.get(rr.ID).bind(new Skeleton(Mt.bones),bt[rr.ID])})}})}}parsePoseNodes(){const _={};if("Pose"in fbxTree.Objects){const ut=fbxTree.Objects.Pose;for(const mt in ut)if(ut[mt].attrType==="BindPose"&&ut[mt].NbPoseNodes>0){const bt=ut[mt].PoseNode;Array.isArray(bt)?bt.forEach(function(St){_[St.Node]=new Matrix4().fromArray(St.Matrix.a)}):_[bt.Node]=new Matrix4().fromArray(bt.Matrix.a)}}return _}createAmbientLight(){if("GlobalSettings"in fbxTree&&"AmbientColor"in fbxTree.GlobalSettings){const _=fbxTree.GlobalSettings.AmbientColor.value,ut=_[0],mt=_[1],bt=_[2];if(ut!==0||mt!==0||bt!==0){const St=new Color$1(ut,mt,bt);sceneGraph.add(new AmbientLight(St,1))}}}}class GeometryParser{parse(_){const ut=new Map;if("Geometry"in fbxTree.Objects){const mt=fbxTree.Objects.Geometry;for(const bt in mt){const St=connections.get(parseInt(bt)),Mt=this.parseGeometry(St,mt[bt],_);ut.set(parseInt(bt),Mt)}}return ut}parseGeometry(_,ut,mt){switch(ut.attrType){case"Mesh":return this.parseMeshGeometry(_,ut,mt);case"NurbsCurve":return this.parseNurbsGeometry(ut)}}parseMeshGeometry(_,ut,mt){const bt=mt.skeletons,St=[],Mt=_.parents.map(function(rr){return fbxTree.Objects.Model[rr.ID]});if(Mt.length===0)return;const Bt=_.children.reduce(function(rr,sr){return bt[sr.ID]!==void 0&&(rr=bt[sr.ID]),rr},null);_.children.forEach(function(rr){mt.morphTargets[rr.ID]!==void 0&&St.push(mt.morphTargets[rr.ID])});const Ut=Mt[0],Ht={};"RotationOrder"in Ut&&(Ht.eulerOrder=getEulerOrder(Ut.RotationOrder.value)),"InheritType"in Ut&&(Ht.inheritType=parseInt(Ut.InheritType.value)),"GeometricTranslation"in Ut&&(Ht.translation=Ut.GeometricTranslation.value),"GeometricRotation"in Ut&&(Ht.rotation=Ut.GeometricRotation.value),"GeometricScaling"in Ut&&(Ht.scale=Ut.GeometricScaling.value);const tr=generateTransform(Ht);return this.genGeometry(ut,Bt,St,tr)}genGeometry(_,ut,mt,bt){const St=new BufferGeometry;_.attrName&&(St.name=_.attrName);const Mt=this.parseGeoNode(_,ut),Bt=this.genBuffers(Mt),Ut=new Float32BufferAttribute(Bt.vertex,3);if(Ut.applyMatrix4(bt),St.setAttribute("position",Ut),Bt.colors.length>0&&St.setAttribute("color",new Float32BufferAttribute(Bt.colors,3)),ut&&(St.setAttribute("skinIndex",new Uint16BufferAttribute(Bt.weightsIndices,4)),St.setAttribute("skinWeight",new Float32BufferAttribute(Bt.vertexWeights,4)),St.FBX_Deformer=ut),Bt.normal.length>0){const Ht=new Matrix3().getNormalMatrix(bt),tr=new Float32BufferAttribute(Bt.normal,3);tr.applyNormalMatrix(Ht),St.setAttribute("normal",tr)}if(Bt.uvs.forEach(function(Ht,tr){let rr="uv"+(tr+1).toString();tr===0&&(rr="uv"),St.setAttribute(rr,new Float32BufferAttribute(Bt.uvs[tr],2))}),Mt.material&&Mt.material.mappingType!=="AllSame"){let Ht=Bt.materialIndex[0],tr=0;if(Bt.materialIndex.forEach(function(rr,sr){rr!==Ht&&(St.addGroup(tr,sr-tr,Ht),Ht=rr,tr=sr)}),St.groups.length>0){const rr=St.groups[St.groups.length-1],sr=rr.start+rr.count;sr!==Bt.materialIndex.length&&St.addGroup(sr,Bt.materialIndex.length-sr,Ht)}St.groups.length===0&&St.addGroup(0,Bt.materialIndex.length,Bt.materialIndex[0])}return this.addMorphTargets(St,_,mt,bt),St}parseGeoNode(_,ut){const mt={};if(mt.vertexPositions=_.Vertices!==void 0?_.Vertices.a:[],mt.vertexIndices=_.PolygonVertexIndex!==void 0?_.PolygonVertexIndex.a:[],_.LayerElementColor&&(mt.color=this.parseVertexColors(_.LayerElementColor[0])),_.LayerElementMaterial&&(mt.material=this.parseMaterialIndices(_.LayerElementMaterial[0])),_.LayerElementNormal&&(mt.normal=this.parseNormals(_.LayerElementNormal[0])),_.LayerElementUV){mt.uv=[];let bt=0;for(;_.LayerElementUV[bt];)_.LayerElementUV[bt].UV&&mt.uv.push(this.parseUVs(_.LayerElementUV[bt])),bt++}return mt.weightTable={},ut!==null&&(mt.skeleton=ut,ut.rawBones.forEach(function(bt,St){bt.indices.forEach(function(Mt,Bt){mt.weightTable[Mt]===void 0&&(mt.weightTable[Mt]=[]),mt.weightTable[Mt].push({id:St,weight:bt.weights[Bt]})})})),mt}genBuffers(_){const ut={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let mt=0,bt=0,St=!1,Mt=[],Bt=[],Ut=[],Ht=[],tr=[],rr=[];const sr=this;return _.vertexIndices.forEach(function(ar,cr){let Ar,_r=!1;ar<0&&(ar=ar^-1,_r=!0);let Dr=[],$r=[];if(Mt.push(ar*3,ar*3+1,ar*3+2),_.color){const Br=getData(cr,mt,ar,_.color);Ut.push(Br[0],Br[1],Br[2])}if(_.skeleton){if(_.weightTable[ar]!==void 0&&_.weightTable[ar].forEach(function(Br){$r.push(Br.weight),Dr.push(Br.id)}),$r.length>4){St||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),St=!0);const Br=[0,0,0,0],Jr=[0,0,0,0];$r.forEach(function(mn,Mn){let $n=mn,en=Dr[Mn];Jr.forEach(function(In,Rn,qn){if($n>In){qn[Rn]=$n,$n=In;const Qn=Br[Rn];Br[Rn]=en,en=Qn}})}),Dr=Br,$r=Jr}for(;$r.length<4;)$r.push(0),Dr.push(0);for(let Br=0;Br<4;++Br)tr.push($r[Br]),rr.push(Dr[Br])}if(_.normal){const Br=getData(cr,mt,ar,_.normal);Bt.push(Br[0],Br[1],Br[2])}_.material&&_.material.mappingType!=="AllSame"&&(Ar=getData(cr,mt,ar,_.material)[0]),_.uv&&_.uv.forEach(function(Br,Jr){const mn=getData(cr,mt,ar,Br);Ht[Jr]===void 0&&(Ht[Jr]=[]),Ht[Jr].push(mn[0]),Ht[Jr].push(mn[1])}),bt++,_r&&(sr.genFace(ut,_,Mt,Ar,Bt,Ut,Ht,tr,rr,bt),mt++,bt=0,Mt=[],Bt=[],Ut=[],Ht=[],tr=[],rr=[])}),ut}genFace(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr){for(let rr=2;rr<tr;rr++)_.vertex.push(ut.vertexPositions[mt[0]]),_.vertex.push(ut.vertexPositions[mt[1]]),_.vertex.push(ut.vertexPositions[mt[2]]),_.vertex.push(ut.vertexPositions[mt[(rr-1)*3]]),_.vertex.push(ut.vertexPositions[mt[(rr-1)*3+1]]),_.vertex.push(ut.vertexPositions[mt[(rr-1)*3+2]]),_.vertex.push(ut.vertexPositions[mt[rr*3]]),_.vertex.push(ut.vertexPositions[mt[rr*3+1]]),_.vertex.push(ut.vertexPositions[mt[rr*3+2]]),ut.skeleton&&(_.vertexWeights.push(Ut[0]),_.vertexWeights.push(Ut[1]),_.vertexWeights.push(Ut[2]),_.vertexWeights.push(Ut[3]),_.vertexWeights.push(Ut[(rr-1)*4]),_.vertexWeights.push(Ut[(rr-1)*4+1]),_.vertexWeights.push(Ut[(rr-1)*4+2]),_.vertexWeights.push(Ut[(rr-1)*4+3]),_.vertexWeights.push(Ut[rr*4]),_.vertexWeights.push(Ut[rr*4+1]),_.vertexWeights.push(Ut[rr*4+2]),_.vertexWeights.push(Ut[rr*4+3]),_.weightsIndices.push(Ht[0]),_.weightsIndices.push(Ht[1]),_.weightsIndices.push(Ht[2]),_.weightsIndices.push(Ht[3]),_.weightsIndices.push(Ht[(rr-1)*4]),_.weightsIndices.push(Ht[(rr-1)*4+1]),_.weightsIndices.push(Ht[(rr-1)*4+2]),_.weightsIndices.push(Ht[(rr-1)*4+3]),_.weightsIndices.push(Ht[rr*4]),_.weightsIndices.push(Ht[rr*4+1]),_.weightsIndices.push(Ht[rr*4+2]),_.weightsIndices.push(Ht[rr*4+3])),ut.color&&(_.colors.push(Mt[0]),_.colors.push(Mt[1]),_.colors.push(Mt[2]),_.colors.push(Mt[(rr-1)*3]),_.colors.push(Mt[(rr-1)*3+1]),_.colors.push(Mt[(rr-1)*3+2]),_.colors.push(Mt[rr*3]),_.colors.push(Mt[rr*3+1]),_.colors.push(Mt[rr*3+2])),ut.material&&ut.material.mappingType!=="AllSame"&&(_.materialIndex.push(bt),_.materialIndex.push(bt),_.materialIndex.push(bt)),ut.normal&&(_.normal.push(St[0]),_.normal.push(St[1]),_.normal.push(St[2]),_.normal.push(St[(rr-1)*3]),_.normal.push(St[(rr-1)*3+1]),_.normal.push(St[(rr-1)*3+2]),_.normal.push(St[rr*3]),_.normal.push(St[rr*3+1]),_.normal.push(St[rr*3+2])),ut.uv&&ut.uv.forEach(function(sr,ar){_.uvs[ar]===void 0&&(_.uvs[ar]=[]),_.uvs[ar].push(Bt[ar][0]),_.uvs[ar].push(Bt[ar][1]),_.uvs[ar].push(Bt[ar][(rr-1)*2]),_.uvs[ar].push(Bt[ar][(rr-1)*2+1]),_.uvs[ar].push(Bt[ar][rr*2]),_.uvs[ar].push(Bt[ar][rr*2+1])})}addMorphTargets(_,ut,mt,bt){if(mt.length===0)return;_.morphTargetsRelative=!0,_.morphAttributes.position=[];const St=this;mt.forEach(function(Mt){Mt.rawTargets.forEach(function(Bt){const Ut=fbxTree.Objects.Geometry[Bt.geoID];Ut!==void 0&&St.genMorphGeometry(_,ut,Ut,bt,Bt.name)})})}genMorphGeometry(_,ut,mt,bt,St){const Mt=ut.PolygonVertexIndex!==void 0?ut.PolygonVertexIndex.a:[],Bt=mt.Vertices!==void 0?mt.Vertices.a:[],Ut=mt.Indexes!==void 0?mt.Indexes.a:[],Ht=_.attributes.position.count*3,tr=new Float32Array(Ht);for(let cr=0;cr<Ut.length;cr++){const Ar=Ut[cr]*3;tr[Ar]=Bt[cr*3],tr[Ar+1]=Bt[cr*3+1],tr[Ar+2]=Bt[cr*3+2]}const rr={vertexIndices:Mt,vertexPositions:tr},sr=this.genBuffers(rr),ar=new Float32BufferAttribute(sr.vertex,3);ar.name=St||mt.attrName,ar.applyMatrix4(bt),_.morphAttributes.position.push(ar)}parseNormals(_){const ut=_.MappingInformationType,mt=_.ReferenceInformationType,bt=_.Normals.a;let St=[];return mt==="IndexToDirect"&&("NormalIndex"in _?St=_.NormalIndex.a:"NormalsIndex"in _&&(St=_.NormalsIndex.a)),{dataSize:3,buffer:bt,indices:St,mappingType:ut,referenceType:mt}}parseUVs(_){const ut=_.MappingInformationType,mt=_.ReferenceInformationType,bt=_.UV.a;let St=[];return mt==="IndexToDirect"&&(St=_.UVIndex.a),{dataSize:2,buffer:bt,indices:St,mappingType:ut,referenceType:mt}}parseVertexColors(_){const ut=_.MappingInformationType,mt=_.ReferenceInformationType,bt=_.Colors.a;let St=[];return mt==="IndexToDirect"&&(St=_.ColorIndex.a),{dataSize:4,buffer:bt,indices:St,mappingType:ut,referenceType:mt}}parseMaterialIndices(_){const ut=_.MappingInformationType,mt=_.ReferenceInformationType;if(ut==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:mt};const bt=_.Materials.a,St=[];for(let Mt=0;Mt<bt.length;++Mt)St.push(Mt);return{dataSize:1,buffer:bt,indices:St,mappingType:ut,referenceType:mt}}parseNurbsGeometry(_){if(NURBSCurve===void 0)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new BufferGeometry;const ut=parseInt(_.Order);if(isNaN(ut))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",_.Order,_.id),new BufferGeometry;const mt=ut-1,bt=_.KnotVector.a,St=[],Mt=_.Points.a;for(let rr=0,sr=Mt.length;rr<sr;rr+=4)St.push(new Vector4().fromArray(Mt,rr));let Bt,Ut;if(_.Form==="Closed")St.push(St[0]);else if(_.Form==="Periodic"){Bt=mt,Ut=bt.length-1-Bt;for(let rr=0;rr<mt;++rr)St.push(St[rr])}const tr=new NURBSCurve(mt,bt,St,Bt,Ut).getPoints(St.length*12);return new BufferGeometry().setFromPoints(tr)}}class AnimationParser{parse(){const _=[],ut=this.parseClips();if(ut!==void 0)for(const mt in ut){const bt=ut[mt],St=this.addClip(bt);_.push(St)}return _}parseClips(){if(fbxTree.Objects.AnimationCurve===void 0)return;const _=this.parseAnimationCurveNodes();this.parseAnimationCurves(_);const ut=this.parseAnimationLayers(_);return this.parseAnimStacks(ut)}parseAnimationCurveNodes(){const _=fbxTree.Objects.AnimationCurveNode,ut=new Map;for(const mt in _){const bt=_[mt];if(bt.attrName.match(/S|R|T|DeformPercent/)!==null){const St={id:bt.id,attr:bt.attrName,curves:{}};ut.set(St.id,St)}}return ut}parseAnimationCurves(_){const ut=fbxTree.Objects.AnimationCurve;for(const mt in ut){const bt={id:ut[mt].id,times:ut[mt].KeyTime.a.map(convertFBXTimeToSeconds),values:ut[mt].KeyValueFloat.a},St=connections.get(bt.id);if(St!==void 0){const Mt=St.parents[0].ID,Bt=St.parents[0].relationship;Bt.match(/X/)?_.get(Mt).curves.x=bt:Bt.match(/Y/)?_.get(Mt).curves.y=bt:Bt.match(/Z/)?_.get(Mt).curves.z=bt:Bt.match(/d|DeformPercent/)&&_.has(Mt)&&(_.get(Mt).curves.morph=bt)}}}parseAnimationLayers(_){const ut=fbxTree.Objects.AnimationLayer,mt=new Map;for(const bt in ut){const St=[],Mt=connections.get(parseInt(bt));Mt!==void 0&&(Mt.children.forEach(function(Ut,Ht){if(_.has(Ut.ID)){const tr=_.get(Ut.ID);if(tr.curves.x!==void 0||tr.curves.y!==void 0||tr.curves.z!==void 0){if(St[Ht]===void 0){const rr=connections.get(Ut.ID).parents.filter(function(sr){return sr.relationship!==void 0})[0].ID;if(rr!==void 0){const sr=fbxTree.Objects.Model[rr.toString()];if(sr===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",Ut);return}const ar={modelName:sr.attrName?PropertyBinding.sanitizeNodeName(sr.attrName):"",ID:sr.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};sceneGraph.traverse(function(cr){cr.ID===sr.id&&(ar.transform=cr.matrix,cr.userData.transformData&&(ar.eulerOrder=cr.userData.transformData.eulerOrder))}),ar.transform||(ar.transform=new Matrix4),"PreRotation"in sr&&(ar.preRotation=sr.PreRotation.value),"PostRotation"in sr&&(ar.postRotation=sr.PostRotation.value),St[Ht]=ar}}St[Ht]&&(St[Ht][tr.attr]=tr)}else if(tr.curves.morph!==void 0){if(St[Ht]===void 0){const rr=connections.get(Ut.ID).parents.filter(function(Dr){return Dr.relationship!==void 0})[0].ID,sr=connections.get(rr).parents[0].ID,ar=connections.get(sr).parents[0].ID,cr=connections.get(ar).parents[0].ID,Ar=fbxTree.Objects.Model[cr],_r={modelName:Ar.attrName?PropertyBinding.sanitizeNodeName(Ar.attrName):"",morphName:fbxTree.Objects.Deformer[rr].attrName};St[Ht]=_r}St[Ht][tr.attr]=tr}}}),mt.set(parseInt(bt),St))}return mt}parseAnimStacks(_){const ut=fbxTree.Objects.AnimationStack,mt={};for(const bt in ut){const St=connections.get(parseInt(bt)).children;St.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const Mt=_.get(St[0].ID);mt[bt]={name:ut[bt].attrName,layer:Mt}}return mt}addClip(_){let ut=[];const mt=this;return _.layer.forEach(function(bt){ut=ut.concat(mt.generateTracks(bt))}),new AnimationClip(_.name,-1,ut)}generateTracks(_){const ut=[];let mt=new Vector3,bt=new Quaternion,St=new Vector3;if(_.transform&&_.transform.decompose(mt,bt,St),mt=mt.toArray(),bt=new Euler().setFromQuaternion(bt,_.eulerOrder).toArray(),St=St.toArray(),_.T!==void 0&&Object.keys(_.T.curves).length>0){const Mt=this.generateVectorTrack(_.modelName,_.T.curves,mt,"position");Mt!==void 0&&ut.push(Mt)}if(_.R!==void 0&&Object.keys(_.R.curves).length>0){const Mt=this.generateRotationTrack(_.modelName,_.R.curves,bt,_.preRotation,_.postRotation,_.eulerOrder);Mt!==void 0&&ut.push(Mt)}if(_.S!==void 0&&Object.keys(_.S.curves).length>0){const Mt=this.generateVectorTrack(_.modelName,_.S.curves,St,"scale");Mt!==void 0&&ut.push(Mt)}if(_.DeformPercent!==void 0){const Mt=this.generateMorphTrack(_);Mt!==void 0&&ut.push(Mt)}return ut}generateVectorTrack(_,ut,mt,bt){const St=this.getTimesForAllAxes(ut),Mt=this.getKeyframeTrackValues(St,ut,mt);return new VectorKeyframeTrack(_+"."+bt,St,Mt)}generateRotationTrack(_,ut,mt,bt,St,Mt){ut.x!==void 0&&(this.interpolateRotations(ut.x),ut.x.values=ut.x.values.map(MathUtils.degToRad)),ut.y!==void 0&&(this.interpolateRotations(ut.y),ut.y.values=ut.y.values.map(MathUtils.degToRad)),ut.z!==void 0&&(this.interpolateRotations(ut.z),ut.z.values=ut.z.values.map(MathUtils.degToRad));const Bt=this.getTimesForAllAxes(ut),Ut=this.getKeyframeTrackValues(Bt,ut,mt);bt!==void 0&&(bt=bt.map(MathUtils.degToRad),bt.push(Mt),bt=new Euler().fromArray(bt),bt=new Quaternion().setFromEuler(bt)),St!==void 0&&(St=St.map(MathUtils.degToRad),St.push(Mt),St=new Euler().fromArray(St),St=new Quaternion().setFromEuler(St).invert());const Ht=new Quaternion,tr=new Euler,rr=[];for(let sr=0;sr<Ut.length;sr+=3)tr.set(Ut[sr],Ut[sr+1],Ut[sr+2],Mt),Ht.setFromEuler(tr),bt!==void 0&&Ht.premultiply(bt),St!==void 0&&Ht.multiply(St),Ht.toArray(rr,sr/3*4);return new QuaternionKeyframeTrack(_+".quaternion",Bt,rr)}generateMorphTrack(_){const ut=_.DeformPercent.curves.morph,mt=ut.values.map(function(St){return St/100}),bt=sceneGraph.getObjectByName(_.modelName).morphTargetDictionary[_.morphName];return new NumberKeyframeTrack(_.modelName+".morphTargetInfluences["+bt+"]",ut.times,mt)}getTimesForAllAxes(_){let ut=[];if(_.x!==void 0&&(ut=ut.concat(_.x.times)),_.y!==void 0&&(ut=ut.concat(_.y.times)),_.z!==void 0&&(ut=ut.concat(_.z.times)),ut=ut.sort(function(mt,bt){return mt-bt}),ut.length>1){let mt=1,bt=ut[0];for(let St=1;St<ut.length;St++){const Mt=ut[St];Mt!==bt&&(ut[mt]=Mt,bt=Mt,mt++)}ut=ut.slice(0,mt)}return ut}getKeyframeTrackValues(_,ut,mt){const bt=mt,St=[];let Mt=-1,Bt=-1,Ut=-1;return _.forEach(function(Ht){if(ut.x&&(Mt=ut.x.times.indexOf(Ht)),ut.y&&(Bt=ut.y.times.indexOf(Ht)),ut.z&&(Ut=ut.z.times.indexOf(Ht)),Mt!==-1){const tr=ut.x.values[Mt];St.push(tr),bt[0]=tr}else St.push(bt[0]);if(Bt!==-1){const tr=ut.y.values[Bt];St.push(tr),bt[1]=tr}else St.push(bt[1]);if(Ut!==-1){const tr=ut.z.values[Ut];St.push(tr),bt[2]=tr}else St.push(bt[2])}),St}interpolateRotations(_){for(let ut=1;ut<_.values.length;ut++){const mt=_.values[ut-1],bt=_.values[ut]-mt,St=Math.abs(bt);if(St>=180){const Mt=St/180,Bt=bt/Mt;let Ut=mt+Bt;const Ht=_.times[ut-1],rr=(_.times[ut]-Ht)/Mt;let sr=Ht+rr;const ar=[],cr=[];for(;sr<_.times[ut];)ar.push(sr),sr+=rr,cr.push(Ut),Ut+=Bt;_.times=inject(_.times,ut,ar),_.values=inject(_.values,ut,cr)}}}}class TextParser{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(_){this.nodeStack.push(_),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(_,ut){this.currentProp=_,this.currentPropName=ut}parse(_){this.currentIndent=0,this.allNodes=new FBXTree,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const ut=this,mt=_.split(/[\r\n]+/);return mt.forEach(function(bt,St){const Mt=bt.match(/^[\s\t]*;/),Bt=bt.match(/^[\s\t]*$/);if(Mt||Bt)return;const Ut=bt.match("^\\t{"+ut.currentIndent+"}(\\w+):(.*){",""),Ht=bt.match("^\\t{"+ut.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),tr=bt.match("^\\t{"+(ut.currentIndent-1)+"}}");Ut?ut.parseNodeBegin(bt,Ut):Ht?ut.parseNodeProperty(bt,Ht,mt[++St]):tr?ut.popStack():bt.match(/^[^\s\t}]/)&&ut.parseNodePropertyContinued(bt)}),this.allNodes}parseNodeBegin(_,ut){const mt=ut[1].trim().replace(/^"/,"").replace(/"$/,""),bt=ut[2].split(",").map(function(Ut){return Ut.trim().replace(/^"/,"").replace(/"$/,"")}),St={name:mt},Mt=this.parseNodeAttr(bt),Bt=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(mt,St):mt in Bt?(mt==="PoseNode"?Bt.PoseNode.push(St):Bt[mt].id!==void 0&&(Bt[mt]={},Bt[mt][Bt[mt].id]=Bt[mt]),Mt.id!==""&&(Bt[mt][Mt.id]=St)):typeof Mt.id=="number"?(Bt[mt]={},Bt[mt][Mt.id]=St):mt!=="Properties70"&&(mt==="PoseNode"?Bt[mt]=[St]:Bt[mt]=St),typeof Mt.id=="number"&&(St.id=Mt.id),Mt.name!==""&&(St.attrName=Mt.name),Mt.type!==""&&(St.attrType=Mt.type),this.pushStack(St)}parseNodeAttr(_){let ut=_[0];_[0]!==""&&(ut=parseInt(_[0]),isNaN(ut)&&(ut=_[0]));let mt="",bt="";return _.length>1&&(mt=_[1].replace(/^(\w+)::/,""),bt=_[2]),{id:ut,name:mt,type:bt}}parseNodeProperty(_,ut,mt){let bt=ut[1].replace(/^"/,"").replace(/"$/,"").trim(),St=ut[2].replace(/^"/,"").replace(/"$/,"").trim();bt==="Content"&&St===","&&(St=mt.replace(/"/g,"").replace(/,$/,"").trim());const Mt=this.getCurrentNode();if(Mt.name==="Properties70"){this.parseNodeSpecialProperty(_,bt,St);return}if(bt==="C"){const Ut=St.split(",").slice(1),Ht=parseInt(Ut[0]),tr=parseInt(Ut[1]);let rr=St.split(",").slice(3);rr=rr.map(function(sr){return sr.trim().replace(/^"/,"")}),bt="connections",St=[Ht,tr],append(St,rr),Mt[bt]===void 0&&(Mt[bt]=[])}bt==="Node"&&(Mt.id=St),bt in Mt&&Array.isArray(Mt[bt])?Mt[bt].push(St):bt!=="a"?Mt[bt]=St:Mt.a=St,this.setCurrentProp(Mt,bt),bt==="a"&&St.slice(-1)!==","&&(Mt.a=parseNumberArray(St))}parseNodePropertyContinued(_){const ut=this.getCurrentNode();ut.a+=_,_.slice(-1)!==","&&(ut.a=parseNumberArray(ut.a))}parseNodeSpecialProperty(_,ut,mt){const bt=mt.split('",').map(function(tr){return tr.trim().replace(/^\"/,"").replace(/\s/,"_")}),St=bt[0],Mt=bt[1],Bt=bt[2],Ut=bt[3];let Ht=bt[4];switch(Mt){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":Ht=parseFloat(Ht);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":Ht=parseNumberArray(Ht);break}this.getPrevNode()[St]={type:Mt,type2:Bt,flag:Ut,value:Ht},this.setCurrentProp(this.getPrevNode(),St)}}class BinaryParser{parse(_){const ut=new BinaryReader(_);ut.skip(23);const mt=ut.getUint32();if(mt<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+mt);const bt=new FBXTree;for(;!this.endOfContent(ut);){const St=this.parseNode(ut,mt);St!==null&&bt.add(St.name,St)}return bt}endOfContent(_){return _.size()%16===0?(_.getOffset()+160+16&-16)>=_.size():_.getOffset()+160+16>=_.size()}parseNode(_,ut){const mt={},bt=ut>=7500?_.getUint64():_.getUint32(),St=ut>=7500?_.getUint64():_.getUint32();ut>=7500?_.getUint64():_.getUint32();const Mt=_.getUint8(),Bt=_.getString(Mt);if(bt===0)return null;const Ut=[];for(let sr=0;sr<St;sr++)Ut.push(this.parseProperty(_));const Ht=Ut.length>0?Ut[0]:"",tr=Ut.length>1?Ut[1]:"",rr=Ut.length>2?Ut[2]:"";for(mt.singleProperty=St===1&&_.getOffset()===bt;bt>_.getOffset();){const sr=this.parseNode(_,ut);sr!==null&&this.parseSubNode(Bt,mt,sr)}return mt.propertyList=Ut,typeof Ht=="number"&&(mt.id=Ht),tr!==""&&(mt.attrName=tr),rr!==""&&(mt.attrType=rr),Bt!==""&&(mt.name=Bt),mt}parseSubNode(_,ut,mt){if(mt.singleProperty===!0){const bt=mt.propertyList[0];Array.isArray(bt)?(ut[mt.name]=mt,mt.a=bt):ut[mt.name]=bt}else if(_==="Connections"&&mt.name==="C"){const bt=[];mt.propertyList.forEach(function(St,Mt){Mt!==0&&bt.push(St)}),ut.connections===void 0&&(ut.connections=[]),ut.connections.push(bt)}else if(mt.name==="Properties70")Object.keys(mt).forEach(function(St){ut[St]=mt[St]});else if(_==="Properties70"&&mt.name==="P"){let bt=mt.propertyList[0],St=mt.propertyList[1];const Mt=mt.propertyList[2],Bt=mt.propertyList[3];let Ut;bt.indexOf("Lcl ")===0&&(bt=bt.replace("Lcl ","Lcl_")),St.indexOf("Lcl ")===0&&(St=St.replace("Lcl ","Lcl_")),St==="Color"||St==="ColorRGB"||St==="Vector"||St==="Vector3D"||St.indexOf("Lcl_")===0?Ut=[mt.propertyList[4],mt.propertyList[5],mt.propertyList[6]]:Ut=mt.propertyList[4],ut[bt]={type:St,type2:Mt,flag:Bt,value:Ut}}else ut[mt.name]===void 0?typeof mt.id=="number"?(ut[mt.name]={},ut[mt.name][mt.id]=mt):ut[mt.name]=mt:mt.name==="PoseNode"?(Array.isArray(ut[mt.name])||(ut[mt.name]=[ut[mt.name]]),ut[mt.name].push(mt)):ut[mt.name][mt.id]===void 0&&(ut[mt.name][mt.id]=mt)}parseProperty(_){const ut=_.getString(1);let mt;switch(ut){case"C":return _.getBoolean();case"D":return _.getFloat64();case"F":return _.getFloat32();case"I":return _.getInt32();case"L":return _.getInt64();case"R":return mt=_.getUint32(),_.getArrayBuffer(mt);case"S":return mt=_.getUint32(),_.getString(mt);case"Y":return _.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const bt=_.getUint32(),St=_.getUint32(),Mt=_.getUint32();if(St===0)switch(ut){case"b":case"c":return _.getBooleanArray(bt);case"d":return _.getFloat64Array(bt);case"f":return _.getFloat32Array(bt);case"i":return _.getInt32Array(bt);case"l":return _.getInt64Array(bt)}const Bt=unzlibSync(new Uint8Array(_.getArrayBuffer(Mt))),Ut=new BinaryReader(Bt.buffer);switch(ut){case"b":case"c":return Ut.getBooleanArray(bt);case"d":return Ut.getFloat64Array(bt);case"f":return Ut.getFloat32Array(bt);case"i":return Ut.getInt32Array(bt);case"l":return Ut.getInt64Array(bt)}default:throw new Error("THREE.FBXLoader: Unknown property type "+ut)}}}class BinaryReader{constructor(_,ut){this.dv=new DataView(_),this.offset=0,this.littleEndian=ut!==void 0?ut:!0}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(_){this.offset+=_}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(_){const ut=[];for(let mt=0;mt<_;mt++)ut.push(this.getBoolean());return ut}getUint8(){const _=this.dv.getUint8(this.offset);return this.offset+=1,_}getInt16(){const _=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,_}getInt32(){const _=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,_}getInt32Array(_){const ut=[];for(let mt=0;mt<_;mt++)ut.push(this.getInt32());return ut}getUint32(){const _=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,_}getInt64(){let _,ut;return this.littleEndian?(_=this.getUint32(),ut=this.getUint32()):(ut=this.getUint32(),_=this.getUint32()),ut&2147483648?(ut=~ut&4294967295,_=~_&4294967295,_===4294967295&&(ut=ut+1&4294967295),_=_+1&4294967295,-(ut*4294967296+_)):ut*4294967296+_}getInt64Array(_){const ut=[];for(let mt=0;mt<_;mt++)ut.push(this.getInt64());return ut}getUint64(){let _,ut;return this.littleEndian?(_=this.getUint32(),ut=this.getUint32()):(ut=this.getUint32(),_=this.getUint32()),ut*4294967296+_}getFloat32(){const _=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,_}getFloat32Array(_){const ut=[];for(let mt=0;mt<_;mt++)ut.push(this.getFloat32());return ut}getFloat64(){const _=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,_}getFloat64Array(_){const ut=[];for(let mt=0;mt<_;mt++)ut.push(this.getFloat64());return ut}getArrayBuffer(_){const ut=this.dv.buffer.slice(this.offset,this.offset+_);return this.offset+=_,ut}getString(_){let ut=[];for(let bt=0;bt<_;bt++)ut[bt]=this.getUint8();const mt=ut.indexOf(0);return mt>=0&&(ut=ut.slice(0,mt)),LoaderUtils.decodeText(new Uint8Array(ut))}}class FBXTree{add(_,ut){this[_]=ut}}function isFbxFormatBinary(rt){const _="Kaydara FBX Binary  \0";return rt.byteLength>=_.length&&_===convertArrayBufferToString(rt,0,_.length)}function isFbxFormatASCII(rt){const _=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let ut=0;function mt(bt){const St=rt[bt-1];return rt=rt.slice(ut+bt),ut++,St}for(let bt=0;bt<_.length;++bt)if(mt(1)===_[bt])return!1;return!0}function getFbxVersion(rt){const _=/FBXVersion: (\d+)/,ut=rt.match(_);if(ut)return parseInt(ut[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function convertFBXTimeToSeconds(rt){return rt/46186158e3}const dataArray=[];function getData(rt,_,ut,mt){let bt;switch(mt.mappingType){case"ByPolygonVertex":bt=rt;break;case"ByPolygon":bt=_;break;case"ByVertice":bt=ut;break;case"AllSame":bt=mt.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+mt.mappingType)}mt.referenceType==="IndexToDirect"&&(bt=mt.indices[bt]);const St=bt*mt.dataSize,Mt=St+mt.dataSize;return slice(dataArray,mt.buffer,St,Mt)}const tempEuler=new Euler,tempVec=new Vector3;function generateTransform(rt){const _=new Matrix4,ut=new Matrix4,mt=new Matrix4,bt=new Matrix4,St=new Matrix4,Mt=new Matrix4,Bt=new Matrix4,Ut=new Matrix4,Ht=new Matrix4,tr=new Matrix4,rr=new Matrix4,sr=new Matrix4,ar=rt.inheritType?rt.inheritType:0;if(rt.translation&&_.setPosition(tempVec.fromArray(rt.translation)),rt.preRotation){const Rn=rt.preRotation.map(MathUtils.degToRad);Rn.push(rt.eulerOrder),ut.makeRotationFromEuler(tempEuler.fromArray(Rn))}if(rt.rotation){const Rn=rt.rotation.map(MathUtils.degToRad);Rn.push(rt.eulerOrder),mt.makeRotationFromEuler(tempEuler.fromArray(Rn))}if(rt.postRotation){const Rn=rt.postRotation.map(MathUtils.degToRad);Rn.push(rt.eulerOrder),bt.makeRotationFromEuler(tempEuler.fromArray(Rn)),bt.invert()}rt.scale&&St.scale(tempVec.fromArray(rt.scale)),rt.scalingOffset&&Bt.setPosition(tempVec.fromArray(rt.scalingOffset)),rt.scalingPivot&&Mt.setPosition(tempVec.fromArray(rt.scalingPivot)),rt.rotationOffset&&Ut.setPosition(tempVec.fromArray(rt.rotationOffset)),rt.rotationPivot&&Ht.setPosition(tempVec.fromArray(rt.rotationPivot)),rt.parentMatrixWorld&&(rr.copy(rt.parentMatrix),tr.copy(rt.parentMatrixWorld));const cr=ut.clone().multiply(mt).multiply(bt),Ar=new Matrix4;Ar.extractRotation(tr);const _r=new Matrix4;_r.copyPosition(tr);const Dr=_r.clone().invert().multiply(tr),$r=Ar.clone().invert().multiply(Dr),Br=St,Jr=new Matrix4;if(ar===0)Jr.copy(Ar).multiply(cr).multiply($r).multiply(Br);else if(ar===1)Jr.copy(Ar).multiply($r).multiply(cr).multiply(Br);else{const qn=new Matrix4().scale(new Vector3().setFromMatrixScale(rr)).clone().invert(),Qn=$r.clone().multiply(qn);Jr.copy(Ar).multiply(cr).multiply(Qn).multiply(Br)}const mn=Ht.clone().invert(),Mn=Mt.clone().invert();let $n=_.clone().multiply(Ut).multiply(Ht).multiply(ut).multiply(mt).multiply(bt).multiply(mn).multiply(Bt).multiply(Mt).multiply(St).multiply(Mn);const en=new Matrix4().copyPosition($n),In=tr.clone().multiply(en);return sr.copyPosition(In),$n=sr.clone().multiply(Jr),$n.premultiply(tr.invert()),$n}function getEulerOrder(rt){rt=rt||0;const _=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return rt===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),_[0]):_[rt]}function parseNumberArray(rt){return rt.split(",").map(function(ut){return parseFloat(ut)})}function convertArrayBufferToString(rt,_,ut){return _===void 0&&(_=0),ut===void 0&&(ut=rt.byteLength),LoaderUtils.decodeText(new Uint8Array(rt,_,ut))}function append(rt,_){for(let ut=0,mt=rt.length,bt=_.length;ut<bt;ut++,mt++)rt[mt]=_[ut]}function slice(rt,_,ut,mt){for(let bt=ut,St=0;bt<mt;bt++,St++)rt[St]=_[bt];return rt}function inject(rt,_,ut){return rt.slice(0,_).concat(ut).concat(rt.slice(_))}class RGBELoader extends DataTextureLoader{constructor(_){super(_),this.type=HalfFloatType}parse(_){const Mt=function(en,In){switch(en){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(In||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(In||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(In||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(In||""))}},tr=`
`,rr=function(en,In,Rn){In=In||1024;let Qn=en.pos,xs=-1,cs=0,ks="",_o=String.fromCharCode.apply(null,new Uint16Array(en.subarray(Qn,Qn+128)));for(;0>(xs=_o.indexOf(tr))&&cs<In&&Qn<en.byteLength;)ks+=_o,cs+=_o.length,Qn+=128,_o+=String.fromCharCode.apply(null,new Uint16Array(en.subarray(Qn,Qn+128)));return-1<xs?(en.pos+=cs+xs+1,ks+_o.slice(0,xs)):!1},sr=function(en){const In=/^#\?(\S+)/,Rn=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,qn=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,Qn=/^\s*FORMAT=(\S+)\s*$/,xs=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,cs={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let ks,_o;for((en.pos>=en.byteLength||!(ks=rr(en)))&&Mt(1,"no header found"),(_o=ks.match(In))||Mt(3,"bad initial token"),cs.valid|=1,cs.programtype=_o[1],cs.string+=ks+`
`;ks=rr(en),ks!==!1;){if(cs.string+=ks+`
`,ks.charAt(0)==="#"){cs.comments+=ks+`
`;continue}if((_o=ks.match(Rn))&&(cs.gamma=parseFloat(_o[1])),(_o=ks.match(qn))&&(cs.exposure=parseFloat(_o[1])),(_o=ks.match(Qn))&&(cs.valid|=2,cs.format=_o[1]),(_o=ks.match(xs))&&(cs.valid|=4,cs.height=parseInt(_o[1],10),cs.width=parseInt(_o[2],10)),cs.valid&2&&cs.valid&4)break}return cs.valid&2||Mt(3,"missing format specifier"),cs.valid&4||Mt(3,"missing image size specifier"),cs},ar=function(en,In,Rn){const qn=In;if(qn<8||qn>32767||en[0]!==2||en[1]!==2||en[2]&128)return new Uint8Array(en);qn!==(en[2]<<8|en[3])&&Mt(3,"wrong scanline width");const Qn=new Uint8Array(4*In*Rn);Qn.length||Mt(4,"unable to allocate buffer space");let xs=0,cs=0;const ks=4*qn,_o=new Uint8Array(4),qs=new Uint8Array(ks);let Ss=Rn;for(;Ss>0&&cs<en.byteLength;){cs+4>en.byteLength&&Mt(1),_o[0]=en[cs++],_o[1]=en[cs++],_o[2]=en[cs++],_o[3]=en[cs++],(_o[0]!=2||_o[1]!=2||(_o[2]<<8|_o[3])!=qn)&&Mt(3,"bad rgbe scanline format");let eo=0,Ao;for(;eo<ks&&cs<en.byteLength;){Ao=en[cs++];const uo=Ao>128;if(uo&&(Ao-=128),(Ao===0||eo+Ao>ks)&&Mt(3,"bad scanline data"),uo){const uu=en[cs++];for(let cu=0;cu<Ao;cu++)qs[eo++]=uu}else qs.set(en.subarray(cs,cs+Ao),eo),eo+=Ao,cs+=Ao}const Oo=qn;for(let uo=0;uo<Oo;uo++){let uu=0;Qn[xs]=qs[uo+uu],uu+=qn,Qn[xs+1]=qs[uo+uu],uu+=qn,Qn[xs+2]=qs[uo+uu],uu+=qn,Qn[xs+3]=qs[uo+uu],xs+=4}Ss--}return Qn},cr=function(en,In,Rn,qn){const Qn=en[In+3],xs=Math.pow(2,Qn-128)/255;Rn[qn+0]=en[In+0]*xs,Rn[qn+1]=en[In+1]*xs,Rn[qn+2]=en[In+2]*xs,Rn[qn+3]=1},Ar=function(en,In,Rn,qn){const Qn=en[In+3],xs=Math.pow(2,Qn-128)/255;Rn[qn+0]=DataUtils.toHalfFloat(Math.min(en[In+0]*xs,65504)),Rn[qn+1]=DataUtils.toHalfFloat(Math.min(en[In+1]*xs,65504)),Rn[qn+2]=DataUtils.toHalfFloat(Math.min(en[In+2]*xs,65504)),Rn[qn+3]=DataUtils.toHalfFloat(1)},_r=new Uint8Array(_);_r.pos=0;const Dr=sr(_r),$r=Dr.width,Br=Dr.height,Jr=ar(_r.subarray(_r.pos),$r,Br);let mn,Mn,$n;switch(this.type){case FloatType:$n=Jr.length/4;const en=new Float32Array($n*4);for(let Rn=0;Rn<$n;Rn++)cr(Jr,Rn*4,en,Rn*4);mn=en,Mn=FloatType;break;case HalfFloatType:$n=Jr.length/4;const In=new Uint16Array($n*4);for(let Rn=0;Rn<$n;Rn++)Ar(Jr,Rn*4,In,Rn*4);mn=In,Mn=HalfFloatType;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:$r,height:Br,data:mn,header:Dr.string,gamma:Dr.gamma,exposure:Dr.exposure,type:Mn}}setDataType(_){return this.type=_,this}load(_,ut,mt,bt){function St(Mt,Bt){switch(Mt.type){case FloatType:case HalfFloatType:"colorSpace"in Mt?Mt.colorSpace="srgb-linear":Mt.encoding=3e3,Mt.minFilter=LinearFilter,Mt.magFilter=LinearFilter,Mt.generateMipmaps=!1,Mt.flipY=!0;break}ut&&ut(Mt,Bt)}return super.load(_,St,mt,bt)}}const hasColorSpace="colorSpace"in new Texture;class EXRLoader extends DataTextureLoader{constructor(_){super(_),this.type=HalfFloatType}parse(_){const In=Math.pow(2.7182818,2.2);function Rn(ru,Iu){for(var Hp=0,M0=0;M0<65536;++M0)(M0==0||ru[M0>>3]&1<<(M0&7))&&(Iu[Hp++]=M0);for(var H0=Hp-1;Hp<65536;)Iu[Hp++]=0;return H0}function qn(ru){for(var Iu=0;Iu<16384;Iu++)ru[Iu]={},ru[Iu].len=0,ru[Iu].lit=0,ru[Iu].p=null}const Qn={l:0,c:0,lc:0};function xs(ru,Iu,Hp,M0,H0){for(;Hp<ru;)Iu=Iu<<8|Cv(M0,H0),Hp+=8;Hp-=ru,Qn.l=Iu>>Hp&(1<<ru)-1,Qn.c=Iu,Qn.lc=Hp}const cs=new Array(59);function ks(ru){for(var Iu=0;Iu<=58;++Iu)cs[Iu]=0;for(var Iu=0;Iu<65537;++Iu)cs[ru[Iu]]+=1;for(var Hp=0,Iu=58;Iu>0;--Iu){var M0=Hp+cs[Iu]>>1;cs[Iu]=Hp,Hp=M0}for(var Iu=0;Iu<65537;++Iu){var H0=ru[Iu];H0>0&&(ru[Iu]=H0|cs[H0]++<<6)}}function _o(ru,Iu,Hp,M0,H0,Z0,Fv){for(var kv=Hp,Dy=0,Gy=0;H0<=Z0;H0++){if(kv.value-Hp.value>M0)return!1;xs(6,Dy,Gy,ru,kv);var jv=Qn.l;if(Dy=Qn.c,Gy=Qn.lc,Fv[H0]=jv,jv==63){if(kv.value-Hp.value>M0)throw"Something wrong with hufUnpackEncTable";xs(8,Dy,Gy,ru,kv);var I0=Qn.l+6;if(Dy=Qn.c,Gy=Qn.lc,H0+I0>Z0+1)throw"Something wrong with hufUnpackEncTable";for(;I0--;)Fv[H0++]=0;H0--}else if(jv>=59){var I0=jv-59+2;if(H0+I0>Z0+1)throw"Something wrong with hufUnpackEncTable";for(;I0--;)Fv[H0++]=0;H0--}}ks(Fv)}function qs(ru){return ru&63}function Ss(ru){return ru>>6}function eo(ru,Iu,Hp,M0){for(;Iu<=Hp;Iu++){var H0=Ss(ru[Iu]),Z0=qs(ru[Iu]);if(H0>>Z0)throw"Invalid table entry";if(Z0>14){var Fv=M0[H0>>Z0-14];if(Fv.len)throw"Invalid table entry";if(Fv.lit++,Fv.p){var kv=Fv.p;Fv.p=new Array(Fv.lit);for(var Dy=0;Dy<Fv.lit-1;++Dy)Fv.p[Dy]=kv[Dy]}else Fv.p=new Array(1);Fv.p[Fv.lit-1]=Iu}else if(Z0)for(var Gy=0,Dy=1<<14-Z0;Dy>0;Dy--){var Fv=M0[(H0<<14-Z0)+Gy];if(Fv.len||Fv.p)throw"Invalid table entry";Fv.len=Z0,Fv.lit=Iu,Gy++}}return!0}const Ao={c:0,lc:0};function Oo(ru,Iu,Hp,M0){ru=ru<<8|Cv(Hp,M0),Iu+=8,Ao.c=ru,Ao.lc=Iu}const uo={c:0,lc:0};function uu(ru,Iu,Hp,M0,H0,Z0,Fv,kv,Dy,Gy){if(ru==Iu){M0<8&&(Oo(Hp,M0,H0,Fv),Hp=Ao.c,M0=Ao.lc),M0-=8;var jv=Hp>>M0,jv=new Uint8Array([jv])[0];if(Dy.value+jv>Gy)return!1;for(var I0=kv[Dy.value-1];jv-- >0;)kv[Dy.value++]=I0}else if(Dy.value<Gy)kv[Dy.value++]=ru;else return!1;uo.c=Hp,uo.lc=M0}function cu(ru){return ru&65535}function Jl(ru){var Iu=cu(ru);return Iu>32767?Iu-65536:Iu}const mu={a:0,b:0};function pu(ru,Iu){var Hp=Jl(ru),M0=Jl(Iu),H0=M0,Z0=Hp+(H0&1)+(H0>>1),Fv=Z0,kv=Z0-H0;mu.a=Fv,mu.b=kv}function Zu(ru,Iu){var Hp=cu(ru),M0=cu(Iu),H0=Hp-(M0>>1)&65535,Z0=M0+H0-32768&65535;mu.a=Z0,mu.b=H0}function Mp(ru,Iu,Hp,M0,H0,Z0,Fv){for(var kv=Fv<16384,Dy=Hp>H0?H0:Hp,Gy=1,jv;Gy<=Dy;)Gy<<=1;for(Gy>>=1,jv=Gy,Gy>>=1;Gy>=1;){for(var I0=0,M2=I0+Z0*(H0-jv),dx=Z0*Gy,bx=Z0*jv,Jx=M0*Gy,t2=M0*jv,y2,Hx,$x,r2;I0<=M2;I0+=bx){for(var Yx=I0,I2=I0+M0*(Hp-jv);Yx<=I2;Yx+=t2){var d2=Yx+Jx,V2=Yx+dx,iE=V2+Jx;kv?(pu(ru[Yx+Iu],ru[V2+Iu]),y2=mu.a,$x=mu.b,pu(ru[d2+Iu],ru[iE+Iu]),Hx=mu.a,r2=mu.b,pu(y2,Hx),ru[Yx+Iu]=mu.a,ru[d2+Iu]=mu.b,pu($x,r2),ru[V2+Iu]=mu.a,ru[iE+Iu]=mu.b):(Zu(ru[Yx+Iu],ru[V2+Iu]),y2=mu.a,$x=mu.b,Zu(ru[d2+Iu],ru[iE+Iu]),Hx=mu.a,r2=mu.b,Zu(y2,Hx),ru[Yx+Iu]=mu.a,ru[d2+Iu]=mu.b,Zu($x,r2),ru[V2+Iu]=mu.a,ru[iE+Iu]=mu.b)}if(Hp&Gy){var V2=Yx+dx;kv?pu(ru[Yx+Iu],ru[V2+Iu]):Zu(ru[Yx+Iu],ru[V2+Iu]),y2=mu.a,ru[V2+Iu]=mu.b,ru[Yx+Iu]=y2}}if(H0&Gy)for(var Yx=I0,I2=I0+M0*(Hp-jv);Yx<=I2;Yx+=t2){var d2=Yx+Jx;kv?pu(ru[Yx+Iu],ru[d2+Iu]):Zu(ru[Yx+Iu],ru[d2+Iu]),y2=mu.a,ru[d2+Iu]=mu.b,ru[Yx+Iu]=y2}jv=Gy,Gy>>=1}return I0}function Up(ru,Iu,Hp,M0,H0,Z0,Fv,kv,Dy,Gy){for(var jv=0,I0=0,M2=kv,dx=Math.trunc(H0.value+(Z0+7)/8);H0.value<dx;)for(Oo(jv,I0,Hp,H0),jv=Ao.c,I0=Ao.lc;I0>=14;){var bx=jv>>I0-14&16383,Jx=Iu[bx];if(Jx.len)I0-=Jx.len,uu(Jx.lit,Fv,jv,I0,Hp,M0,H0,Dy,Gy,M2),jv=uo.c,I0=uo.lc;else{if(!Jx.p)throw"hufDecode issues";var t2;for(t2=0;t2<Jx.lit;t2++){for(var y2=qs(ru[Jx.p[t2]]);I0<y2&&H0.value<dx;)Oo(jv,I0,Hp,H0),jv=Ao.c,I0=Ao.lc;if(I0>=y2&&Ss(ru[Jx.p[t2]])==(jv>>I0-y2&(1<<y2)-1)){I0-=y2,uu(Jx.p[t2],Fv,jv,I0,Hp,M0,H0,Dy,Gy,M2),jv=uo.c,I0=uo.lc;break}}if(t2==Jx.lit)throw"hufDecode issues"}}var Hx=8-Z0&7;for(jv>>=Hx,I0-=Hx;I0>0;){var Jx=Iu[jv<<14-I0&16383];if(Jx.len)I0-=Jx.len,uu(Jx.lit,Fv,jv,I0,Hp,M0,H0,Dy,Gy,M2),jv=uo.c,I0=uo.lc;else throw"hufDecode issues"}return!0}function Ep(ru,Iu,Hp,M0,H0,Z0){var Fv={value:0},kv=Hp.value,Dy=Dv(Iu,Hp),Gy=Dv(Iu,Hp);Hp.value+=4;var jv=Dv(Iu,Hp);if(Hp.value+=4,Dy<0||Dy>=65537||Gy<0||Gy>=65537)throw"Something wrong with HUF_ENCSIZE";var I0=new Array(65537),M2=new Array(16384);qn(M2);var dx=M0-(Hp.value-kv);if(_o(ru,Iu,Hp,dx,Dy,Gy,I0),jv>8*(M0-(Hp.value-kv)))throw"Something wrong with hufUncompress";eo(I0,Dy,Gy,M2),Up(I0,M2,ru,Iu,Hp,jv,Gy,Z0,H0,Fv)}function mp(ru,Iu,Hp){for(var M0=0;M0<Hp;++M0)Iu[M0]=ru[Iu[M0]]}function Cp(ru){for(var Iu=1;Iu<ru.length;Iu++){var Hp=ru[Iu-1]+ru[Iu]-128;ru[Iu]=Hp}}function t0(ru,Iu){for(var Hp=0,M0=Math.floor((ru.length+1)/2),H0=0,Z0=ru.length-1;!(H0>Z0||(Iu[H0++]=ru[Hp++],H0>Z0));)Iu[H0++]=ru[M0++]}function _g(ru){for(var Iu=ru.byteLength,Hp=new Array,M0=0,H0=new DataView(ru);Iu>0;){var Z0=H0.getInt8(M0++);if(Z0<0){var Fv=-Z0;Iu-=Fv+1;for(var kv=0;kv<Fv;kv++)Hp.push(H0.getUint8(M0++))}else{var Fv=Z0;Iu-=2;for(var Dy=H0.getUint8(M0++),kv=0;kv<Fv+1;kv++)Hp.push(Dy)}}return Hp}function m0(ru,Iu,Hp,M0,H0,Z0){var d2=new DataView(Z0.buffer),Fv=Hp[ru.idx[0]].width,kv=Hp[ru.idx[0]].height,Dy=3,Gy=Math.floor(Fv/8),jv=Math.ceil(Fv/8),I0=Math.ceil(kv/8),M2=Fv-(jv-1)*8,dx=kv-(I0-1)*8,bx={value:0},Jx=new Array(Dy),t2=new Array(Dy),y2=new Array(Dy),Hx=new Array(Dy),$x=new Array(Dy);for(let N2=0;N2<Dy;++N2)$x[N2]=Iu[ru.idx[N2]],Jx[N2]=N2<1?0:Jx[N2-1]+jv*I0,t2[N2]=new Float32Array(64),y2[N2]=new Uint16Array(64),Hx[N2]=new Uint16Array(jv*64);for(let N2=0;N2<I0;++N2){var r2=8;N2==I0-1&&(r2=dx);var Yx=8;for(let U2=0;U2<jv;++U2){U2==jv-1&&(Yx=M2);for(let f2=0;f2<Dy;++f2)y2[f2].fill(0),y2[f2][0]=H0[Jx[f2]++],K0(bx,M0,y2[f2]),Jp(y2[f2],t2[f2]),y0(t2[f2]);z0(t2);for(let f2=0;f2<Dy;++f2)jm(t2[f2],Hx[f2],U2*64)}let tE=0;for(let U2=0;U2<Dy;++U2){const f2=Hp[ru.idx[U2]].type;for(let q2=8*N2;q2<8*N2+r2;++q2){tE=$x[U2][q2];for(let IE=0;IE<Gy;++IE){const oE=IE*64+(q2&7)*8;d2.setUint16(tE+0*2*f2,Hx[U2][oE+0],!0),d2.setUint16(tE+1*2*f2,Hx[U2][oE+1],!0),d2.setUint16(tE+2*2*f2,Hx[U2][oE+2],!0),d2.setUint16(tE+3*2*f2,Hx[U2][oE+3],!0),d2.setUint16(tE+4*2*f2,Hx[U2][oE+4],!0),d2.setUint16(tE+5*2*f2,Hx[U2][oE+5],!0),d2.setUint16(tE+6*2*f2,Hx[U2][oE+6],!0),d2.setUint16(tE+7*2*f2,Hx[U2][oE+7],!0),tE+=8*2*f2}}if(Gy!=jv)for(let q2=8*N2;q2<8*N2+r2;++q2){const IE=$x[U2][q2]+8*Gy*2*f2,oE=Gy*64+(q2&7)*8;for(let FE=0;FE<Yx;++FE)d2.setUint16(IE+FE*2*f2,Hx[U2][oE+FE],!0)}}}for(var I2=new Uint16Array(Fv),d2=new DataView(Z0.buffer),V2=0;V2<Dy;++V2){Hp[ru.idx[V2]].decoded=!0;var iE=Hp[ru.idx[V2]].type;if(Hp[V2].type==2)for(var K2=0;K2<kv;++K2){const N2=$x[V2][K2];for(var Y2=0;Y2<Fv;++Y2)I2[Y2]=d2.getUint16(N2+Y2*2*iE,!0);for(var Y2=0;Y2<Fv;++Y2)d2.setFloat32(N2+Y2*2*iE,Fp(I2[Y2]),!0)}}}function K0(ru,Iu,Hp){for(var M0,H0=1;H0<64;)M0=Iu[ru.value],M0==65280?H0=64:M0>>8==255?H0+=M0&255:(Hp[H0]=M0,H0++),ru.value++}function Jp(ru,Iu){Iu[0]=Fp(ru[0]),Iu[1]=Fp(ru[1]),Iu[2]=Fp(ru[5]),Iu[3]=Fp(ru[6]),Iu[4]=Fp(ru[14]),Iu[5]=Fp(ru[15]),Iu[6]=Fp(ru[27]),Iu[7]=Fp(ru[28]),Iu[8]=Fp(ru[2]),Iu[9]=Fp(ru[4]),Iu[10]=Fp(ru[7]),Iu[11]=Fp(ru[13]),Iu[12]=Fp(ru[16]),Iu[13]=Fp(ru[26]),Iu[14]=Fp(ru[29]),Iu[15]=Fp(ru[42]),Iu[16]=Fp(ru[3]),Iu[17]=Fp(ru[8]),Iu[18]=Fp(ru[12]),Iu[19]=Fp(ru[17]),Iu[20]=Fp(ru[25]),Iu[21]=Fp(ru[30]),Iu[22]=Fp(ru[41]),Iu[23]=Fp(ru[43]),Iu[24]=Fp(ru[9]),Iu[25]=Fp(ru[11]),Iu[26]=Fp(ru[18]),Iu[27]=Fp(ru[24]),Iu[28]=Fp(ru[31]),Iu[29]=Fp(ru[40]),Iu[30]=Fp(ru[44]),Iu[31]=Fp(ru[53]),Iu[32]=Fp(ru[10]),Iu[33]=Fp(ru[19]),Iu[34]=Fp(ru[23]),Iu[35]=Fp(ru[32]),Iu[36]=Fp(ru[39]),Iu[37]=Fp(ru[45]),Iu[38]=Fp(ru[52]),Iu[39]=Fp(ru[54]),Iu[40]=Fp(ru[20]),Iu[41]=Fp(ru[22]),Iu[42]=Fp(ru[33]),Iu[43]=Fp(ru[38]),Iu[44]=Fp(ru[46]),Iu[45]=Fp(ru[51]),Iu[46]=Fp(ru[55]),Iu[47]=Fp(ru[60]),Iu[48]=Fp(ru[21]),Iu[49]=Fp(ru[34]),Iu[50]=Fp(ru[37]),Iu[51]=Fp(ru[47]),Iu[52]=Fp(ru[50]),Iu[53]=Fp(ru[56]),Iu[54]=Fp(ru[59]),Iu[55]=Fp(ru[61]),Iu[56]=Fp(ru[35]),Iu[57]=Fp(ru[36]),Iu[58]=Fp(ru[48]),Iu[59]=Fp(ru[49]),Iu[60]=Fp(ru[57]),Iu[61]=Fp(ru[58]),Iu[62]=Fp(ru[62]),Iu[63]=Fp(ru[63])}function y0(ru){const Iu=.5*Math.cos(.7853975),Hp=.5*Math.cos(3.14159/16),M0=.5*Math.cos(3.14159/8),H0=.5*Math.cos(3*3.14159/16),Z0=.5*Math.cos(5*3.14159/16),Fv=.5*Math.cos(3*3.14159/8),kv=.5*Math.cos(7*3.14159/16);for(var Dy=new Array(4),Gy=new Array(4),jv=new Array(4),I0=new Array(4),M2=0;M2<8;++M2){var dx=M2*8;Dy[0]=M0*ru[dx+2],Dy[1]=Fv*ru[dx+2],Dy[2]=M0*ru[dx+6],Dy[3]=Fv*ru[dx+6],Gy[0]=Hp*ru[dx+1]+H0*ru[dx+3]+Z0*ru[dx+5]+kv*ru[dx+7],Gy[1]=H0*ru[dx+1]-kv*ru[dx+3]-Hp*ru[dx+5]-Z0*ru[dx+7],Gy[2]=Z0*ru[dx+1]-Hp*ru[dx+3]+kv*ru[dx+5]+H0*ru[dx+7],Gy[3]=kv*ru[dx+1]-Z0*ru[dx+3]+H0*ru[dx+5]-Hp*ru[dx+7],jv[0]=Iu*(ru[dx+0]+ru[dx+4]),jv[3]=Iu*(ru[dx+0]-ru[dx+4]),jv[1]=Dy[0]+Dy[3],jv[2]=Dy[1]-Dy[2],I0[0]=jv[0]+jv[1],I0[1]=jv[3]+jv[2],I0[2]=jv[3]-jv[2],I0[3]=jv[0]-jv[1],ru[dx+0]=I0[0]+Gy[0],ru[dx+1]=I0[1]+Gy[1],ru[dx+2]=I0[2]+Gy[2],ru[dx+3]=I0[3]+Gy[3],ru[dx+4]=I0[3]-Gy[3],ru[dx+5]=I0[2]-Gy[2],ru[dx+6]=I0[1]-Gy[1],ru[dx+7]=I0[0]-Gy[0]}for(var bx=0;bx<8;++bx)Dy[0]=M0*ru[16+bx],Dy[1]=Fv*ru[16+bx],Dy[2]=M0*ru[48+bx],Dy[3]=Fv*ru[48+bx],Gy[0]=Hp*ru[8+bx]+H0*ru[24+bx]+Z0*ru[40+bx]+kv*ru[56+bx],Gy[1]=H0*ru[8+bx]-kv*ru[24+bx]-Hp*ru[40+bx]-Z0*ru[56+bx],Gy[2]=Z0*ru[8+bx]-Hp*ru[24+bx]+kv*ru[40+bx]+H0*ru[56+bx],Gy[3]=kv*ru[8+bx]-Z0*ru[24+bx]+H0*ru[40+bx]-Hp*ru[56+bx],jv[0]=Iu*(ru[bx]+ru[32+bx]),jv[3]=Iu*(ru[bx]-ru[32+bx]),jv[1]=Dy[0]+Dy[3],jv[2]=Dy[1]-Dy[2],I0[0]=jv[0]+jv[1],I0[1]=jv[3]+jv[2],I0[2]=jv[3]-jv[2],I0[3]=jv[0]-jv[1],ru[0+bx]=I0[0]+Gy[0],ru[8+bx]=I0[1]+Gy[1],ru[16+bx]=I0[2]+Gy[2],ru[24+bx]=I0[3]+Gy[3],ru[32+bx]=I0[3]-Gy[3],ru[40+bx]=I0[2]-Gy[2],ru[48+bx]=I0[1]-Gy[1],ru[56+bx]=I0[0]-Gy[0]}function z0(ru){for(var Iu=0;Iu<64;++Iu){var Hp=ru[0][Iu],M0=ru[1][Iu],H0=ru[2][Iu];ru[0][Iu]=Hp+1.5747*H0,ru[1][Iu]=Hp-.1873*M0-.4682*H0,ru[2][Iu]=Hp+1.8556*M0}}function jm(ru,Iu,Hp){for(var M0=0;M0<64;++M0)Iu[Hp+M0]=DataUtils.toHalfFloat(Nu(ru[M0]))}function Nu(ru){return ru<=1?Math.sign(ru)*Math.pow(Math.abs(ru),2.2):Math.sign(ru)*Math.pow(In,Math.abs(ru)-1)}function Co(ru){return new DataView(ru.array.buffer,ru.offset.value,ru.size)}function Bp(ru){var Iu=ru.viewer.buffer.slice(ru.offset.value,ru.offset.value+ru.size),Hp=new Uint8Array(_g(Iu)),M0=new Uint8Array(Hp.length);return Cp(Hp),t0(Hp,M0),new DataView(M0.buffer)}function a0(ru){var Iu=ru.array.slice(ru.offset.value,ru.offset.value+ru.size),Hp=unzlibSync(Iu),M0=new Uint8Array(Hp.length);return Cp(Hp),t0(Hp,M0),new DataView(M0.buffer)}function Q0(ru){for(var Iu=ru.viewer,Hp={value:ru.offset.value},M0=new Uint16Array(ru.width*ru.scanlineBlockSize*(ru.channels*ru.type)),H0=new Uint8Array(8192),Z0=0,Fv=new Array(ru.channels),kv=0;kv<ru.channels;kv++)Fv[kv]={},Fv[kv].start=Z0,Fv[kv].end=Fv[kv].start,Fv[kv].nx=ru.width,Fv[kv].ny=ru.lines,Fv[kv].size=ru.type,Z0+=Fv[kv].nx*Fv[kv].ny*Fv[kv].size;var Dy=nv(Iu,Hp),Gy=nv(Iu,Hp);if(Gy>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Dy<=Gy)for(var kv=0;kv<Gy-Dy+1;kv++)H0[kv+Dy]=Kp(Iu,Hp);var jv=new Uint16Array(65536),I0=Rn(H0,jv),M2=Dv(Iu,Hp);Ep(ru.array,Iu,Hp,M2,M0,Z0);for(var kv=0;kv<ru.channels;++kv)for(var dx=Fv[kv],bx=0;bx<Fv[kv].size;++bx)Mp(M0,dx.start+bx,dx.nx,dx.size,dx.ny,dx.nx*dx.size,I0);mp(jv,M0,Z0);for(var Jx=0,t2=new Uint8Array(M0.buffer.byteLength),y2=0;y2<ru.lines;y2++)for(var Hx=0;Hx<ru.channels;Hx++){var dx=Fv[Hx],$x=dx.nx*dx.size,r2=new Uint8Array(M0.buffer,dx.end*2,$x*2);t2.set(r2,Jx),Jx+=$x*2,dx.end+=$x}return new DataView(t2.buffer)}function T0(ru){var Iu=ru.array.slice(ru.offset.value,ru.offset.value+ru.size),Hp=unzlibSync(Iu);const M0=ru.lines*ru.channels*ru.width,H0=ru.type==1?new Uint16Array(M0):new Uint32Array(M0);let Z0=0,Fv=0;const kv=new Array(4);for(let Dy=0;Dy<ru.lines;Dy++)for(let Gy=0;Gy<ru.channels;Gy++){let jv=0;switch(ru.type){case 1:kv[0]=Z0,kv[1]=kv[0]+ru.width,Z0=kv[1]+ru.width;for(let I0=0;I0<ru.width;++I0){const M2=Hp[kv[0]++]<<8|Hp[kv[1]++];jv+=M2,H0[Fv]=jv,Fv++}break;case 2:kv[0]=Z0,kv[1]=kv[0]+ru.width,kv[2]=kv[1]+ru.width,Z0=kv[2]+ru.width;for(let I0=0;I0<ru.width;++I0){const M2=Hp[kv[0]++]<<24|Hp[kv[1]++]<<16|Hp[kv[2]++]<<8;jv+=M2,H0[Fv]=jv,Fv++}break}}return new DataView(H0.buffer)}function av(ru){var Iu=ru.viewer,Hp={value:ru.offset.value},M0=new Uint8Array(ru.width*ru.lines*(ru.channels*ru.type*2)),H0={version:sv(Iu,Hp),unknownUncompressedSize:sv(Iu,Hp),unknownCompressedSize:sv(Iu,Hp),acCompressedSize:sv(Iu,Hp),dcCompressedSize:sv(Iu,Hp),rleCompressedSize:sv(Iu,Hp),rleUncompressedSize:sv(Iu,Hp),rleRawSize:sv(Iu,Hp),totalAcUncompressedCount:sv(Iu,Hp),totalDcUncompressedCount:sv(Iu,Hp),acCompression:sv(Iu,Hp)};if(H0.version<2)throw"EXRLoader.parse: "+ov.compression+" version "+H0.version+" is unsupported";for(var Z0=new Array,Fv=nv(Iu,Hp)-2;Fv>0;){var kv=lv(Iu.buffer,Hp),Dy=Kp(Iu,Hp),Gy=Dy>>2&3,jv=(Dy>>4)-1,I0=new Int8Array([jv])[0],M2=Kp(Iu,Hp);Z0.push({name:kv,index:I0,type:M2,compression:Gy}),Fv-=kv.length+3}for(var dx=ov.channels,bx=new Array(ru.channels),Jx=0;Jx<ru.channels;++Jx){var t2=bx[Jx]={},y2=dx[Jx];t2.name=y2.name,t2.compression=0,t2.decoded=!1,t2.type=y2.pixelType,t2.pLinear=y2.pLinear,t2.width=ru.width,t2.height=ru.lines}for(var Hx={idx:new Array(3)},$x=0;$x<ru.channels;++$x)for(var t2=bx[$x],Jx=0;Jx<Z0.length;++Jx){var r2=Z0[Jx];t2.name==r2.name&&(t2.compression=r2.compression,r2.index>=0&&(Hx.idx[r2.index]=$x),t2.offset=$x)}if(H0.acCompressedSize>0)switch(H0.acCompression){case 0:var d2=new Uint16Array(H0.totalAcUncompressedCount);Ep(ru.array,Iu,Hp,H0.acCompressedSize,d2,H0.totalAcUncompressedCount);break;case 1:var Yx=ru.array.slice(Hp.value,Hp.value+H0.totalAcUncompressedCount),I2=unzlibSync(Yx),d2=new Uint16Array(I2.buffer);Hp.value+=H0.totalAcUncompressedCount;break}if(H0.dcCompressedSize>0){var V2={array:ru.array,offset:Hp,size:H0.dcCompressedSize},iE=new Uint16Array(a0(V2).buffer);Hp.value+=H0.dcCompressedSize}if(H0.rleRawSize>0){var Yx=ru.array.slice(Hp.value,Hp.value+H0.rleCompressedSize),I2=unzlibSync(Yx),K2=_g(I2.buffer);Hp.value+=H0.rleCompressedSize}for(var Y2=0,N2=new Array(bx.length),Jx=0;Jx<N2.length;++Jx)N2[Jx]=new Array;for(var tE=0;tE<ru.lines;++tE)for(var U2=0;U2<bx.length;++U2)N2[U2].push(Y2),Y2+=bx[U2].width*ru.type*2;m0(Hx,N2,bx,d2,iE,M0);for(var Jx=0;Jx<bx.length;++Jx){var t2=bx[Jx];if(!t2.decoded)switch(t2.compression){case 2:for(var f2=0,q2=0,tE=0;tE<ru.lines;++tE){for(var IE=N2[Jx][f2],oE=0;oE<t2.width;++oE){for(var FE=0;FE<2*t2.type;++FE)M0[IE++]=K2[q2+FE*t2.width*t2.height];q2++}f2++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(M0.buffer)}function lv(ru,Iu){for(var Hp=new Uint8Array(ru),M0=0;Hp[Iu.value+M0]!=0;)M0+=1;var H0=new TextDecoder().decode(Hp.slice(Iu.value,Iu.value+M0));return Iu.value=Iu.value+M0+1,H0}function N0(ru,Iu,Hp){var M0=new TextDecoder().decode(new Uint8Array(ru).slice(Iu.value,Iu.value+Hp));return Iu.value=Iu.value+Hp,M0}function zv(ru,Iu){var Hp=Gv(ru,Iu),M0=Dv(ru,Iu);return[Hp,M0]}function Uv(ru,Iu){var Hp=Dv(ru,Iu),M0=Dv(ru,Iu);return[Hp,M0]}function Gv(ru,Iu){var Hp=ru.getInt32(Iu.value,!0);return Iu.value=Iu.value+4,Hp}function Dv(ru,Iu){var Hp=ru.getUint32(Iu.value,!0);return Iu.value=Iu.value+4,Hp}function Cv(ru,Iu){var Hp=ru[Iu.value];return Iu.value=Iu.value+1,Hp}function Kp(ru,Iu){var Hp=ru.getUint8(Iu.value);return Iu.value=Iu.value+1,Hp}const sv=function(ru,Iu){let Hp;return"getBigInt64"in DataView.prototype?Hp=Number(ru.getBigInt64(Iu.value,!0)):Hp=ru.getUint32(Iu.value+4,!0)+Number(ru.getUint32(Iu.value,!0)<<32),Iu.value+=8,Hp};function Hv(ru,Iu){var Hp=ru.getFloat32(Iu.value,!0);return Iu.value+=4,Hp}function jp(ru,Iu){return DataUtils.toHalfFloat(Hv(ru,Iu))}function Fp(ru){var Iu=(ru&31744)>>10,Hp=ru&1023;return(ru>>15?-1:1)*(Iu?Iu===31?Hp?NaN:1/0:Math.pow(2,Iu-15)*(1+Hp/1024):6103515625e-14*(Hp/1024))}function nv(ru,Iu){var Hp=ru.getUint16(Iu.value,!0);return Iu.value+=2,Hp}function qy(ru,Iu){return Fp(nv(ru,Iu))}function Uy(ru,Iu,Hp,M0){for(var H0=Hp.value,Z0=[];Hp.value<H0+M0-1;){var Fv=lv(Iu,Hp),kv=Gv(ru,Hp),Dy=Kp(ru,Hp);Hp.value+=3;var Gy=Gv(ru,Hp),jv=Gv(ru,Hp);Z0.push({name:Fv,pixelType:kv,pLinear:Dy,xSampling:Gy,ySampling:jv})}return Hp.value+=1,Z0}function vx(ru,Iu){var Hp=Hv(ru,Iu),M0=Hv(ru,Iu),H0=Hv(ru,Iu),Z0=Hv(ru,Iu),Fv=Hv(ru,Iu),kv=Hv(ru,Iu),Dy=Hv(ru,Iu),Gy=Hv(ru,Iu);return{redX:Hp,redY:M0,greenX:H0,greenY:Z0,blueX:Fv,blueY:kv,whiteX:Dy,whiteY:Gy}}function qx(ru,Iu){var Hp=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],M0=Kp(ru,Iu);return Hp[M0]}function Kx(ru,Iu){var Hp=Dv(ru,Iu),M0=Dv(ru,Iu),H0=Dv(ru,Iu),Z0=Dv(ru,Iu);return{xMin:Hp,yMin:M0,xMax:H0,yMax:Z0}}function Mx(ru,Iu){var Hp=["INCREASING_Y"],M0=Kp(ru,Iu);return Hp[M0]}function Ox(ru,Iu){var Hp=Hv(ru,Iu),M0=Hv(ru,Iu);return[Hp,M0]}function E2(ru,Iu){var Hp=Hv(ru,Iu),M0=Hv(ru,Iu),H0=Hv(ru,Iu);return[Hp,M0,H0]}function $2(ru,Iu,Hp,M0,H0){if(M0==="string"||M0==="stringvector"||M0==="iccProfile")return N0(Iu,Hp,H0);if(M0==="chlist")return Uy(ru,Iu,Hp,H0);if(M0==="chromaticities")return vx(ru,Hp);if(M0==="compression")return qx(ru,Hp);if(M0==="box2i")return Kx(ru,Hp);if(M0==="lineOrder")return Mx(ru,Hp);if(M0==="float")return Hv(ru,Hp);if(M0==="v2f")return Ox(ru,Hp);if(M0==="v3f")return E2(ru,Hp);if(M0==="int")return Gv(ru,Hp);if(M0==="rational")return zv(ru,Hp);if(M0==="timecode")return Uv(ru,Hp);if(M0==="preview")return Hp.value+=H0,"skipped";Hp.value+=H0}function X2(ru,Iu,Hp){const M0={};if(ru.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";M0.version=ru.getUint8(4);const H0=ru.getUint8(5);M0.spec={singleTile:!!(H0&2),longName:!!(H0&4),deepFormat:!!(H0&8),multiPart:!!(H0&16)},Hp.value=8;for(var Z0=!0;Z0;){var Fv=lv(Iu,Hp);if(Fv==0)Z0=!1;else{var kv=lv(Iu,Hp),Dy=Dv(ru,Hp),Gy=$2(ru,Iu,Hp,kv,Dy);Gy===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${kv}'.`):M0[Fv]=Gy}}if(H0&-5)throw console.error("EXRHeader:",M0),"THREE.EXRLoader: provided file is currently unsupported.";return M0}function _E(ru,Iu,Hp,M0,H0){const Z0={size:0,viewer:Iu,array:Hp,offset:M0,width:ru.dataWindow.xMax-ru.dataWindow.xMin+1,height:ru.dataWindow.yMax-ru.dataWindow.yMin+1,channels:ru.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:ru.channels[0].pixelType,uncompress:null,getter:null,format:null,[hasColorSpace?"colorSpace":"encoding"]:null};switch(ru.compression){case"NO_COMPRESSION":Z0.lines=1,Z0.uncompress=Co;break;case"RLE_COMPRESSION":Z0.lines=1,Z0.uncompress=Bp;break;case"ZIPS_COMPRESSION":Z0.lines=1,Z0.uncompress=a0;break;case"ZIP_COMPRESSION":Z0.lines=16,Z0.uncompress=a0;break;case"PIZ_COMPRESSION":Z0.lines=32,Z0.uncompress=Q0;break;case"PXR24_COMPRESSION":Z0.lines=16,Z0.uncompress=T0;break;case"DWAA_COMPRESSION":Z0.lines=32,Z0.uncompress=av;break;case"DWAB_COMPRESSION":Z0.lines=256,Z0.uncompress=av;break;default:throw"EXRLoader.parse: "+ru.compression+" is unsupported"}if(Z0.scanlineBlockSize=Z0.lines,Z0.type==1)switch(H0){case FloatType:Z0.getter=qy,Z0.inputSize=2;break;case HalfFloatType:Z0.getter=nv,Z0.inputSize=2;break}else if(Z0.type==2)switch(H0){case FloatType:Z0.getter=Hv,Z0.inputSize=4;break;case HalfFloatType:Z0.getter=jp,Z0.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+Z0.type+" for "+ru.compression+".";Z0.blockCount=(ru.dataWindow.yMax+1)/Z0.scanlineBlockSize;for(var Fv=0;Fv<Z0.blockCount;Fv++)sv(Iu,M0);Z0.outputChannels=Z0.channels==3?4:Z0.channels;const kv=Z0.width*Z0.height*Z0.outputChannels;switch(H0){case FloatType:Z0.byteArray=new Float32Array(kv),Z0.channels<Z0.outputChannels&&Z0.byteArray.fill(1,0,kv);break;case HalfFloatType:Z0.byteArray=new Uint16Array(kv),Z0.channels<Z0.outputChannels&&Z0.byteArray.fill(15360,0,kv);break;default:console.error("THREE.EXRLoader: unsupported type: ",H0);break}return Z0.bytesPerLine=Z0.width*Z0.inputSize*Z0.channels,Z0.outputChannels==4?Z0.format=RGBAFormat:Z0.format=RedFormat,hasColorSpace?Z0.colorSpace="srgb-linear":Z0.encoding=3e3,Z0}const mE=new DataView(_),Pp=new Uint8Array(_),tv={value:0},ov=X2(mE,_,tv),p0=_E(ov,mE,Pp,tv,this.type),bv={value:0},Dx={R:0,G:1,B:2,A:3,Y:0};for(let ru=0;ru<p0.height/p0.scanlineBlockSize;ru++){const Iu=Dv(mE,tv);p0.size=Dv(mE,tv),p0.lines=Iu+p0.scanlineBlockSize>p0.height?p0.height-Iu:p0.scanlineBlockSize;const M0=p0.size<p0.lines*p0.bytesPerLine?p0.uncompress(p0):Co(p0);tv.value+=p0.size;for(let H0=0;H0<p0.scanlineBlockSize;H0++){const Z0=H0+ru*p0.scanlineBlockSize;if(Z0>=p0.height)break;for(let Fv=0;Fv<p0.channels;Fv++){const kv=Dx[ov.channels[Fv].name];for(let Dy=0;Dy<p0.width;Dy++){bv.value=(H0*(p0.channels*p0.width)+Fv*p0.width+Dy)*p0.inputSize;const Gy=(p0.height-1-Z0)*(p0.width*p0.outputChannels)+Dy*p0.outputChannels+kv;p0.byteArray[Gy]=p0.getter(M0,bv)}}}}return{header:ov,width:p0.width,height:p0.height,data:p0.byteArray,format:p0.format,[hasColorSpace?"colorSpace":"encoding"]:p0[hasColorSpace?"colorSpace":"encoding"],type:this.type}}setDataType(_){return this.type=_,this}load(_,ut,mt,bt){function St(Mt,Bt){hasColorSpace?Mt.colorSpace=Bt.colorSpace:Mt.encoding=Bt.encoding,Mt.minFilter=LinearFilter,Mt.magFilter=LinearFilter,Mt.generateMipmaps=!1,Mt.flipY=!1,ut&&ut(Mt,Bt)}return super.load(_,St,mt,bt)}}const _taskCache$1=new WeakMap;let DRACOLoader$1=class extends Loader{constructor(_){super(_),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(_){return this.decoderPath=_,this}setDecoderConfig(_){return this.decoderConfig=_,this}setWorkerLimit(_){return this.workerLimit=_,this}load(_,ut,mt,bt){const St=new FileLoader(this.manager);St.setPath(this.path),St.setResponseType("arraybuffer"),St.setRequestHeader(this.requestHeader),St.setWithCredentials(this.withCredentials),St.load(_,Mt=>{const Bt={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(Mt,Bt).then(ut).catch(bt)},mt,bt)}decodeDracoFile(_,ut,mt,bt){const St={attributeIDs:mt||this.defaultAttributeIDs,attributeTypes:bt||this.defaultAttributeTypes,useUniqueIDs:!!mt};this.decodeGeometry(_,St).then(ut)}decodeGeometry(_,ut){for(const Ut in ut.attributeTypes){const Ht=ut.attributeTypes[Ut];Ht.BYTES_PER_ELEMENT!==void 0&&(ut.attributeTypes[Ut]=Ht.name)}const mt=JSON.stringify(ut);if(_taskCache$1.has(_)){const Ut=_taskCache$1.get(_);if(Ut.key===mt)return Ut.promise;if(_.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let bt;const St=this.workerNextTaskID++,Mt=_.byteLength,Bt=this._getWorker(St,Mt).then(Ut=>(bt=Ut,new Promise((Ht,tr)=>{bt._callbacks[St]={resolve:Ht,reject:tr},bt.postMessage({type:"decode",id:St,taskConfig:ut,buffer:_},[_])}))).then(Ut=>this._createGeometry(Ut.geometry));return Bt.catch(()=>!0).then(()=>{bt&&St&&this._releaseTask(bt,St)}),_taskCache$1.set(_,{key:mt,promise:Bt}),Bt}_createGeometry(_){const ut=new BufferGeometry;_.index&&ut.setIndex(new BufferAttribute(_.index.array,1));for(let mt=0;mt<_.attributes.length;mt++){const bt=_.attributes[mt],St=bt.name,Mt=bt.array,Bt=bt.itemSize;ut.setAttribute(St,new BufferAttribute(Mt,Bt))}return ut}_loadLibrary(_,ut){const mt=new FileLoader(this.manager);return mt.setPath(this.decoderPath),mt.setResponseType(ut),mt.setWithCredentials(this.withCredentials),new Promise((bt,St)=>{mt.load(_,bt,void 0,St)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const _=typeof WebAssembly!="object"||this.decoderConfig.type==="js",ut=[];return _?ut.push(this._loadLibrary("draco_decoder.js","text")):(ut.push(this._loadLibrary("draco_wasm_wrapper.js","text")),ut.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(ut).then(mt=>{const bt=mt[0];_||(this.decoderConfig.wasmBinary=mt[1]);const St=DRACOWorker$1.toString(),Mt=["/* draco decoder */",bt,"","/* worker */",St.substring(St.indexOf("{")+1,St.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([Mt]))}),this.decoderPending}_getWorker(_,ut){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const bt=new Worker(this.workerSourceURL);bt._callbacks={},bt._taskCosts={},bt._taskLoad=0,bt.postMessage({type:"init",decoderConfig:this.decoderConfig}),bt.onmessage=function(St){const Mt=St.data;switch(Mt.type){case"decode":bt._callbacks[Mt.id].resolve(Mt);break;case"error":bt._callbacks[Mt.id].reject(Mt);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+Mt.type+'"')}},this.workerPool.push(bt)}else this.workerPool.sort(function(bt,St){return bt._taskLoad>St._taskLoad?-1:1});const mt=this.workerPool[this.workerPool.length-1];return mt._taskCosts[_]=ut,mt._taskLoad+=ut,mt})}_releaseTask(_,ut){_._taskLoad-=_._taskCosts[ut],delete _._callbacks[ut],delete _._taskCosts[ut]}debug(){console.log("Task load: ",this.workerPool.map(_=>_._taskLoad))}dispose(){for(let _=0;_<this.workerPool.length;++_)this.workerPool[_].terminate();return this.workerPool.length=0,this}};function DRACOWorker$1(){let rt,_;onmessage=function(Mt){const Bt=Mt.data;switch(Bt.type){case"init":rt=Bt.decoderConfig,_=new Promise(function(tr){rt.onModuleLoaded=function(rr){tr({draco:rr})},DracoDecoderModule(rt)});break;case"decode":const Ut=Bt.buffer,Ht=Bt.taskConfig;_.then(tr=>{const rr=tr.draco,sr=new rr.Decoder,ar=new rr.DecoderBuffer;ar.Init(new Int8Array(Ut),Ut.byteLength);try{const cr=ut(rr,sr,ar,Ht),Ar=cr.attributes.map(_r=>_r.array.buffer);cr.index&&Ar.push(cr.index.array.buffer),self.postMessage({type:"decode",id:Bt.id,geometry:cr},Ar)}catch(cr){console.error(cr),self.postMessage({type:"error",id:Bt.id,error:cr.message})}finally{rr.destroy(ar),rr.destroy(sr)}});break}};function ut(Mt,Bt,Ut,Ht){const tr=Ht.attributeIDs,rr=Ht.attributeTypes;let sr,ar;const cr=Bt.GetEncodedGeometryType(Ut);if(cr===Mt.TRIANGULAR_MESH)sr=new Mt.Mesh,ar=Bt.DecodeBufferToMesh(Ut,sr);else if(cr===Mt.POINT_CLOUD)sr=new Mt.PointCloud,ar=Bt.DecodeBufferToPointCloud(Ut,sr);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!ar.ok()||sr.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+ar.error_msg());const Ar={index:null,attributes:[]};for(const _r in tr){const Dr=self[rr[_r]];let $r,Br;if(Ht.useUniqueIDs)Br=tr[_r],$r=Bt.GetAttributeByUniqueId(sr,Br);else{if(Br=Bt.GetAttributeId(sr,Mt[tr[_r]]),Br===-1)continue;$r=Bt.GetAttribute(sr,Br)}Ar.attributes.push(bt(Mt,Bt,sr,_r,Dr,$r))}return cr===Mt.TRIANGULAR_MESH&&(Ar.index=mt(Mt,Bt,sr)),Mt.destroy(sr),Ar}function mt(Mt,Bt,Ut){const tr=Ut.num_faces()*3,rr=tr*4,sr=Mt._malloc(rr);Bt.GetTrianglesUInt32Array(Ut,rr,sr);const ar=new Uint32Array(Mt.HEAPF32.buffer,sr,tr).slice();return Mt._free(sr),{array:ar,itemSize:1}}function bt(Mt,Bt,Ut,Ht,tr,rr){const sr=rr.num_components(),cr=Ut.num_points()*sr,Ar=cr*tr.BYTES_PER_ELEMENT,_r=St(Mt,tr),Dr=Mt._malloc(Ar);Bt.GetAttributeDataArrayForAllPoints(Ut,rr,_r,Ar,Dr);const $r=new tr(Mt.HEAPF32.buffer,Dr,cr).slice();return Mt._free(Dr),{name:Ht,array:$r,itemSize:sr}}function St(Mt,Bt){switch(Bt){case Float32Array:return Mt.DT_FLOAT32;case Int8Array:return Mt.DT_INT8;case Int16Array:return Mt.DT_INT16;case Int32Array:return Mt.DT_INT32;case Uint8Array:return Mt.DT_UINT8;case Uint16Array:return Mt.DT_UINT16;case Uint32Array:return Mt.DT_UINT32}}}let generated;const MeshoptDecoder=()=>{if(generated)return generated;const rt="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",_="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",ut=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),mt=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let bt=rt;WebAssembly.validate(ut)&&(bt=_);let St;const Mt=WebAssembly.instantiate(Bt(bt),{}).then(rr=>{St=rr.instance,St.exports.__wasm_call_ctors()});function Bt(rr){const sr=new Uint8Array(rr.length);for(let cr=0;cr<rr.length;++cr){const Ar=rr.charCodeAt(cr);sr[cr]=Ar>96?Ar-71:Ar>64?Ar-65:Ar>47?Ar+4:Ar>46?63:62}let ar=0;for(let cr=0;cr<rr.length;++cr)sr[ar++]=sr[cr]<60?mt[sr[cr]]:(sr[cr]-60)*64+sr[++cr];return sr.buffer.slice(0,ar)}function Ut(rr,sr,ar,cr,Ar,_r){const Dr=St.exports.sbrk,$r=ar+3&-4,Br=Dr($r*cr),Jr=Dr(Ar.length),mn=new Uint8Array(St.exports.memory.buffer);mn.set(Ar,Jr);const Mn=rr(Br,ar,cr,Jr,Ar.length);if(Mn===0&&_r&&_r(Br,$r,cr),sr.set(mn.subarray(Br,Br+ar*cr)),Dr(Br-Dr(0)),Mn!==0)throw new Error(`Malformed buffer data: ${Mn}`)}const Ht={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},tr={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return generated={ready:Mt,supported:!0,decodeVertexBuffer(rr,sr,ar,cr,Ar){Ut(St.exports.meshopt_decodeVertexBuffer,rr,sr,ar,cr,St.exports[Ht[Ar]])},decodeIndexBuffer(rr,sr,ar,cr){Ut(St.exports.meshopt_decodeIndexBuffer,rr,sr,ar,cr)},decodeIndexSequence(rr,sr,ar,cr){Ut(St.exports.meshopt_decodeIndexSequence,rr,sr,ar,cr)},decodeGltfBuffer(rr,sr,ar,cr,Ar,_r){Ut(St.exports[tr[Ar]],rr,sr,ar,cr,St.exports[Ht[_r]])}},generated};function shallow(rt,_){if(Object.is(rt,_))return!0;if(typeof rt!="object"||rt===null||typeof _!="object"||_===null)return!1;const ut=Object.keys(rt);if(ut.length!==Object.keys(_).length)return!1;for(let mt=0;mt<ut.length;mt++)if(!Object.prototype.hasOwnProperty.call(_,ut[mt])||!Object.is(rt[ut[mt]],_[ut[mt]]))return!1;return!0}function workerBootstrap(){var rt=Object.create(null);function _(bt,St){var Mt=bt.id,Bt=bt.name,Ut=bt.dependencies;Ut===void 0&&(Ut=[]);var Ht=bt.init;Ht===void 0&&(Ht=function(){});var tr=bt.getTransferables;if(tr===void 0&&(tr=null),!rt[Mt])try{Ut=Ut.map(function(sr){return sr&&sr.isWorkerModule&&(_(sr,function(ar){if(ar instanceof Error)throw ar}),sr=rt[sr.id].value),sr}),Ht=mt("<"+Bt+">.init",Ht),tr&&(tr=mt("<"+Bt+">.getTransferables",tr));var rr=null;typeof Ht=="function"?rr=Ht.apply(void 0,Ut):console.error("worker module init function failed to rehydrate"),rt[Mt]={id:Mt,value:rr,getTransferables:tr},St(rr)}catch(sr){sr&&sr.noLog||console.error(sr),St(sr)}}function ut(bt,St){var Mt,Bt=bt.id,Ut=bt.args;(!rt[Bt]||typeof rt[Bt].value!="function")&&St(new Error("Worker module "+Bt+": not found or its 'init' did not return a function"));try{var Ht=(Mt=rt[Bt]).value.apply(Mt,Ut);Ht&&typeof Ht.then=="function"?Ht.then(tr,function(rr){return St(rr instanceof Error?rr:new Error(""+rr))}):tr(Ht)}catch(rr){St(rr)}function tr(rr){try{var sr=rt[Bt].getTransferables&&rt[Bt].getTransferables(rr);(!sr||!Array.isArray(sr)||!sr.length)&&(sr=void 0),St(rr,sr)}catch(ar){console.error(ar),St(ar)}}}function mt(bt,St){var Mt=void 0;self.troikaDefine=function(Ut){return Mt=Ut};var Bt=URL.createObjectURL(new Blob(["/** "+bt.replace(/\*/g,"")+` **/

troikaDefine(
`+St+`
)`],{type:"application/javascript"}));try{importScripts(Bt)}catch(Ut){console.error(Ut)}return URL.revokeObjectURL(Bt),delete self.troikaDefine,Mt}self.addEventListener("message",function(bt){var St=bt.data,Mt=St.messageId,Bt=St.action,Ut=St.data;try{Bt==="registerModule"&&_(Ut,function(Ht){Ht instanceof Error?postMessage({messageId:Mt,success:!1,error:Ht.message}):postMessage({messageId:Mt,success:!0,result:{isCallable:typeof Ht=="function"}})}),Bt==="callModule"&&ut(Ut,function(Ht,tr){Ht instanceof Error?postMessage({messageId:Mt,success:!1,error:Ht.message}):postMessage({messageId:Mt,success:!0,result:Ht},tr||void 0)})}catch(Ht){postMessage({messageId:Mt,success:!1,error:Ht.stack})}})}function defineMainThreadModule(rt){var _=function(){for(var ut=[],mt=arguments.length;mt--;)ut[mt]=arguments[mt];return _._getInitResult().then(function(bt){if(typeof bt=="function")return bt.apply(void 0,ut);throw new Error("Worker module function was called but `init` did not return a callable function")})};return _._getInitResult=function(){var ut=rt.dependencies,mt=rt.init;ut=Array.isArray(ut)?ut.map(function(St){return St&&St._getInitResult?St._getInitResult():St}):[];var bt=Promise.all(ut).then(function(St){return mt.apply(null,St)});return _._getInitResult=function(){return bt},bt},_}var supportsWorkers=function(){var rt=!1;if(typeof window<"u"&&typeof window.document<"u")try{var _=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));_.terminate(),rt=!0}catch(ut){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+ut.message+"]")}return supportsWorkers=function(){return rt},rt},_workerModuleId=0,_messageId=0,_allowInitAsString=!1,workers=Object.create(null),registeredModules=Object.create(null),openRequests=Object.create(null);function defineWorkerModule(rt){if((!rt||typeof rt.init!="function")&&!_allowInitAsString)throw new Error("requires `options.init` function");var _=rt.dependencies,ut=rt.init,mt=rt.getTransferables,bt=rt.workerId;if(!supportsWorkers())return defineMainThreadModule(rt);bt==null&&(bt="#default");var St="workerModule"+ ++_workerModuleId,Mt=rt.name||St,Bt=null;_=_&&_.map(function(Ht){return typeof Ht=="function"&&!Ht.workerModuleData&&(_allowInitAsString=!0,Ht=defineWorkerModule({workerId:bt,name:"<"+Mt+"> function dependency: "+Ht.name,init:`function(){return (
`+stringifyFunction(Ht)+`
)}`}),_allowInitAsString=!1),Ht&&Ht.workerModuleData&&(Ht=Ht.workerModuleData),Ht});function Ut(){for(var Ht=[],tr=arguments.length;tr--;)Ht[tr]=arguments[tr];if(!Bt){Bt=callWorker(bt,"registerModule",Ut.workerModuleData);var rr=function(){Bt=null,registeredModules[bt].delete(rr)};(registeredModules[bt]||(registeredModules[bt]=new Set)).add(rr)}return Bt.then(function(sr){var ar=sr.isCallable;if(ar)return callWorker(bt,"callModule",{id:St,args:Ht});throw new Error("Worker module function was called but `init` did not return a callable function")})}return Ut.workerModuleData={isWorkerModule:!0,id:St,name:Mt,dependencies:_,init:stringifyFunction(ut),getTransferables:mt&&stringifyFunction(mt)},Ut}function terminateWorker(rt){registeredModules[rt]&&registeredModules[rt].forEach(function(_){_()}),workers[rt]&&(workers[rt].terminate(),delete workers[rt])}function stringifyFunction(rt){var _=rt.toString();return!/^function/.test(_)&&/^\w+\s*\(/.test(_)&&(_="function "+_),_}function getWorker(rt){var _=workers[rt];if(!_){var ut=stringifyFunction(workerBootstrap);_=workers[rt]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+rt.replace(/\*/g,"")+` **/

;(`+ut+")()"],{type:"application/javascript"}))),_.onmessage=function(mt){var bt=mt.data,St=bt.messageId,Mt=openRequests[St];if(!Mt)throw new Error("WorkerModule response with empty or unknown messageId");delete openRequests[St],Mt(bt)}}return _}function callWorker(rt,_,ut){return new Promise(function(mt,bt){var St=++_messageId;openRequests[St]=function(Mt){Mt.success?mt(Mt.result):bt(new Error("Error in worker "+_+" call: "+Mt.error))},getWorker(rt).postMessage({messageId:St,action:_,data:ut})})}function SDFGenerator(){var rt=function(_){function ut(eo,Ao,Oo,uo,uu,cu,Jl,mu){var pu=1-Jl;mu.x=pu*pu*eo+2*pu*Jl*Oo+Jl*Jl*uu,mu.y=pu*pu*Ao+2*pu*Jl*uo+Jl*Jl*cu}function mt(eo,Ao,Oo,uo,uu,cu,Jl,mu,pu,Zu){var Mp=1-pu;Zu.x=Mp*Mp*Mp*eo+3*Mp*Mp*pu*Oo+3*Mp*pu*pu*uu+pu*pu*pu*Jl,Zu.y=Mp*Mp*Mp*Ao+3*Mp*Mp*pu*uo+3*Mp*pu*pu*cu+pu*pu*pu*mu}function bt(eo,Ao){for(var Oo=/([MLQCZ])([^MLQCZ]*)/g,uo,uu,cu,Jl,mu;uo=Oo.exec(eo);){var pu=uo[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(Zu){return parseFloat(Zu)});switch(uo[1]){case"M":Jl=uu=pu[0],mu=cu=pu[1];break;case"L":(pu[0]!==Jl||pu[1]!==mu)&&Ao("L",Jl,mu,Jl=pu[0],mu=pu[1]);break;case"Q":{Ao("Q",Jl,mu,Jl=pu[2],mu=pu[3],pu[0],pu[1]);break}case"C":{Ao("C",Jl,mu,Jl=pu[4],mu=pu[5],pu[0],pu[1],pu[2],pu[3]);break}case"Z":(Jl!==uu||mu!==cu)&&Ao("L",Jl,mu,uu,cu);break}}}function St(eo,Ao,Oo){Oo===void 0&&(Oo=16);var uo={x:0,y:0};bt(eo,function(uu,cu,Jl,mu,pu,Zu,Mp,Up,Ep){switch(uu){case"L":Ao(cu,Jl,mu,pu);break;case"Q":{for(var mp=cu,Cp=Jl,t0=1;t0<Oo;t0++)ut(cu,Jl,Zu,Mp,mu,pu,t0/(Oo-1),uo),Ao(mp,Cp,uo.x,uo.y),mp=uo.x,Cp=uo.y;break}case"C":{for(var _g=cu,m0=Jl,K0=1;K0<Oo;K0++)mt(cu,Jl,Zu,Mp,Up,Ep,mu,pu,K0/(Oo-1),uo),Ao(_g,m0,uo.x,uo.y),_g=uo.x,m0=uo.y;break}}})}var Mt="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",Bt="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",Ut=new WeakMap,Ht={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function tr(eo,Ao){var Oo=eo.getContext?eo.getContext("webgl",Ht):eo,uo=Ut.get(Oo);if(!uo){let _g=function(jm){var Nu=cu[jm];if(!Nu&&(Nu=cu[jm]=Oo.getExtension(jm),!Nu))throw new Error(jm+" not supported");return Nu},m0=function(jm,Nu){var Co=Oo.createShader(Nu);return Oo.shaderSource(Co,jm),Oo.compileShader(Co),Co},K0=function(jm,Nu,Co,Bp){if(!Jl[jm]){var a0={},Q0={},T0=Oo.createProgram();Oo.attachShader(T0,m0(Nu,Oo.VERTEX_SHADER)),Oo.attachShader(T0,m0(Co,Oo.FRAGMENT_SHADER)),Oo.linkProgram(T0),Jl[jm]={program:T0,transaction:function(lv){Oo.useProgram(T0),lv({setUniform:function(zv,Uv){for(var Gv=[],Dv=arguments.length-2;Dv-- >0;)Gv[Dv]=arguments[Dv+2];var Cv=Q0[Uv]||(Q0[Uv]=Oo.getUniformLocation(T0,Uv));Oo["uniform"+zv].apply(Oo,[Cv].concat(Gv))},setAttribute:function(zv,Uv,Gv,Dv,Cv){var Kp=a0[zv];Kp||(Kp=a0[zv]={buf:Oo.createBuffer(),loc:Oo.getAttribLocation(T0,zv),data:null}),Oo.bindBuffer(Oo.ARRAY_BUFFER,Kp.buf),Oo.vertexAttribPointer(Kp.loc,Uv,Oo.FLOAT,!1,0,0),Oo.enableVertexAttribArray(Kp.loc),uu?Oo.vertexAttribDivisor(Kp.loc,Dv):_g("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Kp.loc,Dv),Cv!==Kp.data&&(Oo.bufferData(Oo.ARRAY_BUFFER,Cv,Gv),Kp.data=Cv)}})}}}Jl[jm].transaction(Bp)},Jp=function(jm,Nu){pu++;try{Oo.activeTexture(Oo.TEXTURE0+pu);var Co=mu[jm];Co||(Co=mu[jm]=Oo.createTexture(),Oo.bindTexture(Oo.TEXTURE_2D,Co),Oo.texParameteri(Oo.TEXTURE_2D,Oo.TEXTURE_MIN_FILTER,Oo.NEAREST),Oo.texParameteri(Oo.TEXTURE_2D,Oo.TEXTURE_MAG_FILTER,Oo.NEAREST)),Oo.bindTexture(Oo.TEXTURE_2D,Co),Nu(Co,pu)}finally{pu--}},y0=function(jm,Nu,Co){var Bp=Oo.createFramebuffer();Zu.push(Bp),Oo.bindFramebuffer(Oo.FRAMEBUFFER,Bp),Oo.activeTexture(Oo.TEXTURE0+Nu),Oo.bindTexture(Oo.TEXTURE_2D,jm),Oo.framebufferTexture2D(Oo.FRAMEBUFFER,Oo.COLOR_ATTACHMENT0,Oo.TEXTURE_2D,jm,0);try{Co(Bp)}finally{Oo.deleteFramebuffer(Bp),Oo.bindFramebuffer(Oo.FRAMEBUFFER,Zu[--Zu.length-1]||null)}},z0=function(){cu={},Jl={},mu={},pu=-1,Zu.length=0};var Mp=_g,Up=m0,Ep=K0,mp=Jp,Cp=y0,t0=z0,uu=typeof WebGL2RenderingContext<"u"&&Oo instanceof WebGL2RenderingContext,cu={},Jl={},mu={},pu=-1,Zu=[];Oo.canvas.addEventListener("webglcontextlost",function(jm){z0(),jm.preventDefault()},!1),Ut.set(Oo,uo={gl:Oo,isWebGL2:uu,getExtension:_g,withProgram:K0,withTexture:Jp,withTextureFramebuffer:y0,handleContextLoss:z0})}Ao(uo)}function rr(eo,Ao,Oo,uo,uu,cu,Jl,mu){Jl===void 0&&(Jl=15),mu===void 0&&(mu=null),tr(eo,function(pu){var Zu=pu.gl,Mp=pu.withProgram,Up=pu.withTexture;Up("copy",function(Ep,mp){Zu.texImage2D(Zu.TEXTURE_2D,0,Zu.RGBA,uu,cu,0,Zu.RGBA,Zu.UNSIGNED_BYTE,Ao),Mp("copy",Mt,Bt,function(Cp){var t0=Cp.setUniform,_g=Cp.setAttribute;_g("aUV",2,Zu.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),t0("1i","image",mp),Zu.bindFramebuffer(Zu.FRAMEBUFFER,mu||null),Zu.disable(Zu.BLEND),Zu.colorMask(Jl&8,Jl&4,Jl&2,Jl&1),Zu.viewport(Oo,uo,uu,cu),Zu.scissor(Oo,uo,uu,cu),Zu.drawArrays(Zu.TRIANGLES,0,3)})})})}function sr(eo,Ao,Oo){var uo=eo.width,uu=eo.height;tr(eo,function(cu){var Jl=cu.gl,mu=new Uint8Array(uo*uu*4);Jl.readPixels(0,0,uo,uu,Jl.RGBA,Jl.UNSIGNED_BYTE,mu),eo.width=Ao,eo.height=Oo,rr(Jl,mu,0,0,uo,uu)})}var ar=Object.freeze({__proto__:null,withWebGLContext:tr,renderImageData:rr,resizeWebGLCanvasWithoutClearing:sr});function cr(eo,Ao,Oo,uo,uu,cu){cu===void 0&&(cu=1);var Jl=new Uint8Array(eo*Ao),mu=uo[2]-uo[0],pu=uo[3]-uo[1],Zu=[];St(Oo,function(_g,m0,K0,Jp){Zu.push({x1:_g,y1:m0,x2:K0,y2:Jp,minX:Math.min(_g,K0),minY:Math.min(m0,Jp),maxX:Math.max(_g,K0),maxY:Math.max(m0,Jp)})}),Zu.sort(function(_g,m0){return _g.maxX-m0.maxX});for(var Mp=0;Mp<eo;Mp++)for(var Up=0;Up<Ao;Up++){var Ep=Cp(uo[0]+mu*(Mp+.5)/eo,uo[1]+pu*(Up+.5)/Ao),mp=Math.pow(1-Math.abs(Ep)/uu,cu)/2;Ep<0&&(mp=1-mp),mp=Math.max(0,Math.min(255,Math.round(mp*255))),Jl[Up*eo+Mp]=mp}return Jl;function Cp(_g,m0){for(var K0=1/0,Jp=1/0,y0=Zu.length;y0--;){var z0=Zu[y0];if(z0.maxX+Jp<=_g)break;if(_g+Jp>z0.minX&&m0-Jp<z0.maxY&&m0+Jp>z0.minY){var jm=Dr(_g,m0,z0.x1,z0.y1,z0.x2,z0.y2);jm<K0&&(K0=jm,Jp=Math.sqrt(K0))}}return t0(_g,m0)&&(Jp=-Jp),Jp}function t0(_g,m0){for(var K0=0,Jp=Zu.length;Jp--;){var y0=Zu[Jp];if(y0.maxX<=_g)break;var z0=y0.y1>m0!=y0.y2>m0&&_g<(y0.x2-y0.x1)*(m0-y0.y1)/(y0.y2-y0.y1)+y0.x1;z0&&(K0+=y0.y1<y0.y2?1:-1)}return K0!==0}}function Ar(eo,Ao,Oo,uo,uu,cu,Jl,mu,pu,Zu){cu===void 0&&(cu=1),mu===void 0&&(mu=0),pu===void 0&&(pu=0),Zu===void 0&&(Zu=0),_r(eo,Ao,Oo,uo,uu,cu,Jl,null,mu,pu,Zu)}function _r(eo,Ao,Oo,uo,uu,cu,Jl,mu,pu,Zu,Mp){cu===void 0&&(cu=1),pu===void 0&&(pu=0),Zu===void 0&&(Zu=0),Mp===void 0&&(Mp=0);for(var Up=cr(eo,Ao,Oo,uo,uu,cu),Ep=new Uint8Array(Up.length*4),mp=0;mp<Up.length;mp++)Ep[mp*4+Mp]=Up[mp];rr(Jl,Ep,pu,Zu,eo,Ao,1<<3-Mp,mu)}function Dr(eo,Ao,Oo,uo,uu,cu){var Jl=uu-Oo,mu=cu-uo,pu=Jl*Jl+mu*mu,Zu=pu?Math.max(0,Math.min(1,((eo-Oo)*Jl+(Ao-uo)*mu)/pu)):0,Mp=eo-(Oo+Zu*Jl),Up=Ao-(uo+Zu*mu);return Mp*Mp+Up*Up}var $r=Object.freeze({__proto__:null,generate:cr,generateIntoCanvas:Ar,generateIntoFramebuffer:_r}),Br="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",Jr="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",mn="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",Mn=new Float32Array([0,0,2,0,0,2]),$n=null,en=!1,In={},Rn=new WeakMap;function qn(eo){if(!en&&!ks(eo))throw new Error("WebGL generation not supported")}function Qn(eo,Ao,Oo,uo,uu,cu,Jl){if(cu===void 0&&(cu=1),Jl===void 0&&(Jl=null),!Jl&&(Jl=$n,!Jl)){var mu=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!mu)throw new Error("OffscreenCanvas or DOM canvas not supported");Jl=$n=mu.getContext("webgl",{depth:!1})}qn(Jl);var pu=new Uint8Array(eo*Ao*4);tr(Jl,function(Ep){var mp=Ep.gl,Cp=Ep.withTexture,t0=Ep.withTextureFramebuffer;Cp("readable",function(_g,m0){mp.texImage2D(mp.TEXTURE_2D,0,mp.RGBA,eo,Ao,0,mp.RGBA,mp.UNSIGNED_BYTE,null),t0(_g,m0,function(K0){cs(eo,Ao,Oo,uo,uu,cu,mp,K0,0,0,0),mp.readPixels(0,0,eo,Ao,mp.RGBA,mp.UNSIGNED_BYTE,pu)})})});for(var Zu=new Uint8Array(eo*Ao),Mp=0,Up=0;Mp<pu.length;Mp+=4)Zu[Up++]=pu[Mp];return Zu}function xs(eo,Ao,Oo,uo,uu,cu,Jl,mu,pu,Zu){cu===void 0&&(cu=1),mu===void 0&&(mu=0),pu===void 0&&(pu=0),Zu===void 0&&(Zu=0),cs(eo,Ao,Oo,uo,uu,cu,Jl,null,mu,pu,Zu)}function cs(eo,Ao,Oo,uo,uu,cu,Jl,mu,pu,Zu,Mp){cu===void 0&&(cu=1),pu===void 0&&(pu=0),Zu===void 0&&(Zu=0),Mp===void 0&&(Mp=0),qn(Jl);var Up=[];St(Oo,function(Ep,mp,Cp,t0){Up.push(Ep,mp,Cp,t0)}),Up=new Float32Array(Up),tr(Jl,function(Ep){var mp=Ep.gl,Cp=Ep.isWebGL2,t0=Ep.getExtension,_g=Ep.withProgram,m0=Ep.withTexture,K0=Ep.withTextureFramebuffer,Jp=Ep.handleContextLoss;if(m0("rawDistances",function(y0,z0){(eo!==y0._lastWidth||Ao!==y0._lastHeight)&&mp.texImage2D(mp.TEXTURE_2D,0,mp.RGBA,y0._lastWidth=eo,y0._lastHeight=Ao,0,mp.RGBA,mp.UNSIGNED_BYTE,null),_g("main",Br,Jr,function(jm){var Nu=jm.setAttribute,Co=jm.setUniform,Bp=!Cp&&t0("ANGLE_instanced_arrays"),a0=!Cp&&t0("EXT_blend_minmax");Nu("aUV",2,mp.STATIC_DRAW,0,Mn),Nu("aLineSegment",4,mp.DYNAMIC_DRAW,1,Up),Co.apply(void 0,["4f","uGlyphBounds"].concat(uo)),Co("1f","uMaxDistance",uu),Co("1f","uExponent",cu),K0(y0,z0,function(Q0){mp.enable(mp.BLEND),mp.colorMask(!0,!0,!0,!0),mp.viewport(0,0,eo,Ao),mp.scissor(0,0,eo,Ao),mp.blendFunc(mp.ONE,mp.ONE),mp.blendEquationSeparate(mp.FUNC_ADD,Cp?mp.MAX:a0.MAX_EXT),mp.clear(mp.COLOR_BUFFER_BIT),Cp?mp.drawArraysInstanced(mp.TRIANGLES,0,3,Up.length/4):Bp.drawArraysInstancedANGLE(mp.TRIANGLES,0,3,Up.length/4)})}),_g("post",Mt,mn,function(jm){jm.setAttribute("aUV",2,mp.STATIC_DRAW,0,Mn),jm.setUniform("1i","tex",z0),mp.bindFramebuffer(mp.FRAMEBUFFER,mu),mp.disable(mp.BLEND),mp.colorMask(Mp===0,Mp===1,Mp===2,Mp===3),mp.viewport(pu,Zu,eo,Ao),mp.scissor(pu,Zu,eo,Ao),mp.drawArrays(mp.TRIANGLES,0,3)})}),mp.isContextLost())throw Jp(),new Error("webgl context lost")})}function ks(eo){var Ao=!eo||eo===$n?In:eo.canvas||eo,Oo=Rn.get(Ao);if(Oo===void 0){en=!0;var uo=null;try{var uu=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],cu=Qn(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,eo);Oo=cu&&uu.length===cu.length&&cu.every(function(Jl,mu){return Jl===uu[mu]}),Oo||(uo="bad trial run results",console.info(uu,cu))}catch(Jl){Oo=!1,uo=Jl.message}uo&&console.warn("WebGL SDF generation not supported:",uo),en=!1,Rn.set(Ao,Oo)}return Oo}var _o=Object.freeze({__proto__:null,generate:Qn,generateIntoCanvas:xs,generateIntoFramebuffer:cs,isSupported:ks});function qs(eo,Ao,Oo,uo,uu,cu){uu===void 0&&(uu=Math.max(uo[2]-uo[0],uo[3]-uo[1])/2),cu===void 0&&(cu=1);try{return Qn.apply(_o,arguments)}catch(Jl){return console.info("WebGL SDF generation failed, falling back to JS",Jl),cr.apply($r,arguments)}}function Ss(eo,Ao,Oo,uo,uu,cu,Jl,mu,pu,Zu){uu===void 0&&(uu=Math.max(uo[2]-uo[0],uo[3]-uo[1])/2),cu===void 0&&(cu=1),mu===void 0&&(mu=0),pu===void 0&&(pu=0),Zu===void 0&&(Zu=0);try{return xs.apply(_o,arguments)}catch(Mp){return console.info("WebGL SDF generation failed, falling back to JS",Mp),Ar.apply($r,arguments)}}return _.forEachPathCommand=bt,_.generate=qs,_.generateIntoCanvas=Ss,_.javascript=$r,_.pathToLineSegments=St,_.webgl=_o,_.webglUtils=ar,Object.defineProperty(_,"__esModule",{value:!0}),_}({});return rt}function bidiFactory(){var rt=function(_){var ut={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},mt={},bt={};mt.L=1,bt[1]="L",Object.keys(ut).forEach(function(Jp,y0){mt[Jp]=1<<y0+1,bt[mt[Jp]]=Jp}),Object.freeze(mt);var St=mt.LRI|mt.RLI|mt.FSI,Mt=mt.L|mt.R|mt.AL,Bt=mt.B|mt.S|mt.WS|mt.ON|mt.FSI|mt.LRI|mt.RLI|mt.PDI,Ut=mt.BN|mt.RLE|mt.LRE|mt.RLO|mt.LRO|mt.PDF,Ht=mt.S|mt.WS|mt.B|St|mt.PDI|Ut,tr=null;function rr(){if(!tr){tr=new Map;var Jp=function(z0){if(ut.hasOwnProperty(z0)){var jm=0;ut[z0].split(",").forEach(function(Nu){var Co=Nu.split("+"),Bp=Co[0],a0=Co[1];Bp=parseInt(Bp,36),a0=a0?parseInt(a0,36):0,tr.set(jm+=Bp,mt[z0]);for(var Q0=0;Q0<a0;Q0++)tr.set(++jm,mt[z0])})}};for(var y0 in ut)Jp(y0)}}function sr(Jp){return rr(),tr.get(Jp.codePointAt(0))||mt.L}function ar(Jp){return bt[sr(Jp)]}var cr={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function Ar(Jp,y0){var z0=36,jm=0,Nu=new Map,Co=y0&&new Map,Bp;return Jp.split(",").forEach(function a0(Q0){if(Q0.indexOf("+")!==-1)for(var T0=+Q0;T0--;)a0(Bp);else{Bp=Q0;var av=Q0.split(">"),lv=av[0],N0=av[1];lv=String.fromCodePoint(jm+=parseInt(lv,z0)),N0=String.fromCodePoint(jm+=parseInt(N0,z0)),Nu.set(lv,N0),y0&&Co.set(N0,lv)}}),{map:Nu,reverseMap:Co}}var _r,Dr,$r;function Br(){if(!_r){var Jp=Ar(cr.pairs,!0),y0=Jp.map,z0=Jp.reverseMap;_r=y0,Dr=z0,$r=Ar(cr.canonical,!1).map}}function Jr(Jp){return Br(),_r.get(Jp)||null}function mn(Jp){return Br(),Dr.get(Jp)||null}function Mn(Jp){return Br(),$r.get(Jp)||null}var $n=mt.L,en=mt.R,In=mt.EN,Rn=mt.ES,qn=mt.ET,Qn=mt.AN,xs=mt.CS,cs=mt.B,ks=mt.S,_o=mt.ON,qs=mt.BN,Ss=mt.NSM,eo=mt.AL,Ao=mt.LRO,Oo=mt.RLO,uo=mt.LRE,uu=mt.RLE,cu=mt.PDF,Jl=mt.LRI,mu=mt.RLI,pu=mt.FSI,Zu=mt.PDI;function Mp(Jp,y0){for(var z0=125,jm=new Uint32Array(Jp.length),Nu=0;Nu<Jp.length;Nu++)jm[Nu]=sr(Jp[Nu]);var Co=new Map;function Bp(vE,RE){var lE=jm[vE];jm[vE]=RE,Co.set(lE,Co.get(lE)-1),lE&Bt&&Co.set(Bt,Co.get(Bt)-1),Co.set(RE,(Co.get(RE)||0)+1),RE&Bt&&Co.set(Bt,(Co.get(Bt)||0)+1)}for(var a0=new Uint8Array(Jp.length),Q0=new Map,T0=[],av=null,lv=0;lv<Jp.length;lv++)av||T0.push(av={start:lv,end:Jp.length-1,level:y0==="rtl"?1:y0==="ltr"?0:FM(lv,!1)}),jm[lv]&cs&&(av.end=lv,av=null);for(var N0=uu|uo|Oo|Ao|St|Zu|cu|cs,zv=function(vE){return vE+(vE&1?1:2)},Uv=function(vE){return vE+(vE&1?2:1)},Gv=0;Gv<T0.length;Gv++){av=T0[Gv];var Dv=[{_level:av.level,_override:0,_isolate:0}],Cv=void 0,Kp=0,sv=0,Hv=0;Co.clear();for(var jp=av.start;jp<=av.end;jp++){var Fp=jm[jp];if(Cv=Dv[Dv.length-1],Co.set(Fp,(Co.get(Fp)||0)+1),Fp&Bt&&Co.set(Bt,(Co.get(Bt)||0)+1),Fp&N0)if(Fp&(uu|uo)){a0[jp]=Cv._level;var nv=(Fp===uu?Uv:zv)(Cv._level);nv<=z0&&!Kp&&!sv?Dv.push({_level:nv,_override:0,_isolate:0}):Kp||sv++}else if(Fp&(Oo|Ao)){a0[jp]=Cv._level;var qy=(Fp===Oo?Uv:zv)(Cv._level);qy<=z0&&!Kp&&!sv?Dv.push({_level:qy,_override:Fp&Oo?en:$n,_isolate:0}):Kp||sv++}else if(Fp&St){Fp&pu&&(Fp=FM(jp+1,!0)===1?mu:Jl),a0[jp]=Cv._level,Cv._override&&Bp(jp,Cv._override);var Uy=(Fp===mu?Uv:zv)(Cv._level);Uy<=z0&&Kp===0&&sv===0?(Hv++,Dv.push({_level:Uy,_override:0,_isolate:1,_isolInitIndex:jp})):Kp++}else if(Fp&Zu){if(Kp>0)Kp--;else if(Hv>0){for(sv=0;!Dv[Dv.length-1]._isolate;)Dv.pop();var vx=Dv[Dv.length-1]._isolInitIndex;vx!=null&&(Q0.set(vx,jp),Q0.set(jp,vx)),Dv.pop(),Hv--}Cv=Dv[Dv.length-1],a0[jp]=Cv._level,Cv._override&&Bp(jp,Cv._override)}else Fp&cu?(Kp===0&&(sv>0?sv--:!Cv._isolate&&Dv.length>1&&(Dv.pop(),Cv=Dv[Dv.length-1])),a0[jp]=Cv._level):Fp&cs&&(a0[jp]=av.level);else a0[jp]=Cv._level,Cv._override&&Fp!==qs&&Bp(jp,Cv._override)}for(var qx=[],Kx=null,Mx=av.start;Mx<=av.end;Mx++){var Ox=jm[Mx];if(!(Ox&Ut)){var E2=a0[Mx],$2=Ox&St,X2=Ox===Zu;Kx&&E2===Kx._level?(Kx._end=Mx,Kx._endsWithIsolInit=$2):qx.push(Kx={_start:Mx,_end:Mx,_level:E2,_startsWithPDI:X2,_endsWithIsolInit:$2})}}for(var _E=[],mE=0;mE<qx.length;mE++){var Pp=qx[mE];if(!Pp._startsWithPDI||Pp._startsWithPDI&&!Q0.has(Pp._start)){for(var tv=[Kx=Pp],ov=void 0;Kx&&Kx._endsWithIsolInit&&(ov=Q0.get(Kx._end))!=null;)for(var p0=mE+1;p0<qx.length;p0++)if(qx[p0]._start===ov){tv.push(Kx=qx[p0]);break}for(var bv=[],Dx=0;Dx<tv.length;Dx++)for(var ru=tv[Dx],Iu=ru._start;Iu<=ru._end;Iu++)bv.push(Iu);for(var Hp=a0[bv[0]],M0=av.level,H0=bv[0]-1;H0>=0;H0--)if(!(jm[H0]&Ut)){M0=a0[H0];break}var Z0=bv[bv.length-1],Fv=a0[Z0],kv=av.level;if(!(jm[Z0]&St)){for(var Dy=Z0+1;Dy<=av.end;Dy++)if(!(jm[Dy]&Ut)){kv=a0[Dy];break}}_E.push({_seqIndices:bv,_sosType:Math.max(M0,Hp)%2?en:$n,_eosType:Math.max(kv,Fv)%2?en:$n})}}for(var Gy=0;Gy<_E.length;Gy++){var jv=_E[Gy],I0=jv._seqIndices,M2=jv._sosType,dx=jv._eosType,bx=a0[I0[0]]&1?en:$n;if(Co.get(Ss))for(var Jx=0;Jx<I0.length;Jx++){var t2=I0[Jx];if(jm[t2]&Ss){for(var y2=M2,Hx=Jx-1;Hx>=0;Hx--)if(!(jm[I0[Hx]]&Ut)){y2=jm[I0[Hx]];break}Bp(t2,y2&(St|Zu)?_o:y2)}}if(Co.get(In))for(var $x=0;$x<I0.length;$x++){var r2=I0[$x];if(jm[r2]&In)for(var Yx=$x-1;Yx>=-1;Yx--){var I2=Yx===-1?M2:jm[I0[Yx]];if(I2&Mt){I2===eo&&Bp(r2,Qn);break}}}if(Co.get(eo))for(var d2=0;d2<I0.length;d2++){var V2=I0[d2];jm[V2]&eo&&Bp(V2,en)}if(Co.get(Rn)||Co.get(xs))for(var iE=1;iE<I0.length-1;iE++){var K2=I0[iE];if(jm[K2]&(Rn|xs)){for(var Y2=0,N2=0,tE=iE-1;tE>=0&&(Y2=jm[I0[tE]],!!(Y2&Ut));tE--);for(var U2=iE+1;U2<I0.length&&(N2=jm[I0[U2]],!!(N2&Ut));U2++);Y2===N2&&(jm[K2]===Rn?Y2===In:Y2&(In|Qn))&&Bp(K2,Y2)}}if(Co.get(In))for(var f2=0;f2<I0.length;f2++){var q2=I0[f2];if(jm[q2]&In){for(var IE=f2-1;IE>=0&&jm[I0[IE]]&(qn|Ut);IE--)Bp(I0[IE],In);for(f2++;f2<I0.length&&jm[I0[f2]]&(qn|Ut|In);f2++)jm[I0[f2]]!==In&&Bp(I0[f2],In)}}if(Co.get(qn)||Co.get(Rn)||Co.get(xs))for(var oE=0;oE<I0.length;oE++){var FE=I0[oE];if(jm[FE]&(qn|Rn|xs)){Bp(FE,_o);for(var DC=oE-1;DC>=0&&jm[I0[DC]]&Ut;DC--)Bp(I0[DC],_o);for(var BC=oE+1;BC<I0.length&&jm[I0[BC]]&Ut;BC++)Bp(I0[BC],_o)}}if(Co.get(In))for(var LC=0,pM=M2;LC<I0.length;LC++){var CP=I0[LC],JM=jm[CP];JM&In?pM===$n&&Bp(CP,$n):JM&Mt&&(pM=JM)}if(Co.get(Bt)){var kC=en|In|Qn,IM=kC|$n,_C=[];{for(var jC=[],wC=0;wC<I0.length;wC++)if(jm[I0[wC]]&Bt){var D2=Jp[I0[wC]],QM=void 0;if(Jr(D2)!==null)if(jC.length<63)jC.push({char:D2,seqIndex:wC});else break;else if((QM=mn(D2))!==null)for(var FC=jC.length-1;FC>=0;FC--){var kM=jC[FC].char;if(kM===QM||kM===mn(Mn(D2))||Jr(Mn(kM))===D2){_C.push([jC[FC].seqIndex,wC]),jC.length=FC;break}}}_C.sort(function(vE,RE){return vE[0]-RE[0]})}for(var ZM=0;ZM<_C.length;ZM++){for(var MP=_C[ZM],rE=MP[0],mM=MP[1],TP=!1,ME=0,iT=rE+1;iT<mM;iT++){var gM=I0[iT];if(jm[gM]&IM){TP=!0;var NE=jm[gM]&kC?en:$n;if(NE===bx){ME=NE;break}}}if(TP&&!ME){ME=M2;for(var sT=rE-1;sT>=0;sT--){var PP=I0[sT];if(jm[PP]&IM){var UE=jm[PP]&kC?en:$n;UE!==bx?ME=UE:ME=bx;break}}}if(ME){if(jm[I0[rE]]=jm[I0[mM]]=ME,ME!==bx){for(var TE=rE+1;TE<I0.length;TE++)if(!(jm[I0[TE]]&Ut)){sr(Jp[I0[TE]])&Ss&&(jm[I0[TE]]=ME);break}}if(ME!==bx){for(var EC=mM+1;EC<I0.length;EC++)if(!(jm[I0[EC]]&Ut)){sr(Jp[I0[EC]])&Ss&&(jm[I0[EC]]=ME);break}}}}for(var WE=0;WE<I0.length;WE++)if(jm[I0[WE]]&Bt){for(var aT=WE,hT=WE,BE=M2,vM=WE-1;vM>=0;vM--)if(jm[I0[vM]]&Ut)aT=vM;else{BE=jm[I0[vM]]&kC?en:$n;break}for(var yM=dx,xM=WE+1;xM<I0.length;xM++)if(jm[I0[xM]]&(Bt|Ut))hT=xM;else{yM=jm[I0[xM]]&kC?en:$n;break}for(var PE=aT;PE<=hT;PE++)jm[I0[PE]]=BE===yM?BE:bx;WE=hT}}}for(var gE=av.start;gE<=av.end;gE++){var OM=a0[gE],mC=jm[gE];if(OM&1?mC&($n|In|Qn)&&a0[gE]++:mC&en?a0[gE]++:mC&(Qn|In)&&(a0[gE]+=2),mC&Ut&&(a0[gE]=gE===0?av.level:a0[gE-1]),gE===av.end||sr(Jp[gE])&(ks|cs))for(var HC=gE;HC>=0&&sr(Jp[HC])&Ht;HC--)a0[HC]=av.level}}return{levels:a0,paragraphs:T0};function FM(vE,RE){for(var lE=vE;lE<Jp.length;lE++){var uE=jm[lE];if(uE&(en|eo))return 1;if(uE&(cs|$n)||RE&&uE===Zu)return 0;if(uE&St){var VE=RP(lE);lE=VE===-1?Jp.length:VE}}return 0}function RP(vE){for(var RE=1,lE=vE+1;lE<Jp.length;lE++){var uE=jm[lE];if(uE&cs)break;if(uE&Zu){if(--RE===0)return lE}else uE&St&&RE++}return-1}}var Up="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",Ep;function mp(){if(!Ep){var Jp=Ar(Up,!0),y0=Jp.map,z0=Jp.reverseMap;z0.forEach(function(jm,Nu){y0.set(Nu,jm)}),Ep=y0}}function Cp(Jp){return mp(),Ep.get(Jp)||null}function t0(Jp,y0,z0,jm){var Nu=Jp.length;z0=Math.max(0,z0==null?0:+z0),jm=Math.min(Nu-1,jm==null?Nu-1:+jm);for(var Co=new Map,Bp=z0;Bp<=jm;Bp++)if(y0[Bp]&1){var a0=Cp(Jp[Bp]);a0!==null&&Co.set(Bp,a0)}return Co}function _g(Jp,y0,z0,jm){var Nu=Jp.length;z0=Math.max(0,z0==null?0:+z0),jm=Math.min(Nu-1,jm==null?Nu-1:+jm);var Co=[];return y0.paragraphs.forEach(function(Bp){var a0=Math.max(z0,Bp.start),Q0=Math.min(jm,Bp.end);if(a0<Q0){for(var T0=y0.levels.slice(a0,Q0+1),av=Q0;av>=a0&&sr(Jp[av])&Ht;av--)T0[av]=Bp.level;for(var lv=Bp.level,N0=1/0,zv=0;zv<T0.length;zv++){var Uv=T0[zv];Uv>lv&&(lv=Uv),Uv<N0&&(N0=Uv|1)}for(var Gv=lv;Gv>=N0;Gv--)for(var Dv=0;Dv<T0.length;Dv++)if(T0[Dv]>=Gv){for(var Cv=Dv;Dv+1<T0.length&&T0[Dv+1]>=Gv;)Dv++;Dv>Cv&&Co.push([Cv+a0,Dv+a0])}}}),Co}function m0(Jp,y0,z0,jm){var Nu=K0(Jp,y0,z0,jm),Co=[].concat(Jp);return Nu.forEach(function(Bp,a0){Co[a0]=(y0.levels[Bp]&1?Cp(Jp[Bp]):null)||Jp[Bp]}),Co.join("")}function K0(Jp,y0,z0,jm){for(var Nu=_g(Jp,y0,z0,jm),Co=[],Bp=0;Bp<Jp.length;Bp++)Co[Bp]=Bp;return Nu.forEach(function(a0){for(var Q0=a0[0],T0=a0[1],av=Co.slice(Q0,T0+1),lv=av.length;lv--;)Co[T0-lv]=av[lv]}),Co}return _.closingToOpeningBracket=mn,_.getBidiCharType=sr,_.getBidiCharTypeName=ar,_.getCanonicalBracket=Mn,_.getEmbeddingLevels=Mp,_.getMirroredCharacter=Cp,_.getMirroredCharactersMap=t0,_.getReorderSegments=_g,_.getReorderedIndices=K0,_.getReorderedString=m0,_.openingToClosingBracket=Jr,Object.defineProperty(_,"__esModule",{value:!0}),_}({});return rt}const voidMainRegExp=/\bvoid\s+main\s*\(\s*\)\s*{/g;function expandShaderIncludes(rt){const _=/^[ \t]*#include +<([\w\d./]+)>/gm;function ut(mt,bt){let St=ShaderChunk[bt];return St?expandShaderIncludes(St):mt}return rt.replace(_,ut)}const _lut=[];for(let rt=0;rt<256;rt++)_lut[rt]=(rt<16?"0":"")+rt.toString(16);function generateUUID(){const rt=Math.random()*4294967295|0,_=Math.random()*4294967295|0,ut=Math.random()*4294967295|0,mt=Math.random()*4294967295|0;return(_lut[rt&255]+_lut[rt>>8&255]+_lut[rt>>16&255]+_lut[rt>>24&255]+"-"+_lut[_&255]+_lut[_>>8&255]+"-"+_lut[_>>16&15|64]+_lut[_>>24&255]+"-"+_lut[ut&63|128]+_lut[ut>>8&255]+"-"+_lut[ut>>16&255]+_lut[ut>>24&255]+_lut[mt&255]+_lut[mt>>8&255]+_lut[mt>>16&255]+_lut[mt>>24&255]).toUpperCase()}const assign$3=Object.assign||function(){let rt=arguments[0];for(let _=1,ut=arguments.length;_<ut;_++){let mt=arguments[_];if(mt)for(let bt in mt)Object.prototype.hasOwnProperty.call(mt,bt)&&(rt[bt]=mt[bt])}return rt},epoch=Date.now(),CONSTRUCTOR_CACHE=new WeakMap,SHADER_UPGRADE_CACHE=new Map;let materialInstanceId=1e10;function createDerivedMaterial(rt,_){const ut=getKeyForOptions(_);let mt=CONSTRUCTOR_CACHE.get(rt);if(mt||CONSTRUCTOR_CACHE.set(rt,mt=Object.create(null)),mt[ut])return new mt[ut];const bt=`_onBeforeCompile${ut}`,St=function(Ht,tr){rt.onBeforeCompile.call(this,Ht,tr);const rr=this.customProgramCacheKey()+"|"+Ht.vertexShader+"|"+Ht.fragmentShader;let sr=SHADER_UPGRADE_CACHE[rr];if(!sr){const ar=upgradeShaders(this,Ht,_,ut);sr=SHADER_UPGRADE_CACHE[rr]=ar}Ht.vertexShader=sr.vertexShader,Ht.fragmentShader=sr.fragmentShader,assign$3(Ht.uniforms,this.uniforms),_.timeUniform&&(Ht.uniforms[_.timeUniform]={get value(){return Date.now()-epoch}}),this[bt]&&this[bt](Ht)},Mt=function(){return Bt(_.chained?rt:rt.clone())},Bt=function(Ht){const tr=Object.create(Ht,Ut);return Object.defineProperty(tr,"baseMaterial",{value:rt}),Object.defineProperty(tr,"id",{value:materialInstanceId++}),tr.uuid=generateUUID(),tr.uniforms=assign$3({},Ht.uniforms,_.uniforms),tr.defines=assign$3({},Ht.defines,_.defines),tr.defines[`TROIKA_DERIVED_MATERIAL_${ut}`]="",tr.extensions=assign$3({},Ht.extensions,_.extensions),tr._listeners=void 0,tr},Ut={constructor:{value:Mt},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return rt.customProgramCacheKey()+"|"+ut}},onBeforeCompile:{get(){return St},set(Ht){this[bt]=Ht}},copy:{writable:!0,configurable:!0,value:function(Ht){return rt.copy.call(this,Ht),!rt.isShaderMaterial&&!rt.isDerivedMaterial&&(assign$3(this.extensions,Ht.extensions),assign$3(this.defines,Ht.defines),assign$3(this.uniforms,UniformsUtils.clone(Ht.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const Ht=new rt.constructor;return Bt(Ht).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let Ht=this._depthMaterial;return Ht||(Ht=this._depthMaterial=createDerivedMaterial(rt.isDerivedMaterial?rt.getDepthMaterial():new MeshDepthMaterial({depthPacking:RGBADepthPacking}),_),Ht.defines.IS_DEPTH_MATERIAL="",Ht.uniforms=this.uniforms),Ht}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let Ht=this._distanceMaterial;return Ht||(Ht=this._distanceMaterial=createDerivedMaterial(rt.isDerivedMaterial?rt.getDistanceMaterial():new MeshDistanceMaterial,_),Ht.defines.IS_DISTANCE_MATERIAL="",Ht.uniforms=this.uniforms),Ht}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:Ht,_distanceMaterial:tr}=this;Ht&&Ht.dispose(),tr&&tr.dispose(),rt.dispose.call(this)}}};return mt[ut]=Mt,new Mt}function upgradeShaders(rt,{vertexShader:_,fragmentShader:ut},mt,bt){let{vertexDefs:St,vertexMainIntro:Mt,vertexMainOutro:Bt,vertexTransform:Ut,fragmentDefs:Ht,fragmentMainIntro:tr,fragmentMainOutro:rr,fragmentColorTransform:sr,customRewriter:ar,timeUniform:cr}=mt;if(St=St||"",Mt=Mt||"",Bt=Bt||"",Ht=Ht||"",tr=tr||"",rr=rr||"",(Ut||ar)&&(_=expandShaderIncludes(_)),(sr||ar)&&(ut=ut.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),ut=expandShaderIncludes(ut)),ar){let Ar=ar({vertexShader:_,fragmentShader:ut});_=Ar.vertexShader,ut=Ar.fragmentShader}if(sr){let Ar=[];ut=ut.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,_r=>(Ar.push(_r),"")),rr=`${sr}
${Ar.join(`
`)}
${rr}`}if(cr){const Ar=`
uniform float ${cr};
`;St=Ar+St,Ht=Ar+Ht}return Ut&&(_=`vec3 troika_position_${bt};
vec3 troika_normal_${bt};
vec2 troika_uv_${bt};
${_}
`,St=`${St}
void troikaVertexTransform${bt}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${Ut}
}
`,Mt=`
troika_position_${bt} = vec3(position);
troika_normal_${bt} = vec3(normal);
troika_uv_${bt} = vec2(uv);
troikaVertexTransform${bt}(troika_position_${bt}, troika_normal_${bt}, troika_uv_${bt});
${Mt}
`,_=_.replace(/\b(position|normal|uv)\b/g,(Ar,_r,Dr,$r)=>/\battribute\s+vec[23]\s+$/.test($r.substr(0,Dr))?_r:`troika_${_r}_${bt}`),rt.map&&rt.map.channel>0||(_=_.replace(/\bMAP_UV\b/g,`troika_uv_${bt}`))),_=injectIntoShaderCode(_,bt,St,Mt,Bt),ut=injectIntoShaderCode(ut,bt,Ht,tr,rr),{vertexShader:_,fragmentShader:ut}}function injectIntoShaderCode(rt,_,ut,mt,bt){return(mt||bt||ut)&&(rt=rt.replace(voidMainRegExp,`
${ut}
void troikaOrigMain${_}() {`),rt+=`
void main() {
  ${mt}
  troikaOrigMain${_}();
  ${bt}
}`),rt}function optionsJsonReplacer(rt,_){return rt==="uniforms"?void 0:typeof _=="function"?_.toString():_}let _idCtr=0;const optionsHashesToIds=new Map;function getKeyForOptions(rt){const _=JSON.stringify(rt,optionsJsonReplacer);let ut=optionsHashesToIds.get(_);return ut==null&&optionsHashesToIds.set(_,ut=++_idCtr),ut}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function typrFactory(){return typeof window>"u"&&(self.window=self),function(rt){var _={parse:function(bt){var St=_._bin,Mt=new Uint8Array(bt);if(St.readASCII(Mt,0,4)=="ttcf"){var Bt=4;St.readUshort(Mt,Bt),Bt+=2,St.readUshort(Mt,Bt),Bt+=2;var Ut=St.readUint(Mt,Bt);Bt+=4;for(var Ht=[],tr=0;tr<Ut;tr++){var rr=St.readUint(Mt,Bt);Bt+=4,Ht.push(_._readFont(Mt,rr))}return Ht}return[_._readFont(Mt,0)]},_readFont:function(bt,St){var Mt=_._bin,Bt=St;Mt.readFixed(bt,St),St+=4;var Ut=Mt.readUshort(bt,St);St+=2,Mt.readUshort(bt,St),St+=2,Mt.readUshort(bt,St),St+=2,Mt.readUshort(bt,St),St+=2;for(var Ht=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],tr={_data:bt,_offset:Bt},rr={},sr=0;sr<Ut;sr++){var ar=Mt.readASCII(bt,St,4);St+=4,Mt.readUint(bt,St),St+=4;var cr=Mt.readUint(bt,St);St+=4;var Ar=Mt.readUint(bt,St);St+=4,rr[ar]={offset:cr,length:Ar}}for(sr=0;sr<Ht.length;sr++){var _r=Ht[sr];rr[_r]&&(tr[_r.trim()]=_[_r.trim()].parse(bt,rr[_r].offset,rr[_r].length,tr))}return tr},_tabOffset:function(bt,St,Mt){for(var Bt=_._bin,Ut=Bt.readUshort(bt,Mt+4),Ht=Mt+12,tr=0;tr<Ut;tr++){var rr=Bt.readASCII(bt,Ht,4);Ht+=4,Bt.readUint(bt,Ht),Ht+=4;var sr=Bt.readUint(bt,Ht);if(Ht+=4,Bt.readUint(bt,Ht),Ht+=4,rr==St)return sr}return 0}};_._bin={readFixed:function(bt,St){return(bt[St]<<8|bt[St+1])+(bt[St+2]<<8|bt[St+3])/65540},readF2dot14:function(bt,St){return _._bin.readShort(bt,St)/16384},readInt:function(bt,St){return _._bin._view(bt).getInt32(St)},readInt8:function(bt,St){return _._bin._view(bt).getInt8(St)},readShort:function(bt,St){return _._bin._view(bt).getInt16(St)},readUshort:function(bt,St){return _._bin._view(bt).getUint16(St)},readUshorts:function(bt,St,Mt){for(var Bt=[],Ut=0;Ut<Mt;Ut++)Bt.push(_._bin.readUshort(bt,St+2*Ut));return Bt},readUint:function(bt,St){return _._bin._view(bt).getUint32(St)},readUint64:function(bt,St){return 4294967296*_._bin.readUint(bt,St)+_._bin.readUint(bt,St+4)},readASCII:function(bt,St,Mt){for(var Bt="",Ut=0;Ut<Mt;Ut++)Bt+=String.fromCharCode(bt[St+Ut]);return Bt},readUnicode:function(bt,St,Mt){for(var Bt="",Ut=0;Ut<Mt;Ut++){var Ht=bt[St++]<<8|bt[St++];Bt+=String.fromCharCode(Ht)}return Bt},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(bt,St,Mt){var Bt=_._bin._tdec;return Bt&&St==0&&Mt==bt.length?Bt.decode(bt):_._bin.readASCII(bt,St,Mt)},readBytes:function(bt,St,Mt){for(var Bt=[],Ut=0;Ut<Mt;Ut++)Bt.push(bt[St+Ut]);return Bt},readASCIIArray:function(bt,St,Mt){for(var Bt=[],Ut=0;Ut<Mt;Ut++)Bt.push(String.fromCharCode(bt[St+Ut]));return Bt},_view:function(bt){return bt._dataView||(bt._dataView=bt.buffer?new DataView(bt.buffer,bt.byteOffset,bt.byteLength):new DataView(new Uint8Array(bt).buffer))}},_._lctf={},_._lctf.parse=function(bt,St,Mt,Bt,Ut){var Ht=_._bin,tr={},rr=St;Ht.readFixed(bt,St),St+=4;var sr=Ht.readUshort(bt,St);St+=2;var ar=Ht.readUshort(bt,St);St+=2;var cr=Ht.readUshort(bt,St);return St+=2,tr.scriptList=_._lctf.readScriptList(bt,rr+sr),tr.featureList=_._lctf.readFeatureList(bt,rr+ar),tr.lookupList=_._lctf.readLookupList(bt,rr+cr,Ut),tr},_._lctf.readLookupList=function(bt,St,Mt){var Bt=_._bin,Ut=St,Ht=[],tr=Bt.readUshort(bt,St);St+=2;for(var rr=0;rr<tr;rr++){var sr=Bt.readUshort(bt,St);St+=2;var ar=_._lctf.readLookupTable(bt,Ut+sr,Mt);Ht.push(ar)}return Ht},_._lctf.readLookupTable=function(bt,St,Mt){var Bt=_._bin,Ut=St,Ht={tabs:[]};Ht.ltype=Bt.readUshort(bt,St),St+=2,Ht.flag=Bt.readUshort(bt,St),St+=2;var tr=Bt.readUshort(bt,St);St+=2;for(var rr=Ht.ltype,sr=0;sr<tr;sr++){var ar=Bt.readUshort(bt,St);St+=2;var cr=Mt(bt,rr,Ut+ar,Ht);Ht.tabs.push(cr)}return Ht},_._lctf.numOfOnes=function(bt){for(var St=0,Mt=0;Mt<32;Mt++)bt>>>Mt&1&&St++;return St},_._lctf.readClassDef=function(bt,St){var Mt=_._bin,Bt=[],Ut=Mt.readUshort(bt,St);if(St+=2,Ut==1){var Ht=Mt.readUshort(bt,St);St+=2;var tr=Mt.readUshort(bt,St);St+=2;for(var rr=0;rr<tr;rr++)Bt.push(Ht+rr),Bt.push(Ht+rr),Bt.push(Mt.readUshort(bt,St)),St+=2}if(Ut==2){var sr=Mt.readUshort(bt,St);for(St+=2,rr=0;rr<sr;rr++)Bt.push(Mt.readUshort(bt,St)),St+=2,Bt.push(Mt.readUshort(bt,St)),St+=2,Bt.push(Mt.readUshort(bt,St)),St+=2}return Bt},_._lctf.getInterval=function(bt,St){for(var Mt=0;Mt<bt.length;Mt+=3){var Bt=bt[Mt],Ut=bt[Mt+1];if(bt[Mt+2],Bt<=St&&St<=Ut)return Mt}return-1},_._lctf.readCoverage=function(bt,St){var Mt=_._bin,Bt={};Bt.fmt=Mt.readUshort(bt,St),St+=2;var Ut=Mt.readUshort(bt,St);return St+=2,Bt.fmt==1&&(Bt.tab=Mt.readUshorts(bt,St,Ut)),Bt.fmt==2&&(Bt.tab=Mt.readUshorts(bt,St,3*Ut)),Bt},_._lctf.coverageIndex=function(bt,St){var Mt=bt.tab;if(bt.fmt==1)return Mt.indexOf(St);if(bt.fmt==2){var Bt=_._lctf.getInterval(Mt,St);if(Bt!=-1)return Mt[Bt+2]+(St-Mt[Bt])}return-1},_._lctf.readFeatureList=function(bt,St){var Mt=_._bin,Bt=St,Ut=[],Ht=Mt.readUshort(bt,St);St+=2;for(var tr=0;tr<Ht;tr++){var rr=Mt.readASCII(bt,St,4);St+=4;var sr=Mt.readUshort(bt,St);St+=2;var ar=_._lctf.readFeatureTable(bt,Bt+sr);ar.tag=rr.trim(),Ut.push(ar)}return Ut},_._lctf.readFeatureTable=function(bt,St){var Mt=_._bin,Bt=St,Ut={},Ht=Mt.readUshort(bt,St);St+=2,Ht>0&&(Ut.featureParams=Bt+Ht);var tr=Mt.readUshort(bt,St);St+=2,Ut.tab=[];for(var rr=0;rr<tr;rr++)Ut.tab.push(Mt.readUshort(bt,St+2*rr));return Ut},_._lctf.readScriptList=function(bt,St){var Mt=_._bin,Bt=St,Ut={},Ht=Mt.readUshort(bt,St);St+=2;for(var tr=0;tr<Ht;tr++){var rr=Mt.readASCII(bt,St,4);St+=4;var sr=Mt.readUshort(bt,St);St+=2,Ut[rr.trim()]=_._lctf.readScriptTable(bt,Bt+sr)}return Ut},_._lctf.readScriptTable=function(bt,St){var Mt=_._bin,Bt=St,Ut={},Ht=Mt.readUshort(bt,St);St+=2,Ht>0&&(Ut.default=_._lctf.readLangSysTable(bt,Bt+Ht));var tr=Mt.readUshort(bt,St);St+=2;for(var rr=0;rr<tr;rr++){var sr=Mt.readASCII(bt,St,4);St+=4;var ar=Mt.readUshort(bt,St);St+=2,Ut[sr.trim()]=_._lctf.readLangSysTable(bt,Bt+ar)}return Ut},_._lctf.readLangSysTable=function(bt,St){var Mt=_._bin,Bt={};Mt.readUshort(bt,St),St+=2,Bt.reqFeature=Mt.readUshort(bt,St),St+=2;var Ut=Mt.readUshort(bt,St);return St+=2,Bt.features=Mt.readUshorts(bt,St,Ut),Bt},_.CFF={},_.CFF.parse=function(bt,St,Mt){var Bt=_._bin;(bt=new Uint8Array(bt.buffer,St,Mt))[St=0],bt[++St],bt[++St],bt[++St],St++;var Ut=[];St=_.CFF.readIndex(bt,St,Ut);for(var Ht=[],tr=0;tr<Ut.length-1;tr++)Ht.push(Bt.readASCII(bt,St+Ut[tr],Ut[tr+1]-Ut[tr]));St+=Ut[Ut.length-1];var rr=[];St=_.CFF.readIndex(bt,St,rr);var sr=[];for(tr=0;tr<rr.length-1;tr++)sr.push(_.CFF.readDict(bt,St+rr[tr],St+rr[tr+1]));St+=rr[rr.length-1];var ar=sr[0],cr=[];St=_.CFF.readIndex(bt,St,cr);var Ar=[];for(tr=0;tr<cr.length-1;tr++)Ar.push(Bt.readASCII(bt,St+cr[tr],cr[tr+1]-cr[tr]));if(St+=cr[cr.length-1],_.CFF.readSubrs(bt,St,ar),ar.CharStrings){St=ar.CharStrings,cr=[],St=_.CFF.readIndex(bt,St,cr);var _r=[];for(tr=0;tr<cr.length-1;tr++)_r.push(Bt.readBytes(bt,St+cr[tr],cr[tr+1]-cr[tr]));ar.CharStrings=_r}if(ar.ROS){St=ar.FDArray;var Dr=[];for(St=_.CFF.readIndex(bt,St,Dr),ar.FDArray=[],tr=0;tr<Dr.length-1;tr++){var $r=_.CFF.readDict(bt,St+Dr[tr],St+Dr[tr+1]);_.CFF._readFDict(bt,$r,Ar),ar.FDArray.push($r)}St+=Dr[Dr.length-1],St=ar.FDSelect,ar.FDSelect=[];var Br=bt[St];if(St++,Br!=3)throw Br;var Jr=Bt.readUshort(bt,St);for(St+=2,tr=0;tr<Jr+1;tr++)ar.FDSelect.push(Bt.readUshort(bt,St),bt[St+2]),St+=3}return ar.Encoding&&(ar.Encoding=_.CFF.readEncoding(bt,ar.Encoding,ar.CharStrings.length)),ar.charset&&(ar.charset=_.CFF.readCharset(bt,ar.charset,ar.CharStrings.length)),_.CFF._readFDict(bt,ar,Ar),ar},_.CFF._readFDict=function(bt,St,Mt){var Bt;for(var Ut in St.Private&&(Bt=St.Private[1],St.Private=_.CFF.readDict(bt,Bt,Bt+St.Private[0]),St.Private.Subrs&&_.CFF.readSubrs(bt,Bt+St.Private.Subrs,St.Private)),St)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(Ut)!=-1&&(St[Ut]=Mt[St[Ut]-426+35])},_.CFF.readSubrs=function(bt,St,Mt){var Bt=_._bin,Ut=[];St=_.CFF.readIndex(bt,St,Ut);var Ht,tr=Ut.length;Ht=tr<1240?107:tr<33900?1131:32768,Mt.Bias=Ht,Mt.Subrs=[];for(var rr=0;rr<Ut.length-1;rr++)Mt.Subrs.push(Bt.readBytes(bt,St+Ut[rr],Ut[rr+1]-Ut[rr]))},_.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],_.CFF.glyphByUnicode=function(bt,St){for(var Mt=0;Mt<bt.charset.length;Mt++)if(bt.charset[Mt]==St)return Mt;return-1},_.CFF.glyphBySE=function(bt,St){return St<0||St>255?-1:_.CFF.glyphByUnicode(bt,_.CFF.tableSE[St])},_.CFF.readEncoding=function(bt,St,Mt){_._bin;var Bt=[".notdef"],Ut=bt[St];if(St++,Ut!=0)throw"error: unknown encoding format: "+Ut;var Ht=bt[St];St++;for(var tr=0;tr<Ht;tr++)Bt.push(bt[St+tr]);return Bt},_.CFF.readCharset=function(bt,St,Mt){var Bt=_._bin,Ut=[".notdef"],Ht=bt[St];if(St++,Ht==0)for(var tr=0;tr<Mt;tr++){var rr=Bt.readUshort(bt,St);St+=2,Ut.push(rr)}else{if(Ht!=1&&Ht!=2)throw"error: format: "+Ht;for(;Ut.length<Mt;){rr=Bt.readUshort(bt,St),St+=2;var sr=0;for(Ht==1?(sr=bt[St],St++):(sr=Bt.readUshort(bt,St),St+=2),tr=0;tr<=sr;tr++)Ut.push(rr),rr++}}return Ut},_.CFF.readIndex=function(bt,St,Mt){var Bt=_._bin,Ut=Bt.readUshort(bt,St)+1,Ht=bt[St+=2];if(St++,Ht==1)for(var tr=0;tr<Ut;tr++)Mt.push(bt[St+tr]);else if(Ht==2)for(tr=0;tr<Ut;tr++)Mt.push(Bt.readUshort(bt,St+2*tr));else if(Ht==3)for(tr=0;tr<Ut;tr++)Mt.push(16777215&Bt.readUint(bt,St+3*tr-1));else if(Ut!=1)throw"unsupported offset size: "+Ht+", count: "+Ut;return(St+=Ut*Ht)-1},_.CFF.getCharString=function(bt,St,Mt){var Bt=_._bin,Ut=bt[St],Ht=bt[St+1];bt[St+2],bt[St+3],bt[St+4];var tr=1,rr=null,sr=null;Ut<=20&&(rr=Ut,tr=1),Ut==12&&(rr=100*Ut+Ht,tr=2),21<=Ut&&Ut<=27&&(rr=Ut,tr=1),Ut==28&&(sr=Bt.readShort(bt,St+1),tr=3),29<=Ut&&Ut<=31&&(rr=Ut,tr=1),32<=Ut&&Ut<=246&&(sr=Ut-139,tr=1),247<=Ut&&Ut<=250&&(sr=256*(Ut-247)+Ht+108,tr=2),251<=Ut&&Ut<=254&&(sr=256*-(Ut-251)-Ht-108,tr=2),Ut==255&&(sr=Bt.readInt(bt,St+1)/65535,tr=5),Mt.val=sr??"o"+rr,Mt.size=tr},_.CFF.readCharString=function(bt,St,Mt){for(var Bt=St+Mt,Ut=_._bin,Ht=[];St<Bt;){var tr=bt[St],rr=bt[St+1];bt[St+2],bt[St+3],bt[St+4];var sr=1,ar=null,cr=null;tr<=20&&(ar=tr,sr=1),tr==12&&(ar=100*tr+rr,sr=2),tr!=19&&tr!=20||(ar=tr,sr=2),21<=tr&&tr<=27&&(ar=tr,sr=1),tr==28&&(cr=Ut.readShort(bt,St+1),sr=3),29<=tr&&tr<=31&&(ar=tr,sr=1),32<=tr&&tr<=246&&(cr=tr-139,sr=1),247<=tr&&tr<=250&&(cr=256*(tr-247)+rr+108,sr=2),251<=tr&&tr<=254&&(cr=256*-(tr-251)-rr-108,sr=2),tr==255&&(cr=Ut.readInt(bt,St+1)/65535,sr=5),Ht.push(cr??"o"+ar),St+=sr}return Ht},_.CFF.readDict=function(bt,St,Mt){for(var Bt=_._bin,Ut={},Ht=[];St<Mt;){var tr=bt[St],rr=bt[St+1];bt[St+2],bt[St+3],bt[St+4];var sr=1,ar=null,cr=null;if(tr==28&&(cr=Bt.readShort(bt,St+1),sr=3),tr==29&&(cr=Bt.readInt(bt,St+1),sr=5),32<=tr&&tr<=246&&(cr=tr-139,sr=1),247<=tr&&tr<=250&&(cr=256*(tr-247)+rr+108,sr=2),251<=tr&&tr<=254&&(cr=256*-(tr-251)-rr-108,sr=2),tr==255)throw cr=Bt.readInt(bt,St+1)/65535,sr=5,"unknown number";if(tr==30){var Ar=[];for(sr=1;;){var _r=bt[St+sr];sr++;var Dr=_r>>4,$r=15&_r;if(Dr!=15&&Ar.push(Dr),$r!=15&&Ar.push($r),$r==15)break}for(var Br="",Jr=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],mn=0;mn<Ar.length;mn++)Br+=Jr[Ar[mn]];cr=parseFloat(Br)}tr<=21&&(ar=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][tr],sr=1,tr==12&&(ar=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][rr],sr=2)),ar!=null?(Ut[ar]=Ht.length==1?Ht[0]:Ht,Ht=[]):Ht.push(cr),St+=sr}return Ut},_.cmap={},_.cmap.parse=function(bt,St,Mt){bt=new Uint8Array(bt.buffer,St,Mt),St=0;var Bt=_._bin,Ut={};Bt.readUshort(bt,St),St+=2;var Ht=Bt.readUshort(bt,St);St+=2;var tr=[];Ut.tables=[];for(var rr=0;rr<Ht;rr++){var sr=Bt.readUshort(bt,St);St+=2;var ar=Bt.readUshort(bt,St);St+=2;var cr=Bt.readUint(bt,St);St+=4;var Ar="p"+sr+"e"+ar,_r=tr.indexOf(cr);if(_r==-1){var Dr;_r=Ut.tables.length,tr.push(cr);var $r=Bt.readUshort(bt,cr);$r==0?Dr=_.cmap.parse0(bt,cr):$r==4?Dr=_.cmap.parse4(bt,cr):$r==6?Dr=_.cmap.parse6(bt,cr):$r==12?Dr=_.cmap.parse12(bt,cr):console.debug("unknown format: "+$r,sr,ar,cr),Ut.tables.push(Dr)}if(Ut[Ar]!=null)throw"multiple tables for one platform+encoding";Ut[Ar]=_r}return Ut},_.cmap.parse0=function(bt,St){var Mt=_._bin,Bt={};Bt.format=Mt.readUshort(bt,St),St+=2;var Ut=Mt.readUshort(bt,St);St+=2,Mt.readUshort(bt,St),St+=2,Bt.map=[];for(var Ht=0;Ht<Ut-6;Ht++)Bt.map.push(bt[St+Ht]);return Bt},_.cmap.parse4=function(bt,St){var Mt=_._bin,Bt=St,Ut={};Ut.format=Mt.readUshort(bt,St),St+=2;var Ht=Mt.readUshort(bt,St);St+=2,Mt.readUshort(bt,St),St+=2;var tr=Mt.readUshort(bt,St);St+=2;var rr=tr/2;Ut.searchRange=Mt.readUshort(bt,St),St+=2,Ut.entrySelector=Mt.readUshort(bt,St),St+=2,Ut.rangeShift=Mt.readUshort(bt,St),St+=2,Ut.endCount=Mt.readUshorts(bt,St,rr),St+=2*rr,St+=2,Ut.startCount=Mt.readUshorts(bt,St,rr),St+=2*rr,Ut.idDelta=[];for(var sr=0;sr<rr;sr++)Ut.idDelta.push(Mt.readShort(bt,St)),St+=2;for(Ut.idRangeOffset=Mt.readUshorts(bt,St,rr),St+=2*rr,Ut.glyphIdArray=[];St<Bt+Ht;)Ut.glyphIdArray.push(Mt.readUshort(bt,St)),St+=2;return Ut},_.cmap.parse6=function(bt,St){var Mt=_._bin,Bt={};Bt.format=Mt.readUshort(bt,St),St+=2,Mt.readUshort(bt,St),St+=2,Mt.readUshort(bt,St),St+=2,Bt.firstCode=Mt.readUshort(bt,St),St+=2;var Ut=Mt.readUshort(bt,St);St+=2,Bt.glyphIdArray=[];for(var Ht=0;Ht<Ut;Ht++)Bt.glyphIdArray.push(Mt.readUshort(bt,St)),St+=2;return Bt},_.cmap.parse12=function(bt,St){var Mt=_._bin,Bt={};Bt.format=Mt.readUshort(bt,St),St+=2,St+=2,Mt.readUint(bt,St),St+=4,Mt.readUint(bt,St),St+=4;var Ut=Mt.readUint(bt,St);St+=4,Bt.groups=[];for(var Ht=0;Ht<Ut;Ht++){var tr=St+12*Ht,rr=Mt.readUint(bt,tr+0),sr=Mt.readUint(bt,tr+4),ar=Mt.readUint(bt,tr+8);Bt.groups.push([rr,sr,ar])}return Bt},_.glyf={},_.glyf.parse=function(bt,St,Mt,Bt){for(var Ut=[],Ht=0;Ht<Bt.maxp.numGlyphs;Ht++)Ut.push(null);return Ut},_.glyf._parseGlyf=function(bt,St){var Mt=_._bin,Bt=bt._data,Ut=_._tabOffset(Bt,"glyf",bt._offset)+bt.loca[St];if(bt.loca[St]==bt.loca[St+1])return null;var Ht={};if(Ht.noc=Mt.readShort(Bt,Ut),Ut+=2,Ht.xMin=Mt.readShort(Bt,Ut),Ut+=2,Ht.yMin=Mt.readShort(Bt,Ut),Ut+=2,Ht.xMax=Mt.readShort(Bt,Ut),Ut+=2,Ht.yMax=Mt.readShort(Bt,Ut),Ut+=2,Ht.xMin>=Ht.xMax||Ht.yMin>=Ht.yMax)return null;if(Ht.noc>0){Ht.endPts=[];for(var tr=0;tr<Ht.noc;tr++)Ht.endPts.push(Mt.readUshort(Bt,Ut)),Ut+=2;var rr=Mt.readUshort(Bt,Ut);if(Ut+=2,Bt.length-Ut<rr)return null;Ht.instructions=Mt.readBytes(Bt,Ut,rr),Ut+=rr;var sr=Ht.endPts[Ht.noc-1]+1;for(Ht.flags=[],tr=0;tr<sr;tr++){var ar=Bt[Ut];if(Ut++,Ht.flags.push(ar),(8&ar)!=0){var cr=Bt[Ut];Ut++;for(var Ar=0;Ar<cr;Ar++)Ht.flags.push(ar),tr++}}for(Ht.xs=[],tr=0;tr<sr;tr++){var _r=(2&Ht.flags[tr])!=0,Dr=(16&Ht.flags[tr])!=0;_r?(Ht.xs.push(Dr?Bt[Ut]:-Bt[Ut]),Ut++):Dr?Ht.xs.push(0):(Ht.xs.push(Mt.readShort(Bt,Ut)),Ut+=2)}for(Ht.ys=[],tr=0;tr<sr;tr++)_r=(4&Ht.flags[tr])!=0,Dr=(32&Ht.flags[tr])!=0,_r?(Ht.ys.push(Dr?Bt[Ut]:-Bt[Ut]),Ut++):Dr?Ht.ys.push(0):(Ht.ys.push(Mt.readShort(Bt,Ut)),Ut+=2);var $r=0,Br=0;for(tr=0;tr<sr;tr++)$r+=Ht.xs[tr],Br+=Ht.ys[tr],Ht.xs[tr]=$r,Ht.ys[tr]=Br}else{var Jr;Ht.parts=[];do{Jr=Mt.readUshort(Bt,Ut),Ut+=2;var mn={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(Ht.parts.push(mn),mn.glyphIndex=Mt.readUshort(Bt,Ut),Ut+=2,1&Jr){var Mn=Mt.readShort(Bt,Ut);Ut+=2;var $n=Mt.readShort(Bt,Ut);Ut+=2}else Mn=Mt.readInt8(Bt,Ut),Ut++,$n=Mt.readInt8(Bt,Ut),Ut++;2&Jr?(mn.m.tx=Mn,mn.m.ty=$n):(mn.p1=Mn,mn.p2=$n),8&Jr?(mn.m.a=mn.m.d=Mt.readF2dot14(Bt,Ut),Ut+=2):64&Jr?(mn.m.a=Mt.readF2dot14(Bt,Ut),Ut+=2,mn.m.d=Mt.readF2dot14(Bt,Ut),Ut+=2):128&Jr&&(mn.m.a=Mt.readF2dot14(Bt,Ut),Ut+=2,mn.m.b=Mt.readF2dot14(Bt,Ut),Ut+=2,mn.m.c=Mt.readF2dot14(Bt,Ut),Ut+=2,mn.m.d=Mt.readF2dot14(Bt,Ut),Ut+=2)}while(32&Jr);if(256&Jr){var en=Mt.readUshort(Bt,Ut);for(Ut+=2,Ht.instr=[],tr=0;tr<en;tr++)Ht.instr.push(Bt[Ut]),Ut++}}return Ht},_.GDEF={},_.GDEF.parse=function(bt,St,Mt,Bt){var Ut=St;St+=4;var Ht=_._bin.readUshort(bt,St);return{glyphClassDef:Ht===0?null:_._lctf.readClassDef(bt,Ut+Ht)}},_.GPOS={},_.GPOS.parse=function(bt,St,Mt,Bt){return _._lctf.parse(bt,St,Mt,Bt,_.GPOS.subt)},_.GPOS.subt=function(bt,St,Mt,Bt){var Ut=_._bin,Ht=Mt,tr={};if(tr.fmt=Ut.readUshort(bt,Mt),Mt+=2,St==1||St==2||St==3||St==7||St==8&&tr.fmt<=2){var rr=Ut.readUshort(bt,Mt);Mt+=2,tr.coverage=_._lctf.readCoverage(bt,rr+Ht)}if(St==1&&tr.fmt==1){var sr=Ut.readUshort(bt,Mt);Mt+=2,sr!=0&&(tr.pos=_.GPOS.readValueRecord(bt,Mt,sr))}else if(St==2&&tr.fmt>=1&&tr.fmt<=2){sr=Ut.readUshort(bt,Mt),Mt+=2;var ar=Ut.readUshort(bt,Mt);Mt+=2;var cr=_._lctf.numOfOnes(sr),Ar=_._lctf.numOfOnes(ar);if(tr.fmt==1){tr.pairsets=[];var _r=Ut.readUshort(bt,Mt);Mt+=2;for(var Dr=0;Dr<_r;Dr++){var $r=Ht+Ut.readUshort(bt,Mt);Mt+=2;var Br=Ut.readUshort(bt,$r);$r+=2;for(var Jr=[],mn=0;mn<Br;mn++){var Mn=Ut.readUshort(bt,$r);$r+=2,sr!=0&&(Qn=_.GPOS.readValueRecord(bt,$r,sr),$r+=2*cr),ar!=0&&(xs=_.GPOS.readValueRecord(bt,$r,ar),$r+=2*Ar),Jr.push({gid2:Mn,val1:Qn,val2:xs})}tr.pairsets.push(Jr)}}if(tr.fmt==2){var $n=Ut.readUshort(bt,Mt);Mt+=2;var en=Ut.readUshort(bt,Mt);Mt+=2;var In=Ut.readUshort(bt,Mt);Mt+=2;var Rn=Ut.readUshort(bt,Mt);for(Mt+=2,tr.classDef1=_._lctf.readClassDef(bt,Ht+$n),tr.classDef2=_._lctf.readClassDef(bt,Ht+en),tr.matrix=[],Dr=0;Dr<In;Dr++){var qn=[];for(mn=0;mn<Rn;mn++){var Qn=null,xs=null;sr!=0&&(Qn=_.GPOS.readValueRecord(bt,Mt,sr),Mt+=2*cr),ar!=0&&(xs=_.GPOS.readValueRecord(bt,Mt,ar),Mt+=2*Ar),qn.push({val1:Qn,val2:xs})}tr.matrix.push(qn)}}}else if(St==4&&tr.fmt==1)tr.markCoverage=_._lctf.readCoverage(bt,Ut.readUshort(bt,Mt)+Ht),tr.baseCoverage=_._lctf.readCoverage(bt,Ut.readUshort(bt,Mt+2)+Ht),tr.markClassCount=Ut.readUshort(bt,Mt+4),tr.markArray=_.GPOS.readMarkArray(bt,Ut.readUshort(bt,Mt+6)+Ht),tr.baseArray=_.GPOS.readBaseArray(bt,Ut.readUshort(bt,Mt+8)+Ht,tr.markClassCount);else if(St==6&&tr.fmt==1)tr.mark1Coverage=_._lctf.readCoverage(bt,Ut.readUshort(bt,Mt)+Ht),tr.mark2Coverage=_._lctf.readCoverage(bt,Ut.readUshort(bt,Mt+2)+Ht),tr.markClassCount=Ut.readUshort(bt,Mt+4),tr.mark1Array=_.GPOS.readMarkArray(bt,Ut.readUshort(bt,Mt+6)+Ht),tr.mark2Array=_.GPOS.readBaseArray(bt,Ut.readUshort(bt,Mt+8)+Ht,tr.markClassCount);else{if(St==9&&tr.fmt==1){var cs=Ut.readUshort(bt,Mt);Mt+=2;var ks=Ut.readUint(bt,Mt);if(Mt+=4,Bt.ltype==9)Bt.ltype=cs;else if(Bt.ltype!=cs)throw"invalid extension substitution";return _.GPOS.subt(bt,Bt.ltype,Ht+ks)}console.debug("unsupported GPOS table LookupType",St,"format",tr.fmt)}return tr},_.GPOS.readValueRecord=function(bt,St,Mt){var Bt=_._bin,Ut=[];return Ut.push(1&Mt?Bt.readShort(bt,St):0),St+=1&Mt?2:0,Ut.push(2&Mt?Bt.readShort(bt,St):0),St+=2&Mt?2:0,Ut.push(4&Mt?Bt.readShort(bt,St):0),St+=4&Mt?2:0,Ut.push(8&Mt?Bt.readShort(bt,St):0),St+=8&Mt?2:0,Ut},_.GPOS.readBaseArray=function(bt,St,Mt){var Bt=_._bin,Ut=[],Ht=St,tr=Bt.readUshort(bt,St);St+=2;for(var rr=0;rr<tr;rr++){for(var sr=[],ar=0;ar<Mt;ar++)sr.push(_.GPOS.readAnchorRecord(bt,Ht+Bt.readUshort(bt,St))),St+=2;Ut.push(sr)}return Ut},_.GPOS.readMarkArray=function(bt,St){var Mt=_._bin,Bt=[],Ut=St,Ht=Mt.readUshort(bt,St);St+=2;for(var tr=0;tr<Ht;tr++){var rr=_.GPOS.readAnchorRecord(bt,Mt.readUshort(bt,St+2)+Ut);rr.markClass=Mt.readUshort(bt,St),Bt.push(rr),St+=4}return Bt},_.GPOS.readAnchorRecord=function(bt,St){var Mt=_._bin,Bt={};return Bt.fmt=Mt.readUshort(bt,St),Bt.x=Mt.readShort(bt,St+2),Bt.y=Mt.readShort(bt,St+4),Bt},_.GSUB={},_.GSUB.parse=function(bt,St,Mt,Bt){return _._lctf.parse(bt,St,Mt,Bt,_.GSUB.subt)},_.GSUB.subt=function(bt,St,Mt,Bt){var Ut=_._bin,Ht=Mt,tr={};if(tr.fmt=Ut.readUshort(bt,Mt),Mt+=2,St!=1&&St!=2&&St!=4&&St!=5&&St!=6)return null;if(St==1||St==2||St==4||St==5&&tr.fmt<=2||St==6&&tr.fmt<=2){var rr=Ut.readUshort(bt,Mt);Mt+=2,tr.coverage=_._lctf.readCoverage(bt,Ht+rr)}if(St==1&&tr.fmt>=1&&tr.fmt<=2){if(tr.fmt==1)tr.delta=Ut.readShort(bt,Mt),Mt+=2;else if(tr.fmt==2){var sr=Ut.readUshort(bt,Mt);Mt+=2,tr.newg=Ut.readUshorts(bt,Mt,sr),Mt+=2*tr.newg.length}}else if(St==2&&tr.fmt==1){sr=Ut.readUshort(bt,Mt),Mt+=2,tr.seqs=[];for(var ar=0;ar<sr;ar++){var cr=Ut.readUshort(bt,Mt)+Ht;Mt+=2;var Ar=Ut.readUshort(bt,cr);tr.seqs.push(Ut.readUshorts(bt,cr+2,Ar))}}else if(St==4)for(tr.vals=[],sr=Ut.readUshort(bt,Mt),Mt+=2,ar=0;ar<sr;ar++){var _r=Ut.readUshort(bt,Mt);Mt+=2,tr.vals.push(_.GSUB.readLigatureSet(bt,Ht+_r))}else if(St==5&&tr.fmt==2){if(tr.fmt==2){var Dr=Ut.readUshort(bt,Mt);Mt+=2,tr.cDef=_._lctf.readClassDef(bt,Ht+Dr),tr.scset=[];var $r=Ut.readUshort(bt,Mt);for(Mt+=2,ar=0;ar<$r;ar++){var Br=Ut.readUshort(bt,Mt);Mt+=2,tr.scset.push(Br==0?null:_.GSUB.readSubClassSet(bt,Ht+Br))}}}else if(St==6&&tr.fmt==3){if(tr.fmt==3){for(ar=0;ar<3;ar++){sr=Ut.readUshort(bt,Mt),Mt+=2;for(var Jr=[],mn=0;mn<sr;mn++)Jr.push(_._lctf.readCoverage(bt,Ht+Ut.readUshort(bt,Mt+2*mn)));Mt+=2*sr,ar==0&&(tr.backCvg=Jr),ar==1&&(tr.inptCvg=Jr),ar==2&&(tr.ahedCvg=Jr)}sr=Ut.readUshort(bt,Mt),Mt+=2,tr.lookupRec=_.GSUB.readSubstLookupRecords(bt,Mt,sr)}}else{if(St==7&&tr.fmt==1){var Mn=Ut.readUshort(bt,Mt);Mt+=2;var $n=Ut.readUint(bt,Mt);if(Mt+=4,Bt.ltype==9)Bt.ltype=Mn;else if(Bt.ltype!=Mn)throw"invalid extension substitution";return _.GSUB.subt(bt,Bt.ltype,Ht+$n)}console.debug("unsupported GSUB table LookupType",St,"format",tr.fmt)}return tr},_.GSUB.readSubClassSet=function(bt,St){var Mt=_._bin.readUshort,Bt=St,Ut=[],Ht=Mt(bt,St);St+=2;for(var tr=0;tr<Ht;tr++){var rr=Mt(bt,St);St+=2,Ut.push(_.GSUB.readSubClassRule(bt,Bt+rr))}return Ut},_.GSUB.readSubClassRule=function(bt,St){var Mt=_._bin.readUshort,Bt={},Ut=Mt(bt,St),Ht=Mt(bt,St+=2);St+=2,Bt.input=[];for(var tr=0;tr<Ut-1;tr++)Bt.input.push(Mt(bt,St)),St+=2;return Bt.substLookupRecords=_.GSUB.readSubstLookupRecords(bt,St,Ht),Bt},_.GSUB.readSubstLookupRecords=function(bt,St,Mt){for(var Bt=_._bin.readUshort,Ut=[],Ht=0;Ht<Mt;Ht++)Ut.push(Bt(bt,St),Bt(bt,St+2)),St+=4;return Ut},_.GSUB.readChainSubClassSet=function(bt,St){var Mt=_._bin,Bt=St,Ut=[],Ht=Mt.readUshort(bt,St);St+=2;for(var tr=0;tr<Ht;tr++){var rr=Mt.readUshort(bt,St);St+=2,Ut.push(_.GSUB.readChainSubClassRule(bt,Bt+rr))}return Ut},_.GSUB.readChainSubClassRule=function(bt,St){for(var Mt=_._bin,Bt={},Ut=["backtrack","input","lookahead"],Ht=0;Ht<Ut.length;Ht++){var tr=Mt.readUshort(bt,St);St+=2,Ht==1&&tr--,Bt[Ut[Ht]]=Mt.readUshorts(bt,St,tr),St+=2*Bt[Ut[Ht]].length}return tr=Mt.readUshort(bt,St),St+=2,Bt.subst=Mt.readUshorts(bt,St,2*tr),St+=2*Bt.subst.length,Bt},_.GSUB.readLigatureSet=function(bt,St){var Mt=_._bin,Bt=St,Ut=[],Ht=Mt.readUshort(bt,St);St+=2;for(var tr=0;tr<Ht;tr++){var rr=Mt.readUshort(bt,St);St+=2,Ut.push(_.GSUB.readLigature(bt,Bt+rr))}return Ut},_.GSUB.readLigature=function(bt,St){var Mt=_._bin,Bt={chain:[]};Bt.nglyph=Mt.readUshort(bt,St),St+=2;var Ut=Mt.readUshort(bt,St);St+=2;for(var Ht=0;Ht<Ut-1;Ht++)Bt.chain.push(Mt.readUshort(bt,St)),St+=2;return Bt},_.head={},_.head.parse=function(bt,St,Mt){var Bt=_._bin,Ut={};return Bt.readFixed(bt,St),St+=4,Ut.fontRevision=Bt.readFixed(bt,St),St+=4,Bt.readUint(bt,St),St+=4,Bt.readUint(bt,St),St+=4,Ut.flags=Bt.readUshort(bt,St),St+=2,Ut.unitsPerEm=Bt.readUshort(bt,St),St+=2,Ut.created=Bt.readUint64(bt,St),St+=8,Ut.modified=Bt.readUint64(bt,St),St+=8,Ut.xMin=Bt.readShort(bt,St),St+=2,Ut.yMin=Bt.readShort(bt,St),St+=2,Ut.xMax=Bt.readShort(bt,St),St+=2,Ut.yMax=Bt.readShort(bt,St),St+=2,Ut.macStyle=Bt.readUshort(bt,St),St+=2,Ut.lowestRecPPEM=Bt.readUshort(bt,St),St+=2,Ut.fontDirectionHint=Bt.readShort(bt,St),St+=2,Ut.indexToLocFormat=Bt.readShort(bt,St),St+=2,Ut.glyphDataFormat=Bt.readShort(bt,St),St+=2,Ut},_.hhea={},_.hhea.parse=function(bt,St,Mt){var Bt=_._bin,Ut={};return Bt.readFixed(bt,St),St+=4,Ut.ascender=Bt.readShort(bt,St),St+=2,Ut.descender=Bt.readShort(bt,St),St+=2,Ut.lineGap=Bt.readShort(bt,St),St+=2,Ut.advanceWidthMax=Bt.readUshort(bt,St),St+=2,Ut.minLeftSideBearing=Bt.readShort(bt,St),St+=2,Ut.minRightSideBearing=Bt.readShort(bt,St),St+=2,Ut.xMaxExtent=Bt.readShort(bt,St),St+=2,Ut.caretSlopeRise=Bt.readShort(bt,St),St+=2,Ut.caretSlopeRun=Bt.readShort(bt,St),St+=2,Ut.caretOffset=Bt.readShort(bt,St),St+=2,St+=8,Ut.metricDataFormat=Bt.readShort(bt,St),St+=2,Ut.numberOfHMetrics=Bt.readUshort(bt,St),St+=2,Ut},_.hmtx={},_.hmtx.parse=function(bt,St,Mt,Bt){for(var Ut=_._bin,Ht={aWidth:[],lsBearing:[]},tr=0,rr=0,sr=0;sr<Bt.maxp.numGlyphs;sr++)sr<Bt.hhea.numberOfHMetrics&&(tr=Ut.readUshort(bt,St),St+=2,rr=Ut.readShort(bt,St),St+=2),Ht.aWidth.push(tr),Ht.lsBearing.push(rr);return Ht},_.kern={},_.kern.parse=function(bt,St,Mt,Bt){var Ut=_._bin,Ht=Ut.readUshort(bt,St);if(St+=2,Ht==1)return _.kern.parseV1(bt,St-2,Mt,Bt);var tr=Ut.readUshort(bt,St);St+=2;for(var rr={glyph1:[],rval:[]},sr=0;sr<tr;sr++){St+=2,Mt=Ut.readUshort(bt,St),St+=2;var ar=Ut.readUshort(bt,St);St+=2;var cr=ar>>>8;if((cr&=15)!=0)throw"unknown kern table format: "+cr;St=_.kern.readFormat0(bt,St,rr)}return rr},_.kern.parseV1=function(bt,St,Mt,Bt){var Ut=_._bin;Ut.readFixed(bt,St),St+=4;var Ht=Ut.readUint(bt,St);St+=4;for(var tr={glyph1:[],rval:[]},rr=0;rr<Ht;rr++){Ut.readUint(bt,St),St+=4;var sr=Ut.readUshort(bt,St);St+=2,Ut.readUshort(bt,St),St+=2;var ar=sr>>>8;if((ar&=15)!=0)throw"unknown kern table format: "+ar;St=_.kern.readFormat0(bt,St,tr)}return tr},_.kern.readFormat0=function(bt,St,Mt){var Bt=_._bin,Ut=-1,Ht=Bt.readUshort(bt,St);St+=2,Bt.readUshort(bt,St),St+=2,Bt.readUshort(bt,St),St+=2,Bt.readUshort(bt,St),St+=2;for(var tr=0;tr<Ht;tr++){var rr=Bt.readUshort(bt,St);St+=2;var sr=Bt.readUshort(bt,St);St+=2;var ar=Bt.readShort(bt,St);St+=2,rr!=Ut&&(Mt.glyph1.push(rr),Mt.rval.push({glyph2:[],vals:[]}));var cr=Mt.rval[Mt.rval.length-1];cr.glyph2.push(sr),cr.vals.push(ar),Ut=rr}return St},_.loca={},_.loca.parse=function(bt,St,Mt,Bt){var Ut=_._bin,Ht=[],tr=Bt.head.indexToLocFormat,rr=Bt.maxp.numGlyphs+1;if(tr==0)for(var sr=0;sr<rr;sr++)Ht.push(Ut.readUshort(bt,St+(sr<<1))<<1);if(tr==1)for(sr=0;sr<rr;sr++)Ht.push(Ut.readUint(bt,St+(sr<<2)));return Ht},_.maxp={},_.maxp.parse=function(bt,St,Mt){var Bt=_._bin,Ut={},Ht=Bt.readUint(bt,St);return St+=4,Ut.numGlyphs=Bt.readUshort(bt,St),St+=2,Ht==65536&&(Ut.maxPoints=Bt.readUshort(bt,St),St+=2,Ut.maxContours=Bt.readUshort(bt,St),St+=2,Ut.maxCompositePoints=Bt.readUshort(bt,St),St+=2,Ut.maxCompositeContours=Bt.readUshort(bt,St),St+=2,Ut.maxZones=Bt.readUshort(bt,St),St+=2,Ut.maxTwilightPoints=Bt.readUshort(bt,St),St+=2,Ut.maxStorage=Bt.readUshort(bt,St),St+=2,Ut.maxFunctionDefs=Bt.readUshort(bt,St),St+=2,Ut.maxInstructionDefs=Bt.readUshort(bt,St),St+=2,Ut.maxStackElements=Bt.readUshort(bt,St),St+=2,Ut.maxSizeOfInstructions=Bt.readUshort(bt,St),St+=2,Ut.maxComponentElements=Bt.readUshort(bt,St),St+=2,Ut.maxComponentDepth=Bt.readUshort(bt,St),St+=2),Ut},_.name={},_.name.parse=function(bt,St,Mt){var Bt=_._bin,Ut={};Bt.readUshort(bt,St),St+=2;var Ht=Bt.readUshort(bt,St);St+=2,Bt.readUshort(bt,St);for(var tr,rr=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],sr=St+=2,ar=0;ar<Ht;ar++){var cr=Bt.readUshort(bt,St);St+=2;var Ar=Bt.readUshort(bt,St);St+=2;var _r=Bt.readUshort(bt,St);St+=2;var Dr=Bt.readUshort(bt,St);St+=2;var $r=Bt.readUshort(bt,St);St+=2;var Br=Bt.readUshort(bt,St);St+=2;var Jr,mn=rr[Dr],Mn=sr+12*Ht+Br;if(cr==0)Jr=Bt.readUnicode(bt,Mn,$r/2);else if(cr==3&&Ar==0)Jr=Bt.readUnicode(bt,Mn,$r/2);else if(Ar==0)Jr=Bt.readASCII(bt,Mn,$r);else if(Ar==1)Jr=Bt.readUnicode(bt,Mn,$r/2);else if(Ar==3)Jr=Bt.readUnicode(bt,Mn,$r/2);else{if(cr!=1)throw"unknown encoding "+Ar+", platformID: "+cr;Jr=Bt.readASCII(bt,Mn,$r),console.debug("reading unknown MAC encoding "+Ar+" as ASCII")}var $n="p"+cr+","+_r.toString(16);Ut[$n]==null&&(Ut[$n]={}),Ut[$n][mn!==void 0?mn:Dr]=Jr,Ut[$n]._lang=_r}for(var en in Ut)if(Ut[en].postScriptName!=null&&Ut[en]._lang==1033)return Ut[en];for(var en in Ut)if(Ut[en].postScriptName!=null&&Ut[en]._lang==0)return Ut[en];for(var en in Ut)if(Ut[en].postScriptName!=null&&Ut[en]._lang==3084)return Ut[en];for(var en in Ut)if(Ut[en].postScriptName!=null)return Ut[en];for(var en in Ut){tr=en;break}return console.debug("returning name table with languageID "+Ut[tr]._lang),Ut[tr]},_["OS/2"]={},_["OS/2"].parse=function(bt,St,Mt){var Bt=_._bin.readUshort(bt,St);St+=2;var Ut={};if(Bt==0)_["OS/2"].version0(bt,St,Ut);else if(Bt==1)_["OS/2"].version1(bt,St,Ut);else if(Bt==2||Bt==3||Bt==4)_["OS/2"].version2(bt,St,Ut);else{if(Bt!=5)throw"unknown OS/2 table version: "+Bt;_["OS/2"].version5(bt,St,Ut)}return Ut},_["OS/2"].version0=function(bt,St,Mt){var Bt=_._bin;return Mt.xAvgCharWidth=Bt.readShort(bt,St),St+=2,Mt.usWeightClass=Bt.readUshort(bt,St),St+=2,Mt.usWidthClass=Bt.readUshort(bt,St),St+=2,Mt.fsType=Bt.readUshort(bt,St),St+=2,Mt.ySubscriptXSize=Bt.readShort(bt,St),St+=2,Mt.ySubscriptYSize=Bt.readShort(bt,St),St+=2,Mt.ySubscriptXOffset=Bt.readShort(bt,St),St+=2,Mt.ySubscriptYOffset=Bt.readShort(bt,St),St+=2,Mt.ySuperscriptXSize=Bt.readShort(bt,St),St+=2,Mt.ySuperscriptYSize=Bt.readShort(bt,St),St+=2,Mt.ySuperscriptXOffset=Bt.readShort(bt,St),St+=2,Mt.ySuperscriptYOffset=Bt.readShort(bt,St),St+=2,Mt.yStrikeoutSize=Bt.readShort(bt,St),St+=2,Mt.yStrikeoutPosition=Bt.readShort(bt,St),St+=2,Mt.sFamilyClass=Bt.readShort(bt,St),St+=2,Mt.panose=Bt.readBytes(bt,St,10),St+=10,Mt.ulUnicodeRange1=Bt.readUint(bt,St),St+=4,Mt.ulUnicodeRange2=Bt.readUint(bt,St),St+=4,Mt.ulUnicodeRange3=Bt.readUint(bt,St),St+=4,Mt.ulUnicodeRange4=Bt.readUint(bt,St),St+=4,Mt.achVendID=[Bt.readInt8(bt,St),Bt.readInt8(bt,St+1),Bt.readInt8(bt,St+2),Bt.readInt8(bt,St+3)],St+=4,Mt.fsSelection=Bt.readUshort(bt,St),St+=2,Mt.usFirstCharIndex=Bt.readUshort(bt,St),St+=2,Mt.usLastCharIndex=Bt.readUshort(bt,St),St+=2,Mt.sTypoAscender=Bt.readShort(bt,St),St+=2,Mt.sTypoDescender=Bt.readShort(bt,St),St+=2,Mt.sTypoLineGap=Bt.readShort(bt,St),St+=2,Mt.usWinAscent=Bt.readUshort(bt,St),St+=2,Mt.usWinDescent=Bt.readUshort(bt,St),St+=2},_["OS/2"].version1=function(bt,St,Mt){var Bt=_._bin;return St=_["OS/2"].version0(bt,St,Mt),Mt.ulCodePageRange1=Bt.readUint(bt,St),St+=4,Mt.ulCodePageRange2=Bt.readUint(bt,St),St+=4},_["OS/2"].version2=function(bt,St,Mt){var Bt=_._bin;return St=_["OS/2"].version1(bt,St,Mt),Mt.sxHeight=Bt.readShort(bt,St),St+=2,Mt.sCapHeight=Bt.readShort(bt,St),St+=2,Mt.usDefault=Bt.readUshort(bt,St),St+=2,Mt.usBreak=Bt.readUshort(bt,St),St+=2,Mt.usMaxContext=Bt.readUshort(bt,St),St+=2},_["OS/2"].version5=function(bt,St,Mt){var Bt=_._bin;return St=_["OS/2"].version2(bt,St,Mt),Mt.usLowerOpticalPointSize=Bt.readUshort(bt,St),St+=2,Mt.usUpperOpticalPointSize=Bt.readUshort(bt,St),St+=2},_.post={},_.post.parse=function(bt,St,Mt){var Bt=_._bin,Ut={};return Ut.version=Bt.readFixed(bt,St),St+=4,Ut.italicAngle=Bt.readFixed(bt,St),St+=4,Ut.underlinePosition=Bt.readShort(bt,St),St+=2,Ut.underlineThickness=Bt.readShort(bt,St),St+=2,Ut},_==null&&(_={}),_.U==null&&(_.U={}),_.U.codeToGlyph=function(bt,St){var Mt=bt.cmap,Bt=-1;if(Mt.p0e4!=null?Bt=Mt.p0e4:Mt.p3e1!=null?Bt=Mt.p3e1:Mt.p1e0!=null?Bt=Mt.p1e0:Mt.p0e3!=null&&(Bt=Mt.p0e3),Bt==-1)throw"no familiar platform and encoding!";var Ut=Mt.tables[Bt];if(Ut.format==0)return St>=Ut.map.length?0:Ut.map[St];if(Ut.format==4){for(var Ht=-1,tr=0;tr<Ut.endCount.length;tr++)if(St<=Ut.endCount[tr]){Ht=tr;break}return Ht==-1||Ut.startCount[Ht]>St?0:65535&(Ut.idRangeOffset[Ht]!=0?Ut.glyphIdArray[St-Ut.startCount[Ht]+(Ut.idRangeOffset[Ht]>>1)-(Ut.idRangeOffset.length-Ht)]:St+Ut.idDelta[Ht])}if(Ut.format==12){if(St>Ut.groups[Ut.groups.length-1][1])return 0;for(tr=0;tr<Ut.groups.length;tr++){var rr=Ut.groups[tr];if(rr[0]<=St&&St<=rr[1])return rr[2]+(St-rr[0])}return 0}throw"unknown cmap table format "+Ut.format},_.U.glyphToPath=function(bt,St){var Mt={cmds:[],crds:[]};if(bt.SVG&&bt.SVG.entries[St]){var Bt=bt.SVG.entries[St];return Bt==null?Mt:(typeof Bt=="string"&&(Bt=_.SVG.toPath(Bt),bt.SVG.entries[St]=Bt),Bt)}if(bt.CFF){var Ut={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:bt.CFF.Private?bt.CFF.Private.defaultWidthX:0,open:!1},Ht=bt.CFF,tr=bt.CFF.Private;if(Ht.ROS){for(var rr=0;Ht.FDSelect[rr+2]<=St;)rr+=2;tr=Ht.FDArray[Ht.FDSelect[rr+1]].Private}_.U._drawCFF(bt.CFF.CharStrings[St],Ut,Ht,tr,Mt)}else bt.glyf&&_.U._drawGlyf(St,bt,Mt);return Mt},_.U._drawGlyf=function(bt,St,Mt){var Bt=St.glyf[bt];Bt==null&&(Bt=St.glyf[bt]=_.glyf._parseGlyf(St,bt)),Bt!=null&&(Bt.noc>-1?_.U._simpleGlyph(Bt,Mt):_.U._compoGlyph(Bt,St,Mt))},_.U._simpleGlyph=function(bt,St){for(var Mt=0;Mt<bt.noc;Mt++){for(var Bt=Mt==0?0:bt.endPts[Mt-1]+1,Ut=bt.endPts[Mt],Ht=Bt;Ht<=Ut;Ht++){var tr=Ht==Bt?Ut:Ht-1,rr=Ht==Ut?Bt:Ht+1,sr=1&bt.flags[Ht],ar=1&bt.flags[tr],cr=1&bt.flags[rr],Ar=bt.xs[Ht],_r=bt.ys[Ht];if(Ht==Bt)if(sr){if(!ar){_.U.P.moveTo(St,Ar,_r);continue}_.U.P.moveTo(St,bt.xs[tr],bt.ys[tr])}else ar?_.U.P.moveTo(St,bt.xs[tr],bt.ys[tr]):_.U.P.moveTo(St,(bt.xs[tr]+Ar)/2,(bt.ys[tr]+_r)/2);sr?ar&&_.U.P.lineTo(St,Ar,_r):cr?_.U.P.qcurveTo(St,Ar,_r,bt.xs[rr],bt.ys[rr]):_.U.P.qcurveTo(St,Ar,_r,(Ar+bt.xs[rr])/2,(_r+bt.ys[rr])/2)}_.U.P.closePath(St)}},_.U._compoGlyph=function(bt,St,Mt){for(var Bt=0;Bt<bt.parts.length;Bt++){var Ut={cmds:[],crds:[]},Ht=bt.parts[Bt];_.U._drawGlyf(Ht.glyphIndex,St,Ut);for(var tr=Ht.m,rr=0;rr<Ut.crds.length;rr+=2){var sr=Ut.crds[rr],ar=Ut.crds[rr+1];Mt.crds.push(sr*tr.a+ar*tr.b+tr.tx),Mt.crds.push(sr*tr.c+ar*tr.d+tr.ty)}for(rr=0;rr<Ut.cmds.length;rr++)Mt.cmds.push(Ut.cmds[rr])}},_.U._getGlyphClass=function(bt,St){var Mt=_._lctf.getInterval(St,bt);return Mt==-1?0:St[Mt+2]},_.U._applySubs=function(bt,St,Mt,Bt){for(var Ut=bt.length-St-1,Ht=0;Ht<Mt.tabs.length;Ht++)if(Mt.tabs[Ht]!=null){var tr,rr=Mt.tabs[Ht];if(!rr.coverage||(tr=_._lctf.coverageIndex(rr.coverage,bt[St]))!=-1){if(Mt.ltype==1)bt[St],rr.fmt==1?bt[St]=bt[St]+rr.delta:bt[St]=rr.newg[tr];else if(Mt.ltype==4)for(var sr=rr.vals[tr],ar=0;ar<sr.length;ar++){var cr=sr[ar],Ar=cr.chain.length;if(!(Ar>Ut)){for(var _r=!0,Dr=0,$r=0;$r<Ar;$r++){for(;bt[St+Dr+(1+$r)]==-1;)Dr++;cr.chain[$r]!=bt[St+Dr+(1+$r)]&&(_r=!1)}if(_r){for(bt[St]=cr.nglyph,$r=0;$r<Ar+Dr;$r++)bt[St+$r+1]=-1;break}}}else if(Mt.ltype==5&&rr.fmt==2)for(var Br=_._lctf.getInterval(rr.cDef,bt[St]),Jr=rr.cDef[Br+2],mn=rr.scset[Jr],Mn=0;Mn<mn.length;Mn++){var $n=mn[Mn],en=$n.input;if(!(en.length>Ut)){for(_r=!0,$r=0;$r<en.length;$r++){var In=_._lctf.getInterval(rr.cDef,bt[St+1+$r]);if(Br==-1&&rr.cDef[In+2]!=en[$r]){_r=!1;break}}if(_r){var Rn=$n.substLookupRecords;for(ar=0;ar<Rn.length;ar+=2)Rn[ar],Rn[ar+1]}}}else if(Mt.ltype==6&&rr.fmt==3){if(!_.U._glsCovered(bt,rr.backCvg,St-rr.backCvg.length)||!_.U._glsCovered(bt,rr.inptCvg,St)||!_.U._glsCovered(bt,rr.ahedCvg,St+rr.inptCvg.length))continue;var qn=rr.lookupRec;for(Mn=0;Mn<qn.length;Mn+=2){Br=qn[Mn];var Qn=Bt[qn[Mn+1]];_.U._applySubs(bt,St+Br,Qn,Bt)}}}}},_.U._glsCovered=function(bt,St,Mt){for(var Bt=0;Bt<St.length;Bt++)if(_._lctf.coverageIndex(St[Bt],bt[Mt+Bt])==-1)return!1;return!0},_.U.glyphsToPath=function(bt,St,Mt){for(var Bt={cmds:[],crds:[]},Ut=0,Ht=0;Ht<St.length;Ht++){var tr=St[Ht];if(tr!=-1){for(var rr=Ht<St.length-1&&St[Ht+1]!=-1?St[Ht+1]:0,sr=_.U.glyphToPath(bt,tr),ar=0;ar<sr.crds.length;ar+=2)Bt.crds.push(sr.crds[ar]+Ut),Bt.crds.push(sr.crds[ar+1]);for(Mt&&Bt.cmds.push(Mt),ar=0;ar<sr.cmds.length;ar++)Bt.cmds.push(sr.cmds[ar]);Mt&&Bt.cmds.push("X"),Ut+=bt.hmtx.aWidth[tr],Ht<St.length-1&&(Ut+=_.U.getPairAdjustment(bt,tr,rr))}}return Bt},_.U.P={},_.U.P.moveTo=function(bt,St,Mt){bt.cmds.push("M"),bt.crds.push(St,Mt)},_.U.P.lineTo=function(bt,St,Mt){bt.cmds.push("L"),bt.crds.push(St,Mt)},_.U.P.curveTo=function(bt,St,Mt,Bt,Ut,Ht,tr){bt.cmds.push("C"),bt.crds.push(St,Mt,Bt,Ut,Ht,tr)},_.U.P.qcurveTo=function(bt,St,Mt,Bt,Ut){bt.cmds.push("Q"),bt.crds.push(St,Mt,Bt,Ut)},_.U.P.closePath=function(bt){bt.cmds.push("Z")},_.U._drawCFF=function(bt,St,Mt,Bt,Ut){for(var Ht=St.stack,tr=St.nStems,rr=St.haveWidth,sr=St.width,ar=St.open,cr=0,Ar=St.x,_r=St.y,Dr=0,$r=0,Br=0,Jr=0,mn=0,Mn=0,$n=0,en=0,In=0,Rn=0,qn={val:0,size:0};cr<bt.length;){_.CFF.getCharString(bt,cr,qn);var Qn=qn.val;if(cr+=qn.size,Qn=="o1"||Qn=="o18")Ht.length%2!=0&&!rr&&(sr=Ht.shift()+Bt.nominalWidthX),tr+=Ht.length>>1,Ht.length=0,rr=!0;else if(Qn=="o3"||Qn=="o23")Ht.length%2!=0&&!rr&&(sr=Ht.shift()+Bt.nominalWidthX),tr+=Ht.length>>1,Ht.length=0,rr=!0;else if(Qn=="o4")Ht.length>1&&!rr&&(sr=Ht.shift()+Bt.nominalWidthX,rr=!0),ar&&_.U.P.closePath(Ut),_r+=Ht.pop(),_.U.P.moveTo(Ut,Ar,_r),ar=!0;else if(Qn=="o5")for(;Ht.length>0;)Ar+=Ht.shift(),_r+=Ht.shift(),_.U.P.lineTo(Ut,Ar,_r);else if(Qn=="o6"||Qn=="o7")for(var xs=Ht.length,cs=Qn=="o6",ks=0;ks<xs;ks++){var _o=Ht.shift();cs?Ar+=_o:_r+=_o,cs=!cs,_.U.P.lineTo(Ut,Ar,_r)}else if(Qn=="o8"||Qn=="o24"){xs=Ht.length;for(var qs=0;qs+6<=xs;)Dr=Ar+Ht.shift(),$r=_r+Ht.shift(),Br=Dr+Ht.shift(),Jr=$r+Ht.shift(),Ar=Br+Ht.shift(),_r=Jr+Ht.shift(),_.U.P.curveTo(Ut,Dr,$r,Br,Jr,Ar,_r),qs+=6;Qn=="o24"&&(Ar+=Ht.shift(),_r+=Ht.shift(),_.U.P.lineTo(Ut,Ar,_r))}else{if(Qn=="o11")break;if(Qn=="o1234"||Qn=="o1235"||Qn=="o1236"||Qn=="o1237")Qn=="o1234"&&($r=_r,Br=(Dr=Ar+Ht.shift())+Ht.shift(),Rn=Jr=$r+Ht.shift(),Mn=Jr,en=_r,Ar=($n=(mn=(In=Br+Ht.shift())+Ht.shift())+Ht.shift())+Ht.shift(),_.U.P.curveTo(Ut,Dr,$r,Br,Jr,In,Rn),_.U.P.curveTo(Ut,mn,Mn,$n,en,Ar,_r)),Qn=="o1235"&&(Dr=Ar+Ht.shift(),$r=_r+Ht.shift(),Br=Dr+Ht.shift(),Jr=$r+Ht.shift(),In=Br+Ht.shift(),Rn=Jr+Ht.shift(),mn=In+Ht.shift(),Mn=Rn+Ht.shift(),$n=mn+Ht.shift(),en=Mn+Ht.shift(),Ar=$n+Ht.shift(),_r=en+Ht.shift(),Ht.shift(),_.U.P.curveTo(Ut,Dr,$r,Br,Jr,In,Rn),_.U.P.curveTo(Ut,mn,Mn,$n,en,Ar,_r)),Qn=="o1236"&&(Dr=Ar+Ht.shift(),$r=_r+Ht.shift(),Br=Dr+Ht.shift(),Rn=Jr=$r+Ht.shift(),Mn=Jr,$n=(mn=(In=Br+Ht.shift())+Ht.shift())+Ht.shift(),en=Mn+Ht.shift(),Ar=$n+Ht.shift(),_.U.P.curveTo(Ut,Dr,$r,Br,Jr,In,Rn),_.U.P.curveTo(Ut,mn,Mn,$n,en,Ar,_r)),Qn=="o1237"&&(Dr=Ar+Ht.shift(),$r=_r+Ht.shift(),Br=Dr+Ht.shift(),Jr=$r+Ht.shift(),In=Br+Ht.shift(),Rn=Jr+Ht.shift(),mn=In+Ht.shift(),Mn=Rn+Ht.shift(),$n=mn+Ht.shift(),en=Mn+Ht.shift(),Math.abs($n-Ar)>Math.abs(en-_r)?Ar=$n+Ht.shift():_r=en+Ht.shift(),_.U.P.curveTo(Ut,Dr,$r,Br,Jr,In,Rn),_.U.P.curveTo(Ut,mn,Mn,$n,en,Ar,_r));else if(Qn=="o14"){if(Ht.length>0&&!rr&&(sr=Ht.shift()+Mt.nominalWidthX,rr=!0),Ht.length==4){var Ss=Ht.shift(),eo=Ht.shift(),Ao=Ht.shift(),Oo=Ht.shift(),uo=_.CFF.glyphBySE(Mt,Ao),uu=_.CFF.glyphBySE(Mt,Oo);_.U._drawCFF(Mt.CharStrings[uo],St,Mt,Bt,Ut),St.x=Ss,St.y=eo,_.U._drawCFF(Mt.CharStrings[uu],St,Mt,Bt,Ut)}ar&&(_.U.P.closePath(Ut),ar=!1)}else if(Qn=="o19"||Qn=="o20")Ht.length%2!=0&&!rr&&(sr=Ht.shift()+Bt.nominalWidthX),tr+=Ht.length>>1,Ht.length=0,rr=!0,cr+=tr+7>>3;else if(Qn=="o21")Ht.length>2&&!rr&&(sr=Ht.shift()+Bt.nominalWidthX,rr=!0),_r+=Ht.pop(),Ar+=Ht.pop(),ar&&_.U.P.closePath(Ut),_.U.P.moveTo(Ut,Ar,_r),ar=!0;else if(Qn=="o22")Ht.length>1&&!rr&&(sr=Ht.shift()+Bt.nominalWidthX,rr=!0),Ar+=Ht.pop(),ar&&_.U.P.closePath(Ut),_.U.P.moveTo(Ut,Ar,_r),ar=!0;else if(Qn=="o25"){for(;Ht.length>6;)Ar+=Ht.shift(),_r+=Ht.shift(),_.U.P.lineTo(Ut,Ar,_r);Dr=Ar+Ht.shift(),$r=_r+Ht.shift(),Br=Dr+Ht.shift(),Jr=$r+Ht.shift(),Ar=Br+Ht.shift(),_r=Jr+Ht.shift(),_.U.P.curveTo(Ut,Dr,$r,Br,Jr,Ar,_r)}else if(Qn=="o26")for(Ht.length%2&&(Ar+=Ht.shift());Ht.length>0;)Dr=Ar,$r=_r+Ht.shift(),Ar=Br=Dr+Ht.shift(),_r=(Jr=$r+Ht.shift())+Ht.shift(),_.U.P.curveTo(Ut,Dr,$r,Br,Jr,Ar,_r);else if(Qn=="o27")for(Ht.length%2&&(_r+=Ht.shift());Ht.length>0;)$r=_r,Br=(Dr=Ar+Ht.shift())+Ht.shift(),Jr=$r+Ht.shift(),Ar=Br+Ht.shift(),_r=Jr,_.U.P.curveTo(Ut,Dr,$r,Br,Jr,Ar,_r);else if(Qn=="o10"||Qn=="o29"){var cu=Qn=="o10"?Bt:Mt;if(Ht.length==0)console.debug("error: empty stack");else{var Jl=Ht.pop(),mu=cu.Subrs[Jl+cu.Bias];St.x=Ar,St.y=_r,St.nStems=tr,St.haveWidth=rr,St.width=sr,St.open=ar,_.U._drawCFF(mu,St,Mt,Bt,Ut),Ar=St.x,_r=St.y,tr=St.nStems,rr=St.haveWidth,sr=St.width,ar=St.open}}else if(Qn=="o30"||Qn=="o31"){var pu=Ht.length,Zu=(qs=0,Qn=="o31");for(qs+=pu-(xs=-3&pu);qs<xs;)Zu?($r=_r,Br=(Dr=Ar+Ht.shift())+Ht.shift(),_r=(Jr=$r+Ht.shift())+Ht.shift(),xs-qs==5?(Ar=Br+Ht.shift(),qs++):Ar=Br,Zu=!1):(Dr=Ar,$r=_r+Ht.shift(),Br=Dr+Ht.shift(),Jr=$r+Ht.shift(),Ar=Br+Ht.shift(),xs-qs==5?(_r=Jr+Ht.shift(),qs++):_r=Jr,Zu=!0),_.U.P.curveTo(Ut,Dr,$r,Br,Jr,Ar,_r),qs+=4}else{if((Qn+"").charAt(0)=="o")throw console.debug("Unknown operation: "+Qn,bt),Qn;Ht.push(Qn)}}}St.x=Ar,St.y=_r,St.nStems=tr,St.haveWidth=rr,St.width=sr,St.open=ar};var ut=_,mt={Typr:ut};return rt.Typr=ut,rt.default=mt,Object.defineProperty(rt,"__esModule",{value:!0}),rt}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function woff2otfFactory(){return function(rt){var _=Uint8Array,ut=Uint16Array,mt=Uint32Array,bt=new _([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),St=new _([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Mt=new _([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Bt=function(Qn,xs){for(var cs=new ut(31),ks=0;ks<31;++ks)cs[ks]=xs+=1<<Qn[ks-1];var _o=new mt(cs[30]);for(ks=1;ks<30;++ks)for(var qs=cs[ks];qs<cs[ks+1];++qs)_o[qs]=qs-cs[ks]<<5|ks;return[cs,_o]},Ut=Bt(bt,2),Ht=Ut[0],tr=Ut[1];Ht[28]=258,tr[258]=28;for(var rr=Bt(St,0)[0],sr=new ut(32768),ar=0;ar<32768;++ar){var cr=(43690&ar)>>>1|(21845&ar)<<1;cr=(61680&(cr=(52428&cr)>>>2|(13107&cr)<<2))>>>4|(3855&cr)<<4,sr[ar]=((65280&cr)>>>8|(255&cr)<<8)>>>1}var Ar=function(Qn,xs,cs){for(var ks=Qn.length,_o=0,qs=new ut(xs);_o<ks;++_o)++qs[Qn[_o]-1];var Ss,eo=new ut(xs);for(_o=0;_o<xs;++_o)eo[_o]=eo[_o-1]+qs[_o-1]<<1;{Ss=new ut(1<<xs);var Ao=15-xs;for(_o=0;_o<ks;++_o)if(Qn[_o])for(var Oo=_o<<4|Qn[_o],uo=xs-Qn[_o],uu=eo[Qn[_o]-1]++<<uo,cu=uu|(1<<uo)-1;uu<=cu;++uu)Ss[sr[uu]>>>Ao]=Oo}return Ss},_r=new _(288);for(ar=0;ar<144;++ar)_r[ar]=8;for(ar=144;ar<256;++ar)_r[ar]=9;for(ar=256;ar<280;++ar)_r[ar]=7;for(ar=280;ar<288;++ar)_r[ar]=8;var Dr=new _(32);for(ar=0;ar<32;++ar)Dr[ar]=5;var $r=Ar(_r,9),Br=Ar(Dr,5),Jr=function(Qn){for(var xs=Qn[0],cs=1;cs<Qn.length;++cs)Qn[cs]>xs&&(xs=Qn[cs]);return xs},mn=function(Qn,xs,cs){var ks=xs/8|0;return(Qn[ks]|Qn[ks+1]<<8)>>(7&xs)&cs},Mn=function(Qn,xs){var cs=xs/8|0;return(Qn[cs]|Qn[cs+1]<<8|Qn[cs+2]<<16)>>(7&xs)},$n=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],en=function(Qn,xs,cs){var ks=new Error(xs||$n[Qn]);if(ks.code=Qn,Error.captureStackTrace&&Error.captureStackTrace(ks,en),!cs)throw ks;return ks},In=function(Qn,xs,cs){var ks=Qn.length;if(!ks||cs&&!cs.l&&ks<5)return xs||new _(0);var _o=!xs||cs,qs=!cs||cs.i;cs||(cs={}),xs||(xs=new _(3*ks));var Ss,eo=function(Cv){var Kp=xs.length;if(Cv>Kp){var sv=new _(Math.max(2*Kp,Cv));sv.set(xs),xs=sv}},Ao=cs.f||0,Oo=cs.p||0,uo=cs.b||0,uu=cs.l,cu=cs.d,Jl=cs.m,mu=cs.n,pu=8*ks;do{if(!uu){cs.f=Ao=mn(Qn,Oo,1);var Zu=mn(Qn,Oo+1,3);if(Oo+=3,!Zu){var Mp=Qn[(z0=((Ss=Oo)/8|0)+(7&Ss&&1)+4)-4]|Qn[z0-3]<<8,Up=z0+Mp;if(Up>ks){qs&&en(0);break}_o&&eo(uo+Mp),xs.set(Qn.subarray(z0,Up),uo),cs.b=uo+=Mp,cs.p=Oo=8*Up;continue}if(Zu==1)uu=$r,cu=Br,Jl=9,mu=5;else if(Zu==2){var Ep=mn(Qn,Oo,31)+257,mp=mn(Qn,Oo+10,15)+4,Cp=Ep+mn(Qn,Oo+5,31)+1;Oo+=14;for(var t0=new _(Cp),_g=new _(19),m0=0;m0<mp;++m0)_g[Mt[m0]]=mn(Qn,Oo+3*m0,7);Oo+=3*mp;var K0=Jr(_g),Jp=(1<<K0)-1,y0=Ar(_g,K0);for(m0=0;m0<Cp;){var z0,jm=y0[mn(Qn,Oo,Jp)];if(Oo+=15&jm,(z0=jm>>>4)<16)t0[m0++]=z0;else{var Nu=0,Co=0;for(z0==16?(Co=3+mn(Qn,Oo,3),Oo+=2,Nu=t0[m0-1]):z0==17?(Co=3+mn(Qn,Oo,7),Oo+=3):z0==18&&(Co=11+mn(Qn,Oo,127),Oo+=7);Co--;)t0[m0++]=Nu}}var Bp=t0.subarray(0,Ep),a0=t0.subarray(Ep);Jl=Jr(Bp),mu=Jr(a0),uu=Ar(Bp,Jl),cu=Ar(a0,mu)}else en(1);if(Oo>pu){qs&&en(0);break}}_o&&eo(uo+131072);for(var Q0=(1<<Jl)-1,T0=(1<<mu)-1,av=Oo;;av=Oo){var lv=(Nu=uu[Mn(Qn,Oo)&Q0])>>>4;if((Oo+=15&Nu)>pu){qs&&en(0);break}if(Nu||en(2),lv<256)xs[uo++]=lv;else{if(lv==256){av=Oo,uu=null;break}var N0=lv-254;if(lv>264){var zv=bt[m0=lv-257];N0=mn(Qn,Oo,(1<<zv)-1)+Ht[m0],Oo+=zv}var Uv=cu[Mn(Qn,Oo)&T0],Gv=Uv>>>4;if(Uv||en(3),Oo+=15&Uv,a0=rr[Gv],Gv>3&&(zv=St[Gv],a0+=Mn(Qn,Oo)&(1<<zv)-1,Oo+=zv),Oo>pu){qs&&en(0);break}_o&&eo(uo+131072);for(var Dv=uo+N0;uo<Dv;uo+=4)xs[uo]=xs[uo-a0],xs[uo+1]=xs[uo+1-a0],xs[uo+2]=xs[uo+2-a0],xs[uo+3]=xs[uo+3-a0];uo=Dv}}cs.l=uu,cs.p=av,cs.b=uo,uu&&(Ao=1,cs.m=Jl,cs.d=cu,cs.n=mu)}while(!Ao);return uo==xs.length?xs:function(Cv,Kp,sv){(sv==null||sv>Cv.length)&&(sv=Cv.length);var Hv=new(Cv instanceof ut?ut:Cv instanceof mt?mt:_)(sv-Kp);return Hv.set(Cv.subarray(Kp,sv)),Hv}(xs,0,uo)},Rn=new _(0),qn=typeof TextDecoder<"u"&&new TextDecoder;try{qn.decode(Rn,{stream:!0})}catch{}return rt.convert_streams=function(Qn){var xs=new DataView(Qn),cs=0;function ks(){var Ep=xs.getUint16(cs);return cs+=2,Ep}function _o(){var Ep=xs.getUint32(cs);return cs+=4,Ep}function qs(Ep){Mp.setUint16(Up,Ep),Up+=2}function Ss(Ep){Mp.setUint32(Up,Ep),Up+=4}for(var eo={signature:_o(),flavor:_o(),length:_o(),numTables:ks(),reserved:ks(),totalSfntSize:_o(),majorVersion:ks(),minorVersion:ks(),metaOffset:_o(),metaLength:_o(),metaOrigLength:_o(),privOffset:_o(),privLength:_o()},Ao=0;Math.pow(2,Ao)<=eo.numTables;)Ao++;Ao--;for(var Oo=16*Math.pow(2,Ao),uo=16*eo.numTables-Oo,uu=12,cu=[],Jl=0;Jl<eo.numTables;Jl++)cu.push({tag:_o(),offset:_o(),compLength:_o(),origLength:_o(),origChecksum:_o()}),uu+=16;var mu,pu=new Uint8Array(12+16*cu.length+cu.reduce(function(Ep,mp){return Ep+mp.origLength+4},0)),Zu=pu.buffer,Mp=new DataView(Zu),Up=0;return Ss(eo.flavor),qs(eo.numTables),qs(Oo),qs(Ao),qs(uo),cu.forEach(function(Ep){Ss(Ep.tag),Ss(Ep.origChecksum),Ss(uu),Ss(Ep.origLength),Ep.outOffset=uu,(uu+=Ep.origLength)%4!=0&&(uu+=4-uu%4)}),cu.forEach(function(Ep){var mp,Cp=Qn.slice(Ep.offset,Ep.offset+Ep.compLength);if(Ep.compLength!=Ep.origLength){var t0=new Uint8Array(Ep.origLength);mp=new Uint8Array(Cp,2),In(mp,t0)}else t0=new Uint8Array(Cp);pu.set(t0,Ep.outOffset);var _g=0;(uu=Ep.outOffset+Ep.origLength)%4!=0&&(_g=4-uu%4),pu.set(new Uint8Array(_g).buffer,Ep.outOffset+Ep.origLength),mu=uu+_g}),Zu.slice(0,mu)},Object.defineProperty(rt,"__esModule",{value:!0}),rt}({}).convert_streams}function parserFactory(rt,_){const ut={M:2,L:2,Q:4,C:6,Z:0},mt={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},bt=1,St=2,Mt=4,Bt=8,Ut=16,Ht=32;let tr;function rr($n){if(!tr){const en={R:St,L:bt,D:Mt,C:Ut,U:Ht,T:Bt};tr=new Map;for(let In in mt){let Rn=0;mt[In].split(",").forEach(qn=>{let[Qn,xs]=qn.split("+");Qn=parseInt(Qn,36),xs=xs?parseInt(xs,36):0,tr.set(Rn+=Qn,en[In]);for(let cs=xs;cs--;)tr.set(++Rn,en[In])})}}return tr.get($n)||Ht}const sr=1,ar=2,cr=3,Ar=4,_r=[null,"isol","init","fina","medi"];function Dr($n){const en=new Uint8Array($n.length);let In=Ht,Rn=sr,qn=-1;for(let Qn=0;Qn<$n.length;Qn++){const xs=$n.codePointAt(Qn);let cs=rr(xs)|0,ks=sr;cs&Bt||(In&(bt|Mt|Ut)?cs&(St|Mt|Ut)?(ks=cr,(Rn===sr||Rn===cr)&&en[qn]++):cs&(bt|Ht)&&(Rn===ar||Rn===Ar)&&en[qn]--:In&(St|Ht)&&(Rn===ar||Rn===Ar)&&en[qn]--,Rn=en[Qn]=ks,In=cs,qn=Qn,xs>65535&&Qn++)}return en}function $r($n,en){const In=[];for(let qn=0;qn<en.length;qn++){const Qn=en.codePointAt(qn);Qn>65535&&qn++,In.push(rt.U.codeToGlyph($n,Qn))}const Rn=$n.GSUB;if(Rn){const{lookupList:qn,featureList:Qn}=Rn;let xs;const cs=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,ks=[];Qn.forEach(_o=>{if(cs.test(_o.tag))for(let qs=0;qs<_o.tab.length;qs++){if(ks[_o.tab[qs]])continue;ks[_o.tab[qs]]=!0;const Ss=qn[_o.tab[qs]],eo=/^(isol|init|fina|medi)$/.test(_o.tag);eo&&!xs&&(xs=Dr(en));for(let Ao=0;Ao<In.length;Ao++)(!xs||!eo||_r[xs[Ao]]===_o.tag)&&rt.U._applySubs(In,Ao,Ss,qn)}})}return In}function Br($n,en){const In=new Int16Array(en.length*3);let Rn=0;for(;Rn<en.length;Rn++){const cs=en[Rn];if(cs===-1)continue;In[Rn*3+2]=$n.hmtx.aWidth[cs];const ks=$n.GPOS;if(ks){const _o=ks.lookupList;for(let qs=0;qs<_o.length;qs++){const Ss=_o[qs];for(let eo=0;eo<Ss.tabs.length;eo++){const Ao=Ss.tabs[eo];if(Ss.ltype===1){if(rt._lctf.coverageIndex(Ao.coverage,cs)!==-1&&Ao.pos){xs(Ao.pos,Rn);break}}else if(Ss.ltype===2){let Oo=null,uo=qn();if(uo!==-1){const uu=rt._lctf.coverageIndex(Ao.coverage,en[uo]);if(uu!==-1){if(Ao.fmt===1){const cu=Ao.pairsets[uu];for(let Jl=0;Jl<cu.length;Jl++)cu[Jl].gid2===cs&&(Oo=cu[Jl])}else if(Ao.fmt===2){const cu=rt.U._getGlyphClass(en[uo],Ao.classDef1),Jl=rt.U._getGlyphClass(cs,Ao.classDef2);Oo=Ao.matrix[cu][Jl]}if(Oo){Oo.val1&&xs(Oo.val1,uo),Oo.val2&&xs(Oo.val2,Rn);break}}}}else if(Ss.ltype===4){const Oo=rt._lctf.coverageIndex(Ao.markCoverage,cs);if(Oo!==-1){const uo=qn(Qn),uu=uo===-1?-1:rt._lctf.coverageIndex(Ao.baseCoverage,en[uo]);if(uu!==-1){const cu=Ao.markArray[Oo],Jl=Ao.baseArray[uu][cu.markClass];In[Rn*3]=Jl.x-cu.x+In[uo*3]-In[uo*3+2],In[Rn*3+1]=Jl.y-cu.y+In[uo*3+1];break}}}else if(Ss.ltype===6){const Oo=rt._lctf.coverageIndex(Ao.mark1Coverage,cs);if(Oo!==-1){const uo=qn();if(uo!==-1){const uu=en[uo];if(Jr($n,uu)===3){const cu=rt._lctf.coverageIndex(Ao.mark2Coverage,uu);if(cu!==-1){const Jl=Ao.mark1Array[Oo],mu=Ao.mark2Array[cu][Jl.markClass];In[Rn*3]=mu.x-Jl.x+In[uo*3]-In[uo*3+2],In[Rn*3+1]=mu.y-Jl.y+In[uo*3+1];break}}}}}}}}else if($n.kern&&!$n.cff){const _o=qn();if(_o!==-1){const qs=$n.kern.glyph1.indexOf(en[_o]);if(qs!==-1){const Ss=$n.kern.rval[qs].glyph2.indexOf(cs);Ss!==-1&&(In[_o*3+2]+=$n.kern.rval[qs].vals[Ss])}}}}return In;function qn(cs){for(let ks=Rn-1;ks>=0;ks--)if(en[ks]!==-1&&(!cs||cs(en[ks])))return ks;return-1}function Qn(cs){return Jr($n,cs)===1}function xs(cs,ks){for(let _o=0;_o<3;_o++)In[ks*3+_o]+=cs[_o]||0}}function Jr($n,en){const In=$n.GDEF&&$n.GDEF.glyphClassDef;return In?rt.U._getGlyphClass(en,In):0}function mn(...$n){for(let en=0;en<$n.length;en++)if(typeof $n[en]=="number")return $n[en]}function Mn($n){const en=Object.create(null),In=$n["OS/2"],Rn=$n.hhea,qn=$n.head.unitsPerEm,Qn=mn(In&&In.sTypoAscender,Rn&&Rn.ascender,qn),xs={unitsPerEm:qn,ascender:Qn,descender:mn(In&&In.sTypoDescender,Rn&&Rn.descender,0),capHeight:mn(In&&In.sCapHeight,Qn),xHeight:mn(In&&In.sxHeight,Qn),lineGap:mn(In&&In.sTypoLineGap,Rn&&Rn.lineGap),supportsCodePoint(cs){return rt.U.codeToGlyph($n,cs)>0},forEachGlyph(cs,ks,_o,qs){let Ss=0;const eo=1/xs.unitsPerEm*ks,Ao=$r($n,cs);let Oo=0;const uo=Br($n,Ao);return Ao.forEach((uu,cu)=>{if(uu!==-1){let Jl=en[uu];if(!Jl){const{cmds:mu,crds:pu}=rt.U.glyphToPath($n,uu);let Zu="",Mp=0;for(let t0=0,_g=mu.length;t0<_g;t0++){const m0=ut[mu[t0]];Zu+=mu[t0];for(let K0=1;K0<=m0;K0++)Zu+=(K0>1?",":"")+pu[Mp++]}let Up,Ep,mp,Cp;if(pu.length){Up=Ep=1/0,mp=Cp=-1/0;for(let t0=0,_g=pu.length;t0<_g;t0+=2){let m0=pu[t0],K0=pu[t0+1];m0<Up&&(Up=m0),K0<Ep&&(Ep=K0),m0>mp&&(mp=m0),K0>Cp&&(Cp=K0)}}else Up=mp=Ep=Cp=0;Jl=en[uu]={index:uu,advanceWidth:$n.hmtx.aWidth[uu],xMin:Up,yMin:Ep,xMax:mp,yMax:Cp,path:Zu}}qs.call(null,Jl,Ss+uo[cu*3]*eo,uo[cu*3+1]*eo,Oo),Ss+=uo[cu*3+2]*eo,_o&&(Ss+=_o*ks)}Oo+=cs.codePointAt(Oo)>65535?2:1}),Ss}};return xs}return function(en){const In=new Uint8Array(en,0,4),Rn=rt._bin.readASCII(In,0,4);if(Rn==="wOFF")en=_(en);else if(Rn==="wOF2")throw new Error("woff2 fonts not supported");return Mn(rt.parse(en)[0])}}const workerModule=defineWorkerModule({name:"Typr Font Parser",dependencies:[typrFactory,woff2otfFactory,parserFactory],init(rt,_,ut){const mt=rt(),bt=_();return ut(mt,bt)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function unicodeFontResolverClientFactory(){return function(rt){var _=function(){this.buckets=new Map};_.prototype.add=function(Br){var Jr=Br>>5;this.buckets.set(Jr,(this.buckets.get(Jr)||0)|1<<(31&Br))},_.prototype.has=function(Br){var Jr=this.buckets.get(Br>>5);return Jr!==void 0&&(Jr&1<<(31&Br))!=0},_.prototype.serialize=function(){var Br=[];return this.buckets.forEach(function(Jr,mn){Br.push((+mn).toString(36)+":"+Jr.toString(36))}),Br.join(",")},_.prototype.deserialize=function(Br){var Jr=this;this.buckets.clear(),Br.split(",").forEach(function(mn){var Mn=mn.split(":");Jr.buckets.set(parseInt(Mn[0],36),parseInt(Mn[1],36))})};var ut=Math.pow(2,8),mt=ut-1,bt=~mt;function St(Br){var Jr=function(Mn){return Mn&bt}(Br).toString(16),mn=function(Mn){return(Mn&bt)+ut-1}(Br).toString(16);return"codepoint-index/plane"+(Br>>16)+"/"+Jr+"-"+mn+".json"}function Mt(Br,Jr){var mn=Br&mt,Mn=Jr.codePointAt(mn/6|0);return((Mn=(Mn||48)-48)&1<<mn%6)!=0}function Bt(Br,Jr){var mn;(mn=Br,mn.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(Mn){return Mn.split("-").map(function($n){return parseInt($n.trim(),16)})})).forEach(function(Mn){var $n=Mn[0],en=Mn[1];en===void 0&&(en=$n),Jr($n,en)})}function Ut(Br,Jr){Bt(Br,function(mn,Mn){for(var $n=mn;$n<=Mn;$n++)Jr($n)})}var Ht={},tr={},rr=new WeakMap,sr="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function ar(Br){var Jr=rr.get(Br);return Jr||(Jr=new _,Ut(Br.ranges,function(mn){return Jr.add(mn)}),rr.set(Br,Jr)),Jr}var cr,Ar=new Map;function _r(Br,Jr,mn){return Br[Jr]?Jr:Br[mn]?mn:function(Mn){for(var $n in Mn)return $n}(Br)}function Dr(Br,Jr){var mn=Jr;if(!Br.includes(mn)){mn=1/0;for(var Mn=0;Mn<Br.length;Mn++)Math.abs(Br[Mn]-Jr)<Math.abs(mn-Jr)&&(mn=Br[Mn])}return mn}function $r(Br){return cr||(cr=new Set,Ut("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(Jr){cr.add(Jr)})),cr.has(Br)}return rt.CodePointSet=_,rt.clearCache=function(){Ht={},tr={}},rt.getFontsForString=function(Br,Jr){Jr===void 0&&(Jr={});var mn,Mn=Jr.lang;Mn===void 0&&(Mn=new RegExp("\\p{Script=Hangul}","u").test(mn=Br)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(mn)?"ja":"en");var $n=Jr.category;$n===void 0&&($n="sans-serif");var en=Jr.style;en===void 0&&(en="normal");var In=Jr.weight;In===void 0&&(In=400);var Rn=(Jr.dataUrl||sr).replace(/\/$/g,""),qn=new Map,Qn=new Uint8Array(Br.length),xs={},cs={},ks=new Array(Br.length),_o=new Map,qs=!1;function Ss(Oo){var uo=Ar.get(Oo);return uo||(uo=fetch(Rn+"/"+Oo).then(function(uu){if(!uu.ok)throw new Error(uu.statusText);return uu.json().then(function(cu){if(!Array.isArray(cu)||cu[0]!==1)throw new Error("Incorrect schema version; need 1, got "+cu[0]);return cu[1]})}).catch(function(uu){if(Rn!==sr)return qs||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+Rn+'", trying default CDN. '+uu.message),qs=!0),Rn=sr,Ar.delete(Oo),Ss(Oo);throw uu}),Ar.set(Oo,uo)),uo}for(var eo=function(Oo){var uo=Br.codePointAt(Oo),uu=St(uo);ks[Oo]=uu,Ht[uu]||_o.has(uu)||_o.set(uu,Ss(uu).then(function(cu){Ht[uu]=cu})),uo>65535&&(Oo++,Ao=Oo)},Ao=0;Ao<Br.length;Ao++)eo(Ao);return Promise.all(_o.values()).then(function(){_o.clear();for(var Oo=function(uu){var cu=Br.codePointAt(uu),Jl=null,mu=Ht[ks[uu]],pu=void 0;for(var Zu in mu){var Mp=cs[Zu];if(Mp===void 0&&(Mp=cs[Zu]=new RegExp(Zu).test(Mn||"en")),Mp){for(var Up in pu=Zu,mu[Zu])if(Mt(cu,mu[Zu][Up])){Jl=Up;break}break}}if(!Jl){e:for(var Ep in mu)if(Ep!==pu){for(var mp in mu[Ep])if(Mt(cu,mu[Ep][mp])){Jl=mp;break e}}}Jl||(console.debug("No font coverage for U+"+cu.toString(16)),Jl="latin"),ks[uu]=Jl,tr[Jl]||_o.has(Jl)||_o.set(Jl,Ss("font-meta/"+Jl+".json").then(function(Cp){tr[Jl]=Cp})),cu>65535&&(uu++,uo=uu)},uo=0;uo<Br.length;uo++)Oo(uo);return Promise.all(_o.values())}).then(function(){for(var Oo,uo=null,uu=0;uu<Br.length;uu++){var cu=Br.codePointAt(uu);if(uo&&($r(cu)||ar(uo).has(cu)))Qn[uu]=Qn[uu-1];else{uo=tr[ks[uu]];var Jl=xs[uo.id];if(!Jl){var mu=uo.typeforms,pu=_r(mu,$n,"sans-serif"),Zu=_r(mu[pu],en,"normal"),Mp=Dr((Oo=mu[pu])===null||Oo===void 0?void 0:Oo[Zu],In);Jl=xs[uo.id]=Rn+"/font-files/"+uo.id+"/"+pu+"."+Zu+"."+Mp+".woff"}var Up=qn.get(Jl);Up==null&&(Up=qn.size,qn.set(Jl,Up)),Qn[uu]=Up}cu>65535&&(uu++,Qn[uu]=Qn[uu-1])}return{fontUrls:Array.from(qn.keys()),chars:Qn}})},Object.defineProperty(rt,"__esModule",{value:!0}),rt}({})}function createFontResolver(rt,_){const ut=Object.create(null),mt=Object.create(null);function bt(Mt,Bt){const Ut=Ht=>{console.error(`Failure loading font ${Mt}`,Ht)};try{const Ht=new XMLHttpRequest;Ht.open("get",Mt,!0),Ht.responseType="arraybuffer",Ht.onload=function(){if(Ht.status>=400)Ut(new Error(Ht.statusText));else if(Ht.status>0)try{const tr=rt(Ht.response);tr.src=Mt,Bt(tr)}catch(tr){Ut(tr)}},Ht.onerror=Ut,Ht.send()}catch(Ht){Ut(Ht)}}function St(Mt,Bt){let Ut=ut[Mt];Ut?Bt(Ut):mt[Mt]?mt[Mt].push(Bt):(mt[Mt]=[Bt],bt(Mt,Ht=>{Ht.src=Mt,ut[Mt]=Ht,mt[Mt].forEach(tr=>tr(Ht)),delete mt[Mt]}))}return function(Mt,Bt,{lang:Ut,fonts:Ht=[],style:tr="normal",weight:rr="normal",unicodeFontsURL:sr}={}){const ar=new Uint8Array(Mt.length),cr=[];Mt.length||$r();const Ar=new Map,_r=[];if(tr!=="italic"&&(tr="normal"),typeof rr!="number"&&(rr=rr==="bold"?700:400),Ht&&!Array.isArray(Ht)&&(Ht=[Ht]),Ht=Ht.slice().filter(Jr=>!Jr.lang||Jr.lang.test(Ut)).reverse(),Ht.length){let $n=0;(function en(In=0){for(let Rn=In,qn=Mt.length;Rn<qn;Rn++){const Qn=Mt.codePointAt(Rn);if($n===1&&cr[ar[Rn-1]].supportsCodePoint(Qn)||/\s/.test(Mt[Rn]))ar[Rn]=ar[Rn-1],$n===2&&(_r[_r.length-1][1]=Rn);else for(let xs=ar[Rn],cs=Ht.length;xs<=cs;xs++)if(xs===cs){const ks=$n===2?_r[_r.length-1]:_r[_r.length]=[Rn,Rn];ks[1]=Rn,$n=2}else{ar[Rn]=xs;const{src:ks,unicodeRange:_o}=Ht[xs];if(!_o||Br(Qn,_o)){const qs=ut[ks];if(!qs){St(ks,()=>{en(Rn)});return}if(qs.supportsCodePoint(Qn)){let Ss=Ar.get(qs);typeof Ss!="number"&&(Ss=cr.length,cr.push(qs),Ar.set(qs,Ss)),ar[Rn]=Ss,$n=1;break}}}Qn>65535&&Rn+1<qn&&(ar[Rn+1]=ar[Rn],Rn++,$n===2&&(_r[_r.length-1][1]=Rn))}Dr()})()}else _r.push([0,Mt.length-1]),Dr();function Dr(){if(_r.length){const Jr=_r.map(mn=>Mt.substring(mn[0],mn[1]+1)).join(`
`);_.getFontsForString(Jr,{lang:Ut||void 0,style:tr,weight:rr,dataUrl:sr}).then(({fontUrls:mn,chars:Mn})=>{const $n=cr.length;let en=0;_r.forEach(Rn=>{for(let qn=0,Qn=Rn[1]-Rn[0];qn<=Qn;qn++)ar[Rn[0]+qn]=Mn[en++]+$n;en++});let In=0;mn.forEach((Rn,qn)=>{St(Rn,Qn=>{cr[qn+$n]=Qn,++In===mn.length&&$r()})})})}else $r()}function $r(){Bt({chars:ar,fonts:cr})}function Br(Jr,mn){for(let Mn=0;Mn<mn.length;Mn++){const[$n,en=$n]=mn[Mn];if($n<=Jr&&Jr<=en)return!0}return!1}}}const fontResolverWorkerModule=defineWorkerModule({name:"FontResolver",dependencies:[createFontResolver,workerModule,unicodeFontResolverClientFactory],init(rt,_,ut){return rt(_,ut())}});function createTypesetter(rt,_){const mt=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,bt="[^\\S\\u00A0]",St=new RegExp(`${bt}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function Mt({text:cr,lang:Ar,fonts:_r,style:Dr,weight:$r,preResolvedFonts:Br,unicodeFontsURL:Jr},mn){const Mn=({chars:$n,fonts:en})=>{let In,Rn;const qn=[];for(let Qn=0;Qn<$n.length;Qn++)$n[Qn]!==Rn?(Rn=$n[Qn],qn.push(In={start:Qn,end:Qn,fontObj:en[$n[Qn]]})):In.end=Qn;mn(qn)};Br?Mn(Br):rt(cr,Mn,{lang:Ar,fonts:_r,style:Dr,weight:$r,unicodeFontsURL:Jr})}function Bt({text:cr="",font:Ar,lang:_r,sdfGlyphSize:Dr=64,fontSize:$r=400,fontWeight:Br=1,fontStyle:Jr="normal",letterSpacing:mn=0,lineHeight:Mn="normal",maxWidth:$n=1/0,direction:en,textAlign:In="left",textIndent:Rn=0,whiteSpace:qn="normal",overflowWrap:Qn="normal",anchorX:xs=0,anchorY:cs=0,metricsOnly:ks=!1,unicodeFontsURL:_o,preResolvedFonts:qs=null,includeCaretPositions:Ss=!1,chunkedBoundsSize:eo=8192,colorRanges:Ao=null},Oo){const uo=rr(),uu={fontLoad:0,typesetting:0};cr.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),cr=cr.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),$r=+$r,mn=+mn,$n=+$n,Mn=Mn||"normal",Rn=+Rn,Mt({text:cr,lang:_r,style:Jr,weight:Br,fonts:typeof Ar=="string"?[{src:Ar}]:Ar,unicodeFontsURL:_o,preResolvedFonts:qs},cu=>{uu.fontLoad=rr()-uo;const Jl=isFinite($n);let mu=null,pu=null,Zu=null,Mp=null,Up=null,Ep=null,mp=null,Cp=null,t0=0,_g=0,m0=qn!=="nowrap";const K0=new Map,Jp=rr();let y0=Rn,z0=0,jm=new sr;const Nu=[jm];cu.forEach(T0=>{const{fontObj:av}=T0,{ascender:lv,descender:N0,unitsPerEm:zv,lineGap:Uv,capHeight:Gv,xHeight:Dv}=av;let Cv=K0.get(av);if(!Cv){const Fp=$r/zv,nv=Mn==="normal"?(lv-N0+Uv)*Fp:Mn*$r,qy=(nv-(lv-N0)*Fp)/2,Uy=Math.min(nv,(lv-N0)*Fp),vx=(lv+N0)/2*Fp+Uy/2;Cv={index:K0.size,src:av.src,fontObj:av,fontSizeMult:Fp,unitsPerEm:zv,ascender:lv*Fp,descender:N0*Fp,capHeight:Gv*Fp,xHeight:Dv*Fp,lineHeight:nv,baseline:-qy-lv*Fp,caretTop:vx,caretBottom:vx-Uy},K0.set(av,Cv)}const{fontSizeMult:Kp}=Cv,sv=cr.slice(T0.start,T0.end+1);let Hv,jp;av.forEachGlyph(sv,$r,mn,(Fp,nv,qy,Uy)=>{nv+=z0,Uy+=T0.start,Hv=nv,jp=Fp;const vx=cr.charAt(Uy),qx=Fp.advanceWidth*Kp,Kx=jm.count;let Mx;if("isEmpty"in Fp||(Fp.isWhitespace=!!vx&&new RegExp(bt).test(vx),Fp.canBreakAfter=!!vx&&St.test(vx),Fp.isEmpty=Fp.xMin===Fp.xMax||Fp.yMin===Fp.yMax||mt.test(vx)),!Fp.isWhitespace&&!Fp.isEmpty&&_g++,m0&&Jl&&!Fp.isWhitespace&&nv+qx+y0>$n&&Kx){if(jm.glyphAt(Kx-1).glyphObj.canBreakAfter)Mx=new sr,y0=-nv;else for(let E2=Kx;E2--;)if(E2===0&&Qn==="break-word"){Mx=new sr,y0=-nv;break}else if(jm.glyphAt(E2).glyphObj.canBreakAfter){Mx=jm.splitAt(E2+1);const $2=Mx.glyphAt(0).x;y0-=$2;for(let X2=Mx.count;X2--;)Mx.glyphAt(X2).x-=$2;break}Mx&&(jm.isSoftWrapped=!0,jm=Mx,Nu.push(jm),t0=$n)}let Ox=jm.glyphAt(jm.count);Ox.glyphObj=Fp,Ox.x=nv+y0,Ox.y=qy,Ox.width=qx,Ox.charIndex=Uy,Ox.fontData=Cv,vx===`
`&&(jm=new sr,Nu.push(jm),y0=-(nv+qx+mn*$r)+Rn)}),z0=Hv+jp.advanceWidth*Kp+mn*$r});let Co=0;Nu.forEach(T0=>{let av=!0;for(let lv=T0.count;lv--;){const N0=T0.glyphAt(lv);av&&!N0.glyphObj.isWhitespace&&(T0.width=N0.x+N0.width,T0.width>t0&&(t0=T0.width),av=!1);let{lineHeight:zv,capHeight:Uv,xHeight:Gv,baseline:Dv}=N0.fontData;zv>T0.lineHeight&&(T0.lineHeight=zv);const Cv=Dv-T0.baseline;Cv<0&&(T0.baseline+=Cv,T0.cap+=Cv,T0.ex+=Cv),T0.cap=Math.max(T0.cap,T0.baseline+Uv),T0.ex=Math.max(T0.ex,T0.baseline+Gv)}T0.baseline-=Co,T0.cap-=Co,T0.ex-=Co,Co+=T0.lineHeight});let Bp=0,a0=0;if(xs&&(typeof xs=="number"?Bp=-xs:typeof xs=="string"&&(Bp=-t0*(xs==="left"?0:xs==="center"?.5:xs==="right"?1:Ht(xs)))),cs&&(typeof cs=="number"?a0=-cs:typeof cs=="string"&&(a0=cs==="top"?0:cs==="top-baseline"?-Nu[0].baseline:cs==="top-cap"?-Nu[0].cap:cs==="top-ex"?-Nu[0].ex:cs==="middle"?Co/2:cs==="bottom"?Co:cs==="bottom-baseline"?-Nu[Nu.length-1].baseline:Ht(cs)*Co)),!ks){const T0=_.getEmbeddingLevels(cr,en);mu=new Uint16Array(_g),pu=new Uint8Array(_g),Zu=new Float32Array(_g*2),Mp={},mp=[1/0,1/0,-1/0,-1/0],Cp=[],Ss&&(Ep=new Float32Array(cr.length*4)),Ao&&(Up=new Uint8Array(_g*3));let av=0,lv=-1,N0=-1,zv,Uv;if(Nu.forEach((Gv,Dv)=>{let{count:Cv,width:Kp}=Gv;if(Cv>0){let sv=0;for(let Uy=Cv;Uy--&&Gv.glyphAt(Uy).glyphObj.isWhitespace;)sv++;let Hv=0,jp=0;if(In==="center")Hv=(t0-Kp)/2;else if(In==="right")Hv=t0-Kp;else if(In==="justify"&&Gv.isSoftWrapped){let Uy=0;for(let vx=Cv-sv;vx--;)Gv.glyphAt(vx).glyphObj.isWhitespace&&Uy++;jp=(t0-Kp)/Uy}if(jp||Hv){let Uy=0;for(let vx=0;vx<Cv;vx++){let qx=Gv.glyphAt(vx);const Kx=qx.glyphObj;qx.x+=Hv+Uy,jp!==0&&Kx.isWhitespace&&vx<Cv-sv&&(Uy+=jp,qx.width+=jp)}}const Fp=_.getReorderSegments(cr,T0,Gv.glyphAt(0).charIndex,Gv.glyphAt(Gv.count-1).charIndex);for(let Uy=0;Uy<Fp.length;Uy++){const[vx,qx]=Fp[Uy];let Kx=1/0,Mx=-1/0;for(let Ox=0;Ox<Cv;Ox++)if(Gv.glyphAt(Ox).charIndex>=vx){let E2=Ox,$2=Ox;for(;$2<Cv;$2++){let X2=Gv.glyphAt($2);if(X2.charIndex>qx)break;$2<Cv-sv&&(Kx=Math.min(Kx,X2.x),Mx=Math.max(Mx,X2.x+X2.width))}for(let X2=E2;X2<$2;X2++){const _E=Gv.glyphAt(X2);_E.x=Mx-(_E.x+_E.width-Kx)}break}}let nv;const qy=Uy=>nv=Uy;for(let Uy=0;Uy<Cv;Uy++){const vx=Gv.glyphAt(Uy);nv=vx.glyphObj;const qx=nv.index,Kx=T0.levels[vx.charIndex]&1;if(Kx){const Mx=_.getMirroredCharacter(cr[vx.charIndex]);Mx&&vx.fontData.fontObj.forEachGlyph(Mx,0,0,qy)}if(Ss){const{charIndex:Mx,fontData:Ox}=vx,E2=vx.x+Bp,$2=vx.x+vx.width+Bp;Ep[Mx*4]=Kx?$2:E2,Ep[Mx*4+1]=Kx?E2:$2,Ep[Mx*4+2]=Gv.baseline+Ox.caretBottom+a0,Ep[Mx*4+3]=Gv.baseline+Ox.caretTop+a0;const X2=Mx-lv;X2>1&&tr(Ep,lv,X2),lv=Mx}if(Ao){const{charIndex:Mx}=vx;for(;Mx>N0;)N0++,Ao.hasOwnProperty(N0)&&(Uv=Ao[N0])}if(!nv.isWhitespace&&!nv.isEmpty){const Mx=av++,{fontSizeMult:Ox,src:E2,index:$2}=vx.fontData,X2=Mp[E2]||(Mp[E2]={});X2[qx]||(X2[qx]={path:nv.path,pathBounds:[nv.xMin,nv.yMin,nv.xMax,nv.yMax]});const _E=vx.x+Bp,mE=vx.y+Gv.baseline+a0;Zu[Mx*2]=_E,Zu[Mx*2+1]=mE;const Pp=_E+nv.xMin*Ox,tv=mE+nv.yMin*Ox,ov=_E+nv.xMax*Ox,p0=mE+nv.yMax*Ox;Pp<mp[0]&&(mp[0]=Pp),tv<mp[1]&&(mp[1]=tv),ov>mp[2]&&(mp[2]=ov),p0>mp[3]&&(mp[3]=p0),Mx%eo===0&&(zv={start:Mx,end:Mx,rect:[1/0,1/0,-1/0,-1/0]},Cp.push(zv)),zv.end++;const bv=zv.rect;if(Pp<bv[0]&&(bv[0]=Pp),tv<bv[1]&&(bv[1]=tv),ov>bv[2]&&(bv[2]=ov),p0>bv[3]&&(bv[3]=p0),mu[Mx]=qx,pu[Mx]=$2,Ao){const Dx=Mx*3;Up[Dx]=Uv>>16&255,Up[Dx+1]=Uv>>8&255,Up[Dx+2]=Uv&255}}}}}),Ep){const Gv=cr.length-lv;Gv>1&&tr(Ep,lv,Gv)}}const Q0=[];K0.forEach(({index:T0,src:av,unitsPerEm:lv,ascender:N0,descender:zv,lineHeight:Uv,capHeight:Gv,xHeight:Dv})=>{Q0[T0]={src:av,unitsPerEm:lv,ascender:N0,descender:zv,lineHeight:Uv,capHeight:Gv,xHeight:Dv}}),uu.typesetting=rr()-Jp,Oo({glyphIds:mu,glyphFontIndices:pu,glyphPositions:Zu,glyphData:Mp,fontData:Q0,caretPositions:Ep,glyphColors:Up,chunkedBounds:Cp,fontSize:$r,topBaseline:a0+Nu[0].baseline,blockBounds:[Bp,a0-Co,Bp+t0,a0],visibleBounds:mp,timings:uu})})}function Ut(cr,Ar){Bt({...cr,metricsOnly:!0},_r=>{const[Dr,$r,Br,Jr]=_r.blockBounds;Ar({width:Br-Dr,height:Jr-$r})})}function Ht(cr){let Ar=cr.match(/^([\d.]+)%$/),_r=Ar?parseFloat(Ar[1]):NaN;return isNaN(_r)?0:_r/100}function tr(cr,Ar,_r){const Dr=cr[Ar*4],$r=cr[Ar*4+1],Br=cr[Ar*4+2],Jr=cr[Ar*4+3],mn=($r-Dr)/_r;for(let Mn=0;Mn<_r;Mn++){const $n=(Ar+Mn)*4;cr[$n]=Dr+mn*Mn,cr[$n+1]=Dr+mn*(Mn+1),cr[$n+2]=Br,cr[$n+3]=Jr}}function rr(){return(self.performance||Date).now()}function sr(){this.data=[]}const ar=["glyphObj","x","y","width","charIndex","fontData"];return sr.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/ar.length)},glyphAt(cr){let Ar=sr.flyweight;return Ar.data=this.data,Ar.index=cr,Ar},splitAt(cr){let Ar=new sr;return Ar.data=this.data.splice(cr*ar.length),Ar}},sr.flyweight=ar.reduce((cr,Ar,_r,Dr)=>(Object.defineProperty(cr,Ar,{get(){return this.data[this.index*ar.length+_r]},set($r){this.data[this.index*ar.length+_r]=$r}}),cr),{data:null,index:0}),{typeset:Bt,measure:Ut}}const now$2=()=>(self.performance||Date).now(),mainThreadGenerator=SDFGenerator();let warned;function generateSDF(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr=!0){return tr?generateSDF_GL(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht).then(null,rr=>(warned||(console.warn("WebGL SDF generation failed, falling back to JS",rr),warned=!0),generateSDF_JS_Worker(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht))):generateSDF_JS_Worker(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht)}const queue=[],chunkTimeBudget=5;let timer=0;function nextChunk(){const rt=now$2();for(;queue.length&&now$2()-rt<chunkTimeBudget;)queue.shift()();timer=queue.length?setTimeout(nextChunk,0):0}const generateSDF_GL=(...rt)=>new Promise((_,ut)=>{queue.push(()=>{const mt=now$2();try{mainThreadGenerator.webgl.generateIntoCanvas(...rt),_({timing:now$2()-mt})}catch(bt){ut(bt)}}),timer||(timer=setTimeout(nextChunk,0))}),threadCount=4,idleTimeout=2e3,threads={};let callNum=0;function generateSDF_JS_Worker(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht){const tr="TroikaTextSDFGenerator_JS_"+callNum++%threadCount;let rr=threads[tr];return rr||(rr=threads[tr]={workerModule:defineWorkerModule({name:tr,workerId:tr,dependencies:[SDFGenerator,now$2],init(sr,ar){const cr=sr().javascript.generate;return function(...Ar){const _r=ar();return{textureData:cr(...Ar),timing:ar()-_r}}},getTransferables(sr){return[sr.textureData.buffer]}}),requests:0,idleTimer:null}),rr.requests++,clearTimeout(rr.idleTimer),rr.workerModule(rt,_,ut,mt,bt,St).then(({textureData:sr,timing:ar})=>{const cr=now$2(),Ar=new Uint8Array(sr.length*4);for(let _r=0;_r<sr.length;_r++)Ar[_r*4+Ht]=sr[_r];return mainThreadGenerator.webglUtils.renderImageData(Mt,Ar,Bt,Ut,rt,_,1<<3-Ht),ar+=now$2()-cr,--rr.requests===0&&(rr.idleTimer=setTimeout(()=>{terminateWorker(tr)},idleTimeout)),{timing:ar}})}function warmUpSDFCanvas(rt){rt._warm||(mainThreadGenerator.webgl.isSupported(rt),rt._warm=!0)}const resizeWebGLCanvasWithoutClearing=mainThreadGenerator.webglUtils.resizeWebGLCanvasWithoutClearing,CONFIG={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},tempColor=new Color$1;function now$1$1(){return(self.performance||Date).now()}const atlases=Object.create(null);function getTextRenderInfo(rt,_){rt=assign$2({},rt);const ut=now$1$1(),{defaultFontURL:mt}=CONFIG,bt=[];if(mt&&bt.push({label:"default",src:toAbsoluteURL(mt)}),rt.font&&bt.push({label:"user",src:toAbsoluteURL(rt.font)}),rt.font=bt,rt.text=""+rt.text,rt.sdfGlyphSize=rt.sdfGlyphSize||CONFIG.sdfGlyphSize,rt.unicodeFontsURL=rt.unicodeFontsURL||CONFIG.unicodeFontsURL,rt.colorRanges!=null){let sr={};for(let ar in rt.colorRanges)if(rt.colorRanges.hasOwnProperty(ar)){let cr=rt.colorRanges[ar];typeof cr!="number"&&(cr=tempColor.set(cr).getHex()),sr[ar]=cr}rt.colorRanges=sr}Object.freeze(rt);const{textureWidth:St,sdfExponent:Mt}=CONFIG,{sdfGlyphSize:Bt}=rt,Ut=St/Bt*4;let Ht=atlases[Bt];if(!Ht){const sr=document.createElement("canvas");sr.width=St,sr.height=Bt*256/Ut,Ht=atlases[Bt]={glyphCount:0,sdfGlyphSize:Bt,sdfCanvas:sr,sdfTexture:new Texture(sr,void 0,void 0,void 0,LinearFilter,LinearFilter),contextLost:!1,glyphsByFont:new Map},Ht.sdfTexture.generateMipmaps=!1,initContextLossHandling(Ht)}const{sdfTexture:tr,sdfCanvas:rr}=Ht;typesetInWorker(rt).then(sr=>{const{glyphIds:ar,glyphFontIndices:cr,fontData:Ar,glyphPositions:_r,fontSize:Dr,timings:$r}=sr,Br=[],Jr=new Float32Array(ar.length*4);let mn=0,Mn=0;const $n=now$1$1(),en=Ar.map(xs=>{let cs=Ht.glyphsByFont.get(xs.src);return cs||Ht.glyphsByFont.set(xs.src,cs=new Map),cs});ar.forEach((xs,cs)=>{const ks=cr[cs],{src:_o,unitsPerEm:qs}=Ar[ks];let Ss=en[ks].get(xs);if(!Ss){const{path:uu,pathBounds:cu}=sr.glyphData[_o][xs],Jl=Math.max(cu[2]-cu[0],cu[3]-cu[1])/Bt*(CONFIG.sdfMargin*Bt+.5),mu=Ht.glyphCount++,pu=[cu[0]-Jl,cu[1]-Jl,cu[2]+Jl,cu[3]+Jl];en[ks].set(xs,Ss={path:uu,atlasIndex:mu,sdfViewBox:pu}),Br.push(Ss)}const{sdfViewBox:eo}=Ss,Ao=_r[Mn++],Oo=_r[Mn++],uo=Dr/qs;Jr[mn++]=Ao+eo[0]*uo,Jr[mn++]=Oo+eo[1]*uo,Jr[mn++]=Ao+eo[2]*uo,Jr[mn++]=Oo+eo[3]*uo,ar[cs]=Ss.atlasIndex}),$r.quads=($r.quads||0)+(now$1$1()-$n);const In=now$1$1();$r.sdf={};const Rn=rr.height,qn=Math.ceil(Ht.glyphCount/Ut),Qn=Math.pow(2,Math.ceil(Math.log2(qn*Bt)));Qn>Rn&&(console.info(`Increasing SDF texture size ${Rn}->${Qn}`),resizeWebGLCanvasWithoutClearing(rr,St,Qn),tr.dispose()),Promise.all(Br.map(xs=>generateGlyphSDF(xs,Ht,rt.gpuAccelerateSDF).then(({timing:cs})=>{$r.sdf[xs.atlasIndex]=cs}))).then(()=>{Br.length&&!Ht.contextLost&&(safariPre15Workaround(Ht),tr.needsUpdate=!0),$r.sdfTotal=now$1$1()-In,$r.total=now$1$1()-ut,_(Object.freeze({parameters:rt,sdfTexture:tr,sdfGlyphSize:Bt,sdfExponent:Mt,glyphBounds:Jr,glyphAtlasIndices:ar,glyphColors:sr.glyphColors,caretPositions:sr.caretPositions,chunkedBounds:sr.chunkedBounds,ascender:sr.ascender,descender:sr.descender,lineHeight:sr.lineHeight,capHeight:sr.capHeight,xHeight:sr.xHeight,topBaseline:sr.topBaseline,blockBounds:sr.blockBounds,visibleBounds:sr.visibleBounds,timings:sr.timings}))})}),Promise.resolve().then(()=>{Ht.contextLost||warmUpSDFCanvas(rr)})}function generateGlyphSDF({path:rt,atlasIndex:_,sdfViewBox:ut},{sdfGlyphSize:mt,sdfCanvas:bt,contextLost:St},Mt){if(St)return Promise.resolve({timing:-1});const{textureWidth:Bt,sdfExponent:Ut}=CONFIG,Ht=Math.max(ut[2]-ut[0],ut[3]-ut[1]),tr=Math.floor(_/4),rr=tr%(Bt/mt)*mt,sr=Math.floor(tr/(Bt/mt))*mt,ar=_%4;return generateSDF(mt,mt,rt,ut,Ht,Ut,bt,rr,sr,ar,Mt)}function initContextLossHandling(rt){const _=rt.sdfCanvas;_.addEventListener("webglcontextlost",ut=>{console.log("Context Lost",ut),ut.preventDefault(),rt.contextLost=!0}),_.addEventListener("webglcontextrestored",ut=>{console.log("Context Restored",ut),rt.contextLost=!1;const mt=[];rt.glyphsByFont.forEach(bt=>{bt.forEach(St=>{mt.push(generateGlyphSDF(St,rt,!0))})}),Promise.all(mt).then(()=>{safariPre15Workaround(rt),rt.sdfTexture.needsUpdate=!0})})}function preloadFont({font:rt,characters:_,sdfGlyphSize:ut},mt){let bt=Array.isArray(_)?_.join(`
`):""+_;getTextRenderInfo({font:rt,sdfGlyphSize:ut,text:bt},mt)}function assign$2(rt,_){for(let ut in _)_.hasOwnProperty(ut)&&(rt[ut]=_[ut]);return rt}let linkEl;function toAbsoluteURL(rt){return linkEl||(linkEl=typeof document>"u"?{}:document.createElement("a")),linkEl.href=rt,linkEl.href}function safariPre15Workaround(rt){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:_,sdfTexture:ut}=rt,{width:mt,height:bt}=_,St=rt.sdfCanvas.getContext("webgl");let Mt=ut.image.data;(!Mt||Mt.length!==mt*bt*4)&&(Mt=new Uint8Array(mt*bt*4),ut.image={width:mt,height:bt,data:Mt},ut.flipY=!1,ut.isDataTexture=!0),St.readPixels(0,0,mt,bt,St.RGBA,St.UNSIGNED_BYTE,Mt)}}const typesetterWorkerModule=defineWorkerModule({name:"Typesetter",dependencies:[createTypesetter,fontResolverWorkerModule,bidiFactory],init(rt,_,ut){return rt(_,ut())}}),typesetInWorker=defineWorkerModule({name:"Typesetter",dependencies:[typesetterWorkerModule],init(rt){return function(_){return new Promise(ut=>{rt.typeset(_,ut)})}},getTransferables(rt){const _=[];for(let ut in rt)rt[ut]&&rt[ut].buffer&&_.push(rt[ut].buffer);return _}}),templateGeometries={};function getTemplateGeometry(rt){let _=templateGeometries[rt];if(!_){const ut=new PlaneGeometry(1,1,rt,rt),mt=ut.clone(),bt=ut.attributes,St=mt.attributes,Mt=new BufferGeometry,Bt=bt.uv.count;for(let Ut=0;Ut<Bt;Ut++)St.position.array[Ut*3]*=-1,St.normal.array[Ut*3+2]*=-1;["position","normal","uv"].forEach(Ut=>{Mt.setAttribute(Ut,new Float32BufferAttribute([...bt[Ut].array,...St[Ut].array],bt[Ut].itemSize))}),Mt.setIndex([...ut.index.array,...mt.index.array.map(Ut=>Ut+Bt)]),Mt.translate(.5,.5,0),_=templateGeometries[rt]=Mt}return _}const glyphBoundsAttrName="aTroikaGlyphBounds",glyphIndexAttrName="aTroikaGlyphIndex",glyphColorAttrName="aTroikaGlyphColor";class GlyphsGeometry extends InstancedBufferGeometry{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Sphere$1,this.boundingBox=new Box3}computeBoundingSphere(){}computeBoundingBox(){}setSide(_){const ut=this.getIndex().count;this.setDrawRange(_===BackSide?ut/2:0,_===DoubleSide?ut:ut/2)}set detail(_){if(_!==this._detail){this._detail=_,(typeof _!="number"||_<1)&&(_=1);let ut=getTemplateGeometry(_);["position","normal","uv"].forEach(mt=>{this.attributes[mt]=ut.attributes[mt].clone()}),this.setIndex(ut.getIndex().clone())}}get detail(){return this._detail}set curveRadius(_){_!==this._curveRadius&&(this._curveRadius=_,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(_,ut,mt,bt,St){updateBufferAttr(this,glyphBoundsAttrName,_,4),updateBufferAttr(this,glyphIndexAttrName,ut,1),updateBufferAttr(this,glyphColorAttrName,St,3),this._blockBounds=mt,this._chunkedBounds=bt,this.instanceCount=ut.length,this._updateBounds()}_updateBounds(){const _=this._blockBounds;if(_){const{curveRadius:ut,boundingBox:mt}=this;if(ut){const{PI:bt,floor:St,min:Mt,max:Bt,sin:Ut,cos:Ht}=Math,tr=bt/2,rr=bt*2,sr=Math.abs(ut),ar=_[0]/sr,cr=_[2]/sr,Ar=St((ar+tr)/rr)!==St((cr+tr)/rr)?-sr:Mt(Ut(ar)*sr,Ut(cr)*sr),_r=St((ar-tr)/rr)!==St((cr-tr)/rr)?sr:Bt(Ut(ar)*sr,Ut(cr)*sr),Dr=St((ar+bt)/rr)!==St((cr+bt)/rr)?sr*2:Bt(sr-Ht(ar)*sr,sr-Ht(cr)*sr);mt.min.set(Ar,_[1],ut<0?-Dr:0),mt.max.set(_r,_[3],ut<0?0:Dr)}else mt.min.set(_[0],_[1],0),mt.max.set(_[2],_[3],0);mt.getBoundingSphere(this.boundingSphere)}}applyClipRect(_){let ut=this.getAttribute(glyphIndexAttrName).count,mt=this._chunkedBounds;if(mt)for(let bt=mt.length;bt--;){ut=mt[bt].end;let St=mt[bt].rect;if(St[1]<_.w&&St[3]>_.y&&St[0]<_.z&&St[2]>_.x)break}this.instanceCount=ut}}function updateBufferAttr(rt,_,ut,mt){const bt=rt.getAttribute(_);ut?bt&&bt.array.length===ut.length?(bt.array.set(ut),bt.needsUpdate=!0):(rt.setAttribute(_,new InstancedBufferAttribute(ut,mt)),delete rt._maxInstanceCount,rt.dispose()):bt&&rt.deleteAttribute(_)}const VERTEX_DEFS=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,VERTEX_TRANSFORM=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,FRAGMENT_DEFS=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,FRAGMENT_TRANSFORM=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function createTextDerivedMaterial(rt){const _=createDerivedMaterial(rt,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Vector2},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Vector4(0,0,0,0)},uTroikaClipRect:{value:new Vector4(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Vector2},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Color$1},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Matrix3},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:VERTEX_DEFS,vertexTransform:VERTEX_TRANSFORM,fragmentDefs:FRAGMENT_DEFS,fragmentColorTransform:FRAGMENT_TRANSFORM,customRewriter({vertexShader:ut,fragmentShader:mt}){let bt=/\buniform\s+vec3\s+diffuse\b/;return bt.test(mt)&&(mt=mt.replace(bt,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),bt.test(ut)||(ut=ut.replace(voidMainRegExp,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:ut,fragmentShader:mt}}});return _.transparent=!0,Object.defineProperties(_,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),_}const defaultMaterial=new MeshBasicMaterial({color:16777215,side:DoubleSide,transparent:!0}),defaultStrokeColor=8421504,tempMat4=new Matrix4,tempVec3a=new Vector3,tempVec3b=new Vector3,tempArray=[],origin=new Vector3,defaultOrient="+x+y";function first(rt){return Array.isArray(rt)?rt[0]:rt}let getFlatRaycastMesh=()=>{const rt=new Mesh(new PlaneGeometry(1,1),defaultMaterial);return getFlatRaycastMesh=()=>rt,rt},getCurvedRaycastMesh=()=>{const rt=new Mesh(new PlaneGeometry(1,1,32,1),defaultMaterial);return getCurvedRaycastMesh=()=>rt,rt};const syncStartEvent={type:"syncstart"},syncCompleteEvent={type:"synccomplete"},SYNCABLE_PROPS=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],COPYABLE_PROPS=SYNCABLE_PROPS.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Text$1=class extends Mesh{constructor(){const _=new GlyphsGeometry;super(_,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=defaultStrokeColor,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=defaultOrient,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(_){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(_):(this._isSyncing=!0,this.dispatchEvent(syncStartEvent),getTextRenderInfo({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},ut=>{this._isSyncing=!1,this._textRenderInfo=ut,this.geometry.updateGlyphs(ut.glyphBounds,ut.glyphAtlasIndices,ut.blockBounds,ut.chunkedBounds,ut.glyphColors);const mt=this._queuedSyncs;mt&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{mt.forEach(bt=>bt&&bt())})),this.dispatchEvent(syncCompleteEvent),_&&_()})))}onBeforeRender(_,ut,mt,bt,St,Mt){this.sync(),St.isTroikaTextMaterial&&this._prepareForRender(St),St._hadOwnSide=St.hasOwnProperty("side"),this.geometry.setSide(St._actualSide=St.side),St.side=FrontSide}onAfterRender(_,ut,mt,bt,St,Mt){St._hadOwnSide?St.side=St._actualSide:delete St.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let _=this._derivedMaterial;const ut=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=defaultMaterial.clone());if((!_||_.baseMaterial!==ut)&&(_=this._derivedMaterial=createTextDerivedMaterial(ut),ut.addEventListener("dispose",function mt(){ut.removeEventListener("dispose",mt),_.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let mt=_._outlineMtl;return mt||(mt=_._outlineMtl=Object.create(_,{id:{value:_.id+.1}}),mt.isTextOutlineMaterial=!0,mt.depthWrite=!1,mt.map=null,_.addEventListener("dispose",function bt(){_.removeEventListener("dispose",bt),mt.dispose()})),[mt,_]}else return _}set material(_){_&&_.isTroikaTextMaterial?(this._derivedMaterial=_,this._baseMaterial=_.baseMaterial):this._baseMaterial=_}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(_){this.geometry.detail=_}get curveRadius(){return this.geometry.curveRadius}set curveRadius(_){this.geometry.curveRadius=_}get customDepthMaterial(){return first(this.material).getDepthMaterial()}get customDistanceMaterial(){return first(this.material).getDistanceMaterial()}_prepareForRender(_){const ut=_.isTextOutlineMaterial,mt=_.uniforms,bt=this.textRenderInfo;if(bt){const{sdfTexture:Bt,blockBounds:Ut}=bt;mt.uTroikaSDFTexture.value=Bt,mt.uTroikaSDFTextureSize.value.set(Bt.image.width,Bt.image.height),mt.uTroikaSDFGlyphSize.value=bt.sdfGlyphSize,mt.uTroikaSDFExponent.value=bt.sdfExponent,mt.uTroikaTotalBounds.value.fromArray(Ut),mt.uTroikaUseGlyphColors.value=!ut&&!!bt.glyphColors;let Ht=0,tr=0,rr=0,sr,ar,cr,Ar=0,_r=0;if(ut){let{outlineWidth:$r,outlineOffsetX:Br,outlineOffsetY:Jr,outlineBlur:mn,outlineOpacity:Mn}=this;Ht=this._parsePercent($r)||0,tr=Math.max(0,this._parsePercent(mn)||0),sr=Mn,Ar=this._parsePercent(Br)||0,_r=this._parsePercent(Jr)||0}else rr=Math.max(0,this._parsePercent(this.strokeWidth)||0),rr&&(cr=this.strokeColor,mt.uTroikaStrokeColor.value.set(cr??defaultStrokeColor),ar=this.strokeOpacity,ar==null&&(ar=1)),sr=this.fillOpacity;mt.uTroikaDistanceOffset.value=Ht,mt.uTroikaPositionOffset.value.set(Ar,_r),mt.uTroikaBlurRadius.value=tr,mt.uTroikaStrokeWidth.value=rr,mt.uTroikaStrokeOpacity.value=ar,mt.uTroikaFillOpacity.value=sr??1,mt.uTroikaCurveRadius.value=this.curveRadius||0;let Dr=this.clipRect;if(Dr&&Array.isArray(Dr)&&Dr.length===4)mt.uTroikaClipRect.value.fromArray(Dr);else{const $r=(this.fontSize||.1)*100;mt.uTroikaClipRect.value.set(Ut[0]-$r,Ut[1]-$r,Ut[2]+$r,Ut[3]+$r)}this.geometry.applyClipRect(mt.uTroikaClipRect.value)}mt.uTroikaSDFDebug.value=!!this.debugSDF,_.polygonOffset=!!this.depthOffset,_.polygonOffsetFactor=_.polygonOffsetUnits=this.depthOffset||0;const St=ut?this.outlineColor||0:this.color;if(St==null)delete _.color;else{const Bt=_.hasOwnProperty("color")?_.color:_.color=new Color$1;(St!==Bt._input||typeof St=="object")&&Bt.set(Bt._input=St)}let Mt=this.orientation||defaultOrient;if(Mt!==_._orientation){let Bt=mt.uTroikaOrient.value;Mt=Mt.replace(/[^-+xyz]/g,"");let Ut=Mt!==defaultOrient&&Mt.match(/^([-+])([xyz])([-+])([xyz])$/);if(Ut){let[,Ht,tr,rr,sr]=Ut;tempVec3a.set(0,0,0)[tr]=Ht==="-"?1:-1,tempVec3b.set(0,0,0)[sr]=rr==="-"?-1:1,tempMat4.lookAt(origin,tempVec3a.cross(tempVec3b),tempVec3b),Bt.setFromMatrix4(tempMat4)}else Bt.identity();_._orientation=Mt}}_parsePercent(_){if(typeof _=="string"){let ut=_.match(/^(-?[\d.]+)%$/),mt=ut?parseFloat(ut[1]):NaN;_=(isNaN(mt)?0:mt/100)*this.fontSize}return _}localPositionToTextCoords(_,ut=new Vector2){ut.copy(_);const mt=this.curveRadius;return mt&&(ut.x=Math.atan2(_.x,Math.abs(mt)-Math.abs(_.z))*Math.abs(mt)),ut}worldPositionToTextCoords(_,ut=new Vector2){return tempVec3a.copy(_),this.localPositionToTextCoords(this.worldToLocal(tempVec3a),ut)}raycast(_,ut){const{textRenderInfo:mt,curveRadius:bt}=this;if(mt){const St=mt.blockBounds,Mt=bt?getCurvedRaycastMesh():getFlatRaycastMesh(),Bt=Mt.geometry,{position:Ut,uv:Ht}=Bt.attributes;for(let tr=0;tr<Ht.count;tr++){let rr=St[0]+Ht.getX(tr)*(St[2]-St[0]);const sr=St[1]+Ht.getY(tr)*(St[3]-St[1]);let ar=0;bt&&(ar=bt-Math.cos(rr/bt)*bt,rr=Math.sin(rr/bt)*bt),Ut.setXYZ(tr,rr,sr,ar)}Bt.boundingSphere=this.geometry.boundingSphere,Bt.boundingBox=this.geometry.boundingBox,Mt.matrixWorld=this.matrixWorld,Mt.material.side=this.material.side,tempArray.length=0,Mt.raycast(_,tempArray);for(let tr=0;tr<tempArray.length;tr++)tempArray[tr].object=this,ut.push(tempArray[tr])}}copy(_){const ut=this.geometry;return super.copy(_),this.geometry=ut,COPYABLE_PROPS.forEach(mt=>{this[mt]=_[mt]}),this}clone(){return new this.constructor().copy(this)}};SYNCABLE_PROPS.forEach(rt=>{const _="_private_"+rt;Object.defineProperty(Text$1.prototype,rt,{get(){return this[_]},set(ut){ut!==this[_]&&(this[_]=ut,this._needsSync=!0)}})});const isPromise=rt=>typeof rt=="object"&&typeof rt.then=="function",globalCache=[];function shallowEqualArrays(rt,_,ut=(mt,bt)=>mt===bt){if(rt===_)return!0;if(!rt||!_)return!1;const mt=rt.length;if(_.length!==mt)return!1;for(let bt=0;bt<mt;bt++)if(!ut(rt[bt],_[bt]))return!1;return!0}function query(rt,_=null,ut=!1,mt={}){_===null&&(_=[rt]);for(const St of globalCache)if(shallowEqualArrays(_,St.keys,St.equal)){if(ut)return;if(Object.prototype.hasOwnProperty.call(St,"error"))throw St.error;if(Object.prototype.hasOwnProperty.call(St,"response"))return mt.lifespan&&mt.lifespan>0&&(St.timeout&&clearTimeout(St.timeout),St.timeout=setTimeout(St.remove,mt.lifespan)),St.response;if(!ut)throw St.promise}const bt={keys:_,equal:mt.equal,remove:()=>{const St=globalCache.indexOf(bt);St!==-1&&globalCache.splice(St,1)},promise:(isPromise(rt)?rt:rt(..._)).then(St=>{bt.response=St,mt.lifespan&&mt.lifespan>0&&(bt.timeout=setTimeout(bt.remove,mt.lifespan))}).catch(St=>bt.error=St)};if(globalCache.push(bt),!ut)throw bt.promise}const suspend=(rt,_,ut)=>query(rt,_,!1,ut),Text=reactExports.forwardRef(({sdfGlyphSize:rt=64,anchorX:_="center",anchorY:ut="middle",font:mt,fontSize:bt=1,children:St,characters:Mt,onSync:Bt,...Ut},Ht)=>{const tr=useThree(({invalidate:cr})=>cr),[rr]=reactExports.useState(()=>new Text$1),[sr,ar]=reactExports.useMemo(()=>{const cr=[];let Ar="";return reactExports.Children.forEach(St,_r=>{typeof _r=="string"||typeof _r=="number"?Ar+=_r:cr.push(_r)}),[cr,Ar]},[St]);return suspend(()=>new Promise(cr=>preloadFont({font:mt,characters:Mt},cr)),["troika-text",mt,Mt]),reactExports.useLayoutEffect(()=>void rr.sync(()=>{tr(),Bt&&Bt(rr)})),reactExports.useEffect(()=>()=>rr.dispose(),[rr]),reactExports.createElement("primitive",_extends$4({object:rr,ref:Ht,font:mt,text:ar,anchorX:_,anchorY:ut,fontSize:bt,sdfGlyphSize:rt},Ut),sr)});function shaderMaterial(rt,_,ut,mt){const bt=class extends ShaderMaterial{constructor(Mt={}){const Bt=Object.entries(rt);super({uniforms:Bt.reduce((Ut,[Ht,tr])=>{const rr=UniformsUtils.clone({[Ht]:{value:tr}});return{...Ut,...rr}},{}),vertexShader:_,fragmentShader:ut}),this.key="",Bt.forEach(([Ut])=>Object.defineProperty(this,Ut,{get:()=>this.uniforms[Ut].value,set:Ht=>this.uniforms[Ut].value=Ht})),Object.assign(this,Mt)}};return bt.key=MathUtils.generateUUID(),bt}const IsObject=rt=>rt===Object(rt)&&!Array.isArray(rt)&&typeof rt!="function";function useTexture(rt,_){const ut=useThree(St=>St.gl),mt=useLoader(TextureLoader,IsObject(rt)?Object.values(rt):rt);return reactExports.useLayoutEffect(()=>{_==null||_(mt)},[_]),reactExports.useEffect(()=>{if("initTexture"in ut){let St=[];Array.isArray(mt)?St=mt:mt instanceof Texture?St=[mt]:IsObject(mt)&&(St=Object.values(mt)),St.forEach(Mt=>{Mt instanceof Texture&&ut.initTexture(Mt)})}},[ut,mt]),reactExports.useMemo(()=>{if(IsObject(rt)){const St={};let Mt=0;for(const Bt in rt)St[Bt]=mt[Mt++];return St}else return mt},[rt,mt])}useTexture.preload=rt=>useLoader.preload(TextureLoader,rt);useTexture.clear=rt=>useLoader.clear(TextureLoader,rt);const getVersion=()=>parseInt(REVISION.replace(/\D+/g,"")),version=getVersion(),ImageMaterialImpl=shaderMaterial({color:new Color$1("white"),scale:new Vector2(1,1),imageBounds:new Vector2(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},`
  varying vec2 vUv;
  varying vec2 vPos;
  void main() {
    gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);
    vUv = uv;
    vPos = position.xy;
  }
`,`
  // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44
  varying vec2 vUv;
  varying vec2 vPos;
  uniform vec2 scale;
  uniform vec2 imageBounds;
  uniform float resolution;
  uniform vec3 color;
  uniform sampler2D map;
  uniform float radius;
  uniform float zoom;
  uniform float grayscale;
  uniform float opacity;
  const vec3 luma = vec3(.299, 0.587, 0.114);
  vec4 toGrayscale(vec4 color, float intensity) {
    return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);
  }
  vec2 aspect(vec2 size) {
    return size / min(size.x, size.y);
  }
  
  const float PI = 3.14159265;
    
  // from https://iquilezles.org/articles/distfunctions
  float udRoundBox( vec2 p, vec2 b, float r ) {
    return length(max(abs(p)-b+r,0.0))-r;
  }

  void main() {
    vec2 s = aspect(scale);
    vec2 i = aspect(imageBounds);
    float rs = s.x / s.y;
    float ri = i.x / i.y;
    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);
    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;
    vec2 uv = vUv * s / new + offset;
    vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);

    vec2 res = vec2(scale * resolution);
    vec2 halfRes = 0.5 * res;
    float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    
	  vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));
    gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);
    
    #include <tonemapping_fragment>
    #include <${version>=154?"colorspace_fragment":"encodings_fragment"}>
  }
`),ImageBase=reactExports.forwardRef(({children:rt,color:_,segments:ut=1,scale:mt=1,zoom:bt=1,grayscale:St=0,opacity:Mt=1,radius:Bt=0,texture:Ut,toneMapped:Ht,transparent:tr,side:rr,...sr},ar)=>{extend$3({ImageMaterial:ImageMaterialImpl});const cr=reactExports.useRef(null),Ar=useThree(Br=>Br.size),_r=Array.isArray(mt)?[mt[0],mt[1]]:[mt,mt],Dr=[Ut.image.width,Ut.image.height],$r=Math.max(Ar.width,Ar.height);return reactExports.useImperativeHandle(ar,()=>cr.current,[]),reactExports.useLayoutEffect(()=>{cr.current.geometry.parameters&&cr.current.material.scale.set(_r[0]*cr.current.geometry.parameters.width,_r[1]*cr.current.geometry.parameters.height)},[]),reactExports.createElement("mesh",_extends$4({ref:cr,scale:Array.isArray(mt)?[...mt,1]:mt},sr),reactExports.createElement("planeGeometry",{args:[1,1,ut,ut]}),reactExports.createElement("imageMaterial",{color:_,map:Ut,zoom:bt,grayscale:St,opacity:Mt,scale:_r,imageBounds:Dr,resolution:$r,radius:Bt,toneMapped:Ht,transparent:tr,side:rr,key:ImageMaterialImpl.key}),rt)}),ImageWithUrl=reactExports.forwardRef(({url:rt,..._},ut)=>{const mt=useTexture(rt);return reactExports.createElement(ImageBase,_extends$4({},_,{texture:mt,ref:ut}))}),ImageWithTexture=reactExports.forwardRef(({url:rt,..._},ut)=>reactExports.createElement(ImageBase,_extends$4({},_,{ref:ut}))),Image$1=reactExports.forwardRef((rt,_)=>{if(rt.url)return reactExports.createElement(ImageWithUrl,_extends$4({},rt,{ref:_}));if(rt.texture)return reactExports.createElement(ImageWithTexture,_extends$4({},rt,{ref:_}));throw new Error("<Image /> requires a url or texture")});function createSpread(rt,{keys:_=["near","far","color","distance","decay","penumbra","angle","intensity","skeleton","visible","castShadow","receiveShadow","morphTargetDictionary","morphTargetInfluences","name","geometry","material","position","rotation","scale","up","userData","bindMode","bindMatrix","bindMatrixInverse","skeleton"],deep:ut,inject:mt,castShadow:bt,receiveShadow:St}){let Mt={};for(const Bt of _)Mt[Bt]=rt[Bt];return ut&&(Mt.geometry&&ut!=="materialsOnly"&&(Mt.geometry=Mt.geometry.clone()),Mt.material&&ut!=="geometriesOnly"&&(Mt.material=Mt.material.clone())),mt&&(typeof mt=="function"?Mt={...Mt,children:mt(rt)}:reactExports.isValidElement(mt)?Mt={...Mt,children:mt}:Mt={...Mt,...mt}),rt instanceof Mesh&&(bt&&(Mt.castShadow=!0),St&&(Mt.receiveShadow=!0)),Mt}const Clone=reactExports.forwardRef(({isChild:rt=!1,object:_,children:ut,deep:mt,castShadow:bt,receiveShadow:St,inject:Mt,keys:Bt,...Ut},Ht)=>{const tr={keys:Bt,deep:mt,inject:Mt,castShadow:bt,receiveShadow:St};if(_=reactExports.useMemo(()=>{if(rt===!1&&!Array.isArray(_)){let cr=!1;if(_.traverse(Ar=>{Ar.isSkinnedMesh&&(cr=!0)}),cr)return SkeletonUtils.clone(_)}return _},[_,rt]),Array.isArray(_))return reactExports.createElement("group",_extends$4({},Ut,{ref:Ht}),_.map(cr=>reactExports.createElement(Clone,_extends$4({key:cr.uuid,object:cr},tr))),ut);const{children:rr,...sr}=createSpread(_,tr),ar=_.type[0].toLowerCase()+_.type.slice(1);return reactExports.createElement(ar,_extends$4({},sr,Ut,{ref:Ht}),_.children.map(cr=>cr.type==="Bone"?reactExports.createElement("primitive",_extends$4({key:cr.uuid,object:cr},tr)):reactExports.createElement(Clone,_extends$4({key:cr.uuid,object:cr},tr,{isChild:!0}))),ut,rr)});let dracoLoader=null,decoderPath="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function extensions(rt,_,ut){return mt=>{ut&&ut(mt),rt&&(dracoLoader||(dracoLoader=new DRACOLoader$1),dracoLoader.setDecoderPath(typeof rt=="string"?rt:decoderPath),mt.setDRACOLoader(dracoLoader)),_&&mt.setMeshoptDecoder(typeof MeshoptDecoder=="function"?MeshoptDecoder():MeshoptDecoder)}}function useGLTF(rt,_=!0,ut=!0,mt){return useLoader(GLTFLoader,rt,extensions(_,ut,mt))}useGLTF.preload=(rt,_=!0,ut=!0,mt)=>useLoader.preload(GLTFLoader,rt,extensions(_,ut,mt));useGLTF.clear=rt=>useLoader.clear(GLTFLoader,rt);useGLTF.setDecoderPath=rt=>{decoderPath=rt};function useFBO(rt,_,ut){const mt=useThree(sr=>sr.size),bt=useThree(sr=>sr.viewport),St=typeof rt=="number"?rt:mt.width*bt.dpr,Mt=mt.height*bt.dpr,Bt=(typeof rt=="number"?ut:rt)||{},{samples:Ut=0,depth:Ht,...tr}=Bt,rr=reactExports.useMemo(()=>{const sr=new WebGLRenderTarget(St,Mt,{minFilter:LinearFilter,magFilter:LinearFilter,type:HalfFloatType,...tr});return Ht&&(sr.depthTexture=new DepthTexture(St,Mt,FloatType)),sr.samples=Ut,sr},[]);return reactExports.useLayoutEffect(()=>{rr.setSize(St,Mt),Ut&&(rr.samples=Ut)},[Ut,rr,St,Mt]),reactExports.useEffect(()=>()=>rr.dispose(),[]),rr}const isFunction$2=rt=>typeof rt=="function",OrthographicCamera=reactExports.forwardRef(({envMap:rt,resolution:_=256,frames:ut=1/0,children:mt,makeDefault:bt,...St},Mt)=>{const Bt=useThree(({set:_r})=>_r),Ut=useThree(({camera:_r})=>_r),Ht=useThree(({size:_r})=>_r),tr=reactExports.useRef(null);reactExports.useImperativeHandle(Mt,()=>tr.current,[]);const rr=reactExports.useRef(null),sr=useFBO(_);reactExports.useLayoutEffect(()=>{St.manual||tr.current.updateProjectionMatrix()},[Ht,St]),reactExports.useLayoutEffect(()=>{tr.current.updateProjectionMatrix()}),reactExports.useLayoutEffect(()=>{if(bt){const _r=Ut;return Bt(()=>({camera:tr.current})),()=>Bt(()=>({camera:_r}))}},[tr,bt,Bt]);let ar=0,cr=null;const Ar=isFunction$2(mt);return useFrame(_r=>{Ar&&(ut===1/0||ar<ut)&&(rr.current.visible=!1,_r.gl.setRenderTarget(sr),cr=_r.scene.background,rt&&(_r.scene.background=rt),_r.gl.render(_r.scene,tr.current),_r.scene.background=cr,_r.gl.setRenderTarget(null),rr.current.visible=!0,ar++)}),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("orthographicCamera",_extends$4({left:Ht.width/-2,right:Ht.width/2,top:Ht.height/2,bottom:Ht.height/-2,ref:tr},St),!Ar&&mt),reactExports.createElement("group",{ref:rr},Ar&&mt(sr.texture)))}),isFunction$1=rt=>typeof rt=="function",PerspectiveCamera=reactExports.forwardRef(({envMap:rt,resolution:_=256,frames:ut=1/0,makeDefault:mt,children:bt,...St},Mt)=>{const Bt=useThree(({set:_r})=>_r),Ut=useThree(({camera:_r})=>_r),Ht=useThree(({size:_r})=>_r),tr=reactExports.useRef(null);reactExports.useImperativeHandle(Mt,()=>tr.current,[]);const rr=reactExports.useRef(null),sr=useFBO(_);reactExports.useLayoutEffect(()=>{St.manual||(tr.current.aspect=Ht.width/Ht.height)},[Ht,St]),reactExports.useLayoutEffect(()=>{tr.current.updateProjectionMatrix()});let ar=0,cr=null;const Ar=isFunction$1(bt);return useFrame(_r=>{Ar&&(ut===1/0||ar<ut)&&(rr.current.visible=!1,_r.gl.setRenderTarget(sr),cr=_r.scene.background,rt&&(_r.scene.background=rt),_r.gl.render(_r.scene,tr.current),_r.scene.background=cr,_r.gl.setRenderTarget(null),rr.current.visible=!0,ar++)}),reactExports.useLayoutEffect(()=>{if(mt){const _r=Ut;return Bt(()=>({camera:tr.current})),()=>Bt(()=>({camera:_r}))}},[tr,mt,Bt]),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("perspectiveCamera",_extends$4({ref:tr},St),!Ar&&bt),reactExports.createElement("group",{ref:rr},Ar&&bt(sr.texture)))}),OrbitControls=reactExports.forwardRef(({makeDefault:rt,camera:_,regress:ut,domElement:mt,enableDamping:bt=!0,keyEvents:St=!1,onChange:Mt,onStart:Bt,onEnd:Ut,...Ht},tr)=>{const rr=useThree(Mn=>Mn.invalidate),sr=useThree(Mn=>Mn.camera),ar=useThree(Mn=>Mn.gl),cr=useThree(Mn=>Mn.events),Ar=useThree(Mn=>Mn.setEvents),_r=useThree(Mn=>Mn.set),Dr=useThree(Mn=>Mn.get),$r=useThree(Mn=>Mn.performance),Br=_||sr,Jr=mt||cr.connected||ar.domElement,mn=reactExports.useMemo(()=>new OrbitControls$1(Br),[Br]);return useFrame(()=>{mn.enabled&&mn.update()},-1),reactExports.useEffect(()=>(St&&mn.connect(St===!0?Jr:St),mn.connect(Jr),()=>void mn.dispose()),[St,Jr,ut,mn,rr]),reactExports.useEffect(()=>{const Mn=In=>{rr(),ut&&$r.regress(),Mt&&Mt(In)},$n=In=>{Bt&&Bt(In)},en=In=>{Ut&&Ut(In)};return mn.addEventListener("change",Mn),mn.addEventListener("start",$n),mn.addEventListener("end",en),()=>{mn.removeEventListener("start",$n),mn.removeEventListener("end",en),mn.removeEventListener("change",Mn)}},[Mt,Bt,Ut,mn,rr,Ar]),reactExports.useEffect(()=>{if(rt){const Mn=Dr().controls;return _r({controls:mn}),()=>_r({controls:Mn})}},[rt,mn]),reactExports.createElement("primitive",_extends$4({ref:tr,object:mn,enableDamping:bt},Ht))});function useFBX(rt){return useLoader(FBXLoader,rt)}useFBX.preload=rt=>useLoader.preload(FBXLoader,rt);useFBX.clear=rt=>useLoader.clear(FBXLoader,rt);const scriptRel="modulepreload",assetsURL=function(rt){return"/"+rt},seen={},__vitePreload=function rt(_,ut,mt){let bt=Promise.resolve();if(ut&&ut.length>0){document.getElementsByTagName("link");const St=document.querySelector("meta[property=csp-nonce]"),Mt=(St==null?void 0:St.nonce)||(St==null?void 0:St.getAttribute("nonce"));bt=Promise.all(ut.map(Bt=>{if(Bt=assetsURL(Bt),Bt in seen)return;seen[Bt]=!0;const Ut=Bt.endsWith(".css"),Ht=Ut?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${Bt}"]${Ht}`))return;const tr=document.createElement("link");if(tr.rel=Ut?"stylesheet":scriptRel,Ut||(tr.as="script",tr.crossOrigin=""),tr.href=Bt,Mt&&tr.setAttribute("nonce",Mt),document.head.appendChild(tr),Ut)return new Promise((rr,sr)=>{tr.addEventListener("load",rr),tr.addEventListener("error",()=>sr(new Error(`Unable to preload CSS for ${Bt}`)))})}))}return bt.then(()=>_()).catch(St=>{const Mt=new Event("vite:preloadError",{cancelable:!0});if(Mt.payload=St,window.dispatchEvent(Mt),!Mt.defaultPrevented)throw St})};function useAnimations(rt,_){const ut=reactExports.useRef(),[mt]=reactExports.useState(()=>_?_ instanceof Object3D?{current:_}:_:ut),[bt]=reactExports.useState(()=>new AnimationMixer(void 0));reactExports.useLayoutEffect(()=>{_&&(mt.current=_ instanceof Object3D?_:_.current),bt._root=mt.current});const St=reactExports.useRef({}),Mt=reactExports.useMemo(()=>{const Bt={};return rt.forEach(Ut=>Object.defineProperty(Bt,Ut.name,{enumerable:!0,get(){if(mt.current)return St.current[Ut.name]||(St.current[Ut.name]=bt.clipAction(Ut,mt.current))},configurable:!0})),{ref:mt,clips:rt,actions:Bt,names:rt.map(Ut=>Ut.name),mixer:bt}},[rt]);return useFrame((Bt,Ut)=>bt.update(Ut)),reactExports.useEffect(()=>{const Bt=mt.current;return()=>{St.current={},bt.stopAllAction(),Object.values(Mt.actions).forEach(Ut=>{Bt&&bt.uncacheAction(Ut,Bt)})}},[rt]),Mt}const LinearEncoding=3e3,sRGBEncoding=3001;var distort=`#define GLSLIFY 1
vec3 mod289(vec3 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 mod289(vec4 x){return x-floor(x*(1.0/289.0))*289.0;}vec4 permute(vec4 x){return mod289(((x*34.0)+1.0)*x);}vec4 taylorInvSqrt(vec4 r){return 1.79284291400159-0.85373472095314*r;}float snoise(vec3 v){const vec2 C=vec2(1.0/6.0,1.0/3.0);const vec4 D=vec4(0.0,0.5,1.0,2.0);vec3 i=floor(v+dot(v,C.yyy));vec3 x0=v-i+dot(i,C.xxx);vec3 g=step(x0.yzx,x0.xyz);vec3 l=1.0-g;vec3 i1=min(g.xyz,l.zxy);vec3 i2=max(g.xyz,l.zxy);vec3 x1=x0-i1+C.xxx;vec3 x2=x0-i2+C.yyy;vec3 x3=x0-D.yyy;i=mod289(i);vec4 p=permute(permute(permute(i.z+vec4(0.0,i1.z,i2.z,1.0))+i.y+vec4(0.0,i1.y,i2.y,1.0))+i.x+vec4(0.0,i1.x,i2.x,1.0));float n_=0.142857142857;vec3 ns=n_*D.wyz-D.xzx;vec4 j=p-49.0*floor(p*ns.z*ns.z);vec4 x_=floor(j*ns.z);vec4 y_=floor(j-7.0*x_);vec4 x=x_*ns.x+ns.yyyy;vec4 y=y_*ns.x+ns.yyyy;vec4 h=1.0-abs(x)-abs(y);vec4 b0=vec4(x.xy,y.xy);vec4 b1=vec4(x.zw,y.zw);vec4 s0=floor(b0)*2.0+1.0;vec4 s1=floor(b1)*2.0+1.0;vec4 sh=-step(h,vec4(0.0));vec4 a0=b0.xzyw+s0.xzyw*sh.xxyy;vec4 a1=b1.xzyw+s1.xzyw*sh.zzww;vec3 p0=vec3(a0.xy,h.x);vec3 p1=vec3(a0.zw,h.y);vec3 p2=vec3(a1.xy,h.z);vec3 p3=vec3(a1.zw,h.w);vec4 norm=taylorInvSqrt(vec4(dot(p0,p0),dot(p1,p1),dot(p2,p2),dot(p3,p3)));p0*=norm.x;p1*=norm.y;p2*=norm.z;p3*=norm.w;vec4 m=max(0.6-vec4(dot(x0,x0),dot(x1,x1),dot(x2,x2),dot(x3,x3)),0.0);m=m*m;return 42.0*dot(m*m,vec4(dot(p0,x0),dot(p1,x1),dot(p2,x2),dot(p3,x3)));}`;class DistortMaterialImpl extends MeshPhysicalMaterial{constructor(_={}){super(_),this.setValues(_),this._time={value:0},this._distort={value:.4},this._radius={value:1}}onBeforeCompile(_){_.uniforms.time=this._time,_.uniforms.radius=this._radius,_.uniforms.distort=this._distort,_.vertexShader=`
      uniform float time;
      uniform float radius;
      uniform float distort;
      ${distort}
      ${_.vertexShader}
    `,_.vertexShader=_.vertexShader.replace("#include <begin_vertex>",`
        float updateTime = time / 50.0;
        float noise = snoise(vec3(position / 2.0 + updateTime * 5.0));
        vec3 transformed = vec3(position * (noise * pow(distort, 2.0) + radius));
        `)}get time(){return this._time.value}set time(_){this._time.value=_}get distort(){return this._distort.value}set distort(_){this._distort.value=_}get radius(){return this._radius.value}set radius(_){this._radius.value=_}}const MeshDistortMaterial=reactExports.forwardRef(({speed:rt=1,..._},ut)=>{const[mt]=reactExports.useState(()=>new DistortMaterialImpl);return useFrame(bt=>mt&&(mt.time=bt.clock.getElapsedTime()*rt)),reactExports.createElement("primitive",_extends$4({object:mt,ref:ut,attach:"material"},_))});function create(rt,_){const ut=rt+"Geometry";return reactExports.forwardRef(({args:mt,children:bt,...St},Mt)=>{const Bt=reactExports.useRef(null);return reactExports.useImperativeHandle(Mt,()=>Bt.current),reactExports.useLayoutEffect(()=>void(_==null?void 0:_(Bt.current))),reactExports.createElement("mesh",_extends$4({ref:Bt},St),reactExports.createElement(ut,{attach:"geometry",args:mt}),bt)})}const Sphere=create("sphere"),Float$1=reactExports.forwardRef(({children:rt,enabled:_=!0,speed:ut=1,rotationIntensity:mt=1,floatIntensity:bt=1,floatingRange:St=[-.1,.1],...Mt},Bt)=>{const Ut=reactExports.useRef(null);reactExports.useImperativeHandle(Bt,()=>Ut.current,[]);const Ht=reactExports.useRef(Math.random()*1e4);return useFrame(tr=>{var rr,sr;if(!_||ut===0)return;const ar=Ht.current+tr.clock.getElapsedTime();Ut.current.rotation.x=Math.cos(ar/4*ut)/8*mt,Ut.current.rotation.y=Math.sin(ar/4*ut)/8*mt,Ut.current.rotation.z=Math.sin(ar/4*ut)/20*mt;let cr=Math.sin(ar/4*ut)/10;cr=MathUtils.mapLinear(cr,-.1,.1,(rr=St==null?void 0:St[0])!==null&&rr!==void 0?rr:-.1,(sr=St==null?void 0:St[1])!==null&&sr!==void 0?sr:.1),Ut.current.position.y=cr*bt,Ut.current.updateMatrix()}),reactExports.createElement("group",Mt,reactExports.createElement("group",{ref:Ut,matrixAutoUpdate:!1},rt))}),getBufferForType=(rt,_,ut)=>{let mt;switch(rt){case UnsignedByteType:mt=new Uint8ClampedArray(_*ut*4);break;case HalfFloatType:mt=new Uint16Array(_*ut*4);break;case UnsignedIntType:mt=new Uint32Array(_*ut*4);break;case ByteType:mt=new Int8Array(_*ut*4);break;case ShortType:mt=new Int16Array(_*ut*4);break;case IntType:mt=new Int32Array(_*ut*4);break;case FloatType:mt=new Float32Array(_*ut*4);break;default:throw new Error("Unsupported data type")}return mt};let _canReadPixelsResult;const canReadPixels=(rt,_,ut,mt)=>{if(_canReadPixelsResult!==void 0)return _canReadPixelsResult;const bt=new WebGLRenderTarget(1,1,mt);_.setRenderTarget(bt);const St=new Mesh(new PlaneGeometry,new MeshBasicMaterial({color:16777215}));_.render(St,ut),_.setRenderTarget(null);const Mt=getBufferForType(rt,bt.width,bt.height);return _.readRenderTargetPixels(bt,0,0,bt.width,bt.height,Mt),bt.dispose(),St.geometry.dispose(),St.material.dispose(),_canReadPixelsResult=Mt[0]!==0,_canReadPixelsResult};class QuadRenderer{constructor(_){var ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar,_r,Dr;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(Br){throw this._renderer.setRenderTarget(null),Br}this._renderer.setRenderTarget(null)},this._width=_.width,this._height=_.height,this._type=_.type,this._colorSpace=_.colorSpace;const $r={format:RGBAFormat,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((ut=_.renderTargetOptions)===null||ut===void 0?void 0:ut.anisotropy)!==void 0?(mt=_.renderTargetOptions)===null||mt===void 0?void 0:mt.anisotropy:1,generateMipmaps:((bt=_.renderTargetOptions)===null||bt===void 0?void 0:bt.generateMipmaps)!==void 0?(St=_.renderTargetOptions)===null||St===void 0?void 0:St.generateMipmaps:!1,magFilter:((Mt=_.renderTargetOptions)===null||Mt===void 0?void 0:Mt.magFilter)!==void 0?(Bt=_.renderTargetOptions)===null||Bt===void 0?void 0:Bt.magFilter:LinearFilter,minFilter:((Ut=_.renderTargetOptions)===null||Ut===void 0?void 0:Ut.minFilter)!==void 0?(Ht=_.renderTargetOptions)===null||Ht===void 0?void 0:Ht.minFilter:LinearFilter,samples:((tr=_.renderTargetOptions)===null||tr===void 0?void 0:tr.samples)!==void 0?(rr=_.renderTargetOptions)===null||rr===void 0?void 0:rr.samples:void 0,wrapS:((sr=_.renderTargetOptions)===null||sr===void 0?void 0:sr.wrapS)!==void 0?(ar=_.renderTargetOptions)===null||ar===void 0?void 0:ar.wrapS:ClampToEdgeWrapping,wrapT:((cr=_.renderTargetOptions)===null||cr===void 0?void 0:cr.wrapT)!==void 0?(Ar=_.renderTargetOptions)===null||Ar===void 0?void 0:Ar.wrapT:ClampToEdgeWrapping};if(this._material=_.material,_.renderer?this._renderer=_.renderer:(this._renderer=QuadRenderer.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Scene$3,this._camera=new OrthographicCamera$1,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!canReadPixels(this._type,this._renderer,this._camera,$r)){let Br;switch(this._type){case HalfFloatType:Br=this._renderer.extensions.has("EXT_color_buffer_float")?FloatType:void 0;break}Br!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${FloatType}`),this._type=Br):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Mesh(new PlaneGeometry,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new WebGLRenderTarget(this.width,this.height,$r),this._renderTarget.texture.mapping=((_r=_.renderTargetOptions)===null||_r===void 0?void 0:_r.mapping)!==void 0?(Dr=_.renderTargetOptions)===null||Dr===void 0?void 0:Dr.mapping:UVMapping}static instantiateRenderer(){const _=new WebGLRenderer;return _.setSize(128,128),_}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const _=getBufferForType(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,_),_}toDataTexture(_){const ut=new DataTexture(this.toArray(),this.width,this.height,RGBAFormat,this._type,(_==null?void 0:_.mapping)||UVMapping,(_==null?void 0:_.wrapS)||ClampToEdgeWrapping,(_==null?void 0:_.wrapT)||ClampToEdgeWrapping,(_==null?void 0:_.magFilter)||LinearFilter,(_==null?void 0:_.minFilter)||LinearFilter,(_==null?void 0:_.anisotropy)||1,LinearSRGBColorSpace);return ut.generateMipmaps=(_==null?void 0:_.generateMipmaps)!==void 0?_==null?void 0:_.generateMipmaps:!1,ut}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(_){this.disposeOnDemandRenderer(),_&&this.renderTarget.dispose(),this.material instanceof ShaderMaterial&&Object.values(this.material.uniforms).forEach(ut=>{ut.value instanceof Texture&&ut.value.dispose()}),Object.values(this.material).forEach(ut=>{ut instanceof Texture&&ut.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(_){this._width=_,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(_){this._height=_,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(_){this._renderTarget=_,this._width=_.width,this._height=_.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const vertexShader=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,fragmentShader=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class GainMapDecoderMaterial extends ShaderMaterial{constructor({gamma:_,offsetHdr:ut,offsetSdr:mt,gainMapMin:bt,gainMapMax:St,maxDisplayBoost:Mt,hdrCapacityMin:Bt,hdrCapacityMax:Ut,sdr:Ht,gainMap:tr}){super({name:"GainMapDecoderMaterial",vertexShader,fragmentShader,uniforms:{sdr:{value:Ht},gainMap:{value:tr},gamma:{value:new Vector3(1/_[0],1/_[1],1/_[2])},offsetHdr:{value:new Vector3().fromArray(ut)},offsetSdr:{value:new Vector3().fromArray(mt)},gainMapMin:{value:new Vector3().fromArray(bt)},gainMapMax:{value:new Vector3().fromArray(St)},weightFactor:{value:(Math.log2(Mt)-Bt)/(Ut-Bt)}},blending:NoBlending,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=Mt,this._hdrCapacityMin=Bt,this._hdrCapacityMax=Ut,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(_){this.uniforms.sdr.value=_}get gainMap(){return this.uniforms.gainMap.value}set gainMap(_){this.uniforms.gainMap.value=_}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(_){this.uniforms.offsetHdr.value.fromArray(_)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(_){this.uniforms.offsetSdr.value.fromArray(_)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(_){this.uniforms.gainMapMin.value.fromArray(_)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(_){this.uniforms.gainMapMax.value.fromArray(_)}get gamma(){const _=this.uniforms.gamma.value;return[1/_.x,1/_.y,1/_.z]}set gamma(_){const ut=this.uniforms.gamma.value;ut.x=1/_[0],ut.y=1/_[1],ut.z=1/_[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(_){this._hdrCapacityMin=_,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(_){this._hdrCapacityMax=_,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(_){this._maxDisplayBoost=Math.max(1,Math.min(65504,_)),this.calculateWeight()}calculateWeight(){const _=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,_))}}class GainMapNotFoundError extends Error{}class XMPMetadataNotFoundError extends Error{}const getAttribute=(rt,_,ut)=>{var mt;let bt;const St=(mt=rt.attributes.getNamedItem(_))===null||mt===void 0?void 0:mt.nodeValue;if(St)bt=St;else{const Mt=rt.getElementsByTagName(_)[0];if(Mt){const Bt=Mt.getElementsByTagName("rdf:li");if(Bt.length===3)bt=Array.from(Bt).map(Ut=>Ut.innerHTML);else throw new Error(`Gainmap metadata contains an array of items for ${_} but its length is not 3`)}else{if(ut)return ut;throw new Error(`Can't find ${_} in gainmap metadata`)}}return bt},extractXMP=rt=>{var _,ut;let mt;typeof TextDecoder<"u"?mt=new TextDecoder().decode(rt):mt=rt.toString();let bt=mt.indexOf("<x:xmpmeta");const St=new DOMParser;for(;bt!==-1;){const Mt=mt.indexOf("x:xmpmeta>",bt);mt.slice(bt,Mt+10);const Bt=mt.slice(bt,Mt+10);try{const Ht=St.parseFromString(Bt,"text/xml").getElementsByTagName("rdf:Description")[0],tr=getAttribute(Ht,"hdrgm:GainMapMin","0"),rr=getAttribute(Ht,"hdrgm:GainMapMax"),sr=getAttribute(Ht,"hdrgm:Gamma","1"),ar=getAttribute(Ht,"hdrgm:OffsetSDR","0.015625"),cr=getAttribute(Ht,"hdrgm:OffsetHDR","0.015625");let Ar=(_=Ht.attributes.getNamedItem("hdrgm:HDRCapacityMin"))===null||_===void 0?void 0:_.nodeValue;Ar||(Ar="0");const _r=(ut=Ht.attributes.getNamedItem("hdrgm:HDRCapacityMax"))===null||ut===void 0?void 0:ut.nodeValue;if(!_r)throw new Error("Incomplete gainmap metadata");return{gainMapMin:Array.isArray(tr)?tr.map(Dr=>parseFloat(Dr)):[parseFloat(tr),parseFloat(tr),parseFloat(tr)],gainMapMax:Array.isArray(rr)?rr.map(Dr=>parseFloat(Dr)):[parseFloat(rr),parseFloat(rr),parseFloat(rr)],gamma:Array.isArray(sr)?sr.map(Dr=>parseFloat(Dr)):[parseFloat(sr),parseFloat(sr),parseFloat(sr)],offsetSdr:Array.isArray(ar)?ar.map(Dr=>parseFloat(Dr)):[parseFloat(ar),parseFloat(ar),parseFloat(ar)],offsetHdr:Array.isArray(cr)?cr.map(Dr=>parseFloat(Dr)):[parseFloat(cr),parseFloat(cr),parseFloat(cr)],hdrCapacityMin:parseFloat(Ar),hdrCapacityMax:parseFloat(_r)}}catch{}bt=mt.indexOf("<x:xmpmeta",Mt)}};class MPFExtractor{constructor(_){this.options={debug:_&&_.debug!==void 0?_.debug:!1,extractFII:_&&_.extractFII!==void 0?_.extractFII:!0,extractNonFII:_&&_.extractNonFII!==void 0?_.extractNonFII:!0}}extract(_){return new Promise((ut,mt)=>{const bt=this.options.debug,St=new DataView(_.buffer);if(St.getUint16(0)!==65496){mt(new Error("Not a valid jpeg"));return}const Mt=St.byteLength;let Bt=2,Ut=0,Ht;for(;Bt<Mt;){if(++Ut>250){mt(new Error(`Found no marker after ${Ut} loops 😵`));return}if(St.getUint8(Bt)!==255){mt(new Error(`Not a valid marker at offset 0x${Bt.toString(16)}, found: 0x${St.getUint8(Bt).toString(16)}`));return}if(Ht=St.getUint8(Bt+1),bt&&console.log(`Marker: ${Ht.toString(16)}`),Ht===226){bt&&console.log("Found APP2 marker (0xffe2)");const tr=Bt+4;if(St.getUint32(tr)===1297106432){const rr=tr+4;let sr;if(St.getUint16(rr)===18761)sr=!1;else if(St.getUint16(rr)===19789)sr=!0;else{mt(new Error("No valid endianness marker found in TIFF header"));return}if(St.getUint16(rr+2,!sr)!==42){mt(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const ar=St.getUint32(rr+4,!sr);if(ar<8){mt(new Error("Not valid TIFF data! (First offset less than 8)"));return}const cr=rr+ar,Ar=St.getUint16(cr,!sr),_r=cr+2;let Dr=0;for(let mn=_r;mn<_r+12*Ar;mn+=12)St.getUint16(mn,!sr)===45057&&(Dr=St.getUint32(mn+8,!sr));const Br=cr+2+Ar*12+4,Jr=[];for(let mn=Br;mn<Br+Dr*16;mn+=16){const Mn={MPType:St.getUint32(mn,!sr),size:St.getUint32(mn+4,!sr),dataOffset:St.getUint32(mn+8,!sr),dependantImages:St.getUint32(mn+12,!sr),start:-1,end:-1,isFII:!1};Mn.dataOffset?(Mn.start=rr+Mn.dataOffset,Mn.isFII=!1):(Mn.start=0,Mn.isFII=!0),Mn.end=Mn.start+Mn.size,Jr.push(Mn)}if(this.options.extractNonFII&&Jr.length){const mn=new Blob([St]),Mn=[];for(const $n of Jr){if($n.isFII&&!this.options.extractFII)continue;const en=mn.slice($n.start,$n.end+1,"image/jpeg");Mn.push(en)}ut(Mn)}}}Bt+=2+St.getUint16(Bt+2)}})}}const extractGainmapFromJPEG=async rt=>{const _=extractXMP(rt);if(!_)throw new XMPMetadataNotFoundError("Gain map XMP metadata not found");const mt=await new MPFExtractor({extractFII:!0,extractNonFII:!0}).extract(rt);if(mt.length!==2)throw new GainMapNotFoundError("Gain map recovery image not found");return{sdr:new Uint8Array(await mt[0].arrayBuffer()),gainMap:new Uint8Array(await mt[1].arrayBuffer()),metadata:_}},getHTMLImageFromBlob=rt=>new Promise((_,ut)=>{const mt=document.createElement("img");mt.onload=()=>{_(mt)},mt.onerror=bt=>{ut(bt)},mt.src=URL.createObjectURL(rt)});class LoaderBase extends Loader{constructor(_,ut){super(ut),_&&(this._renderer=_),this._internalLoadingManager=new LoadingManager}setRenderer(_){return this._renderer=_,this}setRenderTargetOptions(_){return this._renderTargetOptions=_,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const _=new GainMapDecoderMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Texture,sdr:new Texture});return new QuadRenderer({width:16,height:16,type:HalfFloatType,colorSpace:LinearSRGBColorSpace,material:_,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(_,ut,mt,bt){const St=bt?new Blob([bt],{type:"image/jpeg"}):void 0,Mt=new Blob([mt],{type:"image/jpeg"});let Bt,Ut,Ht=!1;if(typeof createImageBitmap>"u"){const sr=await Promise.all([St?getHTMLImageFromBlob(St):Promise.resolve(void 0),getHTMLImageFromBlob(Mt)]);Ut=sr[0],Bt=sr[1],Ht=!0}else{const sr=await Promise.all([St?createImageBitmap(St,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(Mt,{imageOrientation:"flipY"})]);Ut=sr[0],Bt=sr[1]}const tr=new Texture(Ut||new ImageData(2,2),UVMapping,ClampToEdgeWrapping,ClampToEdgeWrapping,LinearFilter,LinearMipMapLinearFilter,RGBAFormat,UnsignedByteType,1,LinearSRGBColorSpace);tr.flipY=Ht,tr.needsUpdate=!0;const rr=new Texture(Bt,UVMapping,ClampToEdgeWrapping,ClampToEdgeWrapping,LinearFilter,LinearMipMapLinearFilter,RGBAFormat,UnsignedByteType,1,SRGBColorSpace);rr.flipY=Ht,rr.needsUpdate=!0,_.width=Bt.width,_.height=Bt.height,_.material.gainMap=tr,_.material.sdr=rr,_.material.gainMapMin=ut.gainMapMin,_.material.gainMapMax=ut.gainMapMax,_.material.offsetHdr=ut.offsetHdr,_.material.offsetSdr=ut.offsetSdr,_.material.gamma=ut.gamma,_.material.hdrCapacityMin=ut.hdrCapacityMin,_.material.hdrCapacityMax=ut.hdrCapacityMax,_.material.maxDisplayBoost=Math.pow(2,ut.hdrCapacityMax),_.material.needsUpdate=!0,_.render()}}class GainMapLoader extends LoaderBase{load([_,ut,mt],bt,St,Mt){const Bt=this.prepareQuadRenderer();let Ut,Ht,tr;const rr=async()=>{if(Ut&&Ht&&tr){try{await this.render(Bt,tr,Ut,Ht)}catch(In){this.manager.itemError(_),this.manager.itemError(ut),this.manager.itemError(mt),typeof Mt=="function"&&Mt(In),Bt.disposeOnDemandRenderer();return}typeof bt=="function"&&bt(Bt),this.manager.itemEnd(_),this.manager.itemEnd(ut),this.manager.itemEnd(mt),Bt.disposeOnDemandRenderer()}};let sr=!0,ar=0,cr=0,Ar=!0,_r=0,Dr=0,$r=!0,Br=0,Jr=0;const mn=()=>{if(typeof St=="function"){const In=ar+_r+Br,Rn=cr+Dr+Jr,qn=sr&&Ar&&$r;St(new ProgressEvent("progress",{lengthComputable:qn,loaded:Rn,total:In}))}};this.manager.itemStart(_),this.manager.itemStart(ut),this.manager.itemStart(mt);const Mn=new FileLoader(this._internalLoadingManager);Mn.setResponseType("arraybuffer"),Mn.setRequestHeader(this.requestHeader),Mn.setPath(this.path),Mn.setWithCredentials(this.withCredentials),Mn.load(_,async In=>{if(typeof In=="string")throw new Error("Invalid sdr buffer");Ut=In,await rr()},In=>{sr=In.lengthComputable,cr=In.loaded,ar=In.total,mn()},In=>{this.manager.itemError(_),typeof Mt=="function"&&Mt(In)});const $n=new FileLoader(this._internalLoadingManager);$n.setResponseType("arraybuffer"),$n.setRequestHeader(this.requestHeader),$n.setPath(this.path),$n.setWithCredentials(this.withCredentials),$n.load(ut,async In=>{if(typeof In=="string")throw new Error("Invalid gainmap buffer");Ht=In,await rr()},In=>{Ar=In.lengthComputable,Dr=In.loaded,_r=In.total,mn()},In=>{this.manager.itemError(ut),typeof Mt=="function"&&Mt(In)});const en=new FileLoader(this._internalLoadingManager);return en.setRequestHeader(this.requestHeader),en.setPath(this.path),en.setWithCredentials(this.withCredentials),en.load(mt,async In=>{if(typeof In!="string")throw new Error("Invalid metadata string");tr=JSON.parse(In),await rr()},In=>{$r=In.lengthComputable,Jr=In.loaded,Br=In.total,mn()},In=>{this.manager.itemError(mt),typeof Mt=="function"&&Mt(In)}),Bt}}class HDRJPGLoader extends LoaderBase{load(_,ut,mt,bt){const St=this.prepareQuadRenderer(),Mt=new FileLoader(this._internalLoadingManager);return Mt.setResponseType("arraybuffer"),Mt.setRequestHeader(this.requestHeader),Mt.setPath(this.path),Mt.setWithCredentials(this.withCredentials),this.manager.itemStart(_),Mt.load(_,async Bt=>{if(typeof Bt=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const Ut=new Uint8Array(Bt);let Ht,tr,rr;try{const sr=await extractGainmapFromJPEG(Ut);Ht=sr.sdr,tr=sr.gainMap,rr=sr.metadata}catch(sr){if(sr instanceof XMPMetadataNotFoundError||sr instanceof GainMapNotFoundError)console.warn(`Failure to reconstruct an HDR image from ${_}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),rr={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},Ht=Ut;else throw sr}try{await this.render(St,rr,Ht,tr)}catch(sr){this.manager.itemError(_),typeof bt=="function"&&bt(sr),St.disposeOnDemandRenderer();return}typeof ut=="function"&&ut(St),this.manager.itemEnd(_),St.disposeOnDemandRenderer()},mt,Bt=>{this.manager.itemError(_),typeof bt=="function"&&bt(Bt)}),St}}const presetsObj={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},CUBEMAP_ROOT="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",isArray$1=rt=>Array.isArray(rt);function useEnvironment({files:rt=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"],path:_="",preset:ut=void 0,encoding:mt=void 0,extensions:bt}={}){var St;let Mt=null,Bt=!1,Ut;if(ut){if(!(ut in presetsObj))throw new Error("Preset must be one of: "+Object.keys(presetsObj).join(", "));rt=presetsObj[ut],_=CUBEMAP_ROOT}const Ht=isArray$1(rt)&&rt.length===6,tr=isArray$1(rt)&&rt.length===3&&rt.some(_r=>_r.endsWith("json")),rr=isArray$1(rt)?rt[0]:rt;if(Bt=isArray$1(rt),Ut=Ht?"cube":tr?"webp":rr.startsWith("data:application/exr")?"exr":rr.startsWith("data:application/hdr")?"hdr":rr.startsWith("data:image/jpeg")?"jpg":(St=rr.split(".").pop())==null||(St=St.split("?"))==null||(St=St.shift())==null?void 0:St.toLowerCase(),Mt=Ut==="cube"?CubeTextureLoader:Ut==="hdr"?RGBELoader:Ut==="exr"?EXRLoader:Ut==="jpg"||Ut==="jpeg"?HDRJPGLoader:Ut==="webp"?GainMapLoader:null,!Mt)throw new Error("useEnvironment: Unrecognized file extension: "+rt);const sr=useThree(_r=>_r.gl),ar=useLoader(Mt,Bt?[rt]:rt,_r=>{(Ut==="webp"||Ut==="jpg"||Ut==="jpeg")&&_r.setRenderer(sr),_r.setPath==null||_r.setPath(_),bt&&bt(_r)});let cr=Bt?ar[0]:ar;if(Ut==="jpg"||Ut==="jpeg"||Ut==="webp"){var Ar;cr=(Ar=cr.renderTarget)==null?void 0:Ar.texture}return cr.mapping=Ht?CubeReflectionMapping:EquirectangularReflectionMapping,"colorSpace"in cr?cr.colorSpace=mt??Ht?"srgb":"srgb-linear":cr.encoding=mt??Ht?sRGBEncoding:LinearEncoding,cr}const isRef=rt=>rt.current&&rt.current.isScene,resolveScene=rt=>isRef(rt)?rt.current:rt;function setEnvProps(rt,_,ut,mt,bt={}){var St,Mt,Bt,Ut,Ht;bt={backgroundBlurriness:(St=bt.blur)!==null&&St!==void 0?St:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...bt};const tr=resolveScene(_||ut),rr=tr.background,sr=tr.environment,ar={backgroundBlurriness:tr.backgroundBlurriness,backgroundIntensity:tr.backgroundIntensity,backgroundRotation:(Mt=(Bt=tr.backgroundRotation)==null||Bt.clone==null?void 0:Bt.clone())!==null&&Mt!==void 0?Mt:[0,0,0],environmentIntensity:tr.environmentIntensity,environmentRotation:(Ut=(Ht=tr.environmentRotation)==null||Ht.clone==null?void 0:Ht.clone())!==null&&Ut!==void 0?Ut:[0,0,0]};return rt!=="only"&&(tr.environment=mt),rt&&(tr.background=mt),applyProps(tr,bt),()=>{rt!=="only"&&(tr.environment=sr),rt&&(tr.background=rr),applyProps(tr,ar)}}function EnvironmentMap({scene:rt,background:_=!1,map:ut,...mt}){const bt=useThree(St=>St.scene);return reactExports.useLayoutEffect(()=>{if(ut)return setEnvProps(_,rt,bt,ut,mt)}),null}function EnvironmentCube({background:rt=!1,scene:_,blur:ut,backgroundBlurriness:mt,backgroundIntensity:bt,backgroundRotation:St,environmentIntensity:Mt,environmentRotation:Bt,...Ut}){const Ht=useEnvironment(Ut),tr=useThree(rr=>rr.scene);return reactExports.useLayoutEffect(()=>setEnvProps(rt,_,tr,Ht,{blur:ut,backgroundBlurriness:mt,backgroundIntensity:bt,backgroundRotation:St,environmentIntensity:Mt,environmentRotation:Bt})),null}function EnvironmentPortal({children:rt,near:_=1,far:ut=1e3,resolution:mt=256,frames:bt=1,map:St,background:Mt=!1,blur:Bt,backgroundBlurriness:Ut,backgroundIntensity:Ht,backgroundRotation:tr,environmentIntensity:rr,environmentRotation:sr,scene:ar,files:cr,path:Ar,preset:_r=void 0,extensions:Dr}){const $r=useThree(en=>en.gl),Br=useThree(en=>en.scene),Jr=reactExports.useRef(null),[mn]=reactExports.useState(()=>new Scene$3),Mn=reactExports.useMemo(()=>{const en=new WebGLCubeRenderTarget(mt);return en.texture.type=HalfFloatType,en},[mt]);reactExports.useLayoutEffect(()=>(bt===1&&Jr.current.update($r,mn),setEnvProps(Mt,ar,Br,Mn.texture,{blur:Bt,backgroundBlurriness:Ut,backgroundIntensity:Ht,backgroundRotation:tr,environmentIntensity:rr,environmentRotation:sr})),[rt,mn,Mn.texture,ar,Br,Mt,bt,$r]);let $n=1;return useFrame(()=>{(bt===1/0||$n<bt)&&(Jr.current.update($r,mn),$n++)}),reactExports.createElement(reactExports.Fragment,null,createPortal(reactExports.createElement(reactExports.Fragment,null,rt,reactExports.createElement("cubeCamera",{ref:Jr,args:[_,ut,Mn]}),cr||_r?reactExports.createElement(EnvironmentCube,{background:!0,files:cr,preset:_r,path:Ar,extensions:Dr}):St?reactExports.createElement(EnvironmentMap,{background:!0,map:St,extensions:Dr}):null),mn))}function EnvironmentGround(rt){var _,ut,mt,bt;const St=useEnvironment(rt),Mt=rt.map||St;reactExports.useMemo(()=>extend$3({GroundProjectedEnvImpl:GroundProjectedEnv}),[]);const Bt=reactExports.useMemo(()=>[Mt],[Mt]),Ut=(_=rt.ground)==null?void 0:_.height,Ht=(ut=rt.ground)==null?void 0:ut.radius,tr=(mt=(bt=rt.ground)==null?void 0:bt.scale)!==null&&mt!==void 0?mt:1e3;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(EnvironmentMap,_extends$4({},rt,{map:Mt})),reactExports.createElement("groundProjectedEnvImpl",{args:Bt,scale:tr,height:Ut,radius:Ht}))}function Environment$1(rt){return rt.ground?reactExports.createElement(EnvironmentGround,rt):rt.map?reactExports.createElement(EnvironmentMap,rt):rt.children?reactExports.createElement(EnvironmentPortal,rt):reactExports.createElement(EnvironmentCube,rt)}function calcPosFromAngles(rt,_,ut=new Vector3){const mt=Math.PI*(rt-.5),bt=2*Math.PI*(_-.5);return ut.x=Math.cos(bt),ut.y=Math.sin(mt),ut.z=Math.sin(bt),ut}const Sky=reactExports.forwardRef(({inclination:rt=.6,azimuth:_=.1,distance:ut=1e3,mieCoefficient:mt=.005,mieDirectionalG:bt=.8,rayleigh:St=.5,turbidity:Mt=10,sunPosition:Bt=calcPosFromAngles(rt,_),...Ut},Ht)=>{const tr=reactExports.useMemo(()=>new Vector3().setScalar(ut),[ut]),[rr]=reactExports.useState(()=>new Sky$1);return reactExports.createElement("primitive",_extends$4({object:rr,ref:Ht,"material-uniforms-mieCoefficient-value":mt,"material-uniforms-mieDirectionalG-value":bt,"material-uniforms-rayleigh-value":St,"material-uniforms-sunPosition-value":Bt,"material-uniforms-turbidity-value":Mt,scale:tr},Ut))}),Mask=reactExports.forwardRef(({id:rt=1,colorWrite:_=!1,depthWrite:ut=!1,...mt},bt)=>{const St=reactExports.useRef(null),Mt=reactExports.useMemo(()=>({colorWrite:_,depthWrite:ut,stencilWrite:!0,stencilRef:rt,stencilFunc:AlwaysStencilFunc,stencilFail:ReplaceStencilOp,stencilZFail:ReplaceStencilOp,stencilZPass:ReplaceStencilOp}),[rt,_,ut]);return reactExports.useLayoutEffect(()=>{Object.assign(St.current.material,Mt)}),reactExports.useImperativeHandle(bt,()=>St.current,[]),reactExports.createElement("mesh",_extends$4({ref:St,renderOrder:-rt},mt))});function useMask(rt,_=!1){return{stencilWrite:!0,stencilRef:rt,stencilFunc:_?NotEqualStencilFunc:EqualStencilFunc,stencilFail:KeepStencilOp,stencilZFail:KeepStencilOp,stencilZPass:KeepStencilOp}}function mergeBufferGeometries(rt,_=!1){const ut=rt[0].index!==null,mt=new Set(Object.keys(rt[0].attributes)),bt=new Set(Object.keys(rt[0].morphAttributes)),St={},Mt={},Bt=rt[0].morphTargetsRelative,Ut=new BufferGeometry;let Ht=0;for(let tr=0;tr<rt.length;++tr){const rr=rt[tr];let sr=0;if(ut!==(rr.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+tr+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const ar in rr.attributes){if(!mt.has(ar))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+tr+'. All geometries must have compatible attributes; make sure "'+ar+'" attribute exists among all geometries, or in none of them.'),null;St[ar]===void 0&&(St[ar]=[]),St[ar].push(rr.attributes[ar]),sr++}if(sr!==mt.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+tr+". Make sure all geometries have the same number of attributes."),null;if(Bt!==rr.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+tr+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const ar in rr.morphAttributes){if(!bt.has(ar))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+tr+".  .morphAttributes must be consistent throughout all geometries."),null;Mt[ar]===void 0&&(Mt[ar]=[]),Mt[ar].push(rr.morphAttributes[ar])}if(_){let ar;if(ut)ar=rr.index.count;else if(rr.attributes.position!==void 0)ar=rr.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+tr+". The geometry must have either an index or a position attribute"),null;Ut.addGroup(Ht,ar,tr),Ht+=ar}}if(ut){let tr=0;const rr=[];for(let sr=0;sr<rt.length;++sr){const ar=rt[sr].index;for(let cr=0;cr<ar.count;++cr)rr.push(ar.getX(cr)+tr);tr+=rt[sr].attributes.position.count}Ut.setIndex(rr)}for(const tr in St){const rr=mergeBufferAttributes(St[tr]);if(!rr)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+tr+" attribute."),null;Ut.setAttribute(tr,rr)}for(const tr in Mt){const rr=Mt[tr][0].length;if(rr===0)break;Ut.morphAttributes=Ut.morphAttributes||{},Ut.morphAttributes[tr]=[];for(let sr=0;sr<rr;++sr){const ar=[];for(let Ar=0;Ar<Mt[tr].length;++Ar)ar.push(Mt[tr][Ar][sr]);const cr=mergeBufferAttributes(ar);if(!cr)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+tr+" morphAttribute."),null;Ut.morphAttributes[tr].push(cr)}}return Ut}function mergeBufferAttributes(rt){let _,ut,mt,bt=0;for(let Bt=0;Bt<rt.length;++Bt){const Ut=rt[Bt];if(Ut.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(_===void 0&&(_=Ut.array.constructor),_!==Ut.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(ut===void 0&&(ut=Ut.itemSize),ut!==Ut.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(mt===void 0&&(mt=Ut.normalized),mt!==Ut.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;bt+=Ut.array.length}const St=new _(bt);let Mt=0;for(let Bt=0;Bt<rt.length;++Bt)St.set(rt[Bt].array,Mt),Mt+=rt[Bt].array.length;return new BufferAttribute(St,ut,mt)}const _taskCache=new WeakMap;class DRACOLoader extends Loader{constructor(_){super(_),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(_){return this.decoderPath=_,this}setDecoderConfig(_){return this.decoderConfig=_,this}setWorkerLimit(_){return this.workerLimit=_,this}load(_,ut,mt,bt){const St=new FileLoader(this.manager);St.setPath(this.path),St.setResponseType("arraybuffer"),St.setRequestHeader(this.requestHeader),St.setWithCredentials(this.withCredentials),St.load(_,Mt=>{this.parse(Mt,ut,bt)},mt,bt)}parse(_,ut,mt){this.decodeDracoFile(_,ut,null,null,SRGBColorSpace).catch(mt)}decodeDracoFile(_,ut,mt,bt,St=LinearSRGBColorSpace){const Mt={attributeIDs:mt||this.defaultAttributeIDs,attributeTypes:bt||this.defaultAttributeTypes,useUniqueIDs:!!mt,vertexColorSpace:St};return this.decodeGeometry(_,Mt).then(ut)}decodeGeometry(_,ut){const mt=JSON.stringify(ut);if(_taskCache.has(_)){const Ut=_taskCache.get(_);if(Ut.key===mt)return Ut.promise;if(_.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let bt;const St=this.workerNextTaskID++,Mt=_.byteLength,Bt=this._getWorker(St,Mt).then(Ut=>(bt=Ut,new Promise((Ht,tr)=>{bt._callbacks[St]={resolve:Ht,reject:tr},bt.postMessage({type:"decode",id:St,taskConfig:ut,buffer:_},[_])}))).then(Ut=>this._createGeometry(Ut.geometry));return Bt.catch(()=>!0).then(()=>{bt&&St&&this._releaseTask(bt,St)}),_taskCache.set(_,{key:mt,promise:Bt}),Bt}_createGeometry(_){const ut=new BufferGeometry;_.index&&ut.setIndex(new BufferAttribute(_.index.array,1));for(let mt=0;mt<_.attributes.length;mt++){const bt=_.attributes[mt],St=bt.name,Mt=bt.array,Bt=bt.itemSize,Ut=new BufferAttribute(Mt,Bt);St==="color"&&this._assignVertexColorSpace(Ut,bt.vertexColorSpace),ut.setAttribute(St,Ut)}return ut}_assignVertexColorSpace(_,ut){if(ut!==SRGBColorSpace)return;const mt=new Color$1;for(let bt=0,St=_.count;bt<St;bt++)mt.fromBufferAttribute(_,bt).convertSRGBToLinear(),_.setXYZ(bt,mt.r,mt.g,mt.b)}_loadLibrary(_,ut){const mt=new FileLoader(this.manager);return mt.setPath(this.decoderPath),mt.setResponseType(ut),mt.setWithCredentials(this.withCredentials),new Promise((bt,St)=>{mt.load(_,bt,void 0,St)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const _=typeof WebAssembly!="object"||this.decoderConfig.type==="js",ut=[];return _?ut.push(this._loadLibrary("draco_decoder.js","text")):(ut.push(this._loadLibrary("draco_wasm_wrapper.js","text")),ut.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(ut).then(mt=>{const bt=mt[0];_||(this.decoderConfig.wasmBinary=mt[1]);const St=DRACOWorker.toString(),Mt=["/* draco decoder */",bt,"","/* worker */",St.substring(St.indexOf("{")+1,St.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([Mt]))}),this.decoderPending}_getWorker(_,ut){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const bt=new Worker(this.workerSourceURL);bt._callbacks={},bt._taskCosts={},bt._taskLoad=0,bt.postMessage({type:"init",decoderConfig:this.decoderConfig}),bt.onmessage=function(St){const Mt=St.data;switch(Mt.type){case"decode":bt._callbacks[Mt.id].resolve(Mt);break;case"error":bt._callbacks[Mt.id].reject(Mt);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+Mt.type+'"')}},this.workerPool.push(bt)}else this.workerPool.sort(function(bt,St){return bt._taskLoad>St._taskLoad?-1:1});const mt=this.workerPool[this.workerPool.length-1];return mt._taskCosts[_]=ut,mt._taskLoad+=ut,mt})}_releaseTask(_,ut){_._taskLoad-=_._taskCosts[ut],delete _._callbacks[ut],delete _._taskCosts[ut]}debug(){console.log("Task load: ",this.workerPool.map(_=>_._taskLoad))}dispose(){for(let _=0;_<this.workerPool.length;++_)this.workerPool[_].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function DRACOWorker(){let rt,_;onmessage=function(Mt){const Bt=Mt.data;switch(Bt.type){case"init":rt=Bt.decoderConfig,_=new Promise(function(tr){rt.onModuleLoaded=function(rr){tr({draco:rr})},DracoDecoderModule(rt)});break;case"decode":const Ut=Bt.buffer,Ht=Bt.taskConfig;_.then(tr=>{const rr=tr.draco,sr=new rr.Decoder;try{const ar=ut(rr,sr,new Int8Array(Ut),Ht),cr=ar.attributes.map(Ar=>Ar.array.buffer);ar.index&&cr.push(ar.index.array.buffer),self.postMessage({type:"decode",id:Bt.id,geometry:ar},cr)}catch(ar){console.error(ar),self.postMessage({type:"error",id:Bt.id,error:ar.message})}finally{rr.destroy(sr)}});break}};function ut(Mt,Bt,Ut,Ht){const tr=Ht.attributeIDs,rr=Ht.attributeTypes;let sr,ar;const cr=Bt.GetEncodedGeometryType(Ut);if(cr===Mt.TRIANGULAR_MESH)sr=new Mt.Mesh,ar=Bt.DecodeArrayToMesh(Ut,Ut.byteLength,sr);else if(cr===Mt.POINT_CLOUD)sr=new Mt.PointCloud,ar=Bt.DecodeArrayToPointCloud(Ut,Ut.byteLength,sr);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!ar.ok()||sr.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+ar.error_msg());const Ar={index:null,attributes:[]};for(const _r in tr){const Dr=self[rr[_r]];let $r,Br;if(Ht.useUniqueIDs)Br=tr[_r],$r=Bt.GetAttributeByUniqueId(sr,Br);else{if(Br=Bt.GetAttributeId(sr,Mt[tr[_r]]),Br===-1)continue;$r=Bt.GetAttribute(sr,Br)}const Jr=bt(Mt,Bt,sr,_r,Dr,$r);_r==="color"&&(Jr.vertexColorSpace=Ht.vertexColorSpace),Ar.attributes.push(Jr)}return cr===Mt.TRIANGULAR_MESH&&(Ar.index=mt(Mt,Bt,sr)),Mt.destroy(sr),Ar}function mt(Mt,Bt,Ut){const tr=Ut.num_faces()*3,rr=tr*4,sr=Mt._malloc(rr);Bt.GetTrianglesUInt32Array(Ut,rr,sr);const ar=new Uint32Array(Mt.HEAPF32.buffer,sr,tr).slice();return Mt._free(sr),{array:ar,itemSize:1}}function bt(Mt,Bt,Ut,Ht,tr,rr){const sr=rr.num_components(),cr=Ut.num_points()*sr,Ar=cr*tr.BYTES_PER_ELEMENT,_r=St(Mt,tr),Dr=Mt._malloc(Ar);Bt.GetAttributeDataArrayForAllPoints(Ut,rr,_r,Ar,Dr);const $r=new tr(Mt.HEAPF32.buffer,Dr,cr).slice();return Mt._free(Dr),{name:Ht,array:$r,itemSize:sr}}function St(Mt,Bt){switch(Bt){case Float32Array:return Mt.DT_FLOAT32;case Int8Array:return Mt.DT_INT8;case Int16Array:return Mt.DT_INT16;case Int32Array:return Mt.DT_INT32;case Uint8Array:return Mt.DT_UINT8;case Uint16Array:return Mt.DT_UINT16;case Uint32Array:return Mt.DT_UINT32}}}var qv=Object.create,Ws=Object.defineProperty,Wv=Object.getOwnPropertyDescriptor,$v=Object.getOwnPropertyNames,Yv=Object.getPrototypeOf,Xv=Object.prototype.hasOwnProperty,Kv=(rt,_,ut)=>_ in rt?Ws(rt,_,{enumerable:!0,configurable:!0,writable:!0,value:ut}):rt[_]=ut,qt=(rt,_)=>()=>(_||rt((_={exports:{}}).exports,_),_.exports),Qv=(rt,_)=>{for(var ut in _)Ws(rt,ut,{get:_[ut],enumerable:!0})},Zv=(rt,_,ut,mt)=>{if(_&&typeof _=="object"||typeof _=="function")for(let bt of $v(_))!Xv.call(rt,bt)&&bt!==ut&&Ws(rt,bt,{get:()=>_[bt],enumerable:!(mt=Wv(_,bt))||mt.enumerable});return rt},Rt=(rt,_,ut)=>(ut=rt!=null?qv(Yv(rt)):{},Zv(_||!rt||!rt.__esModule?Ws(ut,"default",{value:rt,enumerable:!0}):ut,rt)),yt=(rt,_,ut)=>(Kv(rt,typeof _!="symbol"?_+"":_,ut),ut),Ly=qt((rt,_)=>{(function(ut,mt){typeof rt=="object"?_.exports=mt():typeof define=="function"&&define.amd?define(mt):ut.Alea=mt()})(rt,function(){return ut.importState=function(bt){var St=new ut;return St.importState(bt),St},ut;function ut(){return function(bt){var St=0,Mt=0,Bt=0,Ut=1;bt.length==0&&(bt=[+new Date]);var Ht=mt();St=Ht(" "),Mt=Ht(" "),Bt=Ht(" ");for(var tr=0;tr<bt.length;tr++)St-=Ht(bt[tr]),St<0&&(St+=1),Mt-=Ht(bt[tr]),Mt<0&&(Mt+=1),Bt-=Ht(bt[tr]),Bt<0&&(Bt+=1);Ht=null;var rr=function(){var sr=2091639*St+Ut*23283064365386963e-26;return St=Mt,Mt=Bt,Bt=sr-(Ut=sr|0)};return rr.next=rr,rr.uint32=function(){return rr()*4294967296},rr.fract53=function(){return rr()+(rr()*2097152|0)*11102230246251565e-32},rr.version="Alea 0.9",rr.args=bt,rr.exportState=function(){return[St,Mt,Bt,Ut]},rr.importState=function(sr){St=+sr[0]||0,Mt=+sr[1]||0,Bt=+sr[2]||0,Ut=+sr[3]||0},rr}(Array.prototype.slice.call(arguments))}function mt(){var bt=4022871197,St=function(Mt){Mt=Mt.toString();for(var Bt=0;Bt<Mt.length;Bt++){bt+=Mt.charCodeAt(Bt);var Ut=.02519603282416938*bt;bt=Ut>>>0,Ut-=bt,Ut*=bt,bt=Ut>>>0,Ut-=bt,bt+=Ut*4294967296}return(bt>>>0)*23283064365386963e-26};return St.version="Mash 0.9",St}})}),zy=qt((rt,_)=>{(function(ut,mt){typeof rt=="object"&&typeof _<"u"?mt(rt):typeof define=="function"&&define.amd?define(["exports"],mt):mt((ut=typeof globalThis<"u"?globalThis:ut||self).SVDJS={})})(rt,function(ut){ut.SVD=function(mt,bt,St,Mt,Bt){if(bt=bt===void 0||bt,St=St===void 0||St,Bt=1e-64/(Mt=Mt||Math.pow(2,-52)),!mt)throw new TypeError("Matrix a is not defined");var Ut,Ht,tr,rr,sr,ar,cr,Ar,_r,Dr,$r,Br,Jr=mt[0].length,mn=mt.length;if(mn<Jr)throw new TypeError("Invalid matrix: m < n");for(var Mn=[],$n=[],en=[],In=bt==="f"?mn:Jr,Rn=Dr=cr=0;Rn<mn;Rn++)$n[Rn]=new Array(In).fill(0);for(Rn=0;Rn<Jr;Rn++)en[Rn]=new Array(Jr).fill(0);var qn,Qn=new Array(Jr).fill(0);for(Rn=0;Rn<mn;Rn++)for(Ut=0;Ut<Jr;Ut++)$n[Rn][Ut]=mt[Rn][Ut];for(Rn=0;Rn<Jr;Rn++){for(Mn[Rn]=cr,_r=0,tr=Rn+1,Ut=Rn;Ut<mn;Ut++)_r+=Math.pow($n[Ut][Rn],2);if(_r<Bt)cr=0;else for(Ar=(ar=$n[Rn][Rn])*(cr=ar<0?Math.sqrt(_r):-Math.sqrt(_r))-_r,$n[Rn][Rn]=ar-cr,Ut=tr;Ut<Jr;Ut++){for(_r=0,Ht=Rn;Ht<mn;Ht++)_r+=$n[Ht][Rn]*$n[Ht][Ut];for(ar=_r/Ar,Ht=Rn;Ht<mn;Ht++)$n[Ht][Ut]=$n[Ht][Ut]+ar*$n[Ht][Rn]}for(Qn[Rn]=cr,_r=0,Ut=tr;Ut<Jr;Ut++)_r+=Math.pow($n[Rn][Ut],2);if(_r<Bt)cr=0;else{for(Ar=(ar=$n[Rn][Rn+1])*(cr=ar<0?Math.sqrt(_r):-Math.sqrt(_r))-_r,$n[Rn][Rn+1]=ar-cr,Ut=tr;Ut<Jr;Ut++)Mn[Ut]=$n[Rn][Ut]/Ar;for(Ut=tr;Ut<mn;Ut++){for(_r=0,Ht=tr;Ht<Jr;Ht++)_r+=$n[Ut][Ht]*$n[Rn][Ht];for(Ht=tr;Ht<Jr;Ht++)$n[Ut][Ht]=$n[Ut][Ht]+_r*Mn[Ht]}}Dr<($r=Math.abs(Qn[Rn])+Math.abs(Mn[Rn]))&&(Dr=$r)}if(St)for(Rn=Jr-1;0<=Rn;Rn--){if(cr!==0){for(Ar=$n[Rn][Rn+1]*cr,Ut=tr;Ut<Jr;Ut++)en[Ut][Rn]=$n[Rn][Ut]/Ar;for(Ut=tr;Ut<Jr;Ut++){for(_r=0,Ht=tr;Ht<Jr;Ht++)_r+=$n[Rn][Ht]*en[Ht][Ut];for(Ht=tr;Ht<Jr;Ht++)en[Ht][Ut]=en[Ht][Ut]+_r*en[Ht][Rn]}}for(Ut=tr;Ut<Jr;Ut++)en[Rn][Ut]=0,en[Ut][Rn]=0;en[Rn][Rn]=1,cr=Mn[Rn],tr=Rn}if(bt){if(bt==="f")for(Rn=Jr;Rn<mn;Rn++){for(Ut=Jr;Ut<mn;Ut++)$n[Rn][Ut]=0;$n[Rn][Rn]=1}for(Rn=Jr-1;0<=Rn;Rn--){for(tr=Rn+1,cr=Qn[Rn],Ut=tr;Ut<In;Ut++)$n[Rn][Ut]=0;if(cr!==0){for(Ar=$n[Rn][Rn]*cr,Ut=tr;Ut<In;Ut++){for(_r=0,Ht=tr;Ht<mn;Ht++)_r+=$n[Ht][Rn]*$n[Ht][Ut];for(ar=_r/Ar,Ht=Rn;Ht<mn;Ht++)$n[Ht][Ut]=$n[Ht][Ut]+ar*$n[Ht][Rn]}for(Ut=Rn;Ut<mn;Ut++)$n[Ut][Rn]=$n[Ut][Rn]/cr}else for(Ut=Rn;Ut<mn;Ut++)$n[Ut][Rn]=0;$n[Rn][Rn]=$n[Rn][Rn]+1}}for(Mt*=Dr,Ht=Jr-1;0<=Ht;Ht--)for(var xs=0;xs<50;xs++){for(qn=!1,tr=Ht;0<=tr;tr--){if(Math.abs(Mn[tr])<=Mt){qn=!0;break}if(Math.abs(Qn[tr-1])<=Mt)break}if(!qn){for(sr=0,rr=tr-(_r=1),Rn=tr;Rn<Ht+1&&(ar=_r*Mn[Rn],Mn[Rn]=sr*Mn[Rn],!(Math.abs(ar)<=Mt));Rn++)if(cr=Qn[Rn],Qn[Rn]=Math.sqrt(ar*ar+cr*cr),sr=cr/(Ar=Qn[Rn]),_r=-ar/Ar,bt)for(Ut=0;Ut<mn;Ut++)$r=$n[Ut][rr],Br=$n[Ut][Rn],$n[Ut][rr]=$r*sr+Br*_r,$n[Ut][Rn]=-$r*_r+Br*sr}if(Br=Qn[Ht],tr===Ht){if(Br<0&&(Qn[Ht]=-Br,St))for(Ut=0;Ut<Jr;Ut++)en[Ut][Ht]=-en[Ut][Ht];break}for(Dr=Qn[tr],ar=((($r=Qn[Ht-1])-Br)*($r+Br)+((cr=Mn[Ht-1])-(Ar=Mn[Ht]))*(cr+Ar))/(2*Ar*$r),cr=Math.sqrt(ar*ar+1),ar=((Dr-Br)*(Dr+Br)+Ar*($r/(ar<0?ar-cr:ar+cr)-Ar))/Dr,Rn=tr+(_r=sr=1);Rn<Ht+1;Rn++){if(cr=Mn[Rn],$r=Qn[Rn],Ar=_r*cr,cr*=sr,Br=Math.sqrt(ar*ar+Ar*Ar),ar=Dr*(sr=ar/(Mn[Rn-1]=Br))+cr*(_r=Ar/Br),cr=-Dr*_r+cr*sr,Ar=$r*_r,$r*=sr,St)for(Ut=0;Ut<Jr;Ut++)Dr=en[Ut][Rn-1],Br=en[Ut][Rn],en[Ut][Rn-1]=Dr*sr+Br*_r,en[Ut][Rn]=-Dr*_r+Br*sr;if(Br=Math.sqrt(ar*ar+Ar*Ar),ar=(sr=ar/(Qn[Rn-1]=Br))*cr+(_r=Ar/Br)*$r,Dr=-_r*cr+sr*$r,bt)for(Ut=0;Ut<mn;Ut++)$r=$n[Ut][Rn-1],Br=$n[Ut][Rn],$n[Ut][Rn-1]=$r*sr+Br*_r,$n[Ut][Rn]=-$r*_r+Br*sr}Mn[tr]=0,Mn[Ht]=ar,Qn[Ht]=Dr}for(Rn=0;Rn<Jr;Rn++)Qn[Rn]<Mt&&(Qn[Rn]=0);return{u:$n,q:Qn,v:en}},ut.VERSION="1.1.1",Object.defineProperty(ut,"__esModule",{value:!0})})}),xg=qt((rt,_)=>{(function(ut,mt){typeof rt=="object"&&typeof _<"u"?_.exports=mt():typeof define=="function"&&define.amd?define(mt):(ut=ut||self,ut.TinyQueue=mt())})(rt,function(){var ut=function(bt,St){if(bt===void 0&&(bt=[]),St===void 0&&(St=mt),this.data=bt,this.length=this.data.length,this.compare=St,this.length>0)for(var Mt=(this.length>>1)-1;Mt>=0;Mt--)this._down(Mt)};ut.prototype.push=function(bt){this.data.push(bt),this.length++,this._up(this.length-1)},ut.prototype.pop=function(){if(this.length!==0){var bt=this.data[0],St=this.data.pop();return this.length--,this.length>0&&(this.data[0]=St,this._down(0)),bt}},ut.prototype.peek=function(){return this.data[0]},ut.prototype._up=function(bt){for(var St=this,Mt=St.data,Bt=St.compare,Ut=Mt[bt];bt>0;){var Ht=bt-1>>1,tr=Mt[Ht];if(Bt(Ut,tr)>=0)break;Mt[bt]=tr,bt=Ht}Mt[bt]=Ut},ut.prototype._down=function(bt){for(var St=this,Mt=St.data,Bt=St.compare,Ut=this.length>>1,Ht=Mt[bt];bt<Ut;){var tr=(bt<<1)+1,rr=Mt[tr],sr=tr+1;if(sr<this.length&&Bt(Mt[sr],rr)<0&&(tr=sr,rr=Mt[sr]),Bt(rr,Ht)>=0)break;Mt[bt]=rr,bt=tr}Mt[bt]=Ht};function mt(bt,St){return bt<St?-1:bt>St?1:0}return ut})}),bg=qt((rt,_)=>{var ut=xg();ut.default&&(ut=ut.default),_.exports=mt,_.exports.default=mt;function mt(Ht,tr,rr){tr=tr||1;for(var sr,ar,cr,Ar,_r=0;_r<Ht[0].length;_r++){var Dr=Ht[0][_r];(!_r||Dr[0]<sr)&&(sr=Dr[0]),(!_r||Dr[1]<ar)&&(ar=Dr[1]),(!_r||Dr[0]>cr)&&(cr=Dr[0]),(!_r||Dr[1]>Ar)&&(Ar=Dr[1])}var $r=cr-sr,Br=Ar-ar,Jr=Math.min($r,Br),mn=Jr/2;if(Jr===0){var Mn=[sr,ar];return Mn.distance=0,Mn}for(var $n=new ut(void 0,bt),en=sr;en<cr;en+=Jr)for(var In=ar;In<Ar;In+=Jr)$n.push(new St(en+mn,In+mn,mn,Ht));var Rn=Bt(Ht),qn=new St(sr+$r/2,ar+Br/2,0,Ht);qn.d>Rn.d&&(Rn=qn);for(var Qn=$n.length;$n.length;){var xs=$n.pop();xs.d>Rn.d&&(Rn=xs,rr&&console.log("found best %d after %d probes",Math.round(1e4*xs.d)/1e4,Qn)),!(xs.max-Rn.d<=tr)&&(mn=xs.h/2,$n.push(new St(xs.x-mn,xs.y-mn,mn,Ht)),$n.push(new St(xs.x+mn,xs.y-mn,mn,Ht)),$n.push(new St(xs.x-mn,xs.y+mn,mn,Ht)),$n.push(new St(xs.x+mn,xs.y+mn,mn,Ht)),Qn+=4)}rr&&(console.log("num probes: "+Qn),console.log("best distance: "+Rn.d));var cs=[Rn.x,Rn.y];return cs.distance=Rn.d,cs}function bt(Ht,tr){return tr.max-Ht.max}function St(Ht,tr,rr,sr){this.x=Ht,this.y=tr,this.h=rr,this.d=Mt(Ht,tr,sr),this.max=this.d+this.h*Math.SQRT2}function Mt(Ht,tr,rr){for(var sr=!1,ar=1/0,cr=0;cr<rr.length;cr++)for(var Ar=rr[cr],_r=0,Dr=Ar.length,$r=Dr-1;_r<Dr;$r=_r++){var Br=Ar[_r],Jr=Ar[$r];Br[1]>tr!=Jr[1]>tr&&Ht<(Jr[0]-Br[0])*(tr-Br[1])/(Jr[1]-Br[1])+Br[0]&&(sr=!sr),ar=Math.min(ar,Ut(Ht,tr,Br,Jr))}return ar===0?0:(sr?1:-1)*Math.sqrt(ar)}function Bt(Ht){for(var tr=0,rr=0,sr=0,ar=Ht[0],cr=0,Ar=ar.length,_r=Ar-1;cr<Ar;_r=cr++){var Dr=ar[cr],$r=ar[_r],Br=Dr[0]*$r[1]-$r[0]*Dr[1];rr+=(Dr[0]+$r[0])*Br,sr+=(Dr[1]+$r[1])*Br,tr+=Br*3}return tr===0?new St(ar[0][0],ar[0][1],0,Ht):new St(rr/tr,sr/tr,0,Ht)}function Ut(Ht,tr,rr,sr){var ar=rr[0],cr=rr[1],Ar=sr[0]-ar,_r=sr[1]-cr;if(Ar!==0||_r!==0){var Dr=((Ht-ar)*Ar+(tr-cr)*_r)/(Ar*Ar+_r*_r);Dr>1?(ar=sr[0],cr=sr[1]):Dr>0&&(ar+=Ar*Dr,cr+=_r*Dr)}return Ar=Ht-ar,_r=tr-cr,Ar*Ar+_r*_r}}),B0=qt(rt=>{(function(){var _=function(){this.init()};_.prototype={init:function(){var rr=this||ut;return rr._counter=1e3,rr._html5AudioPool=[],rr.html5PoolSize=10,rr._codecs={},rr._howls=[],rr._muted=!1,rr._volume=1,rr._canPlayEvent="canplaythrough",rr._navigator=typeof window<"u"&&window.navigator?window.navigator:null,rr.masterGain=null,rr.noAudio=!1,rr.usingWebAudio=!0,rr.autoSuspend=!0,rr.ctx=null,rr.autoUnlock=!0,rr._setup(),rr},volume:function(rr){var sr=this||ut;if(rr=parseFloat(rr),sr.ctx||tr(),typeof rr<"u"&&rr>=0&&rr<=1){if(sr._volume=rr,sr._muted)return sr;sr.usingWebAudio&&sr.masterGain.gain.setValueAtTime(rr,ut.ctx.currentTime);for(var ar=0;ar<sr._howls.length;ar++)if(!sr._howls[ar]._webAudio)for(var cr=sr._howls[ar]._getSoundIds(),Ar=0;Ar<cr.length;Ar++){var _r=sr._howls[ar]._soundById(cr[Ar]);_r&&_r._node&&(_r._node.volume=_r._volume*rr)}return sr}return sr._volume},mute:function(rr){var sr=this||ut;sr.ctx||tr(),sr._muted=rr,sr.usingWebAudio&&sr.masterGain.gain.setValueAtTime(rr?0:sr._volume,ut.ctx.currentTime);for(var ar=0;ar<sr._howls.length;ar++)if(!sr._howls[ar]._webAudio)for(var cr=sr._howls[ar]._getSoundIds(),Ar=0;Ar<cr.length;Ar++){var _r=sr._howls[ar]._soundById(cr[Ar]);_r&&_r._node&&(_r._node.muted=rr?!0:_r._muted)}return sr},stop:function(){for(var rr=this||ut,sr=0;sr<rr._howls.length;sr++)rr._howls[sr].stop();return rr},unload:function(){for(var rr=this||ut,sr=rr._howls.length-1;sr>=0;sr--)rr._howls[sr].unload();return rr.usingWebAudio&&rr.ctx&&typeof rr.ctx.close<"u"&&(rr.ctx.close(),rr.ctx=null,tr()),rr},codecs:function(rr){return(this||ut)._codecs[rr.replace(/^x-/,"")]},_setup:function(){var rr=this||ut;if(rr.state=rr.ctx&&rr.ctx.state||"suspended",rr._autoSuspend(),!rr.usingWebAudio)if(typeof Audio<"u")try{var sr=new Audio;typeof sr.oncanplaythrough>"u"&&(rr._canPlayEvent="canplay")}catch{rr.noAudio=!0}else rr.noAudio=!0;try{var sr=new Audio;sr.muted&&(rr.noAudio=!0)}catch{}return rr.noAudio||rr._setupCodecs(),rr},_setupCodecs:function(){var rr=this||ut,sr=null;try{sr=typeof Audio<"u"?new Audio:null}catch{return rr}if(!sr||typeof sr.canPlayType!="function")return rr;var ar=sr.canPlayType("audio/mpeg;").replace(/^no$/,""),cr=rr._navigator?rr._navigator.userAgent:"",Ar=cr.match(/OPR\/([0-6].)/g),_r=Ar&&parseInt(Ar[0].split("/")[1],10)<33,Dr=cr.indexOf("Safari")!==-1&&cr.indexOf("Chrome")===-1,$r=cr.match(/Version\/(.*?) /),Br=Dr&&$r&&parseInt($r[1],10)<15;return rr._codecs={mp3:!!(!_r&&(ar||sr.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!ar,opus:!!sr.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!sr.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!sr.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(sr.canPlayType('audio/wav; codecs="1"')||sr.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!sr.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!sr.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(sr.canPlayType("audio/x-m4a;")||sr.canPlayType("audio/m4a;")||sr.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(sr.canPlayType("audio/x-m4b;")||sr.canPlayType("audio/m4b;")||sr.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(sr.canPlayType("audio/x-mp4;")||sr.canPlayType("audio/mp4;")||sr.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!Br&&sr.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!Br&&sr.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!sr.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(sr.canPlayType("audio/x-flac;")||sr.canPlayType("audio/flac;")).replace(/^no$/,"")},rr},_unlockAudio:function(){var rr=this||ut;if(!(rr._audioUnlocked||!rr.ctx)){rr._audioUnlocked=!1,rr.autoUnlock=!1,!rr._mobileUnloaded&&rr.ctx.sampleRate!==44100&&(rr._mobileUnloaded=!0,rr.unload()),rr._scratchBuffer=rr.ctx.createBuffer(1,1,22050);var sr=function(ar){for(;rr._html5AudioPool.length<rr.html5PoolSize;)try{var cr=new Audio;cr._unlocked=!0,rr._releaseHtml5Audio(cr)}catch{rr.noAudio=!0;break}for(var Ar=0;Ar<rr._howls.length;Ar++)if(!rr._howls[Ar]._webAudio)for(var _r=rr._howls[Ar]._getSoundIds(),Dr=0;Dr<_r.length;Dr++){var $r=rr._howls[Ar]._soundById(_r[Dr]);$r&&$r._node&&!$r._node._unlocked&&($r._node._unlocked=!0,$r._node.load())}rr._autoResume();var Br=rr.ctx.createBufferSource();Br.buffer=rr._scratchBuffer,Br.connect(rr.ctx.destination),typeof Br.start>"u"?Br.noteOn(0):Br.start(0),typeof rr.ctx.resume=="function"&&rr.ctx.resume(),Br.onended=function(){Br.disconnect(0),rr._audioUnlocked=!0,document.removeEventListener("touchstart",sr,!0),document.removeEventListener("touchend",sr,!0),document.removeEventListener("click",sr,!0),document.removeEventListener("keydown",sr,!0);for(var Jr=0;Jr<rr._howls.length;Jr++)rr._howls[Jr]._emit("unlock")}};return document.addEventListener("touchstart",sr,!0),document.addEventListener("touchend",sr,!0),document.addEventListener("click",sr,!0),document.addEventListener("keydown",sr,!0),rr}},_obtainHtml5Audio:function(){var rr=this||ut;if(rr._html5AudioPool.length)return rr._html5AudioPool.pop();var sr=new Audio().play();return sr&&typeof Promise<"u"&&(sr instanceof Promise||typeof sr.then=="function")&&sr.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(rr){var sr=this||ut;return rr._unlocked&&sr._html5AudioPool.push(rr),sr},_autoSuspend:function(){var rr=this;if(!(!rr.autoSuspend||!rr.ctx||typeof rr.ctx.suspend>"u"||!ut.usingWebAudio)){for(var sr=0;sr<rr._howls.length;sr++)if(rr._howls[sr]._webAudio){for(var ar=0;ar<rr._howls[sr]._sounds.length;ar++)if(!rr._howls[sr]._sounds[ar]._paused)return rr}return rr._suspendTimer&&clearTimeout(rr._suspendTimer),rr._suspendTimer=setTimeout(function(){if(rr.autoSuspend){rr._suspendTimer=null,rr.state="suspending";var cr=function(){rr.state="suspended",rr._resumeAfterSuspend&&(delete rr._resumeAfterSuspend,rr._autoResume())};rr.ctx.suspend().then(cr,cr)}},3e4),rr}},_autoResume:function(){var rr=this;if(!(!rr.ctx||typeof rr.ctx.resume>"u"||!ut.usingWebAudio))return rr.state==="running"&&rr.ctx.state!=="interrupted"&&rr._suspendTimer?(clearTimeout(rr._suspendTimer),rr._suspendTimer=null):rr.state==="suspended"||rr.state==="running"&&rr.ctx.state==="interrupted"?(rr.ctx.resume().then(function(){rr.state="running";for(var sr=0;sr<rr._howls.length;sr++)rr._howls[sr]._emit("resume")}),rr._suspendTimer&&(clearTimeout(rr._suspendTimer),rr._suspendTimer=null)):rr.state==="suspending"&&(rr._resumeAfterSuspend=!0),rr}};var ut=new _,mt=function(rr){var sr=this;if(!rr.src||rr.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}sr.init(rr)};mt.prototype={init:function(rr){var sr=this;return ut.ctx||tr(),sr._autoplay=rr.autoplay||!1,sr._format=typeof rr.format!="string"?rr.format:[rr.format],sr._html5=rr.html5||!1,sr._muted=rr.mute||!1,sr._loop=rr.loop||!1,sr._pool=rr.pool||5,sr._preload=typeof rr.preload=="boolean"||rr.preload==="metadata"?rr.preload:!0,sr._rate=rr.rate||1,sr._sprite=rr.sprite||{},sr._src=typeof rr.src!="string"?rr.src:[rr.src],sr._volume=rr.volume!==void 0?rr.volume:1,sr._xhr={method:rr.xhr&&rr.xhr.method?rr.xhr.method:"GET",headers:rr.xhr&&rr.xhr.headers?rr.xhr.headers:null,withCredentials:rr.xhr&&rr.xhr.withCredentials?rr.xhr.withCredentials:!1},sr._duration=0,sr._state="unloaded",sr._sounds=[],sr._endTimers={},sr._queue=[],sr._playLock=!1,sr._onend=rr.onend?[{fn:rr.onend}]:[],sr._onfade=rr.onfade?[{fn:rr.onfade}]:[],sr._onload=rr.onload?[{fn:rr.onload}]:[],sr._onloaderror=rr.onloaderror?[{fn:rr.onloaderror}]:[],sr._onplayerror=rr.onplayerror?[{fn:rr.onplayerror}]:[],sr._onpause=rr.onpause?[{fn:rr.onpause}]:[],sr._onplay=rr.onplay?[{fn:rr.onplay}]:[],sr._onstop=rr.onstop?[{fn:rr.onstop}]:[],sr._onmute=rr.onmute?[{fn:rr.onmute}]:[],sr._onvolume=rr.onvolume?[{fn:rr.onvolume}]:[],sr._onrate=rr.onrate?[{fn:rr.onrate}]:[],sr._onseek=rr.onseek?[{fn:rr.onseek}]:[],sr._onunlock=rr.onunlock?[{fn:rr.onunlock}]:[],sr._onresume=[],sr._webAudio=ut.usingWebAudio&&!sr._html5,typeof ut.ctx<"u"&&ut.ctx&&ut.autoUnlock&&ut._unlockAudio(),ut._howls.push(sr),sr._autoplay&&sr._queue.push({event:"play",action:function(){sr.play()}}),sr._preload&&sr._preload!=="none"&&sr.load(),sr},load:function(){var rr=this,sr=null;if(ut.noAudio){rr._emit("loaderror",null,"No audio support.");return}typeof rr._src=="string"&&(rr._src=[rr._src]);for(var ar=0;ar<rr._src.length;ar++){var cr,Ar;if(rr._format&&rr._format[ar])cr=rr._format[ar];else{if(Ar=rr._src[ar],typeof Ar!="string"){rr._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}cr=/^data:audio\/([^;,]+);/i.exec(Ar),cr||(cr=/\.([^.]+)$/.exec(Ar.split("?",1)[0])),cr&&(cr=cr[1].toLowerCase())}if(cr||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),cr&&ut.codecs(cr)){sr=rr._src[ar];break}}if(!sr){rr._emit("loaderror",null,"No codec support for selected audio sources.");return}return rr._src=sr,rr._state="loading",window.location.protocol==="https:"&&sr.slice(0,5)==="http:"&&(rr._html5=!0,rr._webAudio=!1),new bt(rr),rr._webAudio&&Mt(rr),rr},play:function(rr,sr){var ar=this,cr=null;if(typeof rr=="number")cr=rr,rr=null;else{if(typeof rr=="string"&&ar._state==="loaded"&&!ar._sprite[rr])return null;if(typeof rr>"u"&&(rr="__default",!ar._playLock)){for(var Ar=0,_r=0;_r<ar._sounds.length;_r++)ar._sounds[_r]._paused&&!ar._sounds[_r]._ended&&(Ar++,cr=ar._sounds[_r]._id);Ar===1?rr=null:cr=null}}var Dr=cr?ar._soundById(cr):ar._inactiveSound();if(!Dr)return null;if(cr&&!rr&&(rr=Dr._sprite||"__default"),ar._state!=="loaded"){Dr._sprite=rr,Dr._ended=!1;var $r=Dr._id;return ar._queue.push({event:"play",action:function(){ar.play($r)}}),$r}if(cr&&!Dr._paused)return sr||ar._loadQueue("play"),Dr._id;ar._webAudio&&ut._autoResume();var Br=Math.max(0,Dr._seek>0?Dr._seek:ar._sprite[rr][0]/1e3),Jr=Math.max(0,(ar._sprite[rr][0]+ar._sprite[rr][1])/1e3-Br),mn=Jr*1e3/Math.abs(Dr._rate),Mn=ar._sprite[rr][0]/1e3,$n=(ar._sprite[rr][0]+ar._sprite[rr][1])/1e3;Dr._sprite=rr,Dr._ended=!1;var en=function(){Dr._paused=!1,Dr._seek=Br,Dr._start=Mn,Dr._stop=$n,Dr._loop=!!(Dr._loop||ar._sprite[rr][2])};if(Br>=$n){ar._ended(Dr);return}var In=Dr._node;if(ar._webAudio){var Rn=function(){ar._playLock=!1,en(),ar._refreshBuffer(Dr);var cs=Dr._muted||ar._muted?0:Dr._volume;In.gain.setValueAtTime(cs,ut.ctx.currentTime),Dr._playStart=ut.ctx.currentTime,typeof In.bufferSource.start>"u"?Dr._loop?In.bufferSource.noteGrainOn(0,Br,86400):In.bufferSource.noteGrainOn(0,Br,Jr):Dr._loop?In.bufferSource.start(0,Br,86400):In.bufferSource.start(0,Br,Jr),mn!==1/0&&(ar._endTimers[Dr._id]=setTimeout(ar._ended.bind(ar,Dr),mn)),sr||setTimeout(function(){ar._emit("play",Dr._id),ar._loadQueue()},0)};ut.state==="running"&&ut.ctx.state!=="interrupted"?Rn():(ar._playLock=!0,ar.once("resume",Rn),ar._clearTimer(Dr._id))}else{var qn=function(){In.currentTime=Br,In.muted=Dr._muted||ar._muted||ut._muted||In.muted,In.volume=Dr._volume*ut.volume(),In.playbackRate=Dr._rate;try{var cs=In.play();if(cs&&typeof Promise<"u"&&(cs instanceof Promise||typeof cs.then=="function")?(ar._playLock=!0,en(),cs.then(function(){ar._playLock=!1,In._unlocked=!0,sr?ar._loadQueue():ar._emit("play",Dr._id)}).catch(function(){ar._playLock=!1,ar._emit("playerror",Dr._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),Dr._ended=!0,Dr._paused=!0})):sr||(ar._playLock=!1,en(),ar._emit("play",Dr._id)),In.playbackRate=Dr._rate,In.paused){ar._emit("playerror",Dr._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}rr!=="__default"||Dr._loop?ar._endTimers[Dr._id]=setTimeout(ar._ended.bind(ar,Dr),mn):(ar._endTimers[Dr._id]=function(){ar._ended(Dr),In.removeEventListener("ended",ar._endTimers[Dr._id],!1)},In.addEventListener("ended",ar._endTimers[Dr._id],!1))}catch(ks){ar._emit("playerror",Dr._id,ks)}};In.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(In.src=ar._src,In.load());var Qn=window&&window.ejecta||!In.readyState&&ut._navigator.isCocoonJS;if(In.readyState>=3||Qn)qn();else{ar._playLock=!0,ar._state="loading";var xs=function(){ar._state="loaded",qn(),In.removeEventListener(ut._canPlayEvent,xs,!1)};In.addEventListener(ut._canPlayEvent,xs,!1),ar._clearTimer(Dr._id)}}return Dr._id},pause:function(rr){var sr=this;if(sr._state!=="loaded"||sr._playLock)return sr._queue.push({event:"pause",action:function(){sr.pause(rr)}}),sr;for(var ar=sr._getSoundIds(rr),cr=0;cr<ar.length;cr++){sr._clearTimer(ar[cr]);var Ar=sr._soundById(ar[cr]);if(Ar&&!Ar._paused&&(Ar._seek=sr.seek(ar[cr]),Ar._rateSeek=0,Ar._paused=!0,sr._stopFade(ar[cr]),Ar._node))if(sr._webAudio){if(!Ar._node.bufferSource)continue;typeof Ar._node.bufferSource.stop>"u"?Ar._node.bufferSource.noteOff(0):Ar._node.bufferSource.stop(0),sr._cleanBuffer(Ar._node)}else(!isNaN(Ar._node.duration)||Ar._node.duration===1/0)&&Ar._node.pause();arguments[1]||sr._emit("pause",Ar?Ar._id:null)}return sr},stop:function(rr,sr){var ar=this;if(ar._state!=="loaded"||ar._playLock)return ar._queue.push({event:"stop",action:function(){ar.stop(rr)}}),ar;for(var cr=ar._getSoundIds(rr),Ar=0;Ar<cr.length;Ar++){ar._clearTimer(cr[Ar]);var _r=ar._soundById(cr[Ar]);_r&&(_r._seek=_r._start||0,_r._rateSeek=0,_r._paused=!0,_r._ended=!0,ar._stopFade(cr[Ar]),_r._node&&(ar._webAudio?_r._node.bufferSource&&(typeof _r._node.bufferSource.stop>"u"?_r._node.bufferSource.noteOff(0):_r._node.bufferSource.stop(0),ar._cleanBuffer(_r._node)):(!isNaN(_r._node.duration)||_r._node.duration===1/0)&&(_r._node.currentTime=_r._start||0,_r._node.pause(),_r._node.duration===1/0&&ar._clearSound(_r._node))),sr||ar._emit("stop",_r._id))}return ar},mute:function(rr,sr){var ar=this;if(ar._state!=="loaded"||ar._playLock)return ar._queue.push({event:"mute",action:function(){ar.mute(rr,sr)}}),ar;if(typeof sr>"u")if(typeof rr=="boolean")ar._muted=rr;else return ar._muted;for(var cr=ar._getSoundIds(sr),Ar=0;Ar<cr.length;Ar++){var _r=ar._soundById(cr[Ar]);_r&&(_r._muted=rr,_r._interval&&ar._stopFade(_r._id),ar._webAudio&&_r._node?_r._node.gain.setValueAtTime(rr?0:_r._volume,ut.ctx.currentTime):_r._node&&(_r._node.muted=ut._muted?!0:rr),ar._emit("mute",_r._id))}return ar},volume:function(){var rr=this,sr=arguments,ar,cr;if(sr.length===0)return rr._volume;if(sr.length===1||sr.length===2&&typeof sr[1]>"u"){var Ar=rr._getSoundIds(),_r=Ar.indexOf(sr[0]);_r>=0?cr=parseInt(sr[0],10):ar=parseFloat(sr[0])}else sr.length>=2&&(ar=parseFloat(sr[0]),cr=parseInt(sr[1],10));var Dr;if(typeof ar<"u"&&ar>=0&&ar<=1){if(rr._state!=="loaded"||rr._playLock)return rr._queue.push({event:"volume",action:function(){rr.volume.apply(rr,sr)}}),rr;typeof cr>"u"&&(rr._volume=ar),cr=rr._getSoundIds(cr);for(var $r=0;$r<cr.length;$r++)Dr=rr._soundById(cr[$r]),Dr&&(Dr._volume=ar,sr[2]||rr._stopFade(cr[$r]),rr._webAudio&&Dr._node&&!Dr._muted?Dr._node.gain.setValueAtTime(ar,ut.ctx.currentTime):Dr._node&&!Dr._muted&&(Dr._node.volume=ar*ut.volume()),rr._emit("volume",Dr._id))}else return Dr=cr?rr._soundById(cr):rr._sounds[0],Dr?Dr._volume:0;return rr},fade:function(rr,sr,ar,cr){var Ar=this;if(Ar._state!=="loaded"||Ar._playLock)return Ar._queue.push({event:"fade",action:function(){Ar.fade(rr,sr,ar,cr)}}),Ar;rr=Math.min(Math.max(0,parseFloat(rr)),1),sr=Math.min(Math.max(0,parseFloat(sr)),1),ar=parseFloat(ar),Ar.volume(rr,cr);for(var _r=Ar._getSoundIds(cr),Dr=0;Dr<_r.length;Dr++){var $r=Ar._soundById(_r[Dr]);if($r){if(cr||Ar._stopFade(_r[Dr]),Ar._webAudio&&!$r._muted){var Br=ut.ctx.currentTime,Jr=Br+ar/1e3;$r._volume=rr,$r._node.gain.setValueAtTime(rr,Br),$r._node.gain.linearRampToValueAtTime(sr,Jr)}Ar._startFadeInterval($r,rr,sr,ar,_r[Dr],typeof cr>"u")}}return Ar},_startFadeInterval:function(rr,sr,ar,cr,Ar,_r){var Dr=this,$r=sr,Br=ar-sr,Jr=Math.abs(Br/.01),mn=Math.max(4,Jr>0?cr/Jr:cr),Mn=Date.now();rr._fadeTo=ar,rr._interval=setInterval(function(){var $n=(Date.now()-Mn)/cr;Mn=Date.now(),$r+=Br*$n,$r=Math.round($r*100)/100,Br<0?$r=Math.max(ar,$r):$r=Math.min(ar,$r),Dr._webAudio?rr._volume=$r:Dr.volume($r,rr._id,!0),_r&&(Dr._volume=$r),(ar<sr&&$r<=ar||ar>sr&&$r>=ar)&&(clearInterval(rr._interval),rr._interval=null,rr._fadeTo=null,Dr.volume(ar,rr._id),Dr._emit("fade",rr._id))},mn)},_stopFade:function(rr){var sr=this,ar=sr._soundById(rr);return ar&&ar._interval&&(sr._webAudio&&ar._node.gain.cancelScheduledValues(ut.ctx.currentTime),clearInterval(ar._interval),ar._interval=null,sr.volume(ar._fadeTo,rr),ar._fadeTo=null,sr._emit("fade",rr)),sr},loop:function(){var rr=this,sr=arguments,ar,cr,Ar;if(sr.length===0)return rr._loop;if(sr.length===1)if(typeof sr[0]=="boolean")ar=sr[0],rr._loop=ar;else return Ar=rr._soundById(parseInt(sr[0],10)),Ar?Ar._loop:!1;else sr.length===2&&(ar=sr[0],cr=parseInt(sr[1],10));for(var _r=rr._getSoundIds(cr),Dr=0;Dr<_r.length;Dr++)Ar=rr._soundById(_r[Dr]),Ar&&(Ar._loop=ar,rr._webAudio&&Ar._node&&Ar._node.bufferSource&&(Ar._node.bufferSource.loop=ar,ar&&(Ar._node.bufferSource.loopStart=Ar._start||0,Ar._node.bufferSource.loopEnd=Ar._stop,rr.playing(_r[Dr])&&(rr.pause(_r[Dr],!0),rr.play(_r[Dr],!0)))));return rr},rate:function(){var rr=this,sr=arguments,ar,cr;if(sr.length===0)cr=rr._sounds[0]._id;else if(sr.length===1){var Ar=rr._getSoundIds(),_r=Ar.indexOf(sr[0]);_r>=0?cr=parseInt(sr[0],10):ar=parseFloat(sr[0])}else sr.length===2&&(ar=parseFloat(sr[0]),cr=parseInt(sr[1],10));var Dr;if(typeof ar=="number"){if(rr._state!=="loaded"||rr._playLock)return rr._queue.push({event:"rate",action:function(){rr.rate.apply(rr,sr)}}),rr;typeof cr>"u"&&(rr._rate=ar),cr=rr._getSoundIds(cr);for(var $r=0;$r<cr.length;$r++)if(Dr=rr._soundById(cr[$r]),Dr){rr.playing(cr[$r])&&(Dr._rateSeek=rr.seek(cr[$r]),Dr._playStart=rr._webAudio?ut.ctx.currentTime:Dr._playStart),Dr._rate=ar,rr._webAudio&&Dr._node&&Dr._node.bufferSource?Dr._node.bufferSource.playbackRate.setValueAtTime(ar,ut.ctx.currentTime):Dr._node&&(Dr._node.playbackRate=ar);var Br=rr.seek(cr[$r]),Jr=(rr._sprite[Dr._sprite][0]+rr._sprite[Dr._sprite][1])/1e3-Br,mn=Jr*1e3/Math.abs(Dr._rate);(rr._endTimers[cr[$r]]||!Dr._paused)&&(rr._clearTimer(cr[$r]),rr._endTimers[cr[$r]]=setTimeout(rr._ended.bind(rr,Dr),mn)),rr._emit("rate",Dr._id)}}else return Dr=rr._soundById(cr),Dr?Dr._rate:rr._rate;return rr},seek:function(){var rr=this,sr=arguments,ar,cr;if(sr.length===0)rr._sounds.length&&(cr=rr._sounds[0]._id);else if(sr.length===1){var Ar=rr._getSoundIds(),_r=Ar.indexOf(sr[0]);_r>=0?cr=parseInt(sr[0],10):rr._sounds.length&&(cr=rr._sounds[0]._id,ar=parseFloat(sr[0]))}else sr.length===2&&(ar=parseFloat(sr[0]),cr=parseInt(sr[1],10));if(typeof cr>"u")return 0;if(typeof ar=="number"&&(rr._state!=="loaded"||rr._playLock))return rr._queue.push({event:"seek",action:function(){rr.seek.apply(rr,sr)}}),rr;var Dr=rr._soundById(cr);if(Dr)if(typeof ar=="number"&&ar>=0){var $r=rr.playing(cr);$r&&rr.pause(cr,!0),Dr._seek=ar,Dr._ended=!1,rr._clearTimer(cr),!rr._webAudio&&Dr._node&&!isNaN(Dr._node.duration)&&(Dr._node.currentTime=ar);var Br=function(){$r&&rr.play(cr,!0),rr._emit("seek",cr)};if($r&&!rr._webAudio){var Jr=function(){rr._playLock?setTimeout(Jr,0):Br()};setTimeout(Jr,0)}else Br()}else if(rr._webAudio){var mn=rr.playing(cr)?ut.ctx.currentTime-Dr._playStart:0,Mn=Dr._rateSeek?Dr._rateSeek-Dr._seek:0;return Dr._seek+(Mn+mn*Math.abs(Dr._rate))}else return Dr._node.currentTime;return rr},playing:function(rr){var sr=this;if(typeof rr=="number"){var ar=sr._soundById(rr);return ar?!ar._paused:!1}for(var cr=0;cr<sr._sounds.length;cr++)if(!sr._sounds[cr]._paused)return!0;return!1},duration:function(rr){var sr=this,ar=sr._duration,cr=sr._soundById(rr);return cr&&(ar=sr._sprite[cr._sprite][1]/1e3),ar},state:function(){return this._state},unload:function(){for(var rr=this,sr=rr._sounds,ar=0;ar<sr.length;ar++)sr[ar]._paused||rr.stop(sr[ar]._id),rr._webAudio||(rr._clearSound(sr[ar]._node),sr[ar]._node.removeEventListener("error",sr[ar]._errorFn,!1),sr[ar]._node.removeEventListener(ut._canPlayEvent,sr[ar]._loadFn,!1),sr[ar]._node.removeEventListener("ended",sr[ar]._endFn,!1),ut._releaseHtml5Audio(sr[ar]._node)),delete sr[ar]._node,rr._clearTimer(sr[ar]._id);var cr=ut._howls.indexOf(rr);cr>=0&&ut._howls.splice(cr,1);var Ar=!0;for(ar=0;ar<ut._howls.length;ar++)if(ut._howls[ar]._src===rr._src||rr._src.indexOf(ut._howls[ar]._src)>=0){Ar=!1;break}return St&&Ar&&delete St[rr._src],ut.noAudio=!1,rr._state="unloaded",rr._sounds=[],rr=null,null},on:function(rr,sr,ar,cr){var Ar=this,_r=Ar["_on"+rr];return typeof sr=="function"&&_r.push(cr?{id:ar,fn:sr,once:cr}:{id:ar,fn:sr}),Ar},off:function(rr,sr,ar){var cr=this,Ar=cr["_on"+rr],_r=0;if(typeof sr=="number"&&(ar=sr,sr=null),sr||ar)for(_r=0;_r<Ar.length;_r++){var Dr=ar===Ar[_r].id;if(sr===Ar[_r].fn&&Dr||!sr&&Dr){Ar.splice(_r,1);break}}else if(rr)cr["_on"+rr]=[];else{var $r=Object.keys(cr);for(_r=0;_r<$r.length;_r++)$r[_r].indexOf("_on")===0&&Array.isArray(cr[$r[_r]])&&(cr[$r[_r]]=[])}return cr},once:function(rr,sr,ar){var cr=this;return cr.on(rr,sr,ar,1),cr},_emit:function(rr,sr,ar){for(var cr=this,Ar=cr["_on"+rr],_r=Ar.length-1;_r>=0;_r--)(!Ar[_r].id||Ar[_r].id===sr||rr==="load")&&(setTimeout((function(Dr){Dr.call(this,sr,ar)}).bind(cr,Ar[_r].fn),0),Ar[_r].once&&cr.off(rr,Ar[_r].fn,Ar[_r].id));return cr._loadQueue(rr),cr},_loadQueue:function(rr){var sr=this;if(sr._queue.length>0){var ar=sr._queue[0];ar.event===rr&&(sr._queue.shift(),sr._loadQueue()),rr||ar.action()}return sr},_ended:function(rr){var sr=this,ar=rr._sprite;if(!sr._webAudio&&rr._node&&!rr._node.paused&&!rr._node.ended&&rr._node.currentTime<rr._stop)return setTimeout(sr._ended.bind(sr,rr),100),sr;var cr=!!(rr._loop||sr._sprite[ar][2]);if(sr._emit("end",rr._id),!sr._webAudio&&cr&&sr.stop(rr._id,!0).play(rr._id),sr._webAudio&&cr){sr._emit("play",rr._id),rr._seek=rr._start||0,rr._rateSeek=0,rr._playStart=ut.ctx.currentTime;var Ar=(rr._stop-rr._start)*1e3/Math.abs(rr._rate);sr._endTimers[rr._id]=setTimeout(sr._ended.bind(sr,rr),Ar)}return sr._webAudio&&!cr&&(rr._paused=!0,rr._ended=!0,rr._seek=rr._start||0,rr._rateSeek=0,sr._clearTimer(rr._id),sr._cleanBuffer(rr._node),ut._autoSuspend()),!sr._webAudio&&!cr&&sr.stop(rr._id,!0),sr},_clearTimer:function(rr){var sr=this;if(sr._endTimers[rr]){if(typeof sr._endTimers[rr]!="function")clearTimeout(sr._endTimers[rr]);else{var ar=sr._soundById(rr);ar&&ar._node&&ar._node.removeEventListener("ended",sr._endTimers[rr],!1)}delete sr._endTimers[rr]}return sr},_soundById:function(rr){for(var sr=this,ar=0;ar<sr._sounds.length;ar++)if(rr===sr._sounds[ar]._id)return sr._sounds[ar];return null},_inactiveSound:function(){var rr=this;rr._drain();for(var sr=0;sr<rr._sounds.length;sr++)if(rr._sounds[sr]._ended)return rr._sounds[sr].reset();return new bt(rr)},_drain:function(){var rr=this,sr=rr._pool,ar=0,cr=0;if(!(rr._sounds.length<sr)){for(cr=0;cr<rr._sounds.length;cr++)rr._sounds[cr]._ended&&ar++;for(cr=rr._sounds.length-1;cr>=0;cr--){if(ar<=sr)return;rr._sounds[cr]._ended&&(rr._webAudio&&rr._sounds[cr]._node&&rr._sounds[cr]._node.disconnect(0),rr._sounds.splice(cr,1),ar--)}}},_getSoundIds:function(rr){var sr=this;if(typeof rr>"u"){for(var ar=[],cr=0;cr<sr._sounds.length;cr++)ar.push(sr._sounds[cr]._id);return ar}else return[rr]},_refreshBuffer:function(rr){var sr=this;return rr._node.bufferSource=ut.ctx.createBufferSource(),rr._node.bufferSource.buffer=St[sr._src],rr._panner?rr._node.bufferSource.connect(rr._panner):rr._node.bufferSource.connect(rr._node),rr._node.bufferSource.loop=rr._loop,rr._loop&&(rr._node.bufferSource.loopStart=rr._start||0,rr._node.bufferSource.loopEnd=rr._stop||0),rr._node.bufferSource.playbackRate.setValueAtTime(rr._rate,ut.ctx.currentTime),sr},_cleanBuffer:function(rr){var sr=this,ar=ut._navigator&&ut._navigator.vendor.indexOf("Apple")>=0;if(ut._scratchBuffer&&rr.bufferSource&&(rr.bufferSource.onended=null,rr.bufferSource.disconnect(0),ar))try{rr.bufferSource.buffer=ut._scratchBuffer}catch{}return rr.bufferSource=null,sr},_clearSound:function(rr){var sr=/MSIE |Trident\//.test(ut._navigator&&ut._navigator.userAgent);sr||(rr.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var bt=function(rr){this._parent=rr,this.init()};bt.prototype={init:function(){var rr=this,sr=rr._parent;return rr._muted=sr._muted,rr._loop=sr._loop,rr._volume=sr._volume,rr._rate=sr._rate,rr._seek=0,rr._paused=!0,rr._ended=!0,rr._sprite="__default",rr._id=++ut._counter,sr._sounds.push(rr),rr.create(),rr},create:function(){var rr=this,sr=rr._parent,ar=ut._muted||rr._muted||rr._parent._muted?0:rr._volume;return sr._webAudio?(rr._node=typeof ut.ctx.createGain>"u"?ut.ctx.createGainNode():ut.ctx.createGain(),rr._node.gain.setValueAtTime(ar,ut.ctx.currentTime),rr._node.paused=!0,rr._node.connect(ut.masterGain)):ut.noAudio||(rr._node=ut._obtainHtml5Audio(),rr._errorFn=rr._errorListener.bind(rr),rr._node.addEventListener("error",rr._errorFn,!1),rr._loadFn=rr._loadListener.bind(rr),rr._node.addEventListener(ut._canPlayEvent,rr._loadFn,!1),rr._endFn=rr._endListener.bind(rr),rr._node.addEventListener("ended",rr._endFn,!1),rr._node.src=sr._src,rr._node.preload=sr._preload===!0?"auto":sr._preload,rr._node.volume=ar*ut.volume(),rr._node.load()),rr},reset:function(){var rr=this,sr=rr._parent;return rr._muted=sr._muted,rr._loop=sr._loop,rr._volume=sr._volume,rr._rate=sr._rate,rr._seek=0,rr._rateSeek=0,rr._paused=!0,rr._ended=!0,rr._sprite="__default",rr._id=++ut._counter,rr},_errorListener:function(){var rr=this;rr._parent._emit("loaderror",rr._id,rr._node.error?rr._node.error.code:0),rr._node.removeEventListener("error",rr._errorFn,!1)},_loadListener:function(){var rr=this,sr=rr._parent;sr._duration=Math.ceil(rr._node.duration*10)/10,Object.keys(sr._sprite).length===0&&(sr._sprite={__default:[0,sr._duration*1e3]}),sr._state!=="loaded"&&(sr._state="loaded",sr._emit("load"),sr._loadQueue()),rr._node.removeEventListener(ut._canPlayEvent,rr._loadFn,!1)},_endListener:function(){var rr=this,sr=rr._parent;sr._duration===1/0&&(sr._duration=Math.ceil(rr._node.duration*10)/10,sr._sprite.__default[1]===1/0&&(sr._sprite.__default[1]=sr._duration*1e3),sr._ended(rr)),rr._node.removeEventListener("ended",rr._endFn,!1)}};var St={},Mt=function(rr){var sr=rr._src;if(St[sr]){rr._duration=St[sr].duration,Ht(rr);return}if(/^data:[^;]+;base64,/.test(sr)){for(var ar=atob(sr.split(",")[1]),cr=new Uint8Array(ar.length),Ar=0;Ar<ar.length;++Ar)cr[Ar]=ar.charCodeAt(Ar);Ut(cr.buffer,rr)}else{var _r=new XMLHttpRequest;_r.open(rr._xhr.method,sr,!0),_r.withCredentials=rr._xhr.withCredentials,_r.responseType="arraybuffer",rr._xhr.headers&&Object.keys(rr._xhr.headers).forEach(function(Dr){_r.setRequestHeader(Dr,rr._xhr.headers[Dr])}),_r.onload=function(){var Dr=(_r.status+"")[0];if(Dr!=="0"&&Dr!=="2"&&Dr!=="3"){rr._emit("loaderror",null,"Failed loading audio file with status: "+_r.status+".");return}Ut(_r.response,rr)},_r.onerror=function(){rr._webAudio&&(rr._html5=!0,rr._webAudio=!1,rr._sounds=[],delete St[sr],rr.load())},Bt(_r)}},Bt=function(rr){try{rr.send()}catch{rr.onerror()}},Ut=function(rr,sr){var ar=function(){sr._emit("loaderror",null,"Decoding audio data failed.")},cr=function(Ar){Ar&&sr._sounds.length>0?(St[sr._src]=Ar,Ht(sr,Ar)):ar()};typeof Promise<"u"&&ut.ctx.decodeAudioData.length===1?ut.ctx.decodeAudioData(rr).then(cr).catch(ar):ut.ctx.decodeAudioData(rr,cr,ar)},Ht=function(rr,sr){sr&&!rr._duration&&(rr._duration=sr.duration),Object.keys(rr._sprite).length===0&&(rr._sprite={__default:[0,rr._duration*1e3]}),rr._state!=="loaded"&&(rr._state="loaded",rr._emit("load"),rr._loadQueue())},tr=function(){if(ut.usingWebAudio){try{typeof AudioContext<"u"?ut.ctx=new AudioContext:typeof webkitAudioContext<"u"?ut.ctx=new webkitAudioContext:ut.usingWebAudio=!1}catch{ut.usingWebAudio=!1}ut.ctx||(ut.usingWebAudio=!1);var rr=/iP(hone|od|ad)/.test(ut._navigator&&ut._navigator.platform),sr=ut._navigator&&ut._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),ar=sr?parseInt(sr[1],10):null;if(rr&&ar&&ar<9){var cr=/safari/.test(ut._navigator&&ut._navigator.userAgent.toLowerCase());ut._navigator&&!cr&&(ut.usingWebAudio=!1)}ut.usingWebAudio&&(ut.masterGain=typeof ut.ctx.createGain>"u"?ut.ctx.createGainNode():ut.ctx.createGain(),ut.masterGain.gain.setValueAtTime(ut._muted?0:ut._volume,ut.ctx.currentTime),ut.masterGain.connect(ut.ctx.destination)),ut._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:ut,Howl:mt}}),typeof rt<"u"&&(rt.Howler=ut,rt.Howl=mt),typeof global<"u"?(global.HowlerGlobal=_,global.Howler=ut,global.Howl=mt,global.Sound=bt):typeof window<"u"&&(window.HowlerGlobal=_,window.Howler=ut,window.Howl=mt,window.Sound=bt)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(ut){var mt=this;if(!mt.ctx||!mt.ctx.listener)return mt;for(var bt=mt._howls.length-1;bt>=0;bt--)mt._howls[bt].stereo(ut);return mt},HowlerGlobal.prototype.pos=function(ut,mt,bt){var St=this;if(!St.ctx||!St.ctx.listener)return St;if(mt=typeof mt!="number"?St._pos[1]:mt,bt=typeof bt!="number"?St._pos[2]:bt,typeof ut=="number")St._pos=[ut,mt,bt],typeof St.ctx.listener.positionX<"u"?(St.ctx.listener.positionX.setTargetAtTime(St._pos[0],Howler.ctx.currentTime,.1),St.ctx.listener.positionY.setTargetAtTime(St._pos[1],Howler.ctx.currentTime,.1),St.ctx.listener.positionZ.setTargetAtTime(St._pos[2],Howler.ctx.currentTime,.1)):St.ctx.listener.setPosition(St._pos[0],St._pos[1],St._pos[2]);else return St._pos;return St},HowlerGlobal.prototype.orientation=function(ut,mt,bt,St,Mt,Bt){var Ut=this;if(!Ut.ctx||!Ut.ctx.listener)return Ut;var Ht=Ut._orientation;if(mt=typeof mt!="number"?Ht[1]:mt,bt=typeof bt!="number"?Ht[2]:bt,St=typeof St!="number"?Ht[3]:St,Mt=typeof Mt!="number"?Ht[4]:Mt,Bt=typeof Bt!="number"?Ht[5]:Bt,typeof ut=="number")Ut._orientation=[ut,mt,bt,St,Mt,Bt],typeof Ut.ctx.listener.forwardX<"u"?(Ut.ctx.listener.forwardX.setTargetAtTime(ut,Howler.ctx.currentTime,.1),Ut.ctx.listener.forwardY.setTargetAtTime(mt,Howler.ctx.currentTime,.1),Ut.ctx.listener.forwardZ.setTargetAtTime(bt,Howler.ctx.currentTime,.1),Ut.ctx.listener.upX.setTargetAtTime(St,Howler.ctx.currentTime,.1),Ut.ctx.listener.upY.setTargetAtTime(Mt,Howler.ctx.currentTime,.1),Ut.ctx.listener.upZ.setTargetAtTime(Bt,Howler.ctx.currentTime,.1)):Ut.ctx.listener.setOrientation(ut,mt,bt,St,Mt,Bt);else return Ht;return Ut},Howl.prototype.init=function(ut){return function(mt){var bt=this;return bt._orientation=mt.orientation||[1,0,0],bt._stereo=mt.stereo||null,bt._pos=mt.pos||null,bt._pannerAttr={coneInnerAngle:typeof mt.coneInnerAngle<"u"?mt.coneInnerAngle:360,coneOuterAngle:typeof mt.coneOuterAngle<"u"?mt.coneOuterAngle:360,coneOuterGain:typeof mt.coneOuterGain<"u"?mt.coneOuterGain:0,distanceModel:typeof mt.distanceModel<"u"?mt.distanceModel:"inverse",maxDistance:typeof mt.maxDistance<"u"?mt.maxDistance:1e4,panningModel:typeof mt.panningModel<"u"?mt.panningModel:"HRTF",refDistance:typeof mt.refDistance<"u"?mt.refDistance:1,rolloffFactor:typeof mt.rolloffFactor<"u"?mt.rolloffFactor:1},bt._onstereo=mt.onstereo?[{fn:mt.onstereo}]:[],bt._onpos=mt.onpos?[{fn:mt.onpos}]:[],bt._onorientation=mt.onorientation?[{fn:mt.onorientation}]:[],ut.call(this,mt)}}(Howl.prototype.init),Howl.prototype.stereo=function(ut,mt){var bt=this;if(!bt._webAudio)return bt;if(bt._state!=="loaded")return bt._queue.push({event:"stereo",action:function(){bt.stereo(ut,mt)}}),bt;var St=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof mt>"u")if(typeof ut=="number")bt._stereo=ut,bt._pos=[ut,0,0];else return bt._stereo;for(var Mt=bt._getSoundIds(mt),Bt=0;Bt<Mt.length;Bt++){var Ut=bt._soundById(Mt[Bt]);if(Ut)if(typeof ut=="number")Ut._stereo=ut,Ut._pos=[ut,0,0],Ut._node&&(Ut._pannerAttr.panningModel="equalpower",(!Ut._panner||!Ut._panner.pan)&&_(Ut,St),St==="spatial"?typeof Ut._panner.positionX<"u"?(Ut._panner.positionX.setValueAtTime(ut,Howler.ctx.currentTime),Ut._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),Ut._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):Ut._panner.setPosition(ut,0,0):Ut._panner.pan.setValueAtTime(ut,Howler.ctx.currentTime)),bt._emit("stereo",Ut._id);else return Ut._stereo}return bt},Howl.prototype.pos=function(ut,mt,bt,St){var Mt=this;if(!Mt._webAudio)return Mt;if(Mt._state!=="loaded")return Mt._queue.push({event:"pos",action:function(){Mt.pos(ut,mt,bt,St)}}),Mt;if(mt=typeof mt!="number"?0:mt,bt=typeof bt!="number"?-.5:bt,typeof St>"u")if(typeof ut=="number")Mt._pos=[ut,mt,bt];else return Mt._pos;for(var Bt=Mt._getSoundIds(St),Ut=0;Ut<Bt.length;Ut++){var Ht=Mt._soundById(Bt[Ut]);if(Ht)if(typeof ut=="number")Ht._pos=[ut,mt,bt],Ht._node&&((!Ht._panner||Ht._panner.pan)&&_(Ht,"spatial"),typeof Ht._panner.positionX<"u"?(Ht._panner.positionX.setValueAtTime(ut,Howler.ctx.currentTime),Ht._panner.positionY.setValueAtTime(mt,Howler.ctx.currentTime),Ht._panner.positionZ.setValueAtTime(bt,Howler.ctx.currentTime)):Ht._panner.setPosition(ut,mt,bt)),Mt._emit("pos",Ht._id);else return Ht._pos}return Mt},Howl.prototype.orientation=function(ut,mt,bt,St){var Mt=this;if(!Mt._webAudio)return Mt;if(Mt._state!=="loaded")return Mt._queue.push({event:"orientation",action:function(){Mt.orientation(ut,mt,bt,St)}}),Mt;if(mt=typeof mt!="number"?Mt._orientation[1]:mt,bt=typeof bt!="number"?Mt._orientation[2]:bt,typeof St>"u")if(typeof ut=="number")Mt._orientation=[ut,mt,bt];else return Mt._orientation;for(var Bt=Mt._getSoundIds(St),Ut=0;Ut<Bt.length;Ut++){var Ht=Mt._soundById(Bt[Ut]);if(Ht)if(typeof ut=="number")Ht._orientation=[ut,mt,bt],Ht._node&&(Ht._panner||(Ht._pos||(Ht._pos=Mt._pos||[0,0,-.5]),_(Ht,"spatial")),typeof Ht._panner.orientationX<"u"?(Ht._panner.orientationX.setValueAtTime(ut,Howler.ctx.currentTime),Ht._panner.orientationY.setValueAtTime(mt,Howler.ctx.currentTime),Ht._panner.orientationZ.setValueAtTime(bt,Howler.ctx.currentTime)):Ht._panner.setOrientation(ut,mt,bt)),Mt._emit("orientation",Ht._id);else return Ht._orientation}return Mt},Howl.prototype.pannerAttr=function(){var ut=this,mt=arguments,bt,St,Mt;if(!ut._webAudio)return ut;if(mt.length===0)return ut._pannerAttr;if(mt.length===1)if(typeof mt[0]=="object")bt=mt[0],typeof St>"u"&&(bt.pannerAttr||(bt.pannerAttr={coneInnerAngle:bt.coneInnerAngle,coneOuterAngle:bt.coneOuterAngle,coneOuterGain:bt.coneOuterGain,distanceModel:bt.distanceModel,maxDistance:bt.maxDistance,refDistance:bt.refDistance,rolloffFactor:bt.rolloffFactor,panningModel:bt.panningModel}),ut._pannerAttr={coneInnerAngle:typeof bt.pannerAttr.coneInnerAngle<"u"?bt.pannerAttr.coneInnerAngle:ut._coneInnerAngle,coneOuterAngle:typeof bt.pannerAttr.coneOuterAngle<"u"?bt.pannerAttr.coneOuterAngle:ut._coneOuterAngle,coneOuterGain:typeof bt.pannerAttr.coneOuterGain<"u"?bt.pannerAttr.coneOuterGain:ut._coneOuterGain,distanceModel:typeof bt.pannerAttr.distanceModel<"u"?bt.pannerAttr.distanceModel:ut._distanceModel,maxDistance:typeof bt.pannerAttr.maxDistance<"u"?bt.pannerAttr.maxDistance:ut._maxDistance,refDistance:typeof bt.pannerAttr.refDistance<"u"?bt.pannerAttr.refDistance:ut._refDistance,rolloffFactor:typeof bt.pannerAttr.rolloffFactor<"u"?bt.pannerAttr.rolloffFactor:ut._rolloffFactor,panningModel:typeof bt.pannerAttr.panningModel<"u"?bt.pannerAttr.panningModel:ut._panningModel});else return Mt=ut._soundById(parseInt(mt[0],10)),Mt?Mt._pannerAttr:ut._pannerAttr;else mt.length===2&&(bt=mt[0],St=parseInt(mt[1],10));for(var Bt=ut._getSoundIds(St),Ut=0;Ut<Bt.length;Ut++)if(Mt=ut._soundById(Bt[Ut]),Mt){var Ht=Mt._pannerAttr;Ht={coneInnerAngle:typeof bt.coneInnerAngle<"u"?bt.coneInnerAngle:Ht.coneInnerAngle,coneOuterAngle:typeof bt.coneOuterAngle<"u"?bt.coneOuterAngle:Ht.coneOuterAngle,coneOuterGain:typeof bt.coneOuterGain<"u"?bt.coneOuterGain:Ht.coneOuterGain,distanceModel:typeof bt.distanceModel<"u"?bt.distanceModel:Ht.distanceModel,maxDistance:typeof bt.maxDistance<"u"?bt.maxDistance:Ht.maxDistance,refDistance:typeof bt.refDistance<"u"?bt.refDistance:Ht.refDistance,rolloffFactor:typeof bt.rolloffFactor<"u"?bt.rolloffFactor:Ht.rolloffFactor,panningModel:typeof bt.panningModel<"u"?bt.panningModel:Ht.panningModel};var tr=Mt._panner;tr?(tr.coneInnerAngle=Ht.coneInnerAngle,tr.coneOuterAngle=Ht.coneOuterAngle,tr.coneOuterGain=Ht.coneOuterGain,tr.distanceModel=Ht.distanceModel,tr.maxDistance=Ht.maxDistance,tr.refDistance=Ht.refDistance,tr.rolloffFactor=Ht.rolloffFactor,tr.panningModel=Ht.panningModel):(Mt._pos||(Mt._pos=ut._pos||[0,0,-.5]),_(Mt,"spatial"))}return ut},Sound.prototype.init=function(ut){return function(){var mt=this,bt=mt._parent;mt._orientation=bt._orientation,mt._stereo=bt._stereo,mt._pos=bt._pos,mt._pannerAttr=bt._pannerAttr,ut.call(this),mt._stereo?bt.stereo(mt._stereo):mt._pos&&bt.pos(mt._pos[0],mt._pos[1],mt._pos[2],mt._id)}}(Sound.prototype.init),Sound.prototype.reset=function(ut){return function(){var mt=this,bt=mt._parent;return mt._orientation=bt._orientation,mt._stereo=bt._stereo,mt._pos=bt._pos,mt._pannerAttr=bt._pannerAttr,mt._stereo?bt.stereo(mt._stereo):mt._pos?bt.pos(mt._pos[0],mt._pos[1],mt._pos[2],mt._id):mt._panner&&(mt._panner.disconnect(0),mt._panner=void 0,bt._refreshBuffer(mt)),ut.call(this)}}(Sound.prototype.reset);var _=function(ut,mt){mt=mt||"spatial",mt==="spatial"?(ut._panner=Howler.ctx.createPanner(),ut._panner.coneInnerAngle=ut._pannerAttr.coneInnerAngle,ut._panner.coneOuterAngle=ut._pannerAttr.coneOuterAngle,ut._panner.coneOuterGain=ut._pannerAttr.coneOuterGain,ut._panner.distanceModel=ut._pannerAttr.distanceModel,ut._panner.maxDistance=ut._pannerAttr.maxDistance,ut._panner.refDistance=ut._pannerAttr.refDistance,ut._panner.rolloffFactor=ut._pannerAttr.rolloffFactor,ut._panner.panningModel=ut._pannerAttr.panningModel,typeof ut._panner.positionX<"u"?(ut._panner.positionX.setValueAtTime(ut._pos[0],Howler.ctx.currentTime),ut._panner.positionY.setValueAtTime(ut._pos[1],Howler.ctx.currentTime),ut._panner.positionZ.setValueAtTime(ut._pos[2],Howler.ctx.currentTime)):ut._panner.setPosition(ut._pos[0],ut._pos[1],ut._pos[2]),typeof ut._panner.orientationX<"u"?(ut._panner.orientationX.setValueAtTime(ut._orientation[0],Howler.ctx.currentTime),ut._panner.orientationY.setValueAtTime(ut._orientation[1],Howler.ctx.currentTime),ut._panner.orientationZ.setValueAtTime(ut._orientation[2],Howler.ctx.currentTime)):ut._panner.setOrientation(ut._orientation[0],ut._orientation[1],ut._orientation[2])):(ut._panner=Howler.ctx.createStereoPanner(),ut._panner.pan.setValueAtTime(ut._stereo,Howler.ctx.currentTime)),ut._panner.connect(ut._node),ut._paused||ut._parent.pause(ut._id,!0).play(ut._id,!0)}}()}),Ux=qt((rt,_)=>{function ut(mt){for(var bt=new Array(mt),St=0;St<mt;++St)bt[St]=St;return bt}_.exports=ut}),Wx=qt((rt,_)=>{_.exports=function(bt){return bt!=null&&(ut(bt)||mt(bt)||!!bt._isBuffer)};function ut(bt){return!!bt.constructor&&typeof bt.constructor.isBuffer=="function"&&bt.constructor.isBuffer(bt)}function mt(bt){return typeof bt.readFloatLE=="function"&&typeof bt.slice=="function"&&ut(bt.slice(0,0))}}),ja=qt((rt,_)=>{var ut=Ux(),mt=Wx(),bt=typeof Float64Array<"u";function St(rr,sr){return rr[0]-sr[0]}function Mt(){var rr=this.stride,sr=new Array(rr.length),ar;for(ar=0;ar<sr.length;++ar)sr[ar]=[Math.abs(rr[ar]),ar];sr.sort(St);var cr=new Array(sr.length);for(ar=0;ar<cr.length;++ar)cr[ar]=sr[ar][1];return cr}function Bt(rr,sr){var ar=["View",sr,"d",rr].join("");sr<0&&(ar="View_Nil"+rr);var cr=rr==="generic";if(sr===-1){var Ar="function "+ar+"(a){this.data=a;};var proto="+ar+".prototype;proto.dtype='"+rr+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+ar+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+ar+"(a){return new "+ar+"(a);}",Rn=new Function(Ar);return Rn()}else if(sr===0){var Ar="function "+ar+"(a,d) {this.data = a;this.offset = d};var proto="+ar+".prototype;proto.dtype='"+rr+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+ar+"_copy() {return new "+ar+"(this.data,this.offset)};proto.pick=function "+ar+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+ar+"_get(){return "+(cr?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+ar+"_set(v){return "+(cr?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+ar+"(a,b,c,d){return new "+ar+"(a,d)}",Rn=new Function("TrivialArray",Ar);return Rn(Ht[rr][0])}var Ar=["'use strict'"],_r=ut(sr),Dr=_r.map(function(qn){return"i"+qn}),$r="this.offset+"+_r.map(function(qn){return"this.stride["+qn+"]*i"+qn}).join("+"),Br=_r.map(function(qn){return"b"+qn}).join(","),Jr=_r.map(function(qn){return"c"+qn}).join(",");Ar.push("function "+ar+"(a,"+Br+","+Jr+",d){this.data=a","this.shape=["+Br+"]","this.stride=["+Jr+"]","this.offset=d|0}","var proto="+ar+".prototype","proto.dtype='"+rr+"'","proto.dimension="+sr),Ar.push("Object.defineProperty(proto,'size',{get:function "+ar+"_size(){return "+_r.map(function(qn){return"this.shape["+qn+"]"}).join("*"),"}})"),sr===1?Ar.push("proto.order=[0]"):(Ar.push("Object.defineProperty(proto,'order',{get:"),sr<4?(Ar.push("function "+ar+"_order(){"),sr===2?Ar.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):sr===3&&Ar.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):Ar.push("ORDER})")),Ar.push("proto.set=function "+ar+"_set("+Dr.join(",")+",v){"),cr?Ar.push("return this.data.set("+$r+",v)}"):Ar.push("return this.data["+$r+"]=v}"),Ar.push("proto.get=function "+ar+"_get("+Dr.join(",")+"){"),cr?Ar.push("return this.data.get("+$r+")}"):Ar.push("return this.data["+$r+"]}"),Ar.push("proto.index=function "+ar+"_index(",Dr.join(),"){return "+$r+"}"),Ar.push("proto.hi=function "+ar+"_hi("+Dr.join(",")+"){return new "+ar+"(this.data,"+_r.map(function(qn){return["(typeof i",qn,"!=='number'||i",qn,"<0)?this.shape[",qn,"]:i",qn,"|0"].join("")}).join(",")+","+_r.map(function(qn){return"this.stride["+qn+"]"}).join(",")+",this.offset)}");var mn=_r.map(function(qn){return"a"+qn+"=this.shape["+qn+"]"}),Mn=_r.map(function(qn){return"c"+qn+"=this.stride["+qn+"]"});Ar.push("proto.lo=function "+ar+"_lo("+Dr.join(",")+"){var b=this.offset,d=0,"+mn.join(",")+","+Mn.join(","));for(var $n=0;$n<sr;++$n)Ar.push("if(typeof i"+$n+"==='number'&&i"+$n+">=0){d=i"+$n+"|0;b+=c"+$n+"*d;a"+$n+"-=d}");Ar.push("return new "+ar+"(this.data,"+_r.map(function(qn){return"a"+qn}).join(",")+","+_r.map(function(qn){return"c"+qn}).join(",")+",b)}"),Ar.push("proto.step=function "+ar+"_step("+Dr.join(",")+"){var "+_r.map(function(qn){return"a"+qn+"=this.shape["+qn+"]"}).join(",")+","+_r.map(function(qn){return"b"+qn+"=this.stride["+qn+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var $n=0;$n<sr;++$n)Ar.push("if(typeof i"+$n+"==='number'){d=i"+$n+"|0;if(d<0){c+=b"+$n+"*(a"+$n+"-1);a"+$n+"=ceil(-a"+$n+"/d)}else{a"+$n+"=ceil(a"+$n+"/d)}b"+$n+"*=d}");Ar.push("return new "+ar+"(this.data,"+_r.map(function(qn){return"a"+qn}).join(",")+","+_r.map(function(qn){return"b"+qn}).join(",")+",c)}");for(var en=new Array(sr),In=new Array(sr),$n=0;$n<sr;++$n)en[$n]="a[i"+$n+"]",In[$n]="b[i"+$n+"]";Ar.push("proto.transpose=function "+ar+"_transpose("+Dr+"){"+Dr.map(function(qn,Qn){return qn+"=("+qn+"===undefined?"+Qn+":"+qn+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+ar+"(this.data,"+en.join(",")+","+In.join(",")+",this.offset)}"),Ar.push("proto.pick=function "+ar+"_pick("+Dr+"){var a=[],b=[],c=this.offset");for(var $n=0;$n<sr;++$n)Ar.push("if(typeof i"+$n+"==='number'&&i"+$n+">=0){c=(c+this.stride["+$n+"]*i"+$n+")|0}else{a.push(this.shape["+$n+"]);b.push(this.stride["+$n+"])}");Ar.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),Ar.push("return function construct_"+ar+"(data,shape,stride,offset){return new "+ar+"(data,"+_r.map(function(qn){return"shape["+qn+"]"}).join(",")+","+_r.map(function(qn){return"stride["+qn+"]"}).join(",")+",offset)}");var Rn=new Function("CTOR_LIST","ORDER",Ar.join(`
`));return Rn(Ht[rr],Mt)}function Ut(rr){if(mt(rr))return"buffer";if(bt)switch(Object.prototype.toString.call(rr)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(rr)?"array":"generic"}var Ht={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function tr(rr,sr,ar,cr){if(rr===void 0){var Jr=Ht.array[0];return Jr([])}else typeof rr=="number"&&(rr=[rr]);sr===void 0&&(sr=[rr.length]);var Ar=sr.length;if(ar===void 0){ar=new Array(Ar);for(var _r=Ar-1,Dr=1;_r>=0;--_r)ar[_r]=Dr,Dr*=sr[_r]}if(cr===void 0){cr=0;for(var _r=0;_r<Ar;++_r)ar[_r]<0&&(cr-=(sr[_r]-1)*ar[_r])}for(var $r=Ut(rr),Br=Ht[$r];Br.length<=Ar+1;)Br.push(Bt($r,Br.length-1));var Jr=Br[Ar+1];return Jr(rr,sr,ar,cr)}_.exports=tr}),Xx=qt((rt,_)=>{function ut(St,Mt){for(var Bt=1,Ut=St.length,Ht=St[0],tr=St[0],rr=1;rr<Ut;++rr)if(tr=Ht,Ht=St[rr],Mt(Ht,tr)){if(rr===Bt){Bt++;continue}St[Bt++]=Ht}return St.length=Bt,St}function mt(St){for(var Mt=1,Bt=St.length,Ut=St[0],Ht=St[0],tr=1;tr<Bt;++tr,Ht=Ut)if(Ht=Ut,Ut=St[tr],Ut!==Ht){if(tr===Mt){Mt++;continue}St[Mt++]=Ut}return St.length=Mt,St}function bt(St,Mt,Bt){return St.length===0?St:Mt?(Bt||St.sort(Mt),ut(St,Mt)):(Bt||St.sort(),mt(St))}_.exports=bt}),Zx=qt((rt,_)=>{var ut=Xx();function mt(Ht,tr,rr){var sr=Ht.length,ar=tr.arrayArgs.length,cr=tr.indexArgs.length>0,Ar=[],_r=[],Dr=0,$r=0,Br,Jr;for(Br=0;Br<sr;++Br)_r.push(["i",Br,"=0"].join(""));for(Jr=0;Jr<ar;++Jr)for(Br=0;Br<sr;++Br)$r=Dr,Dr=Ht[Br],Br===0?_r.push(["d",Jr,"s",Br,"=t",Jr,"p",Dr].join("")):_r.push(["d",Jr,"s",Br,"=(t",Jr,"p",Dr,"-s",$r,"*t",Jr,"p",$r,")"].join(""));for(_r.length>0&&Ar.push("var "+_r.join(",")),Br=sr-1;Br>=0;--Br)Dr=Ht[Br],Ar.push(["for(i",Br,"=0;i",Br,"<s",Dr,";++i",Br,"){"].join(""));for(Ar.push(rr),Br=0;Br<sr;++Br){for($r=Dr,Dr=Ht[Br],Jr=0;Jr<ar;++Jr)Ar.push(["p",Jr,"+=d",Jr,"s",Br].join(""));cr&&(Br>0&&Ar.push(["index[",$r,"]-=s",$r].join("")),Ar.push(["++index[",Dr,"]"].join(""))),Ar.push("}")}return Ar.join(`
`)}function bt(Ht,tr,rr,sr){for(var ar=tr.length,cr=rr.arrayArgs.length,Ar=rr.blockSize,_r=rr.indexArgs.length>0,Dr=[],$r=0;$r<cr;++$r)Dr.push(["var offset",$r,"=p",$r].join(""));for(var $r=Ht;$r<ar;++$r)Dr.push(["for(var j"+$r+"=SS[",tr[$r],"]|0;j",$r,">0;){"].join("")),Dr.push(["if(j",$r,"<",Ar,"){"].join("")),Dr.push(["s",tr[$r],"=j",$r].join("")),Dr.push(["j",$r,"=0"].join("")),Dr.push(["}else{s",tr[$r],"=",Ar].join("")),Dr.push(["j",$r,"-=",Ar,"}"].join("")),_r&&Dr.push(["index[",tr[$r],"]=j",$r].join(""));for(var $r=0;$r<cr;++$r){for(var Br=["offset"+$r],Jr=Ht;Jr<ar;++Jr)Br.push(["j",Jr,"*t",$r,"p",tr[Jr]].join(""));Dr.push(["p",$r,"=(",Br.join("+"),")"].join(""))}Dr.push(mt(tr,rr,sr));for(var $r=Ht;$r<ar;++$r)Dr.push("}");return Dr.join(`
`)}function St(Ht){for(var tr=0,rr=Ht[0].length;tr<rr;){for(var sr=1;sr<Ht.length;++sr)if(Ht[sr][tr]!==Ht[0][tr])return tr;++tr}return tr}function Mt(Ht,tr,rr){for(var sr=Ht.body,ar=[],cr=[],Ar=0;Ar<Ht.args.length;++Ar){var _r=Ht.args[Ar];if(!(_r.count<=0)){var Dr=new RegExp(_r.name,"g"),$r="",Br=tr.arrayArgs.indexOf(Ar);switch(tr.argTypes[Ar]){case"offset":var Jr=tr.offsetArgIndex.indexOf(Ar),mn=tr.offsetArgs[Jr];Br=mn.array,$r="+q"+Jr;case"array":$r="p"+Br+$r;var Mn="l"+Ar,$n="a"+Br;if(tr.arrayBlockIndices[Br]===0)_r.count===1?rr[Br]==="generic"?_r.lvalue?(ar.push(["var ",Mn,"=",$n,".get(",$r,")"].join("")),sr=sr.replace(Dr,Mn),cr.push([$n,".set(",$r,",",Mn,")"].join(""))):sr=sr.replace(Dr,[$n,".get(",$r,")"].join("")):sr=sr.replace(Dr,[$n,"[",$r,"]"].join("")):rr[Br]==="generic"?(ar.push(["var ",Mn,"=",$n,".get(",$r,")"].join("")),sr=sr.replace(Dr,Mn),_r.lvalue&&cr.push([$n,".set(",$r,",",Mn,")"].join(""))):(ar.push(["var ",Mn,"=",$n,"[",$r,"]"].join("")),sr=sr.replace(Dr,Mn),_r.lvalue&&cr.push([$n,"[",$r,"]=",Mn].join("")));else{for(var en=[_r.name],In=[$r],Rn=0;Rn<Math.abs(tr.arrayBlockIndices[Br]);Rn++)en.push("\\s*\\[([^\\]]+)\\]"),In.push("$"+(Rn+1)+"*t"+Br+"b"+Rn);if(Dr=new RegExp(en.join(""),"g"),$r=In.join("+"),rr[Br]==="generic")throw new Error("cwise: Generic arrays not supported in combination with blocks!");sr=sr.replace(Dr,[$n,"[",$r,"]"].join(""))}break;case"scalar":sr=sr.replace(Dr,"Y"+tr.scalarArgs.indexOf(Ar));break;case"index":sr=sr.replace(Dr,"index");break;case"shape":sr=sr.replace(Dr,"shape");break}}}return[ar.join(`
`),sr,cr.join(`
`)].join(`
`).trim()}function Bt(Ht){for(var tr=new Array(Ht.length),rr=!0,sr=0;sr<Ht.length;++sr){var ar=Ht[sr],cr=ar.match(/\d+/);cr?cr=cr[0]:cr="",ar.charAt(0)===0?tr[sr]="u"+ar.charAt(1)+cr:tr[sr]=ar.charAt(0)+cr,sr>0&&(rr=rr&&tr[sr]===tr[sr-1])}return rr?tr[0]:tr.join("")}function Ut(Ht,tr){for(var rr=tr[1].length-Math.abs(Ht.arrayBlockIndices[0])|0,sr=new Array(Ht.arrayArgs.length),ar=new Array(Ht.arrayArgs.length),cr=0;cr<Ht.arrayArgs.length;++cr)ar[cr]=tr[2*cr],sr[cr]=tr[2*cr+1];for(var Ar=[],_r=[],Dr=[],$r=[],Br=[],cr=0;cr<Ht.arrayArgs.length;++cr){Ht.arrayBlockIndices[cr]<0?(Dr.push(0),$r.push(rr),Ar.push(rr),_r.push(rr+Ht.arrayBlockIndices[cr])):(Dr.push(Ht.arrayBlockIndices[cr]),$r.push(Ht.arrayBlockIndices[cr]+rr),Ar.push(0),_r.push(Ht.arrayBlockIndices[cr]));for(var Jr=[],mn=0;mn<sr[cr].length;mn++)Dr[cr]<=sr[cr][mn]&&sr[cr][mn]<$r[cr]&&Jr.push(sr[cr][mn]-Dr[cr]);Br.push(Jr)}for(var Mn=["SS"],$n=["'use strict'"],en=[],mn=0;mn<rr;++mn)en.push(["s",mn,"=SS[",mn,"]"].join(""));for(var cr=0;cr<Ht.arrayArgs.length;++cr){Mn.push("a"+cr),Mn.push("t"+cr),Mn.push("p"+cr);for(var mn=0;mn<rr;++mn)en.push(["t",cr,"p",mn,"=t",cr,"[",Dr[cr]+mn,"]"].join(""));for(var mn=0;mn<Math.abs(Ht.arrayBlockIndices[cr]);++mn)en.push(["t",cr,"b",mn,"=t",cr,"[",Ar[cr]+mn,"]"].join(""))}for(var cr=0;cr<Ht.scalarArgs.length;++cr)Mn.push("Y"+cr);if(Ht.shapeArgs.length>0&&en.push("shape=SS.slice(0)"),Ht.indexArgs.length>0){for(var In=new Array(rr),cr=0;cr<rr;++cr)In[cr]="0";en.push(["index=[",In.join(","),"]"].join(""))}for(var cr=0;cr<Ht.offsetArgs.length;++cr){for(var Rn=Ht.offsetArgs[cr],qn=[],mn=0;mn<Rn.offset.length;++mn)Rn.offset[mn]!==0&&(Rn.offset[mn]===1?qn.push(["t",Rn.array,"p",mn].join("")):qn.push([Rn.offset[mn],"*t",Rn.array,"p",mn].join("")));qn.length===0?en.push("q"+cr+"=0"):en.push(["q",cr,"=",qn.join("+")].join(""))}var Qn=ut([].concat(Ht.pre.thisVars).concat(Ht.body.thisVars).concat(Ht.post.thisVars));en=en.concat(Qn),en.length>0&&$n.push("var "+en.join(","));for(var cr=0;cr<Ht.arrayArgs.length;++cr)$n.push("p"+cr+"|=0");Ht.pre.body.length>3&&$n.push(Mt(Ht.pre,Ht,ar));var xs=Mt(Ht.body,Ht,ar),cs=St(Br);cs<rr?$n.push(bt(cs,Br[0],Ht,xs)):$n.push(mt(Br[0],Ht,xs)),Ht.post.body.length>3&&$n.push(Mt(Ht.post,Ht,ar)),Ht.debug&&console.log("-----Generated cwise routine for ",tr,`:
`+$n.join(`
`)+`
----------`);var ks=[Ht.funcName||"unnamed","_cwise_loop_",sr[0].join("s"),"m",cs,Bt(ar)].join(""),_o=new Function(["function ",ks,"(",Mn.join(","),"){",$n.join(`
`),"} return ",ks].join(""));return _o()}_.exports=Ut}),ev=qt((rt,_)=>{var ut=Zx();function mt(bt){var St=["'use strict'","var CACHED={}"],Mt=[],Bt=bt.funcName+"_cwise_thunk";St.push(["return function ",Bt,"(",bt.shimArgs.join(","),"){"].join(""));for(var Ut=[],Ht=[],tr=[["array",bt.arrayArgs[0],".shape.slice(",Math.max(0,bt.arrayBlockIndices[0]),bt.arrayBlockIndices[0]<0?","+bt.arrayBlockIndices[0]+")":")"].join("")],rr=[],sr=[],ar=0;ar<bt.arrayArgs.length;++ar){var cr=bt.arrayArgs[ar];Mt.push(["t",cr,"=array",cr,".dtype,","r",cr,"=array",cr,".order"].join("")),Ut.push("t"+cr),Ut.push("r"+cr),Ht.push("t"+cr),Ht.push("r"+cr+".join()"),tr.push("array"+cr+".data"),tr.push("array"+cr+".stride"),tr.push("array"+cr+".offset|0"),ar>0&&(rr.push("array"+bt.arrayArgs[0]+".shape.length===array"+cr+".shape.length+"+(Math.abs(bt.arrayBlockIndices[0])-Math.abs(bt.arrayBlockIndices[ar]))),sr.push("array"+bt.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,bt.arrayBlockIndices[0])+"]===array"+cr+".shape[shapeIndex+"+Math.max(0,bt.arrayBlockIndices[ar])+"]"))}bt.arrayArgs.length>1&&(St.push("if (!("+rr.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),St.push("for(var shapeIndex=array"+bt.arrayArgs[0]+".shape.length-"+Math.abs(bt.arrayBlockIndices[0])+"; shapeIndex-->0;) {"),St.push("if (!("+sr.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),St.push("}"));for(var ar=0;ar<bt.scalarArgs.length;++ar)tr.push("scalar"+bt.scalarArgs[ar]);Mt.push(["type=[",Ht.join(","),"].join()"].join("")),Mt.push("proc=CACHED[type]"),St.push("var "+Mt.join(",")),St.push(["if(!proc){","CACHED[type]=proc=compile([",Ut.join(","),"])}","return proc(",tr.join(","),")}"].join("")),bt.debug&&console.log(`-----Generated thunk:
`+St.join(`
`)+`
----------`);var Ar=new Function("compile",St.join(`
`));return Ar(ut.bind(void 0,bt))}_.exports=mt}),rv=qt((rt,_)=>{var ut=ev();function mt(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function bt(St){var Mt=new mt;Mt.pre=St.pre,Mt.body=St.body,Mt.post=St.post;var Bt=St.args.slice(0);Mt.argTypes=Bt;for(var Ut=0;Ut<Bt.length;++Ut){var Ht=Bt[Ut];if(Ht==="array"||typeof Ht=="object"&&Ht.blockIndices){if(Mt.argTypes[Ut]="array",Mt.arrayArgs.push(Ut),Mt.arrayBlockIndices.push(Ht.blockIndices?Ht.blockIndices:0),Mt.shimArgs.push("array"+Ut),Ut<Mt.pre.args.length&&Mt.pre.args[Ut].count>0)throw new Error("cwise: pre() block may not reference array args");if(Ut<Mt.post.args.length&&Mt.post.args[Ut].count>0)throw new Error("cwise: post() block may not reference array args")}else if(Ht==="scalar")Mt.scalarArgs.push(Ut),Mt.shimArgs.push("scalar"+Ut);else if(Ht==="index"){if(Mt.indexArgs.push(Ut),Ut<Mt.pre.args.length&&Mt.pre.args[Ut].count>0)throw new Error("cwise: pre() block may not reference array index");if(Ut<Mt.body.args.length&&Mt.body.args[Ut].lvalue)throw new Error("cwise: body() block may not write to array index");if(Ut<Mt.post.args.length&&Mt.post.args[Ut].count>0)throw new Error("cwise: post() block may not reference array index")}else if(Ht==="shape"){if(Mt.shapeArgs.push(Ut),Ut<Mt.pre.args.length&&Mt.pre.args[Ut].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(Ut<Mt.body.args.length&&Mt.body.args[Ut].lvalue)throw new Error("cwise: body() block may not write to array shape");if(Ut<Mt.post.args.length&&Mt.post.args[Ut].lvalue)throw new Error("cwise: post() block may not write to array shape")}else if(typeof Ht=="object"&&Ht.offset)Mt.argTypes[Ut]="offset",Mt.offsetArgs.push({array:Ht.array,offset:Ht.offset}),Mt.offsetArgIndex.push(Ut);else throw new Error("cwise: Unknown argument type "+Bt[Ut])}if(Mt.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(Mt.pre.args.length>Bt.length)throw new Error("cwise: Too many arguments in pre() block");if(Mt.body.args.length>Bt.length)throw new Error("cwise: Too many arguments in body() block");if(Mt.post.args.length>Bt.length)throw new Error("cwise: Too many arguments in post() block");return Mt.debug=!!St.printCode||!!St.debug,Mt.funcName=St.funcName||"cwise",Mt.blockSize=St.blockSize||64,ut(Mt)}_.exports=bt}),Ua=qt(rt=>{var _=rv(),ut={body:"",args:[],thisVars:[],localVars:[]};function mt(sr){if(!sr)return ut;for(var ar=0;ar<sr.args.length;++ar){var cr=sr.args[ar];ar===0?sr.args[ar]={name:cr,lvalue:!0,rvalue:!!sr.rvalue,count:sr.count||1}:sr.args[ar]={name:cr,lvalue:!1,rvalue:!0,count:1}}return sr.thisVars||(sr.thisVars=[]),sr.localVars||(sr.localVars=[]),sr}function bt(sr){return _({args:sr.args,pre:mt(sr.pre),body:mt(sr.body),post:mt(sr.proc),funcName:sr.funcName})}function St(sr){for(var ar=[],cr=0;cr<sr.args.length;++cr)ar.push("a"+cr);var Ar=new Function("P",["return function ",sr.funcName,"_ndarrayops(",ar.join(","),") {P(",ar.join(","),");return a0}"].join(""));return Ar(bt(sr))}var Mt={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var sr in Mt){var ar=Mt[sr];rt[sr]=St({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+ar+"c"},funcName:sr}),rt[sr+"eq"]=St({args:["array","array"],body:{args:["a","b"],body:"a"+ar+"=b"},rvalue:!0,funcName:sr+"eq"}),rt[sr+"s"]=St({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+ar+"s"},funcName:sr+"s"}),rt[sr+"seq"]=St({args:["array","scalar"],body:{args:["a","s"],body:"a"+ar+"=s"},rvalue:!0,funcName:sr+"seq"})}})();var Bt={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var sr in Bt){var ar=Bt[sr];rt[sr]=St({args:["array","array"],body:{args:["a","b"],body:"a="+ar+"b"},funcName:sr}),rt[sr+"eq"]=St({args:["array"],body:{args:["a"],body:"a="+ar+"a"},rvalue:!0,count:2,funcName:sr+"eq"})}})();var Ut={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var sr in Ut){var ar=Ut[sr];rt[sr]=St({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+ar+"c"},funcName:sr}),rt[sr+"s"]=St({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+ar+"s"},funcName:sr+"s"}),rt[sr+"eq"]=St({args:["array","array"],body:{args:["a","b"],body:"a=a"+ar+"b"},rvalue:!0,count:2,funcName:sr+"eq"}),rt[sr+"seq"]=St({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+ar+"s"},rvalue:!0,count:2,funcName:sr+"seq"})}})();var Ht=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var sr=0;sr<Ht.length;++sr){var ar=Ht[sr];rt[ar]=St({args:["array","array"],pre:{args:[],body:"this_f=Math."+ar,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:ar}),rt[ar+"eq"]=St({args:["array"],pre:{args:[],body:"this_f=Math."+ar,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:ar+"eq"})}})();var tr=["max","min","atan2","pow"];(function(){for(var sr=0;sr<tr.length;++sr){var ar=tr[sr];rt[ar]=St({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+ar,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:ar}),rt[ar+"s"]=St({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+ar,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:ar+"s"}),rt[ar+"eq"]=St({args:["array","array"],pre:{args:[],body:"this_f=Math."+ar,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:ar+"eq"}),rt[ar+"seq"]=St({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+ar,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:ar+"seq"})}})();var rr=["atan2","pow"];(function(){for(var sr=0;sr<rr.length;++sr){var ar=rr[sr];rt[ar+"op"]=St({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+ar,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:ar+"op"}),rt[ar+"ops"]=St({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+ar,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:ar+"ops"}),rt[ar+"opeq"]=St({args:["array","array"],pre:{args:[],body:"this_f=Math."+ar,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:ar+"opeq"}),rt[ar+"opseq"]=St({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+ar,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:ar+"opseq"})}})(),rt.any=_({args:["array"],pre:ut,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),rt.all=_({args:["array"],pre:ut,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),rt.sum=_({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),rt.prod=_({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),rt.norm2squared=_({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),rt.norm2=_({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),rt.norminf=_({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),rt.norm1=_({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),rt.sup=_({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),rt.inf=_({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),rt.argmin=_({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),rt.argmax=_({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),rt.random=St({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),rt.assign=St({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),rt.assigns=St({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),rt.equals=_({args:["array","array"],pre:ut,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})}),Lv=qt((rt,_)=>{_.exports=function(ut,mt){for(var bt=ut.split("."),St=mt.split("."),Mt=0;Mt<3;Mt++){var Bt=Number(bt[Mt]),Ut=Number(St[Mt]);if(Bt>Ut)return 1;if(Ut>Bt)return-1;if(!isNaN(Bt)&&isNaN(Ut))return 1;if(isNaN(Bt)&&!isNaN(Ut))return-1}return 0}});function ef(rt){for(let _ of Object.keys(rt))rt[_]===void 0&&delete rt[_];return rt}function Wt(rt,_){return Object.setPrototypeOf(rt,_),rt}function $s(rt){return Array.isArray(rt)?rt:[rt]}function tf(rt,_){let ut=0;for(;ut<rt.length&&ut<_.length;){if(rt[ut]<_[ut])return-1;if(rt[ut]>_[ut])return 1;ut+=1}return ut!==_.length?-1:ut!==rt.length?1:0}var Jv=typeof global=="object"&&global&&global.Object===Object&&global,Ys=Jv,eb=typeof self=="object"&&self&&self.Object===Object&&self,tb=Ys||eb||Function("return this")(),lt=tb,rb=lt.Symbol,gt=rb,rf=Object.prototype,ob=rf.hasOwnProperty,nb=rf.toString,qa=gt?gt.toStringTag:void 0;function ib(rt){var _=ob.call(rt,qa),ut=rt[qa];try{rt[qa]=void 0;var mt=!0}catch{}var bt=nb.call(rt);return mt&&(_?rt[qa]=ut:delete rt[qa]),bt}var of=ib,ab=Object.prototype,sb=ab.toString;function lb(rt){return sb.call(rt)}var nf=lb,cb="[object Null]",ub="[object Undefined]",af=gt?gt.toStringTag:void 0;function db(rt){return rt==null?rt===void 0?ub:cb:af&&af in Object(rt)?of(rt):nf(rt)}var or=db;function pb(rt){return rt!=null&&typeof rt=="object"}var Ct=pb,fb="[object Symbol]";function hb(rt){return typeof rt=="symbol"||Ct(rt)&&or(rt)==fb}var Zn=hb;function mb(rt,_){for(var ut=-1,mt=rt==null?0:rt.length,bt=Array(mt);++ut<mt;)bt[ut]=_(rt[ut],ut,rt);return bt}var Xs=mb,yb=Array.isArray,Ze=yb,gb=1/0,sf=gt?gt.prototype:void 0,lf=sf?sf.toString:void 0;function cf(rt){if(typeof rt=="string")return rt;if(Ze(rt))return Xs(rt,cf)+"";if(Zn(rt))return lf?lf.call(rt):"";var _=rt+"";return _=="0"&&1/rt==-gb?"-0":_}var uf=cf;function xb(rt){var _=typeof rt;return rt!=null&&(_=="object"||_=="function")}var nr=xb;function vb(rt){return rt}var df=vb,bb="[object AsyncFunction]",Sb="[object Function]",wb="[object GeneratorFunction]",_b="[object Proxy]";function Ab(rt){if(!nr(rt))return!1;var _=or(rt);return _==Sb||_==wb||_==bb||_==_b}var Ks=Ab,Tb=lt["__core-js_shared__"],Qs=Tb,pf=function(){var rt=/[^.]+$/.exec(Qs&&Qs.keys&&Qs.keys.IE_PROTO||"");return rt?"Symbol(src)_1."+rt:""}();function Cb(rt){return!!pf&&pf in rt}var ff=Cb,Pb=Function.prototype,Ob=Pb.toString;function Mb(rt){if(rt!=null){try{return Ob.call(rt)}catch{}try{return rt+""}catch{}}return""}var po=Mb,Ib=/[\\^$.*+?()[\]{}|]/g,Nb=/^\[object .+?Constructor\]$/,Eb=Function.prototype,Db=Object.prototype,Lb=Eb.toString,Bb=Db.hasOwnProperty,Rb=RegExp("^"+Lb.call(Bb).replace(Ib,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Vb(rt){if(!nr(rt)||ff(rt))return!1;var _=Ks(rt)?Rb:Nb;return _.test(po(rt))}var hf=Vb;function Gb(rt,_){return rt==null?void 0:rt[_]}var mf=Gb;function zb(rt,_){var ut=mf(rt,_);return hf(ut)?ut:void 0}var $t=zb,kb=$t(lt,"WeakMap"),Zs=kb,yf=Object.create,Fb=function(){function rt(){}return function(_){if(!nr(_))return{};if(yf)return yf(_);rt.prototype=_;var ut=new rt;return rt.prototype=void 0,ut}}(),gf=Fb;function jb(rt,_,ut){switch(ut.length){case 0:return rt.call(_);case 1:return rt.call(_,ut[0]);case 2:return rt.call(_,ut[0],ut[1]);case 3:return rt.call(_,ut[0],ut[1],ut[2])}return rt.apply(_,ut)}var xf=jb;function Ub(rt,_){var ut=-1,mt=rt.length;for(_||(_=Array(mt));++ut<mt;)_[ut]=rt[ut];return _}var vf=Ub,Hb=800,qb=16,Wb=Date.now;function $b(rt){var _=0,ut=0;return function(){var mt=Wb(),bt=qb-(mt-ut);if(ut=mt,bt>0){if(++_>=Hb)return arguments[0]}else _=0;return rt.apply(void 0,arguments)}}var bf=$b;function Yb(rt){return function(){return rt}}var Sf=Yb,Xb=function(){try{var rt=$t(Object,"defineProperty");return rt({},"",{}),rt}catch{}}(),Jn=Xb,Kb=Jn?function(rt,_){return Jn(rt,"toString",{configurable:!0,enumerable:!1,value:Sf(_),writable:!0})}:df,wf=Kb,Qb=bf(wf),_f=Qb;function Zb(rt,_){for(var ut=-1,mt=rt==null?0:rt.length;++ut<mt&&_(rt[ut],ut,rt)!==!1;);return rt}var Af=Zb,Jb=9007199254740991,eS=/^(?:0|[1-9]\d*)$/;function tS(rt,_){var ut=typeof rt;return _=_??Jb,!!_&&(ut=="number"||ut!="symbol"&&eS.test(rt))&&rt>-1&&rt%1==0&&rt<_}var ei=tS;function rS(rt,_,ut){_=="__proto__"&&Jn?Jn(rt,_,{configurable:!0,enumerable:!0,value:ut,writable:!0}):rt[_]=ut}var Js=rS;function oS(rt,_){return rt===_||rt!==rt&&_!==_}var ti=oS,nS=Object.prototype,iS=nS.hasOwnProperty;function aS(rt,_,ut){var mt=rt[_];(!(iS.call(rt,_)&&ti(mt,ut))||ut===void 0&&!(_ in rt))&&Js(rt,_,ut)}var ri=aS;function sS(rt,_,ut,mt){var bt=!ut;ut||(ut={});for(var St=-1,Mt=_.length;++St<Mt;){var Bt=_[St],Ut=mt?mt(ut[Bt],rt[Bt],Bt,ut,rt):void 0;Ut===void 0&&(Ut=rt[Bt]),bt?Js(ut,Bt,Ut):ri(ut,Bt,Ut)}return ut}var Rr=sS,Tf=Math.max;function lS(rt,_,ut){return _=Tf(_===void 0?rt.length-1:_,0),function(){for(var mt=arguments,bt=-1,St=Tf(mt.length-_,0),Mt=Array(St);++bt<St;)Mt[bt]=mt[_+bt];bt=-1;for(var Bt=Array(_+1);++bt<_;)Bt[bt]=mt[bt];return Bt[_]=ut(Mt),xf(rt,this,Bt)}}var Cf=lS,cS=9007199254740991;function uS(rt){return typeof rt=="number"&&rt>-1&&rt%1==0&&rt<=cS}var oi=uS;function dS(rt){return rt!=null&&oi(rt.length)&&!Ks(rt)}var el=dS,pS=Object.prototype;function fS(rt){var _=rt&&rt.constructor,ut=typeof _=="function"&&_.prototype||pS;return rt===ut}var ni=fS;function hS(rt,_){for(var ut=-1,mt=Array(rt);++ut<rt;)mt[ut]=_(ut);return mt}var Pf=hS,mS="[object Arguments]";function yS(rt){return Ct(rt)&&or(rt)==mS}var yu=yS,Of=Object.prototype,gS=Of.hasOwnProperty,xS=Of.propertyIsEnumerable,vS=yu(function(){return arguments}())?yu:function(rt){return Ct(rt)&&gS.call(rt,"callee")&&!xS.call(rt,"callee")},ii=vS;function bS(){return!1}var Mf=bS,Ef=typeof exports=="object"&&exports&&!exports.nodeType&&exports,If=Ef&&typeof module=="object"&&module&&!module.nodeType&&module,SS=If&&If.exports===Ef,Nf=SS?lt.Buffer:void 0,wS=Nf?Nf.isBuffer:void 0,_S=wS||Mf,xn=_S,AS="[object Arguments]",TS="[object Array]",CS="[object Boolean]",PS="[object Date]",OS="[object Error]",MS="[object Function]",IS="[object Map]",NS="[object Number]",ES="[object Object]",DS="[object RegExp]",LS="[object Set]",BS="[object String]",RS="[object WeakMap]",VS="[object ArrayBuffer]",GS="[object DataView]",zS="[object Float32Array]",kS="[object Float64Array]",FS="[object Int8Array]",jS="[object Int16Array]",US="[object Int32Array]",HS="[object Uint8Array]",qS="[object Uint8ClampedArray]",WS$1="[object Uint16Array]",$S="[object Uint32Array]",qe={};qe[zS]=qe[kS]=qe[FS]=qe[jS]=qe[US]=qe[HS]=qe[qS]=qe[WS$1]=qe[$S]=!0;qe[AS]=qe[TS]=qe[VS]=qe[CS]=qe[GS]=qe[PS]=qe[OS]=qe[MS]=qe[IS]=qe[NS]=qe[ES]=qe[DS]=qe[LS]=qe[BS]=qe[RS]=!1;function YS(rt){return Ct(rt)&&oi(rt.length)&&!!qe[or(rt)]}var Df=YS;function XS(rt){return function(_){return rt(_)}}var ai=XS,Lf=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Wa=Lf&&typeof module=="object"&&module&&!module.nodeType&&module,KS=Wa&&Wa.exports===Lf,gu=KS&&Ys.process,QS=function(){try{var rt=Wa&&Wa.require&&Wa.require("util").types;return rt||gu&&gu.binding&&gu.binding("util")}catch{}}(),fo=QS,Bf=fo&&fo.isTypedArray,ZS=Bf?ai(Bf):Df,tl=ZS,JS=Object.prototype,e1=JS.hasOwnProperty;function t1(rt,_){var ut=Ze(rt),mt=!ut&&ii(rt),bt=!ut&&!mt&&xn(rt),St=!ut&&!mt&&!bt&&tl(rt),Mt=ut||mt||bt||St,Bt=Mt?Pf(rt.length,String):[],Ut=Bt.length;for(var Ht in rt)(_||e1.call(rt,Ht))&&!(Mt&&(Ht=="length"||bt&&(Ht=="offset"||Ht=="parent")||St&&(Ht=="buffer"||Ht=="byteLength"||Ht=="byteOffset")||ei(Ht,Ut)))&&Bt.push(Ht);return Bt}var rl=t1;function r1(rt,_){return function(ut){return rt(_(ut))}}var ol=r1,o1=ol(Object.keys,Object),Rf=o1,n1=Object.prototype,i1=n1.hasOwnProperty;function a1(rt){if(!ni(rt))return Rf(rt);var _=[];for(var ut in Object(rt))i1.call(rt,ut)&&ut!="constructor"&&_.push(ut);return _}var Vf=a1;function s1(rt){return el(rt)?rl(rt):Vf(rt)}var si=s1;function l1(rt){var _=[];if(rt!=null)for(var ut in Object(rt))_.push(ut);return _}var Gf=l1,c1=Object.prototype,u1=c1.hasOwnProperty;function d1(rt){if(!nr(rt))return Gf(rt);var _=ni(rt),ut=[];for(var mt in rt)mt=="constructor"&&(_||!u1.call(rt,mt))||ut.push(mt);return ut}var zf=d1;function p1(rt){return el(rt)?rl(rt,!0):zf(rt)}var li=p1,f1=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h1=/^\w*$/;function m1(rt,_){if(Ze(rt))return!1;var ut=typeof rt;return ut=="number"||ut=="symbol"||ut=="boolean"||rt==null||Zn(rt)?!0:h1.test(rt)||!f1.test(rt)||_!=null&&rt in Object(_)}var kf=m1,y1=$t(Object,"create"),ho=y1;function g1(){this.__data__=ho?ho(null):{},this.size=0}var Ff=g1;function x1(rt){var _=this.has(rt)&&delete this.__data__[rt];return this.size-=_?1:0,_}var jf=x1,v1="__lodash_hash_undefined__",b1=Object.prototype,S1=b1.hasOwnProperty;function w1(rt){var _=this.__data__;if(ho){var ut=_[rt];return ut===v1?void 0:ut}return S1.call(_,rt)?_[rt]:void 0}var Uf=w1,_1=Object.prototype,A1=_1.hasOwnProperty;function T1(rt){var _=this.__data__;return ho?_[rt]!==void 0:A1.call(_,rt)}var Hf=T1,C1="__lodash_hash_undefined__";function P1(rt,_){var ut=this.__data__;return this.size+=this.has(rt)?0:1,ut[rt]=ho&&_===void 0?C1:_,this}var qf=P1;function ci(rt){var _=-1,ut=rt==null?0:rt.length;for(this.clear();++_<ut;){var mt=rt[_];this.set(mt[0],mt[1])}}ci.prototype.clear=Ff;ci.prototype.delete=jf;ci.prototype.get=Uf;ci.prototype.has=Hf;ci.prototype.set=qf;var xu=ci;function O1(){this.__data__=[],this.size=0}var Wf=O1;function M1(rt,_){for(var ut=rt.length;ut--;)if(ti(rt[ut][0],_))return ut;return-1}var Eo=M1,I1=Array.prototype,N1=I1.splice;function E1(rt){var _=this.__data__,ut=Eo(_,rt);if(ut<0)return!1;var mt=_.length-1;return ut==mt?_.pop():N1.call(_,ut,1),--this.size,!0}var $f=E1;function D1(rt){var _=this.__data__,ut=Eo(_,rt);return ut<0?void 0:_[ut][1]}var Yf=D1;function L1(rt){return Eo(this.__data__,rt)>-1}var Xf=L1;function B1(rt,_){var ut=this.__data__,mt=Eo(ut,rt);return mt<0?(++this.size,ut.push([rt,_])):ut[mt][1]=_,this}var Kf=B1;function ui(rt){var _=-1,ut=rt==null?0:rt.length;for(this.clear();++_<ut;){var mt=rt[_];this.set(mt[0],mt[1])}}ui.prototype.clear=Wf;ui.prototype.delete=$f;ui.prototype.get=Yf;ui.prototype.has=Xf;ui.prototype.set=Kf;var Do=ui,R1=$t(lt,"Map"),Lo=R1;function V1(){this.size=0,this.__data__={hash:new xu,map:new(Lo||Do),string:new xu}}var Qf=V1;function G1(rt){var _=typeof rt;return _=="string"||_=="number"||_=="symbol"||_=="boolean"?rt!=="__proto__":rt===null}var Zf=G1;function z1(rt,_){var ut=rt.__data__;return Zf(_)?ut[typeof _=="string"?"string":"hash"]:ut.map}var Bo=z1;function k1(rt){var _=Bo(this,rt).delete(rt);return this.size-=_?1:0,_}var Jf=k1;function F1(rt){return Bo(this,rt).get(rt)}var eh=F1;function j1(rt){return Bo(this,rt).has(rt)}var th=j1;function U1(rt,_){var ut=Bo(this,rt),mt=ut.size;return ut.set(rt,_),this.size+=ut.size==mt?0:1,this}var rh=U1;function di(rt){var _=-1,ut=rt==null?0:rt.length;for(this.clear();++_<ut;){var mt=rt[_];this.set(mt[0],mt[1])}}di.prototype.clear=Qf;di.prototype.delete=Jf;di.prototype.get=eh;di.prototype.has=th;di.prototype.set=rh;var vn=di,H1="Expected a function";function vu(rt,_){if(typeof rt!="function"||_!=null&&typeof _!="function")throw new TypeError(H1);var ut=function(){var mt=arguments,bt=_?_.apply(this,mt):mt[0],St=ut.cache;if(St.has(bt))return St.get(bt);var Mt=rt.apply(this,mt);return ut.cache=St.set(bt,Mt)||St,Mt};return ut.cache=new(vu.Cache||vn),ut}vu.Cache=vn;var oh=vu,q1=500;function W1(rt){var _=oh(rt,function(mt){return ut.size===q1&&ut.clear(),mt}),ut=_.cache;return _}var nh=W1,$1=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Y1=/\\(\\)?/g,X1=nh(function(rt){var _=[];return rt.charCodeAt(0)===46&&_.push(""),rt.replace($1,function(ut,mt,bt,St){_.push(bt?St.replace(Y1,"$1"):mt||ut)}),_}),ih=X1;function K1(rt){return rt==null?"":uf(rt)}var ah=K1;function Q1(rt,_){return Ze(rt)?rt:kf(rt,_)?[rt]:ih(ah(rt))}var ur=Q1,Z1=1/0;function J1(rt){if(typeof rt=="string"||Zn(rt))return rt;var _=rt+"";return _=="0"&&1/rt==-Z1?"-0":_}var Ro=J1;function ew(rt,_){_=ur(_,rt);for(var ut=0,mt=_.length;rt!=null&&ut<mt;)rt=rt[Ro(_[ut++])];return ut&&ut==mt?rt:void 0}var nl=ew;function tw(rt,_){for(var ut=-1,mt=_.length,bt=rt.length;++ut<mt;)rt[bt+ut]=_[ut];return rt}var pi=tw,sh=gt?gt.isConcatSpreadable:void 0;function rw(rt){return Ze(rt)||ii(rt)||!!(sh&&rt&&rt[sh])}var lh=rw;function ch(rt,_,ut,mt,bt){var St=-1,Mt=rt.length;for(ut||(ut=lh),bt||(bt=[]);++St<Mt;){var Bt=rt[St];_>0&&ut(Bt)?_>1?ch(Bt,_-1,ut,mt,bt):pi(bt,Bt):mt||(bt[bt.length]=Bt)}return bt}var uh=ch;function ow(rt){var _=rt==null?0:rt.length;return _?uh(rt,1):[]}var dh=ow;function nw(rt){return _f(Cf(rt,void 0,dh),rt+"")}var il=nw,iw=ol(Object.getPrototypeOf,Object),fi=iw,aw="[object Object]",sw=Function.prototype,lw=Object.prototype,ph=sw.toString,cw=lw.hasOwnProperty,uw=ph.call(Object);function dw(rt){if(!Ct(rt)||or(rt)!=aw)return!1;var _=fi(rt);if(_===null)return!0;var ut=cw.call(_,"constructor")&&_.constructor;return typeof ut=="function"&&ut instanceof ut&&ph.call(ut)==uw}var fh=dw;function pw(rt,_,ut){var mt=-1,bt=rt.length;_<0&&(_=-_>bt?0:bt+_),ut=ut>bt?bt:ut,ut<0&&(ut+=bt),bt=_>ut?0:ut-_>>>0,_>>>=0;for(var St=Array(bt);++mt<bt;)St[mt]=rt[mt+_];return St}var hh=pw;function fw(){this.__data__=new Do,this.size=0}var mh=fw;function hw(rt){var _=this.__data__,ut=_.delete(rt);return this.size=_.size,ut}var yh=hw;function mw(rt){return this.__data__.get(rt)}var gh=mw;function yw(rt){return this.__data__.has(rt)}var xh=yw,gw=200;function xw(rt,_){var ut=this.__data__;if(ut instanceof Do){var mt=ut.__data__;if(!Lo||mt.length<gw-1)return mt.push([rt,_]),this.size=++ut.size,this;ut=this.__data__=new vn(mt)}return ut.set(rt,_),this.size=ut.size,this}var vh$1=xw;function hi(rt){var _=this.__data__=new Do(rt);this.size=_.size}hi.prototype.clear=mh;hi.prototype.delete=yh;hi.prototype.get=gh;hi.prototype.has=xh;hi.prototype.set=vh$1;var mi=hi;function vw$1(rt,_){return rt&&Rr(_,si(_),rt)}var bh=vw$1;function bw(rt,_){return rt&&Rr(_,li(_),rt)}var Sh=bw,Th=typeof exports=="object"&&exports&&!exports.nodeType&&exports,wh=Th&&typeof module=="object"&&module&&!module.nodeType&&module,Sw=wh&&wh.exports===Th,_h=Sw?lt.Buffer:void 0,Ah=_h?_h.allocUnsafe:void 0;function ww(rt,_){if(_)return rt.slice();var ut=rt.length,mt=Ah?Ah(ut):new rt.constructor(ut);return rt.copy(mt),mt}var Ch=ww;function _w(rt,_){for(var ut=-1,mt=rt==null?0:rt.length,bt=0,St=[];++ut<mt;){var Mt=rt[ut];_(Mt,ut,rt)&&(St[bt++]=Mt)}return St}var Ph=_w;function Aw(){return[]}var al=Aw,Tw=Object.prototype,Cw=Tw.propertyIsEnumerable,Oh=Object.getOwnPropertySymbols,Pw=Oh?function(rt){return rt==null?[]:(rt=Object(rt),Ph(Oh(rt),function(_){return Cw.call(rt,_)}))}:al,yi=Pw;function Ow(rt,_){return Rr(rt,yi(rt),_)}var Mh=Ow,Mw=Object.getOwnPropertySymbols,Iw=Mw?function(rt){for(var _=[];rt;)pi(_,yi(rt)),rt=fi(rt);return _}:al,sl=Iw;function Nw(rt,_){return Rr(rt,sl(rt),_)}var Ih=Nw;function Ew(rt,_,ut){var mt=_(rt);return Ze(rt)?mt:pi(mt,ut(rt))}var ll=Ew;function Dw(rt){return ll(rt,si,yi)}var $a=Dw;function Lw(rt){return ll(rt,li,sl)}var cl=Lw,Bw=$t(lt,"DataView"),ul=Bw,Rw=$t(lt,"Promise"),dl=Rw,Vw=$t(lt,"Set"),pl=Vw,Nh="[object Map]",Gw="[object Object]",Eh="[object Promise]",Dh="[object Set]",Lh="[object WeakMap]",Bh="[object DataView]",zw=po(ul),kw=po(Lo),Fw=po(dl),jw=po(pl),Uw=po(Zs),bn=or;(ul&&bn(new ul(new ArrayBuffer(1)))!=Bh||Lo&&bn(new Lo)!=Nh||dl&&bn(dl.resolve())!=Eh||pl&&bn(new pl)!=Dh||Zs&&bn(new Zs)!=Lh)&&(bn=function(rt){var _=or(rt),ut=_==Gw?rt.constructor:void 0,mt=ut?po(ut):"";if(mt)switch(mt){case zw:return Bh;case kw:return Nh;case Fw:return Eh;case jw:return Dh;case Uw:return Lh}return _});var mo=bn,Hw=Object.prototype,qw=Hw.hasOwnProperty;function Ww(rt){var _=rt.length,ut=new rt.constructor(_);return _&&typeof rt[0]=="string"&&qw.call(rt,"index")&&(ut.index=rt.index,ut.input=rt.input),ut}var Rh=Ww,$w=lt.Uint8Array,gi=$w;function Yw(rt){var _=new rt.constructor(rt.byteLength);return new gi(_).set(new gi(rt)),_}var xi=Yw;function Xw(rt,_){var ut=_?xi(rt.buffer):rt.buffer;return new rt.constructor(ut,rt.byteOffset,rt.byteLength)}var Vh=Xw,Kw=/\w*$/;function Qw(rt){var _=new rt.constructor(rt.source,Kw.exec(rt));return _.lastIndex=rt.lastIndex,_}var Gh=Qw,zh=gt?gt.prototype:void 0,kh=zh?zh.valueOf:void 0;function Zw(rt){return kh?Object(kh.call(rt)):{}}var Fh=Zw;function Jw(rt,_){var ut=_?xi(rt.buffer):rt.buffer;return new rt.constructor(ut,rt.byteOffset,rt.length)}var jh=Jw,e_="[object Boolean]",t_="[object Date]",r_="[object Map]",o_="[object Number]",n_="[object RegExp]",i_="[object Set]",a_="[object String]",s_="[object Symbol]",l_="[object ArrayBuffer]",c_="[object DataView]",u_="[object Float32Array]",d_="[object Float64Array]",p_="[object Int8Array]",f_="[object Int16Array]",h_="[object Int32Array]",m_="[object Uint8Array]",y_="[object Uint8ClampedArray]",g_="[object Uint16Array]",x_="[object Uint32Array]";function v_(rt,_,ut){var mt=rt.constructor;switch(_){case l_:return xi(rt);case e_:case t_:return new mt(+rt);case c_:return Vh(rt,ut);case u_:case d_:case p_:case f_:case h_:case m_:case y_:case g_:case x_:return jh(rt,ut);case r_:return new mt;case o_:case a_:return new mt(rt);case n_:return Gh(rt);case i_:return new mt;case s_:return Fh(rt)}}var Uh=v_;function b_(rt){return typeof rt.constructor=="function"&&!ni(rt)?gf(fi(rt)):{}}var Hh=b_,S_="[object Map]";function w_(rt){return Ct(rt)&&mo(rt)==S_}var qh=w_,Wh=fo&&fo.isMap,__=Wh?ai(Wh):qh,$h=__,A_="[object Set]";function T_(rt){return Ct(rt)&&mo(rt)==A_}var Yh=T_,Xh=fo&&fo.isSet,C_=Xh?ai(Xh):Yh,Kh=C_,P_=1,O_=2,M_=4,Qh="[object Arguments]",I_="[object Array]",N_="[object Boolean]",E_="[object Date]",D_="[object Error]",Zh="[object Function]",L_="[object GeneratorFunction]",B_="[object Map]",R_="[object Number]",Jh="[object Object]",V_="[object RegExp]",G_="[object Set]",z_="[object String]",k_="[object Symbol]",F_="[object WeakMap]",j_="[object ArrayBuffer]",U_="[object DataView]",H_="[object Float32Array]",q_="[object Float64Array]",W_="[object Int8Array]",$_="[object Int16Array]",Y_="[object Int32Array]",X_="[object Uint8Array]",K_="[object Uint8ClampedArray]",Q_="[object Uint16Array]",Z_="[object Uint32Array]",Ue={};Ue[Qh]=Ue[I_]=Ue[j_]=Ue[U_]=Ue[N_]=Ue[E_]=Ue[H_]=Ue[q_]=Ue[W_]=Ue[$_]=Ue[Y_]=Ue[B_]=Ue[R_]=Ue[Jh]=Ue[V_]=Ue[G_]=Ue[z_]=Ue[k_]=Ue[X_]=Ue[K_]=Ue[Q_]=Ue[Z_]=!0;Ue[D_]=Ue[Zh]=Ue[F_]=!1;function fl(rt,_,ut,mt,bt,St){var Mt,Bt=_&P_,Ut=_&O_,Ht=_&M_;if(ut&&(Mt=bt?ut(rt,mt,bt,St):ut(rt)),Mt!==void 0)return Mt;if(!nr(rt))return rt;var tr=Ze(rt);if(tr){if(Mt=Rh(rt),!Bt)return vf(rt,Mt)}else{var rr=mo(rt),sr=rr==Zh||rr==L_;if(xn(rt))return Ch(rt,Bt);if(rr==Jh||rr==Qh||sr&&!bt){if(Mt=Ut||sr?{}:Hh(rt),!Bt)return Ut?Ih(rt,Sh(Mt,rt)):Mh(rt,bh(Mt,rt))}else{if(!Ue[rr])return bt?rt:{};Mt=Uh(rt,rr,Bt)}}St||(St=new mi);var ar=St.get(rt);if(ar)return ar;St.set(rt,Mt),Kh(rt)?rt.forEach(function(_r){Mt.add(fl(_r,_,ut,_r,rt,St))}):$h(rt)&&rt.forEach(function(_r,Dr){Mt.set(Dr,fl(_r,_,ut,Dr,rt,St))});var cr=Ht?Ut?cl:$a:Ut?li:si,Ar=tr?void 0:cr(rt);return Af(Ar||rt,function(_r,Dr){Ar&&(Dr=_r,_r=rt[Dr]),ri(Mt,Dr,fl(_r,_,ut,Dr,rt,St))}),Mt}var hl=fl,J_=1,eA=4;function tA(rt){return hl(rt,J_|eA)}var yo=tA,rA="__lodash_hash_undefined__";function oA(rt){return this.__data__.set(rt,rA),this}var em=oA;function nA(rt){return this.__data__.has(rt)}var tm=nA;function ml(rt){var _=-1,ut=rt==null?0:rt.length;for(this.__data__=new vn;++_<ut;)this.add(rt[_])}ml.prototype.add=ml.prototype.push=em;ml.prototype.has=tm;var rm=ml;function iA(rt,_){for(var ut=-1,mt=rt==null?0:rt.length;++ut<mt;)if(_(rt[ut],ut,rt))return!0;return!1}var om=iA;function aA(rt,_){return rt.has(_)}var nm=aA,sA=1,lA=2;function cA(rt,_,ut,mt,bt,St){var Mt=ut&sA,Bt=rt.length,Ut=_.length;if(Bt!=Ut&&!(Mt&&Ut>Bt))return!1;var Ht=St.get(rt),tr=St.get(_);if(Ht&&tr)return Ht==_&&tr==rt;var rr=-1,sr=!0,ar=ut&lA?new rm:void 0;for(St.set(rt,_),St.set(_,rt);++rr<Bt;){var cr=rt[rr],Ar=_[rr];if(mt)var _r=Mt?mt(Ar,cr,rr,_,rt,St):mt(cr,Ar,rr,rt,_,St);if(_r!==void 0){if(_r)continue;sr=!1;break}if(ar){if(!om(_,function(Dr,$r){if(!nm(ar,$r)&&(cr===Dr||bt(cr,Dr,ut,mt,St)))return ar.push($r)})){sr=!1;break}}else if(!(cr===Ar||bt(cr,Ar,ut,mt,St))){sr=!1;break}}return St.delete(rt),St.delete(_),sr}var yl=cA;function uA(rt){var _=-1,ut=Array(rt.size);return rt.forEach(function(mt,bt){ut[++_]=[bt,mt]}),ut}var im=uA;function dA(rt){var _=-1,ut=Array(rt.size);return rt.forEach(function(mt){ut[++_]=mt}),ut}var am=dA,pA=1,fA=2,hA="[object Boolean]",mA="[object Date]",yA="[object Error]",gA="[object Map]",xA="[object Number]",vA="[object RegExp]",bA="[object Set]",SA="[object String]",wA="[object Symbol]",_A="[object ArrayBuffer]",AA="[object DataView]",sm=gt?gt.prototype:void 0,bu=sm?sm.valueOf:void 0;function TA(rt,_,ut,mt,bt,St,Mt){switch(ut){case AA:if(rt.byteLength!=_.byteLength||rt.byteOffset!=_.byteOffset)return!1;rt=rt.buffer,_=_.buffer;case _A:return!(rt.byteLength!=_.byteLength||!St(new gi(rt),new gi(_)));case hA:case mA:case xA:return ti(+rt,+_);case yA:return rt.name==_.name&&rt.message==_.message;case vA:case SA:return rt==_+"";case gA:var Bt=im;case bA:var Ut=mt&pA;if(Bt||(Bt=am),rt.size!=_.size&&!Ut)return!1;var Ht=Mt.get(rt);if(Ht)return Ht==_;mt|=fA,Mt.set(rt,_);var tr=yl(Bt(rt),Bt(_),mt,bt,St,Mt);return Mt.delete(rt),tr;case wA:if(bu)return bu.call(rt)==bu.call(_)}return!1}var lm=TA,CA=1,PA=Object.prototype,OA=PA.hasOwnProperty;function MA(rt,_,ut,mt,bt,St){var Mt=ut&CA,Bt=$a(rt),Ut=Bt.length,Ht=$a(_),tr=Ht.length;if(Ut!=tr&&!Mt)return!1;for(var rr=Ut;rr--;){var sr=Bt[rr];if(!(Mt?sr in _:OA.call(_,sr)))return!1}var ar=St.get(rt),cr=St.get(_);if(ar&&cr)return ar==_&&cr==rt;var Ar=!0;St.set(rt,_),St.set(_,rt);for(var _r=Mt;++rr<Ut;){sr=Bt[rr];var Dr=rt[sr],$r=_[sr];if(mt)var Br=Mt?mt($r,Dr,sr,_,rt,St):mt(Dr,$r,sr,rt,_,St);if(!(Br===void 0?Dr===$r||bt(Dr,$r,ut,mt,St):Br)){Ar=!1;break}_r||(_r=sr=="constructor")}if(Ar&&!_r){var Jr=rt.constructor,mn=_.constructor;Jr!=mn&&"constructor"in rt&&"constructor"in _&&!(typeof Jr=="function"&&Jr instanceof Jr&&typeof mn=="function"&&mn instanceof mn)&&(Ar=!1)}return St.delete(rt),St.delete(_),Ar}var cm=MA,IA=1,um="[object Arguments]",dm="[object Array]",gl="[object Object]",NA=Object.prototype,pm=NA.hasOwnProperty;function EA(rt,_,ut,mt,bt,St){var Mt=Ze(rt),Bt=Ze(_),Ut=Mt?dm:mo(rt),Ht=Bt?dm:mo(_);Ut=Ut==um?gl:Ut,Ht=Ht==um?gl:Ht;var tr=Ut==gl,rr=Ht==gl,sr=Ut==Ht;if(sr&&xn(rt)){if(!xn(_))return!1;Mt=!0,tr=!1}if(sr&&!tr)return St||(St=new mi),Mt||tl(rt)?yl(rt,_,ut,mt,bt,St):lm(rt,_,Ut,ut,mt,bt,St);if(!(ut&IA)){var ar=tr&&pm.call(rt,"__wrapped__"),cr=rr&&pm.call(_,"__wrapped__");if(ar||cr){var Ar=ar?rt.value():rt,_r=cr?_.value():_;return St||(St=new mi),bt(Ar,_r,ut,mt,St)}}return sr?(St||(St=new mi),cm(rt,_,ut,mt,bt,St)):!1}var fm=EA;function hm(rt,_,ut,mt,bt){return rt===_?!0:rt==null||_==null||!Ct(rt)&&!Ct(_)?rt!==rt&&_!==_:fm(rt,_,ut,mt,hm,bt)}var mm=hm;function DA(rt,_){return rt!=null&&_ in Object(rt)}var ym=DA;function LA(rt,_,ut){_=ur(_,rt);for(var mt=-1,bt=_.length,St=!1;++mt<bt;){var Mt=Ro(_[mt]);if(!(St=rt!=null&&ut(rt,Mt)))break;rt=rt[Mt]}return St||++mt!=bt?St:(bt=rt==null?0:rt.length,!!bt&&oi(bt)&&ei(Mt,bt)&&(Ze(rt)||ii(rt)))}var gm=LA;function BA(rt,_){return rt!=null&&gm(rt,_,ym)}var xm=BA;function RA(rt){var _=rt==null?0:rt.length;return _?rt[_-1]:void 0}var vm=RA;function VA(rt,_){return _.length<2?rt:nl(rt,hh(_,0,-1))}var bm=VA;function GA(rt,_){return mm(rt,_)}var Su=GA;function zA(rt,_){return _=ur(_,rt),rt=bm(rt,_),rt==null||delete rt[Ro(vm(_))]}var Sm=zA;function kA(rt){return fh(rt)?void 0:rt}var wm=kA,FA=1,jA=2,UA=4,HA=il(function(rt,_){var ut={};if(rt==null)return ut;var mt=!1;_=Xs(_,function(St){return St=ur(St,rt),mt||(mt=St.length>1),St}),Rr(rt,cl(rt),ut),mt&&(ut=hl(ut,FA|jA|UA,wm));for(var bt=_.length;bt--;)Sm(ut,_[bt]);return ut}),vi=HA;function qA(rt,_,ut,mt){if(!nr(rt))return rt;_=ur(_,rt);for(var bt=-1,St=_.length,Mt=St-1,Bt=rt;Bt!=null&&++bt<St;){var Ut=Ro(_[bt]),Ht=ut;if(Ut==="__proto__"||Ut==="constructor"||Ut==="prototype")return rt;if(bt!=Mt){var tr=Bt[Ut];Ht=mt?mt(tr,Ut,Bt):void 0,Ht===void 0&&(Ht=nr(tr)?tr:ei(_[bt+1])?[]:{})}ri(Bt,Ut,Ht),Bt=Bt[Ut]}return rt}var _m=qA;function WA(rt,_,ut){for(var mt=-1,bt=_.length,St={};++mt<bt;){var Mt=_[mt],Bt=nl(rt,Mt);ut(Bt,Mt)&&_m(St,ur(Mt,rt),Bt)}return St}var Am=WA;function $A(rt,_){return Am(rt,_,function(ut,mt){return xm(rt,mt)})}var Tm=$A,YA=il(function(rt,_){return rt==null?{}:Tm(rt,_)}),xr=YA,he=class{modifyById(rt,_){let ut=this;if(ut[rt]===void 0)throw new Error("not expected");{let mt={...ut,[rt]:_};return Object.setPrototypeOf(mt,he.prototype),mt}}add(rt,_){var ut;return((ut=this.runOp({type:1,id:rt,data:_}))==null?void 0:ut.data)??this}runOp(rt){let _=this;if(rt.type===1){let ut=_[rt.id],mt;ut===void 0?mt={type:2,id:rt.id}:mt={type:1,id:rt.id,data:ut};let{id:bt,data:St}=rt,Mt={..._,[bt]:St};return Object.setPrototypeOf(Mt,he.prototype),{data:Mt,actual:rt,reverse:mt}}else if(rt.type===2){let{id:ut}=rt,mt=_[ut];if(mt===void 0)return null;{let bt={..._};return Object.setPrototypeOf(bt,he.prototype),delete bt[ut],{data:bt,actual:rt,reverse:{type:1,id:ut,data:mt}}}}return null}};function Ya(rt){if(rt.deepFreeze!==void 0){rt.deepFreeze(rt);return}let _=Object.getOwnPropertyNames(rt);for(let ut of _){let mt=rt[ut];mt&&typeof mt=="object"&&Ya(mt)}return Object.freeze(rt)}function Cm(rt,_){let ut=0;for(;ut<rt.length&&ut<_.length;){if(rt[ut]<_[ut])return-1;if(rt[ut]>_[ut])return 1;ut+=1}return ut!==_.length?-1:ut!==rt.length?1:0}var bi=class extends Error{};function xl(rt){let _={...rt};return Object.setPrototypeOf(_,Object.getPrototypeOf(rt)),_}function Vr(rt,_,ut){if(rt===void 0?_===void 0?(rt=0,_=10):rt=_-10:_===void 0&&(_=rt+10),rt>_){let St=rt;rt=_,_=St}let mt=[],bt=1/(ut+1);for(let St=0;St<ut;St++){let Mt=rt+(_-rt)*(St+.75+Math.random()*.5)*bt;mt.push(Mt)}return mt}function Si(rt){return rt instanceof Uint8Array||rt instanceof Uint16Array||rt instanceof Uint32Array||rt instanceof Int8Array||rt instanceof Int16Array||rt instanceof Int32Array||rt instanceof Float32Array||rt instanceof Float64Array}function Pm(){return typeof process<"u"}function Om(rt,_){for(let ut of rt)_(ut.id,ut.data)!==!0&&Om(ut.children,_)}function Mm(rt,_){if(_(rt.id,rt.data)!==!0)for(let ut of rt.children)Mm(ut,_)}var $e=class extends Array{constructor(...rt){super(...rt),Object.setPrototypeOf(this,$e.prototype)}deepFreeze(){let rt=0;for(;rt<this.length;)Ya(this[rt]),rt++}fillCaches0(rt,_){this.objCaches.set(rt.id,rt),this.parentCaches.set(rt.id,_);for(let ut of rt.children)this.fillCaches0(ut,rt.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let rt of this)this.fillCaches0(rt,null)}}randomId(){this.fillCaches();let rt=Array.from(this.objCaches.keys());if(rt.length!==0)return rt[Math.max(0,Math.floor(Math.random()*rt.length)-1)]}nonExistOrDescendantOf(rt,_){if(!this.has(rt))return!0;for(;rt;){let ut=this.parent(rt);if(ut===_)return!0;rt=ut}return!1}rootAcestor(rt){for(;rt;){let _=this.parent(rt);if(_)rt=_;else return rt}return rt}isDescendantOf(rt,_){for(;rt;){let ut=this.parent(rt);if(ut===_)return!0;rt=ut}return!1}data(rt){var _;return(_=this.get(rt))==null?void 0:_.data}has(rt){return this.childrenOf(rt)!==void 0}get(rt){return this.fillCaches(),this.objCaches.get(rt)}childrenOf(rt){var _;return rt===null?this:(_=this.get(rt))==null?void 0:_.children}traverseFrom(rt,_){if(rt===null)this.traverse(_);else{let ut=this.get(rt);ut&&Mm(ut,_)}}traverse(rt){Om(this,rt)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(rt){return this.fillCaches(),this.parentCaches.get(rt)}childrenArray(rt){return rt===null?this:this.get(rt).children}modifyById(rt,_){if(this.get(rt)===void 0)throw new Error("not expected");{let ut=this.parent(rt),mt=this.childrenArray(ut),bt=mt.findIndex(Mt=>Mt.id===rt);if(bt<0)throw new Error("not expected");let St=mt[bt];return mt=[...mt],mt[bt]={...St,data:_},this.modifyArrayBy(ut,mt)}}modifyArrayBy(rt,_){let ut=rt,mt=_;for(;ut!==null;){let St=mt,Mt=ut;if(ut=this.parent(ut),ut===void 0)throw new Error;mt=this.childrenArray(ut);let Bt=mt.findIndex(Ut=>Ut.id===Mt);if(Bt<0)throw new Error;mt=[...mt],mt[Bt]={...mt[Bt],children:St}}Object.setPrototypeOf(mt,$e.prototype);let bt=mt;return bt.fillCaches(),bt}runOp(rt){switch(rt.type){case 7:return this.addOp(rt);case 8:return this.deleteOp(rt);case 9:return this.moveOp(rt)}return null}checkDuplicatedIdRec({id:rt,children:_}){if(this.get(rt)!==void 0)return!0;for(let ut of _)if(this.checkDuplicatedIdRec(ut))return!0;return!1}addOp(rt){let{parent:_,fi:ut,id:mt,data:bt,children:St}=rt;if(_!==null&&this.get(_)===void 0||this.checkDuplicatedIdRec(rt))return null;{let Mt=_,Bt=this.childrenArray(Mt),Ut={fi:ut,id:mt,data:bt,children:St};return Bt=[...Bt,Ut],Bt.sort((Ht,tr)=>Ht.fi-tr.fi),rt.localIndex=Bt.indexOf(Ut),{data:this.modifyArrayBy(Mt,Bt),actual:rt,reverse:{type:8,id:mt}}}}deleteOp(rt){let{id:_}=rt;if(this.get(_)===null)return null;{let ut=this.parent(_);if(ut===void 0)return null;let mt=this.childrenArray(ut),bt=mt.findIndex(Mt=>Mt.id===_);rt.localIndex=bt,mt=[...mt];let St=mt.splice(bt,1)[0];return{data:this.modifyArrayBy(ut,mt),actual:rt,reverse:{type:7,...St,parent:ut}}}}moveOp(rt){let{parent:_,fi:ut,id:mt}=rt;if(_!==null&&this.get(_)===void 0)return this.deleteOp({type:8,id:mt});if(_!==null){let rr=_;for(;rr!==null;){if(rr===void 0)throw new Error;if(rr===mt)throw new bi("cyclic tree");rr=this.parent(rr)}}let bt=this.parent(mt);if(bt===void 0)return null;let St=bt,Mt=this.childrenArray(bt),Bt=Mt.findIndex(rr=>rr.id===mt);Mt=[...Mt];let Ut=Mt.splice(Bt,1)[0],Ht=this.modifyArrayBy(bt,Mt);bt=_,Mt=Ht.childrenArray(bt);let tr=Ut.fi;return Ut={...Ut,fi:ut},Mt=[...Mt,Ut],Mt.sort((rr,sr)=>rr.fi-sr.fi),rt.localIndex=Mt.indexOf(Ut),Ht=Ht.modifyArrayBy(bt,Mt),{data:Ht,actual:rt,reverse:{type:9,parent:St,fi:tr,id:mt}}}previous(rt,_){if(_===null){let mt=this.childrenArray(rt);return mt.length===0?null:mt[mt.length-1].id}let ut=null;for(let mt of this.childrenArray(rt)){if(mt.id===_)return ut;ut=mt.id}return null}traverseSortNext(rt){let _=this.parent(rt);if(_!==void 0){let ut=this.childrenArray(_),mt=ut.findIndex(bt=>bt.id===rt)+1;if(mt<ut.length)return ut[mt].id;if(_)return this.traverseSortNext(_)}}sortNext(rt){let _=this.childrenArray(rt);return _.length>0?_[0].id:this.traverseSortNext(rt)}traverseSortPrevious(rt){let _=this.childrenArray(rt);return _.length>0?this.traverseSortPrevious(_[_.length-1].id):rt}sortPrevious(rt){let _=this.parent(rt);if(_!==void 0){let ut=this.childrenArray(_),mt=ut.findIndex(bt=>bt.id===rt)-1;return mt>=0?this.traverseSortPrevious(ut[mt].id):_}}getAllSorted(rt){let _=[];for(let ut of rt){let mt=this.getWithSortKey(ut.id);mt!==void 0&&_.push({...ut,...mt})}_.sort((ut,mt)=>Cm(ut.sortKey,mt.sortKey));for(let ut of _)delete ut.sortKey;return _}getWithSortKey(rt){var _=rt;let ut=[],mt=this.get(_),bt=mt;if(mt!==void 0){for(;_;)ut.splice(0,0,mt.fi),_=this.parent(_),_!==null&&(mt=this.get(_));return{...bt,sortKey:ut}}}insertBeforeHelper(rt,_,ut){return this.insertAfterHelper(rt,this.previous(rt,_),ut)}insertAfterHelper(rt,_,ut){let mt=this.childrenArray(rt);if(_===null){if(mt.length===0)return Vr(0,ut,ut);{let bt=mt[0].fi;return Vr(bt-ut,bt,ut)}}else{let bt=this.get(_);if(bt===void 0||this.parent(_)!==rt)throw new Error("illegal args");let St=mt.find(Mt=>Mt.fi>bt.fi);if(St===void 0){let Mt=mt[mt.length-1].fi;return Vr(Mt,Mt+ut,ut)}else return Vr(bt.fi,St.fi,ut)}}},wi;(rt=>{function _(ut,mt){if(mt.type!==0)return null;if(Array.isArray(ut)){let bt=mt.props,St={},Mt=[...ut],Bt=!1;if(bt)for(let Ut of Object.keys(bt)){let Ht=parseInt(Ut);if(isNaN(Ht))throw new Error("wrong index");St[Ut]=Mt[Ht],Mt[Ht]=bt[Ut],Bt=!0}return Bt?{data:Mt,actual:mt,reverse:{type:0,props:St}}:null}else{let bt=mt.props,St={},Mt={...ut},Bt=!1;if(bt)for(let Ut of Object.keys(bt)){St[Ut]=Mt[Ut];let Ht=bt[Ut];Ht===void 0?delete Mt[Ut]:Mt[Ut]=Ht,Bt=!0}return Bt?{data:Mt,actual:mt,reverse:{type:0,props:St}}:null}}rt.runOp=_})(wi||(wi={}));var ye=class extends Array{constructor(...rt){super(...rt),Object.setPrototypeOf(this,ye.prototype)}deepFreeze(){let rt=0;for(;rt<this.length;)Ya(this[rt]),rt++}fillCaches0(rt){this.objCaches.set(rt.id,rt)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let rt of this)this.fillCaches0(rt)}}randomId(){this.fillCaches();let rt=Array.from(this.objCaches.keys());if(rt.length!==0)return rt[Math.max(0,Math.floor(Math.random()*rt.length)-1)]}data(rt){var _;return(_=this.get(rt))==null?void 0:_.data}get(rt){return this.fillCaches(),this.objCaches.get(rt)}modifyById(rt,_){if(this.get(rt)===void 0)throw new Error("not expected");{let ut=this,mt=ut.findIndex(St=>St.id===rt);if(mt<0)throw new Error("not expected");let bt=ut[mt];return ut=[...ut],ut[mt]={...bt,data:_},this.modifyArrayBy(ut)}}modifyArrayBy(rt){Object.setPrototypeOf(rt,ye.prototype);let _=rt;return Pm()||_.fillCaches(),_}runOp(rt){switch(rt.type){case 4:return this.addOp(rt);case 5:return this.deleteOp(rt);case 6:return this.moveOp(rt)}return null}addOp(rt){let{fi:_,id:ut,data:mt}=rt,bt=this,St={fi:_,id:ut,data:mt};return bt=[...bt,St],bt.sort((Mt,Bt)=>Mt.fi-Bt.fi),rt.localIndex=bt.indexOf(St),{data:this.modifyArrayBy(bt),actual:rt,reverse:{type:5,id:ut}}}deleteOp(rt){let{id:_}=rt,ut=this,mt=ut.findIndex(St=>St.id===_);if(mt===-1)return null;rt.localIndex=mt,ut=[...ut];let bt=ut.splice(mt,1)[0];return{data:this.modifyArrayBy(ut),actual:rt,reverse:{type:4,...bt}}}moveOp(rt){let{fi:_,id:ut}=rt,mt=this;mt=[...mt];let bt=mt.findIndex(Bt=>Bt.id===ut);if(bt===-1)return null;let St=mt[bt].fi,Mt={...mt[bt],fi:_};return mt[bt]=Mt,mt.sort((Bt,Ut)=>Bt.fi-Ut.fi),rt.localIndex=mt.indexOf(Mt),{data:this.modifyArrayBy(mt),actual:rt,reverse:{type:6,fi:St,id:ut}}}previous(rt){if(rt===null)return this.length===0?null:this[this.length-1].id;let _=null;for(let ut of this){if(ut.id===rt)return _;_=ut.id}return null}insertBeforeHelper(rt,_){return this.insertAfterHelper(this.previous(rt),_)}insertAfterHelper(rt,_){let ut=this;if(rt===null){if(ut.length===0)return Vr(0,_,_);{let mt=ut[0].fi;return Vr(mt-_,mt,_)}}else{let mt=this.get(rt);if(mt===void 0)throw new Error("illegal args");let bt=ut.find(St=>St.fi>mt.fi);if(bt===void 0){let St=ut[ut.length-1].fi;return Vr(St,St+_,_)}else return Vr(mt.fi,bt.fi,_)}}};function _i(rt){return rt&&typeof rt=="object"&&rt instanceof ke}var ke=class{unusedFunOverridesTable(rt){}runOp(rt){let _=[],ut=this,mt=0,bt={};for(;mt<rt.path.length;){if(_.push(ut),ut=ut===void 0?void 0:ut[rt.path[mt]],ut!==void 0&&!_i(ut))return null;mt+=1}ut=ut?xl(ut):new ke;for(let[Bt,Ut]of Object.entries(rt.props)){let Ht=ut[Bt];bt[Bt]=Ht,Ut===void 0?delete ut[Bt]:ut[Bt]=Ut}for(;mt>0;){if(Object.keys(ut).length===0){let Bt=_[mt-1];Bt&&(ut=xl(Bt),delete ut[rt.path[mt-1]])}else{let Bt=_[mt-1];if(Bt){let Ut=xl(Bt);Ut[rt.path[mt-1]]=ut,ut=Ut}else{let Ut=new ke;Ut[rt.path[mt-1]]=ut,ut=Ut}}mt-=1}let St=Object.setPrototypeOf(ut,ke.prototype),Mt={...rt,props:bt};return{data:St,actual:rt,reverse:Mt}}},Gr;(rt=>{function _(bt,St){return Xa(bt,St)??bt}rt.apply=_;function ut(bt,St){return _u(bt,St)}rt.merge=ut;function mt(bt,St){let Mt=0,Bt=St.path,Ut=bt;for(;Mt<Bt.length&&Ut!==void 0;){if(Ut=ot.zoomOnce(Ut,Bt[Mt]),Ut===void 0)return St;if(!_i(Ut))return;Mt+=1}if(Ut===void 0)return St;if(_i(Ut))if(St.type===0){let Ht={...St.props};for(let tr of Object.keys(Ut))delete Ht[tr];return{...St,props:Ht}}else if(St.type===1||St.type===4||St.type===7){let Ht=wu([St],Ut);return Ht?(console.log(Ht),Ht):St}else return St}rt.filterOp=mt})(Gr||(Gr={}));function wu(rt,_){if(_===void 0)return;let ut=!1,mt=rt.map(bt=>{let St=bt.id,Mt=Xa(bt.data,_[St]);if(ut=ut||Mt!==void 0,Mt===void 0&&(Mt=bt.data),bt.children){let Bt=wu(bt.children,_);return Bt!==void 0?ut=!0:Bt=bt.children,{...bt,id:St,data:Mt,children:Bt}}else return{...bt,id:St,data:Mt}});if(ut)return mt}function XA(rt,_){if(_===void 0)return;let ut=!1,mt=rt.map(bt=>{let St=bt.id,Mt=Xa(bt.data,_[St]);return ut=ut||Mt!==void 0,Mt===void 0&&(Mt=bt.data),{...bt,id:St,data:Mt}});if(ut)return Object.setPrototypeOf(mt,Object.getPrototypeOf(rt)),mt}function Xa(rt,_){if(!_i(_))return _;if(rt instanceof $e){let ut=wu(rt,_);return ut!==void 0&&Object.setPrototypeOf(ut,Object.getPrototypeOf(rt)),ut}else{if(rt instanceof ye)return XA(rt,_);if(Array.isArray(rt)){let ut=!1,mt=rt.map((bt,St)=>{let Mt=Xa(bt,_[St]);return ut=ut||Mt!==void 0,Mt===void 0&&(Mt=bt),Mt});return ut?(Object.setPrototypeOf(mt,Object.getPrototypeOf(rt)),mt):void 0}else{if(rt instanceof ke)return _u(rt,_);if(rt&&typeof rt=="object"){let ut={},mt=!1;for(let[bt,St]of Object.entries(rt)){let Mt=Xa(St,_[bt]);mt=mt||Mt!==void 0,Mt===void 0&&(Mt=St),ut[bt]=Mt}return mt?(Object.setPrototypeOf(ut,Object.getPrototypeOf(rt)),ut):void 0}}}}function _u(rt,_){if(rt===void 0)return _;if(_===void 0)return rt;if(!_i(_))return _;if(!_i(rt))return Gr.apply(rt,_);let ut=new Set;for(let bt of Object.keys(rt))ut.add(bt);for(let bt of Object.keys(_))ut.add(bt);let mt=new ke;for(let bt of ut){let St=_u(rt===void 0?void 0:rt[bt],_===void 0?void 0:_[bt]);mt[bt]=St}return mt}function Im(rt,_){let ut={cur:[],result:[],len:0};return rt=Ka(rt,_,ut)??rt,[rt,ut.result]}function vl(rt,_){return rt===null?null:(rt.cur[rt.len]=_,rt.len+=1,rt)}function bl(rt){rt&&(rt.len-=1)}function KA(rt){if(rt===null)return null;rt.result.push(rt.cur.slice(0,rt.len))}function Nm(rt,_,ut){let mt=!1,bt=rt.map(St=>{let Mt=St.id,Bt=_[Mt];if(Bt!==void 0&&typeof Bt=="string"&&(mt=!0,Mt=Bt,ut!==null))throw new Error("not supported");let Ut=Ka(St.data,_,vl(ut,Mt));bl(ut),mt=mt||Ut!==void 0,Ut===void 0&&(Ut=St.data);let Ht=Nm(St.children,_,ut);return Ht!==void 0?mt=!0:Ht=St.children,{...St,id:Mt,data:Ut,children:Ht}});if(mt)return bt}function QA(rt,_,ut){let mt=!1,bt=rt.map(St=>{let Mt=St.id,Bt=_[Mt];if(Bt!==void 0&&typeof Bt=="string"&&(mt=!0,Mt=Bt,ut!==null))throw new Error("not supported");let Ut=Ka(St.data,_,vl(ut,Mt));return bl(ut),mt=mt||Ut!==void 0,Ut===void 0&&(Ut=St.data),{...St,id:Mt,data:Ut}});if(mt)return Object.setPrototypeOf(bt,Object.getPrototypeOf(rt)),bt}function Ka(rt,_,ut){if(rt instanceof $e){let mt=Nm(rt,_,ut);return mt!==void 0&&Object.setPrototypeOf(mt,Object.getPrototypeOf(rt)),mt}else{if(rt instanceof ye)return QA(rt,_,ut);if(Array.isArray(rt)){let mt=!1,bt=rt.map((St,Mt)=>{let Bt=Ka(St,_,vl(ut,Mt));return bl(ut),mt=mt||Bt!==void 0,Bt===void 0&&(Bt=St),Bt});return mt?(Object.setPrototypeOf(bt,Object.getPrototypeOf(rt)),bt):void 0}else if(rt&&typeof rt=="object"&&!Si(rt)){let mt={},bt=!1;for(let[St,Mt]of Object.entries(rt))if(St!=="name"){let Bt=_[St];if(typeof Bt=="string"){if(ut!==null)throw new Error("not supported");bt=!0,St=Bt}let Ut=Ka(Mt,_,vl(ut,St));bl(ut),bt=bt||Ut!==void 0,Ut===void 0&&(Ut=Mt),mt[St]=Ut}else mt[St]=Mt;return bt?(Object.setPrototypeOf(mt,Object.getPrototypeOf(rt)),mt):void 0}else if(typeof rt=="string"){let mt=_[rt];return mt!==void 0&&KA(ut),mt}else return}}var Sl;(rt=>{function _(ut,mt){let bt=ot.zoom(mt,ut.path);if(typeof bt=="object"){let St={};for(let Mt of Object.keys(ut.props))St[Mt]=bt[Mt];return{...ut,props:St}}else return{...ut,props:{}}}rt.replaceProps=_})(Sl||(Sl={}));var nt;(rt=>{function _(Ut,Ht){return{...Ut,path:Ut.path.slice(Ht)}}rt.drop=_;function ut(Ut,Ht){var tr;return((tr=mt(Ut,Ht))==null?void 0:tr.data)??Ut}rt.applySimple=ut;function mt(Ut,Ht){var sr,ar;let tr=Ht.path;for(var rr=[];;){let cr;if(Ut instanceof ke&&Ht.type===0&&(cr=Ut.runOp({...Ht,path:tr.slice(rr.length)}),cr===null&&(cr=void 0)),cr===void 0&&rr.length===tr.length&&(Ut instanceof $e||Ut instanceof ye||Ut instanceof he?cr=Ut.runOp(Ht):cr=wi.runOp(Ut,Ht)),cr!==void 0)if(cr!==null){let Dr=cr.data;for(let $r=rr.length-1;$r>=0;$r--){let Br=tr[$r],Jr=rr[$r];if(Jr instanceof $e){if(typeof Br=="number")throw new Error("illegal arg");Dr=Jr.modifyById(Br,Dr)}else if(Jr instanceof ye){if(typeof Br=="number")throw new Error("illegal arg");Dr=Jr.modifyById(Br,Dr)}else if(Jr instanceof he){if(typeof Br=="number")throw new Error("illegal arg");Dr=Jr.modifyById(Br,Dr)}else if(Jr instanceof ke){let mn={...Jr,[Br]:Dr};Dr=Object.setPrototypeOf(mn,ke.prototype)}else if(typeof Jr=="object")if(Array.isArray(Jr)){if(typeof Br=="string"&&(Br=parseInt(Br),isNaN(Br)))throw new Error("Invalid path");let mn=Dr;Dr=[...Jr],Dr[Br]=mn}else Dr={...Jr,[Br]:Dr};else return null}return{data:Dr,actual:{...cr.actual,path:tr},reverse:{...cr.reverse,path:tr}}}else return null;let Ar=tr[rr.length],_r;if(Ut instanceof $e){if(typeof Ar=="number")throw new Error("");_r=(sr=Ut.get(Ar))==null?void 0:sr.data}else if(Ut instanceof ye){if(typeof Ar=="number")throw new Error("");_r=(ar=Ut.get(Ar))==null?void 0:ar.data}else Ut!==null&&(_r=Ut[Ar]);if(_r!==void 0)rr.push(Ut),Ut=_r;else return null}}rt.apply=mt;function bt(Ut,Ht){for(let tr=0;tr<Ut.length&&tr<Ht.length;tr++)if(Ut[tr]!==Ht[tr])return!0;return!1}rt.pathDisjoint=bt;function St(Ut,Ht){if(Ut.length!==Ht.length)return!1;for(let tr=0;tr<Ut.length;tr++)if(Ut[tr]!==Ht[tr])return!1;return!0}rt.pathEq=St;function Mt(Ut,Ht){return bt(Ut.path,Ht.path)}rt.commutative=Mt;function Bt(Ut,Ht){return Ut.type===0&&Ht.type===0&&St(Ut.path,Ht.path)?Object.keys(Ut.props).every(tr=>Ht.props[tr]!==void 0):!1}rt.subsumed=Bt})(nt||(nt={}));var Qa;(rt=>{function _(){return[]}rt.empty=_;function ut(Ht,tr){let rr=[];for(let sr of Ht){let[ar,...cr]=sr.path;ar===tr&&rr.push({...sr,path:cr})}return rr}rt.removePrefix=ut;function mt(Ht,tr){return Ht.map(rr=>({...rr,path:[tr,...rr.path]}))}rt.addPrefix=mt;function bt(Ht,tr){return[...Ht,...tr]}rt.concat=bt;function St(Ht,tr){return[...Ht.filter(rr=>!tr.some(sr=>nt.subsumed(rr,sr))),...tr]}rt.compress=St;function Mt(Ht,tr){return Ht.every(rr=>tr.every(sr=>nt.commutative(rr,sr)))}rt.commutative=Mt;function Bt(Ht,tr){for(let rr of tr){let sr=Ut(Ht,rr);sr!==null&&(Ht=sr.data)}return Ht}rt.applyAll=Bt;function Ut(Ht,tr){var rr=Ht;let sr=[],ar=[];for(let cr of tr)try{if(cr.type===3||cr.type===5&&cr.path[cr.path.length-1]==="variables"){let Ar,_r,Dr;if(cr.type===3?(Ar=ot.zoom(rr,[...cr.path,cr.id]),Dr=nt.apply(rr,{...cr,type:2})):(Ar=ot.zoom(rr,[...cr.path,cr.id,"value"]),Dr=nt.apply(rr,cr)),Dr!==null){rr=Dr.data;let[$r,Br]=Im(rr,{[cr.id]:Ar});rr=$r;for(let Jr=0;Jr<Br.length;Jr++){let mn=Br[Jr],Mn=mn.pop();if(typeof Mn=="number"){let $n=[Mn];for(let In=Jr+1;In<Br.length;In++){let Rn=Br[In],qn=Rn[Rn.length-1];if(typeof qn=="number"&&ot.equal(mn,Rn.slice(0,Rn.length-1)))$n.push(qn),Br.splice(In,1);else break}let en=ot.zoom(rr,mn);_r=en.map((In,Rn)=>$n.includes(Rn)?cr.id:In),Ar=en,Mn=mn.pop()}else{if(Mn==="alphaOverride"||Mn==="alpha"){Ar/=100;let $n=Ar,en=ot.zoom(rr,mn.slice(0,mn.length-2)),In=en.layers.map(Rn=>Rn.id===mn[mn.length-1]?{...Rn,data:{...Rn.data,[Mn]:$n}}:Rn);Object.setPrototypeOf(In,Object.getPrototypeOf(en.layers)),en.layers=In}_r=cr.id}sr.push({type:0,path:mn,props:{[Mn]:Ar}}),ar.push({type:0,path:mn,props:{[Mn]:_r}})}ar.push(Dr.reverse),sr.push(Dr.actual)}}else{let Ar=nt.apply(rr,cr);Ar!==null&&(sr.push(Ar.actual),rr=Ar.data,ar.push(Ar.reverse))}}catch(Ar){if(Ar instanceof bi)return null;throw Ar}return{data:rr,actual:sr,reverse:ar.reverse()}}rt.apply=Ut})(Qa||(Qa={}));var Em=Symbol(),ZA=Symbol(),_l=Symbol(),Sn=class{reportOp(rt,_,ut=[]){let mt=this;if(_===null)return;mt._current=_.data;let bt=ut;for(;!(mt instanceof wl);){let St=mt._path,Mt=mt._current;if(St!==""&&bt.splice(0,0,St),mt=mt._parent,mt===null)return;mt.update(St,Mt)}mt.push(bt,rt,_.actual,_.reverse)}deleteChildren(rt){if(this._children){let _=this._children[rt];if(_){let ut=_[_l];ut&&ut(),delete this._children[rt]}}}},Tu=class extends Sn{constructor(rt,_,ut){super(),this._parent=rt,this._path=_,this._current=ut}update(rt,_){if(Array.isArray(this._current)){if(typeof rt=="string"&&(rt=parseInt(rt),isNaN(rt)))throw new Error("Invalid path");this._current=[...this._current],this._current[rt]=_}else this._current={...this._current,[rt]:_}}runOp(rt){this.reportOp(rt,wi.runOp(this._current,rt),rt.path)}},Cu=class extends Sn{constructor(rt,_,ut){super(),this._parent=rt,this._path=_,this._current=ut}update(rt,_){this._current={...this._current,[rt]:_},Object.setPrototypeOf(this._current,he.prototype)}runOp(rt){this.reportOp(rt,this._current.runOp(rt))}},Dm={get(rt,_){if(_===_l)return()=>{rt._parent=null};if(_===Em)return rt._current;if(_===ZA)return rt;let{_current:ut,_children:mt}=rt;if(_==="push"&&Array.isArray(ut))throw new Error("not supported to expand array");let bt=mt===void 0?void 0:mt[_];if(bt!==void 0)return bt;let St=ut[_],Mt=Al(rt,_,St);return Mt!==St?(mt===void 0&&(mt={},rt._children=mt),mt[_]=Mt,Mt):St},has(rt,_){return _ in rt._current},ownKeys(rt){return Reflect.ownKeys(rt._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(rt){return Object.getPrototypeOf(rt._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(rt,_){let ut=rt._current,mt=Reflect.getOwnPropertyDescriptor(ut,_);return mt&&{writable:!0,configurable:!0,enumerable:mt.enumerable,value:ut[_]}}},JA={...Dm,set(rt,_,ut){let mt={type:0,props:{[_]:Ye(ut)??ut}};return rt.deleteChildren(_),rt.runOp(mt),!0},deleteProperty(rt,_){let ut={type:0,props:{[_]:void 0}};return rt.deleteChildren(_),rt.runOp(ut),!0}},eT={...Dm,set(rt,_,ut){return ut===void 0?this.deleteProperty(rt,_):(rt.deleteChildren(_),rt.runOp({type:1,id:_,data:ut})),!0},deleteProperty(rt,_){return rt.runOp({type:2,id:_}),!0}},Ai=class extends Sn{constructor(rt,_,ut){super(),this._children={},this._parent=rt,this._path=_,this._current=ut,this[_l]=()=>{this._parent=null}}unproxy(){return this._current}update(rt,_){this._current=this._current.modifyById(rt,_)}runOp(rt){this.reportOp(rt,this._current.runOp(rt))}randomId(){return this._current.randomId()}isDescendantOf(rt,_){return this._current.isDescendantOf(rt,_)}childrenOf(rt){return this._current.childrenOf(rt)}traverse(rt){return this._current.traverse(rt)}get(rt){return this._current.get(rt)}parent(rt){return this._current.parent(rt)}traverse(rt){this._current.traverse((_,ut)=>{rt(_,this.data(_))})}data(rt){var Mt;let{_current:_,_children:ut}=this,mt=ut===void 0?void 0:ut[rt];if(mt!==void 0)return mt;let bt=(Mt=_.get(rt))==null?void 0:Mt.data,St=Al(this,rt,bt);return St!==bt?(ut===void 0&&(ut={},this._children=ut),ut[rt]=St,St):bt}add(rt,_,ut,mt,bt){this.runOp({type:7,parent:rt,fi:_,id:ut,data:mt,children:bt})}move(rt,_,ut){this.runOp({type:9,parent:rt,fi:_,id:ut})}insertAfter(rt,_,ut){let mt=this._current.insertAfterHelper(rt,_,ut.length);for(let bt=0;bt<ut.length;bt++){let St=ut[bt];this.add(rt,mt[bt],St.id,St.data,St.children)}}insertBefore(rt,_,ut){let mt=this._current.insertBeforeHelper(rt,_,ut.length);for(let bt=0;bt<ut.length;bt++){let St=ut[bt];this.add(rt,mt[bt],St.id,St.data,St.children)}}moveAfter(rt,_,ut){let mt=this._current.insertAfterHelper(rt,_,ut.length);for(let bt=0;bt<ut.length;bt++){let St=ut[bt];this.move(rt,mt[bt],St)}}moveBefore(rt,_,ut){let mt=this._current.insertBeforeHelper(rt,_,ut.length);for(let bt=0;bt<ut.length;bt++){let St=ut[bt];this.move(rt,mt[bt],St)}}delete(rt){this.deleteChildren(rt),this.runOp({type:8,id:rt})}sortNext(rt){return this._current.sortNext(rt)}sortPrevious(rt){return this._current.sortPrevious(rt)}getAllSorted(rt){return this._current.getAllSorted(rt)}},Ti=class extends Sn{constructor(rt,_,ut){super(),this._children={},this._parent=rt,this._path=_,this._current=ut,this[_l]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(rt){let _=this.length;for(let ut=0;ut<_;ut++){let mt=this._current[ut].id,bt=this._current[ut].fi;rt(this.data(this._current[ut].id),mt,bt)}}find(rt){let _=this.length;for(let ut=0;ut<_;ut++){let mt=this._current[ut].id;if(rt(this.data(mt),mt))return this.get(mt)}}update(rt,_){this._current=this._current.modifyById(rt,_)}randomId(){return this._current.randomId()}get(rt){return{...this._current.get(rt),data:this.data(rt)}}data(rt){var Mt;let{_current:_,_children:ut}=this,mt=ut===void 0?void 0:ut[rt];if(mt!==void 0)return mt;let bt=(Mt=_.get(rt))==null?void 0:Mt.data,St=Al(this,rt,bt);return St!==bt?(ut===void 0&&(ut={},this._children=ut),ut[rt]=St,St):bt}runOp(rt){this.reportOp(rt,this._current.runOp(rt))}add(rt,_,ut){this.runOp({type:4,fi:rt,id:_,data:ut})}move(rt,_){this.runOp({type:6,fi:rt,id:_})}insertAfter(rt,_){let ut=this._current.insertAfterHelper(rt,_.length);for(let mt=0;mt<_.length;mt++){let bt=_[mt];this.add(ut[mt],bt.id,bt.data)}}insertBefore(rt,_){let ut=this._current.insertBeforeHelper(rt,_.length);for(let mt=0;mt<_.length;mt++){let bt=_[mt];this.add(ut[mt],bt.id,bt.data)}}moveAfter(rt,_){let ut=this._current.insertAfterHelper(rt,_.length);for(let mt=0;mt<_.length;mt++){let bt=_[mt];this.move(ut[mt],bt)}}moveBefore(rt,_){let ut=this._current.insertBeforeHelper(rt,_.length);for(let mt=0;mt<_.length;mt++){let bt=_[mt];this.move(ut[mt],bt)}}delete(rt){this.deleteChildren(rt),this.runOp({type:5,id:rt})}};function Au(rt,_,ut){if(rt.length>0){let mt=rt[rt.length-1];if(mt.type===0&&_.type===0&&ot.equal(mt.path,ut)){Object.assign(mt.props,_.props);return}}rt.push({..._,path:ut})}var wl=class extends Sn{constructor(rt){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=rt}update(rt,_){if(rt!=="")throw new Error("");this._current=_}push(rt,_,ut,mt){Au(this.ts,_,rt),Au(this.actual,ut,rt),Au(this.reverse,mt,rt)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function Al(rt,_,ut){return ut instanceof $e?new Ai(rt,_,ut):ut instanceof ye?new Ti(rt,_,ut):ut instanceof he?new Proxy(new Cu(rt,_,ut),eT):ut!==null&&typeof ut=="object"?Si(ut)?ut:new Proxy(new Tu(rt,_,ut),JA):ut}function Pu(rt){let _=new wl(rt);return[Al(_,"",rt),_]}function Vo(rt,_){let[ut,mt]=Pu(rt);return _(ut),mt.result()}function Ye(rt){return rt instanceof Ai||rt instanceof Ti?rt._current:rt!==null&&typeof rt=="object"?rt[Em]:rt}var ot;(rt=>{function _(St,Mt){if(Mt.length===St.length)for(var Bt=0;Bt<St.length;){if(St[Bt]!==Mt[Bt])return!1;Bt+=1}else return!1;return!0}rt.equal=_;function ut(St,Mt,Bt){let Ut=bt(Bt,St);if(Ut!==void 0&&typeof Ut=="object"&&Ut!==null){let Ht={...Mt};return Object.keys(Ut).forEach(tr=>{delete Ht[tr]}),Ht}else return Mt}rt.removeOverridden=ut;function mt(St,Mt){if((St instanceof $e||St instanceof Ai)&&typeof Mt=="string"||(St instanceof ye||St instanceof Ti)&&typeof Mt=="string")return St.data(Mt);if(typeof Mt=="number"&&Array.isArray(St)||typeof Mt=="string"&&typeof St=="object"&&St!==null)return St[Mt]}rt.zoomOnce=mt;function bt(St,Mt,Bt=0){for(;Bt<Mt.length&&St!==void 0;)St=mt(St,Mt[Bt]),Bt+=1;return St}rt.zoom=bt})(ot||(ot={}));function Lm(rt,_){let ut=[];if(_.length===rt.length)for(var mt=0;mt<rt.length;){if(_[mt]==="*")ut.push(rt[mt]);else if(rt[mt]!==_[mt])return null;mt+=1}else return null;return ut}function Lt(rt,_){let ut=[];if(_.length<=rt.length)for(var mt=0;mt<_.length;){if(_[mt]==="*")ut.push(rt[mt]);else if(rt[mt]!==_[mt])return null;mt+=1}else return null;return ut}var Tl=class{},Za=class extends Tl{constructor(rt){super(),this.id=rt}},Ja=class extends Tl{constructor(rt){super(),this.data=rt}},Mu;try{Mu=new TextDecoder}catch{}var re$2,zo,E$1=0,Yt={},De,Go,dr=0,zr=0,ir,go,Vt=[],Be,Bm={useRecords:!1,mapsAsObjects:!0},es=class{},Du=new es;Du.name="MessagePack 0xC1";var Ci=!1,kr=class{constructor(rt){rt&&(rt.useRecords===!1&&rt.mapsAsObjects===void 0&&(rt.mapsAsObjects=!0),rt.structures?rt.structures.sharedLength=rt.structures.length:rt.getStructures&&((rt.structures=[]).uninitialized=!0,rt.structures.sharedLength=0)),Object.assign(this,rt)}unpack(rt,_){if(re$2)return $m(()=>(Pl(),this?this.unpack(rt,_):kr.prototype.unpack.call(Bm,rt,_)));zo=_>-1?_:rt.length,E$1=0,zr=0,Go=null,ir=null,re$2=rt;try{Be=rt.dataView||(rt.dataView=new DataView(rt.buffer,rt.byteOffset,rt.byteLength))}catch(ut){throw re$2=null,rt instanceof Uint8Array?ut:new Error("Source must be a Uint8Array or Buffer but was a "+(rt&&typeof rt=="object"?rt.constructor.name:typeof rt))}if(this instanceof kr){if(Yt=this,this.structures)return De=this.structures,Cl();(!De||De.length>0)&&(De=[])}else Yt=Bm,(!De||De.length>0)&&(De=[]);return Cl()}unpackMultiple(rt,_){let ut,mt=0;try{Ci=!0;let bt=rt.length,St=this?this.unpack(rt,bt):Il.unpack(rt,bt);if(_){for(_(St);E$1<bt;)if(mt=E$1,_(Cl())===!1)return}else{for(ut=[St];E$1<bt;)mt=E$1,ut.push(Cl());return ut}}catch(bt){throw bt.lastPosition=mt,bt.values=ut,bt}finally{Ci=!1,Pl()}}_mergeStructures(rt,_){rt=rt||[];for(let ut=0,mt=rt.length;ut<mt;ut++){let bt=rt[ut];bt&&(bt.isShared=!0,ut>=32&&(bt.highByte=ut-32>>5))}rt.sharedLength=rt.length;for(let ut in _||[])if(ut>=0){let mt=rt[ut],bt=_[ut];bt&&(mt&&((rt.restoreStructures||(rt.restoreStructures=[]))[ut]=mt),rt[ut]=bt)}return this.structures=rt}decode(rt,_){return this.unpack(rt,_)}};function Cl(){try{if(!Yt.trusted&&!Ci){let _=De.sharedLength||0;_<De.length&&(De.length=_)}let rt=Je();if(E$1==zo)De.restoreStructures&&Rm(),De=null,re$2=null,go&&(go=null);else if(E$1>zo){let _=new Error("Unexpected end of MessagePack data");throw _.incomplete=!0,_}else if(!Ci)throw new Error("Data read, but end of buffer not reached");return rt}catch(rt){throw De.restoreStructures&&Rm(),Pl(),(rt instanceof RangeError||rt.message.startsWith("Unexpected end of buffer"))&&(rt.incomplete=!0),rt}}function Rm(){for(let rt in De.restoreStructures)De[rt]=De.restoreStructures[rt];De.restoreStructures=null}function Je(){let rt=re$2[E$1++];if(rt<160)if(rt<128){if(rt<64)return rt;{let _=De[rt&63]||Yt.getStructures&&Um()[rt&63];return _?(_.read||(_.read=Lu(_,rt&63)),_.read()):rt}}else if(rt<144)if(rt-=128,Yt.mapsAsObjects){let _={};for(let ut=0;ut<rt;ut++)_[qm()]=Je();return _}else{let _=new Map;for(let ut=0;ut<rt;ut++)_.set(Je(),Je());return _}else{rt-=144;let _=new Array(rt);for(let ut=0;ut<rt;ut++)_[ut]=Je();return _}else if(rt<192){let _=rt-160;if(zr>=E$1)return Go.slice(E$1-dr,(E$1+=_)-dr);if(zr==0&&zo<140){let ut=_<16?Bu(_):Hm(_);if(ut!=null)return ut}return Eu(_)}else{let _;switch(rt){case 192:return null;case 193:return ir?(_=Je(),_>0?ir[1].slice(ir.position1,ir.position1+=_):ir[0].slice(ir.position0,ir.position0-=_)):Du;case 194:return!1;case 195:return!0;case 196:return Ou(re$2[E$1++]);case 197:return _=Be.getUint16(E$1),E$1+=2,Ou(_);case 198:return _=Be.getUint32(E$1),E$1+=4,Ou(_);case 199:return wn(re$2[E$1++]);case 200:return _=Be.getUint16(E$1),E$1+=2,wn(_);case 201:return _=Be.getUint32(E$1),E$1+=4,wn(_);case 202:if(_=Be.getFloat32(E$1),Yt.useFloat32>2){let ut=Ml[(re$2[E$1]&127)<<1|re$2[E$1+1]>>7];return E$1+=4,(ut*_+(_>0?.5:-.5)>>0)/ut}return E$1+=4,_;case 203:return _=Be.getFloat64(E$1),E$1+=8,_;case 204:return re$2[E$1++];case 205:return _=Be.getUint16(E$1),E$1+=2,_;case 206:return _=Be.getUint32(E$1),E$1+=4,_;case 207:return Yt.int64AsNumber?(_=Be.getUint32(E$1)*4294967296,_+=Be.getUint32(E$1+4)):_=Be.getBigUint64(E$1),E$1+=8,_;case 208:return Be.getInt8(E$1++);case 209:return _=Be.getInt16(E$1),E$1+=2,_;case 210:return _=Be.getInt32(E$1),E$1+=4,_;case 211:return Yt.int64AsNumber?(_=Be.getInt32(E$1)*4294967296,_+=Be.getUint32(E$1+4)):_=Be.getBigInt64(E$1),E$1+=8,_;case 212:if(_=re$2[E$1++],_==114)return Fm(re$2[E$1++]&63);{let ut=Vt[_];if(ut)return ut.read?(E$1++,ut.read(Je())):ut.noBuffer?(E$1++,ut()):ut(re$2.subarray(E$1,++E$1));throw new Error("Unknown extension "+_)}case 213:return _=re$2[E$1],_==114?(E$1++,Fm(re$2[E$1++]&63,re$2[E$1++])):wn(2);case 214:return wn(4);case 215:return wn(8);case 216:return wn(16);case 217:return _=re$2[E$1++],zr>=E$1?Go.slice(E$1-dr,(E$1+=_)-dr):rT(_);case 218:return _=Be.getUint16(E$1),E$1+=2,zr>=E$1?Go.slice(E$1-dr,(E$1+=_)-dr):oT(_);case 219:return _=Be.getUint32(E$1),E$1+=4,zr>=E$1?Go.slice(E$1-dr,(E$1+=_)-dr):nT(_);case 220:return _=Be.getUint16(E$1),E$1+=2,Gm(_);case 221:return _=Be.getUint32(E$1),E$1+=4,Gm(_);case 222:return _=Be.getUint16(E$1),E$1+=2,zm(_);case 223:return _=Be.getUint32(E$1),E$1+=4,zm(_);default:if(rt>=224)return rt-256;if(rt===void 0){let ut=new Error("Unexpected end of MessagePack data");throw ut.incomplete=!0,ut}throw new Error("Unknown MessagePack token "+rt)}}}var tT=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Lu(rt,_){function ut(){if(ut.count++>2){let bt=rt.read=new Function("r","return function(){return {"+rt.map(St=>tT.test(St)?St+":r()":"["+JSON.stringify(St)+"]:r()").join(",")+"}}")(Je);return rt.highByte===0&&(rt.read=Vm(_,rt.read)),bt()}let mt={};for(let bt=0,St=rt.length;bt<St;bt++){let Mt=rt[bt];mt[Mt]=Je()}return mt}return ut.count=0,rt.highByte===0?Vm(_,ut):ut}var Vm=(rt,_)=>function(){let ut=re$2[E$1++];if(ut===0)return _();let mt=rt<32?-(rt+(ut<<5)):rt+(ut<<5),bt=De[mt]||Um()[mt];if(!bt)throw new Error("Record id is not defined for "+mt);return bt.read||(bt.read=Lu(bt,rt)),bt.read()};function Um(){let rt=$m(()=>(re$2=null,Yt.getStructures()));return De=Yt._mergeStructures(rt,De)}var Eu=Ol,rT=Ol,oT=Ol,nT=Ol;function Ol(rt){let _;if(rt<16&&(_=Bu(rt)))return _;if(rt>64&&Mu)return Mu.decode(re$2.subarray(E$1,E$1+=rt));let ut=E$1+rt,mt=[];for(_="";E$1<ut;){let bt=re$2[E$1++];if(!(bt&128))mt.push(bt);else if((bt&224)===192){let St=re$2[E$1++]&63;mt.push((bt&31)<<6|St)}else if((bt&240)===224){let St=re$2[E$1++]&63,Mt=re$2[E$1++]&63;mt.push((bt&31)<<12|St<<6|Mt)}else if((bt&248)===240){let St=re$2[E$1++]&63,Mt=re$2[E$1++]&63,Bt=re$2[E$1++]&63,Ut=(bt&7)<<18|St<<12|Mt<<6|Bt;Ut>65535&&(Ut-=65536,mt.push(Ut>>>10&1023|55296),Ut=56320|Ut&1023),mt.push(Ut)}else mt.push(bt);mt.length>=4096&&(_+=xt.apply(String,mt),mt.length=0)}return mt.length>0&&(_+=xt.apply(String,mt)),_}function Gm(rt){let _=new Array(rt);for(let ut=0;ut<rt;ut++)_[ut]=Je();return _}function zm(rt){if(Yt.mapsAsObjects){let _={};for(let ut=0;ut<rt;ut++)_[qm()]=Je();return _}else{let _=new Map;for(let ut=0;ut<rt;ut++)_.set(Je(),Je());return _}}var xt=String.fromCharCode;function Hm(rt){let _=E$1,ut=new Array(rt);for(let mt=0;mt<rt;mt++){let bt=re$2[E$1++];if((bt&128)>0){E$1=_;return}ut[mt]=bt}return xt.apply(String,ut)}function Bu(rt){if(rt<4)if(rt<2){if(rt===0)return"";{let _=re$2[E$1++];if((_&128)>1){E$1-=1;return}return xt(_)}}else{let _=re$2[E$1++],ut=re$2[E$1++];if((_&128)>0||(ut&128)>0){E$1-=2;return}if(rt<3)return xt(_,ut);let mt=re$2[E$1++];if((mt&128)>0){E$1-=3;return}return xt(_,ut,mt)}else{let _=re$2[E$1++],ut=re$2[E$1++],mt=re$2[E$1++],bt=re$2[E$1++];if((_&128)>0||(ut&128)>0||(mt&128)>0||(bt&128)>0){E$1-=4;return}if(rt<6){if(rt===4)return xt(_,ut,mt,bt);{let St=re$2[E$1++];if((St&128)>0){E$1-=5;return}return xt(_,ut,mt,bt,St)}}else if(rt<8){let St=re$2[E$1++],Mt=re$2[E$1++];if((St&128)>0||(Mt&128)>0){E$1-=6;return}if(rt<7)return xt(_,ut,mt,bt,St,Mt);let Bt=re$2[E$1++];if((Bt&128)>0){E$1-=7;return}return xt(_,ut,mt,bt,St,Mt,Bt)}else{let St=re$2[E$1++],Mt=re$2[E$1++],Bt=re$2[E$1++],Ut=re$2[E$1++];if((St&128)>0||(Mt&128)>0||(Bt&128)>0||(Ut&128)>0){E$1-=8;return}if(rt<10){if(rt===8)return xt(_,ut,mt,bt,St,Mt,Bt,Ut);{let Ht=re$2[E$1++];if((Ht&128)>0){E$1-=9;return}return xt(_,ut,mt,bt,St,Mt,Bt,Ut,Ht)}}else if(rt<12){let Ht=re$2[E$1++],tr=re$2[E$1++];if((Ht&128)>0||(tr&128)>0){E$1-=10;return}if(rt<11)return xt(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr);let rr=re$2[E$1++];if((rr&128)>0){E$1-=11;return}return xt(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr)}else{let Ht=re$2[E$1++],tr=re$2[E$1++],rr=re$2[E$1++],sr=re$2[E$1++];if((Ht&128)>0||(tr&128)>0||(rr&128)>0||(sr&128)>0){E$1-=12;return}if(rt<14){if(rt===12)return xt(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr);{let ar=re$2[E$1++];if((ar&128)>0){E$1-=13;return}return xt(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar)}}else{let ar=re$2[E$1++],cr=re$2[E$1++];if((ar&128)>0||(cr&128)>0){E$1-=14;return}if(rt<15)return xt(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr);let Ar=re$2[E$1++];if((Ar&128)>0){E$1-=15;return}return xt(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar)}}}}}function Ou(rt){return Yt.copyBuffers?Uint8Array.prototype.slice.call(re$2,E$1,E$1+=rt):re$2.subarray(E$1,E$1+=rt)}function wn(rt){let _=re$2[E$1++];if(Vt[_])return Vt[_](re$2.subarray(E$1,E$1+=rt));throw new Error("Unknown extension type "+_)}var km=new Array(4096);function qm(){let rt=re$2[E$1++];if(rt>=160&&rt<192){if(rt=rt-160,zr>=E$1)return Go.slice(E$1-dr,(E$1+=rt)-dr);if(!(zr==0&&zo<180))return Eu(rt)}else return E$1--,Je();let _=(rt<<5^(rt>1?Be.getUint16(E$1):rt>0?re$2[E$1]:0))&4095,ut=km[_],mt=E$1,bt=E$1+rt-3,St,Mt=0;if(ut&&ut.bytes==rt){for(;mt<bt;){if(St=Be.getUint32(mt),St!=ut[Mt++]){mt=1879048192;break}mt+=4}for(bt+=3;mt<bt;)if(St=re$2[mt++],St!=ut[Mt++]){mt=1879048192;break}if(mt===bt)return E$1=mt,ut.string;bt-=3,mt=E$1}for(ut=[],km[_]=ut,ut.bytes=rt;mt<bt;)St=Be.getUint32(mt),ut.push(St),mt+=4;for(bt+=3;mt<bt;)St=re$2[mt++],ut.push(St);let Bt=rt<16?Bu(rt):Hm(rt);return Bt!=null?ut.string=Bt:ut.string=Eu(rt)}var Fm=(rt,_)=>{var ut=Je();let mt=rt;_!==void 0&&(rt=rt<32?-((_<<5)+rt):(_<<5)+rt,ut.highByte=_);let bt=De[rt];return bt&&bt.isShared&&((De.restoreStructures||(De.restoreStructures=[]))[rt]=bt),De[rt]=ut,ut.read=Lu(ut,mt),ut.read()},Wm=typeof self=="object"?self:global;Vt[0]=()=>{};Vt[0].noBuffer=!0;Vt[101]=()=>{let rt=Je();return(Wm[rt[0]]||Error)(rt[1])};Vt[105]=rt=>{let _=Be.getUint32(E$1-4);go||(go=new Map);let ut=re$2[E$1],mt;ut>=144&&ut<160||ut==220||ut==221?mt=[]:mt={};let bt={target:mt};go.set(_,bt);let St=Je();return bt.used?Object.assign(mt,St):(bt.target=St,St)};Vt[112]=rt=>{let _=Be.getUint32(E$1-4),ut=go.get(_);return ut.used=!0,ut.target};Vt[115]=()=>new Set(Je());var Ru=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(rt=>rt+"Array");Vt[116]=rt=>{let _=rt[0],ut=Ru[_];if(!ut)throw new Error("Could not find typed array for code "+_);return new Wm[ut](Uint8Array.prototype.slice.call(rt,1).buffer)};Vt[120]=()=>{let rt=Je();return new RegExp(rt[0],rt[1])};Vt[98]=rt=>{let _=(rt[0]<<24)+(rt[1]<<16)+(rt[2]<<8)+rt[3],ut=E$1;E$1+=_-4,ir=[Je(),Je()],ir.position0=0,ir.position1=0;let mt=E$1;E$1=ut;try{return Je()}finally{E$1=mt}};Vt[255]=rt=>rt.length==4?new Date((rt[0]*16777216+(rt[1]<<16)+(rt[2]<<8)+rt[3])*1e3):rt.length==8?new Date(((rt[0]<<22)+(rt[1]<<14)+(rt[2]<<6)+(rt[3]>>2))/1e6+((rt[3]&3)*4294967296+rt[4]*16777216+(rt[5]<<16)+(rt[6]<<8)+rt[7])*1e3):rt.length==12?new Date(((rt[0]<<24)+(rt[1]<<16)+(rt[2]<<8)+rt[3])/1e6+((rt[4]&128?-281474976710656:0)+rt[6]*1099511627776+rt[7]*4294967296+rt[8]*16777216+(rt[9]<<16)+(rt[10]<<8)+rt[11])*1e3):new Date("invalid");function $m(rt){let _=zo,ut=E$1,mt=dr,bt=zr,St=Go,Mt=go,Bt=ir,Ut=new Uint8Array(re$2.slice(0,zo)),Ht=De,tr=De.slice(0,De.length),rr=Yt,sr=Ci,ar=rt();return zo=_,E$1=ut,dr=mt,zr=bt,Go=St,go=Mt,ir=Bt,re$2=Ut,Ci=sr,De=Ht,De.splice(0,De.length,...tr),Yt=rr,Be=new DataView(re$2.buffer,re$2.byteOffset,re$2.byteLength),ar}function Pl(){re$2=null,go=null,De=null}function Ym(rt){rt.unpack?Vt[rt.type]=rt.unpack:Vt[rt.type]=rt}var Ml=new Array(147);for(let rt=0;rt<256;rt++)Ml[rt]=+("1e"+Math.floor(45.15-rt*.30103));var Il=new kr({useRecords:!1});Il.unpack;Il.unpackMultiple;Il.unpack;var lT=new Float32Array(1);new Uint8Array(lT.buffer,0,4);var El;try{El=new TextEncoder}catch{}var Dl,Gu,Ll=typeof Buffer<"u",Vu=Ll?Buffer.allocUnsafeSlow:Uint8Array,Zm=Ll?Buffer:Uint8Array,Xm=Ll?4294967296:2144337920,j$2,it,L$2=0,Fr,jr=null,cT=/[\u0080-\uFFFF]/,ts=Symbol("record-id"),_n=class extends kr{constructor(rt){super(rt),this.offset=0;let _,ut,mt,bt,St,Mt=0,Bt=Zm.prototype.utf8Write?function(Mn,$n,en){return j$2.utf8Write(Mn,$n,en)}:El&&El.encodeInto?function(Mn,$n){return El.encodeInto(Mn,j$2.subarray($n)).written}:!1,Ut=this;rt||(rt={});let Ht=rt&&rt.sequential,tr=rt.structures||rt.saveStructures,rr=rt.maxSharedStructures;if(rr==null&&(rr=tr?32:0),rr>8160)throw new Error("Maximum maxSharedStructure is 8160");let sr=rt.maxOwnStructures;sr==null&&(sr=tr?32:64),Ht&&!rt.saveStructures&&(this.structures=[]);let ar=rr>32||sr+rr>64,cr=rr+64,Ar=rr+sr+64;if(Ar>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let _r=[],Dr=0,$r=0;this.pack=this.encode=function(Mn,$n){if(j$2||(j$2=new Vu(8192),it=new DataView(j$2.buffer,0,8192),L$2=0),Fr=j$2.length-10,Fr-L$2<2048?(j$2=new Vu(j$2.length),it=new DataView(j$2.buffer,0,j$2.length),Fr=j$2.length-10,L$2=0):L$2=L$2+7&2147483640,_=L$2,St=Ut.structuredClone?new Map:null,Ut.bundleStrings?(jr=["",""],j$2[L$2++]=214,j$2[L$2++]=98,jr.position=L$2-_,L$2+=4):jr=null,ut=Ut.structures,ut){ut.uninitialized&&(ut=Ut._mergeStructures(Ut.getStructures()));let en=ut.sharedLength||0;if(en>rr)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+ut.sharedLength);if(!ut.transitions){ut.transitions=Object.create(null);for(let In=0;In<en;In++){let Rn=ut[In];if(!Rn)continue;let qn,Qn=ut.transitions;for(let xs=0,cs=Rn.length;xs<cs;xs++){let ks=Rn[xs];qn=Qn[ks],qn||(qn=Qn[ks]=Object.create(null)),Qn=qn}Qn[ts]=In+64}Mt=en}Ht||(ut.nextId=en+64)}mt&&(mt=!1),bt=ut||[];try{if(Br(Mn),jr){it.setUint32(jr.position+_,L$2-jr.position-_);let en=jr;jr=null,Br(en[0]),Br(en[1])}if(Ut.offset=L$2,St&&St.idsToInsert){L$2+=St.idsToInsert.length*6,L$2>Fr&&mn(L$2),Ut.offset=L$2;let en=dT(j$2.subarray(_,L$2),St.idsToInsert);return St=null,en}return $n&ey?(j$2.start=_,j$2.end=L$2,j$2):j$2.subarray(_,L$2)}finally{if(ut){if($r<10&&$r++,Dr>1e4)ut.transitions=null,$r=0,Dr=0,_r.length>0&&(_r=[]);else if(_r.length>0&&!Ht){for(let en=0,In=_r.length;en<In;en++)_r[en][ts]=0;_r=[]}if(mt&&Ut.saveStructures){let en=ut.sharedLength||rr;ut.length>en&&(ut=ut.slice(0,en));let In=j$2.subarray(_,L$2);return Ut.saveStructures(ut,Mt)===!1?(Ut._mergeStructures(Ut.getStructures()),Ut.pack(Mn)):(Mt=en,In)}}$n&xT&&(L$2=_)}};let Br=Mn=>{L$2>Fr&&(j$2=mn(L$2));var $n=typeof Mn,en;if($n==="string"){let In=Mn.length;if(jr&&In>=8&&In<4096){let Qn=cT.test(Mn);jr[Qn?0:1]+=Mn,j$2[L$2++]=193,Br(Qn?-In:In);return}let Rn;In<32?Rn=1:In<256?Rn=2:In<65536?Rn=3:Rn=5;let qn=In*3;if(L$2+qn>Fr&&(j$2=mn(L$2+qn)),In<64||!Bt){let Qn,xs,cs,ks=L$2+Rn;for(Qn=0;Qn<In;Qn++)xs=Mn.charCodeAt(Qn),xs<128?j$2[ks++]=xs:xs<2048?(j$2[ks++]=xs>>6|192,j$2[ks++]=xs&63|128):(xs&64512)===55296&&((cs=Mn.charCodeAt(Qn+1))&64512)===56320?(xs=65536+((xs&1023)<<10)+(cs&1023),Qn++,j$2[ks++]=xs>>18|240,j$2[ks++]=xs>>12&63|128,j$2[ks++]=xs>>6&63|128,j$2[ks++]=xs&63|128):(j$2[ks++]=xs>>12|224,j$2[ks++]=xs>>6&63|128,j$2[ks++]=xs&63|128);en=ks-L$2-Rn}else en=Bt(Mn,L$2+Rn,qn);en<32?j$2[L$2++]=160|en:en<256?(Rn<2&&j$2.copyWithin(L$2+2,L$2+1,L$2+1+en),j$2[L$2++]=217,j$2[L$2++]=en):en<65536?(Rn<3&&j$2.copyWithin(L$2+3,L$2+2,L$2+2+en),j$2[L$2++]=218,j$2[L$2++]=en>>8,j$2[L$2++]=en&255):(Rn<5&&j$2.copyWithin(L$2+5,L$2+3,L$2+3+en),j$2[L$2++]=219,it.setUint32(L$2,en),L$2+=4),L$2+=en}else if($n==="number")if(Mn>>>0===Mn)Mn<64?j$2[L$2++]=Mn:Mn<256?(j$2[L$2++]=204,j$2[L$2++]=Mn):Mn<65536?(j$2[L$2++]=205,j$2[L$2++]=Mn>>8,j$2[L$2++]=Mn&255):(j$2[L$2++]=206,it.setUint32(L$2,Mn),L$2+=4);else if(Mn>>0===Mn)Mn>=-32?j$2[L$2++]=256+Mn:Mn>=-128?(j$2[L$2++]=208,j$2[L$2++]=Mn+256):Mn>=-32768?(j$2[L$2++]=209,it.setInt16(L$2,Mn),L$2+=2):(j$2[L$2++]=210,it.setInt32(L$2,Mn),L$2+=4);else{let In;if((In=this.useFloat32)>0&&Mn<4294967296&&Mn>=-2147483648){j$2[L$2++]=202,it.setFloat32(L$2,Mn);let Rn;if(In<4||(Rn=Mn*Ml[(j$2[L$2]&127)<<1|j$2[L$2+1]>>7])>>0===Rn){L$2+=4;return}else L$2--}j$2[L$2++]=203,it.setFloat64(L$2,Mn),L$2+=8}else if($n==="object")if(!Mn)j$2[L$2++]=192;else{if(St){let Rn=St.get(Mn);if(Rn){if(!Rn.id){let qn=St.idsToInsert||(St.idsToInsert=[]);Rn.id=qn.push(Rn)}j$2[L$2++]=214,j$2[L$2++]=112,it.setUint32(L$2,Rn.id),L$2+=4;return}else St.set(Mn,{offset:L$2-_})}let In=Mn.constructor;if(In===Object)Jr(Mn,!0);else if(In===Array){en=Mn.length,en<16?j$2[L$2++]=144|en:en<65536?(j$2[L$2++]=220,j$2[L$2++]=en>>8,j$2[L$2++]=en&255):(j$2[L$2++]=221,it.setUint32(L$2,en),L$2+=4);for(let Rn=0;Rn<en;Rn++)Br(Mn[Rn])}else if(In===Map){en=Mn.size,en<16?j$2[L$2++]=128|en:en<65536?(j$2[L$2++]=222,j$2[L$2++]=en>>8,j$2[L$2++]=en&255):(j$2[L$2++]=223,it.setUint32(L$2,en),L$2+=4);for(let[Rn,qn]of Mn)Br(Rn),Br(qn)}else{for(let Rn=0,qn=Dl.length;Rn<qn;Rn++){let Qn=Gu[Rn];if(Mn instanceof Qn){let xs=Dl[Rn];if(xs.write){xs.type&&(j$2[L$2++]=212,j$2[L$2++]=xs.type,j$2[L$2++]=0),Br(xs.write.call(this,Mn));return}let cs=j$2,ks=it,_o=L$2;j$2=null;let qs;try{qs=xs.pack.call(this,Mn,Ss=>(j$2=cs,cs=null,L$2+=Ss,L$2>Fr&&mn(L$2),{target:j$2,targetView:it,position:L$2-Ss}),Br)}finally{cs&&(j$2=cs,it=ks,L$2=_o,Fr=j$2.length-10)}qs&&(qs.length+L$2>Fr&&mn(qs.length+L$2),L$2=uT(qs,j$2,L$2,xs.type));return}}Jr(Mn,!Mn.hasOwnProperty)}}else if($n==="boolean")j$2[L$2++]=Mn?195:194;else if($n==="bigint"){if(Mn<BigInt(1)<<BigInt(63)&&Mn>=-(BigInt(1)<<BigInt(63)))j$2[L$2++]=211,it.setBigInt64(L$2,Mn);else if(Mn<BigInt(1)<<BigInt(64)&&Mn>0)j$2[L$2++]=207,it.setBigUint64(L$2,Mn);else if(this.largeBigIntToFloat)j$2[L$2++]=203,it.setFloat64(L$2,Number(Mn));else throw new RangeError(Mn+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");L$2+=8}else if($n==="undefined")this.encodeUndefinedAsNil?j$2[L$2++]=192:(j$2[L$2++]=212,j$2[L$2++]=0,j$2[L$2++]=0);else if($n==="function")Br(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+$n)},Jr=this.useRecords===!1?this.variableMapSize?Mn=>{let $n=Object.keys(Mn),en=$n.length;en<16?j$2[L$2++]=128|en:en<65536?(j$2[L$2++]=222,j$2[L$2++]=en>>8,j$2[L$2++]=en&255):(j$2[L$2++]=223,it.setUint32(L$2,en),L$2+=4);let In;for(let Rn=0;Rn<en;Rn++)Br(In=$n[Rn]),Br(Mn[In])}:(Mn,$n)=>{j$2[L$2++]=222;let en=L$2-_;L$2+=2;let In=0;for(let Rn in Mn)($n||Mn.hasOwnProperty(Rn))&&(Br(Rn),Br(Mn[Rn]),In++);j$2[en+++_]=In>>8,j$2[en+_]=In&255}:Mn=>{let $n=Object.keys(Mn),en,In=bt.transitions||(bt.transitions=Object.create(null)),Rn=0;for(let Qn=0,xs=$n.length;Qn<xs;Qn++){let cs=$n[Qn];en=In[cs],en||(en=In[cs]=Object.create(null),Rn++),In=en}let qn=In[ts];if(qn)qn>=96&&ar?(j$2[L$2++]=((qn-=96)&31)+96,j$2[L$2++]=qn>>5):j$2[L$2++]=qn;else{qn=bt.nextId,qn||(qn=64),qn<cr&&this.shouldShareStructure&&!this.shouldShareStructure($n)?(qn=bt.nextOwnId,qn<Ar||(qn=cr),bt.nextOwnId=qn+1):(qn>=Ar&&(qn=cr),bt.nextId=qn+1);let Qn=$n.highByte=qn>=96&&ar?qn-96>>5:-1;In[ts]=qn,bt[qn-64]=$n,qn<cr?($n.isShared=!0,bt.sharedLength=qn-63,mt=!0,Qn>=0?(j$2[L$2++]=(qn&31)+96,j$2[L$2++]=Qn):j$2[L$2++]=qn):(Qn>=0?(j$2[L$2++]=213,j$2[L$2++]=114,j$2[L$2++]=(qn&31)+96,j$2[L$2++]=Qn):(j$2[L$2++]=212,j$2[L$2++]=114,j$2[L$2++]=qn),Rn&&(Dr+=$r*Rn),_r.length>=sr&&(_r.shift()[ts]=0),_r.push(In),Br($n))}for(let Qn=0,xs=$n.length;Qn<xs;Qn++)Br(Mn[$n[Qn]])},mn=Mn=>{let $n;if(Mn>16777216){if(Mn-_>Xm)throw new Error("Packed buffer would be larger than maximum buffer size");$n=Math.min(Xm,Math.round(Math.max((Mn-_)*(Mn>67108864?1.25:2),4194304)/4096)*4096)}else $n=(Math.max(Mn-_<<2,j$2.length-1)>>12)+1<<12;let en=new Vu($n);return it=new DataView(en.buffer,0,$n),j$2.copy?j$2.copy(en,0,_,Mn):en.set(j$2.slice(_,Mn)),L$2-=_,_=0,Fr=en.length-10,j$2=en}}useBuffer(rt){j$2=rt,it=new DataView(j$2.buffer,j$2.byteOffset,j$2.byteLength),L$2=0}};Gu=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,es];Dl=[{pack(rt,_,ut){let mt=rt.getTime()/1e3;if((this.useTimestamp32||rt.getMilliseconds()===0)&&mt>=0&&mt<4294967296){let{target:bt,targetView:St,position:Mt}=_(6);bt[Mt++]=214,bt[Mt++]=255,St.setUint32(Mt,mt)}else if(mt>0&&mt<17179869184){let{target:bt,targetView:St,position:Mt}=_(10);bt[Mt++]=215,bt[Mt++]=255,St.setUint32(Mt,rt.getMilliseconds()*4e6+(mt/1e3/4294967296>>0)),St.setUint32(Mt+4,mt)}else if(isNaN(mt)){if(this.onInvalidDate)return _(0),ut(this.onInvalidDate());let{target:bt,targetView:St,position:Mt}=_(3);bt[Mt++]=212,bt[Mt++]=255,bt[Mt++]=255}else{let{target:bt,targetView:St,position:Mt}=_(15);bt[Mt++]=199,bt[Mt++]=12,bt[Mt++]=255,St.setUint32(Mt,rt.getMilliseconds()*1e6),St.setBigInt64(Mt+4,BigInt(Math.floor(mt)))}}},{pack(rt,_,ut){let mt=Array.from(rt),{target:bt,position:St}=_(this.structuredClone?3:0);this.structuredClone&&(bt[St++]=212,bt[St++]=115,bt[St++]=0),ut(mt)}},{pack(rt,_,ut){let{target:mt,position:bt}=_(this.structuredClone?3:0);this.structuredClone&&(mt[bt++]=212,mt[bt++]=101,mt[bt++]=0),ut([rt.name,rt.message])}},{pack(rt,_,ut){let{target:mt,position:bt}=_(this.structuredClone?3:0);this.structuredClone&&(mt[bt++]=212,mt[bt++]=120,mt[bt++]=0),ut([rt.source,rt.flags])}},{pack(rt,_){this.structuredClone?Km(rt,16,_):Qm(Ll?Buffer.from(rt):new Uint8Array(rt),_)}},{pack(rt,_){let ut=rt.constructor;ut!==Zm&&this.structuredClone?Km(rt,Ru.indexOf(ut.name),_):Qm(rt,_)}},{pack(rt,_){let{target:ut,position:mt}=_(1);ut[mt]=193}}];function Km(rt,_,ut,mt){let bt=rt.byteLength;if(bt+1<256){var{target:St,position:Mt}=ut(4+bt);St[Mt++]=199,St[Mt++]=bt+1}else if(bt+1<65536){var{target:St,position:Mt}=ut(5+bt);St[Mt++]=200,St[Mt++]=bt+1>>8,St[Mt++]=bt+1&255}else{var{target:St,position:Mt,targetView:Bt}=ut(7+bt);St[Mt++]=201,Bt.setUint32(Mt,bt+1),Mt+=4}St[Mt++]=116,St[Mt++]=_,St.set(new Uint8Array(rt.buffer,rt.byteOffset,rt.byteLength),Mt)}function Qm(rt,_){let ut=rt.byteLength;var mt,bt;if(ut<256){var{target:mt,position:bt}=_(ut+2);mt[bt++]=196,mt[bt++]=ut}else if(ut<65536){var{target:mt,position:bt}=_(ut+3);mt[bt++]=197,mt[bt++]=ut>>8,mt[bt++]=ut&255}else{var{target:mt,position:bt,targetView:St}=_(ut+5);mt[bt++]=198,St.setUint32(bt,ut),bt+=4}mt.set(rt,bt)}function uT(rt,_,ut,mt){let bt=rt.length;switch(bt){case 1:_[ut++]=212;break;case 2:_[ut++]=213;break;case 4:_[ut++]=214;break;case 8:_[ut++]=215;break;case 16:_[ut++]=216;break;default:bt<256?(_[ut++]=199,_[ut++]=bt):bt<65536?(_[ut++]=200,_[ut++]=bt>>8,_[ut++]=bt&255):(_[ut++]=201,_[ut++]=bt>>24,_[ut++]=bt>>16&255,_[ut++]=bt>>8&255,_[ut++]=bt&255)}return _[ut++]=mt,_.set(rt,ut),ut+=bt,ut}function dT(rt,_){let ut,mt=_.length*6,bt=rt.length-mt;for(_.sort((St,Mt)=>St.offset>Mt.offset?1:-1);ut=_.pop();){let St=ut.offset,Mt=ut.id;rt.copyWithin(St+mt,St,bt),mt-=6;let Bt=St+mt;rt[Bt++]=214,rt[Bt++]=105,rt[Bt++]=Mt>>24,rt[Bt++]=Mt>>16&255,rt[Bt++]=Mt>>8&255,rt[Bt++]=Mt&255,bt=St}return rt}function ko(rt){if(rt.Class){if(!rt.pack&&!rt.write)throw new Error("Extension has no pack or write function");if(rt.pack&&!rt.type)throw new Error("Extension has no type (numeric code to identify the extension)");Gu.unshift(rt.Class),Dl.unshift(rt)}Ym(rt)}var Jm=new _n({useRecords:!1});Jm.pack;Jm.pack;var ey=512,xT=1024,ty=new _n({structuredClone:!0});ko({Class:he.prototype.constructor,type:1,write(rt){return{...rt}},read(rt){return Object.setPrototypeOf(rt,he.prototype),rt}});ko({Class:ye.prototype.constructor,type:2,write(rt){return[...rt]},read(rt){return Object.setPrototypeOf(rt,ye.prototype),rt}});ko({Class:$e.prototype.constructor,type:3,write(rt){return[...rt]},read(rt){return Object.setPrototypeOf(rt,$e.prototype),rt}});ko({Class:Za.prototype.constructor,type:4,write(rt){return rt.id},read(rt){return new Za(rt)}});ko({Class:Ja.prototype.constructor,type:5,write(rt){return rt.data},read(rt){return new Ja(rt)}});ko({Class:ke.prototype.constructor,type:6,write(rt){return{...rt}},read(rt){return Object.setPrototypeOf(rt,ke.prototype),rt}});function vT(rt){var _=0;if(rt.length===0)return _;for(let ut=0;ut<rt.length;ut++){let mt=rt[ut];_=(_<<5)-_+mt,_=_&_}return _}function zu(rt){if(Si(rt))return rt;if(Array.isArray(rt))return rt.map(zu);if(typeof rt=="object"&&rt!==null){let _={};for(let ut of Object.keys(rt).sort())_[ut]=zu(rt[ut]);return Object.setPrototypeOf(_,Object.getPrototypeOf(rt)),_}else return rt}var Bl;(rt=>{function _(bt){return ty.pack(bt)}rt.serialize=_;function ut(bt){return ty.unpack(bt)}rt.deserialize=ut;function mt(bt){return vT(_(zu(bt))).toString()}rt.checksum=mt})(Bl||(Bl={}));var Uo="personal camera",Ho="a218fcc3-276b-49b9-b485-49037fd14f5f",sy=2960946,dt=5526619,ry;(rt=>{function _(mt,bt){return mt[0]===bt[0]&&mt[1]===bt[1]}rt.isEqual=_;function ut(mt,bt,St){return[mt[0]+(bt[0]-mt[0])*St,mt[1]+(bt[1]-mt[1])*St]}rt.lerp=ut})(ry||(ry={}));var Fo;(rt=>{function _(Ut,Ht){return Ut[0]===Ht[0]&&Ut[1]===Ht[1]&&Ut[2]===Ht[2]}rt.isEqual=_;function ut(Ut,Ht){return[Ut[0]+Ht[0],Ut[1]+Ht[1],Ut[2]+Ht[2]]}rt.add=ut;function mt(Ut,Ht){return[Ut[0]-Ht[0],Ut[1]-Ht[1],Ut[2]-Ht[2]]}rt.sub=mt;function bt(Ut,Ht){return[Ut[0]/Ht[0],Ut[1]/Ht[1],Ut[2]/Ht[2]]}rt.div=bt;function St(Ut,Ht){return[Ut[0]*Ht[0],Ut[1]*Ht[1],Ut[2]*Ht[2]]}rt.mul=St;function Mt(Ut,Ht){return Math.hypot(Ut[0]-Ht[0],Ut[1]-Ht[1],Ut[2]-Ht[2])}rt.dist=Mt;function Bt(Ut,Ht,tr){return[Ut[0]+(Ht[0]-Ut[0])*tr,Ut[1]+(Ht[1]-Ut[1])*tr,Ut[2]+(Ht[2]-Ut[2])*tr]}rt.lerp=Bt})(Fo||(Fo={}));var oy;(rt=>{function _(mt,bt){return mt[0]===bt[0]&&mt[1]===bt[1]&&mt[2]===bt[2]&&mt[3]===bt[3]}rt.isEqual=_;function ut(mt,bt,St){return[mt[0]+(bt[0]-mt[0])*St,mt[1]+(bt[1]-mt[1])*St,mt[2]+(bt[2]-mt[2])*St,mt[3]+(bt[3]-mt[3])*St]}rt.lerp=ut})(oy||(oy={}));var jo;(rt=>{rt.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function _(bt,St){for(let Mt=0;Mt<16;Mt++)if(bt[Mt]!==St[Mt])return!1;return!0}rt.isEqual=_;function ut(bt){return bt??rt.identity}rt.simplify=ut;function mt(bt,St){let Mt=St.slice(0);for(var Bt=0,Ut=St.length;Bt<Ut;Bt+=3){let Ht=bt[3]*St[Bt]+bt[7]*St[Bt+1]+bt[11]*St[Bt+2]+bt[15];Mt[Bt]=(bt[0]*St[Bt]+bt[4]*St[Bt+1]+bt[8]*St[Bt+2]+bt[12])/Ht,Mt[Bt+1]=(bt[1]*St[Bt]+bt[5]*St[Bt+1]+bt[9]*St[Bt+2]+bt[13])/Ht,Mt[Bt+2]=(bt[2]*St[Bt]+bt[6]*St[Bt+1]+bt[10]*St[Bt+2]+bt[14])/Ht}return Mt}rt.applyMatrix4=mt})(jo||(jo={}));var vt;(rt=>{function _(Ut){return typeof Ut=="object"&&typeof Ut.r=="number"&&typeof Ut.g=="number"&&typeof Ut.b=="number"}rt.isRGB=_,rt.white={r:1,g:1,b:1},rt.red={r:1,g:0,b:0},rt.black={r:0,g:0,b:0};function ut(Ut){return{r:Math.round(Ut.r*255),g:Math.round(Ut.g*255),b:Math.round(Ut.b*255),a:1}}rt.toRgb255a1=ut;function mt(Ut){return{r:Ut.r,g:Ut.g,b:Ut.b}}rt.clone=mt;function bt(Ut){return Ut=Math.floor(Ut),{r:(Ut>>16&255)/255,g:(Ut>>8&255)/255,b:(Ut&255)/255}}rt.fromHex=bt;function St(Ut){return Math.round(Ut.r*255)*65536+Math.round(Ut.g*255)*256+Math.round(Ut.b*255)}rt.toHex=St;function Mt(Ut,Ht){return Ut.r===Ht.r&&Ut.g===Ht.g&&Ut.b===Ht.b}rt.equals=Mt;function Bt(Ut,Ht,tr){return{r:Ut.r+(Ht.r-Ut.r)*tr,g:Ut.g+(Ht.g-Ut.g)*tr,b:Ut.b+(Ht.b-Ut.b)*tr}}rt.lerp=Bt})(vt||(vt={}));var Gt;(rt=>{rt.white={...vt.white,a:1},rt.transparent={...vt.white,a:0};function _(Mt){return{r:Mt[0],g:Mt[1],b:Mt[2],a:Mt[3]}}rt.from0to1=_;function ut(Mt,Bt){return{...vt.fromHex(Mt),a:Bt}}rt.fromHexAndA=ut;function mt(Mt){return{r:Math.round(Mt.r*255),g:Math.round(Mt.g*255),b:Math.round(Mt.b*255),a:Mt.a}}rt.toRgb255a1=mt;function bt(Mt,Bt){return vt.equals(Mt,Bt)&&Mt.a===Bt.a}rt.equals=bt;function St(Mt,Bt,Ut){return{r:Mt.r+(Bt.r-Mt.r)*Ut,g:Mt.g+(Bt.g-Mt.g)*Ut,b:Mt.b+(Bt.b-Mt.b)*Ut,a:Mt.a+(Bt.a-Mt.a)*Ut}}rt.lerp=St})(Gt||(Gt={}));var Rl;(rt=>rt.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(Rl||(Rl={}));var ny;(rt=>rt.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(ny||(ny={}));var iy;(rt=>rt.defaultData={control1:[.5,0],control2:[.5,1]})(iy||(iy={}));var ay;(rt=>(rt.linear=[0,0,1,1],rt.ease=[.25,.1,.25,1],rt.easeIn=[.42,0,1,1],rt.easeOut=[0,0,.58,1],rt.easeInOut=[.42,0,.58,1]))(ay||(ay={}));function ku(rt){return typeof rt=="string"&&rt.length===36?/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(rt):!1}var vr;(rt=>{rt.all=["PerspectiveCamera","OrthographicCamera"];function _(ut){return rt.all.includes(ut)}rt.is=_})(vr||(vr={}));var qo;(rt=>{rt.DefaultUp=[0,1,0],rt.DefaultTargetOffset=1e3,rt.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:rt.DefaultUp,isUpVectorFlipped:!1,targetOffset:rt.DefaultTargetOffset};function _(ut){return ut.type==="PerspectiveCamera"?ut.perspective.zoom:ut.orthographic.zoom}rt.getZoom=_})(qo||(qo={}));var Ur;(rt=>{function _(mt,bt=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(mt[0],mt[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[mt[0]+mt[0]*bt,0,0]},grid:{count:[2,2,2],size:mt.map(St=>St*(1+bt)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}rt.defaultData=_;function ut(mt,bt){let St={...mt};if(bT.forEach(Mt=>{Object.assign(St,{[Mt]:bt[Mt]??mt[Mt]})}),St.radial={...mt.radial},bt.radial){let Mt=mt.radial,Bt=bt.radial;ST.forEach(Ut=>{Object.assign(St.radial,{[Ut]:Bt[Ut]??Mt[Ut]})})}if(St.linear={...mt.linear},bt.linear){let Mt=mt.linear,Bt=bt.linear;wT.forEach(Ut=>{Object.assign(St.linear,{[Ut]:Bt[Ut]??Mt[Ut]})})}if(St.grid={...mt.grid},bt.grid){let Mt=mt.grid,Bt=bt.grid;_T.forEach(Ut=>{Object.assign(St.grid,{[Ut]:Bt[Ut]??Mt[Ut]})})}if(St.toObject={...mt.toObject},bt.toObject){let Mt=mt.toObject,Bt=bt.toObject;AT.forEach(Ut=>{Object.assign(St.toObject,{[Ut]:Bt[Ut]??Mt[Ut]})})}if(St.randomnessObject={...mt.randomnessObject},bt.randomnessObject){let Mt=mt.randomnessObject,Bt=bt.randomnessObject;TT.forEach(Ut=>{Object.assign(St.randomnessObject,{[Ut]:Bt[Ut]??Mt[Ut]})})}return St}rt.merge=ut})(Ur||(Ur={}));var Vl;(rt=>{rt.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let _=["radial","linear","grid","toObject","randomnessObject"];function ut(mt,bt){let St=[];mt.count!==void 0&&St.push({type:0,path:bt,props:{count:mt.count}});for(let Mt of _){let Bt=mt[Mt];Bt&&Object.keys(Bt).length>0&&St.push({type:0,path:[...bt,Mt],props:Bt})}return St}rt.toOps=ut})(Vl||(Vl={}));var bT=["count"],ST=["radius","start","end","position","scale","rotation"],wT=["position","scale","rotation"],_T=["count","size"],AT=["count","position","scale","rotation"],TT=["strength","scale","rotation","position","movement","seed","freqScale"],Gl;(rt=>{rt.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function _(ut){return rt.all.includes(ut)}rt.is=_})(Gl||(Gl={}));var zl;(rt=>{function _(mt){return ut(mt)}rt.defaultData=_;function ut(mt){if(mt==="PointLight")return{type:mt,color:Gt.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(mt==="SpotLight")return{type:mt,color:Gt.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(mt==="DirectionalLight")return{type:mt,color:Gt.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(zl||(zl={}));var Wo;(rt=>rt.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(Wo||(Wo={}));var Fu;(rt=>{rt.defaultData={castShadow:!0,receiveShadow:!0};function _(ut,mt){return ut.castShadow===mt.castShadow&&ut.receiveShadow===mt.receiveShadow}rt.equals=_})(Fu||(Fu={}));var ju;(rt=>{rt.defaultData={flatShading:!1,wireframe:!1,side:0};function _(ut,mt){return ut.flatShading===mt.flatShading&&ut.side===mt.side&&ut.wireframe===mt.wireframe}rt.equals=_})(ju||(ju={}));var kl;(rt=>rt.defaultData={...ju.defaultData,...Fu.defaultData})(kl||(kl={}));var ly;(rt=>{function _(ut,mt){var St,Mt;let bt=[];if("material"in ut){let Bt=typeof ut.material=="string"?mt.materials[ut.material]??((St=mt.lib.materials[ut.material])==null?void 0:St.asset):ut.material;Bt&&bt.push(Bt)}else if("materials"in ut)for(let Bt of ut.materials){let Ut=typeof Bt=="string"?mt.materials[Bt]??((Mt=mt.lib.materials[Bt])==null?void 0:Mt.asset):Bt;Ut&&bt.push(Ut)}return bt}rt.getMaterialData=_})(ly||(ly={}));var Pi;(rt=>(rt.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},rt.maxSize=3e7))(Pi||(Pi={}));var cy;(rt=>{function _(ut){return ut==="texture"||ut==="video"||ut==="color"||ut==="depth"||ut==="normal"||ut==="gradient"||ut==="noise"||ut==="fresnel"||ut==="rainbow"||ut==="toon"||ut==="outline"||ut==="transmission"||ut==="matcap"||ut==="displace"||ut==="pattern"||ut==="light"}rt.is=_})(cy||(cy={}));function dy(rt){return rt.type!=="displace"}var uy;(rt=>{function _(ut){return ut==="phong"||ut==="toon"||ut==="lambert"||ut==="physical"}rt.is=_})(uy||(uy={}));var py=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],fy=["wrapping","image","video","name"],zt;(rt=>{function _(St,Mt){let{texture:Bt,...Ut}=Mt;if(Object.assign(St,Ut),Bt){let Ht=St.texture;Ht&&Object.assign(Ht,Bt)}}rt.patch=_;function ut(St,Mt){return St==="light"&&Mt?mt(Mt):bt(St)}rt.defaultData=ut;function mt(St){let Mt={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(St){case"phong":return{...Mt,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...Mt,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...Mt,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...Mt,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function bt(St){let Mt={alpha:1,mode:0,isMask:!1,visible:!0};switch(St){case"texture":return{...Mt,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{...Mt,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:Pi.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!1};case"color":return{...Mt,type:"color",color:vt.fromHex(dt)};case"depth":return{...Mt,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...Mt,type:"normal",cnormal:[1,1,1]};case"gradient":return{...Mt,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...Mt,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...vt.fromHex(6710886),a:1},colorB:{...vt.fromHex(6710886),a:1},colorC:{...vt.fromHex(16777215),a:1},colorD:{...vt.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...Mt,type:"fresnel",color:Gt.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...Mt,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...Mt,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Gt.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...Mt,type:"outline",outlineColor:Gt.fromHexAndA(0,1),contourColor:Gt.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...Mt,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{...Mt,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...Mt,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...vt.fromHex(0),a:1},colorB:{...vt.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(zt||(zt={}));var Pt;(rt=>{function _(Ht){return!Ht.layers.some(tr=>tr.data.type==="texture"&&tr.data.projection!==0||tr.data.type==="depth"&&!tr.data.isWorldSpace||tr.data.type==="noise"||tr.data.type==="displace")}rt.isMergable=_;function ut(Ht){let tr="";return Ht.layers.forEach(rr=>{Object.entries(rr.data).forEach(([sr,ar])=>{tr+=`${sr}${ar}`,Array.isArray(ar)?ar.forEach(cr=>tr+=`${cr}`):typeof ar=="object"?Object.values(ar).forEach(cr=>{typeof cr=="number"?tr+=`${cr.toFixed(4)}`:tr+=`${cr}`}):tr+=`${ar}`})}),tr}rt.getHash=ut;function mt(){return{layers:new ye}}rt.defaultEmptyData=mt;function bt(Ht="layer1",tr="layer2"){return Mt("phong",Ht,tr)}rt.defaultData=bt;function St(Ht,tr){return{...Ht,name:tr}}rt.withName=St;function Mt(Ht,tr="layer1",rr="layer2"){let sr=new ye;return sr.push({fi:0,data:zt.defaultData("light",Ht),id:tr}),sr.push({fi:1,data:zt.defaultData("color"),id:rr}),{layers:sr}}rt.defaultTwoLayerData=Mt;function Bt(Ht,tr="phong",rr="layer1",sr="layer2"){let ar=zt.defaultData("texture");Object.assign(ar.texture,{image:Ht});let cr=new ye;return cr.push({fi:0,data:ar,id:rr}),cr.push({fi:1,data:zt.defaultData("light",tr),id:sr}),{layers:cr}}rt.defaultTwoLayerTextureData=Bt;function Ut(Ht,tr="phong",rr="layer1",sr="layer2"){let ar=zt.defaultData("video");Object.assign(ar.texture,{video:Ht});let cr=new ye;return cr.push({fi:0,data:ar,id:rr}),cr.push({fi:1,data:zt.defaultData("light",tr),id:sr}),{layers:cr}}rt.defaultTwoLayerVideoTextureData=Ut})(Pt||(Pt={}));var Oi;(rt=>{function _(){return{points:new ye,roundness:0,shapeHoles:[],isClosed:!1}}rt.defaultData=_})(Oi||(Oi={}));var Mi;(rt=>{function _(){return{points:new ye,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}rt.defaultData=_})(Mi||(Mi={}));var Uu={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},Fl;(rt=>{function _(ut,mt){let bt={...ut};return CT.forEach(St=>{Object.assign(bt,{[St]:mt[St]??ut[St]})}),bt}rt.merge=_})(Fl||(Fl={}));var jl={shape:Uu,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},CT=["depth","offset","angle","twist","startScale","endScale"],rs;(rt=>{function _(mt){return mt==="PolygonGeometry"||mt==="RectangleGeometry"||mt==="StarGeometry"||mt==="TriangleGeometry"||mt==="EllipseGeometry"}rt.is2DParametricMesh=_;function ut(mt){return mt==="PolygonGeometry"||mt==="PolygonGeometry"||mt==="RectangleGeometry"||mt==="StarGeometry"||mt==="TriangleGeometry"||mt==="EllipseGeometry"||mt==="PathGeometry"||mt==="VectorGeometry"||mt==="ConeGeometry"||mt==="CubeGeometry"||mt==="CylinderGeometry"||mt==="DodecahedronGeometry"||mt==="HelixGeometry"||mt==="IcosahedronGeometry"||mt==="LatheGeometry"||mt==="PyramidGeometry"||mt==="SphereGeometry"||mt==="PlaneGeometry"||mt==="BackdropGeometry"||mt==="TorusGeometry"||mt==="TorusKnotGeometry"||mt==="BooleanGeometry"||mt==="TextGeometry"}rt.isParametricMesh=ut})(rs||(rs={}));var Ul;(rt=>{function _(ut,mt){let bt={...ut};return Object.assign(bt,mt),bt.type==="PathGeometry"&&"extrusion"in mt&&mt.extrusion&&(bt.extrusion={...ut.extrusion},Object.assign(bt.extrusion,Fl.merge(bt.extrusion,mt.extrusion))),bt}rt.merge=_})(Ul||(Ul={}));var $o;(rt=>{function _(ut){if(ut==="RectangleGeometry")return{width:320,height:320,type:ut,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(ut==="PathGeometry")return{type:ut,width:1,height:1,depth:1,path:Mi.defaultData(),extrusion:jl};if(ut==="VectorGeometry")return{width:1,height:1,type:ut,subdivisions:12,shape:Oi.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(ut==="BooleanGeometry")return{type:ut,operation:2,width:0,height:0,depth:0,phongAngle:35};if(ut==="TextGeometry")return{type:ut,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:{textValue:""},textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if(ut==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180};throw new Error("not implemented")}rt.defaultData=_})($o||($o={}));var Hl;(rt=>rt.defaultData={enabled:!1,useBackgroundColor:!1,color:vt.white,near:.1,far:2e3})(Hl||(Hl={}));var ql;(rt=>{let _={opacity:1,blendFunction:13,enabled:!1};rt.defaultData={enabled:!1,pixelation:{..._,blendFunction:16,granularity:15},bloom:{..._,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{..._,offset:[2,2]},vignette:{..._,darkness:1,offset:0},hueSaturation:{..._,hue:3,saturation:0},brightnessContrast:{..._,brightness:.25,contrast:0},depthOfField:{..._,focalLength:2,focusDistance:2,bokehScale:2},noise:{..._,blendFunction:16}}})(ql||(ql={}));var Hu;(rt=>rt.defaultData={softShadowQuality:"low"})(Hu||(Hu={}));var qu;(rt=>rt.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(qu||(qu={}));var Wu;(rt=>rt.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(Wu||(Wu={}));var os;(rt=>rt.defaultData={usePhysics:!1,gravity:-10})(os||(os={}));var $u;(rt=>rt.defaultData={playCamera:Uo,gameControlObject:null})($u||($u={}));var Wl;(rt=>rt.defaultData={backgroundColor:Gt.fromHexAndA(sy,1),postprocessing:ql.defaultData,fog:Hl.defaultData,globalPhysics:os.defaultData,ambient:qu.defaultData,ao:Wu.defaultData,shadow:Hu.defaultData,publish:$u.defaultData})(Wl||(Wl={}));var hy;(rt=>{function _(mt){return mt==="Component"||mt==="Instance"}rt.isComponentRelated=_;function ut(mt){return mt==="Empty"||mt==="Instance"}rt.isEmptyOrComponent=ut})(hy||(hy={}));var Ii;(rt=>{rt.identity={...Rl.identity,hiddenMatrix:jo.identity};function _(bt){return{position:bt.position,rotation:bt.rotation,scale:bt.scale,hiddenMatrix:bt.hiddenMatrix}}rt.fromObject=_;function ut(bt,St){return{position:(St==null?void 0:St.position)||bt.position,rotation:(St==null?void 0:St.rotation)||bt.rotation,scale:(St==null?void 0:St.scale)||bt.scale,hiddenMatrix:(St==null?void 0:St.hiddenMatrix)||bt.hiddenMatrix}}rt.merge=ut;function mt(bt,St){return ef({position:Fo.isEqual(bt.position,St.position)?void 0:St.position,rotation:Fo.isEqual(bt.rotation,St.rotation)?void 0:St.rotation,scale:Fo.isEqual(bt.scale,St.scale)?null:St.scale,hiddenMatrix:jo.isEqual(bt.hiddenMatrix,St.hiddenMatrix)?void 0:St.hiddenMatrix})}rt.diff=mt})(Ii||(Ii={}));var Ot;(rt=>rt.defaultData={states:new ye,events:new ye,visible:!0,raycastLock:!1,physics:Wo.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...Ii.identity,cloner:null})(Ot||(Ot={}));var $l;(rt=>rt.defaultData={type:"Empty",...Ot.defaultData})($l||($l={}));var my;(rt=>rt.defaultData={type:"Component",...Ot.defaultData})(my||(my={}));var An;(rt=>rt.defaultData={type:"Mesh",...Ot.defaultData,...kl.defaultData})(An||(An={}));var Tn;(rt=>rt.defaultData={...Ot.defaultData,...Ii.identity,position:[0,0,qo.DefaultTargetOffset],...qo.defaultData})(Tn||(Tn={}));var Yl;(rt=>{function _(ut){return{...Ot.defaultData,...zl.defaultData(ut)}}rt.defaultData=_,rt.defaultDirectionalLightData={...rt.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})(Yl||(Yl={}));var Ni;(rt=>{function _(mt,bt,St=0){for(;St<bt.length;){let Mt=mt?mt[bt[St]]:void 0;if(bt.length===St+1)return Mt;if(Mt)mt=Mt.descendants,St+=1;else return}}rt.resolveWithDes=_;function ut(mt,bt,St=0){let Mt=_(mt,bt,St);if(Mt){let Bt=Object.keys(Mt);if(Bt.length===1&&Bt[0]==="descendants")return}return Mt}rt.resolve=ut})(Ni||(Ni={}));var Hr;(rt=>{rt.rootOverrideProps=["physics","events"],rt.compositeNonOptionalOverrideProps=["geometry"],rt.compositeEntireOverrideOverrideProps=["material"];function _(mt,bt){return{...Ot.defaultData,...bt,component:mt,overrides:new ke,physics:void 0,events:void 0,type:"Instance"}}rt.ofComponent=_;function ut(mt){let bt=Ii.fromObject(mt.data);return _(mt.id,bt)}rt.fromComponentData=ut})(Hr||(Hr={}));var xo;(rt=>rt.defaultData={type:"Page",...Ot.defaultData,physics:{...Wo.defaultData,fusedBody:!1},...Wl.defaultData,camera:Tn.defaultData})(xo||(xo={}));var Xl;(rt=>(rt.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:jo.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:Wo.defaultData,states:new ye,events:new ye,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...qo.defaultData},rt.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},rt.defaultMeshObject={name:"Rectangle",...Ot.defaultData,...An.defaultData,geometry:$o.defaultData("RectangleGeometry"),material:Pt.defaultTwoLayerData("phong","layer1","layer2")},rt.defaultBooleanObject={name:"Boolean",...Ot.defaultData,...An.defaultData,geometry:$o.defaultData("BooleanGeometry"),material:Pt.defaultTwoLayerData("phong","layer1","layer2")},rt.defaultTextObject={name:"Text",...Ot.defaultData,...An.defaultData,geometry:$o.defaultData("TextGeometry"),material:Pt.defaultTwoLayerData("phong","layer1","layer2")}))(Xl||(Xl={}));var Cn;(rt=>{function _(St,Mt){let Bt={name:Mt};return St.type==="Mesh"?(Bt.geometry={},"material"in St&&(Bt.material={layers:new ke}),"materials"in St&&(Bt.materials=St.materials.map(Ut=>({layers:new ke})))):vr.is(St.type)&&(Bt.perspective={},Bt.orthographic={}),Bt}rt.newEmpty=_;function ut(St,Mt){if(Mt===void 0)return St;let Bt={...St};return"material"in Bt&&"material"in Mt&&Mt.material&&(Bt.material=Vo(Bt.material,Ut=>{if(typeof Ut!="string")for(let[Ht,tr]of Object.entries(Mt.material.layers)){let rr=Ut.layers.data(Ht);rr&&zt.patch(rr,tr)}}).data),Bt.materials&&Mt.materials&&(Bt.materials=Vo(Bt.materials,Ut=>{var Ht,tr;for(let rr=0;rr<Bt.materials.length;rr++){let sr=Mt.materials[rr];if(typeof sr!="string")for(let[ar,cr]of Object.entries(sr.layers)){let Ar=(tr=(Ht=Ut[rr])==null?void 0:Ht.layers)==null?void 0:tr.data(ar);Ar&&zt.patch(Ar,cr)}}}).data),Bt}function mt(St,Mt){let Bt,Ut=[],Ht={orthographic:0,perspective:0,geometry:0};function tr(rr,sr){for(let[ar,cr]of Object.entries(sr.layers)){let{texture:Ar,..._r}=cr;if(Ar!==void 0&&Object.keys(Ar).length>0){let Dr={path:[...rr,"layers",ar,"texture"],props:Ar,type:0};Ut.push(Dr)}if(Object.keys(_r).length>0){let Dr={path:[...rr,"layers",ar],props:_r,type:0};Ut.push(Dr)}}}for(let[rr,sr]of Object.entries(Mt))if(rr!=="name")if(rr==="cloner")Ut.push(...Vl.toOps(sr,["cloner"]));else if(rr==="pathSnapping")Ut.push({path:[rr],props:{slide:sr.slide,offset:sr.offset},type:0});else if(rr==="material")tr(["material"],sr);else if(rr==="materials")for(let[ar,cr]of Object.entries(sr))tr(["materials",ar],cr);else if(Ht[rr]===0){if(rr==="geometry"&&sr.extrusion!==void 0){let ar={path:[rr,"extrusion"],props:sr.extrusion,type:0};Ut.push(ar),sr={...sr},delete sr.extrusion}if(Object.keys(sr).length>0){let ar={path:[rr],props:sr,type:0};Ut.push(ar)}}else Bt===void 0&&(Bt={path:[],props:{},type:0},Ut.push(Bt)),Bt.props[rr]=sr;return Ut}rt.toOps=mt;function bt(St,Mt){var Ut,Ht,tr,rr,sr,ar;if(Mt===void 0)return St;let Bt={...St};if(Object.assign(Bt,Ii.merge(Bt,Mt)),Object.assign(Bt,{pathSnapping:Object.assign({},Bt.pathSnapping,{slide:((Ut=Mt.pathSnapping)==null?void 0:Ut.slide)??((Ht=Bt.pathSnapping)==null?void 0:Ht.slide)??0,offset:((tr=Mt.pathSnapping)==null?void 0:tr.offset)??((rr=Bt.pathSnapping)==null?void 0:rr.offset)??0})}),vr.is(St.type)){Bt.orthographic={...Bt.orthographic},Bt.perspective={...Bt.perspective};let cr=Mt;((sr=cr.orthographic)==null?void 0:sr.zoom)!==void 0&&(Bt.orthographic.zoom=cr.orthographic.zoom),((ar=cr.perspective)==null?void 0:ar.zoom)!==void 0&&(Bt.perspective.zoom=cr.perspective.zoom),cr.isUpVectorFlipped!==void 0&&(Bt.isUpVectorFlipped=cr.isUpVectorFlipped),cr.targetOffset!==void 0&&(Bt.targetOffset=cr.targetOffset)}else if(St.type==="Mesh")"geometry"in Mt&&Object.assign(Bt,{geometry:Ul.merge(Bt.geometry,Mt.geometry)}),(Mt.material||Mt.materials)&&(Bt=ut(Bt,Mt)),Bt.cloner&&"cloner"in Mt&&Object.assign(Bt,{cloner:Ur.merge(Bt.cloner,Mt.cloner)});else if(St.type==="Empty")Bt.cloner&&"cloner"in Mt&&Object.assign(Bt,{cloner:Ur.merge(Bt.cloner,Mt.cloner)});else if(Gl.is(St.type)){let cr=Mt;cr.intensity!==void 0&&(Bt.intensity=cr.intensity),cr.color!==void 0&&(typeof cr.color=="string"?Bt.color=cr.color:Bt.color=vt.clone(cr.color))}return Bt}rt.patch=bt})(Cn||(Cn={}));var Di;(rt=>rt.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,hoverRotateDamping:.125,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(Di||(Di={}));var qr;(rt=>rt.defaultData={orbitControls:Di.defaultData,playPage:Ho,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((_,ut)=>{let mt=0,bt=0;return ut<5?bt=-30:ut<10&&(bt=30),ut===0||ut===10||ut===5?mt=30:(ut===4||ut===11||ut===9)&&(mt=-30),[120,[mt,bt],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,hdTransmission:!1})(qr||(qr={}));var Yu;(rt=>rt.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(Yu||(Yu={}));var Xu;(rt=>rt.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(Xu||(Xu={}));var Yo;(rt=>(rt.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...Yu.defaultData},isRandomSeed:!0,seed:rt.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:Xu.defaultData}),rt.generateSeed=()=>Math.round(Math.random()*1e5)))(Yo||(Yo={}));var yy;(rt=>{function _(mt){return mt.find(bt=>bt.data.type==="Page"&&bt.data.globalPhysics.usePhysics)!==void 0}rt.physicsEnabled=_;function ut(mt,bt,St){mt.scene.objects.traverseFrom(bt,(Mt,Bt)=>{var Ut;if(Bt.type==="Instance"){let Ht=(Ut=Li.getComponentData(mt,Bt.component))==null?void 0:Ut.data;Ht&&St(Mt,Bt,Ht.events)}else St(Mt,Bt,Bt.events)})}rt.traverseModuleInstances=ut})(yy||(yy={}));var Xo;(rt=>{rt.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function _(bt={withLight:!0,withSquare:!0}){let St=[],Mt=Xl.defaultMeshObject;bt.withLight===!0&&St.push({fi:-1,data:Yl.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),bt.withSquare===!0&&St.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:Mt,children:[]});let Bt=new $e;return Bt.push({fi:1,id:Ho,data:{...xo.defaultData,name:"Scene 1"},children:St}),Bt}rt.defaultData={objects:_(),publish:qr.defaultData,styles:Yo.defaultData()},rt.emptyDataWithoutPage=function(){return{objects:new $e,publish:qr.defaultData,styles:Yo.defaultData()}},rt.emptyDataWithPage=function(bt){return{objects:_(bt),publish:qr.defaultData,styles:Yo.defaultData()}};function ut(bt){return{...rt.defaultData,objects:Wt(bt,$e.prototype)}}rt.withObjs=ut;function mt(bt,St){return ut([{id:bt,data:St,children:[],fi:0}])}rt.withObj=mt})(Xo||(Xo={}));var Bi;(rt=>rt.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(Bi||(Bi={}));var Ri;(rt=>rt.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(Ri||(Ri={}));var Kl;(rt=>{function _(Mt){return Mt.textValue!==void 0}rt.isTextValue=_;function ut(Mt){return typeof Mt=="number"}rt.isNumber=ut;function mt(Mt){return typeof Mt=="boolean"}rt.isBoolean=mt;function bt(Mt){return _(Mt)?"string":mt(Mt)?"boolean":"number"}rt.typeOfVariable=bt;function St(Mt){return rt.isTextValue(Mt)?Array.isArray(Mt.textValue)?Mt.textValue.map(Bt=>Bt.toString().padStart(Mt.padding??2,"0")).join(Mt.deliminator??":")+(Mt.suffix!==void 0?" "+Mt.suffix:""):Mt.textValue.toString():rt.isBoolean(Mt)?Mt?"True":"False":rt.isNumber(Mt)?parseFloat(Mt.toFixed(3)).toString():Mt.toString()}rt.getDisplayedValue=St})(Kl||(Kl={}));var Ku;(rt=>rt.all=["images","videos","colors","audios","fonts","materials","variables"])(Ku||(Ku={}));var gy;(rt=>rt.all=[...Ku.all,"components"])(gy||(gy={}));var xy;(rt=>{function _(){return{images:new he,videos:new he,colors:new he,audios:new he,fonts:new he,materials:new he,components:new he,variables:new he}}rt.defaultData=_})(xy||(xy={}));var Ko;(rt=>{function _(){return{images:new he,videos:new he,colors:new he,audios:new he,fonts:new he,materials:new he,components:new he,variables:new he}}rt.defaultData=_})(Ko||(Ko={}));var br;(rt=>{function _(){let Mt={};return Mt["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Wt(Mt,he.prototype)}rt.defaultColors=_;function ut(Mt){let Bt={};return Mt!=null&&Mt.withAITexture&&(Bt["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...Ri.emptyImage,name:"AI generated image"}),Wt(Bt,he.prototype)}rt.defaultImages=ut;function mt(){return{catelogs:new he,materials:new he,images:new he,videos:new he,colors:new he,audios:new he,fonts:new he,variables:new ye,lib:Ko.defaultData()}}rt.emptyData=mt;function bt(Mt){switch(Mt){case"number":return{value:0,name:"Number"};case"boolean":return{value:!1,name:"Boolean"};case"string":return{value:{textValue:"String value"},name:"String"};case"time":let Bt=[0,0,0];return{name:"Time",value:{textValue:Bt,deliminator:":",padding:2,suffix:"AM"},dynamicVariableType:"time",format:"HH:mm:ss",format12h24h:"12ampm",timeZone:null,hasEnd:!1,endValue:{textValue:Bt,deliminator:":",padding:2,suffix:"AM"},autoStart:!0,repeat:!1};case"counter":return{name:"Counter",value:0,dynamicVariableType:"counter",updateInterval:1e3,increment:1,autoStart:!0,hasEnd:!0,endValue:60,repeat:!0,randomStart:!1,range:[0,100],decimals:0};case"random":return{name:"Random",value:0,dynamicVariableType:"random",updateInterval:1e3,increment:1,autoStart:!0,isStatic:!1,hasEnd:!0,endValue:60,repeat:!0,min:0,max:100,decimals:0};default:console.error("Unknown variable type",Mt)}}rt.defaultVariables=bt;function St(Mt,Bt){if(Bt.format==="HH:mm:ss"){let Ut=Math.floor(Mt/3600),Ht=Math.floor((Mt-Ut*3600)/60),tr=Math.round(Mt-Ut*3600-Ht*60);return{textValue:[Ut,Ht,tr]}}else if(Bt.format==="mm:ss"){let Ut=Math.floor(Mt/60),Ht=Math.round(Mt-Ut*60);return{textValue:[Ut,Ht]}}else return Bt.format==="number"?Mt=Math.round(Mt):Mt=Math.round(Mt*1e3)/1e3,Mt}rt.getFormattedTimerTime=St})(br||(br={}));var Ql;(rt=>rt.list=["idle","move","jump","run"])(Ql||(Ql={}));var Zl;(rt=>(rt.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},rt.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"],["run","⇧"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:rt.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new ye,move:new ye,jump:new ye,run:new ye},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:Gt.fromHexAndA(3728051,1)}}))(Zl||(Zl={}));function vy(rt){rt.layers.forEach(_=>{if(_.type==="depth"&&_.colorA!==void 0){let ut=_.colorA,mt=_.colorB,bt=[[ut.r,ut.g,ut.b,ut.a],[mt.r,mt.g,mt.b,mt.a]],St=[0,1];for(let Bt=2;Bt<10;Bt++)bt.push(bt[1]),St.push(1);let Mt={...xr(Ye(_),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,_.near),far:Math.max(0,_.far),colors:bt,steps:St,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(_,Mt)}else if(_.type==="depth"&&_.gradientType===1&&(_.near<0||_.far<0)){let ut={...Ye(_),near:Math.max(_.near,0),far:Math.max(_.far,0)};Object.assign(_,ut)}})}function vo(rt,_){Object.values(rt.shared.materials).forEach(ut=>_(ut))}function bo(rt,_){rt.scene.objects.traverse((ut,mt)=>{"materials"in mt?mt.materials.forEach((bt,St)=>{bt===void 0&&(mt.materials[St]=Pt.defaultData(),bt=mt.materials[St]),typeof bt!="string"&&_(bt)}):"material"in mt?typeof mt.material!="string"&&(mt.material===void 0&&(mt.material=Pt.defaultData()),_(mt.material)):mt.type==="Mesh"&&(mt.material===void 0&&(mt.material=Pt.defaultData()),_(mt.material)),"overrides"in mt&&Object.values(mt.overrides).forEach(bt=>{bt.material&&typeof bt.material!="string"&&_(bt.material)})})}function PT(rt){Object.assign(rt.scene.publish,{orbitControls:{...Di.defaultData,...Ye(rt.scene.publish.orbitControls)}})}function OT(rt){Object.assign(rt.scene.publish.settings,{video:{...qr.defaultData.settings.video,...Ye(rt.scene.publish.settings.video)}})}function MT(rt){function _(ut){if(ut.layers){for(let mt of Object.values(ut.layers))if(mt){for(let[bt,St]of Object.entries(mt))if((py.includes(bt)||typeof St=="boolean")&&delete mt[bt],bt==="texture")for(let[Mt,Bt]of Object.entries(St))(fy.includes(Mt)||typeof Bt=="boolean")&&delete St[Mt]}}}rt.scene.objects.traverse((ut,mt)=>{mt.states.forEach(bt=>{let St=bt;St.material?_(St.material):St.materials&&St.materials.forEach(Mt=>{_(Mt)})})})}function IT(rt){rt.scene.publish.withBackground=!0}function NT(rt){rt.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function ET(rt){rt.scene.objects.traverse((_,ut)=>{let mt=ut.cloner;mt&&(mt.radial.scale=mt.radial.scale.map(bt=>bt+1),mt.linear.scale=mt.linear.scale.map(bt=>bt+1))})}function DT(rt){rt.scene.objects.traverse((_,ut)=>{let mt=ut.geometry;mt&&(mt.type==="DodecahedronGeometry"||mt.type==="IcosahedronGeometry")&&(mt.detail=Math.round(mt.detail))})}function LT(rt){rt.scene.objects.traverse((_,ut)=>{let mt=rt.scene.objects.unproxy().parent(_);if(mt){let bt=Ye(rt.scene.objects.data(mt));bt&&bt.type==="Mesh"&&bt.geometry.type==="BooleanGeometry"&&ut.type==="Mesh"&&(ut.visible=Ye(ut).booleanExclude!==!0)}})}function BT(rt){rt.scene.objects.traverse((_,ut)=>{if(ut.type==="Mesh"){let mt=ut;ut.geometry.type==="NonParametricGeometry"?mt.material!==void 0&&delete mt.material:mt.materials!==void 0&&delete mt.materials}})}function RT(rt){function _(mt){Object.setPrototypeOf(mt,ke.prototype),mt.texture&&Object.setPrototypeOf(mt.texture,ke.prototype)}function ut(mt){Object.setPrototypeOf(mt,ke.prototype);for(let bt in mt)_(mt[bt])}rt.scene.objects.traverse((mt,bt)=>{bt.states.forEach(St=>{let Mt=St;if(Mt.material){let Bt=Ye(Mt.material).layers;ut(Bt),Mt.material.layers=Bt}if(Mt.materials)for(let Bt=0;Bt<Mt.materials.length;Bt++){let Ut=Mt.materials[Bt],Ht=Ye(Ut).layers;ut(Ht),Ut.layers=Ht}})})}function by(rt){rt.layers===void 0&&Object.assign(rt,Pt.defaultTwoLayerData("lambert"))}function Qu(rt){!rt.layers||rt.layers.forEach(_=>{if(_.type==="depth"&&_.colors.length===10){let ut=[..._.colors];ut.push(_.colors[9]);let mt=[..._.steps];mt.push(_.steps[9]);let bt={...Ye(_),colors:ut,steps:mt};Object.assign(_,bt)}})}function VT(rt){rt.scene.objects.traverse((_,ut)=>{ut.type==="Mesh"&&(ut.geometry.type==="BooleanGeometry"||ut.geometry.type==="SubdivGeometry")&&(ut.geometry.phongAngle=35)})}function Sy(rt){rt.scene.objects.traverse((_,ut)=>{"materials"in ut?ut.materials.forEach(mt=>{typeof mt!="string"&&Qu(mt)}):"material"in ut&&typeof ut.material!="string"&&Qu(ut.material)}),Object.values(rt.shared.materials).forEach(_=>Qu(_))}function GT(rt){rt.scene.environment.ambientLight.softShadows=!1,rt.scene.environment.ambientLight.softShadowQuality="low",rt.scene.objects.traverse((_,ut)=>{(ut.type==="DirectionalLight"||ut.type==="SpotLight")&&(ut.shadowResolution=1024,ut.shadowRadius=1,ut.depth=1e5)}),rt.shared.penumbraSize=new Array(5).fill(.5)}function zT(rt){rt.shared.audios=Wt({},he.prototype)}function kT(rt){rt.shared.videos=Wt({},he.prototype)}function FT(rt){let _=rt.shared.materials;Object.entries(_).forEach(([ut,mt])=>{if(!mt.layers){let bt={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(_,{[ut]:bt})}})}function jT(rt){Object.entries(Ye(rt.shared.images)).filter(_=>_[1].asset===!1).map(_=>_[0]).forEach(_=>{delete rt.shared.images[_]}),Object.entries(Ye(rt.shared.audios)).filter(_=>_[1].asset===!1).map(_=>_[0]).forEach(_=>{delete rt.shared.audios[_]})}function UT(rt){rt.scene.publish.settings.web.preload=!1}function wy(rt){rt.layers&&rt.layers.forEach(_=>{_.type==="depth"&&_.num!==void 0&&(_.colors=_.colors.slice(0,_.num),_.steps=_.steps.slice(0,_.num),delete _.num)})}function _y(rt){rt.layers&&rt.layers.forEach(_=>{dy(_)&&_.isMask===void 0&&(_.isMask=!1),(_.type==="texture"||_.type==="video")&&_.blending===void 0&&(_.blending=0),(_.type==="noise"||_.type==="displace"&&_.displacementType==="noise")&&(_.voronoiStyle===void 0&&(_.voronoiStyle=0),_.highCut===void 0&&(_.highCut=1),_.lowCut===void 0&&(_.lowCut=0),_.smoothness===void 0&&(_.smoothness=.3),_.seed===void 0&&(_.seed=0),_.quality===void 0&&(_.quality=1))})}function HT(rt){rt.shared.fonts=Wt({},he.prototype)}function qT(rt){return rt.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(_=>_.charAt(0).toUpperCase()+_.slice(1)).join(" ")}function WT$1(rt){let _=[];rt.scene.objects.traverse((ut,mt)=>{let bt=mt;if(bt.type==="TextFrame"){let St=Pt.defaultTwoLayerData("phong"),Mt=typeof bt.color=="string"?rt.shared.colors[bt.color]:bt.color;St.layers[1].data.color={r:Mt.r,g:Mt.g,b:Mt.b},St.layers[1].data.alpha=bt.alpha;let Bt=qT(bt.font);rt.shared.fonts[Bt]===void 0&&(rt.shared.fonts[Bt]={name:Bt});let Ut={name:bt.name,...Ot.defaultData,...An.defaultData,flatShading:!1,wireframe:!1,geometry:{...$o.defaultData("TextGeometry"),width:bt.width,height:bt.height,font:Bt,depth:0,horizontalAlign:bt.horizontalAlign,verticalAlign:bt.verticalAlign,fontSize:bt.fontSize*1.40625,lineHeight:bt.lineHeight/1.40625,letterSpacing:bt.letterSpacing-1,text:bt.text,textTransform:bt.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:St,states:Ye(bt.states),events:Ye(bt.events),visible:bt.visible,raycastLock:bt.raycastLock,position:bt.position,rotation:bt.rotation,scale:bt.scale,hiddenMatrix:bt.hiddenMatrix},Ht=Ye(rt.scene.objects).parent(ut);rt.scene.objects.insertAfter(Ht??null,ut,[{id:ut+"new",data:Ut,children:[]}]),_.push(ut)}}),_.forEach(ut=>{rt.scene.objects.delete(ut)})}function $T(rt){let _={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};rt.scene.objects.traverse((ut,mt)=>{mt.events.forEach(bt=>{if(_[Number(bt.type)])if(Object.assign(bt,{type:_[Number(bt.type)]}),bt.type==="Audio"&&"audioEvent"in bt&&(Object.assign(bt,{playAudio:bt.audioEvent}),delete bt.audioEvent),bt.type==="GameControl")Object.assign(bt,{gameActions:{idle:new ye,move:new ye,jump:new ye}});else{let St=new ye;Object.assign(bt,{actions:St}),(bt.type==="MouseDown"||bt.type==="MouseUp"||bt.type==="KeyDown"||bt.type==="KeyUp")&&"url"in bt&&St.push({fi:0,id:MathUtils.generateUUID(),data:{type:"Link",url:bt.url,delay:0}}),"targets"in bt&&(bt.targets.forEach((Mt,Bt,Ut)=>{let Ht={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},tr={easing:Mt.easing,duration:Mt.duration};Mt.easing===6?Object.assign(tr,xr(Mt,"mass","stiffness","damping","velocity")):Mt.easing===5&&Object.assign(tr,{control1:{...Mt.control1},control2:{...Mt.control2}});let rr={repeat:Mt.repeat?-1:0,delay:Mt.delay,delayDirection:Mt.delayDirection,direction:Mt.cycle&&Mt.rewind?"pingpong-rewind":Mt.cycle?"pingpong":"normal"},sr={state:Mt.state,...rr,...tr},ar={allowSlerp:!0,type:"Transition",object:Mt.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new ye({fi:0,id:MathUtils.generateUUID(),data:Ht},{fi:1,id:MathUtils.generateUUID(),data:sr})};St.push({fi:Ut,id:Bt,data:ar})}),delete bt.targets)}})})}function YT(rt){rt.scene.objects.traverse((_,ut)=>{function mt(bt,St){var Ut;let Mt=new ye,Bt=[];if(ut.events.forEach((Ht,tr,rr)=>{if(Ht.type==="Audio"&&Ht.trigger===St){let sr;Bt.push(tr),Ht.interaction==="play"?sr={...xr(Ht,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in Ht?Ht.after:void 0,toggle:"after"in Ht?Ht.toggle:void 0,type:"Audio"}:(Ht.interaction==="pause"||Ht.interaction==="stop")&&(sr={...xr(Ht,"interaction","delay","object","playAudio"),type:"Audio"}),sr&&Mt.push({fi:rr,id:tr,data:sr})}}),Bt.forEach(Ht=>ut.events.delete(Ht)),Mt.length){let Ht=(Ut=ut.events.find(tr=>tr.type===bt))==null?void 0:Ut.data;Ht?"actions"in Ht&&Ht.actions.insertBefore(null,Mt):ut.events.insertBefore(null,[{id:MathUtils.generateUUID(),data:{type:bt,actions:Mt}}])}}mt("Start","start"),mt("MouseDown","mouseDown"),mt("MouseUp","mouseUp"),mt("KeyDown","keyDown"),mt("KeyUp","keyUp")})}function Ay(rt){var ut;let _=(ut=rt.layers.find(mt=>mt.type==="light"))==null?void 0:ut.data;if((_==null?void 0:_.category)==="basic"){let mt=zt.defaultData("light","phong"),bt=_;Object.assign(bt,mt),bt.visible=!1}}function Ty(rt){vo(rt,Ay),bo(rt,Ay)}function XT(rt){rt.scene.objects.traverse((_,ut)=>{ut.type==="Mesh"&&ut.geometry.type==="SubdivGeometry"&&(ut.geometry.scaleBaked||(ut.geometry.scaleBaked=[1,1,1]))})}function KT(rt){rt.scene.objects.traverse((_,ut)=>{(ut.type==="Empty"||ut.type==="Mesh")&&ut.cloner&&!ut.cloner.randomnessObject&&!ut.cloner.toObject&&!ut.cloner.randomness&&(ut.cloner={...ut.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function QT(rt){rt.scene.objects.traverse((_,ut)=>{ut.type==="Mesh"&&ut.geometry.type==="NonParametricGeometry"&&!("material"in ut)&&!("materials"in ut)&&(ut.material=Pt.defaultTwoLayerData("phong"))})}function ZT(rt){rt.scene.publish.orbitControls.autoZoom===void 0&&(rt.scene.publish.orbitControls.autoZoom=!1),rt.scene.objects.traverse((_,ut)=>{(ut.type==="OrthographicCamera"||ut.type==="PerspectiveCamera")&&(ut.orthographic.autoZoom===void 0&&(ut.orthographic.autoZoom=!1),ut.orthographic.autoZoomFrustumSize===void 0&&(ut.orthographic.autoZoomFrustumSize=790))})}function JT(rt){rt.scene.objects.traverse((_,ut)=>{ut.pathSnapping===void 0&&(ut.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),ut.pathSnapping.offset===void 0&&(ut.pathSnapping.offset=0)})}function eC(rt){rt.scene.publish.mouseEventTarget===void 0&&(rt.scene.publish.mouseEventTarget="canvas"),rt.scene.publish.settings.web.hint===void 0&&(rt.scene.publish.settings.web.hint=!1)}function tC(rt){let{video:_}=rt.scene.publish.settings;_.format==="gif"&&_.fps>48&&(_.fps=15)}function rC(rt){rt.scene.objects.traverse((_,ut)=>{ut.events.forEach(mt=>{mt.type==="GameControl"&&(mt.resetYPosition=Math.abs(mt.resetYPosition-ut.position[1]))})})}function oC(rt){let _=rt.scene.environment.usePhysics;rt.scene.objects.traverse((ut,mt)=>{_&&mt.physics===null?mt.collision=!1:mt.collision="visibility"})}function nC(rt){rt.scene.objects.traverse((_,ut)=>{ut.events.forEach(mt=>{mt.type==="GameControl"&&(mt.navmesh=Zl.defaultDataThirdPerson.navmesh)})})}function iC(rt){rt.scene.styles||(rt.scene.styles=Yo.defaultData())}function Cy(rt){rt.layers.forEach(_=>{_.type==="light"&&_.category!=="toon"&&_.occlusion===void 0&&(_.occlusion=!0)})}function aC(rt){rt.scene.environment.ambientLight.occlusion===void 0&&(rt.scene.environment.ambientLight.occlusion=!1),rt.scene.environment.ambientLight.aoFullRes===void 0&&(rt.scene.environment.ambientLight.aoFullRes=!1),rt.scene.environment.ambientLight.radius===void 0&&(rt.scene.environment.ambientLight.radius=256),rt.scene.environment.ambientLight.bias===void 0&&(rt.scene.environment.ambientLight.bias=.5),rt.scene.environment.ambientLight.aoColor===void 0&&(rt.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),bo(rt,Cy),vo(rt,Cy)}function sC(rt){rt.scene.objects.traverse((_,ut)=>{ut.events.forEach(mt=>{mt.type==="GameControl"&&Object.assign(mt.gameActions,{run:new ye})})})}function lC(rt){rt.scene.objects.traverse((_,ut)=>{ut.events.forEach(mt=>{mt.type==="GameControl"&&(mt.keyAssignments=[...mt.keyAssignments,["run","⇧"],["none","Ctrl"]])})})}function Py(rt){rt.layers&&rt.layers.forEach(_=>{_.type==="light"&&_.bumpMapIntensity===void 0&&(_.bumpMapIntensity=5)})}function Oy(rt,_){if(_<1&&(bo(rt,vy),vo(rt,vy),rt.schema=1),_<2&&(PT(rt),rt.schema=2),_<3&&(MT(rt),rt.schema=3),_<4&&(IT(rt),rt.schema=4),_<5&&(NT(rt),rt.schema=5),_<6&&(ET(rt),rt.schema=6),_<7&&(DT(rt),rt.schema=7),_<8&&(rt.schema=8),_<9&&(Sy(rt),rt.schema=9),_<10&&(VT(rt),rt.schema=10),_<11&&(GT(rt),rt.schema=11),_<12&&(Sy(rt),rt.schema=12),_<13&&(zT(rt),rt.schema=13),_<14&&(FT(rt),rt.schema=14),_<15&&(jT(rt),rt.schema=15),_<16&&(UT(rt),rt.schema=16),_<17&&(bo(rt,wy),vo(rt,wy),rt.schema=17),_<18&&(bo(rt,by),vo(rt,by),rt.schema=18),_<19&&(OT(rt),rt.schema=19),_<20&&(HT(rt),WT$1(rt),rt.schema=20),_<21&&($T(rt),YT(rt),rt.schema=21),_<22&&(Ty(rt),rt.schema=22),_<23&&(XT(rt),rt.schema=23),_<24&&(KT(rt),rt.schema=24),(_<25||rt.shared.videos===void 0)&&(kT(rt),_<25&&(rt.schema=25)),_<26&&(LT(rt),rt.schema=26),_<27&&(BT(rt),rt.schema=27),_<28&&(Ty(rt),rt.schema=28),_<29&&(RT(rt),rt.schema=29),_<30&&(QT(rt),rt.schema=30),_<31&&(ZT(rt),rt.schema=31),_<33&&(JT(rt),rt.schema=33),_<34&&(eC(rt),rt.schema=34),_<35&&(tC(rt),rt.schema=35),_<36&&(rC(rt),rt.schema=36),_<37&&(oC(rt),rt.schema=37),_<38&&(bo(rt,_y),vo(rt,_y),rt.schema=38),_<39&&(nC(rt),rt.schema=39),_<40&&(iC(rt),rt.schema=40),_<41&&(aC(rt),rt.schema=41),_<42&&(sC(rt),rt.schema=42),_<43&&(lC(rt),rt.schema=43),_<99){bo(rt,Py),vo(rt,Py),rt.scene.publish.playCamera===null&&(rt.scene.publish.playCamera=Uo);let ut=Ye(rt.scene.objects),mt=rt.scene.objects;rt.scene.publish.playPage=Ho,mt.insertBefore(null,null,[{id:Ho,data:{...xo.defaultData,backgroundColor:rt.scene.backgroundColor,fog:rt.scene.fog,postprocessing:rt.scene.postprocessing,ao:xr(rt.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:rt.scene.publish.playCamera,gameControlObject:rt.scene.publish.gameControlObject},shadow:xr(rt.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...os.defaultData,...xr(rt.scene.environment,"usePhysics","gravity")},camera:Ye(rt.scene.ownerCamera)??xo.defaultData.camera,name:"Scene"},children:[]}]);for(let Mt of ut)Mt.id!==Xo.TRASH_CAN_ID&&mt.move(Ho,Mt.fi,Mt.id);let bt=0,St=0;rt.shared.penumbraSize&&rt.scene.objects.traverse((Mt,Bt)=>{Bt.type==="DirectionalLight"?(Bt.penumbraSize=rt.shared.penumbraSize[Math.min(bt,2)],bt+=1):Bt.type==="SpotLight"&&(Bt.penumbraSize=rt.shared.penumbraSize[3+Math.min(St,1)],St+=1),(Bt.physics===void 0||Bt.physics===null)&&Bt.type!=="Instance"&&(Bt.physics={},Object.assign(Bt.physics,Wo.defaultData)),Bt.physics!==void 0&&Bt.physics!==null&&(Bt.physics.enabled=Bt.collision??"visibility",delete Bt.collision)}),rt.schema=99}}function My(rt){rt.layers&&rt.layers.forEach(_=>{_.type==="light"&&_.alphaOverride===void 0&&(_.alphaOverride=1)})}function cC(rt){rt.scene.objects.traverse((_,ut)=>{let mt=ut.geometry;mt&&mt.type==="PathGeometry"&&(mt.extrusion.capType="flat",mt.extrusion.bevel=50,mt.extrusion.bevelSides=6,mt.extrusion.shape.type==="Custom"&&(mt.extrusion.shape.shapeQuality="low"))})}var Vi=180/Math.PI;function Iy(rt){rt.rotation=rt.rotation.slice(0,3).map(_=>_*Vi)}function Ny(rt){var ut,mt;Iy(rt),rt.type==="Page"&&Iy(rt.camera),(ut=rt.states)==null||ut.forEach(bt=>{bt.rotation===void 0||bt.rotation===null||(bt.rotation=bt.rotation.slice(0,3).map(St=>St*Vi))});let _=rt.geometry;_&&_.type==="SphereGeometry"&&(_.thetaLength=(_.thetaLength??180)*Vi),_&&_.type==="TorusGeometry"&&(_.arc=_.arc*Vi),_&&_.type==="PathGeometry"&&(_.extrusion.angle*=Vi,_.extrusion.twist*=Vi),rt.type==="Mesh"&&rt.geometry.type==="TextGeometry"&&(rt.geometry.text={textValue:rt.geometry.text}),Array.isArray(Ye(rt.events))&&((mt=rt.events)==null||mt.forEach(bt=>{(bt.type==="MouseDown"||bt.type==="MouseUp"||bt.type==="MousePress"||bt.type==="KeyDown"||bt.type==="KeyUp"||bt.type==="KeyPress"||bt.type==="Collision"||bt.type==="Trigger")&&(bt.runMode=bt.toggle?"Toggle":"Once")}))}function uC(rt){rt.shared.variables=Wt({},he.prototype)}function dC(rt){let _=Ye(rt.shared.variables);rt.shared.variables=Wt(Object.entries(_??{}).map(([ut,mt],bt)=>({fi:bt,id:ut,data:mt})),ye.prototype)}var So=107;function Ey(rt,_){_(rt.data);for(let ut of rt.children)Ey(ut,_)}function pC(rt){let _=rt.schema??104;_!==So&&_<105&&(Ey(rt.asset,Ny),rt.schema=105)}function ec(rt){let _=rt.schema??0;if(_!==So){console.warn("updating from ",_,"to ",So),Oy(rt,_),_<100&&(rt.scene.publish.joystickSizeAndXYOffset===void 0&&(rt.scene.publish.joystickSizeAndXYOffset=qr.defaultData.joystickSizeAndXYOffset),rt.schema=100),_<101&&(bo(rt,My),vo(rt,My),rt.schema=101),_<102&&(cC(rt),rt.schema=102),_<104&&(rt.shared.catelogs=new he,rt.shared.lib=Ko.defaultData(),rt.schema=104),_<105&&(uC(rt),rt.scene.objects.traverse((ut,mt)=>{Ny(mt)}),rt.schema=105);for(let ut of Object.values(rt.shared.lib.components))pC(ut);_<106&&(dC(rt),rt.schema=106),_<107&&(rt.shared.lib.variables=Ko.defaultData().variables,rt.schema=107)}}var Li;(rt=>{rt.defaultData={schema:So,scene:Xo.defaultData,frames:new he().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Bi.defaultData),shared:{...br.emptyData(),colors:br.defaultColors()}},rt.emptyDataForImports=function(bt){let St=Xo.emptyDataWithPage(bt);return{schema:So,scene:St,frames:new he().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Bi.defaultData),shared:{...br.emptyData(),colors:br.defaultColors(),images:br.defaultImages(bt)}}},rt.emptyData=function(){return{schema:So,scene:Xo.emptyDataWithPage(),frames:new he().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Bi.defaultData),shared:br.emptyData()}},rt.collabHelper={...Qa,updateSchema(bt){return(bt.schema??0)<So?Vo(bt,ec):(bt.schema??0)-So}};function _(bt){let St=rt.collabHelper.updateSchema(bt);return typeof St=="number"?St===0?bt:null:St.data}rt.updateSchemaDirectly=_;function ut(bt){return{...bt,shared:{...bt.shared,lib:Ko.defaultData()}}}rt.withoutLib=ut;function mt(bt,St){let Mt=bt.scene.objects.get(St);if(Mt&&Mt.data.type==="Component")return Mt;{let Bt=bt.shared.lib.components[St];if(Bt)return Bt.asset}}rt.getComponentData=mt})(Li||(Li={}));var Ea=Rt(Ly()),fC=.5*(Math.sqrt(3)-1),ns=(3-Math.sqrt(3))/6,hC=1/3,Wr=1/6,is=rt=>Math.floor(rt)|0,By=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),Ju=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function tc(rt=Math.random){let _=Vy(rt),ut=new Float64Array(_).map(bt=>By[bt%12*2]),mt=new Float64Array(_).map(bt=>By[bt%12*2+1]);return function(bt,St){let Mt=0,Bt=0,Ut=0,Ht=(bt+St)*fC,tr=is(bt+Ht),rr=is(St+Ht),sr=(tr+rr)*ns,ar=tr-sr,cr=rr-sr,Ar=bt-ar,_r=St-cr,Dr,$r;Ar>_r?(Dr=1,$r=0):(Dr=0,$r=1);let Br=Ar-Dr+ns,Jr=_r-$r+ns,mn=Ar-1+2*ns,Mn=_r-1+2*ns,$n=tr&255,en=rr&255,In=.5-Ar*Ar-_r*_r;if(In>=0){let Qn=$n+_[en],xs=ut[Qn],cs=mt[Qn];In*=In,Mt=In*In*(xs*Ar+cs*_r)}let Rn=.5-Br*Br-Jr*Jr;if(Rn>=0){let Qn=$n+Dr+_[en+$r],xs=ut[Qn],cs=mt[Qn];Rn*=Rn,Bt=Rn*Rn*(xs*Br+cs*Jr)}let qn=.5-mn*mn-Mn*Mn;if(qn>=0){let Qn=$n+1+_[en+1],xs=ut[Qn],cs=mt[Qn];qn*=qn,Ut=qn*qn*(xs*mn+cs*Mn)}return 70*(Mt+Bt+Ut)}}function Ry(rt=Math.random){let _=Vy(rt),ut=new Float64Array(_).map(St=>Ju[St%12*3]),mt=new Float64Array(_).map(St=>Ju[St%12*3+1]),bt=new Float64Array(_).map(St=>Ju[St%12*3+2]);return function(St,Mt,Bt){let Ut,Ht,tr,rr,sr=(St+Mt+Bt)*hC,ar=is(St+sr),cr=is(Mt+sr),Ar=is(Bt+sr),_r=(ar+cr+Ar)*Wr,Dr=ar-_r,$r=cr-_r,Br=Ar-_r,Jr=St-Dr,mn=Mt-$r,Mn=Bt-Br,$n,en,In,Rn,qn,Qn;Jr>=mn?mn>=Mn?($n=1,en=0,In=0,Rn=1,qn=1,Qn=0):Jr>=Mn?($n=1,en=0,In=0,Rn=1,qn=0,Qn=1):($n=0,en=0,In=1,Rn=1,qn=0,Qn=1):mn<Mn?($n=0,en=0,In=1,Rn=0,qn=1,Qn=1):Jr<Mn?($n=0,en=1,In=0,Rn=0,qn=1,Qn=1):($n=0,en=1,In=0,Rn=1,qn=1,Qn=0);let xs=Jr-$n+Wr,cs=mn-en+Wr,ks=Mn-In+Wr,_o=Jr-Rn+2*Wr,qs=mn-qn+2*Wr,Ss=Mn-Qn+2*Wr,eo=Jr-1+3*Wr,Ao=mn-1+3*Wr,Oo=Mn-1+3*Wr,uo=ar&255,uu=cr&255,cu=Ar&255,Jl=.6-Jr*Jr-mn*mn-Mn*Mn;if(Jl<0)Ut=0;else{let Mp=uo+_[uu+_[cu]];Jl*=Jl,Ut=Jl*Jl*(ut[Mp]*Jr+mt[Mp]*mn+bt[Mp]*Mn)}let mu=.6-xs*xs-cs*cs-ks*ks;if(mu<0)Ht=0;else{let Mp=uo+$n+_[uu+en+_[cu+In]];mu*=mu,Ht=mu*mu*(ut[Mp]*xs+mt[Mp]*cs+bt[Mp]*ks)}let pu=.6-_o*_o-qs*qs-Ss*Ss;if(pu<0)tr=0;else{let Mp=uo+Rn+_[uu+qn+_[cu+Qn]];pu*=pu,tr=pu*pu*(ut[Mp]*_o+mt[Mp]*qs+bt[Mp]*Ss)}let Zu=.6-eo*eo-Ao*Ao-Oo*Oo;if(Zu<0)rr=0;else{let Mp=uo+1+_[uu+1+_[cu+1]];Zu*=Zu,rr=Zu*Zu*(ut[Mp]*eo+mt[Mp]*Ao+bt[Mp]*Oo)}return 32*(Ut+Ht+tr+rr)}}function Vy(rt){let _=new Uint8Array(512);for(let ut=0;ut<512/2;ut++)_[ut]=ut;for(let ut=0;ut<512/2-1;ut++){let mt=ut+~~(rt()*(256-ut)),bt=_[ut];_[ut]=_[mt],_[mt]=bt}for(let ut=256;ut<512;ut++)_[ut]=_[ut-256];return _}var Sr=new Triangle,rc=class{constructor(rt){this.weightAttribute=null;let _=rt.geometry;if(!_.isBufferGeometry||_.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");_.index&&(_=_.toNonIndexed()),this.geometry=_,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let rt=this.positionAttribute,_=new Float32Array(rt.count/3);for(let mt=0;mt<rt.count;mt+=3){let bt=1;Sr.a.fromBufferAttribute(rt,mt),Sr.b.fromBufferAttribute(rt,mt+1),Sr.c.fromBufferAttribute(rt,mt+2),bt*=Sr.getArea(),_[mt/3]=bt}this.distribution=new Float32Array(rt.count/3);let ut=0;for(let mt=0;mt<_.length;mt++)ut+=_[mt],this.distribution[mt]=ut;return this}setRandomGenerator(rt){return this.randomFunction=rt,this}sample(rt,_){if(this.distribution){let ut=this.distribution[this.distribution.length-1],mt=this.binarySearch(this.randomFunction()*ut);return this.sampleFace(mt,rt,_)}}binarySearch(rt){if(!this.distribution)return 0;let _=this.distribution,ut=0,mt=_.length-1,bt=-1;for(;ut<=mt;){let St=Math.ceil((ut+mt)/2);if(St===0||_[St-1]<=rt&&_[St]>rt){bt=St;break}else rt<_[St]?mt=St-1:ut=St+1}return bt}sampleFace(rt,_,ut){let mt=this.randomFunction(),bt=this.randomFunction();return mt+bt>1&&(mt=1-mt,bt=1-bt),Sr.a.fromBufferAttribute(this.positionAttribute,rt*3),Sr.b.fromBufferAttribute(this.positionAttribute,rt*3+1),Sr.c.fromBufferAttribute(this.positionAttribute,rt*3+2),_.set(0,0,0).addScaledVector(Sr.a,mt).addScaledVector(Sr.b,bt).addScaledVector(Sr.c,1-(mt+bt)),Sr.getNormal(ut),this}},ky=Rt(zy()),gC=new Matrix4,xC=new Matrix4,vC=new Matrix4,Gi;(rt=>{function _(ut){return ut&&ut.__isSPEObject}rt.is=_})(Gi||(Gi={}));var zi=rt=>class extends rt{constructor(){super(...arguments),this.previousModelViewMatrix=new Matrix4,this.copyPreviousMatrix=!0,this.hiddenMatrix=new Matrix4,this.matrixWorldRigid=new Matrix4,this.shearScale=new Matrix4,this.shearScaleInv=new Matrix4}get __isSPEObject(){return!0}isDescendantOf(_){_ instanceof Object3D&&(_=_.uuid);let ut=this;for(;ut.parent;){if(ut.parent.uuid===_)return!0;ut=ut.parent}return!1}updateMatrixWorld(_){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||_)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,_=!0);for(let ut of this.children)ut.updateMatrixWorld(_)}updateWorldMatrix(_,ut){let mt=this.parent;if(_&&mt!==null&&mt.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),ut)for(let bt of this.children)bt.updateWorldMatrix(!1,!0)}traverseChildren(_,ut=0){for(let mt of this.children)Gi.is(mt)&&mt.traverseObject(_,ut+1)}traverseObject(_,ut=0){if(_(this,ut)!==!0)for(let mt of this.children)Gi.is(mt)&&mt.traverseObject(_,ut+1)}updateMatrixWorldSVD(){let _=this.matrixWorld.elements,ut=[[_[0],_[4],_[8]],[_[1],_[5],_[9]],[_[2],_[6],_[10]]],{u:mt,v:bt,q:St}=(0,ky.SVD)(ut),Mt=gC.set(mt[0][0],mt[0][1],mt[0][2],0,mt[1][0],mt[1][1],mt[1][2],0,mt[2][0],mt[2][1],mt[2][2],0,0,0,0,1),Bt=xC.set(bt[0][0],bt[0][1],bt[0][2],0,bt[1][0],bt[1][1],bt[1][2],0,bt[2][0],bt[2][1],bt[2][2],0,0,0,0,1),Ut=vC.copy(Bt).transpose();this.shearScale.makeScale(St[0],St[1],St[2]).multiply(Ut).premultiply(Bt),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(Mt,Ut).copyPosition(this.matrixWorld),St.every(Ht=>Math.abs(St[0]-Ht)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(_,ut){this.updateWorldMatrix(!0,!1);let mt=new Matrix4().copy(this.matrixWorld).invert();return _.parent!==null&&(_.parent.updateWorldMatrix(!0,!1),mt.multiply(_.parent.matrixWorld)),"hiddenMatrix"in _&&_.hiddenMatrix instanceof Matrix4?_.hiddenMatrix.premultiply(mt):_.applyMatrix4(mt),_.updateWorldMatrix(!1,!1),this.add(_),ut!==void 0&&(this.children.pop(),this.children.splice(ut,0,_)),this}copy(_,ut=!1){return super.copy(_,ut),this.hasNonUniformScale=_.hasNonUniformScale,this}onAfterRender(_,ut,mt,bt,St,Mt){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},ed=class extends zi(Object3D){},SC=rt=>rt.type==="Mesh",wo=class extends ed{constructor(rt){super(),this.object=rt,this.matrixAutoUpdate=!1,this.hasNonUniformScale=rt.hasNonUniformScale}raycast(rt,_){}expand(){let rt=0,_=this.object.entityChildren(rt);for(;_;){let ut=this.children[rt];(ut==null?void 0:ut.object)!==_&&(ut&&this.remove(ut),ut=new wo(_),this.add(ut),this.children.splice(rt,0,this.children.pop()),ut.matrixWorldNeedsUpdate=!0,ut.matrixAutoUpdate=!1,ut.matrix=_.matrix,ut.hiddenMatrix=_.hiddenMatrix),ut.expand(),rt+=1,_=this.object.entityChildren(rt)}for(;this.children.length>rt;)this.remove(this.children[rt])}get visible(){var rt;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((rt=this.object.dataPatched.cloner)==null?void 0:rt.hideBase)===!0}set visible(rt){}get castShadow(){return this.object.castShadow}set castShadow(rt){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(rt){}get isMesh(){return SC(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(rt){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Pn=new Vector3,On=new Vector3,ki=new Matrix4,jy=[new Vector3(-1,1,1),new Vector3(-1,-1,1),new Vector3(1,-1,1),new Vector3(1,1,1),new Vector3(-1,1,-1),new Vector3(-1,-1,-1),new Vector3(1,-1,-1),new Vector3(1,1,-1)],AC=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],TC=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],Fy=(rt,_,ut)=>{rt.updateEntityBoxSize(Pn,On),ki.copy(_).multiply(rt.matrixWorld),On.x===0&&On.y===0&&On.z===0?ut.push(new Vector3(Pn.x,Pn.y,Pn.z).applyMatrix4(ki)):jy.forEach(mt=>{ut.push(mt.clone().multiply(On).add(Pn).applyMatrix4(ki))})},as=class extends Box3{constructor(){super(...arguments),this.matrix=new Matrix4,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(rt){return super.copy(rt),this.matrix.copy(rt.matrix),this.vertices=rt.vertices.map(_=>_.clone()),this.faces=rt.faces.map(_=>_.clone()),this.edges=rt.edges.map(_=>_.clone()),this.centerEdges=rt.centerEdges.map(_=>_.clone()),this}setFromObjectSize(rt,_=!1){rt.updateWorldMatrix(!1,_),this.makeEmpty(),this.matrix.copy(rt.matrixWorld);let ut=new Matrix4().copy(rt.matrixWorld).invert();return this.expandByObjectSize(rt,ut,_)}expandByObjectSize(rt,_,ut=!1){let mt=[];return ut===!0?rt.traverseEntity(bt=>{if(bt.visible||bt.cloner&&bt.data.visible){if(!("geometry"in bt)){mt.push(new Vector3);return}Fy(bt,_,mt)}}):Fy(rt,_,mt),this.setFromPoints(mt)}getCenter(rt){return rt=super.getCenter(rt),rt.applyMatrix4(this.matrix),rt}getPositionToCenter(rt){return rt=super.getCenter(rt),rt.applyMatrix4(ki.copy(this.matrix).setPosition(0,0,0)),rt}computeVertices(){this.getSize(On).multiplyScalar(.5),this.getCenter(Pn),ki.copy(this.matrix).setPosition(Pn),this.vertices=jy.map(rt=>rt.clone().multiply(On).applyMatrix4(ki))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=AC.map(([rt,_])=>new Line3(this.vertices[rt],this.vertices[_])),this.centerEdges=this.edges.map(rt=>rt.getCenter(new Vector3))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=TC.map(([rt,_])=>this.vertices[rt].clone().add(this.vertices[_]).multiplyScalar(.5))}},wr={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},nd=class extends CurvePath{constructor(){super()}getPoints(rt=12){let _=[],ut,mt=this.getCurveLengths(),bt=mt[mt.length-1]/mt.length;for(let St=0,Mt=this.curves;St<Mt.length;St++){let Bt=Mt[St],Ut=St===0?mt[St]:mt[St]-mt[St-1],Ht=Math.ceil(rt*Ut/bt),tr=Bt.getPoints(Ht);for(let rr=0;rr<tr.length;rr++){let sr=tr[rr];ut&&ut.equals(sr)||(_.push(sr),ut=sr)}}return this.autoClose&&_.length>1&&!_[_.length-1].equals(_[0])&&_.push(_[0]),_}},id$2=.001;function ad(rt,_,ut){return _.clone().sub(rt).cross(_.clone().sub(ut)).length()<=id$2}function od(rt,_){let ut=new Vector3(...rt.position),mt=new Vector3(...rt.controlNext.position),bt=new Vector3(..._.controlPrevious.position),St=new Vector3(..._.position);return ad(ut,mt,St)&&ad(ut,bt,St)}function nc(rt){let _=rt.points.map(tr=>new Vector3(...tr.data.position)),ut=[rt.points[0]],mt=new Vector3(...ut[0].data.position);for(let tr=0;tr<rt.points.length-1;tr++)ad(mt,_[tr],_[tr+1])||(ut.push(rt.points[tr]),mt=_[tr]);ut.push(rt.points[rt.points.length-1]);let bt=rt.isClosed,St=ut.length-(bt?0:1),Mt=ut.length,Bt=[];for(let tr=0;tr<Mt;tr++){let rr=ut[tr].data,sr=new Vector3(...rr.position),ar=new Vector3(...rr.controlPrevious.position),cr=new Vector3(...rr.controlNext.position),Ar={position:sr,baseRoundness:rr.roundness,controlPrevious:ar,controlNext:cr};if(rr.roundness===0||!rt.isClosed&&(tr===0||tr===Mt-1)){Bt[tr]={...Ar,removedLength:0};continue}let _r=bt&&tr==0?Mt-1:tr-1,Dr=bt&&tr==Mt-1?0:tr+1,$r=ut[_r].data,Br=ut[Dr].data,Jr=new Vector3(...$r.position),mn=new Vector3(...Br.position),Mn=Jr.clone().sub(sr).normalize(),$n=mn.clone().sub(sr).normalize();Object.assign(Ar,{prevDir:Mn,nextDir:$n});let en=od($r,rr),In=od(rr,Br);if(!en||!In)Bt[tr]={...Ar,removedLength:0};else{let Rn=Mn.clone().add($n).normalize(),qn=Rn.clone().cross(Mn).length()/Mn.dot(Rn);Bt[tr]={...Ar,tan:qn,removedLength:rr.roundness/qn}}}for(let tr=0;tr<St;tr++){let rr=tr,sr=bt&&tr===Mt-1?0:tr+1,ar=Bt[rr],cr=Bt[sr];if(ar.removedLength!==0||cr.removedLength!==0){let Ar=ar.position.distanceTo(cr.position);ar.removedLength=Math.min(ar.removedLength,Ar/2),cr.removedLength=Math.min(cr.removedLength,Ar/2)}}let Ut=[];for(let tr=0;tr<St;tr++){let rr=tr,sr=bt&&tr===Mt-1?0:tr+1,ar=Bt[rr],cr=Bt[sr],Ar=null;if(!od(ut[rr].data,ut[sr].data))ar.position.distanceTo(cr.position)>id$2&&(Ar=new CubicBezierCurve3(ar.position,ar.controlNext,cr.controlPrevious,cr.position));else{let _r=ar.position.clone(),Dr=cr.position.clone();(ar.removedLength!==0||cr.removedLength!==0)&&(ar.nextDir&&_r.add(ar.nextDir.clone().setLength(ar.removedLength)),cr.prevDir&&Dr.add(cr.prevDir.clone().setLength(cr.removedLength))),_r.distanceTo(Dr)>id$2&&(Ar=new CubicBezierCurve3(_r,_r.clone().lerp(Dr,.3),Dr.clone().lerp(_r,.3),Dr))}Ut[2*tr+1]=Ar}for(let tr=0;tr<Mt;tr++){let rr=Bt[tr];if(rr.removedLength===0){Ut[2*tr]=null;continue}let sr=rr.position,ar=rr.prevDir.clone().multiplyScalar(rr.removedLength).add(sr),cr=rr.nextDir.clone().multiplyScalar(rr.removedLength).add(sr),Ar=rr.tan*rr.removedLength,_r=rr.prevDir.clone().add(rr.nextDir).normalize(),Dr=ar.clone().lerp(cr,.5),$r=ar.distanceTo(cr)/2,Br=_r.clone().multiplyScalar(Math.sqrt(Math.pow(Ar,2)-Math.pow($r,2))).add(Dr),Jr=_r.clone().multiplyScalar(-Ar).add(Br),mn=sr.distanceTo(Jr)/sr.distanceTo(Dr),Mn=rr.prevDir.clone().multiplyScalar(mn*sr.distanceTo(ar)).add(sr),$n=Mn.clone().lerp(Jr,2),en=ar.clone().lerp(Mn,4/3),In=cr.clone().lerp($n,4/3);Ut[2*tr]=new CubicBezierCurve3(ar,en,In,cr)}let Ht=new nd;return Ut.forEach(tr=>{tr&&Ht.add(tr)}),Ht}var Ae;(rt=>{function _(ut){return ut&&ut.__isEntity}rt.is=_})(Ae||(Ae={}));var Fi=rt=>Ae.is(rt),OC={type:"completeState",isfromEntity:!0},MC=["x","y","z"],sd=new Vector3,IC=new Vector3().set(0,1,0),ji=rt=>class extends zi(rt){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.destroyedInAction=!1,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new as,this._recursiveBBox=new as,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(_){let ut=this.children[_];if(Ae.is(ut))return ut}entityChildrenCount(){let _=this.children.length;for(;_--;)if(Ae.is(this.children[_]))return _+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let _=this;for(;_.data.type!=="Instance";){let ut=_.parent;if(Ae.is(ut))_=ut;else return}return _}forInstancesRec(_){this.instances.forEach(ut=>{ut.disposed||_(ut),ut.forInstancesRec(_)})}super_Entity(_,ut){typeof _=="string"&&(this.uuid=_),this.identity=_,this.data=ut,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(_,ut,mt=!1){if(!(this.data.states.length===0&&!mt)){for(let bt of this.data.states)Cn.toOps(this.data,bt.data).forEach(St=>{let Mt=Sl.replaceProps(St,this.data);this.dataPatched=this.data,this.updateByPatchedOp(Mt,this.data,ut)});if(_!==null){let bt=this.data.states.data(_);bt&&(this.dataPatched=Cn.patch(this.data,bt),Cn.toOps(this.data,bt).forEach(St=>{this.updateByPatchedOp(St,this.dataPatched,ut)}))}mt&&this.updateTransformState(this.dataPatched,ut),this.stateSelection=_,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(_,ut){_.setScalar(0),ut.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(_=>{Fi(_)&&_.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(_=>{_.resetBBoxNeedsUpdateSelf()})}find(_){let ut;return this.traverseEntity(mt=>{mt.uuid===_&&(ut=mt)}),ut}traverseSortNextHelper(){let _=this.parent;if(_){let ut=_.children,mt=ut.indexOf(this)+1;if(Ae.is(ut[mt]))return ut[mt];if(Ae.is(_))return _.traverseSortNextHelper()}}sortNext(){let _=this.children;return this.children.length>0&&Ae.is(this.children[0])?_[0]:this.traverseSortNextHelper()}goUp(_){let ut=this;for(;_>0&&ut!==null;)ut=ut.parent,_-=1;return ut}hasAnccestorOrSelf(_){return this===_||this.hasAnccestor(_)}hasAnccestor(_){let ut=this.parent;for(;ut;){if(_===ut)return!0;ut=ut.parent}return!1}countToAccestor(_){let ut=0,mt=this;for(;mt!==_;){if(mt===null)return-1;mt=mt.parent,ut+=1}return ut}forEachEntity(_){for(let ut of this.children)Fi(ut)&&_(ut)}traverseEntityAncestors(_){this.traverseAncestors(ut=>{Ae.is(ut)&&_(ut)})}traverseConcreteEntity(_,ut=0){if(_(this,ut)!==!0)for(let mt of this.children)Fi(mt)&&mt.isConcreteEntity&&mt.traverseEntity(_,ut+1)}traverseEntity(_,ut=0){if(_(this,ut)!==!0)for(let mt of this.children)Fi(mt)&&mt.traverseEntity(_,ut+1)}traverseVisibleEntity(_){_(this);for(let ut of this.children)Fi(ut)&&ut.visible&&ut.traverseVisibleEntity(_)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}updateMatrixWorld(_){super.updateMatrixWorld(_),this.dispatchEvent({type:"updateMatrixWorld"})}copy(_,ut=!1){return super.copy(_,ut),this.dataPatched=_.dataPatched,this.raycastLock=_.raycastLock,this.scaleLock=_.scaleLock,this.hiddenMatrix.copy(_.hiddenMatrix),this}hasEntityChild(){return this.children.some(_=>Fi(_))}isAncestorOf(_){if(this.uuid===_)return!1;let ut=!1;return this.traverseEntity(mt=>{mt.uuid===_&&(ut=!0)}),ut}toObjectTransformState(_=[]){this.updateWorldMatrix(!0,!1);let ut={position:this.position.toArray(),rotation:[this.rotation.x*MathUtils.RAD2DEG,this.rotation.y*MathUtils.RAD2DEG,this.rotation.z*MathUtils.RAD2DEG],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return vi(ut,_)}getTransformValues(_,ut,mt){return ut[_].map((bt,St)=>(mt==null?void 0:mt.shared.getVariable(bt,[this.uuid,_,MC[St]]))??bt)}updateTransformState(_,ut){let mt=!1;return _.position&&(this.position.fromArray(this.getTransformValues("position",_,ut)),mt=!0),_.rotation&&(sd.fromArray(this.getTransformValues("rotation",_,ut)).multiplyScalar(MathUtils.DEG2RAD),this.rotation.setFromVector3(sd),mt=!0),_.scale&&(this.scale.fromArray(this.getTransformValues("scale",_,ut)),mt=!0),_.hiddenMatrix!==void 0&&(mt=!0,this.hiddenMatrix.fromArray(_.hiddenMatrix??jo.identity)),mt&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(bt=>{bt.invalidateClonerTransform(this)})),_.position&&_.rotation&&_.scale&&_.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),mt}onVariableUpdate(_=!1){if(_){this.resetBBoxNeedsUpdate();return}this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(ut=>{ut.invalidateClonerTransform(this)})}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let _ of this.children)Ae.is(_)&&_.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(_=>{Ae.is(_)&&_.disposeRecursively()})}toState(_=[]){let ut={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(_)};return vi(ut,_)}updateByObjUpdateOp(_,ut){_!==void 0&&this.updateByOp({type:0,props:_,path:[]},{...this.data,..._},ut,!1)}updateByOp(_,ut,mt,bt){let St=this.data;this.data=ut;let Mt=_,Bt=Lt(_.path,["states","*"]);if(Bt!==null){if(_.type===0){let[Ut]=Bt;if((this==null?void 0:this.stateSelection)===Ut){let Ht={..._.props};if(delete Ht.name,Object.values(_.props).some(tr=>tr===void 0)){let tr=this.data;if(tr!==void 0){let rr=ot.zoom(tr,_.path.slice(2));if(rr)for(let sr in _.props)_.props[sr]===void 0&&sr in rr&&(Ht[sr]=rr[sr])}}Mt={..._,props:Ht,path:_.path.slice(2)}}}}else if(_.type===0){let Ut=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(Ut!==void 0){if(_.props.name!==void 0&&Ut.name){let{name:tr,...rr}=Ut;Ut=rr}if(_.props.material!==void 0&&"material"in Ut){let{material:tr,...rr}=Ut;Ut=rr}let Ht=ot.removeOverridden(_.path,_.props,Ut);Mt={..._,props:Ht}}}if(this.updateByPatchedOpBase(Mt,Cn.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),mt),Lt(_.path,["overrides"])){let Ut=[],Ht=[..._.path];for(Ut.push(Ht[1]),Ht.splice(0,2);Ht.length>0&&Ht[0]==="descendants";)Ut.push(Ht[1]),Ht.splice(0,2);if(Ut[Ut.length-1]===void 0){if(_.type===0)for(let tr of Object.keys(_.props)){Ut[Ut.length-1]=tr;let rr=mt.scene.findInstance([this.uuid,...Ut]);rr&&(rr.overrideData=_.props[tr],rr.updateState(Gr.apply(rr.component.data,rr.overrideData),mt))}}else{let tr=mt.scene.findInstance([this.uuid,...Ut]);if(tr){let rr=ot.zoom(tr.component.data,Ht);if(_={..._,path:Ht},_.type===0){let sr=_.props;if(rr)for(let[ar,cr]of Object.entries(_.props))cr===void 0&&(sr===_.props&&(sr={..._.props}),sr[ar]=rr[ar]);_={..._,props:sr}}tr.overrideData=Ni.resolve(ut.overrides,Ut),tr.updateByOp(_,nt.applySimple(tr.data,_),mt,!1)}}}else if(this.instances.length>0){let Ut;if(_.path.length===0&&_.type===0){let Ht;for(let tr of Hr.rootOverrideProps)tr in _.props&&(Ht===void 0&&(Ht={}),Ht[tr]=_.props[tr]);Ht&&(Ut={..._,props:Ht})}else for(let Ht of Hr.rootOverrideProps)if(Lt(_.path,[Ht])){Ut=_;break}Ut!==void 0&&this.instances.forEach(Ht=>{if(Ht.isInstanceRoot){let tr=Gr.filterOp(Ht.overrideData,Ut);tr&&Ht.updateByOp(tr,nt.applySimple(Ht.data,tr),mt,!0)}}),this.instances.forEach(Ht=>{if(!Ht.isInstanceRoot){let tr=Gr.filterOp(Ht.overrideData,_);if(tr){let rr;St===Ht.data&&_===tr?rr=ut:rr=nt.applySimple(Ht.data,tr),Ht.updateByOp(tr,rr,mt,!0)}}})}}updateByPatchedOpBase(_,ut,mt){if(this.dataPatched=ut,_.path.length===0&&_.type===0)_.props.type!==void 0&&!vr.is(_.props.type)&&wr.changeEntityProptotype(this,ut,mt);else if(_.path.length===1&&_.path[0]==="geometry"&&_.type===0&&"type"in _.props){wr.changeEntityProptotype(this,ut,mt);for(let bt of this.children)Ae.is(bt)&&bt.updateVisible(mt.scene)}this.updateByPatchedOp(_,ut,mt)}updateByPatchedOp(_,ut,mt){if(_.path.length===0&&_.type===0&&this.updateState(_.props,mt),Lt(_.path,["pathSnapping"])!==null&&this.updatePathSnapping(ut.pathSnapping),Lt(_.path,["cloner"])!==null){let bt=nt.drop(_,1);bt.path.length===0&&bt.type===0&&bt.props.disabled===!0?this.setFromClonerState(null,mt):this.cloner?this.cloner.updateState(ut.cloner,mt.scene):(this.setFromClonerState(ut.cloner,mt),this.expandCloner(mt.scene)),this.updateVisible(mt.scene)}}updatePathSnapping(_=this.dataPatched.pathSnapping){this._updatedPathSnapping=_,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(_){var cr,Ar,_r,Dr,$r;let ut=((cr=this._updatedPathSnapping)==null?void 0:cr.pathId)??this.dataPatched.pathSnapping.pathId,mt=((Ar=this._updatedPathSnapping)==null?void 0:Ar.slide)??this.dataPatched.pathSnapping.slide??0,bt=((_r=this._updatedPathSnapping)==null?void 0:_r.offset)??this.dataPatched.pathSnapping.offset??0,St=((Dr=this._updatedPathSnapping)==null?void 0:Dr.orientation)??this.dataPatched.pathSnapping.orientation;if(ut===null)return;let Mt=_.find(ut);if(!Mt||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let Bt=Mt.data;if(Bt.geometry.path.points.length<=1)return;let Ut=nc(Bt.geometry.path),Ht=(mt+bt)%1;mt+bt===1&&Ht===0&&(Ht=1);let tr=Ut.getPointAt(Ht);if(tr===null)return;let rr=this.parent?($r=this.parent)==null?void 0:$r.matrixWorld:new Matrix4;Mt.updateMatrixWorld();let sr=new Matrix4().multiplyMatrices(rr.clone().invert(),Mt.matrixWorld);tr.applyMatrix4(sr);let ar={position:tr.toArray(),rotation:Bt.rotation};if(St==="tangential"){let Br=new Matrix4().extractRotation(Mt.matrixWorld),Jr=Ut.getTangentAt(Ht).applyMatrix4(Br).add(tr),mn=new Matrix4().lookAt(tr,Jr,IC),Mn=sd.setFromEuler(new Euler().setFromRotationMatrix(mn)).multiplyScalar(MathUtils.RAD2DEG);ar={...ar,rotation:Mn.toArray()}}this.updateTransformState(ar),this.traverseEntity(Br=>{Br._cameraType&&Br.dispatchEvent(OC)})}updateVisible(_){var mt;if(this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((mt=this.dataPatched.cloner)==null?void 0:mt.hideBase)!==!0),!_)return;let ut=!1;this.traverseEntity(bt=>{if(bt.data.type==="Splat")return ut=!0,!0}),ut&&_.reloadSplats()}updateState_Entity(_,ut){_.name!==void 0&&(this.name=_.name),_.raycastLock!==void 0&&(this.raycastLock=_.raycastLock),_.visible!==void 0&&(this.updateVisible(ut==null?void 0:ut.scene),this.resetBBoxNeedsUpdate()),ut&&"cloner"in _&&_.cloner!==void 0&&(this.setFromClonerState(_.cloner,ut),this.updateVisible(ut.scene)),this.updateTransformState(_,ut)}get attachedSurfaceCloners(){return this.children.filter(_=>_ instanceof wr.Cloner&&_.parameters.type==="toObject")}setFromClonerState(_,ut){this.disposed||(_===null||_.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new wr.Cloner(this,_),ut.scene.addPendingExpandCloner(this)):this.cloner.updateState(_,ut.scene))}expandCloner(_){!this.disposed&&this.cloner&&this.cloner.expandClones(_)}invalidateClonerTransform(_){this.cloner&&this.cloner.invalidateTransform(_)}},Wy=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},rt.parameters);ut.thetaLength=MathUtils.clamp(ut.thetaLength,0,360);let mt=ut.width/2,bt=ut.radiusTop??mt,St=ut.radiusBottom??mt;return bt===St?(bt=mt,St=mt):bt>St?(bt=mt,St=St*mt/bt):(bt=bt*mt/St,St=mt),{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??ut.width),radiusTop:bt,radiusBottom:St})}}static build(rt){let{width:_,depth:ut,height:mt,radialSegments:bt,heightSegments:St,openEnded:Mt,thetaStart:Bt,thetaLength:Ut,radiusTop:Ht,radiusBottom:tr,cornerRadius:rr,cornerSegments:sr,hollow:ar}=rt.parameters,cr;return Ut===0?(cr=new BufferGeometry,cr.setAttribute("position",new Float32BufferAttribute([],3))):rr||ar?cr=new ls(Ht,tr,mt,bt,St,Mt,Bt,Ut*Math.PI/180,rr,rr,sr,ar):cr=new CylinderGeometry(Ht,tr,mt,bt,St,Mt,Bt,Ut*Math.PI/180),cr.scale(1,1,ut/_),Object.assign(cr,{userData:{...rt,type:"CylinderGeometry"}})}};function Qo(rt,_,ut){ut.x=rt.x*_.x,ut.y=rt.y,ut.z=rt.x*_.y}function Hy(rt){return new Vector2(rt.y,-rt.x)}var ls=class extends BufferGeometry{constructor(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr=!1){super(),this.type="RoundedCylinderBufferGeometry",rt=rt!==void 0?rt:1,_=_!==void 0?_:1,ut=ut||1,mt=Math.floor(mt)||8,bt=Math.floor(bt)||1,St=St!==void 0?St:!1,Mt=Mt!==void 0?Mt:0,Bt=Bt!==void 0?Bt:Math.PI*2,St&&(Ut=0,Ht=0);let ar=[],cr=[],Ar=[],_r=[],Dr=0,$r=ut/2,Br=new Vector3,Jr=new Vector3;sr&&rt==0&&(rt=Ut),sr&&_==0&&(_=Ht);let mn=new Vector2(rt,$r),Mn=new Vector2(_,-$r),$n=null,en=null,In=null,Rn=null,qn=mn.clone().sub(Mn),Qn=0,xs=0,cs=0;rr>0&&(Qn=Math.min(rt,_)*(1-rr),xs=rt-Qn,cs=_-Qn);let ks=mn.clone();ks.x-=Qn;let _o=Math.PI-qn.angle(),qs=qn.angle(),Ss=Math.tan(qs/2),eo=Math.tan(_o/2),Ao=Ss+eo,Oo=rr?Ao:eo,uo=rr?Ao:Ss;if(Ut=Math.min(Ut,(rt-xs)/Oo,qn.length()/Ao),Ht=Math.min(Ht,(_-cs)/uo,qn.length()/Ao),Ut>0){let Zu=Ut/Ss;$n=mn.clone().sub(new Vector2(Zu,Ut)),rr&&(In=$n.clone(),In.x-=Qn-Ao*Ut),mn.sub(qn.clone().setLength(Zu))}if(Ht>0){let Zu=Ht/eo;en=Mn.clone().sub(new Vector2(Zu,-Ht)),Mn.add(qn.clone().setLength(Zu)),rr&&(Rn=en.clone(),Rn.x-=Qn-Ao*Ht,ks.sub(qn.clone().setLength(Zu)))}qn=mn.clone().sub(Mn);let uu=qn.length()<.5,cu=[];for(let Zu=0;Zu<=mt;Zu++){let Mp=[],Up=Zu/mt,Ep=Up*Bt+Mt,mp=new Vector2(Math.sin(Ep),Math.cos(Ep));Rn&&en?(Jl(Mp,Up,mp,_o,Ht,Rn,-1,!0),Jl(Mp,Up,mp,qs,Ht,en,-1,!1)):en?(mu(Mp,mp,en.x,0,-1),Jl(Mp,Up,mp,qs,Ht,en,-1,!1)):St||mu(Mp,mp,_,cs,-1);let Cp=Hy(qn).normalize();if(Qo(Cp,mp,Br),!uu)for(let t0=0;t0<=bt;t0++){let _g=t0/bt,m0=qn.clone().multiplyScalar(_g).add(Mn);Qo(m0,mp,Jr),cr.push(Jr.x,Jr.y,Jr.z),Ar.push(Br.x,Br.y,Br.z),_r.push(Up,.5+Jr.y/ut),Mp.push(Dr++)}if(In&&$n?(Jl(Mp,Up,mp,_o,Ut,$n,1,!1),Jl(Mp,Up,mp,qs,Ut,In,1,!0)):$n?(Jl(Mp,Up,mp,_o,Ut,$n,1,!1),mu(Mp,mp,$n.x,0,1)):St||mu(Mp,mp,rt,xs,1),rr&&!uu){let t0=Hy(qn).multiplyScalar(-1).normalize();Qo(t0,mp,Br);for(let _g=0;_g<=bt;_g++){let m0=_g/bt,K0=qn.clone().multiplyScalar(-m0).add(ks);Qo(K0,mp,Jr),cr.push(Jr.x,Jr.y,Jr.z),Ar.push(Br.x,Br.y,Br.z),_r.push(Up,.5+Jr.y/ut),Mp.push(Dr++)}}rr&&!St&&Mp.push(Mp[0]),cu.push(Mp)}for(let Zu=0;Zu<cu.length-1;Zu++)for(let Mp=0;Mp<cu[0].length-1;Mp++){if(St&&rr&&Mp==bt)continue;let Up=cu[Zu][Mp],Ep=cu[Zu+1][Mp],mp=cu[Zu+1][Mp+1],Cp=cu[Zu][Mp+1],t0=cr[mp*3+0],_g=cr[mp*3+2];ar.push(Up,Ep,Cp),(t0!=0||_g!=0)&&ar.push(Ep,mp,Cp)}Bt<Math.PI*2&&(pu(-1,cu[0],Mt),pu(1,cu[cu.length-1],Mt+Bt)),this.setIndex(ar),this.setAttribute("position",new Float32BufferAttribute(cr,3)),this.setAttribute("normal",new Float32BufferAttribute(Ar,3)),this.setAttribute("uv",new Float32BufferAttribute(_r,2));function Jl(Zu,Mp,Up,Ep,mp,Cp,t0,_g){for(let m0=0;m0<tr+1;m0++){let K0=m0/tr,Jp=t0<0?K0:1-K0;_g&&(Jp-=1),Jp*=Ep;let y0=new Vector2(Math.sin(Jp),Math.cos(Jp)*t0),z0=y0.clone().multiplyScalar(mp).add(Cp);Qo(z0,Up,Jr),cr.push(Jr.x,Jr.y,Jr.z),Qo(y0,Up,Br),Ar.push(Br.x,Br.y,Br.z),_r.push(Mp,.5+Jr.y/ut),Zu.push(Dr++)}}function mu(Zu,Mp,Up,Ep,mp){let Cp=new Vector3,t0=new Vector2,_g=[Up,Ep];mp<0&&_g.reverse();for(let m0 of _g)t0.set(m0,$r*mp),Qo(t0,Mp,Cp),cr.push(Cp.x,Cp.y,Cp.z),Ar.push(0,mp,0),_r.push(.5,.5),Zu.push(Dr++)}function pu(Zu,Mp,Up){let Ep=new Vector2(Math.sin(Up),Math.cos(Up)),mp=new Vector2(-Math.cos(Up),Math.sin(Up)),Cp=new Vector3,t0=Zu<0?(K0,Jp,y0)=>ar.push(K0,Jp,y0):(K0,Jp,y0)=>ar.push(K0,y0,Jp),_g=new Vector2((rt+_+xs+cs)/4,0);Qo(_g,Ep,Cp),cr.push(Cp.x,Cp.y,Cp.z),Ar.push(mp.x,0,mp.y),_r.push(.5,.5);let m0=Dr++;for(let K0 of Mp){let Jp=cr.slice(K0*3,K0*3+3);cr.push(...Jp),Ar.push(mp.x,0,mp.y);let y0=_r.slice(K0*2,K0*2+2);_r.push(...y0),Dr++}for(let K0=m0+1;K0<Dr-1;K0++)t0(m0,K0,K0+1);t0(m0,Dr-1,m0+1)}}},$y=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},rt.parameters);return ut.thetaLength=MathUtils.clamp(ut.thetaLength,0,360),{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??ut.width)})}}static build(rt){let{width:_,depth:ut,height:mt,radialSegments:bt,heightSegments:St,openEnded:Mt,thetaStart:Bt,thetaLength:Ut,cornerRadiusTop:Ht,cornerRadiusBottom:tr,cornerSegments:rr}=rt.parameters,sr;return Ut===0?(sr=new BufferGeometry,sr.setAttribute("position",new Float32BufferAttribute([],3))):Ht>0||tr>0||Ut<360?sr=new ls(0,_/2,mt,bt,St,Mt,Bt,Ut*Math.PI/180,Ht,tr,rr,0,!0):sr=new ConeGeometry(_/2,mt,bt,St,Mt),sr.scale(1,1,ut/_),Object.assign(sr,{userData:{...rt,type:"ConeGeometry"}})}},Yy=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},rt.parameters);return{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??ut.width)})}}static build(rt){let{width:_,height:ut,depth:mt,widthSegments:bt,heightSegments:St,depthSegments:Mt,cornerRadius:Bt,cornerSegments:Ut}=rt.parameters,Ht;return Bt==0?Ht=new BoxGeometry(_,ut,mt,bt,St,Mt):Ht=new ud(_,ut,mt,bt,St,Mt,Bt,Ut),Object.assign(Ht,{userData:{...rt,type:"CubeGeometry"}})}},cd=Math.PI/2,ud=class extends BufferGeometry{constructor(rt=1,_=1,ut=1,mt=1,bt=1,St=1,Mt=0,Bt=4){super(),this.type="BoxGeometry";let Ut=this;mt=Math.floor(mt),bt=Math.floor(bt),St=Math.floor(St),Bt=Math.floor(Bt),Mt=Math.min(Mt,rt/2,_/2,ut/2);let Ht=[],tr=[],rr=[],sr=[],ar=0,cr=0;Ar("z","y","x",-1,-1,ut,_,rt,St,bt,0),Ar("z","y","x",1,-1,ut,_,-rt,St,bt,1),Ar("x","z","y",1,1,rt,ut,_,mt,St,2),Ar("x","z","y",1,-1,rt,ut,-_,mt,St,3),Ar("x","y","z",1,-1,rt,_,ut,mt,bt,4),Ar("x","y","z",-1,-1,rt,_,-ut,mt,bt,5),Mt>0&&(_r("z","y","x",-1,-1,1,ut,_,rt,St,0),_r("z","y","x",1,-1,-1,ut,_,rt,St,1),_r("z","y","x",-1,1,-1,ut,_,rt,St,1),_r("z","y","x",1,1,1,ut,_,rt,St,0),_r("x","y","z",-1,-1,-1,rt,_,ut,mt,0),_r("x","y","z",1,-1,1,rt,_,ut,mt,1),_r("x","y","z",-1,1,1,rt,_,ut,mt,0),_r("x","y","z",1,1,-1,rt,_,ut,mt,1),_r("y","x","z",-1,-1,1,_,rt,ut,bt,0),_r("y","x","z",1,-1,-1,_,rt,ut,bt,1),_r("y","x","z",1,1,1,_,rt,ut,bt,1),_r("y","x","z",-1,1,-1,_,rt,ut,bt,0),Dr(1,1,1),Dr(-1,1,1),Dr(1,-1,1),Dr(-1,-1,1),Dr(1,1,-1),Dr(-1,1,-1),Dr(1,-1,-1),Dr(-1,-1,-1)),this.setIndex(Ht),this.setAttribute("position",new Float32BufferAttribute(tr,3)),this.setAttribute("normal",new Float32BufferAttribute(rr,3)),this.setAttribute("uv",new Float32BufferAttribute(sr,2));function Ar($r,Br,Jr,mn,Mn,$n,en,In,Rn,qn,Qn){let xs=($n-2*Mt)/Rn,cs=(en-2*Mt)/qn,ks=$n/2-Mt,_o=en/2-Mt,qs=In/2,Ss=Rn+1,eo=qn+1,Ao=0,Oo=0,uo=new Vector3;for(let uu=0;uu<eo;uu++){let cu=uu*cs-_o;for(let Jl=0;Jl<Ss;Jl++){let mu=Jl*xs-ks;uo[$r]=mu*mn,uo[Br]=cu*Mn,uo[Jr]=qs,tr.push(uo.x,uo.y,uo.z),uo[$r]=0,uo[Br]=0,uo[Jr]=In>0?1:-1,rr.push(uo.x,uo.y,uo.z),sr.push(Jl/Rn),sr.push(1-uu/qn),Ao+=1}}for(let uu=0;uu<qn;uu++)for(let cu=0;cu<Rn;cu++){let Jl=ar+cu+Ss*uu,mu=ar+cu+Ss*(uu+1),pu=ar+(cu+1)+Ss*(uu+1),Zu=ar+(cu+1)+Ss*uu;Ht.push(Jl,mu,Zu),Ht.push(mu,pu,Zu),Oo+=6}Ut.addGroup(cr,Oo,Qn),cr+=Oo,ar+=Ao}function _r($r,Br,Jr,mn,Mn,$n,en,In,Rn,qn,Qn){let xs=(en-2*Mt)/qn,cs=en/2-Mt,ks=In/2-Mt,_o=Rn/2,qs=qn+1,Ss=0,eo=0,Ao=new Vector3,Oo=new Vector3;for(let uo=0;uo<Bt+1;uo++){let uu=uo/Bt*cd,cu=Math.sin(uu)*Mt,Jl=(1-Math.cos(uu))*Mt,mu=Math.sin(uu),pu=Math.cos(uu);Ao[Br]=(ks+cu)*Mn,Ao[Jr]=(_o-Jl)*$n,Oo[$r]=0,Oo[Br]=mu*Math.sign(Ao[Br]),Oo[Jr]=pu*Math.sign(Ao[Jr]);for(let Zu=0;Zu<qs;Zu++){let Mp=Zu*xs-cs;Ao[$r]=Mp*mn,tr.push(Ao.x,Ao.y,Ao.z),rr.push(Oo.x,Oo.y,Oo.z),sr.push(Zu/qn),sr.push(0),Ss+=1}}for(let uo=0;uo<Bt;uo++)for(let uu=0;uu<qn;uu++){let cu=ar+uu+qs*uo,Jl=ar+uu+qs*(uo+1),mu=ar+(uu+1)+qs*(uo+1),pu=ar+(uu+1)+qs*uo;Ht.push(cu,Jl,pu),Ht.push(Jl,mu,pu),eo+=6}Ut.addGroup(cr,eo,Qn),cr+=eo,ar+=Ss}function Dr($r,Br,Jr){let mn=new Vector3,Mn=new Vector3(rt/2,_/2,ut/2);Mn.subScalar(Mt);let $n=[],en=$r*Br*Jr>0?(Rn,qn,Qn)=>Ht.push(Rn,qn,Qn):(Rn,qn,Qn)=>Ht.push(Rn,Qn,qn);for(let Rn=0;Rn<=Bt;Rn++){let qn=[],Qn=cd*(1-Rn/Bt),xs=Math.cos(Qn),cs=Math.sin(Qn),ks=0;for(let _o=0;_o<=Rn;_o++){let qs=Math.cos(ks),Ss=Math.sin(ks);mn.x=xs*qs,mn.y=cs,mn.z=xs*Ss;let eo=Mn.clone().addScaledVector(mn,Mt);tr.push($r*eo.x,Br*eo.y,Jr*eo.z),rr.push($r*mn.x,Br*mn.y,Jr*mn.z),sr.push(0,0),qn.push(ar++),ks+=cd/Rn}$n.push(qn)}let In=$n.length-1;for(let Rn=0;Rn<In;Rn++){let qn=$n[Rn],Qn=$n[Rn+1],xs=qn.length-1;en(qn[0],Qn[1],Qn[0]);for(let cs=1;cs<=xs;cs++)en(qn[cs-1],qn[cs],Qn[cs]),en(qn[cs],Qn[cs+1],Qn[cs])}}}},Zo=class extends BufferGeometry{constructor(rt=[],_=[],ut="",mt=1,bt=.2,St=4){super(),this.type="PolyhedronGeometryRound";let Mt=[],Bt=[],Ut=[];Ht(),tr(),this.setAttribute("position",new Float32BufferAttribute(Mt,3)),this.setAttribute("normal",new Float32BufferAttribute(Ut,3)),this.setAttribute("uv",new Float32BufferAttribute(Bt,2));return;function Ht(){var qs;bt=Math.min(1-1e-5,bt),bt==0&&(St=0);let rr={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[ut],sr=new Vector3,ar=sr.clone(),cr=new Triangle,Ar=bt*mt,_r=mt-Ar,Dr=St+1,$r=new Vector3,Br=(Ss,eo)=>$r.subVectors(Ss,eo).normalize(),Jr=(Ss,eo)=>Array(Ss).fill(void 0).map(eo),mn=Jr(rt.length/3,(Ss,eo)=>new Vector3().fromArray(rt,eo*3).setLength(mt)),Mn=[],$n=1e6;for(let Ss=0;Ss<mn.length;Ss++){let eo=mn[Ss],Ao=[],Oo,uo,uu,cu=1e10,Jl=-1;for(;(Jl=_.indexOf(Ss,Jl+1))!=-1;){let Mp=Jl-Jl%3;Oo=_[Mp+(Jl+1)%3],uo=_[Mp+(Jl+2)%3],uu=eo.distanceToSquared(mn[Oo]),cu=Math.min(cu,uu),Ao.push([Oo,uo,uu])}cu+=1e-6;let mu=[],pu=0,Zu=Ao.length;for(let Mp=0;Mp<Zu;Mp++){[Oo,uo,uu]=Ao[pu];let Up=((qs=Mn[Oo])==null?void 0:qs.includes(Ss))==!0;uu<=cu&&mu.push(Oo+ +Up*$n),pu=Ao.findIndex(Ep=>Ep[0]==uo)}Mn.push(mu)}let en=[];{let Ss=0,eo=0,Ao,Oo,uo=rr==3;for(let uu=0;uu<=St;uu++){Ao=uu*(uu+1)/2,Oo=(uu+1)*(uu+2)/2;for(let cu=0;cu<St-uu;cu++)[Ss,eo]=[Ao+cu+uu+2,Oo+cu+uu+3],en.push(Ao,Oo,...uo?[eo,Ao]:[Ss,Oo],eo,Ss),[Ao,Oo]=[Ss,eo];en.push(Ao,Oo,Ao+St+2)}}let In=sr.clone(),Rn=sr.clone(),qn=sr.clone(),Qn=sr.clone(),xs=sr.clone(),cs=[],ks=Jr(mn.length,()=>Jr(rr,()=>sr.clone()));for(let Ss=0;Ss<mn.length;Ss++){sr.copy(mn[Ss]).normalize(),In.copy(sr).multiplyScalar(_r);let eo=Mn[Ss];for(let mu=0;mu<eo.length;mu++){let pu=eo[mu],Zu=eo[(mu+1)%rr];cr.setFromPointsAndIndices(mn,Ss,pu%$n,Zu%$n),cr.b.sub(cr.a).setLength(1e10).add(cr.a),cr.c.sub(cr.a).setLength(1e10).add(cr.a),cr.closestPointToPoint(In,ks[Ss][mu])}let Ao=[],Oo=[],uo=[],uu=new Vector3;St==0&&[...ks[Ss]].reduce((mu,pu)=>mu.add(pu),uu).multiplyScalar(1/rr);for(let mu=0;mu<rr;mu++){let pu=[],Zu=(mu-1+rr)%rr,Mp=ks[Ss][Zu],Up=ks[Ss][mu];sr.copy(Mp).sub(In),ar.copy(Up).sub(In);let Ep=In.angleTo(sr),mp=sr.angleTo(ar),Cp=Math.cos(Ep)*Ar;St==0?Rn.copy(uu):Rn.copy(In).setLength(_r+Cp),Oo.push(Cp);let t0=[Rn,Mp,Up];for(let _g=0;_g<2;_g++){let m0=t0[_g],K0=t0[_g+1];Qn.subVectors(m0,In),xs.subVectors(K0,In),qn.crossVectors(Qn,xs).normalize();for(let Jp=0;Jp<Dr;Jp++){let y0=[Ep,mp][_g]*Jp/Dr;sr.copy(Qn).applyAxisAngle(qn,y0).add(In),Ao.push(sr.clone()),_g&&(Br(sr,In),pu.push([Jp==0?m0:sr.clone(),$r.clone()]))}_g&&(Br(K0,In),pu.push([K0,$r.clone()]))}uo.push(pu)}cs.push(uo);let cu=2*Dr,Jl=2;for(let mu=0;mu<rr;mu++){let pu=cu*mu,Zu=cu*((mu+1)%rr),Mp=[Ao[pu]];for(let Ep=1;Ep<Dr;Ep++){Qn=Ao[pu+Ep],xs=Ao[Zu+Ep],Mp.push(Qn);for(let mp=1,Cp=Ep-Jl+1;mp<=Cp;mp++)sr.lerpVectors(Qn,xs,mp/(Cp+1)),sr.sub(In).setLength(Oo[mu]).add(In),Mp.push(sr.clone());Mp.push(xs)}for(let Ep=0;Ep<Dr;Ep++)Mp.push(Ao[Ep+Dr+pu]);Mp.push(Ao[Zu+Dr]);let Up=en.map(Ep=>Mp[Ep]);Mt.push(...Up.map(Ep=>[Ep.x,Ep.y,Ep.z]).flat()),Ut.push(...Up.map(Ep=>(Br(Ep,In),[$r.x,$r.y,$r.z])).flat())}}let _o=[];for(let Ss=0;Ss<Mn.length;Ss++)for(let eo=0;eo<rr;eo++){let Ao=Mn[Ss][eo];if(Ao<$n){let Oo=Mn[Ao].findIndex(cu=>cu%$n==Ss),uo=cs[Ss][eo],uu=cs[Ao][Oo];for(let cu=0;cu<Dr;cu++){let Jl=uo[cu],mu=uu[Dr-cu],pu=uo[cu+1],Zu=uu[Dr-(cu+1)];[Jl,mu,pu,pu,mu,Zu].forEach(Mp=>{Mt.push(Mp[0].x,Mp[0].y,Mp[0].z),Ut.push(Mp[1].x,Mp[1].y,Mp[1].z)})}_o.push(uo[0][0],uu[Dr][0],uo[Dr][0],uu[0][0])}}for(;_o.length;){let Ss,eo,Ao,Oo;[Ss,eo]=_o.splice(0,2);let uo=[Ss];for(;Ss!=eo;)uo.push(eo),Ao=_o.indexOf(eo),Oo=Ao%2,eo=_o.splice(Ao-Oo,2)[1-Oo];$r.subVectors(uo[0],uo[1]).cross(sr.subVectors(uo[0],uo[2])).normalize();let uu=$r.dot(uo[0])<0;uu&&$r.negate();for(let cu=1;cu<=uo.length-2;cu++)[uo[cu+ +uu],uo[cu+1-+uu],uo[0]].forEach(Jl=>{Mt.push(Jl.x,Jl.y,Jl.z),Ut.push($r.x,$r.y,$r.z)})}}function tr(){let rr=new Vector3;for(let Mn=0;Mn<Mt.length;Mn+=3){rr.x=Mt[Mn+0],rr.y=Mt[Mn+1],rr.z=Mt[Mn+2];let $n=Jr(rr)/2/Math.PI+.5,en=mn(rr)/Math.PI+.5;Bt.push($n,1-en)}let sr=new Vector3,ar=new Vector3,cr=new Vector3,Ar=new Vector3,_r=new Vector2,Dr=new Vector2,$r=new Vector2,Br=(Mn,$n,en,In)=>{In<0&&Mn.x===1&&(Bt[$n]=Mn.x-1),en.x===0&&en.z===0&&(Bt[$n]=In/2/Math.PI+.5)};for(let Mn=0,$n=0;Mn<Mt.length;Mn+=9,$n+=6){sr.set(Mt[Mn+0],Mt[Mn+1],Mt[Mn+2]),ar.set(Mt[Mn+3],Mt[Mn+4],Mt[Mn+5]),cr.set(Mt[Mn+6],Mt[Mn+7],Mt[Mn+8]),_r.set(Bt[$n+0],Bt[$n+1]),Dr.set(Bt[$n+2],Bt[$n+3]),$r.set(Bt[$n+4],Bt[$n+5]),Ar.copy(sr).add(ar).add(cr).divideScalar(3);let en=Jr(Ar);Br(_r,$n+0,sr,en),Br(Dr,$n+2,ar,en),Br($r,$n+4,cr,en)}for(let Mn=0;Mn<Bt.length;Mn+=6){let $n=Bt[Mn+0],en=Bt[Mn+2],In=Bt[Mn+4],Rn=Math.max($n,en,In),qn=Math.min($n,en,In);Rn>.9&&qn<.1&&($n<.2&&(Bt[Mn+0]+=1),en<.2&&(Bt[Mn+2]+=1),In<.2&&(Bt[Mn+4]+=1))}function Jr(Mn){return Math.atan2(Mn.z,-Mn.x)}function mn(Mn){return Math.atan2(-Mn.y,Math.sqrt(Mn.x*Mn.x+Mn.z*Mn.z))}}}static fromJSON(rt){return new Zo(rt.vertices,rt.indices,rt.radius,rt.corner,rt.cornerSides)}},Xy=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,detail:0,corner:0,cornerSides:4},rt.parameters);return{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??ut.width)})}}static build(rt){let{width:_,height:ut,depth:mt,detail:bt,corner:St,cornerSides:Mt}=rt.parameters,Bt=bt===0&&St!==0?new us(_*.5,St,Mt):new DodecahedronGeometry(_*.5,bt);return Bt.scale(1,ut/_,mt/_),Object.assign(Bt,{userData:{...rt,type:"DodecahedronGeometry"}})}},us=class extends Zo{constructor(rt=1,_=.2,ut=4){let mt=(1+Math.sqrt(5))/2,bt=1/mt,St=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-bt,-mt,0,-bt,mt,0,bt,-mt,0,bt,mt,-bt,-mt,0,-bt,mt,0,bt,-mt,0,bt,mt,0,-mt,0,-bt,mt,0,-bt,-mt,0,bt,mt,0,bt],Mt=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],Bt="DodecahedronGeometry";super(St,Mt,Bt,rt,_,ut),this.type=Bt}static fromJSON(rt){return new us(rt.radius,rt.corner,rt.cornerSides)}},ds=1e-12,Ui=class{constructor(rt){this.position=new Vector2,this.startPosition=new Vector2,this.uuid=MathUtils.generateUUID(),this.position=rt.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(rt){this.position.copy(this.startPosition).add(rt)}copy(rt){return this.position.copy(rt.position),this.startPosition.copy(rt.startPosition),this}clone(){return new Ui(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},Hi=class extends Ui{constructor(rt){super(rt.position),this.parent=rt}copy(rt){return super.copy(rt),this}clone(){return new Hi(this.parent).copy(this)}},Tr=class extends Ui{constructor(rt,_){super(_),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=rt,this.controls.push(new Hi(this),new Hi(this))}static create(rt,_){let ut=new Tr(rt,new Vector2(..._.position));return ut.controls[0].position.set(..._.controlPrevious.position),ut.controls[1].position.set(..._.controlNext.position),ut.roundness=_.roundness,ut.areControlsDirectionsMirrored=_.areControlsDirectionsMirrored,ut}getOppositeControl(rt){let _=this.controls.indexOf(rt);return _===0?this.controls[1]:_===1?this.controls[0]:null}applyOffsetToControls(rt,_=1){for(let ut=0,mt=this.controls.length;ut<mt;ut++){let bt=this.controls[ut];this.position.distanceTo(bt.position)<=_?bt.position.copy(this.position):bt.applyOffset(rt)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(rt){return super.copy(rt),this.controls[0].copy(rt.controls[0]),this.controls[1].copy(rt.controls[1]),this.roundness=rt.roundness,this.uuid=rt.uuid,this}clone(){return new Tr(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var ut,mt;let rt=(ut=this.curveBefore)==null?void 0:ut.getTangentAt(1),_=(mt=this.curveAfter)==null?void 0:mt.getTangentAt(0);return[rt,_]}computeNormals(rt=new Vector2,_=new Vector2){let[ut,mt]=this.computeTangents();return ut&&mt&&(Ky(ut,rt),Ky(mt,_)),[rt,_]}computeTangent(rt=new Vector2){let[_,ut]=this.computeTangents();return _&&ut&&rt.copy(_).add(ut).normalize(),rt}computeNormal(rt=new Vector2){let[_,ut]=this.computeNormals();return rt.copy(_).add(ut).normalize(),rt}};function Ky(rt,_=new Vector2){let ut=rt.length();return _.set(-rt.y/ut,rt.x/ut)}var md=rt=>rt,qi=new Vector2,uc=new Vector2,WC=new Vector2,$C=new Vector2,YC=new Vector2,XC=new Vector2,Jy=new Vector3,eg=new Vector3;function tg(rt){let _=new Vector2;_.addVectors(rt.v0,qi.subVectors(rt.v1,rt.v0).multiplyScalar(2/3));let ut=new Vector2;return ut.addVectors(rt.v2,uc.subVectors(rt.v1,rt.v2).multiplyScalar(2/3)),new CubicBezierCurve(rt.v0,_,ut,rt.v2)}function ps(rt,_,ut=Number.EPSILON){return Math.abs(rt-_)<ut}function KC(rt,_,ut=Number.EPSILON){return rt.distanceTo(_)<ut}function QC(rt,_,ut=Number.EPSILON){return rt.distanceTo(_)<ut}function yd(rt,_,ut){let mt=Math.sqrt(Math.pow(_.x-rt.x,2)+Math.pow(_.y-rt.y,2)),bt=Math.sqrt(Math.pow(_.x-ut.x,2)+Math.pow(_.y-ut.y,2)),St=Math.sqrt(Math.pow(ut.x-rt.x,2)+Math.pow(ut.y-rt.y,2));return Math.acos((bt*bt+mt*mt-St*St)/(2*bt*mt))}function rg(rt,_,ut){return Qy(rt,_)&&Qy(_,ut)&&fd(rt.position,_.position,ut.position)}function fd(rt,_,ut){return qi.copy(_).sub(rt).cross(uc.copy(ut).sub(rt))===0}function og(rt,_,ut,mt,bt){let St=Math.sqrt(Math.pow(_.x-rt.x,2)+Math.pow(_.y-rt.y,2)),Mt=(rt.y+_.y)/2,Bt=(rt.x+_.x)/2,Ut=Math.sqrt(Math.pow(ut,2)-Math.pow(St/2,2))*(rt.y-_.y)/St,Ht=Math.sqrt(Math.pow(ut,2)-Math.pow(St/2,2))*(_.x-rt.x)/St;return mt.set(Bt+Ut,Mt+Ht),bt.set(Bt-Ut,Mt-Ht),[mt,bt]}function ng(rt,_,ut){let mt=rt.distanceTo(ut),bt=_.distanceTo(ut);return mt<bt?_:rt}function ig(rt,_,ut,mt,bt,St){let Mt=_.x-rt.x,Bt=_.y-rt.y,Ut=ut.x-rt.x,Ht=ut.y-rt.y,tr=Math.sqrt((Mt+Ut)*(Mt+Ut)+(Bt+Ht)*(Bt+Ht)),rr;return yd(_,rt,ut)>Math.PI&&(tr*=-1),ps(Ht,Bt)?rr=(Bt+Ht)*(mt/tr-.5)*8/3/(Mt-Ut):rr=(Mt+Ut)*(mt/tr-.5)*8/3/(Ht-Bt),bt.set(_.x-rr*Bt,_.y+rr*Mt),St.set(ut.x+rr*Ht,ut.y-rr*Ut),[bt,St]}function gd(rt,_){return rt.position.equals(rt.controls[1].position)&&_.position.equals(_.controls[0].position)}function Qy(rt,_){return fd(rt.position,rt.controls[1].position,_.position)&&fd(rt.position,_.controls[0].position,_.position)}function ag(rt,_,ut,mt,bt=.5){let St=qi.subVectors(_,rt).multiplyScalar(bt).add(rt),Mt=uc.subVectors(ut,_).multiplyScalar(bt).add(_),Bt=WC.subVectors(mt,ut).multiplyScalar(bt).add(ut),Ut=St,Ht=$C.subVectors(Mt,St).multiplyScalar(bt).add(St),tr=YC.subVectors(Bt,Mt).multiplyScalar(bt).add(Mt),rr=Bt,sr=XC.subVectors(tr,Ht).multiplyScalar(bt).add(Ht);return[rt.x,rt.y,Ut.x,Ut.y,Ht.x,Ht.y,sr.x,sr.y,tr.x,tr.y,rr.x,rr.y,mt.x,mt.y]}function sg(rt,_,ut=12,mt=!0){let bt=eg.set(0,0,0),St,Mt=0;for(let Bt=0;Bt<_.length;Bt++){let Ut=md(_[Bt]),Ht=qi,tr=Jo(Ut,ut);for(let rr=0;rr<=tr;rr++)if(Ut instanceof CubicBezierCurve||Ut instanceof QuadraticBezierCurve||Ut instanceof LineCurve){if(Ut.getPoint(rr/tr,Ht),bt.set(Ht.x,Ht.y,0),St!==void 0&&QC(St,bt))continue;St===void 0&&(St=Jy),St.copy(bt),rt.setXYZ(Mt,bt.x,bt.y,bt.z),Mt++}}return mt&&Mt>1&&!(rt.getX(Mt-1)===rt.getX(0)&&rt.getY(Mt-1)===rt.getY(0)&&rt.getZ(Mt-1)===rt.getZ(0))&&(rt.setXYZ(Mt,rt.getX(0),rt.getY(0),rt.getZ(0)),Mt++),rt}function lg(rt,_,ut,mt=12,bt=!0){let St=eg.set(0,0,0),Mt=0,Bt=[];for(let Ut=0;Ut<_.length;Ut++){if(ut[Ut]===!1)continue;let Ht,tr=md(_[Ut]),rr=qi,sr=Jo(tr,mt);Bt.push(sr);for(let ar=0;ar<=sr;ar++)if(tr instanceof CubicBezierCurve||tr instanceof QuadraticBezierCurve||tr instanceof LineCurve){if(tr.getPoint(ar/sr,rr),St.set(rr.x,rr.y,0),Ht==null?void 0:Ht.equals(St))continue;Ht===void 0?Ht=Jy:(rt.setXYZ(Mt,Ht.x,Ht.y,Ht.z),Mt++,rt.setXYZ(Mt,St.x,St.y,St.z),Mt++),Ht.copy(St)}}return bt&&Mt>1&&!(rt.getX(Mt-1)===rt.getX(0)&&rt.getY(Mt-1)===rt.getY(0)&&rt.getZ(Mt-1)===rt.getZ(0))&&(rt.setXYZ(Mt,rt.getX(0),rt.getY(0),rt.getZ(0)),Mt++),Bt}function xd(rt,_=12,ut=!1){let mt=[];for(let bt=0,St=rt.length;bt<St;bt++){let Mt=rt[bt],Bt=0;if(ut&&Mt.roundedCurveCorner!==void 0){let Ut=Jo(Mt.roundedCurveCorner,_)*.5;bt>0&&(mt[bt-1]+=Ut),Bt+=Ut}Mt.curveAfter!==void 0&&(Bt+=Jo(Mt.curveAfter,_)),mt.push(Bt)}return rt.length>0&&ut&&rt[0].roundedCurveCorner!==void 0&&(mt[rt.length-1]+=Jo(rt[0].roundedCurveCorner,_)*.5),mt}function Jo(rt,_=12){return rt&&rt instanceof EllipseCurve?_*2:rt&&(rt instanceof LineCurve||rt instanceof LineCurve3)?1:rt&&rt instanceof SplineCurve?_*rt.points.length:_}function cg(rt,_,ut=12,mt=!0){let bt,St=0;for(let Mt=0;Mt<_.length;Mt++){let Bt=md(_[Mt]),Ut=Jo(Bt,ut),Ht=qi;for(let tr=0;tr<=Ut;tr++)if(Bt instanceof CubicBezierCurve||Bt instanceof QuadraticBezierCurve||Bt instanceof LineCurve){if(Bt.getPoint(tr/Ut,Ht),bt!==void 0&&KC(bt,Ht,ds))continue;bt===void 0&&(bt=uc),bt.copy(Ht),rt.push(Ht.x,Ht.y),St++}}return ps(rt[0],rt[rt.length-2],ds)&&ps(rt[1],rt[rt.length-1],ds)&&(rt.pop(),rt.pop()),mt&&St>1&&!(ps(rt[St-1],rt[1],ds)&&ps(rt[St-2],rt[0],ds))&&(rt.push(rt[0],rt[1]),St++),rt}var Sd=new Vector2,eP=new Vector2,tP=new Vector2,rP=new Vector2,oP=new Vector2,nP=new Vector2,Ne$1=class extends Shape{constructor(_=100,ut=100){super(),this.points=[],this.shapeHoles=[],this.plane=new Plane(new Vector3(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this.isText=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=MathUtils.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=_,this._height=ut}static createFromState(_,ut,mt){let bt=new Ne$1;return bt.isClosed=_.isClosed,bt.points=_.points.map(St=>Tr.create(St.id,St.data)),typeof _.roundness=="number"&&(bt.roundness=_.roundness),bt.shapeHoles=_.shapeHoles.map(St=>Ne$1.createFromState(St)),ut!==void 0&&mt!==void 0&&bt.applySize(ut,mt),bt.update(),bt}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(_){if(this._roundness!==_){this._roundness=_;for(let ut=0,mt=this.points.length;ut<mt;ut++)this.points[ut].roundness=_;this.needsUpdate=!0}}getPointsIndexesByIds(_){return _.map(ut=>this.getPointIndexById(ut)).filter(ut=>ut>=0)}getPointIndexById(_){let ut=this.points.length,mt=this.points.findIndex(bt=>bt.uuid===_);if(mt<0){let bt=ut;for(let St=0,Mt=this.shapeHoles.length;St<Mt;St++){let Bt=this.shapeHoles[St],Ut=Bt.points.length,Ht=Bt.getPointIndexById(_);if(Ht<0)bt+=Ut;else return Ht+bt}}return mt}getLineIndexById(_){return this.getPointIndexById(_)}getBezierPoint(_){if(_<=this.points.length-1)return this.points[_];if(this.shapeHoles.length>0){let ut=this.points.length;for(let mt=0,bt=this.shapeHoles.length;mt<bt;mt++){let St=this.shapeHoles[mt],Mt=_-ut;if(Mt<=St.points.length-1)return St.points[Mt];ut+=St.points.length}}throw new Error("This shape does not have a point for this index: "+_)}getBezierPointIndex(_){let ut=this.points.indexOf(_);if(ut>=0)return ut;if(ut=this.points.length,this.shapeHoles.length>0)for(let mt=0,bt=this.shapeHoles.length;mt<bt;mt++){let St=this.shapeHoles[mt],Mt=St.points.indexOf(_);if(Mt>=0)return ut+Mt;ut+=St.points.length}return-1}getAllPoints(){let _=[].concat(...this.shapeHoles.map(ut=>ut.points));return[...this.points,..._]}applySize(_,ut){_===0&&(_=.001),ut===0&&(ut=.001),this._width=_,this._height=ut}applyScale(_,ut){let mt=Sd.set(_,ut);for(let bt=0,St=this.points.length;bt<St;bt++){let Mt=this.points[bt];Mt.position.multiply(mt),Mt.controls[0].position.multiply(mt),Mt.controls[1].position.multiply(mt)}for(let bt=0,St=this.shapeHoles.length;bt<St;bt++)this.shapeHoles[bt].applyScale(_,ut);this._update()}createPoint(_,ut=0,mt=MathUtils.generateUUID()){let bt;_ instanceof Vector2?bt=_:bt=new Vector2(_,ut);let St=new Tr(mt,bt);return St.roundness=this.roundness,St}addPoint(_){this.points.push(_),this.needsUpdate=!0}addPointAt(_,ut){this.points.splice(ut,0,_),this.needsUpdate=!0}getPointByUuid(_){for(let ut=0,mt=this.points.length;ut<mt;ut++){let bt=this.points[ut];if(bt.uuid===_)return bt}for(let ut=0,mt=this.shapeHoles.length;ut<mt;ut++){let bt=this.shapeHoles[ut].getPointByUuid(_);if(bt)return bt}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(_){let ut=this.points.indexOf(_);ut>=0&&this.points.splice(ut,1),this.needsUpdate=!0}removePointById(_){let ut=this.points.find(mt=>mt.uuid===_);ut&&this.removePoint(ut)}update(){for(let _=0,ut=this.shapeHoles.length;_<ut;_++)this.shapeHoles[_].update();this._update()}extractShapePointsToBuffer(_,ut=12,mt=!1){this.subdivision=ut,this.curveDivisions===void 0&&this.computeCurveDivisions(ut);let bt=mt?this.roundedCurveDivisions:this.curveDivisions;return sg(_,mt?this.roundedCurves:this.curves,ut,this.autoClose),bt.reduce((St,Mt)=>St+Mt,0)+1}computeCurveDivisions(_=12){return this.curveDivisions=xd(this.points,_,!1),this.roundedCurveDivisions=xd(this.points,_,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(_,ut,mt=12){return lg(_,this.curves,ut,mt,this.autoClose).reduce((bt,St)=>bt+St,0)*2}extractShapePointsToFlatArray(_,ut=12){return this.subdivision=ut,this.curveDivisions===void 0&&this.computeCurveDivisions(ut),cg(_,this.roundedCurves,ut,this.autoClose)}getCurveIndexFromVertexId(_,ut=!1){let mt=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let bt=ut?this.roundedCurveDivisions:this.curveDivisions,St=0;ut&&this.points[0].roundedCurveCorner!==void 0&&(St=Jo(this.points[0].roundedCurveCorner,this.subdivision)*.5);let Mt=_-St;Mt<0&&(Mt+=bt.reduce((Bt,Ut)=>Bt+Ut,0));for(let Bt=0,Ut=bt.length;Bt<Ut;Bt++){let Ht=bt[Bt];if(Mt<mt+Ht)return[Bt,(Mt-mt+1)/Ht];mt+=Ht}return[0,1]}getCurveT(_,ut,mt){let bt=this.points[_],St=this.points[_>=this.points.length-1?0:_+1],Mt=this.curveDivisions,Bt=Mt[_];if(gd(bt,St)){let Ht=bt.position.distanceTo(St.position);return bt.position.distanceTo(Sd.set(mt.x,mt.y))/Ht}let Ut=0;for(let Ht=0;Ht<_;Ht++)Ut+=Mt[Ht];return(ut-Ut)/Bt}dispose(){}_applyCurveForPoint(_,ut){gd(ut,_)?this.lineTo(_.position.x,_.position.y):this.bezierCurveTo(ut.controls[1].position.x,ut.controls[1].position.y,_.controls[0].position.x,_.controls[0].position.y,_.position.x,_.position.y);let mt=this.curves[this.curves.length-1];_.curveBefore=mt,ut.curveAfter=mt;let bt=mt.clone();_.roundedCurveBefore=bt,ut.roundedCurveAfter=bt,_.roundedCurveCorner=void 0,this.roundedCurves.push(bt)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let ut=0,mt=this.points.length;ut<mt;ut++){let bt=this.points[ut];if(ut===0)this.moveTo(bt.position.x,bt.position.y);else{let St=this.points[ut-1];this._applyCurveForPoint(bt,St)}}let _=this.getLastPoint();if(_!=null&&_.curveAfter&&(_.curveAfter=void 0),this.isClosed){let ut=this.points[0],mt=this.points[this.points.length-1];this._applyCurveForPoint(ut,mt)}if(this.points.length>2){let ut=0;for(let mt=0,bt=this.points.length;mt<bt;mt++){let St=this.points[mt],Mt=this.points[mt-1]??this.points[this.points.length-1],Bt=this.points[mt+1]??this.points[0],Ut=St.roundness,Ht=Mt&&Bt&&rg(Mt,St,Bt);if(!St.controlsMoved()&&Ut>0&&!Ht){let tr=St.curveBefore,rr=St.curveAfter;if(tr===void 0||rr===void 0)continue;let sr=St.roundedCurveBefore,ar=St.roundedCurveAfter,cr=tr.getLength(),Ar=rr.getLength(),_r=Math.min(Ut,cr*.499),Dr=Math.min(Ut,Ar*.499),$r=Math.min(_r,Dr),Br=1-$r/cr,Jr=$r/Ar,mn=tr.getPointAt(Br,Sd),Mn=rr.getPointAt(Jr,eP);this._subSplitCurve(tr,sr,Br,mn,void 0),this._subSplitCurve(rr,ar,Jr,void 0,Mn);let $n;if(this.useCubicForRoundedCorners){let en=yd(mn,St.position,Mn)/2,In=Math.tan(en)*mn.distanceTo(St.position),[Rn,qn]=og(mn,Mn,In,tP,rP),Qn=ng(Rn,qn,St.position),[xs,cs]=ig(Qn,mn,Mn,In,oP,nP);$n=new CubicBezierCurve(mn.clone(),xs.clone(),cs.clone(),Mn.clone())}else $n=new QuadraticBezierCurve(mn.clone(),St.position.clone(),Mn.clone());St.roundedCurveCorner=$n,this.roundedCurves.splice(mt+ut,0,$n),ut++}}}}_subSplitCurve(_,ut,mt,bt,St){if(_ instanceof LineCurve)bt!==void 0&&ut.v2.copy(bt),St!==void 0&&ut.v1.copy(St);else{let Mt=_,Bt=ut,Ut=Mt.getUtoTmapping(mt,0),Ht=ag(Mt.v0,Mt.v1,Mt.v2,Mt.v3,Ut);return bt!==void 0&&(Bt.v0.set(Ht[0],Ht[1]),Bt.v1.set(Ht[2],Ht[3]),Bt.v2.set(Ht[4],Ht[5]),Bt.v3.set(Ht[6],Ht[7])),St!==void 0&&(Bt.v0.set(Ht[6],Ht[7]),Bt.v1.set(Ht[8],Ht[9]),Bt.v2.set(Ht[10],Ht[11]),Bt.v3.set(Ht[12],Ht[13])),Bt}return ut}clone(){let _=new Ne$1(this._width,this._height);return _.points=this.points.map(ut=>ut.clone()),_.isClosed=this.isClosed,_.roundness=this.roundness,_.isMesh2D=this.isMesh2D,_.shapeHoles=this.shapeHoles.map(ut=>ut.clone()),_}toJSON(){return{points:this.points.reduce((_,ut)=>_.concat(ut.toJSON()),[]),shapeHoles:this.shapeHoles.map(_=>_.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(_){var mt;this.points=[],this.pointIDs=0;let ut=_.points.length/7;for(let bt=0;bt<ut;bt++){let St=bt*7,Mt=_.points[St+0],Bt=_.points[St+1],Ut=_.points[St+2],Ht=_.points[St+3],tr=_.points[St+4],rr=_.points[St+5],sr=_.points[St+6],ar=new Tr(MathUtils.generateUUID(),new Vector2(Mt,Bt));ar.controls[0].position.set(Ut,Ht),ar.controls[1].position.set(tr,rr),ar.roundness=sr,this.points.push(ar)}return this.shapeHoles=(mt=_.shapeHoles)!=null&&mt.length?_.shapeHoles.map(bt=>{let St=new Ne$1;return St.fromJSON(bt),St}):[],this.isClosed=_.isClosed,this._roundness=_.roundness,this._update(),this}fromShape(_,ut=!1){this.isText=ut;let mt=(St,Mt)=>{Mt instanceof CubicBezierCurve&&Mt.v3.equals(St.position)&&St.controls[0].position.copy(Mt.v2)},bt=St=>{let Mt=[],Bt,Ut;for(Bt=0,Ut=St.length;Bt<Ut;Bt++)St[Bt]instanceof QuadraticBezierCurve&&(St[Bt]=tg(St[Bt]));for(Bt=0,Ut=St.length;Bt<Ut;Bt++){let rr=St[Bt],sr=Bt>0?St[Bt-1]:null,ar;rr instanceof CubicBezierCurve?(ar=this.createPoint(rr.v0),ar.controls[1].position.copy(rr.v1)):rr instanceof LineCurve&&(ar=this.createPoint(rr.v1)),ar!==void 0&&(sr!==null&&mt(ar,sr),Mt.push(ar))}let Ht=St[St.length-1],tr=!1;return Ht instanceof CubicBezierCurve?Ht.v3.equals(Mt[0].position)&&(Mt[0].controls[0].position.copy(Ht.v2),tr=!0):Ht instanceof LineCurve&&Ht.v2.equals(Mt[0].position)&&(tr=!0),this.isClosed=tr,Mt};return this.points=bt(_.curves),_ instanceof Shape&&(this.shapeHoles=_.holes.map(St=>{let Mt=new Ne$1;return Mt.fromShape(St),Mt})),this.update(),this}updatePoint(_,ut){let mt=this.getPointByUuid(_);mt&&(ut.position!==void 0&&mt.position.fromArray(ut.position),ut.roundness!==void 0&&(mt.roundness=ut.roundness),ut.areControlsDirectionsMirrored!==void 0&&(mt.areControlsDirectionsMirrored=ut.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(_,ut){var bt;let mt=(bt=this.getPointByUuid(_))==null?void 0:bt.controls[0];mt&&(ut.position&&mt.position.fromArray(ut.position),this.needsUpdate=!0)}updateNextControl(_,ut){var bt;let mt=(bt=this.getPointByUuid(_))==null?void 0:bt.controls[1];mt&&(ut.position&&mt.position.fromArray(ut.position),this.needsUpdate=!0)}},_d=Math.PI*2;function wd({x:rt,y:_},ut,mt,bt,St){return{x:rt*ut+bt,y:_*mt+St}}function iP(rt,_){let ut=_===1.5707963267948966?.551915024494:_===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(_/4),mt=Math.cos(rt),bt=Math.sin(rt),St=Math.cos(rt+_),Mt=Math.sin(rt+_);return[{x:mt-bt*ut,y:bt+mt*ut},{x:St+Mt*ut,y:Mt-St*ut},{x:St,y:Mt}]}function pg(rt,_,ut,mt){let bt=rt*mt-_*ut<0?-1:1,St=Math.min(1,Math.max(-1,rt*ut+_*mt));return bt*Math.acos(St)}function aP(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht){let tr=Math.pow(bt,2),rr=Math.pow(St,2),sr=Math.pow(Mt,2),ar=Math.pow(Bt,2),cr=tr*rr-tr*ar-rr*sr;cr<0&&(cr=0),cr/=tr*ar+rr*sr,cr=Math.sqrt(cr)*(Ut===Ht?-1:1);let Ar=cr*bt/St*Bt,_r=cr*-St/bt*Mt,Dr=Ar+(rt+ut)/2,$r=_r+(_+mt)/2,Br=(Mt-Ar)/bt,Jr=(Bt-_r)/St,mn=(-Mt-Ar)/bt,Mn=(-Bt-_r)/St,$n=pg(1,0,Br,Jr),en=pg(Br,Jr,mn,Mn);return!Ht&&en>0&&(en-=_d),Ht&&en<0&&(en+=_d),{centerx:Dr,centery:$r,ang1:$n,ang2:en}}function fg({px:rt,py:_,cx:ut,cy:mt,rx:bt,ry:St,largeArcFlag:Mt,sweepFlag:Bt}){let Ut=[];if(bt===0||St===0)return[];let Ht=(rt-ut)/2,tr=(_-mt)/2;if(Ht===0&&tr===0)return[];bt=Math.abs(bt),St=Math.abs(St);let rr=Math.pow(Ht,2)/Math.pow(bt,2)+Math.pow(tr,2)/Math.pow(St,2);rr>1&&(bt*=Math.sqrt(rr),St*=Math.sqrt(rr));let sr=aP(rt,_,ut,mt,bt,St,Ht,tr,Mt,Bt),{ang1:ar,ang2:cr}=sr,{centerx:Ar,centery:_r}=sr,Dr=Math.abs(cr)/(_d/4);Math.abs(1-Dr)<1e-7&&(Dr=1);let $r=Math.max(Math.ceil(Dr),1);cr/=$r;for(let Br=0;Br<$r;Br++)Ut.push(iP(ar,cr)),ar+=cr;return Ut.map(Br=>{let{x:Jr,y:mn}=wd(Br[0],bt,St,Ar,_r),{x:Mn,y:$n}=wd(Br[1],bt,St,Ar,_r),{x:en,y:In}=wd(Br[2],bt,St,Ar,_r);return{x1:Jr,y1:mn,x2:Mn,y2:$n,x:en,y:In}})}var Pe;(function(rt){rt[rt.ODD=0]="ODD",rt[rt.NONZERO=1]="NONZERO",rt[rt.POSITIVE=2]="POSITIVE",rt[rt.NEGATIVE=3]="NEGATIVE",rt[rt.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Pe||(Pe={}));var Xe;(function(rt){rt[rt.POLYGONS=0]="POLYGONS",rt[rt.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",rt[rt.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Xe||(Xe={}));function me(rt,_){if(!rt)throw _||"Assertion Failed!"}var pe=function(){function rt(){}return rt.vertEq=function(_,ut){return _.s===ut.s&&_.t===ut.t},rt.vertLeq=function(_,ut){return _.s<ut.s||_.s===ut.s&&_.t<=ut.t},rt.transLeq=function(_,ut){return _.t<ut.t||_.t===ut.t&&_.s<=ut.s},rt.edgeGoesLeft=function(_){return rt.vertLeq(_.Dst,_.Org)},rt.edgeGoesRight=function(_){return rt.vertLeq(_.Org,_.Dst)},rt.vertL1dist=function(_,ut){return Math.abs(_.s-ut.s)+Math.abs(_.t-ut.t)},rt.edgeEval=function(_,ut,mt){me(rt.vertLeq(_,ut)&&rt.vertLeq(ut,mt));var bt=ut.s-_.s,St=mt.s-ut.s;return bt+St>0?bt<St?ut.t-_.t+(_.t-mt.t)*(bt/(bt+St)):ut.t-mt.t+(mt.t-_.t)*(St/(bt+St)):0},rt.edgeSign=function(_,ut,mt){me(rt.vertLeq(_,ut)&&rt.vertLeq(ut,mt));var bt=ut.s-_.s,St=mt.s-ut.s;return bt+St>0?(ut.t-mt.t)*bt+(ut.t-_.t)*St:0},rt.transEval=function(_,ut,mt){me(rt.transLeq(_,ut)&&rt.transLeq(ut,mt));var bt=ut.t-_.t,St=mt.t-ut.t;return bt+St>0?bt<St?ut.s-_.s+(_.s-mt.s)*(bt/(bt+St)):ut.s-mt.s+(mt.s-_.s)*(St/(bt+St)):0},rt.transSign=function(_,ut,mt){me(rt.transLeq(_,ut)&&rt.transLeq(ut,mt));var bt=ut.t-_.t,St=mt.t-ut.t;return bt+St>0?(ut.s-mt.s)*bt+(ut.s-_.s)*St:0},rt.vertCCW=function(_,ut,mt){return _.s*(ut.t-mt.t)+ut.s*(mt.t-_.t)+mt.s*(_.t-ut.t)>=0},rt.interpolate=function(_,ut,mt,bt){return _=_<0?0:_,mt=mt<0?0:mt,_<=mt?mt===0?(ut+bt)/2:ut+(bt-ut)*(_/(_+mt)):bt+(ut-bt)*(mt/(_+mt))},rt.intersect=function(_,ut,mt,bt,St){var Mt,Bt,Ut;rt.vertLeq(_,ut)||(Ut=_,_=ut,ut=Ut),rt.vertLeq(mt,bt)||(Ut=mt,mt=bt,bt=Ut),rt.vertLeq(_,mt)||(Ut=_,_=mt,mt=Ut,Ut=ut,ut=bt,bt=Ut),rt.vertLeq(mt,ut)?rt.vertLeq(ut,bt)?(Mt=rt.edgeEval(_,mt,ut),Bt=rt.edgeEval(mt,ut,bt),Mt+Bt<0&&(Mt=-Mt,Bt=-Bt),St.s=rt.interpolate(Mt,mt.s,Bt,ut.s)):(Mt=rt.edgeSign(_,mt,ut),Bt=-rt.edgeSign(_,bt,ut),Mt+Bt<0&&(Mt=-Mt,Bt=-Bt),St.s=rt.interpolate(Mt,mt.s,Bt,bt.s)):St.s=(mt.s+ut.s)/2,rt.transLeq(_,ut)||(Ut=_,_=ut,ut=Ut),rt.transLeq(mt,bt)||(Ut=mt,mt=bt,bt=Ut),rt.transLeq(_,mt)||(Ut=_,_=mt,mt=Ut,Ut=ut,ut=bt,bt=Ut),rt.transLeq(mt,ut)?rt.transLeq(ut,bt)?(Mt=rt.transEval(_,mt,ut),Bt=rt.transEval(mt,ut,bt),Mt+Bt<0&&(Mt=-Mt,Bt=-Bt),St.t=rt.interpolate(Mt,mt.t,Bt,ut.t)):(Mt=rt.transSign(_,mt,ut),Bt=-rt.transSign(_,bt,ut),Mt+Bt<0&&(Mt=-Mt,Bt=-Bt),St.t=rt.interpolate(Mt,mt.t,Bt,bt.t)):St.t=(mt.t+ut.t)/2},rt}(),fs=function(){function rt(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return rt}(),pc=function(){function rt(_){this.side=_,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(rt.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(_){this.Sym.Lface=_},enumerable:!0,configurable:!0}),Object.defineProperty(rt.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(_){this.Sym.Org=_},enumerable:!0,configurable:!0}),Object.defineProperty(rt.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(_){this.Sym.Lnext=_},enumerable:!0,configurable:!0}),Object.defineProperty(rt.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(_){this.Onext.Sym=_},enumerable:!0,configurable:!0}),Object.defineProperty(rt.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(_){this.Lnext.Sym=_},enumerable:!0,configurable:!0}),Object.defineProperty(rt.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(_){this.Sym.Onext=_},enumerable:!0,configurable:!0}),Object.defineProperty(rt.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(_){this.Sym.Onext.Sym=_},enumerable:!0,configurable:!0}),Object.defineProperty(rt.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(_){this.Sym.Lnext.Sym=_},enumerable:!0,configurable:!0}),rt}(),Wi=function(){function rt(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return rt}(),hg=function(){function rt(){var _=new Wi,ut=new fs,mt=new pc(0),bt=new pc(1);_.next=_.prev=_,_.anEdge=null,ut.next=ut.prev=ut,mt.next=mt,mt.Sym=bt,bt.next=bt,bt.Sym=mt,this.vHead=_,this.fHead=ut,this.eHead=mt,this.eHeadSym=bt}return rt.prototype.makeEdge_=function(_){var ut=new pc(0),mt=new pc(1);_.Sym.side<_.side&&(_=_.Sym);var bt=_.Sym.next;return mt.next=bt,bt.Sym.next=ut,ut.next=_,_.Sym.next=mt,ut.Sym=mt,ut.Onext=ut,ut.Lnext=mt,ut.Org=null,ut.Lface=null,ut.winding=0,ut.activeRegion=null,mt.Sym=ut,mt.Onext=mt,mt.Lnext=ut,mt.Org=null,mt.Lface=null,mt.winding=0,mt.activeRegion=null,ut},rt.prototype.splice_=function(_,ut){var mt=_.Onext,bt=ut.Onext;mt.Sym.Lnext=ut,bt.Sym.Lnext=_,_.Onext=bt,ut.Onext=mt},rt.prototype.makeVertex_=function(_,ut,mt){var bt=_;me(bt,"Vertex can't be null!");var St=mt.prev;bt.prev=St,St.next=bt,bt.next=mt,mt.prev=bt,bt.anEdge=ut;var Mt=ut;do Mt.Org=bt,Mt=Mt.Onext;while(Mt!==ut)},rt.prototype.makeFace_=function(_,ut,mt){var bt=_;me(bt,"Face can't be null");var St=mt.prev;bt.prev=St,St.next=bt,bt.next=mt,mt.prev=bt,bt.anEdge=ut,bt.trail=null,bt.marked=!1,bt.inside=mt.inside;var Mt=ut;do Mt.Lface=bt,Mt=Mt.Lnext;while(Mt!==ut)},rt.prototype.killEdge_=function(_){_.Sym.side<_.side&&(_=_.Sym);var ut=_.next,mt=_.Sym.next;ut.Sym.next=mt,mt.Sym.next=ut},rt.prototype.killVertex_=function(_,ut){var mt=_.anEdge,bt=mt;do bt.Org=ut,bt=bt.Onext;while(bt!==mt);var St=_.prev,Mt=_.next;Mt.prev=St,St.next=Mt},rt.prototype.killFace_=function(_,ut){var mt=_.anEdge,bt=mt;do bt.Lface=ut,bt=bt.Lnext;while(bt!==mt);var St=_.prev,Mt=_.next;Mt.prev=St,St.next=Mt},rt.prototype.makeEdge=function(){var _=new Wi,ut=new Wi,mt=new fs,bt=this.makeEdge_(this.eHead);return this.makeVertex_(_,bt,this.vHead),this.makeVertex_(ut,bt.Sym,this.vHead),this.makeFace_(mt,bt,this.fHead),bt},rt.prototype.splice=function(_,ut){var mt=!1,bt=!1;if(_!==ut){if(ut.Org!==_.Org&&(bt=!0,this.killVertex_(ut.Org,_.Org)),ut.Lface!==_.Lface&&(mt=!0,this.killFace_(ut.Lface,_.Lface)),this.splice_(ut,_),!bt){var St=new Wi;this.makeVertex_(St,ut,_.Org),_.Org.anEdge=_}if(!mt){var Mt=new fs;this.makeFace_(Mt,ut,_.Lface),_.Lface.anEdge=_}}},rt.prototype.delete=function(_){var ut=_.Sym,mt=!1;if(_.Lface!==_.Rface&&(mt=!0,this.killFace_(_.Lface,_.Rface)),_.Onext===_)this.killVertex_(_.Org,null);else if(_.Rface.anEdge=_.Oprev,_.Org.anEdge=_.Onext,this.splice_(_,_.Oprev),!mt){var bt=new fs;this.makeFace_(bt,_,_.Lface)}ut.Onext===ut?(this.killVertex_(ut.Org,null),this.killFace_(ut.Lface,null)):(_.Lface.anEdge=ut.Oprev,ut.Org.anEdge=ut.Onext,this.splice_(ut,ut.Oprev)),this.killEdge_(_)},rt.prototype.addEdgeVertex=function(_){var ut=this.makeEdge_(_),mt=ut.Sym;this.splice_(ut,_.Lnext),ut.Org=_.Dst;var bt=new Wi;return this.makeVertex_(bt,mt,ut.Org),ut.Lface=mt.Lface=_.Lface,ut},rt.prototype.splitEdge=function(_){var ut=this.addEdgeVertex(_),mt=ut.Sym;return this.splice_(_.Sym,_.Sym.Oprev),this.splice_(_.Sym,mt),_.Dst=mt.Org,mt.Dst.anEdge=mt.Sym,mt.Rface=_.Rface,mt.winding=_.winding,mt.Sym.winding=_.Sym.winding,mt.idx=_.idx,mt.Sym.idx=_.Sym.idx,mt},rt.prototype.connect=function(_,ut){var mt=!1,bt=this.makeEdge_(_),St=bt.Sym;if(ut.Lface!==_.Lface&&(mt=!0,this.killFace_(ut.Lface,_.Lface)),this.splice_(bt,_.Lnext),this.splice_(St,ut),bt.Org=_.Dst,St.Org=ut.Org,bt.Lface=St.Lface=_.Lface,_.Lface.anEdge=St,!mt){var Mt=new fs;this.makeFace_(Mt,bt,_.Lface)}return bt},rt.prototype.zapFace=function(_){var ut=_.anEdge,mt,bt,St,Mt,Bt;bt=ut.Lnext;do mt=bt,bt=mt.Lnext,mt.Lface=null,mt.Rface===null&&(mt.Onext===mt?this.killVertex_(mt.Org,null):(mt.Org.anEdge=mt.Onext,this.splice_(mt,mt.Oprev)),St=mt.Sym,St.Onext===St?this.killVertex_(St.Org,null):(St.Org.anEdge=St.Onext,this.splice_(St,St.Oprev)),this.killEdge_(mt));while(mt!=ut);Mt=_.prev,Bt=_.next,Bt.prev=Mt,Mt.next=Bt},rt.prototype.countFaceVerts_=function(_){var ut=_.anEdge,mt=0;do mt++,ut=ut.Lnext;while(ut!==_.anEdge);return mt},rt.prototype.mergeConvexFaces=function(_){var ut,mt,bt,St,Mt,Bt,Ut;for(ut=this.fHead.next;ut!==this.fHead;ut=ut.next)if(ut.inside)for(mt=ut.anEdge,Mt=mt.Org;bt=mt.Lnext,St=mt.Sym,St&&St.Lface&&St.Lface.inside&&(Bt=this.countFaceVerts_(ut),Ut=this.countFaceVerts_(St.Lface),Bt+Ut-2<=_&&pe.vertCCW(mt.Lprev.Org,mt.Org,St.Lnext.Lnext.Org)&&pe.vertCCW(St.Lprev.Org,St.Org,mt.Lnext.Lnext.Org)&&(bt=St.Lnext,this.delete(St),mt=null,St=null)),!(mt&&mt.Lnext.Org===Mt);)mt=bt;return!0},rt.prototype.check=function(){var _=this.fHead,ut=this.vHead,mt=this.eHead,bt,St,Mt,Bt,Ut,Ht;for(St=_,St=_;(bt=St.next)!==_;St=bt){me(bt.prev===St),Ut=bt.anEdge;do me(Ut.Sym!==Ut),me(Ut.Sym.Sym===Ut),me(Ut.Lnext.Onext.Sym===Ut),me(Ut.Onext.Sym.Lnext===Ut),me(Ut.Lface===bt),Ut=Ut.Lnext;while(Ut!==bt.anEdge)}for(me(bt.prev===St&&bt.anEdge===null),Bt=ut,Bt=ut;(Mt=Bt.next)!==ut;Bt=Mt){me(Mt.prev===Bt),Ut=Mt.anEdge;do me(Ut.Sym!==Ut),me(Ut.Sym.Sym===Ut),me(Ut.Lnext.Onext.Sym===Ut),me(Ut.Onext.Sym.Lnext===Ut),me(Ut.Org===Mt),Ut=Ut.Onext;while(Ut!==Mt.anEdge)}for(me(Mt.prev===Bt&&Mt.anEdge===null),Ht=mt,Ht=mt;(Ut=Ht.next)!==mt;Ht=Ut)me(Ut.Sym.next===Ht.Sym),me(Ut.Sym!==Ut),me(Ut.Sym.Sym===Ut),me(Ut.Org!==null),me(Ut.Dst!==null),me(Ut.Lnext.Onext.Sym===Ut),me(Ut.Onext.Sym.Lnext===Ut);me(Ut.Sym.next===Ht.Sym&&Ut.Sym===this.eHeadSym&&Ut.Sym.Sym===Ut&&Ut.Org===null&&Ut.Dst===null&&Ut.Lface===null&&Ut.Rface===null)},rt}(),mg=function(){function rt(){this.handle=null}return rt}(),yg=function(){function rt(){this.key=null,this.node=0}return rt}(),sP=function(){function rt(_,ut){this.leq=ut,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=_,this.nodes=[],this.handles=[];for(var mt=0;mt<_+1;mt++)this.nodes[mt]=new mg,this.handles[mt]=new yg;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return rt.prototype.floatDown_=function(_){var ut=this.nodes,mt=this.handles,bt,St,Mt;for(bt=ut[_].handle;;){if(Mt=_<<1,Mt<this.size&&this.leq(mt[ut[Mt+1].handle].key,mt[ut[Mt].handle].key)&&++Mt,me(Mt<=this.max),St=ut[Mt].handle,Mt>this.size||this.leq(mt[bt].key,mt[St].key)){ut[_].handle=bt,mt[bt].node=_;break}ut[_].handle=St,mt[St].node=_,_=Mt}},rt.prototype.floatUp_=function(_){var ut=this.nodes,mt=this.handles,bt,St,Mt;for(bt=ut[_].handle;;){if(Mt=_>>1,St=ut[Mt].handle,Mt===0||this.leq(mt[St].key,mt[bt].key)){ut[_].handle=bt,mt[bt].node=_;break}ut[_].handle=St,mt[St].node=_,_=Mt}},rt.prototype.init=function(){for(var _=this.size;_>=1;--_)this.floatDown_(_);this.initialized=!0},rt.prototype.min=function(){return this.handles[this.nodes[1].handle].key},rt.prototype.insert=function(_){var ut,mt;if(ut=++this.size,ut*2>this.max){this.max*=2;var bt,St;for(St=this.nodes.length,this.nodes.length=this.max+1,bt=St;bt<this.nodes.length;bt++)this.nodes[bt]=new mg;for(St=this.handles.length,this.handles.length=this.max+1,bt=St;bt<this.handles.length;bt++)this.handles[bt]=new yg}return this.freeList===0?mt=ut:(mt=this.freeList,this.freeList=this.handles[mt].node),this.nodes[ut].handle=mt,this.handles[mt].node=ut,this.handles[mt].key=_,this.initialized&&this.floatUp_(ut),mt},rt.prototype.extractMin=function(){var _=this.nodes,ut=this.handles,mt=_[1].handle,bt=ut[mt].key;return this.size>0&&(_[1].handle=_[this.size].handle,ut[_[1].handle].node=1,ut[mt].key=null,ut[mt].node=this.freeList,this.freeList=mt,--this.size,this.size>0&&this.floatDown_(1)),bt},rt.prototype.delete=function(_){var ut=this.nodes,mt=this.handles,bt;me(_>=1&&_<=this.max&&mt[_].key!==null),bt=mt[_].node,ut[bt].handle=ut[this.size].handle,mt[ut[bt].handle].node=bt,--this.size,bt<=this.size&&(bt<=1||this.leq(mt[ut[bt>>1].handle].key,mt[ut[bt].handle].key)?this.floatDown_(bt):this.floatUp_(bt)),mt[_].key=null,mt[_].node=this.freeList,this.freeList=_},rt}(),Ad=function(){function rt(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return rt}(),gg=function(){function rt(){this.key=null,this.next=null,this.prev=null}return rt}(),lP=function(){function rt(_,ut){this.frame=_,this.leq=ut,this.head=new gg,this.head.next=this.head,this.head.prev=this.head}return rt.prototype.min=function(){return this.head.next},rt.prototype.max=function(){return this.head.prev},rt.prototype.insert=function(_){return this.insertBefore(this.head,_)},rt.prototype.search=function(_){var ut=this.head;do ut=ut.next;while(ut.key!==null&&!this.leq(this.frame,_,ut.key));return ut},rt.prototype.insertBefore=function(_,ut){do _=_.prev;while(_.key!==null&&!this.leq(this.frame,_.key,ut));var mt=new gg;return mt.key=ut,mt.next=_.next,_.next.prev=mt,mt.prev=_,_.next=mt,mt},rt.prototype.delete=function(_){_.next.prev=_.prev,_.prev.next=_.next},rt}(),cP=function(){function rt(){}return rt.regionBelow=function(_){return _.nodeUp.prev.key},rt.regionAbove=function(_){return _.nodeUp.next.key},rt.debugEvent=function(_){},rt.addWinding=function(_,ut){_.winding+=ut.winding,_.Sym.winding+=ut.Sym.winding},rt.edgeLeq=function(_,ut,mt){var bt=_.event,St=ut.eUp,Mt=mt.eUp;if(St.Dst===bt)return Mt.Dst===bt?pe.vertLeq(St.Org,Mt.Org)?pe.edgeSign(Mt.Dst,St.Org,Mt.Org)<=0:pe.edgeSign(St.Dst,Mt.Org,St.Org)>=0:pe.edgeSign(Mt.Dst,bt,Mt.Org)<=0;if(Mt.Dst===bt)return pe.edgeSign(St.Dst,bt,St.Org)>=0;var Bt=pe.edgeEval(St.Dst,bt,St.Org),Ut=pe.edgeEval(Mt.Dst,bt,Mt.Org);return Bt>=Ut},rt.deleteRegion=function(_,ut){ut.fixUpperEdge&&me(ut.eUp.winding===0),ut.eUp.activeRegion=null,_.dict.delete(ut.nodeUp)},rt.fixUpperEdge=function(_,ut,mt){me(ut.fixUpperEdge),_.mesh.delete(ut.eUp),ut.fixUpperEdge=!1,ut.eUp=mt,mt.activeRegion=ut},rt.topLeftRegion=function(_,ut){var mt=ut.eUp.Org,bt;do ut=rt.regionAbove(ut);while(ut.eUp.Org===mt);if(ut.fixUpperEdge){if(bt=_.mesh.connect(rt.regionBelow(ut).eUp.Sym,ut.eUp.Lnext),bt===null)return null;rt.fixUpperEdge(_,ut,bt),ut=rt.regionAbove(ut)}return ut},rt.topRightRegion=function(_){var ut=_.eUp.Dst;do _=rt.regionAbove(_);while(_.eUp.Dst===ut);return _},rt.addRegionBelow=function(_,ut,mt){var bt=new Ad;return bt.eUp=mt,bt.nodeUp=_.dict.insertBefore(ut.nodeUp,bt),bt.fixUpperEdge=!1,bt.sentinel=!1,bt.dirty=!1,mt.activeRegion=bt,bt},rt.isWindingInside=function(_,ut){switch(_.windingRule){case Pe.ODD:return(ut&1)!==0;case Pe.NONZERO:return ut!==0;case Pe.POSITIVE:return ut>0;case Pe.NEGATIVE:return ut<0;case Pe.ABS_GEQ_TWO:return ut>=2||ut<=-2}throw new Error("Invalid winding rulle")},rt.computeWinding=function(_,ut){ut.windingNumber=rt.regionAbove(ut).windingNumber+ut.eUp.winding,ut.inside=rt.isWindingInside(_,ut.windingNumber)},rt.finishRegion=function(_,ut){var mt=ut.eUp,bt=mt.Lface;bt.inside=ut.inside,bt.anEdge=mt,rt.deleteRegion(_,ut)},rt.finishLeftRegions=function(_,ut,mt){for(var bt,St=null,Mt=ut,Bt=ut.eUp;Mt!==mt;){if(Mt.fixUpperEdge=!1,St=rt.regionBelow(Mt),bt=St.eUp,bt.Org!=Bt.Org){if(!St.fixUpperEdge){rt.finishRegion(_,Mt);break}bt=_.mesh.connect(Bt.Lprev,bt.Sym),rt.fixUpperEdge(_,St,bt)}Bt.Onext!==bt&&(_.mesh.splice(bt.Oprev,bt),_.mesh.splice(Bt,bt)),rt.finishRegion(_,Mt),Bt=St.eUp,Mt=St}return Bt},rt.addRightEdges=function(_,ut,mt,bt,St,Mt){var Bt,Ut,Ht,tr,rr=!0;Ht=mt;do me(pe.vertLeq(Ht.Org,Ht.Dst)),rt.addRegionBelow(_,ut,Ht.Sym),Ht=Ht.Onext;while(Ht!==bt);for(St===null&&(St=rt.regionBelow(ut).eUp.Rprev),Ut=ut,tr=St;Bt=rt.regionBelow(Ut),Ht=Bt.eUp.Sym,Ht.Org===tr.Org;)Ht.Onext!==tr&&(_.mesh.splice(Ht.Oprev,Ht),_.mesh.splice(tr.Oprev,Ht)),Bt.windingNumber=Ut.windingNumber-Ht.winding,Bt.inside=rt.isWindingInside(_,Bt.windingNumber),Ut.dirty=!0,!rr&&rt.checkForRightSplice(_,Ut)&&(rt.addWinding(Ht,tr),rt.deleteRegion(_,Ut),_.mesh.delete(tr)),rr=!1,Ut=Bt,tr=Ht;Ut.dirty=!0,me(Ut.windingNumber-Ht.winding===Bt.windingNumber),Mt&&rt.walkDirtyRegions(_,Ut)},rt.spliceMergeVertices=function(_,ut,mt){_.mesh.splice(ut,mt)},rt.vertexWeights=function(_,ut,mt){var bt=pe.vertL1dist(ut,_),St=pe.vertL1dist(mt,_),Mt=.5*St/(bt+St),Bt=.5*bt/(bt+St);_.coords[0]+=Mt*ut.coords[0]+Bt*mt.coords[0],_.coords[1]+=Mt*ut.coords[1]+Bt*mt.coords[1],_.coords[2]+=Mt*ut.coords[2]+Bt*mt.coords[2]},rt.getIntersectData=function(_,ut,mt,bt,St,Mt){ut.coords[0]=ut.coords[1]=ut.coords[2]=0,ut.idx=-1,rt.vertexWeights(ut,mt,bt),rt.vertexWeights(ut,St,Mt)},rt.checkForRightSplice=function(_,ut){var mt=rt.regionBelow(ut),bt=ut.eUp,St=mt.eUp;if(pe.vertLeq(bt.Org,St.Org)){if(pe.edgeSign(St.Dst,bt.Org,St.Org)>0)return!1;pe.vertEq(bt.Org,St.Org)?bt.Org!==St.Org&&(_.pq.delete(bt.Org.pqHandle),rt.spliceMergeVertices(_,St.Oprev,bt)):(_.mesh.splitEdge(St.Sym),_.mesh.splice(bt,St.Oprev),ut.dirty=mt.dirty=!0)}else{if(pe.edgeSign(bt.Dst,St.Org,bt.Org)<0)return!1;rt.regionAbove(ut).dirty=ut.dirty=!0,_.mesh.splitEdge(bt.Sym),_.mesh.splice(St.Oprev,bt)}return!0},rt.checkForLeftSplice=function(_,ut){var mt=rt.regionBelow(ut),bt=ut.eUp,St=mt.eUp,Mt;if(me(!pe.vertEq(bt.Dst,St.Dst)),pe.vertLeq(bt.Dst,St.Dst)){if(pe.edgeSign(bt.Dst,St.Dst,bt.Org)<0)return!1;rt.regionAbove(ut).dirty=ut.dirty=!0,Mt=_.mesh.splitEdge(bt),_.mesh.splice(St.Sym,Mt),Mt.Lface.inside=ut.inside}else{if(pe.edgeSign(St.Dst,bt.Dst,St.Org)>0)return!1;ut.dirty=mt.dirty=!0,Mt=_.mesh.splitEdge(St),_.mesh.splice(bt.Lnext,St.Sym),Mt.Rface.inside=ut.inside}return!0},rt.checkForIntersect=function(_,ut){var mt=rt.regionBelow(ut),bt=ut.eUp,St=mt.eUp,Mt=bt.Org,Bt=St.Org,Ut=bt.Dst,Ht=St.Dst,tr,rr,sr=new Wi,ar,cr;if(me(!pe.vertEq(Ht,Ut)),me(pe.edgeSign(Ut,_.event,Mt)<=0),me(pe.edgeSign(Ht,_.event,Bt)>=0),me(Mt!==_.event&&Bt!==_.event),me(!ut.fixUpperEdge&&!mt.fixUpperEdge),Mt===Bt||(tr=Math.min(Mt.t,Ut.t),rr=Math.max(Bt.t,Ht.t),tr>rr))return!1;if(pe.vertLeq(Mt,Bt)){if(pe.edgeSign(Ht,Mt,Bt)>0)return!1}else if(pe.edgeSign(Ut,Bt,Mt)<0)return!1;return rt.debugEvent(_),pe.intersect(Ut,Mt,Ht,Bt,sr),me(Math.min(Mt.t,Ut.t)<=sr.t),me(sr.t<=Math.max(Bt.t,Ht.t)),me(Math.min(Ht.s,Ut.s)<=sr.s),me(sr.s<=Math.max(Bt.s,Mt.s)),pe.vertLeq(sr,_.event)&&(sr.s=_.event.s,sr.t=_.event.t),ar=pe.vertLeq(Mt,Bt)?Mt:Bt,pe.vertLeq(ar,sr)&&(sr.s=ar.s,sr.t=ar.t),pe.vertEq(sr,Mt)||pe.vertEq(sr,Bt)?(rt.checkForRightSplice(_,ut),!1):!pe.vertEq(Ut,_.event)&&pe.edgeSign(Ut,_.event,sr)>=0||!pe.vertEq(Ht,_.event)&&pe.edgeSign(Ht,_.event,sr)<=0?Ht===_.event?(_.mesh.splitEdge(bt.Sym),_.mesh.splice(St.Sym,bt),ut=rt.topLeftRegion(_,ut),bt=rt.regionBelow(ut).eUp,rt.finishLeftRegions(_,rt.regionBelow(ut),mt),rt.addRightEdges(_,ut,bt.Oprev,bt,bt,!0),!0):Ut===_.event?(_.mesh.splitEdge(St.Sym),_.mesh.splice(bt.Lnext,St.Oprev),mt=ut,ut=rt.topRightRegion(ut),cr=rt.regionBelow(ut).eUp.Rprev,mt.eUp=St.Oprev,St=rt.finishLeftRegions(_,mt,null),rt.addRightEdges(_,ut,St.Onext,bt.Rprev,cr,!0),!0):(pe.edgeSign(Ut,_.event,sr)>=0&&(rt.regionAbove(ut).dirty=ut.dirty=!0,_.mesh.splitEdge(bt.Sym),bt.Org.s=_.event.s,bt.Org.t=_.event.t),pe.edgeSign(Ht,_.event,sr)<=0&&(ut.dirty=mt.dirty=!0,_.mesh.splitEdge(St.Sym),St.Org.s=_.event.s,St.Org.t=_.event.t),!1):(_.mesh.splitEdge(bt.Sym),_.mesh.splitEdge(St.Sym),_.mesh.splice(St.Oprev,bt),bt.Org.s=sr.s,bt.Org.t=sr.t,bt.Org.pqHandle=_.pq.insert(bt.Org),rt.getIntersectData(_,bt.Org,Mt,Ut,Bt,Ht),rt.regionAbove(ut).dirty=ut.dirty=mt.dirty=!0,!1)},rt.walkDirtyRegions=function(_,ut){for(var mt=rt.regionBelow(ut),bt,St;;){for(;mt.dirty;)ut=mt,mt=rt.regionBelow(mt);if(!ut.dirty&&(mt=ut,ut=rt.regionAbove(ut),ut===null||!ut.dirty))return;if(ut.dirty=!1,bt=ut.eUp,St=mt.eUp,bt.Dst!==St.Dst&&rt.checkForLeftSplice(_,ut)&&(mt.fixUpperEdge?(rt.deleteRegion(_,mt),_.mesh.delete(St),mt=rt.regionBelow(ut),St=mt.eUp):ut.fixUpperEdge&&(rt.deleteRegion(_,ut),_.mesh.delete(bt),ut=rt.regionAbove(mt),bt=ut.eUp)),bt.Org!==St.Org)if(bt.Dst!==St.Dst&&!ut.fixUpperEdge&&!mt.fixUpperEdge&&(bt.Dst===_.event||St.Dst===_.event)){if(rt.checkForIntersect(_,ut))return}else rt.checkForRightSplice(_,ut);bt.Org===St.Org&&bt.Dst===St.Dst&&(rt.addWinding(St,bt),rt.deleteRegion(_,ut),_.mesh.delete(bt),ut=rt.regionAbove(mt))}},rt.connectRightVertex=function(_,ut,mt){var bt,St=mt.Onext,Mt=rt.regionBelow(ut),Bt=ut.eUp,Ut=Mt.eUp,Ht=!1;if(Bt.Dst!==Ut.Dst&&rt.checkForIntersect(_,ut),pe.vertEq(Bt.Org,_.event)&&(_.mesh.splice(St.Oprev,Bt),ut=rt.topLeftRegion(_,ut),St=rt.regionBelow(ut).eUp,rt.finishLeftRegions(_,rt.regionBelow(ut),Mt),Ht=!0),pe.vertEq(Ut.Org,_.event)&&(_.mesh.splice(mt,Ut.Oprev),mt=rt.finishLeftRegions(_,Mt,null),Ht=!0),Ht){rt.addRightEdges(_,ut,mt.Onext,St,St,!0);return}pe.vertLeq(Ut.Org,Bt.Org)?bt=Ut.Oprev:bt=Bt,bt=_.mesh.connect(mt.Lprev,bt),rt.addRightEdges(_,ut,bt,bt.Onext,bt.Onext,!1),bt.Sym.activeRegion.fixUpperEdge=!0,rt.walkDirtyRegions(_,ut)},rt.connectLeftDegenerate=function(_,ut,mt){var bt,St,Mt,Bt,Ut;if(bt=ut.eUp,pe.vertEq(bt.Org,mt)){me(!1),rt.spliceMergeVertices(_,bt,mt.anEdge);return}if(!pe.vertEq(bt.Dst,mt)){_.mesh.splitEdge(bt.Sym),ut.fixUpperEdge&&(_.mesh.delete(bt.Onext),ut.fixUpperEdge=!1),_.mesh.splice(mt.anEdge,bt),rt.sweepEvent(_,mt);return}me(!1),ut=rt.topRightRegion(ut),Ut=rt.regionBelow(ut),Mt=Ut.eUp.Sym,St=Bt=Mt.Onext,Ut.fixUpperEdge&&(me(St!==Mt),rt.deleteRegion(_,Ut),_.mesh.delete(Mt),Mt=St.Oprev),_.mesh.splice(mt.anEdge,Mt),pe.edgeGoesLeft(St)||(St=null),rt.addRightEdges(_,ut,Mt.Onext,Bt,St,!0)},rt.connectLeftVertex=function(_,ut){var mt,bt,St,Mt,Bt,Ut,Ht=new Ad;if(Ht.eUp=ut.anEdge.Sym,mt=_.dict.search(Ht).key,bt=rt.regionBelow(mt),!!bt){if(Mt=mt.eUp,Bt=bt.eUp,pe.edgeSign(Mt.Dst,ut,Mt.Org)===0){rt.connectLeftDegenerate(_,mt,ut);return}if(St=pe.vertLeq(Bt.Dst,Mt.Dst)?mt:bt,mt.inside||St.fixUpperEdge){if(St===mt)Ut=_.mesh.connect(ut.anEdge.Sym,Mt.Lnext);else{var tr=_.mesh.connect(Bt.Dnext,ut.anEdge);Ut=tr.Sym}St.fixUpperEdge?rt.fixUpperEdge(_,St,Ut):rt.computeWinding(_,rt.addRegionBelow(_,mt,Ut)),rt.sweepEvent(_,ut)}else rt.addRightEdges(_,mt,ut.anEdge,ut.anEdge,null,!0)}},rt.sweepEvent=function(_,ut){_.event=ut,rt.debugEvent(_);for(var mt=ut.anEdge;mt.activeRegion===null;)if(mt=mt.Onext,mt===ut.anEdge){rt.connectLeftVertex(_,ut);return}var bt=rt.topLeftRegion(_,mt.activeRegion);me(bt!==null);var St=rt.regionBelow(bt),Mt=St.eUp,Bt=rt.finishLeftRegions(_,St,null);Bt.Onext===Mt?rt.connectRightVertex(_,bt,Bt):rt.addRightEdges(_,bt,Bt.Onext,Mt,Mt,!0)},rt.addSentinel=function(_,ut,mt,bt){var St=new Ad,Mt=_.mesh.makeEdge();Mt.Org.s=mt,Mt.Org.t=bt,Mt.Dst.s=ut,Mt.Dst.t=bt,_.event=Mt.Dst,St.eUp=Mt,St.windingNumber=0,St.inside=!1,St.fixUpperEdge=!1,St.sentinel=!0,St.dirty=!1,St.nodeUp=_.dict.insert(St)},rt.initEdgeDict=function(_){_.dict=new lP(_,rt.edgeLeq);var ut=_.bmax[0]-_.bmin[0],mt=_.bmax[1]-_.bmin[1],bt=_.bmin[0]-ut,St=_.bmax[0]+ut,Mt=_.bmin[1]-mt,Bt=_.bmax[1]+mt;rt.addSentinel(_,bt,St,Mt),rt.addSentinel(_,bt,St,Bt)},rt.doneEdgeDict=function(_){for(var ut,mt=0;(ut=_.dict.min().key)!==null;)ut.sentinel||(me(ut.fixUpperEdge),me(++mt===1)),me(ut.windingNumber===0),rt.deleteRegion(_,ut)},rt.removeDegenerateEdges=function(_){var ut,mt,bt,St=_.mesh.eHead;for(ut=St.next;ut!==St;ut=mt)mt=ut.next,bt=ut.Lnext,pe.vertEq(ut.Org,ut.Dst)&&ut.Lnext.Lnext!==ut&&(rt.spliceMergeVertices(_,bt,ut),_.mesh.delete(ut),ut=bt,bt=ut.Lnext),bt.Lnext===ut&&(bt!==ut&&((bt===mt||bt===mt.Sym)&&(mt=mt.next),_.mesh.delete(bt)),(ut===mt||ut===mt.Sym)&&(mt=mt.next),_.mesh.delete(ut))},rt.initPriorityQ=function(_){var ut,mt,bt,St=0;for(bt=_.mesh.vHead,mt=bt.next;mt!==bt;mt=mt.next)St++;for(St+=8,ut=_.pq=new sP(St,pe.vertLeq),bt=_.mesh.vHead,mt=bt.next;mt!==bt;mt=mt.next)mt.pqHandle=ut.insert(mt);return mt!==bt?!1:(ut.init(),!0)},rt.donePriorityQ=function(_){_.pq=null},rt.removeDegenerateFaces=function(_,ut){var mt,bt,St;for(mt=ut.fHead.next;mt!==ut.fHead;mt=bt)bt=mt.next,St=mt.anEdge,me(St.Lnext!==St),St.Lnext.Lnext===St&&(rt.addWinding(St.Onext,St),_.mesh.delete(St));return!0},rt.computeInterior=function(_,ut){ut===void 0&&(ut=!0);var mt,bt;if(rt.removeDegenerateEdges(_),!rt.initPriorityQ(_))return!1;for(rt.initEdgeDict(_);(mt=_.pq.extractMin())!==null;){for(;bt=_.pq.min(),!(bt===null||!pe.vertEq(bt,mt));)bt=_.pq.extractMin(),rt.spliceMergeVertices(_,mt.anEdge,bt.anEdge);rt.sweepEvent(_,mt)}return _.event=_.dict.min().key.eUp.Org,rt.debugEvent(_),rt.doneEdgeDict(_),rt.donePriorityQ(_),rt.removeDegenerateFaces(_,_.mesh)?(ut&&_.mesh.check(),!0):!1},rt}(),uP=function(){function rt(){this.mesh=new hg,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Pe.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return rt.prototype.dot_=function(_,ut){return _[0]*ut[0]+_[1]*ut[1]+_[2]*ut[2]},rt.prototype.normalize_=function(_){var ut=_[0]*_[0]+_[1]*_[1]+_[2]*_[2];if(!ut)throw"Zero-size vector!";ut=Math.sqrt(ut),_[0]/=ut,_[1]/=ut,_[2]/=ut},rt.prototype.longAxis_=function(_){var ut=0;return Math.abs(_[1])>Math.abs(_[0])&&(ut=1),Math.abs(_[2])>Math.abs(_[ut])&&(ut=2),ut},rt.prototype.computeNormal_=function(_){var ut,mt,bt,St,Mt,Bt,Ut=[0,0,0],Ht=[0,0,0],tr=[0,0,0],rr=[0,0,0],sr=[0,0,0],ar=[null,null,null],cr=[null,null,null],Ar=this.mesh.vHead;ut=Ar.next;for(var _r=0;_r<3;++_r)St=ut.coords[_r],Ht[_r]=St,cr[_r]=ut,Ut[_r]=St,ar[_r]=ut;for(ut=Ar.next;ut!==Ar;ut=ut.next)for(var Dr=0;Dr<3;++Dr)St=ut.coords[Dr],St<Ht[Dr]&&(Ht[Dr]=St,cr[Dr]=ut),St>Ut[Dr]&&(Ut[Dr]=St,ar[Dr]=ut);var $r=0;if(Ut[1]-Ht[1]>Ut[0]-Ht[0]&&($r=1),Ut[2]-Ht[2]>Ut[$r]-Ht[$r]&&($r=2),Ht[$r]>=Ut[$r]){_[0]=0,_[1]=0,_[2]=1;return}for(Bt=0,mt=cr[$r],bt=ar[$r],tr[0]=mt.coords[0]-bt.coords[0],tr[1]=mt.coords[1]-bt.coords[1],tr[2]=mt.coords[2]-bt.coords[2],ut=Ar.next;ut!==Ar;ut=ut.next)rr[0]=ut.coords[0]-bt.coords[0],rr[1]=ut.coords[1]-bt.coords[1],rr[2]=ut.coords[2]-bt.coords[2],sr[0]=tr[1]*rr[2]-tr[2]*rr[1],sr[1]=tr[2]*rr[0]-tr[0]*rr[2],sr[2]=tr[0]*rr[1]-tr[1]*rr[0],Mt=sr[0]*sr[0]+sr[1]*sr[1]+sr[2]*sr[2],Mt>Bt&&(Bt=Mt,_[0]=sr[0],_[1]=sr[1],_[2]=sr[2]);Bt<=0&&(_[0]=_[1]=_[2]=0,_[this.longAxis_(tr)]=1)},rt.prototype.checkOrientation_=function(){for(var _=this.mesh.fHead,ut,mt=this.mesh.vHead,bt,St=0,Mt=_.next;Mt!==_;Mt=Mt.next)if(bt=Mt.anEdge,!(bt.winding<=0))do St+=(bt.Org.s-bt.Dst.s)*(bt.Org.t+bt.Dst.t),bt=bt.Lnext;while(bt!==Mt.anEdge);if(St<0){for(ut=mt.next;ut!==mt;ut=ut.next)ut.t=-ut.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},rt.prototype.projectPolygon_=function(){var _=this.mesh.vHead,ut=[0,0,0],mt,bt,St=!1;ut[0]=this.normal[0],ut[1]=this.normal[1],ut[2]=this.normal[2],!ut[0]&&!ut[1]&&!ut[2]&&(this.computeNormal_(ut),St=!0),mt=this.sUnit,bt=this.tUnit;var Mt=this.longAxis_(ut);mt[Mt]=0,mt[(Mt+1)%3]=1,mt[(Mt+2)%3]=0,bt[Mt]=0,bt[(Mt+1)%3]=0,bt[(Mt+2)%3]=ut[Mt]>0?1:-1;for(var Bt=_.next;Bt!==_;Bt=Bt.next)Bt.s=this.dot_(Bt.coords,mt),Bt.t=this.dot_(Bt.coords,bt);St&&this.checkOrientation_();for(var Ut=!0,Ht=_.next;Ht!==_;Ht=Ht.next)Ut?(this.bmin[0]=this.bmax[0]=Ht.s,this.bmin[1]=this.bmax[1]=Ht.t,Ut=!1):(Ht.s<this.bmin[0]&&(this.bmin[0]=Ht.s),Ht.s>this.bmax[0]&&(this.bmax[0]=Ht.s),Ht.t<this.bmin[1]&&(this.bmin[1]=Ht.t),Ht.t>this.bmax[1]&&(this.bmax[1]=Ht.t))},rt.prototype.addWinding_=function(_,ut){_.winding+=ut.winding,_.Sym.winding+=ut.Sym.winding},rt.prototype.tessellateMonoRegion_=function(_,ut){var mt,bt;if(mt=ut.anEdge,!(mt.Lnext!==mt&&mt.Lnext.Lnext!==mt))throw"Mono region invalid";for(;pe.vertLeq(mt.Dst,mt.Org);mt=mt.Lprev);for(;pe.vertLeq(mt.Org,mt.Dst);mt=mt.Lnext);bt=mt.Lprev;for(var St=void 0;mt.Lnext!==bt;)if(pe.vertLeq(mt.Dst,bt.Org)){for(;bt.Lnext!==mt&&(pe.edgeGoesLeft(bt.Lnext)||pe.edgeSign(bt.Org,bt.Dst,bt.Lnext.Dst)<=0);)St=_.connect(bt.Lnext,bt),bt=St.Sym;bt=bt.Lprev}else{for(;bt.Lnext!==mt&&(pe.edgeGoesRight(mt.Lprev)||pe.edgeSign(mt.Dst,mt.Org,mt.Lprev.Org)>=0);)St=_.connect(mt,mt.Lprev),mt=St.Sym;mt=mt.Lnext}if(bt.Lnext===mt)throw"Mono region invalid";for(;bt.Lnext.Lnext!==mt;)St=_.connect(bt.Lnext,bt),bt=St.Sym;return!0},rt.prototype.tessellateInterior_=function(_){for(var ut,mt=_.fHead.next;mt!==_.fHead;mt=ut)if(ut=mt.next,mt.inside&&!this.tessellateMonoRegion_(_,mt))return!1;return!0},rt.prototype.discardExterior_=function(_){for(var ut,mt=_.fHead.next;mt!==_.fHead;mt=ut)ut=mt.next,mt.inside||_.zapFace(mt)},rt.prototype.setWindingNumber_=function(_,ut,mt){for(var bt,St=_.eHead.next;St!==_.eHead;St=bt)bt=St.next,St.Rface.inside!==St.Lface.inside?St.winding=St.Lface.inside?ut:-ut:mt?_.delete(St):St.winding=0},rt.prototype.getNeighbourFace_=function(_){return!_.Rface||!_.Rface.inside?-1:_.Rface.n},rt.prototype.outputPolymesh_=function(_,ut,mt,bt){var St,Mt=0,Bt=0,Ut;mt>3&&_.mergeConvexFaces(mt);for(var Ht=_.vHead.next;Ht!==_.vHead;Ht=Ht.next)Ht.n=-1;for(var tr=_.fHead.next;tr!==_.fHead;tr=tr.next)if(tr.n=-1,!!tr.inside){St=tr.anEdge,Ut=0;do{var Ht=St.Org;Ht.n===-1&&(Ht.n=Bt,Bt++),Ut++,St=St.Lnext}while(St!==tr.anEdge);if(Ut>mt)throw"Face vertex greater that support polygon";tr.n=Mt,++Mt}this.elementCount=Mt,ut===Xe.CONNECTED_POLYGONS&&(Mt*=2),this.elements=[],this.elements.length=Mt*mt,this.vertexCount=Bt,this.vertices=[],this.vertices.length=Bt*bt,this.vertexIndices=[],this.vertexIndices.length=Bt;for(var Ht=_.vHead.next;Ht!==_.vHead;Ht=Ht.next)if(Ht.n!==-1){var rr=Ht.n*bt;this.vertices[rr+0]=Ht.coords[0],this.vertices[rr+1]=Ht.coords[1],bt>2&&(this.vertices[rr+2]=Ht.coords[2]),this.vertexIndices[Ht.n]=Ht.idx}for(var sr=0,tr=_.fHead.next;tr!==_.fHead;tr=tr.next)if(tr.inside){St=tr.anEdge,Ut=0;do{var Ht=St.Org;this.elements[sr++]=Ht.n,Ut++,St=St.Lnext}while(St!==tr.anEdge);for(var ar=Ut;ar<mt;++ar)this.elements[sr++]=-1;if(ut===Xe.CONNECTED_POLYGONS){St=tr.anEdge;do this.elements[sr++]=this.getNeighbourFace_(St),St=St.Lnext;while(St!==tr.anEdge);for(var cr=Ut;cr<mt;++cr)this.elements[sr++]=-1}}},rt.prototype.outputContours_=function(_,ut){var mt,bt,St=0,Mt=0;this.vertexCount=0,this.elementCount=0;for(var Bt=_.fHead.next;Bt!==_.fHead;Bt=Bt.next)if(Bt.inside){bt=mt=Bt.anEdge;do this.vertexCount++,mt=mt.Lnext;while(mt!==bt);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*ut,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var Ut=0,Ht=0,tr=0;St=0;for(var Bt=_.fHead.next;Bt!==_.fHead;Bt=Bt.next)if(Bt.inside){Mt=0,bt=mt=Bt.anEdge;do this.vertices[Ut++]=mt.Org.coords[0],this.vertices[Ut++]=mt.Org.coords[1],ut>2&&(this.vertices[Ut++]=mt.Org.coords[2]),this.vertexIndices[Ht++]=this.vertexIdCallback?this.vertexIdCallback(mt):mt.Org.idx,Mt++,mt=mt.Lnext;while(mt!==bt);this.elements[tr++]=St,this.elements[tr++]=Mt,St+=Mt}},rt.prototype.addContour=function(_,ut){this.mesh===null&&(this.mesh=new hg),_<2&&(_=2),_>3&&(_=3);for(var mt=null,bt=0;bt<ut.length;bt+=_)mt===null?(mt=this.mesh.makeEdge(),this.mesh.splice(mt,mt.Sym)):(this.mesh.splitEdge(mt),mt=mt.Lnext),mt.Org.coords[0]=ut[bt+0],mt.Org.coords[1]=ut[bt+1],_>2?mt.Org.coords[2]=ut[bt+2]:mt.Org.coords[2]=0,mt.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(mt),mt.winding=1,mt.Sym.winding=-1},rt.prototype.tesselate=function(_,ut,mt,bt,St,Mt){if(_===void 0&&(_=Pe.ODD),ut===void 0&&(ut=Xe.POLYGONS),Mt===void 0&&(Mt=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,St&&(this.normal[0]=St[0],this.normal[1]=St[1],this.normal[2]=St[2]),this.windingRule=_,bt<2&&(bt=2),bt>3&&(bt=3),!this.mesh)return!1;this.projectPolygon_(),cP.computeInterior(this,Mt);var Bt=this.mesh;return ut===Xe.BOUNDARY_CONTOURS?this.setWindingNumber_(Bt,1,!0):this.tessellateInterior_(Bt),Mt&&Bt.check(),ut===Xe.BOUNDARY_CONTOURS?this.outputContours_(Bt,bt):this.outputPolymesh_(Bt,ut,mt,bt),!0},rt}();function Cr(rt){var _=rt.windingRule,ut=_===void 0?Pe.ODD:_,mt=rt.elementType,bt=mt===void 0?Xe.POLYGONS:mt,St=rt.polySize,Mt=St===void 0?3:St,Bt=rt.vertexSize,Ut=Bt===void 0?2:Bt,Ht=rt.normal,tr=Ht===void 0?[0,0,1]:Ht,rr=rt.contours,sr=rr===void 0?[]:rr,ar=rt.strict,cr=ar===void 0?!0:ar,Ar=rt.debug,_r=Ar===void 0?!1:Ar;if(!sr&&cr)throw new Error("Contours can't be empty");if(sr){var Dr=new uP;rt.edgeCreateCallback&&(Dr.edgeCreateCallback=rt.edgeCreateCallback),rt.vertexIdCallback&&(Dr.vertexIdCallback=rt.vertexIdCallback);for(var $r=0;$r<sr.length;$r++)Dr.addContour(Ut||2,sr[$r]);return Dr.tesselate(ut,bt,Mt,Ut,tr,cr),{vertices:Dr.vertices,vertexIndices:Dr.vertexIndices,vertexCount:Dr.vertexCount,elements:Dr.elements,elementCount:Dr.elementCount,mesh:_r?Dr.mesh:void 0}}}Pe.ODD;Pe.NONZERO;Pe.POSITIVE;Pe.NEGATIVE;Pe.ABS_GEQ_TWO;Xe.POLYGONS;Xe.CONNECTED_POLYGONS;Xe.BOUNDARY_CONTOURS;var fc=class{constructor(rt=256,_=!1){this.capacity=rt,this.size=0,this.debug=_,this.debug&&console.log(`allocating with cap ${rt}`);let ut=rt*fc.eSize;this.buffer=new ArrayBuffer(ut);let mt=Float32Array.BYTES_PER_ELEMENT,bt=0;this.positions=new Float32Array(this.buffer,bt*mt,3*rt),bt+=3*rt,this.normals=new Float32Array(this.buffer,bt*mt,3*rt),bt+=3*rt,this.uvs=new Float32Array(this.buffer,bt*mt,2*rt)}realloc(rt,_=!1){if(rt<this.size)throw Error("cannot shrink buffer");if(rt<=this.capacity&&!_)return;this.debug&&console.log(`resizing from ${this.capacity} → ${rt}`);let ut=rt*fc.eSize,mt=new ArrayBuffer(ut),bt=Float32Array.BYTES_PER_ELEMENT,St=0,Mt=new Float32Array(mt,St*bt,3*rt);St+=3*rt;let Bt=new Float32Array(mt,St*bt,3*rt);St+=3*rt;let Ut=new Float32Array(mt,St*bt,2*rt);_?(Mt.set(this.positions.subarray(0,this.size*3)),Bt.set(this.normals.subarray(0,this.size*3)),Ut.set(this.uvs.subarray(0,this.size*2))):(Mt.set(this.positions),Bt.set(this.normals),Ut.set(this.uvs)),this.buffer=mt,this.positions=Mt,this.normals=Bt,this.uvs=Ut,this.capacity=rt}get(rt=1){let _=this.size+rt;if(_>this.capacity){let mt=this.capacity;for(;_>mt;)mt*=2;this.realloc(mt)}let ut=this.size;return this.size=_,ut}reserve(rt){let _=this.size+rt;_>this.capacity&&this.realloc(_)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},hs=fc;hs.eSize=8*Float32Array.BYTES_PER_ELEMENT;var Sg=Rt(bg()),ms={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},Md={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},Id={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},Od=(rt,_)=>([ut,mt])=>(mt<ut&&(mt+=_),(rt>=ut?rt:rt+_)<=mt),tn=class extends BufferGeometry{constructor(rt,_,ut=0,mt=12,bt=3,St=Pe.ODD,Mt=!1){super(),this.forPathBevel=Mt,this.type="ShapeGeometry",this.vertexCache={},this._shape=rt,this._depth=_,this._curveSegments=mt,this._bevelSegmentsInput=bt;let Bt=this._shape.extractShapePointsToFlatArray([],mt),Ut=this._shape.shapeHoles.map(In=>{let Rn=In.extractShapePointsToFlatArray([],mt),qn=[];for(let Qn=Rn.length-1;Qn>=1;Qn-=2){let xs=Rn[Qn-1],cs=Rn[Qn-0];qn.push(xs,cs)}return qn}),Ht=[],tr=[];for(let In=0;In<Bt.length;In+=2)tr.push([Bt[In],Bt[In+1]]);Ht.push(tr);for(let In=0;In<Ut.length;In++){let Rn=Ut[In],qn=[];for(let Qn=0;Qn<Rn.length;Qn+=2)qn.push([Rn[Qn],Rn[Qn+1]]);Ht.push(qn)}let rr;rt.isText?rr=new Box2().setFromPoints(rt.points.map(In=>In.position)).getSize(new Vector2).length()*.1:Ht[0].length===0?rr=ut:rr=(0,Sg.default)(Ht).distance,ut<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(ut,rr,_/2),this._bevelSegments=Math.floor(bt));let sr;try{sr=Cr({windingRule:St,elementType:Xe.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[Bt]})}catch{sr=ms}let ar;try{ar=Cr({windingRule:Pe.ODD,elementType:Xe.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...Ut]})}catch{ar=Md}if(!sr)throw new Error("error generating geometry");let cr=sr.elementCount;if(ar){sr.elementCount+=ar.elementCount;for(let In=0;In<ar.elements.length;In++){let Rn=ar.elements[In],qn=In%2===0?sr.vertexCount:0;sr.elements.push(Rn+qn)}for(let In=0;In<ar.vertexIndices.length;In++){let Rn=ar.vertexIndices[In],qn=sr.vertexCount;sr.vertexIndices.push(Rn+qn)}for(let In=0;In<ar.vertices.length;In++){let Rn=ar.vertices[In];sr.vertices.push(Rn)}}let Ar=1/0,_r=-1/0,Dr=1/0,$r=-1/0;for(let In=0,Rn=sr.vertexCount;In<Rn;In++){let qn=In*2,Qn=sr.vertices[qn+0],xs=sr.vertices[qn+1];Qn<Ar&&(Ar=Qn),Qn>_r&&(_r=Qn),xs<Dr&&(Dr=xs),xs>$r&&($r=xs)}this._minX=Ar,this._minY=Dr,this._width=_r-Ar,this._height=$r-Dr,this._buffer=new hs(this._computeBufferEstimatedSize(sr));let Br=[],Jr=[];for(let In=sr.elementCount-1;In>=0;In--){let Rn=In>=cr,qn=In*2,Qn=sr.elements[qn+0],xs=sr.elements[qn+1],cs=Qn+xs,ks={start:Qn,count:xs,normals:[],continuous:[],concave:[]},_o=Qn,qs=cs-1,Ss=Qn+1,eo=this._shape.roundedCurves.length;do{let cu=_o-Qn,Jl=sr.vertices[qs*2+0],mu=sr.vertices[qs*2+1],pu=sr.vertices[_o*2+0],Zu=sr.vertices[_o*2+1],Mp=sr.vertices[Ss*2+0],Up=sr.vertices[Ss*2+1],Ep=pu-Jl,mp=Zu-mu,Cp=Math.sqrt(Ep*Ep+mp*mp);Ep/=Cp,mp/=Cp;let t0=pu-Mp,_g=Zu-Up,m0=Math.sqrt(t0*t0+_g*_g);t0/=m0,_g/=m0,ks.normals[cu*2+0]=-_g,ks.normals[cu*2+1]=t0,ks.concave[cu]=Ep*_g-mp*t0>0;let K0=sr.vertexIndices[_o];if(Array.isArray(K0))ks.continuous[cu]=!1;else{let[Jp,y0]=this._shape.getCurveIndexFromVertexId(K0-1,!0);if(y0>0&&y0<1)ks.continuous[cu]=!0;else{let z0=y0===1?Jp+1:Jp-1;z0=(z0+eo)%eo;let jm=y0===1?0:1,Nu=this._shape.roundedCurves[Jp].getTangent(y0),Co=this._shape.roundedCurves[z0].getTangent(jm);ks.continuous[cu]=Nu.dot(Co)>.95}}Rn&&(ks.normals[cu*2+0]*=-1,ks.normals[cu*2+1]*=-1),[qs,_o,Ss]=[_o,Ss,Ss+1],Ss>=cs&&(Ss-=xs)}while(Ss!==Qn+1);let Ao=[];Ao.push({bevelI:0,angle:0,size:0,boundary:{vertices:sr.vertices.slice(Qn*2,cs*2),vertexCount:xs,vertexIndices:new Array(xs).fill(!0).map((cu,Jl)=>[Jl,Jl]),elements:[0,xs],elementCount:1,mesh:null},reverseMap:[],insetPoints:sr.vertices.slice(Qn*2,cs*2)});let Oo=0;for(let cu=1;cu<=this._bevelSegments;cu++){let Jl=cu/this._bevelSegments*Math.PI/2,mu=(1-Math.cos(Jl))*this._bevel,pu=[],Zu=[],Mp=0;for(let Ep=0;Ep<xs;Ep++){let mp=Ep*2,Cp=(Ep-1+xs)%xs*2,t0=sr.vertices[ks.start*2+mp+0],_g=sr.vertices[ks.start*2+mp+1],m0=-ks.normals[Cp+0]*mu,K0=-ks.normals[Cp+1]*mu,Jp=-ks.normals[mp+0]*mu,y0=-ks.normals[mp+1]*mu;if(ks.concave[Ep]||!ks.concave[Ep]&&Rn){let z0=Math.atan2(K0,m0),jm=Math.atan2(y0,Jp);jm>z0&&(jm-=Math.PI*2);let Nu=jm-z0;if(ks.continuous[Ep]||Rn){let Co=z0+Nu/2,Bp=Math.cos(Co)*mu,a0=Math.sin(Co)*mu;pu[2*Mp+0]=t0+Bp*(Rn?-1:1),pu[2*Mp+1]=_g+a0*(Rn?-1:1),Zu[Mp]=Ep,Mp++}else{let Co=Math.max(1,Math.floor(mt/4*Math.abs(Nu)/Math.PI));for(let Bp=0;Bp<=Co;Bp++){let a0=z0+Nu*(Bp/Co),Q0=Math.cos(a0)*mu,T0=Math.sin(a0)*mu;pu[2*Mp+0]=t0+Q0,pu[2*Mp+1]=_g+T0,Zu[Mp]=Ep,Mp++}}}else pu[2*Mp+0]=t0+m0,pu[2*Mp+1]=_g+K0,Zu[Mp]=Ep,Mp++,pu[2*Mp+0]=t0,pu[2*Mp+1]=_g,Zu[Mp]=Ep,Mp++,pu[2*Mp+0]=t0+Jp,pu[2*Mp+1]=_g+y0,Zu[Mp]=Ep,Mp++}let Up=Cr({windingRule:Pe.POSITIVE,elementType:Xe.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[pu],edgeCreateCallback:Ep=>{let mp=Ep.Org.idx,Cp=Zu[mp],t0=Zu[(mp+1)%Zu.length];Ep.idx=[Cp,t0],Ep.Sym.idx=[t0,Cp]},vertexIdCallback:Ep=>{let mp=Ep.Lprev.idx;return[mp?mp[1]:0,Ep.idx?Ep.idx[0]:0]}});if(!Up)throw console.log("Error"),new Error(`error generating bevel geometry for ${cu}'th loop`);if(!Up.vertexCount){let Ep=(cu-1)/this._bevelSegments*Math.PI/2;Oo=(1-Math.sin(Ep))*this._bevel;break}for(let Ep=0;Ep<Up.vertexIndices.length;Ep++){let[mp,Cp]=Up.vertexIndices[Ep];if(mp===Cp)continue;let t0=Cp;Cp<mp&&(t0+=xs);for(let _g=mp;_g<t0;_g++){let m0=_g%xs,K0=(_g+1)%xs;if(!ks.continuous[m0]||!ks.continuous[K0]){Up.vertexIndices[Ep]=[mp,m0],Up.vertexIndices.splice(Ep+1,0,[K0,Cp]),Up.vertices.splice((Ep+1)*2,0,Up.vertices[Ep*2],Up.vertices[Ep*2+1]);break}}}Ao.push({bevelI:cu,angle:Jl,size:mu,boundary:Up,reverseMap:Zu,insetPoints:pu})}let uo=(cu,Jl,mu)=>{let pu=0,Zu=cu.boundary.vertexIndices.length;for(;pu<Zu&&mu(cu.boundary.vertexIndices[Jl]);)Jl=(Jl+1)%Zu,pu++;return pu},uu=Br.length;for(let cu=1;cu<Ao.length;cu++){let Jl=Ao[cu-1],mu=Ao[cu],pu=Jl.boundary.vertexIndices.length,Zu=mu.boundary.vertexIndices.length;if(!pu||!Zu)break;let Mp=ks.concave.length,Up=0,Ep=Od(Up,xs);for(;!Jl.boundary.vertexIndices.filter(Ep).length||!mu.boundary.vertexIndices.filter(Ep).length;)Up++,Ep=Od(Up,xs);let mp=Jl.boundary.vertexIndices.findIndex(Ep),Cp=mu.boundary.vertexIndices.findIndex(Ep);do mp=(mp+1)%pu;while(Ep(Jl.boundary.vertexIndices[mp]));do Cp=(Cp+1)%Zu;while(Ep(mu.boundary.vertexIndices[Cp]));Up=(Up+1)%xs;let t0=Up,_g=0,m0=this._buildBevelVert(ks,Jl,(mp-1+pu)%pu,void 0,_g),K0=this._buildBevelVert(ks,mu,(Cp-1+Zu)%Zu,void 0,_g),Jp=m0,y0=K0,z0,jm,Nu=!1;do{_g=(Up||Mp)/Mp,Ep=Od(Up,xs);let Co=uo(Jl,mp,Ep),Bp=uo(mu,Cp,Ep),a0=Nu;if(Nu=!1,Co&&!Bp){for(let Q0=0;Q0<Co;Q0++)z0=this._buildBevelVert(ks,Jl,(mp+Q0)%pu,Q0/(Co-1),_g),Br.push(Jp.topN,z0.topP,y0.topN),Mt===!1&&Br.push(z0.bottomP,Jp.bottomN,y0.bottomN),Jp=z0;Nu=!0}else if(!Co&&Bp)for(let Q0=0;Q0<Bp;Q0++)jm=this._buildBevelVert(ks,mu,(Cp+Q0)%Zu,Q0/(Bp-1),_g),Br.push(y0.topN,Jp.topP,jm.topP),Mt===!1&&Br.push(Jp.bottomP,y0.bottomN,jm.bottomP),y0=jm;else if(Co&&Bp)if(z0=this._buildBevelVert(ks,Jl,mp,0,_g),jm=this._buildBevelVert(ks,mu,Cp,0,_g),a0?(Br.push(Jp.topN,jm.topP,y0.topN),Br.push(Jp.topN,z0.topP,jm.topP),Mt===!1&&(Br.push(jm.bottomP,Jp.bottomN,y0.bottomN),Br.push(jm.bottomP,z0.bottomP,Jp.bottomN))):(Br.push(y0.topN,Jp.topN,z0.topP),Br.push(y0.topN,z0.topP,jm.topP),Mt===!1&&(Br.push(z0.bottomP,Jp.bottomN,y0.bottomN),Br.push(z0.bottomP,y0.bottomN,jm.bottomP))),Jp=z0,y0=jm,Co===Bp)for(let Q0=1;Q0<Co;Q0++)z0=this._buildBevelVert(ks,Jl,(mp+Q0)%pu,Q0/(Co-1),_g),jm=this._buildBevelVert(ks,mu,(Cp+Q0)%Zu,Q0/(Bp-1),_g),Br.push(Jp.topN,z0.topP,y0.topN),Br.push(y0.topN,z0.topP,jm.topP),Mt===!1&&(Br.push(z0.bottomP,Jp.bottomN,y0.bottomN),Br.push(z0.bottomP,y0.bottomN,jm.bottomP)),Jp=z0,y0=jm;else if(Co>Bp){let Q0=Co/Bp,T0=0;for(let av=1;av<Co;av++)z0=this._buildBevelVert(ks,Jl,(mp+av)%pu,av/(Co-1),_g),Br.push(Jp.topN,z0.topP,y0.topN),Mt===!1&&Br.push(z0.bottomP,Jp.bottomN,y0.bottomN),Jp=z0,av>(T0+1)*Q0&&(T0++,jm=this._buildBevelVert(ks,mu,(Cp+T0)%Zu,T0/(Bp-1),_g),Br.push(y0.topN,z0.topP,jm.topP),Mt===!1&&Br.push(z0.bottomP,y0.bottomN,jm.bottomP),y0=jm)}else{let Q0=Bp/Co,T0=0;for(let av=1;av<Bp;av++)jm=this._buildBevelVert(ks,mu,(Cp+av)%Zu,av/(Bp-1),_g),Br.push(y0.topN,z0.topP,jm.topP),Mt===!1&&Br.push(z0.bottomP,y0.bottomN,jm.bottomP),y0=jm,av>(T0+1)*Q0&&(T0++,z0=this._buildBevelVert(ks,Jl,(mp+T0)%pu,T0/(Co-1),_g),Br.push(Jp.topN,z0.topP,y0.topN),Mt===!1&&Br.push(z0.bottomP,Jp.bottomN,y0.bottomN),Jp=z0)}mp=(mp+Co)%pu,Cp=(Cp+Bp)%Zu,Up=(Up+1)%Mp}while(Up!==t0)}if(Mt===!1&&this._depth>this._bevel*2&&this._buildWall(Ao,ks,Br),Rn){let cu=[];for(let Jl=Br.length-1;Jl>=uu+2;Jl-=3){let mu=Br[Jl-2],pu=Br[Jl-1],Zu=Br[Jl-0];cu.push(Zu,pu,mu)}Br.splice(uu,Br.length-uu,...cu)}if(Rn){let cu=[];for(let Jl=Ao[Ao.length-1].boundary.vertices.length-1;Jl>=1;Jl-=2){let mu=Ao[Ao.length-1].boundary.vertices[Jl-1],pu=Ao[Ao.length-1].boundary.vertices[Jl-0];cu.push(mu,pu)}Jr.push(cu)}if(!Rn){let cu=Ao[Ao.length-1],Jl;try{Jl=Cr({windingRule:Ao.length>1?Pe.POSITIVE:Pe.ODD,elementType:Xe.POLYGONS,vertexSize:2,strict:!0,contours:[cu.insetPoints,...Jr]})}catch{Jl=Id}if(!Jl)throw new Error("Error generating geometry for surface");Ut.length===0&&this._bevel<rr&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let mu=0;mu<Jl.elementCount*3;mu+=3){let pu=this._buildSurfaceVert(Jl,Jl.elements[mu+0],Oo),Zu=this._buildSurfaceVert(Jl,Jl.elements[mu+1],Oo),Mp=this._buildSurfaceVert(Jl,Jl.elements[mu+2],Oo);Br.push(pu.top,Zu.top,Mp.top),Mt===!1&&Br.push(Mp.bottom,Zu.bottom,pu.bottom)}}this.vertexCache={}}this._buffer.shrink();let mn=new BufferAttribute(Uint32Array.from(Br),1),Mn=new BufferAttribute(this._buffer.positions,3),$n=new BufferAttribute(this._buffer.normals,3),en=new BufferAttribute(this._buffer.uvs,2);Mn.needsUpdate=!0,$n.needsUpdate=!0,en.needsUpdate=!0,mn.needsUpdate=!0,this.setAttribute("position",Mn),this.setAttribute("normal",$n),this.setAttribute("uv",en),this.setIndex(mn)}_computeBufferEstimatedSize(rt){return rt.vertexCount*2*(2+this._bevelSegments)}_buildWall(rt,_,ut){let mt=rt[0];for(let bt=0,St=mt.boundary.vertexCount;bt<St;bt++){let Mt=this._buildBevelVert(_,mt,bt),Bt=this._buildBevelVert(_,mt,(bt+1)%St);ut.push(Bt.topP,Mt.topN,Mt.bottomN),ut.push(Bt.topP,Mt.bottomN,Bt.bottomP)}}_buildSurfaceVert(rt,_,ut){let mt=_.toString();if(mt in this.vertexCache)return this.vertexCache[mt];let bt=rt.vertices[_*2+0],St=rt.vertices[_*2+1],Mt=(bt-this._minX)/this._width,Bt=(St-this._minY)/this._height;this.forPathBevel&&(Bt=1);let Ut=this._buffer.get(this.forPathBevel?1:2),Ht=Ut*3,tr=Ut*2,rr={top:Ut+0,bottom:Ut+1};return this._buffer.positions[Ht+0]=bt,this._buffer.positions[Ht+1]=St,this._buffer.positions[Ht+2]=this.forPathBevel?this._bevel:this._depth-ut,this._buffer.normals[Ht+0]=0,this._buffer.normals[Ht+1]=0,this._buffer.normals[Ht+2]=1,this._buffer.uvs[tr+0]=Mt,this._buffer.uvs[tr+1]=Bt,this.forPathBevel===!1&&(this._buffer.positions[Ht+3]=bt,this._buffer.positions[Ht+4]=St,this._buffer.positions[Ht+5]=ut,this._buffer.normals[Ht+3]=0,this._buffer.normals[Ht+4]=0,this._buffer.normals[Ht+5]=-1,this._buffer.uvs[tr+2]=Mt,this._buffer.uvs[tr+3]=Bt),this.vertexCache[mt]=rr,rr}_buildBevelVert(rt,_,ut,mt=1,bt){let St=`${_.bevelI}:${ut}`;if(St in this.vertexCache&&bt!==0&&bt!==1&&(!bt||bt===this.vertexCache[St].pathBevelUCoord))return this.vertexCache[St];let[Mt,Bt]=_.boundary.vertexIndices[ut],Ut,Ht,tr,rr;Mt!==Bt?(Ht=Mt,Ut=Bt,rr=!1,tr=rt.continuous[Ht]&&rt.continuous[Ut]):(Ut=Mt,Ht=(Ut-1+rt.count)%rt.count,rr=rt.concave[Ut]&&_.bevelI>0,tr=rt.continuous[Ut]||rr);let sr=Math.cos(_.angle),ar=Math.sin(_.angle),cr=ut*2,Ar=Ut*2,_r=Ht*2,Dr=_.boundary.vertices[cr+0],$r=_.boundary.vertices[cr+1],Br=(1-ar)*this._bevel,Jr=(Dr-this._minX)/this._width,mn=($r-this._minY)/this._height;this.forPathBevel&&(bt!==void 0&&(Jr=bt),mn=1);let Mn=rt.normals[Ar+0],$n=rt.normals[Ar+1],en=rt.normals[_r+0],In=rt.normals[_r+1];if(rr){let cs=en-Mn,ks=In-$n;Mn=Mn+cs*(1-mt),$n=$n+ks*(1-mt);let _o=Math.sqrt(Mn*Mn+$n*$n);Mn/=_o,$n/=_o}let Rn=this.forPathBevel?this._buffer.get(tr?1:2):this._buffer.get(tr?2:4),qn=Rn*3,Qn=Rn*2,xs={i:ut,fi:Ut,topP:Rn+0,topN:Rn+0,bottomP:Rn+1,bottomN:Rn+1,pathBevelUCoord:bt};return this._buffer.positions[qn+0]=Dr,this._buffer.positions[qn+1]=$r,this._buffer.positions[qn+2]=(this.forPathBevel?this._bevel:this._depth)-Br,this._buffer.normals[qn+0]=Mn*sr,this._buffer.normals[qn+1]=$n*sr,this._buffer.normals[qn+2]=ar,this._buffer.uvs[Qn+0]=Jr,this._buffer.uvs[Qn+1]=mn,this.forPathBevel===!1&&(this._buffer.positions[qn+3]=Dr,this._buffer.positions[qn+4]=$r,this._buffer.positions[qn+5]=Br,this._buffer.normals[qn+3]=Mn*sr,this._buffer.normals[qn+4]=$n*sr,this._buffer.normals[qn+5]=-ar,this._buffer.uvs[Qn+2]=mn,this._buffer.uvs[Qn+3]=Jr),tr||(this.forPathBevel?(Rn+=1,qn+=3,Qn+=2):(Rn+=2,qn+=6,Qn+=4),xs.topP=Rn+0,xs.bottomP=Rn+1,this._buffer.positions[qn+0]=Dr,this._buffer.positions[qn+1]=$r,this._buffer.positions[qn+2]=(this.forPathBevel?this._bevel:this._depth)-Br,this._buffer.normals[qn+0]=en*sr,this._buffer.normals[qn+1]=In*sr,this._buffer.normals[qn+2]=ar,this._buffer.uvs[Qn+0]=Jr,this._buffer.uvs[Qn+1]=mn,this.forPathBevel===!1&&(this._buffer.positions[qn+3]=Dr,this._buffer.positions[qn+4]=$r,this._buffer.positions[qn+5]=Br,this._buffer.normals[qn+3]=en*sr,this._buffer.normals[qn+4]=In*sr,this._buffer.normals[qn+5]=-ar,this._buffer.uvs[Qn+2]=mn,this._buffer.uvs[Qn+3]=Jr)),this.vertexCache[St]=xs,xs}clone(){let rt=new tn(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return rt.userData=yo(this.userData),rt}},$i=class extends BufferGeometry{constructor(rt,_=12,ut={}){super(),this.type="ShapeGeometry",this.windingRule=Pe.ODD,this.elementType=Xe.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=rt,this._curveSegments=_,this._triangulationOptions=Object.assign({windingRule:Pe.ODD,elementType:Xe.POLYGONS,polySize:3,vertexSize:2,strict:!0},ut);let mt=this._shape.extractShapePointsToFlatArray([],this._curveSegments),bt=this._shape.shapeHoles.map(sr=>sr.extractShapePointsToFlatArray([],this._curveSegments)),St,Mt=!0,Bt=!0,Ut,Ht;for(let sr=0,ar=mt.length/2;sr<ar;sr++){let cr=sr*2,Ar=mt[cr+0],_r=mt[cr+1];if(Ut!==void 0&&Ar!==Ut&&(Mt=!1),Ht!==void 0&&_r!==Ht&&(Bt=!1),Ut=Ar,Ht=_r,!Mt&&!Bt)break}if(!Mt&&!Bt)try{St=Cr({contours:[mt,...bt],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{St=ms}let tr=(St==null?void 0:St.vertexCount)??1,rr=(St==null?void 0:St.elementCount)??1;if(this._positionAttribute=new BufferAttribute(new Float32Array(tr*3),3),this._normalAttribute=new BufferAttribute(new Float32Array(tr*3),3),this._uvAttribute=new BufferAttribute(new Float32Array(tr*2),2),this._indexAttribute=new BufferAttribute(new Uint32Array(rr*3),1),St){let sr=1/0,ar=-1/0,cr=1/0,Ar=-1/0;for(let $r=0,Br=tr;$r<Br;$r++){let Jr=$r*2,mn=St.vertices[Jr+0],Mn=St.vertices[Jr+1];mn<sr&&(sr=mn),mn>ar&&(ar=mn),Mn<cr&&(cr=Mn),Mn>Ar&&(Ar=Mn)}let _r=ar-sr,Dr=Ar-cr;for(let $r=0,Br=tr;$r<Br;$r++){let Jr=$r*2,mn=St.vertices[Jr+0],Mn=St.vertices[Jr+1],$n=(mn-sr)/_r,en=(Mn-cr)/Dr;this._positionAttribute.setXYZ($r,mn,Mn,0),this._normalAttribute.setXYZ($r,0,0,1),this._uvAttribute.setXY($r,$n,en)}for(let $r=0,Br=rr;$r<Br;$r++){let Jr=$r*3,mn=St.elements[Jr+0],Mn=St.elements[Jr+1],$n=St.elements[Jr+2];this._indexAttribute.setX(Jr+0,mn),this._indexAttribute.setX(Jr+1,Mn),this._indexAttribute.setX(Jr+2,$n)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((St==null?void 0:St.elementCount)??1)*3)}clone(){let rt=new $i(this._shape,this._curveSegments);return rt.userData=yo(this.userData),rt}},Yi=class extends tn{constructor(rt,_,ut=0,mt=12,bt=3,St=Pe.ODD){super(rt,_,ut,mt,bt,St),this.type="ShapeGeometry"}_computeBufferEstimatedSize(rt){return rt.vertexCount*2*(2+this._bevelSegments)}_buildWall(rt,_,ut){let mt=rt[0];for(let bt=0,St=mt.boundary.vertexCount;bt<St;bt++){let Mt=this._buildBevelVert(_,mt,bt),Bt=this._buildBevelVert(_,mt,(bt+1)%St);ut.push(Bt.topP,Mt.topN,Mt.bottomN),ut.push(Bt.topP,Mt.bottomN,Bt.bottomP)}}clone(){let rt=new Yi(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return rt.userData=yo(this.userData),rt}},Xt=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){var Ht,tr;let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Pe.ODD},rt.parameters),mt=Math.abs(ut.width),bt=Math.abs(ut.height??ut.width),St=Math.abs(ut.depth??0),Mt=rt.shape??(_==null?void 0:_.shape),Bt=(Mt==null?void 0:Mt.roundness)??ut.roundness;Mt!==void 0&&(Mt instanceof Ne$1?(Mt.width!==mt||Mt.height!==bt)&&Mt.applySize(mt,bt):Mt=new Ne$1(mt,bt).fromJSON(Mt),((Ht=rt.parameters)==null?void 0:Ht.roundness)!==void 0&&((tr=rt.parameters)==null?void 0:tr.roundness)>0&&Mt.update());let Ut=Mt??new Ne$1(mt,bt);return{parameters:Object.assign(ut,{width:mt,height:bt,depth:St,roundness:Bt}),shape:Ut}}static build(rt){let{depth:_,extrudeBevelSize:ut,extrudeBevelSegments:mt,subdivisions:bt,roundness:St,windingRule:Mt}=rt.parameters;rt.shape.roundness=St;let Bt;return _<=0?Bt=new $i(rt.shape,bt,{windingRule:Mt}):Bt=new Yi(rt.shape,_,ut,bt,mt,Mt),Object.assign(Bt,{userData:{...rt,type:"VectorGeometry"}})}},Ag=Math.PI*2,Ki=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},rt.parameters);return ut.angle=MathUtils.clamp(ut.angle,0,360),{shape:rt.shape&&rt.shape instanceof Ne$1?rt.shape:new Ne$1,parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??0)})}}static build(rt){let{width:_,height:ut,spikes:mt,angle:bt,innerRadius:St,depth:Mt,extrudeBevelSize:Bt,extrudeBevelSegments:Ut}=rt.parameters,Ht=rt.shape,tr=_*.5,rr=ut*.5,sr=SP(Ht,tr,rr,bt*Math.PI/180,mt,St);Ht.isClosed=!0,Ht.update();let ar;return bt===0?(ar=new BufferGeometry,ar.setAttribute("position",new Float32BufferAttribute([],3))):ar=Xt.create({shape:Ht,parameters:{subdivisions:sr,depth:Mt,extrudeBevelSize:Bt,extrudeBevelSegments:Ut}}),Object.assign(ar,{userData:{...rt,type:"EllipseGeometry"}})}};function SP(rt,_,ut,mt,bt,St){if(mt>=Ag)return bt>30||bt%4===0?(_P(rt,_,ut,St),Math.round(bt/4)):wg(rt,mt,bt,_,ut,St);mt=Math.max(mt,.001);let Mt={x:0,y:ut},Bt=mt+Math.PI*.5,Ut={x:Math.cos(Bt)*_,y:Math.sin(Bt)*ut},Ht=fg({px:Mt.x,py:Mt.y,cx:Ut.x,cy:Ut.y,rx:_,ry:ut,largeArcFlag:mt>Math.PI,sweepFlag:!0});return bt>30||bt%Ht.length===0?wP(rt,Mt.x,Mt.y,Ht,bt,_,ut,St):wg(rt,mt,bt,_,ut,St)}function wP(rt,_,ut,mt,bt,St,Mt,Bt){let Ut=Math.round(bt/mt.length);rt.addPoint(Xi(_,ut));for(let Ht=0,tr=mt.length;Ht<tr;Ht++){let rr=mt[Ht],sr=rt.points[Ht],ar=Xi(rr.x,rr.y);sr.controls[1].position.set(rr.x1,rr.y1),ar.controls[0].position.set(rr.x2,rr.y2),rt.addPoint(ar)}return Bt>0?Tg(rt,St,Mt,Bt):rt.addPoint(Xi(0,0)),Ut}function wg(rt,_,ut,mt,bt,St){let Mt=-_/ut;for(let Bt=0;Bt<=ut;Bt++){let Ut=Mt*Bt,Ht=Math.sin(Ut)*mt,tr=Math.cos(Ut)*bt;rt.addPoint(Xi(Ht,tr))}return _<Ag?St>0?Tg(rt,mt,bt,St):rt.addPoint(Xi(0,0)):(rt.removePoint(rt.points[rt.points.length-1]),St>0&&Cg(rt,mt,bt,St)),1}function _P(rt,_,ut,mt=0,bt=0,St=0){let Mt=.5522847498,Bt=_*Mt,Ut=ut*Mt;rt.addPoint(gc(bt-_,St,bt-_,St-Ut,bt-_,St+Ut)),rt.addPoint(gc(bt,St+ut,bt-Bt,St+ut,bt+Bt,St+ut)),rt.addPoint(gc(bt+_,St,bt+_,St+Ut,bt+_,St-Ut)),rt.addPoint(gc(bt,St-ut,bt+Bt,St-ut,bt-Bt,St-ut)),mt>0&&Cg(rt,_,ut,mt)}function Xi(rt,_){return new Tr(MathUtils.generateUUID(),new Vector2(rt,_))}function gc(rt,_,ut,mt,bt,St){let Mt=Xi(rt,_);return Mt.controls[0].position.set(ut,mt),Mt.controls[1].position.set(bt,St),Mt}function Tg(rt,_,ut,mt){Pg(rt,_,ut,mt).forEach(bt=>rt.addPoint(bt))}function Cg(rt,_,ut,mt){let bt=Pg(rt,_,ut,mt),St=new Ne$1;bt.forEach(Mt=>St.addPoint(Mt)),St.isClosed=!0,rt.shapeHoles.push(St)}function Pg(rt,_,ut,mt){let bt=mt*_/100,St=bt*(Math.abs(ut)/Math.abs(_)),Mt=new Vector2(bt/_,St/ut),Bt=rt.points.map(Ut=>{let Ht=Ut.clone();return Ht.uuid=MathUtils.generateUUID(),Ht}).reverse();return Bt.forEach(Ut=>{Ut.position.multiply(Mt);let Ht=Ut.controls[0].position.clone().multiply(Mt),tr=Ut.controls[1].position.clone().multiply(Mt);Ut.controls[0].position.copy(tr),Ut.controls[1].position.copy(Ht)}),Bt}var Mg=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},rt.parameters),mt=Math.abs(ut.width),bt=Math.abs(ut.height??mt),St=Math.abs(ut.depth??mt),Mt=Math.abs(Math.min(mt,St))/2;return{parameters:Object.assign(ut,{width:mt,height:bt,depth:St,radius:Mt,segments:Math.round(ut.segments),pathSegments:Math.round(ut.pathSegments),cornerSegments:Math.round(ut.cornerSegments)})}}static build(rt){let{width:_,height:ut,depth:mt,radius:bt,revolutions:St,segments:Mt,pathRadius:Bt,pathType:Ut,pathSegments:Ht,cornerRadius:tr,cornerSegments:rr}=rt.parameters,sr=new ys(!1,_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr);return Object.assign(sr,{userData:{...rt,type:"HelixGeometry"}})}},Dd=new Uint32BufferAttribute([0,0,0],1),ys=class extends BufferGeometry{constructor(rt=!0,_=1,ut=1,mt=1,bt=1,St=1,Mt=1,Bt=1,Ut=1,Ht=1,tr=1,rr=1){if(super(),St===0)return;let sr=rt&&St===1;sr&&(rr=0),tr>100&&(tr=100),tr===0&&(rr=0);let ar=()=>new Vector3,cr=new Vector3,Ar=ar(),_r=ar(),Dr=ar(),$r,Br,Jr,mn,Mn,$n,en,In,Rn=ar(),qn=ar(),Qn=ar(),xs=ar(),cs=ar(),ks=ar(),_o=ar(),qs=ar(),Ss=ut-2*Bt+.001,eo=Ss/St,Ao=Math.ceil(Mt*St),Oo=Ao+1,uo=Ss/Ao,uu=-Ss/2,cu=Ht+1,Jl=2*Math.PI/Ht,mu=Math.PI/2/rr,pu=.01,Zu=Math.min((1-tr/100)*Bt,Bt-pu),Mp=Bt-Zu,Up=0,Ep=2,mp=rr*Ep+Ep,Cp=cu*mp/Ep,t0=Cp+cu*Oo,_g=Math.max(0,cu*(Oo+mp)),[m0,K0,Jp]=[3,3,2].map(N0=>Array(_g*N0).fill(0)),y0=[],z0=bt-Bt;function jm(N0,zv){let Uv=Math.PI/2;$n=zv*uo,In=2*Math.PI*($n%eo)/eo+Uv,$n+=uu,en=Math.sin(In)*z0,Mn=Math.cos(In)*z0,rt?N0.set(Mn,en,$n):N0.set(Mn,$n,en)}jm(cr,-1e-10),jm(Ar,0),Rn.copy(cr),jm(cr,1);let Nu=cr.distanceTo(Ar),Co=sr?0:Mp+Zu,Bp=Nu*Ao+2*Co,a0=Zu,Q0=Bp-Co;for(let N0=0;N0<=Ao;N0++){jm(_r,N0),qs.subVectors(_r,Rn).normalize(),Rn.copy(_r),ks.copy(_r).setComponent(+rt+1,0).normalize(),_o.crossVectors(qs,ks).normalize();let zv=N0===0,Uv=N0===Ao,Gv=zv?3*Math.PI/2:mu,Dv=zv?a0:Q0,Cv=zv?cu:t0,Kp=zv?0:_g-cu,sv=qs.clone().multiplyScalar(zv?-Mp:Mp).add(_r),Hv=qs.clone().multiplyScalar(zv?-1:1).normalize();for(let jp=0;jp<cu;jp++){let Fp=jp*Jl;if(qn.addVectors(cr.copy(ks).multiplyScalar(Bt*Math.cos(Fp)),Ar.copy(_o).multiplyScalar(Bt*Math.sin(Fp))),Qn.copy(qn).normalize(),zv||Uv){sr||(Up=Kp+jp,[0,1,2].forEach(nv=>{m0[Up*3+nv]=sv.getComponent(nv),K0[Up*3+nv]=Hv.getComponent(nv)}),Jp[Up*2]=+Uv,Jp[Up*2+1]=jp/Ht),Ar.copy(Qn).multiplyScalar(Zu),Dr.addVectors(_r,Ar);for(let nv=0;nv<rr;nv++){let qy=nv*mu+Gv;xs.addVectors(cr.copy(qs).multiplyScalar(Mp*Math.sin(qy)),Ar.copy(Qn).multiplyScalar(Mp*Math.cos(qy))),cs.copy(xs).normalize(),Ar.addVectors(Dr,xs),xs.normalize(),Up=Cv+nv*cu+jp,[0,1,2].forEach(vx=>{m0[Up*3+vx]=Ar.getComponent(vx),K0[Up*3+vx]=cs.getComponent(vx)});let Uy=+zv+Math.sin(qy);Jp[Up*2]=(Dv+Mp*Uy)/Bp,Jp[Up*2+1]=jp/Ht}}Ar.addVectors(_r,qn),Up=Cp+N0*cu+jp,[0,1,2].forEach(nv=>{m0[Up*3+nv]=Ar.getComponent(nv),K0[Up*3+nv]=Qn.getComponent(nv)}),Jp[Up*2]=(Co+N0*Nu)/Bp,Jp[Up*2+1]=jp/Ht}}let T0=Oo+2*rr+Ep,[av,lv]=[+sr,T0-1];for(let N0=av;N0<=lv-1;N0++){let zv=sr&&N0===lv-1;for(let Uv=0;Uv<cu-1;Uv++)$r=N0*cu+Uv,Br=$r+1,Jr=(zv?Uv:$r)+cu,mn=(zv?Uv+1:Br)+cu,N0===0?y0.push(Br,mn,Jr):N0===T0-2?y0.push($r,Br,Jr):y0.push($r,Br,Jr,Br,mn,Jr)}this.setIndex(y0),this.setAttribute("position",new Float32BufferAttribute(m0,3)),this.setAttribute("normal",new Float32BufferAttribute(K0,3)),this.setAttribute("uv",new Float32BufferAttribute(Jp,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let rt=this.userData.parameters,_=Math.ceil(rt.tubularSegments),ut=rt.radialSegments+1,mt=Array.from(this.getIndex().array),bt,St,Mt,Bt,Ut=6*(_-1)*rt.radialSegments,Ht=_,tr=Ht===_;for(let rr=0;rr<rt.radialSegments;rr++)bt=Ht*ut+rr,St=bt+1,Mt=(tr?rr:bt)+ut,Bt=(tr?rr+1:St)+ut,mt[Ut++]=bt,mt[Ut++]=St,mt[Ut++]=Mt,mt[Ut++]=St,mt[Ut++]=Bt,mt[Ut++]=Mt;return mt.length=Ut,Dd.array=mt,Dd.count=mt.length,Dd}},Ig=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,detail:0,corner:0,cornerSides:4},rt.parameters);return{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??ut.width)})}}static build(rt){let{width:_,height:ut,depth:mt,detail:bt,corner:St,cornerSides:Mt}=rt.parameters,Bt=bt===0&&St!==0?new gs(_*.5,St,Mt):new IcosahedronGeometry(_*.5,bt);return Bt.scale(1,ut/_,mt/_),Object.assign(Bt,{userData:{...rt,type:"IcosahedronGeometry"}})}},gs=class extends Zo{constructor(rt=1,_=.2,ut=4){let mt=(1+Math.sqrt(5))/2,bt=[-1,mt,0,1,mt,0,-1,-mt,0,1,-mt,0,0,-1,mt,0,1,mt,0,-1,-mt,0,1,-mt,mt,0,-1,mt,0,1,-mt,0,-1,-mt,0,1],St=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],Mt="IcosahedronGeometry";super(bt,St,Mt,rt,_,ut),this.type=Mt}static fromJSON(rt){return new gs(rt.radius,rt.corner,rt.cornerSides)}},Ng=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){var mt;(((mt=rt.parameters)==null?void 0:mt.points)??[]).forEach(bt=>{Array.isArray(bt)&&(bt.x=bt[0],bt.y=bt[1])});let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},rt.parameters);return{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??ut.width)})}}static build(rt){let{points:_,segments:ut,verticalSegments:mt}=rt.parameters,bt=new Shape;bt.moveTo(_[0].x,_[0].y),bt.bezierCurveTo(_[1].x,_[1].y,_[2].x,_[2].y,_[3].x,_[3].y);let St=new LatheGeometry(bt.extractPoints(mt).shape,ut);return St.rotateZ(Math.PI),Object.assign(St,{userData:{...rt,type:"LatheGeometry"}})}},Yr=new Matrix4,Ld=new Object3D,xc=new Vector3,rn=class extends EventDispatcher{constructor(){super(),this.uuid=MathUtils.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(rt){let _=new Matrix3().getNormalMatrix(rt);for(let ut=0,mt=this.vertices.length;ut<mt;ut++)this.vertices[ut].applyMatrix4(rt);for(let ut=0,mt=this.faces.length;ut<mt;ut++){let bt=this.faces[ut];bt.normal.applyMatrix3(_).normalize();for(let St=0,Mt=bt.vertexNormals.length;St<Mt;St++)bt.vertexNormals[St].applyMatrix3(_).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(rt){return Yr.makeRotationX(rt),this.applyMatrix4(Yr),this}rotateY(rt){return Yr.makeRotationY(rt),this.applyMatrix4(Yr),this}rotateZ(rt){return Yr.makeRotationZ(rt),this.applyMatrix4(Yr),this}translate(rt,_,ut){return Yr.makeTranslation(rt,_,ut),this.applyMatrix4(Yr),this}scale(rt,_,ut){return Yr.makeScale(rt,_,ut),this.applyMatrix4(Yr),this}lookAt(rt){return Ld.lookAt(rt),Ld.updateMatrix(),this.applyMatrix4(Ld.matrix),this}fromBufferGeometry(rt){let _=this,ut=rt.index!==null?rt.index:void 0,mt=rt.attributes;if(mt.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let bt=mt.position,St=mt.normal,Mt=mt.color,Bt=mt.uv,Ut=mt.uv2;Ut!==void 0&&(this.faceVertexUvs[1]=[]);for(let rr=0;rr<bt.count;rr++)_.vertices.push(new Vector3().fromBufferAttribute(bt,rr)),Mt!==void 0&&_.colors.push(new Color$1().fromBufferAttribute(Mt,rr));function Ht(rr,sr,ar,cr){let Ar=Mt===void 0?[]:[_.colors[rr].clone(),_.colors[sr].clone(),_.colors[ar].clone()],_r=St===void 0?[]:[new Vector3().fromBufferAttribute(St,rr),new Vector3().fromBufferAttribute(St,sr),new Vector3().fromBufferAttribute(St,ar)],Dr=new Zi(rr,sr,ar,_r,Ar,cr);_.faces.push(Dr),Bt!==void 0&&_.faceVertexUvs[0].push([new Vector2().fromBufferAttribute(Bt,rr),new Vector2().fromBufferAttribute(Bt,sr),new Vector2().fromBufferAttribute(Bt,ar)]),Ut!==void 0&&_.faceVertexUvs[1].push([new Vector2().fromBufferAttribute(Ut,rr),new Vector2().fromBufferAttribute(Ut,sr),new Vector2().fromBufferAttribute(Ut,ar)])}let tr=rt.groups;if(tr.length>0)for(let rr=0;rr<tr.length;rr++){let sr=tr[rr],ar=sr.start,cr=sr.count;for(let Ar=ar,_r=ar+cr;Ar<_r;Ar+=3)ut!==void 0?Ht(ut.getX(Ar),ut.getX(Ar+1),ut.getX(Ar+2),sr.materialIndex):Ht(Ar,Ar+1,Ar+2,sr.materialIndex)}else if(ut!==void 0)for(let rr=0;rr<ut.count;rr+=3)Ht(ut.getX(rr),ut.getX(rr+1),ut.getX(rr+2));else for(let rr=0;rr<bt.count;rr+=3)Ht(rr,rr+1,rr+2);return this.computeFaceNormals(),rt.boundingBox!==null&&(this.boundingBox=rt.boundingBox.clone()),rt.boundingSphere!==null&&(this.boundingSphere=rt.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(xc).negate(),this.translate(xc.x,xc.y,xc.z),this}normalize(){this.computeBoundingSphere();let rt=this.boundingSphere.center,_=this.boundingSphere.radius,ut=_===0?1:1/_,mt=new Matrix4;return mt.set(ut,0,0,-ut*rt.x,0,ut,0,-ut*rt.y,0,0,ut,-ut*rt.z,0,0,0,1),this.applyMatrix4(mt),this}computeFaceNormals(){let rt=new Vector3,_=new Vector3;for(let ut=0,mt=this.faces.length;ut<mt;ut++){let bt=this.faces[ut],St=this.vertices[bt.a],Mt=this.vertices[bt.b],Bt=this.vertices[bt.c];rt.subVectors(Bt,Mt),_.subVectors(St,Mt),rt.cross(_),rt.normalize(),bt.normal.copy(rt)}}computeVertexNormals(rt=!0){let _=new Array(this.vertices.length);for(let ut=0,mt=this.vertices.length;ut<mt;ut++)_[ut]=new Vector3;if(rt){let ut=new Vector3,mt=new Vector3;for(let bt=0,St=this.faces.length;bt<St;bt++){let Mt=this.faces[bt],Bt=this.vertices[Mt.a],Ut=this.vertices[Mt.b],Ht=this.vertices[Mt.c];ut.subVectors(Ht,Ut),mt.subVectors(Bt,Ut),ut.cross(mt),_[Mt.a].add(ut),_[Mt.b].add(ut),_[Mt.c].add(ut)}}else{this.computeFaceNormals();for(let ut=0,mt=this.faces.length;ut<mt;ut++){let bt=this.faces[ut];_[bt.a].add(bt.normal),_[bt.b].add(bt.normal),_[bt.c].add(bt.normal)}}for(let ut=0,mt=this.vertices.length;ut<mt;ut++)_[ut].normalize();for(let ut=0,mt=this.faces.length;ut<mt;ut++){let bt=this.faces[ut],St=bt.vertexNormals;St.length===3?(St[0].copy(_[bt.a]),St[1].copy(_[bt.b]),St[2].copy(_[bt.c])):(St[0]=_[bt.a].clone(),St[1]=_[bt.b].clone(),St[2]=_[bt.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let rt=0,_=this.faces.length;rt<_;rt++){let ut=this.faces[rt],mt=ut.vertexNormals;mt.length===3?(mt[0].copy(ut.normal),mt[1].copy(ut.normal),mt[2].copy(ut.normal)):(mt[0]=ut.normal.clone(),mt[1]=ut.normal.clone(),mt[2]=ut.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let _=0,ut=this.faces.length;_<ut;_++){let mt=this.faces[_];mt.__originalFaceNormal?mt.__originalFaceNormal.copy(mt.normal):mt.__originalFaceNormal=mt.normal.clone(),mt.__originalVertexNormals||(mt.__originalVertexNormals=[]);for(let bt=0,St=mt.vertexNormals.length;bt<St;bt++)mt.__originalVertexNormals[bt]?mt.__originalVertexNormals[bt].copy(mt.vertexNormals[bt]):mt.__originalVertexNormals[bt]=mt.vertexNormals[bt].clone()}let rt=new rn;rt.faces=this.faces;for(let _=0,ut=this.morphTargets.length;_<ut;_++){if(!this.morphNormals[_]){this.morphNormals[_]={},this.morphNormals[_].faceNormals=[],this.morphNormals[_].vertexNormals=[];let bt=this.morphNormals[_].faceNormals,St=this.morphNormals[_].vertexNormals;for(let Mt=0,Bt=this.faces.length;Mt<Bt;Mt++){let Ut=new Vector3,Ht={a:new Vector3,b:new Vector3,c:new Vector3};bt.push(Ut),St.push(Ht)}}let mt=this.morphNormals[_];rt.vertices=this.morphTargets[_].vertices,rt.computeFaceNormals(),rt.computeVertexNormals();for(let bt=0,St=this.faces.length;bt<St;bt++){let Mt=this.faces[bt],Bt=mt.faceNormals[bt],Ut=mt.vertexNormals[bt];Bt.copy(Mt.normal),Ut.a.copy(Mt.vertexNormals[0]),Ut.b.copy(Mt.vertexNormals[1]),Ut.c.copy(Mt.vertexNormals[2])}}for(let _=0,ut=this.faces.length;_<ut;_++){let mt=this.faces[_];mt.normal=mt.__originalFaceNormal,mt.vertexNormals=mt.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere$1),this.boundingSphere.setFromPoints(this.vertices)}merge(rt,_,ut=0){if(!(rt&&rt.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",rt);return}let mt,bt=this.vertices.length,St=this.vertices,Mt=rt.vertices,Bt=this.faces,Ut=rt.faces,Ht=this.colors,tr=rt.colors;_!==void 0&&(mt=new Matrix3().getNormalMatrix(_));for(let rr=0,sr=Mt.length;rr<sr;rr++){let ar=Mt[rr].clone();_!==void 0&&ar.applyMatrix4(_),St.push(ar)}for(let rr=0,sr=tr.length;rr<sr;rr++)Ht.push(tr[rr].clone());for(let rr=0,sr=Ut.length;rr<sr;rr++){let ar=Ut[rr],cr,Ar,_r=ar.vertexNormals,Dr=ar.vertexColors,$r=new Zi(ar.a+bt,ar.b+bt,ar.c+bt);$r.normal.copy(ar.normal),mt!==void 0&&$r.normal.applyMatrix3(mt).normalize();for(let Br=0,Jr=_r.length;Br<Jr;Br++)cr=_r[Br].clone(),mt!==void 0&&cr.applyMatrix3(mt).normalize(),$r.vertexNormals.push(cr);$r.color.copy(ar.color);for(let Br=0,Jr=Dr.length;Br<Jr;Br++)Ar=Dr[Br],$r.vertexColors.push(Ar.clone());$r.materialIndex=ar.materialIndex+ut,Bt.push($r)}for(let rr=0,sr=rt.faceVertexUvs.length;rr<sr;rr++){let ar=rt.faceVertexUvs[rr];this.faceVertexUvs[rr]===void 0&&(this.faceVertexUvs[rr]=[]);for(let cr=0,Ar=ar.length;cr<Ar;cr++){let _r=ar[cr],Dr=[];for(let $r=0,Br=_r.length;$r<Br;$r++)Dr.push(_r[$r].clone());this.faceVertexUvs[rr].push(Dr)}}}mergeMesh(rt){if(!(rt&&rt.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",rt);return}rt.matrixAutoUpdate&&rt.updateMatrix(),this.merge(rt.geometry,rt.matrix)}mergeVertices(rt=4){let _={},ut=[],mt=[],bt=Math.pow(10,rt);for(let Bt=0,Ut=this.vertices.length;Bt<Ut;Bt++){let Ht=this.vertices[Bt],tr=Math.round(Ht.x*bt)+"_"+Math.round(Ht.y*bt)+"_"+Math.round(Ht.z*bt);_[tr]===void 0?(_[tr]=Bt,ut.push(this.vertices[Bt]),mt[Bt]=ut.length-1):mt[Bt]=mt[_[tr]]}let St=[];for(let Bt=0,Ut=this.faces.length;Bt<Ut;Bt++){let Ht=this.faces[Bt];Ht.a=mt[Ht.a],Ht.b=mt[Ht.b],Ht.c=mt[Ht.c];let tr=[Ht.a,Ht.b,Ht.c];for(let rr=0;rr<3;rr++)if(tr[rr]===tr[(rr+1)%3]){St.push(Bt);break}}for(let Bt=St.length-1;Bt>=0;Bt--){let Ut=St[Bt];this.faces.splice(Ut,1);for(let Ht=0,tr=this.faceVertexUvs.length;Ht<tr;Ht++)this.faceVertexUvs[Ht].splice(Ut,1)}let Mt=this.vertices.length-ut.length;return this.vertices=ut,Mt}setFromPoints(rt){this.vertices=[];for(let _=0,ut=rt.length;_<ut;_++){let mt=rt[_];this.vertices.push(new Vector3(mt.x,mt.y,mt.z||0))}return this}sortFacesByMaterialIndex(){let rt=this.faces,_=rt.length;for(let Bt=0;Bt<_;Bt++)rt[Bt]._id=Bt;function ut(Bt,Ut){return Bt.materialIndex-Ut.materialIndex}rt.sort(ut);let mt=this.faceVertexUvs[0],bt=this.faceVertexUvs[1],St,Mt;mt&&mt.length===_&&(St=[]),bt&&bt.length===_&&(Mt=[]);for(let Bt=0;Bt<_;Bt++){let Ut=rt[Bt]._id;St&&St.push(mt[Ut]),Mt&&Mt.push(bt[Ut])}St&&(this.faceVertexUvs[0]=St),Mt&&(this.faceVertexUvs[1]=Mt)}toJSON(){let rt={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(rt.uuid=this.uuid,rt.type=this.type,this.name!==""&&(rt.name=this.name),this.parameters!==void 0){let ar=this.parameters;for(let cr in ar)ar[cr]!==void 0&&(rt[cr]=ar[cr]);return rt}let _=[];for(let ar=0;ar<this.vertices.length;ar++){let cr=this.vertices[ar];_.push(cr.x,cr.y,cr.z)}let ut=[],mt=[],bt={},St=[],Mt={},Bt=[],Ut={};for(let ar=0;ar<this.faces.length;ar++){let cr=this.faces[ar],Ar=!0,_r=!1,Dr=this.faceVertexUvs[0][ar]!==void 0,$r=cr.normal.length()>0,Br=cr.vertexNormals.length>0,Jr=cr.color.r!==1||cr.color.g!==1||cr.color.b!==1,mn=cr.vertexColors.length>0,Mn=0;if(Mn=Ht(Mn,0,0),Mn=Ht(Mn,1,Ar),Mn=Ht(Mn,2,_r),Mn=Ht(Mn,3,Dr),Mn=Ht(Mn,4,$r),Mn=Ht(Mn,5,Br),Mn=Ht(Mn,6,Jr),Mn=Ht(Mn,7,mn),ut.push(Mn),ut.push(cr.a,cr.b,cr.c),ut.push(cr.materialIndex),Dr){let $n=this.faceVertexUvs[0][ar];ut.push(sr($n[0]),sr($n[1]),sr($n[2]))}if($r&&ut.push(tr(cr.normal)),Br){let $n=cr.vertexNormals;ut.push(tr($n[0]),tr($n[1]),tr($n[2]))}if(Jr&&ut.push(rr(cr.color)),mn){let $n=cr.vertexColors;ut.push(rr($n[0]),rr($n[1]),rr($n[2]))}}function Ht(ar,cr,Ar){return Ar?ar|1<<cr:ar&~(1<<cr)}function tr(ar){let cr=ar.x.toString()+ar.y.toString()+ar.z.toString();return bt[cr]!==void 0||(bt[cr]=mt.length/3,mt.push(ar.x,ar.y,ar.z)),bt[cr]}function rr(ar){let cr=ar.r.toString()+ar.g.toString()+ar.b.toString();return Mt[cr]!==void 0||(Mt[cr]=St.length,St.push(ar.getHex())),Mt[cr]}function sr(ar){let cr=ar.x.toString()+ar.y.toString();return Ut[cr]!==void 0||(Ut[cr]=Bt.length/2,Bt.push(ar.x,ar.y)),Ut[cr]}return rt.data={},rt.data.vertices=_,rt.data.normals=mt,St.length>0&&(rt.data.colors=St),Bt.length>0&&(rt.data.uvs=[Bt]),rt.data.faces=ut,rt}clone(){return new rn().copy(this)}copy(rt){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=rt.name;let _=rt.vertices;for(let rr=0,sr=_.length;rr<sr;rr++)this.vertices.push(_[rr].clone());let ut=rt.colors;for(let rr=0,sr=ut.length;rr<sr;rr++)this.colors.push(ut[rr].clone());let mt=rt.faces;for(let rr=0,sr=mt.length;rr<sr;rr++)this.faces.push(mt[rr].clone());for(let rr=0,sr=rt.faceVertexUvs.length;rr<sr;rr++){let ar=rt.faceVertexUvs[rr];this.faceVertexUvs[rr]===void 0&&(this.faceVertexUvs[rr]=[]);for(let cr=0,Ar=ar.length;cr<Ar;cr++){let _r=ar[cr],Dr=[];for(let $r=0,Br=_r.length;$r<Br;$r++){let Jr=_r[$r];Dr.push(Jr.clone())}this.faceVertexUvs[rr].push(Dr)}}let bt=rt.morphTargets;for(let rr=0,sr=bt.length;rr<sr;rr++){let ar={};if(ar.name=bt[rr].name,bt[rr].vertices!==void 0){ar.vertices=[];for(let cr=0,Ar=bt[rr].vertices.length;cr<Ar;cr++)ar.vertices.push(bt[rr].vertices[cr].clone())}if(bt[rr].normals!==void 0){ar.normals=[];for(let cr=0,Ar=bt[rr].normals.length;cr<Ar;cr++)ar.normals.push(bt[rr].normals[cr].clone())}this.morphTargets.push(ar)}let St=rt.morphNormals;for(let rr=0,sr=St.length;rr<sr;rr++){let ar={};if(St[rr].vertexNormals!==void 0){ar.vertexNormals=[];for(let cr=0,Ar=St[rr].vertexNormals.length;cr<Ar;cr++){let _r=St[rr].vertexNormals[cr],Dr={};Dr.a=_r.a.clone(),Dr.b=_r.b.clone(),Dr.c=_r.c.clone(),ar.vertexNormals.push(Dr)}}if(St[rr].faceNormals!==void 0){ar.faceNormals=[];for(let cr=0,Ar=St[rr].faceNormals.length;cr<Ar;cr++)ar.faceNormals.push(St[rr].faceNormals[cr].clone())}this.morphNormals.push(ar)}let Mt=rt.skinWeights;for(let rr=0,sr=Mt.length;rr<sr;rr++)this.skinWeights.push(Mt[rr].clone());let Bt=rt.skinIndices;for(let rr=0,sr=Bt.length;rr<sr;rr++)this.skinIndices.push(Bt[rr].clone());let Ut=rt.lineDistances;for(let rr=0,sr=Ut.length;rr<sr;rr++)this.lineDistances.push(Ut[rr]);let Ht=rt.boundingBox;Ht!==null&&(this.boundingBox=Ht.clone());let tr=rt.boundingSphere;return tr!==null&&(this.boundingSphere=tr.clone()),this.elementsNeedUpdate=rt.elementsNeedUpdate,this.verticesNeedUpdate=rt.verticesNeedUpdate,this.uvsNeedUpdate=rt.uvsNeedUpdate,this.normalsNeedUpdate=rt.normalsNeedUpdate,this.colorsNeedUpdate=rt.colorsNeedUpdate,this.lineDistancesNeedUpdate=rt.lineDistancesNeedUpdate,this.groupsNeedUpdate=rt.groupsNeedUpdate,this}toBufferGeometry(){let rt=new Bd().fromGeometry(this),_=new BufferGeometry,ut=new Float32Array(rt.vertices.length*3);if(_.setAttribute("position",vc.call(new BufferAttribute(ut,3),rt.vertices)),rt.normals.length>0){let mt=new Float32Array(rt.normals.length*3);_.setAttribute("normal",vc.call(new BufferAttribute(mt,3),rt.normals))}if(rt.colors.length>0){let mt=new Float32Array(rt.colors.length*3);_.setAttribute("color",Lg.call(new BufferAttribute(mt,3),rt.colors))}if(rt.uvs.length>0){let mt=new Float32Array(rt.uvs.length*2);_.setAttribute("uv",Bg.call(new BufferAttribute(mt,2),rt.uvs))}if(rt.uvs2.length>0){let mt=new Float32Array(rt.uvs2.length*2);_.setAttribute("uv2",Bg.call(new BufferAttribute(mt,2),rt.uvs2))}_.groups=rt.groups;for(let mt in rt.morphTargets){let bt=[],St=rt.morphTargets[mt];for(let Mt=0,Bt=St.length;Mt<Bt;Mt++){let Ut=St[Mt],Ht=new Float32BufferAttribute(Ut.data.length*3,3);Ht.name=Ut.name,bt.push(vc.call(Ht,Ut.data))}_.morphAttributes[mt]=bt}if(rt.skinIndices.length>0){let mt=new Float32BufferAttribute(rt.skinIndices.length*4,4);_.setAttribute("skinIndex",Rg.call(mt,rt.skinIndices))}if(rt.skinWeights.length>0){let mt=new Float32BufferAttribute(rt.skinWeights.length*4,4);_.setAttribute("skinWeight",Rg.call(mt,rt.skinWeights))}return rt.boundingSphere!==null&&(_.boundingSphere=rt.boundingSphere.clone()),rt.boundingBox!==null&&(_.boundingBox=rt.boundingBox.clone()),_}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(rt){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(rt)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(rt){let _=new BufferGeometry,ut=rt.geometry;if(rt.isPoints||rt.isLine){let mt=new Float32BufferAttribute(ut.vertices.length*3,3),bt=new Float32BufferAttribute(ut.colors.length*3,3);if(_.setAttribute("position",vc.call(mt,ut.vertices)),_.setAttribute("color",Lg.call(bt,ut.colors)),ut.lineDistances&&ut.lineDistances.length===ut.vertices.length){let St=new Float32BufferAttribute(ut.lineDistances.length,1);_.setAttribute("lineDistance",BP.call(St,ut.lineDistances))}ut.boundingSphere!==null&&(_.boundingSphere=ut.boundingSphere.clone()),ut.boundingBox!==null&&(_.boundingBox=ut.boundingBox.clone())}else rt.isMesh&&(_=ut.toBufferGeometry());return _}};rn.prototype.isGeometry=!0;var Bd=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(rt){let _=[],ut,mt,bt,St=rt.faces;for(mt=0;mt<St.length;mt++){let Mt=St[mt];Mt.materialIndex!==bt&&(bt=Mt.materialIndex,ut!==void 0&&(ut.count=mt*3-ut.start,_.push(ut)),ut={start:mt*3,materialIndex:bt})}ut!==void 0&&(ut.count=mt*3-ut.start,_.push(ut)),this.groups=_}fromGeometry(rt){let _=rt.faces,ut=rt.vertices,mt=rt.faceVertexUvs,bt=mt[0]&&mt[0].length>0,St=mt[1]&&mt[1].length>0,Mt=rt.morphTargets,Bt=Mt.length,Ut;if(Bt>0){Ut=[];for(let _r=0;_r<Bt;_r++)Ut[_r]={name:Mt[_r].name,data:[]};this.morphTargets.position=Ut}let Ht=rt.morphNormals,tr=Ht.length,rr;if(tr>0){rr=[];for(let _r=0;_r<tr;_r++)rr[_r]={name:Ht[_r].name,data:[]};this.morphTargets.normal=rr}let sr=rt.skinIndices,ar=rt.skinWeights,cr=sr.length===ut.length,Ar=ar.length===ut.length;ut.length>0&&_.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let _r=0;_r<_.length;_r++){let Dr=_[_r];this.vertices.push(ut[Dr.a],ut[Dr.b],ut[Dr.c]);let $r=Dr.vertexNormals;if($r.length===3)this.normals.push($r[0],$r[1],$r[2]);else{let Jr=Dr.normal;this.normals.push(Jr,Jr,Jr)}let Br=Dr.vertexColors;if(Br.length===3)this.colors.push(Br[0],Br[1],Br[2]);else{let Jr=Dr.color;this.colors.push(Jr,Jr,Jr)}if(bt===!0){let Jr=mt[0][_r];Jr!==void 0?this.uvs.push(Jr[0],Jr[1],Jr[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",_r),this.uvs.push(new Vector2,new Vector2,new Vector2))}if(St===!0){let Jr=mt[1][_r];Jr!==void 0?this.uvs2.push(Jr[0],Jr[1],Jr[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",_r),this.uvs2.push(new Vector2,new Vector2,new Vector2))}for(let Jr=0;Jr<Bt;Jr++){let mn=Mt[Jr].vertices;Ut[Jr].data.push(mn[Dr.a],mn[Dr.b],mn[Dr.c])}for(let Jr=0;Jr<tr;Jr++){let mn=Ht[Jr].vertexNormals[_r];rr[Jr].data.push(mn.a,mn.b,mn.c)}cr&&this.skinIndices.push(sr[Dr.a],sr[Dr.b],sr[Dr.c]),Ar&&this.skinWeights.push(ar[Dr.a],ar[Dr.b],ar[Dr.c])}return this.computeGroups(rt),this.verticesNeedUpdate=rt.verticesNeedUpdate,this.normalsNeedUpdate=rt.normalsNeedUpdate,this.colorsNeedUpdate=rt.colorsNeedUpdate,this.uvsNeedUpdate=rt.uvsNeedUpdate,this.groupsNeedUpdate=rt.groupsNeedUpdate,rt.boundingSphere!==null&&(this.boundingSphere=rt.boundingSphere.clone()),rt.boundingBox!==null&&(this.boundingBox=rt.boundingBox.clone()),this}},Zi=class{constructor(rt,_,ut,mt,bt,St=0){this.a=rt,this.b=_,this.c=ut,this.normal=mt&&mt.isVector3?mt:new Vector3,this.vertexNormals=Array.isArray(mt)?mt:[],this.color=bt&&bt.isColor?bt:new Color$1,this.vertexColors=Array.isArray(bt)?bt:[],this.materialIndex=St}clone(){return new this.constructor().copy(this)}copy(rt){this.a=rt.a,this.b=rt.b,this.c=rt.c,this.normal.copy(rt.normal),this.color.copy(rt.color),this.materialIndex=rt.materialIndex;for(let _=0,ut=rt.vertexNormals.length;_<ut;_++)this.vertexNormals[_]=rt.vertexNormals[_].clone();for(let _=0,ut=rt.vertexColors.length;_<ut;_++)this.vertexColors[_]=rt.vertexColors[_].clone();return this}};function BP(rt){return this.array.set(rt),this}function Lg(rt){let _=this.array,ut=0;for(let mt=0,bt=rt.length;mt<bt;mt++){let St=rt[mt];St===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",mt),St=new Color$1),_[ut++]=St.r,_[ut++]=St.g,_[ut++]=St.b}return this}function Bg(rt){let _=this.array,ut=0;for(let mt=0,bt=rt.length;mt<bt;mt++){let St=rt[mt];St===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",mt),St=new Vector2),_[ut++]=St.x,_[ut++]=St.y}return this}function vc(rt){let _=this.array,ut=0;for(let mt=0,bt=rt.length;mt<bt;mt++){let St=rt[mt];St===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",mt),St=new Vector3),_[ut++]=St.x,_[ut++]=St.y,_[ut++]=St.z}return this}function Rg(rt){let _=this.array,ut=0;for(let mt=0,bt=rt.length;mt<bt;mt++){let St=rt[mt];St===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",mt),St=new Vector4),_[ut++]=St.x,_[ut++]=St.y,_[ut++]=St.z,_[ut++]=St.w}return this}var VP=["a","b","c"];function GP(rt,_){switch(_){case"c":return rt.c;case"b":return rt.b;case"a":default:return rt.a}}function Gd(rt,_,ut){let mt=Math.min(rt,_),bt=Math.max(rt,_),St=mt+"_"+bt;return ut.get(St)}function zd(rt,_,ut,mt,bt,St){let Mt=Math.min(rt,_),Bt=Math.max(rt,_),Ut=Mt+"_"+Bt,Ht;if(mt.has(Ut))Ht=mt.get(Ut);else{let tr=ut[Mt],rr=ut[Bt];Ht={a:tr,b:rr,newEdge:null,faces:[]},mt.set(Ut,Ht)}Ht.faces.push(bt),St[rt].edges.push(Ht),St[_].edges.push(Ht)}function zP(rt,_,ut,mt){let bt,St,Mt;for(bt=0,St=rt.length;bt<St;bt++)ut[bt]={edges:[]};for(bt=0,St=_.length;bt<St;bt++)Mt=_[bt],zd(Mt.a,Mt.b,rt,mt,Mt,ut),zd(Mt.b,Mt.c,rt,mt,Mt,ut),zd(Mt.c,Mt.a,rt,mt,Mt,ut)}function bc(rt,_,ut,mt,bt){rt.push(new Zi(_,ut,mt,void 0,void 0,bt))}function Ji(rt,_){return Math.abs(_-rt)/2+Math.min(rt,_)}function Sc(rt,_,ut,mt){rt.push([_.clone(),ut.clone(),mt.clone()])}var wc=class{constructor(rt=1){this.subdivisions=rt}modify(rt){rt instanceof BufferGeometry?rt=new rn().fromBufferGeometry(rt):rt=rt.clone(),rt.mergeVertices();let _=this.subdivisions;for(;_-- >0;)this._smooth(rt);return rt.computeFaceNormals(),rt.computeVertexNormals(),rt}_smooth(rt){let _=new Vector3,ut,mt,bt,St,Mt,Bt=rt.vertices,Ut=rt.faces,Ht=rt.faceVertexUvs[0],tr=Ht!==void 0&&Ht.length>0,rr=[],sr=new Map;zP(Bt,Ut,rr,sr);let ar=[],cr,Ar,_r,Dr,$r,Br,Jr;for(let pu of Array.from(sr.keys())){for(Ar=sr.get(pu),_r=new Vector3,$r=3/8,Br=1/8,Jr=Ar.faces.length,Jr!=2&&($r=.5,Br=0,Jr!=1),_r.addVectors(Ar.a,Ar.b).multiplyScalar($r),_.set(0,0,0),St=0;St<Jr;St++){for(Dr=Ar.faces[St],Mt=0;Mt<3&&(cr=Bt[GP(Dr,VP[Mt])],!(cr!==Ar.a&&cr!==Ar.b));Mt++);cr&&_.add(cr)}_.multiplyScalar(Br),_r.add(_),Ar.newEdge=ar.length,ar.push(_r)}let mn,Mn,$n,en,In,Rn,qn,Qn=[];for(mt=0,bt=Bt.length;mt<bt;mt++){for(Rn=Bt[mt],In=rr[mt].edges,ut=In.length,ut==3?mn=3/16:ut>3&&(mn=3/(8*ut)),Mn=1-ut*Number(mn),$n=mn,ut<=2&&(ut==2?(Mn=3/4,$n=1/8):ut==1||ut==0),qn=Rn.clone().multiplyScalar(Mn),_.set(0,0,0),St=0;St<ut;St++)en=In[St],cr=en.a!==Rn?en.a:en.b,_.add(cr);_.multiplyScalar(Number($n)),qn.add(_),Qn.push(qn)}let xs=Qn.concat(ar),cs=Qn.length,ks,_o,qs,Ss=[],eo=[],Ao,Oo,uo,uu,cu=new Vector2,Jl=new Vector2,mu=new Vector2;for(mt=0,bt=Ut.length;mt<bt;mt++)Dr=Ut[mt],ks=Number(Gd(Dr.a,Dr.b,sr).newEdge)+cs,_o=Number(Gd(Dr.b,Dr.c,sr).newEdge)+cs,qs=Number(Gd(Dr.c,Dr.a,sr).newEdge)+cs,bc(Ss,ks,_o,qs,Dr.materialIndex),bc(Ss,Dr.a,ks,qs,Dr.materialIndex),bc(Ss,Dr.b,_o,ks,Dr.materialIndex),bc(Ss,Dr.c,qs,_o,Dr.materialIndex),tr&&(Ao=Ht[mt],Oo=Ao[0],uo=Ao[1],uu=Ao[2],cu.set(Ji(Oo.x,uo.x),Ji(Oo.y,uo.y)),Jl.set(Ji(uo.x,uu.x),Ji(uo.y,uu.y)),mu.set(Ji(Oo.x,uu.x),Ji(Oo.y,uu.y)),Sc(eo,cu,Jl,mu),Sc(eo,Oo,cu,mu),Sc(eo,uo,Jl,cu),Sc(eo,uu,mu,Jl));rt.vertices=xs,rt.faces=Ss,tr&&(rt.faceVertexUvs[0]=eo)}},pt=new Vector3,Fg=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=rt.geometry??(_==null?void 0:_.geometry)??new BufferGeometry().copy(new BoxGeometry(100,100,100)),mt;_===void 0?(ut.computeBoundingBox(),ut.boundingBox.getSize(pt),mt={width:pt.x,height:pt.y,depth:pt.z,subdivisions:0}):mt=_.parameters;let bt={...mt,...rt.parameters};return{parameters:{width:Math.abs(bt.width),height:Math.abs(bt.height),depth:Math.abs(bt.depth),subdivisions:Math.abs(bt.subdivisions)},geometry:ut}}static build(rt){let{width:_,height:ut,depth:mt,subdivisions:bt}=rt.parameters,St=rt.geometry??new BufferGeometry().copy(new BoxGeometry(100,100,100)),Mt=St.userData.parameters;Mt===void 0?(St.computeBoundingBox(),St.boundingBox.getSize(pt)):pt.set(Mt.width,Mt.height,Mt.depth),(_!==pt.x||ut!==pt.y||mt!==pt.z)&&St.scale(pt.x===0?1:_/pt.x,pt.y===0?1:ut/pt.y,pt.z===0?1:mt/pt.z);let Bt=St.originalGeometry;try{bt>0?(Bt===void 0||(Mt==null?void 0:Mt.subdivisions)!==bt)&&(Bt===void 0&&(Bt=St),St=new wc(bt).modify(Bt).toBufferGeometry()):(Bt!==void 0&&(St=Bt),Bt=void 0,St.getAttribute("normal")===void 0&&St.computeVertexNormals())}catch{Bt!==void 0&&(St=Bt),Bt=void 0,St.getAttribute("normal")===void 0&&St.computeVertexNormals()}return Bt!==void 0&&Object.assign(St,{originalGeometry:Bt}),delete rt.geometry,Object.assign(St,{userData:{...rt,type:"NonParametricGeometry"}})}static loadFromUrl(rt,_,ut){new BufferGeometryLoader(ut).load(rt,mt=>{let bt=this.normalizeInputs({geometry:mt});mt.boundingBox.getSize(pt);let St=100/pt.x;Object.assign(bt.parameters,{width:100,height:pt.y*St,depth:pt.z*St}),_(this.build(bt))})}},_c=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},rt.parameters);return{shape:rt.shape&&rt.shape instanceof Ne$1?rt.shape:new Ne$1,parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??0)})}}static build(rt){let{width:_,height:ut,spikes:mt,cornerRadius:bt,depth:St,extrudeBevelSize:Mt,extrudeBevelSegments:Bt}=rt.parameters,Ut=rt.shape,Ht=_*.5,tr=ut*.5,rr=0,sr=0,ar=2*Math.PI/mt;for(let Ar=0;Ar<mt;Ar++){let _r=ar*Ar,Dr=rr+Math.sin(_r)*Ht,$r=sr+Math.cos(_r)*tr;Ut.addPoint(Ut.createPoint(Dr,$r))}Ut.isClosed=!0;for(let Ar=0,_r=Ut.points.length;Ar<_r;Ar++)Ut.points[Ar].roundness=bt;Ut.roundness=bt,Ut.update();let cr=Xt.create({shape:Ut,parameters:{roundness:bt,depth:St,extrudeBevelSize:Mt,extrudeBevelSegments:Bt}});return Object.assign(cr,{userData:{...rt,type:"PolygonGeometry"}})}},jg=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},rt.parameters);return{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??ut.width)})}}static build(rt){let{width:_,height:ut,depth:mt,radialSegments:bt,heightSegments:St,openEnded:Mt,cornerRadius:Bt,cornerSegments:Ut}=rt.parameters,Ht=new jd(_*.5,ut,bt,St,Mt,Bt,Ut);return Ht.scale(1,1,mt/_),Object.assign(Ht,{userData:{...rt,type:"PyramidGeometry"}})}};function vs(rt,_,ut){ut.x=rt.x*_.x,ut.y=rt.y,ut.z=rt.x*_.y}function Fd(rt,_,ut,mt,bt,St){let Mt=_.clone().sub(rt),Bt=ut.clone().sub(rt),Ut=Mt.angleTo(Bt);if(Mt.normalize(),Bt.normalize(),mt===bt){let Ht=Mt.add(Bt).normalize();St.copy(rt).addScaledVector(Ht,mt/Math.sin(Ut/2))}else{let Ht=Mt.angleTo(Bt);St.copy(rt),St.addScaledVector(Mt,bt/Math.sin(Ht)),St.addScaledVector(Bt,mt/Math.sin(Ht))}}function UP(rt,_,ut){let mt=rt.clone().sub(_),bt=ut.clone().sub(_);return mt.projectOnVector(bt),mt.add(_)}var jd=class extends BufferGeometry{constructor(rt=.5,_=1,ut=4,mt=1,bt=!1,St=0,Mt=4){super(),ut=Math.floor(Math.max(3,ut)),mt=Math.floor(mt),Mt=Math.floor(Mt);let Bt=[],Ut=[],Ht=[],tr=[],rr=0,sr=_/2,ar=Math.PI/ut,cr=rt*Math.cos(Math.PI/ut),Ar=2*Math.PI/ut,_r=(ut-2)*Math.PI/ut,Dr=Math.PI-_r,$r=new Vector3(0,-sr,0),Br=new Vector3(0,sr,0),Jr=new Vector2(rt,-sr),mn=new Vector2(cr,-sr),Mn=new Vector2(0,Br.y).sub(mn),$n=new Vector2(0,Br.y).sub(Jr),en=new Vector2(Mn.y,-Mn.x).normalize(),In=new Vector2($n.y,-$n.x).normalize(),Rn=rt*Math.cos(Math.PI/ut)*Math.tan((Math.PI-Mn.angle())/2)-1e-8;St=Math.min(St,Rn);let qn;{let qs=new Vector3(en.x,en.y,0),Ss=new Vector3(Math.cos(Ar)*qs.x,qs.y,Math.sin(Ar)*qs.x);qn=qs.angleTo(Ss)}let Qn=St/Math.tan((Math.PI-Mn.angle())/2),xs=St/Math.tan((Math.PI-qn)/2),cs=new Vector3;if(!bt){Ut.push($r.x,$r.y,$r.z),Ht.push(0,-1,0),tr.push(0,0);let qs=rr++,Ss=[],eo=Jr.clone(),Ao=Qn/Math.cos(Math.PI/ut);eo.x-=Ao;for(let Oo=0;Oo<ut;Oo++){let uo=Oo/ut*Math.PI*2+ar,uu=new Vector2(Math.sin(uo),Math.cos(uo));vs(eo,uu,cs),Ut.push(cs.x,cs.y,cs.z),Ht.push(0,-1,0),tr.push(0,0),Ss.push(rr++)}for(let Oo=0;Oo<Ss.length;Oo++)Bt.push(Ss[Oo],qs,Ss[(Oo+1)%Ss.length])}{let qs=new Vector3,Ss=new Vector3,eo=new Vector3,Ao=new Vector3,Oo=new Vector3,uo=new Vector3;for(let uu=0;uu<ut;uu++){let cu=uu/ut*Math.PI*2+ar,Jl=(uu+.5)/ut*Math.PI*2+ar,mu=(uu+1)/ut*Math.PI*2+ar,pu=new Vector2(Math.sin(cu),Math.cos(cu)),Zu=new Vector2(Math.sin(Jl),Math.cos(Jl)),Mp=new Vector2(Math.sin(mu),Math.cos(mu));vs(Jr,pu,Ss),vs(Jr,Mp,eo),vs(en,Zu,qs),Fd(Br,Ss,eo,xs,xs,Ao),Ut.push(Ao.x,Ao.y,Ao.z),Fd(Ss,Br,eo,xs,Qn,Oo),Ut.push(Oo.x,Oo.y,Oo.z),Fd(eo,Ss,Br,Qn,xs,uo),Ut.push(uo.x,uo.y,uo.z),Ht.push(qs.x,qs.y,qs.z),Ht.push(qs.x,qs.y,qs.z),Ht.push(qs.x,qs.y,qs.z),tr.push(0,0),tr.push(0,0),tr.push(0,0);let Up=rr++,Ep=rr++,mp=rr++;if(Bt.push(Up,Ep,mp),St>0){{let _g=Ss.clone().add(eo).multiplyScalar(.5),m0=Br.clone().sub(_g).normalize(),K0=$r.clone().sub(_g).normalize().add(m0).normalize().multiplyScalar(-1),Jp=uo.clone().sub(Oo);ks(_g,Jp,K0,Mn.angle())}let Cp,t0;{let _g=new Vector3;vs(In,Mp,_g);let m0=uo.clone().add(Ao).multiplyScalar(.5);m0=UP(m0,eo,Br);let K0=uo.clone().sub(Ao);[Cp,t0]=ks(m0,K0,_g,qn,Ao.y)}{let _g=Cp,m0=_g.clone().setY(0).normalize(),K0=new Vector3(0,-1,0),Jp=m0.clone().cross(K0);_o(_g,m0,K0,Jp)}{let _g=Mn.angle(),m0=Math.PI-_g,K0=Br.clone();K0.y-=St/Math.sin(_g-Math.PI/2);let Jp=new Vector3,y0=[];for(let jm=0;jm<Mt;jm++){let Nu=[],Co=Math.PI/2-m0*jm/Mt,Bp=Math.cos(Co),a0=Math.sin(Co),Q0=Jl;for(let T0=0;T0<=jm;T0++){let av=Math.cos(Q0),lv=Math.sin(Q0);qs.x=Bp*lv,qs.y=a0,qs.z=Bp*av,Jp.copy(K0).addScaledVector(qs,St),Ut.push(Jp.x,Jp.y,Jp.z),Ht.push(qs.x,qs.y,qs.z),tr.push(0,0),Nu.push(rr++),Q0+=Math.PI*2/jm/ut}y0.push(Nu)}t0.reverse(),y0.push(t0);let z0=y0.length-1;for(let jm=0;jm<z0;jm++){let Nu=y0[jm],Co=y0[jm+1],Bp=Nu.length-1;Bt.push(Co[1],Nu[0],Co[0]);for(let a0=1;a0<=Bp;a0++)Bt.push(Nu[a0],Nu[a0-1],Co[a0]),Bt.push(Co[a0+1],Nu[a0],Co[a0])}}}}}this.setIndex(Bt),this.setAttribute("position",new Float32BufferAttribute(Ut,3)),this.setAttribute("normal",new Float32BufferAttribute(Ht,3)),this.setAttribute("uv",new Float32BufferAttribute(tr,2));function ks(qs,Ss,eo,Ao,Oo){let uo=-Ao/2,uu=(Math.PI-Ao)/2,cu=Ss.clone().normalize().cross(eo);qs.addScaledVector(eo,-St/Math.sin(uu));let Jl=new Vector3,mu=new Vector3,pu=1,Zu=rr,Mp=[];for(let Up=0;Up<=Mt;Up++){let Ep=uo+Up/Mt*Ao;mu.set(0,0,0),mu.addScaledVector(cu,Math.sin(Ep)),mu.addScaledVector(eo,Math.cos(Ep));for(let mp=0;mp<=pu;mp++){let Cp=mp/pu-.5;if(Jl.copy(qs),Jl.addScaledVector(Ss,Cp),Jl.addScaledVector(mu,St),Oo!=null){let t0=Math.max(0,Jl.y-Oo);Jl.addScaledVector(Ss,-t0/Ss.y)}Ut.push(Jl.x,Jl.y,Jl.z),Ht.push(mu.x,mu.y,mu.z),tr.push(0,0),mp===0&&Mp.push(rr),rr++}}for(let Up=0;Up<Mt;Up++)for(let Ep=0;Ep<pu;Ep++){let mp=Zu+Ep+(pu+1)*Up,Cp=mp+(pu+1),t0=Cp+1,_g=mp+1;Bt.push(mp,Cp,_g),Bt.push(Cp,t0,_g)}return[qs.clone().addScaledVector(Ss,.5),Mp]}function _o(qs,Ss,eo,Ao){let Oo=Math.PI/2,uo=$n.angle()-Oo,uu=[],cu=new Vector3,Jl=new Vector3;for(let pu=0;pu<=Mt;pu++){let Zu=[],Mp=pu/Mt;for(let Up=0;Up<=pu;Up++){let Ep=((pu?Up/pu:0)-.5)*Dr,mp=Math.cos(Ep),Cp=Math.sin(Ep),t0=Math.atan(Math.tan(uo)*mp),_g=(Oo+t0)*Mp,m0=Math.cos(_g),K0=Math.sin(_g);cu.set(0,0,0),cu.addScaledVector(Ss,K0*mp),cu.addScaledVector(eo,m0),cu.addScaledVector(Ao,K0*Cp),Jl.copy(qs).addScaledVector(cu,St),Ut.push(Jl.x,Jl.y,Jl.z),Ht.push(cu.x,cu.y,cu.z),tr.push(0,0),Zu.push(rr++)}uu.push(Zu)}let mu=uu.length-1;for(let pu=0;pu<mu;pu++){let Zu=uu[pu],Mp=uu[pu+1],Up=Zu.length-1;Bt.push(Zu[0],Mp[1],Mp[0]);for(let Ep=1;Ep<=Up;Ep++)Bt.push(Zu[Ep-1],Zu[Ep],Mp[Ep]),Bt.push(Zu[Ep],Mp[Ep+1],Mp[Ep])}}}},Ac=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},rt.parameters),mt=Object.assign((_==null?void 0:_.ui)??{enabledIndieCorners:!1},rt.ui);return{shape:rt.shape&&rt.shape instanceof Ne$1?rt.shape:new Ne$1,parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??0)}),ui:mt}}static build(rt){let _=rt.shape,{width:ut,height:mt,cornerRadius:bt,cornerType:St,depth:Mt,extrudeBevelSize:Bt,extrudeBevelSegments:Ut}=rt.parameters,Ht={x:ut*.5,y:mt*.5},tr={x:-Ht.x,y:-Ht.y},rr={x:Ht.x,y:Ht.y};function sr(Jr,mn,Mn){return mn>ut&&Mn>mt?Math.min(Jr*ut/mn,Jr*mt/Mn):mn>ut?Jr*ut/mn:Mn>mt?Jr*mt/Mn:Jr}let ar=[];ar[0]=bt[0]===0?0:sr(bt[0],bt[0]+bt[3],bt[0]+bt[1]),ar[1]=bt[1]===0?0:sr(bt[1],bt[1]+bt[2],bt[1]+bt[0]),ar[2]=bt[2]===0?0:sr(bt[2],bt[2]+bt[1],bt[2]+bt[3]),ar[3]=bt[3]===0?0:sr(bt[3],bt[3]+bt[0],bt[3]+bt[2]);let cr=tr.x,Ar=rr.x,_r=rr.y,Dr=tr.y;_.addPoint(_.createPoint(cr,_r)),_.addPoint(_.createPoint(Ar,_r)),_.addPoint(_.createPoint(Ar,Dr)),_.addPoint(_.createPoint(cr,Dr)),_.isClosed=!0;let $r=!0;for(let Jr=0,mn=_.points.length;Jr<mn;Jr++)_.points[Jr].roundness=ar[Jr],Jr>0&&ar[Jr]!==ar[Jr-1]&&($r=!1);$r&&(_.roundness=ar[0]),_.useCubicForRoundedCorners=St!==1,_.update();let Br=Xt.create({shape:_,parameters:{depth:Mt,extrudeBevelSize:Bt,extrudeBevelSegments:Ut}});return Object.assign(Br,{userData:{...rt,type:"RectangleGeometry"}})}},Hg=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:180},rt.parameters);return ut.thetaLength=MathUtils.clamp(ut.thetaLength,0,180),{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??ut.width)})}}static build(rt){let{width:_=100,height:ut=_,depth:mt=_,widthSegments:bt=64,heightSegments:St=64,phiStart:Mt,phiLength:Bt,thetaStart:Ut,thetaLength:Ht}=rt.parameters,tr;return Ht===0?(tr=new BufferGeometry,tr.setAttribute("position",new Float32BufferAttribute([],3))):tr=new SphereGeometry(.5*_,bt,St,Mt,Bt,Ut,Ht*MathUtils.DEG2RAD),tr.scale(1,ut/_,mt/_),Object.assign(tr,{userData:{...rt,type:"SphereGeometry"}})}},qg=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},rt.parameters);return{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:0})}}static build(rt){let{width:_=100,height:ut=_,widthSegments:mt=8,heightSegments:bt=8}=rt.parameters,St=new PlaneGeometry(_,ut,mt,bt);return St.scale(1,1,1),Object.assign(St,{userData:{...rt,type:"PlaneGeometry"}})}},Wg=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},rt.parameters);return{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??ut.width)})}}static build(rt){let{width:_,height:ut,depth:mt,angle:bt,cornerRadius:St,cornerSegments:Mt}=rt.parameters,Bt=new Hd(_,ut,mt,bt,St,Mt);return Object.assign(Bt,{userData:{...rt,type:"BackdropGeometry"}})}},Hd=class extends BufferGeometry{constructor(rt=1,_=1,ut=1,mt=90,bt=10,St=24){super(),this.type="BackdropGeometry";let Mt=[],Bt=[],Ut=[],Ht=.001;bt==0&&(St=1),St=Math.max(1,Math.floor(St)),bt=Math.min(bt,100),mt=Math.min(180-Ht,mt),mt*=Math.PI/180;let tr=[],rr=Math.PI/2,sr=(pu=0,Zu=0,Mp=0)=>new Vector3(pu,Zu,Mp),ar=sr(),cr=sr(),[Ar,_r,Dr]=[_/2,rt/2,ut/2],$r=-_r,Br=+_r,[Jr,mn,Mn]=[sr($r,-Ar,+Dr),sr($r,-Ar,-Dr),sr($r,+Ar,-Dr)],$n=(pu,Zu=!1)=>Math.sin(pu-Math.PI/(1+ +Zu)),en=(pu,Zu=!1)=>Math.cos(pu-Math.PI/(1+ +Zu));Mn.y=Math.sin(mt)*_-Ar;let In=Math.cos(mt)*_-Dr,Rn=Jr.z-Ht;mt<=rr?(Mn.z=Math.min(In,Rn),Mn.z==Rn&&(Mn.y-=(In-Rn)/Math.tan(rr-mt))):mn.z=Math.min(mn.z-In-Dr,Jr.z-Ht),ar.subVectors(Jr,mn),cr.subVectors(Mn,mn);let qn=Math.min(ar.length(),cr.length())*bt/100,Qn=qn*Math.tan(mt/2),xs=qn/Math.cos(mt/2),cs=ar.clone().normalize().add(cr.normalize()).setLength(xs).add(mn);ar.set(0,$n(mt,!0),en(mt,!0)),tr.push([Mn,ar.clone()]);let ks=(Math.PI-mt)/St;for(let pu=0;pu<=St;pu++){let Zu=rr+mt+pu*ks;ar.set(0,Math.sin(Zu)*Qn,Math.cos(Zu)*Qn),ar.add(cs),cr.set(0,$n(Zu),en(Zu)),tr.push([ar.clone(),cr.clone()])}tr.push([Jr,sr(0,1,0)]);let _o=Math.sin(ks/2)*Qn*2,qs=tr.length-1,Ss=tr[0][0].distanceTo(tr[1][0]),eo=tr[qs-1][0].distanceTo(tr[qs][0]),Ao=Ss+_o*St+eo;tr[0].push(1);for(let pu=0;pu<=St;pu++)tr[pu+1].push(1-(Ss+pu*_o)/Ao);tr[qs].push(0);let[Oo,uo,uu]=tr[0],cu,Jl,mu;for(let pu=1;pu<tr.length;pu++)[cu,Jl,mu]=tr[pu],Mt.push($r,Oo.y,Oo.z,$r,cu.y,cu.z,Br,Oo.y,Oo.z,Br,Oo.y,Oo.z,$r,cu.y,cu.z,Br,cu.y,cu.z),Bt.push(0,uo.y,uo.z,0,Jl.y,Jl.z,0,uo.y,uo.z,0,uo.y,uo.z,0,Jl.y,Jl.z,0,Jl.y,Jl.z),Ut.push(0,uu,0,mu,1,uu,1,uu,0,mu,1,mu),[Oo,uo,uu]=[cu,Jl,mu];this.setAttribute("position",new Float32BufferAttribute(Mt,3)),this.setAttribute("normal",new Float32BufferAttribute(Bt,3)),this.setAttribute("uv",new Float32BufferAttribute(Ut,2))}},Tc=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},rt.parameters);return{shape:rt.shape&&rt.shape instanceof Ne$1?rt.shape:new Ne$1,parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??0)})}}static build(rt){let{width:_,height:ut,innerRadiusPercent:mt,spikes:bt,cornerRadius:St,angle:Mt,depth:Bt,extrudeBevelSize:Ut,extrudeBevelSegments:Ht}=rt.parameters,tr=rt.shape,rr=_*.5,sr=ut*.5,ar=0,cr=0,Ar=Mt*Math.PI/360/bt,_r=Math.PI/2*3*-1,Dr=rr*mt/100,$r=sr*mt/100;if(bt===3&&mt===50){Ar=2*Math.PI/bt;for(let Jr=0;Jr<bt;Jr++){let mn=Ar*Jr,Mn=ar+Math.sin(mn)*rr,$n=cr+Math.cos(mn)*sr;tr.addPoint(tr.createPoint(Mn,$n))}}else for(let Jr=0;Jr<bt;Jr++){let mn=ar+Math.cos(_r)*rr,Mn=cr+Math.sin(_r)*sr;tr.addPoint(tr.createPoint(mn,Mn)),_r+=Ar,mn=ar+Math.cos(_r)*Dr,Mn=cr+Math.sin(_r)*$r,tr.addPoint(tr.createPoint(mn,Mn)),_r+=Ar}tr.isClosed=!0;for(let Jr=0,mn=tr.points.length;Jr<mn;Jr++)tr.points[Jr].roundness=St;tr.roundness=St,tr.update();let Br=Xt.create({shape:tr,parameters:{roundness:St,depth:Bt,extrudeBevelSize:Ut,extrudeBevelSegments:Ht}});return Object.assign(Br,{userData:{...rt,type:"StarGeometry"}})}},$g=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,depth:0},rt.parameters);return{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??0)})}}static build(rt){let{width:_,height:ut}=rt.parameters,mt=new PlaneGeometry(_,ut);return Object.assign(mt,{userData:{...rt,type:"TextFrameGeometry"}})}},Yg=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:360,cornerRadius:30,cornerSegments:8},rt.parameters),mt=Math.abs(ut.width),bt=Math.abs(ut.height??ut.width),St=Math.round(Math.abs(ut.depth??ut.width*.25));return{parameters:Object.assign(ut,{width:mt,height:bt,depth:St})}}static build(rt){let{width:_,height:ut,depth:mt,radialSegments:bt,tubularSegments:St,arc:Mt,cornerRadius:Bt,cornerSegments:Ut}=rt.parameters,Ht=e2(_,ut,mt,_*.5,Mt,St,0,0,bt,Bt,Ut);return Ht.scale(1,ut/_,1),Object.assign(Ht,{userData:{...rt,type:"TorusGeometry"}})}};function e2(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr){[_,ut]=[ut,_],Mt=_/2;let rr=MathUtils.clamp(bt/360,0,1);if(rr===0){let sr=new BufferGeometry;return sr.setAttribute("position",new Float32BufferAttribute([],3)),sr}return rr===1&&(Ht=0),new ys(!0,rt,_,ut,mt,rr,St,Mt,Bt,Ut,Ht,tr)}var Xg=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},rt.parameters);return{parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width),depth:Math.abs(ut.depth??ut.width),tube:ut.tube??ut.width*.125})}}static build(rt){let{width:_,tube:ut,tubularSegments:mt,radialSegments:bt,p:St,q:Mt}=rt.parameters,Bt=_*.5;Bt!==ut&&(Bt-=ut);let Ut=new TorusKnotGeometry(Bt,ut,mt,bt,St,Mt);return Object.assign(Ut,{userData:{...rt,type:"TorusKnotGeometry"}})}},Kg=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},rt.parameters);return{shape:rt.shape&&rt.shape instanceof Ne$1?rt.shape:new Ne$1,parameters:Object.assign(ut,{width:Math.abs(ut.width),height:Math.abs(ut.height??ut.width*(ut.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(ut.depth??0)})}}static build(rt){let{width:_=100,height:ut,cornerRadius:mt,depth:bt,extrudeBevelSize:St,extrudeBevelSegments:Mt,isRect:Bt}=rt.parameters,Ut=rt.shape,Ht=_*.5,tr=ut*.5;Bt?(Ut.addPoint(Ut.createPoint(-Ht,tr)),Ut.addPoint(Ut.createPoint(Ht,-tr)),Ut.addPoint(Ut.createPoint(-Ht,-tr))):(Ut.addPoint(Ut.createPoint(0,tr)),Ut.addPoint(Ut.createPoint(Ht,-tr)),Ut.addPoint(Ut.createPoint(-Ht,-tr))),Ut.isClosed=!0;for(let sr=0,ar=Ut.points.length;sr<ar;sr++)Ut.points[sr].roundness=mt;Ut.roundness=mt,Ut.update();let rr=Xt.create({shape:Ut,parameters:{roundness:mt,depth:bt,extrudeBevelSize:St,extrudeBevelSegments:Mt}});return Object.assign(rr,{userData:{...rt,type:"TriangleGeometry"}})}};function Qg(rt,_){let ut=2*Math.PI;return(rt%ut+ut)%ut===(_%ut+ut)%ut}var o2=new Matrix4,n2=new Matrix4;function i2(rt,_,ut){let mt=[new Vector3,new Vector3,new Vector3],bt=[new Vector3,new Vector3,new Vector3];return rt.extractBasis(mt[0],mt[1],mt[2]),_.extractBasis(bt[0],bt[1],bt[2]),mt.forEach((St,Mt)=>{let Bt=bt[Mt],Ut=MathUtils.lerp(St.length(),Bt.length(),ut);St.lerp(Bt,ut).setLength(Ut)}),new Matrix4().makeBasis(mt[0],mt[1],mt[2])}var e0=class{static create(rt){return this.build(this.normalizeInputs(rt))}static normalizeInputs(rt,_){let ut=Object.assign({},(_==null?void 0:_.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},rt.parameters),mt=Math.abs(ut.width),bt=Math.abs(ut.height??ut.width),St=Math.abs(ut.depth??0),Mt=(_==null?void 0:_.shapeData)??Ki.create({parameters:Uu}).userData.shape;return{path:rt.path??Mi.defaultData(),parameters:Object.assign(ut,{width:mt,height:bt,depth:St,extrusion:{...jl,...ut.extrusion}}),shapeData:Mt}}static build(rt){if(rt.path.points.length>=2){let _=new qd(rt);return Object.assign(_,{userData:{...rt,type:"PathGeometry"}})}else return Object.assign(new BufferGeometry,{userData:{...rt,type:"PathGeometry"}})}},qd=class extends BufferGeometry{constructor(rt){super(),this.type="PathExtrusionGeometry",this.inputs=rt,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let rt=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&rt.depth===1)||!Qg(rt.twist,0)||rt.startScale!==rt.endScale}build(){let rt=this._extractPathPoints();if(rt.length<2)return;let _=this._computeBasisMatrices(rt),{depth:ut,offset:mt}=this.inputs.parameters.extrusion;ut=Math.max(0,Math.min(ut,1)),mt=Math.max(0,Math.min(mt,1));let bt=this.inputs.path.isClosed?rt.length:rt.length-1,St=Math.floor(mt*bt),Mt=this.inputs.path.isClosed?Math.ceil((ut+mt)*bt):Math.ceil(Math.min(1,ut+mt)*bt),Bt=Math.min(Math.max(2,Mt-St+1),bt+2),Ut=[],Ht=[];for(let qs=0;qs<Bt;qs++){let Ss=this.inputs.path.isClosed?(qs+St)%rt.length:Math.min(qs+St,rt.length-1);Ut.push(rt[Ss].clone()),Ht.push(_[Ss].clone())}let tr=(qs,Ss,eo)=>{Ut[qs]=Ut[qs].clone().lerp(Ut[Ss],eo),Ht[qs]=i2(Ht[qs],Ht[Ss],eo)},rr=0,sr=mt*bt%1;(!this.inputs.path.isClosed||ut<=1)&&(sr||mt===0)&&(rr=sr,tr(0,1,rr));let ar=0,cr=(mt+ut)*bt%1;if((this.inputs.path.isClosed&&ut<=1||!this.inputs.path.isClosed&&mt+ut<1)&&cr&&(ar=cr,tr(Ut.length-1,Ut.length-2,1-ar)),ut===0){let qs=Ut.length-1;Ut[qs].copy(Ut[0]),Ht[qs].copy(Ht[0])}this._applyPathModifiers(Ht,rr,ar);let{bevel:Ar,bevelSides:_r}=this.inputs.parameters.extrusion,Dr=Ar>0?this.inputs.parameters.extrusion.capType:"flat",$r=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&($r=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:Br,infos:Jr,vertices:mn}=this._computeShapePoints($r),Mn=0,$n;Dr==="round"&&($n=new tn(this.inputs.shapeData,2*Ar,Ar,$r,_r,void 0,!0),Mn=$n.getAttribute("position").count);let en=0,In=0;Jr.sort((qs,Ss)=>qs.start-Ss.start),Jr.forEach(qs=>{qs.verticesStart=en,qs.verticesCount=qs.continuous.reduce((Ss,eo,Ao)=>Ss+(Ao===0||!eo?2:1),0),In+=qs.verticesCount,en=In});let Rn=In*Bt,qn,Qn=0;if(this._isOpenEnded()&&Dr==="flat"){try{qn=Cr({windingRule:Pe.ODD,elementType:Xe.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:Br})}catch{qn=Id}Qn=qn.vertexCount}let xs=Rn+2*Qn+Mn*2,cs=Rn+2*Qn,ks={positions:new Float32Array(xs*3),normals:new Float32Array(xs*3),uvs:new Float32Array(xs*2)},_o=[];if(Jr.forEach(qs=>{this._extrudeRegion(qs,mn,Ht,Ut,ks,_o,this._isGeometryClosed()&&!this._isOpenEnded())}),qn&&(this._closeEnd(qn,Rn,_o,ks,Ht[0],Ut[0],!1),this._closeEnd(qn,Rn+Qn,_o,ks,Ht[Ht.length-1],Ut[Ut.length-1],!0)),$n){ks.positions.set($n.getAttribute("position").array,cs*3),ks.normals.set($n.getAttribute("normal").array,cs*3),ks.uvs.set($n.getAttribute("uv").array,cs*2);let qs=_o.length;_o.push(...$n.getIndex().array.map(Ao=>Ao+cs)),cs+=Mn,ks.positions.set($n.getAttribute("position").array,cs*3),ks.normals.set($n.getAttribute("normal").array,cs*3),ks.uvs.set($n.getAttribute("uv").array,cs*2);let Ss=_o.length;_o.push(...$n.getIndex().array.map(Ao=>Ao+cs)),this.setAttribute("position",new BufferAttribute(ks.positions,3)),this.setAttribute("normal",new BufferAttribute(ks.normals,3)),this.setAttribute("uv",new BufferAttribute(ks.uvs,2)),this.setIndex(_o);let eo=o2;eo.copy(Ht[Ht.length-1]).setPosition(Ut[Ut.length-1]),this.applyMatrix4OnRange(eo,cs,xs),eo.copy(Ht[0]).setPosition(Ut[0]).multiply(n2.makeScale(1,1,-1)),this.applyMatrix4OnRange(eo,cs-Mn,cs),this.reverseIndicesOnRange(qs,Ss)}else this.setAttribute("position",new BufferAttribute(ks.positions,3)),this.setAttribute("normal",new BufferAttribute(ks.normals,3)),this.setAttribute("uv",new BufferAttribute(ks.uvs,2)),this.setIndex(_o)}_extractPathPoints(){let rt=nc(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(rt.length<2)return[];let _=[rt[0]];return rt.forEach(ut=>{_[_.length-1].distanceToSquared(ut)>.001&&_.push(ut)}),this.inputs.path.isClosed&&_[_.length-1].distanceTo(_[0])<.001&&_.pop(),_}_computeBasisMatrices(rt){let _=[],ut=rt.length,mt=this.inputs.path.isClosed,bt=new Vector3,St=new Vector3,Mt=new Vector3,Bt=new Vector3,Ut=new Vector3(0,1,0);for(let cr=0;cr<ut;cr++){let Ar=rt[cr],_r;cr===0?_r=mt?rt[rt.length-2]:Ar.clone().multiplyScalar(2).sub(rt[1]):_r=rt[cr-1];let Dr;cr===ut-1?Dr=mt?rt[1]:Ar.clone().multiplyScalar(2).sub(rt[cr-1]):Dr=rt[cr+1];let $r=Ar.clone().sub(_r).normalize(),Br=Dr.clone().sub(Ar).normalize(),Jr=$r.clone().add(Br).normalize();Mt.copy(Jr),cr===0&&(Jr.equals(Ut)||Jr.clone().negate().equals(Ut))&&Ut.set(0,0,1);let mn=Ut.clone().cross(Jr).normalize(),Mn=Jr.clone().cross(mn).normalize();Ut.copy(Mn),Bt.copy(mn),cr===0&&(bt.copy(Mn),St.copy(Jr));let $n=new Matrix4().makeBasis(mn,Mn,Jr);_.push($n)}let Ht=mt?St:Mt,tr=mt?bt:new Vector3(0,1,0),rr=Ht.clone().cross(Bt).normalize(),sr=Math.acos(tr.dot(rr));if(isNaN(sr))return _;let ar=tr.clone().cross(rr);Ht.dot(ar)>0&&(sr*=-1);for(let cr=1;cr<_.length;cr++){let Ar=new Matrix4().makeRotationZ(sr*cr/_.length);_[cr].multiply(Ar)}return _}_applyPathModifiers(rt,_,ut){let mt=rt.length,{angle:bt,twist:St,startScale:Mt,endScale:Bt}=this.inputs.parameters.extrusion,Ut=new Matrix4,Ht=new Matrix4;return rt.forEach((tr,rr)=>{let sr=rr===0?0:rr===mt-1?1:(rr-_)/(mt-(ut===0?0:1)-(_+(1-ut)));Ut.makeRotationZ(MathUtils.lerp(bt,bt+St,sr)*MathUtils.DEG2RAD);let ar=MathUtils.lerp(Mt,Bt,sr);Ht.makeScale(ar,ar,ar),tr.multiply(Ut).multiply(Ht)}),rt}_computeShapePoints(rt=12,_=Pe.ODD){let ut=this.inputs.shapeData,mt=ut.extractShapePointsToFlatArray([],rt),bt=ut.shapeHoles.map(Ht=>{let tr=Ht.extractShapePointsToFlatArray([],rt),rr=[];for(let sr=tr.length-1;sr>=1;sr-=2){let ar=tr[sr-1],cr=tr[sr-0];rr.push(ar,cr)}return rr}),St;try{St=Cr({windingRule:_,elementType:Xe.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[mt]})}catch{St=ms}let Mt;try{Mt=Cr({windingRule:Pe.ODD,elementType:Xe.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...bt]})}catch{Mt=Md}if(!St)throw new Error("error generating geometry");let Bt=St.elementCount;if(Mt){St.elementCount+=Mt.elementCount;for(let Ht=0;Ht<Mt.elements.length;Ht++){let tr=Mt.elements[Ht],rr=Ht%2===0?St.vertexCount:0;St.elements.push(tr+rr)}for(let Ht=0;Ht<Mt.vertexIndices.length;Ht++){let tr=Mt.vertexIndices[Ht],rr=St.vertexCount;St.vertexIndices.push(tr+rr)}for(let Ht=0;Ht<Mt.vertices.length;Ht++){let tr=Mt.vertices[Ht];St.vertices.push(tr)}}for(let Ht=0,tr=St.vertexCount;Ht<tr;Ht++){let rr=Ht*2;St.vertices[rr+0],St.vertices[rr+1]}let Ut=[];for(let Ht=St.elementCount-1;Ht>=0;Ht--){let tr=Ht>=Bt,rr=Ht*2,sr=St.elements[rr+0],ar=St.elements[rr+1],cr=sr+ar,Ar={start:sr,count:ar,normals:[],isHole:tr,continuous:[],verticesStart:0,verticesCount:0};Ut.push(Ar);let _r=sr,Dr=cr-1,$r=sr+1,Br=ut.roundedCurves.length;do{let Jr=_r-sr;St.vertices[Dr*2+0],St.vertices[Dr*2+1];let mn=St.vertices[_r*2+0],Mn=St.vertices[_r*2+1],$n=St.vertices[$r*2+0],en=St.vertices[$r*2+1],In=mn-$n,Rn=Mn-en,qn=Math.sqrt(In*In+Rn*Rn);In/=qn,Rn/=qn,Ar.normals[Jr*2+0]=-Rn,Ar.normals[Jr*2+1]=In;let Qn=St.vertexIndices[_r];if(Array.isArray(Qn))Ar.continuous[Jr]=!1;else{let[xs,cs]=ut.getCurveIndexFromVertexId(Qn-1,!0);if(cs>0&&cs<1)Ar.continuous[Jr]=!0;else{let ks=cs===1?xs+1:xs-1;ks=(ks+Br)%Br;let _o=cs===1?0:1,qs=ut.roundedCurves[xs].getTangent(cs),Ss=ut.roundedCurves[ks].getTangent(_o);Ar.continuous[Jr]=qs.dot(Ss)>.95}}tr&&(Ar.normals[Jr*2+0]*=-1,Ar.normals[Jr*2+1]*=-1),[Dr,_r,$r]=[_r,$r,$r+1],$r>=cr&&($r-=ar)}while($r!==sr+1)}return{regions:[mt,...bt],infos:Ut,vertices:St.vertices}}_insertVertex(rt,_,ut,mt,bt){let St=_*2,Mt=_*3;rt.positions[Mt+0]=ut.x,rt.positions[Mt+1]=ut.y,rt.positions[Mt+2]=ut.z,rt.normals[Mt+0]=mt.x,rt.normals[Mt+1]=mt.y,rt.normals[Mt+2]=mt.z,rt.uvs[St+0]=bt.x,rt.uvs[St+1]=bt.y}_extrudeRegion(rt,_,ut,mt,bt,St,Mt){let Bt=new Vector3,Ut=new Vector3,Ht=new Vector3,tr=new Vector3,rr=new Vector2;ut.forEach((ar,cr)=>{let Ar=mt[cr],_r=rt.verticesStart*ut.length+rt.verticesCount*cr;for(let Dr=0;Dr<rt.count;Dr++){let $r=(rt.start+Dr)*2;if(Bt.set(_[$r+0],_[$r+1],0),Ht.copy(Bt).applyMatrix4(ar).add(Ar),rt.continuous[Dr])tr.set(rt.normals[Dr*2+0],rt.normals[Dr*2+1],0);else{let Br=Dr===0?(rt.start+rt.count-1)*2:$r-2;Ut.set(_[Br+0],_[Br+1],0),tr.copy(Bt).sub(Ut),tr.set(-tr.y,tr.x,0),rt.isHole||tr.negate()}if(tr.applyMatrix4(ar).normalize(),rr.set(Dr===0?1:Dr/rt.count,cr/(ut.length-1)),this._insertVertex(bt,_r,Ht,tr,rr),_r++,!rt.continuous[Dr]||Dr===0){if(Dr===0)tr.set(rt.normals[Dr*2+0],rt.normals[Dr*2+1],0),rr.set(0,cr/(ut.length-1));else{let Br=Dr===rt.count-1?rt.start*2:$r+2;Ut.set(_[Br+0],_[Br+1],0),tr.copy(Ut).sub(Bt),tr.set(-tr.y,tr.x,0),rt.isHole||tr.negate()}tr.applyMatrix4(ar).normalize(),this._insertVertex(bt,_r,Ht,tr,rr),_r++}}});let sr=ut.length-1;for(let ar=0;ar<sr;ar++){let cr=rt.verticesStart*ut.length+rt.verticesCount*ar,Ar=rt.verticesStart*ut.length+rt.verticesCount*(ar+1),_r=0;for(let Dr=0;Dr<rt.count;Dr++){(!rt.continuous[Dr]||Dr===0)&&_r++;let $r=Dr===rt.count-1?0:_r+1,Br=cr+_r,Jr=cr+$r,mn=Ar+$r,Mn=Ar+_r;rt.isHole?St.push(Br,mn,Jr,Br,Mn,mn):St.push(Br,Jr,mn,Br,mn,Mn),_r++}}}_closeEnd(rt,_,ut,mt,bt,St,Mt){let Bt=rt.vertexCount,Ut=new Vector3(0,0,Mt?-1:1).applyMatrix4(bt),Ht=new Vector3,tr=new Vector2;for(let sr=0;sr<Bt;sr++){let ar=2*sr;Ht.set(rt.vertices[ar+0],rt.vertices[ar+1],0).applyMatrix4(bt).add(St),this._insertVertex(mt,_+sr,Ht,Ut,tr)}let rr=rt.elements;for(let sr=0;sr<rt.elementCount;sr++){let ar=3*sr,cr=rr[ar+0]+_,Ar=rr[ar+(Mt?1:2)]+_,_r=rr[ar+(Mt?2:1)]+_;ut.push(cr,Ar,_r)}}applyMatrix4OnRange(rt,_,ut){let mt=rt.elements,bt=new Matrix3().getNormalMatrix(rt).elements,St,Mt,Bt,Ut,Ht=this.attributes.position,tr=this.attributes.normal;if(!Ht||!tr)return;let rr=Ht.array,sr=tr.array,ar=Ht.itemSize;for(let cr=_*ar,Ar=ut*ar;cr<Ar;cr+=ar){if(cr===_)debugger;St=rr[cr+0],Mt=rr[cr+1],Bt=rr[cr+2],Ut=1/(mt[3]*St+mt[7]*Mt+mt[11]*Bt+mt[15]),rr[cr+0]=(mt[0]*St+mt[4]*Mt+mt[8]*Bt+mt[12])*Ut,rr[cr+1]=(mt[1]*St+mt[5]*Mt+mt[9]*Bt+mt[13])*Ut,rr[cr+2]=(mt[2]*St+mt[6]*Mt+mt[10]*Bt+mt[14])*Ut,St=sr[cr+0],Mt=sr[cr+1],Bt=sr[cr+2],sr[cr+0]=bt[0]*St+bt[3]*Mt+bt[6]*Bt,sr[cr+1]=bt[1]*St+bt[4]*Mt+bt[7]*Bt,sr[cr+2]=bt[2]*St+bt[5]*Mt+bt[8]*Bt}Ht.needsUpdate=!0,tr.needsUpdate=!0}reverseIndicesOnRange(rt,_){let ut=this.index;if(ut){for(let mt=rt;mt<_;mt+=3){let bt=ut.getX(mt),St=ut.getX(mt+1),Mt=ut.getX(mt+2);ut.setXYZ(mt,Mt,St,bt)}ut.needsUpdate=!0}}};function r0(){let rt=new BufferGeometry;return rt.setAttribute("position",new BufferAttribute(new Float32Array([]),3)),rt.setIndex(new BufferAttribute(new Uint16Array([]),1)),rt}var s2=r0().attributes,l2=12,c2=1,ta=class extends BufferGeometry{constructor(rt,_){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,s2),this.userData={parameters:rt,type:"TextGeometry"};let ut=_.getFont(rt.font);ut!=null&&ut.isLoaded?(this.font=ut,this.update(rt)):this.updateFont(rt.font,_).then(()=>{this.update(rt),_==null||_.requestRender()})}async updateFont(rt,_){let ut=_.getFont(rt);ut&&(this.font=ut,await ut.loadingPromise)}update(rt){let _=this.font;if(this.userData={parameters:rt,type:"TextGeometry"},!(_!=null&&_.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:ut,height:mt,depth:bt,extrudeBevelSize:St,extrudeBevelSegments:Mt,text:Bt,textTransform:Ut}=rt,Ht=Kl.getDisplayedValue(Bt),tr=Ut===2?Ht.toUpperCase():Ut===3?Ht.toLowerCase():Ht,rr=u2(rt,_,tr),{shapes:sr,charWidths:ar,charCoords:cr}=_.generateShapes(rr,rt),Ar=(typeof ut=="number"?ut:1)*.5,_r=(typeof mt=="number"?mt:1)*.5,Dr=sr.map(Jr=>new Ne$1().fromShape(Jr,!0));this.vectorShapes=Dr;let $r=Dr.map(Jr=>Xt.create({shape:Jr,parameters:{depth:bt,extrudeBevelSegments:Mt,extrudeBevelSize:St,windingRule:bt<=0?Pe.NONZERO:Pe.ODD,subdivisions:this.isLowResolution&&bt>0?c2:l2}})),Br=$r.length?mergeBufferGeometries($r):r0();Br.translate(-Ar,_r,0),this.dispose(),this.wrappedText=rr,this.charCoords=cr,this.charWidths=ar,this.deleteAttribute("extrudeNormal"),Object.entries(Br.attributes).forEach(([Jr,mn])=>{this.setAttribute(Jr,mn)}),this.setIndex(Br.index),this.computeBoundingSphere()}clone(){let rt=Wt(new BufferGeometry,ta.prototype);return rt.copy(this),console.log("CloneGeometry",this,rt),rt}copy(rt){return Object.entries(rt.attributes).forEach(([_,ut])=>{this.setAttribute(_,ut)}),this.setIndex(rt.index),this.userData={parameters:{...rt.userData.parameters},type:"TextGeometry"},this}async setText(rt){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:rt})}get text(){return this.userData.parameters.text??""}};function u2(rt,_,ut){let mt=[""],bt="";for(let St of ut)bt+=St,St===" "||St===`
`?(mt[mt.length-1]+=bt,bt="",St===`
`&&mt.push("")):_.getTextWidth(mt[mt.length-1]+bt,rt)>rt.width&&(mt[mt.length-1].length&&mt.push(""),_.getTextWidth(mt[mt.length-1]+bt,rt)>rt.width&&(bt.length===1?(mt[mt.length-1]+=bt,bt=""):(mt[mt.length-1]+=bt.slice(0,-1),bt=bt[bt.length-1],mt.push(""))));return mt[mt.length-1]+=bt,mt}var n0,ra=new Promise(rt=>{n0=rt}),o0=!1,Pc;function i0(){if(o0)return;if(Pc)return Pc;async function rt(){let _="https://unpkg.com/@splinetool/modelling-wasm@0.9.526/build",ut=__vitePreload(()=>import("./process-B9H0U9ag.js"),[]),[mt,bt]=await Promise.all([ut,fetch(`${_}/process.wasm`).then(Bt=>Bt.arrayBuffer())]),St=mt.default,Mt=await St({wasmBinary:bt});n0(Mt),o0=!0}return Pc=rt(),Pc}var p2=["font"];function Nn(rt,_,ut,mt){var Ht;let bt,St,Mt;rt.type==="PathGeometry"?(St=JSON.parse(JSON.stringify(rt)),Mt=[[],["extrusion"]]):(St={...rt},Mt=[[]]);for(let tr of Mt){let rr=St;for(let sr of tr)rr=rr[sr];for(bt in rr){let sr=rr[bt];ku(sr)&&!p2.includes(bt)&&(rr[bt]=_.getVariable(sr,[mt.uuid,"geometry",...tr,bt]),ku(rr[bt])&&(rr[bt]=1))}}let Bt={parameters:St,type:St.type};if(St.type==="PathGeometry")Bt.path=St.path;else if(St.type==="VectorGeometry"){let tr=Ne$1.createFromState(St.shape,St.width,St.height);Bt.shape=tr}else if(St.type==="NonParametricGeometry")St.data.groups&&((Ht=St.data.groups)==null||Ht.forEach(tr=>tr.materialIndex=Math.max(tr.materialIndex??0,0))),Bt.geometry=new BufferGeometryLoader().parse(St);else if(St.type==="SubdivGeometry"){let tr=new at(St,ut);return tr.data=rt,tr}else if(St.type==="TextGeometry")return new ta(St,_);let Ut;try{Ut=$d(Bt)}catch(tr){console.error(tr)}if(!Ut){let tr=Ne$1.createFromState(Oi.defaultData(),100,100);Bt.shape=tr,Ut=$d(Bt)}return Ut}var h2=new Matrix4;function bs(rt,_,ut,mt){let bt=rt.position.array,St=rt.normal.array,Mt=h2.makeScale(_,ut,mt).invert().elements,Bt,Ut,Ht;for(var tr=0,rr=bt.length;tr<rr;tr+=3)bt[tr]*=_,bt[tr+1]*=ut,bt[tr+2]*=mt,Bt=St[tr],Ut=St[tr+1],Ht=St[tr+2],St[tr]=Mt[0]*Bt+Mt[4]*Ut+Mt[8]*Ht,St[tr+1]=Mt[1]*Bt+Mt[5]*Ut+Mt[9]*Ht,St[tr+2]=Mt[2]*Bt+Mt[6]*Ut+Mt[10]*Ht;rt.position.needsUpdate=!0,rt.normal.needsUpdate=!0}var Oc=new Box3,oa=new Vector3,fe;ra.then(rt=>{fe=rt});var s0=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),l0=new Uint32Array([0,1,2,3]),c0=new Uint8Array([4]),at=class extends BufferGeometry{constructor(rt,_){super(),this.data=rt,this.flatShading=_,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(rt,_){this.freeSubdivPointer();let ut=this.data.scaleBaked,mt=Fo.div(_,ut);this.subdividedGeometry&&bs(this.subdividedGeometry.attributes,...mt),this.originalGeometry&&bs(this.originalGeometry.attributes,...mt),this.data=rt;let bt=this.userData.parameters;this.userData.parameters={width:bt.width*mt[0],height:bt.height*mt[1],depth:bt.depth*mt[2]},this.originalGeometry.boundingSphere.center.multiply(oa.fromArray(mt));let St=oa.set(bt.width,bt.height,bt.depth).length();this.originalGeometry.boundingSphere.radius=St/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let rt,_,ut;try{({originalGeometry:rt,subdividedGeometry:_,subdivPointer:ut}=at.build(this.data,void 0,!this.flatShading,void 0))}catch{rt=new BoxGeometry(100,100,100),ut=0}this.subdivPointer=ut,this.originalGeometry=rt,this.subdividedGeometry=_??void 0;let mt=this.subdividedGeometry??this.originalGeometry;Object.assign(this,mt),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(at.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let rt=this.originalGeometry;rt.boundingSphere===null&&(rt.boundingSphere=new Sphere$1,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=rt.boundingSphere));let _=rt.attributes.position,ut=rt.boundingSphere.center;Oc.setFromBufferAttribute(_),Oc.getCenter(ut),rt.boundingSphere.radius=ut.distanceTo(Oc.max),isNaN(rt.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Oc.getSize(oa);let mt={width:oa.x,height:oa.y,depth:oa.z};return this.userData.parameters=mt,mt}static build(rt,_,ut,mt){let bt,St,Mt,Bt=(rt==null?void 0:rt.phongAngle)??35;ut===!1&&(Bt=-1),_&&(fe.free_bvh(_),fe.free_subdivision_surface(_));try{bt=at.allocate(rt,mt)}catch(Ut){console.error(Ut,rt),bt=at.allocate({positionWASM:s0,indexWASM:l0,verticesPerFaceWASM:c0},mt)}if(fe.set_destination_refinement_level(bt,0),St=at.buildLevel(bt,!0,Bt),rt.subdivisions>0)try{fe.set_destination_refinement_level(bt,rt.subdivisions),Mt=at.buildLevel(bt,!1,Bt)}catch{try{fe.set_destination_refinement_level(bt,rt.subdivisions-1),Mt=at.buildLevel(bt,!1,Bt)}catch{Mt=null}}else Mt=null;return{subdivPointer:bt,originalGeometry:St,subdividedGeometry:Mt}}static primitiveToQuads(rt,_,ut){rt.widthSegments>16&&(rt.widthSegments=16),rt.heightSegments>16&&(rt.heightSegments=16),rt.depthSegments>16&&(rt.depthSegments=16),rt.radialSegments>16&&(rt.radialSegments=16),rt.type==="DodecahedronGeometry"&&(rt.detail=0);let mt=rt.shape!==void 0||rt.path!==void 0?_.geometry:Nn(rt,ut,!1),bt;rt.type==="TorusGeometry"&&rt.arc===Math.PI*2?bt=mt.getClosedTorusIndicesForBooleanOrSubdiv():bt=mt.getIndex();let St,Mt,Bt,Ut;({positions:St,triIndices:Ut}=ep(mt.getAttribute("position"),bt));let Ht;if(rt.type==="CylinderGeometry"&&rt.cornerRadius===0&&rt.hollow===0&&rt.openEnded===!1){let tr=rt.radialSegments*rt.heightSegments*3*2,rr=tr+rt.radialSegments*3;Ht=[tr,rr]}return{indices:Mt,verticesPerFace:Bt}=tp(St,Ut,mt,Ht),{positions:St,indices:Mt,verticesPerFace:Bt}}static allocate(rt,_){var Br;let ut,mt,bt,St=[],Mt=[];rt.positionWASM&&rt.positionWASM.length>0?(ut=rt.positionWASM,mt=rt.indexWASM,bt=rt.verticesPerFaceWASM):(ut=s0,mt=l0,bt=c0);let Bt=ut.length,Ut=mt.length,Ht=bt.length,tr=ut.length+St.length+Mt.length,rr=mt.length+bt.length,sr=tr*Float32Array.BYTES_PER_ELEMENT+rr*Uint32Array.BYTES_PER_ELEMENT,ar=tr*Float32Array.BYTES_PER_ELEMENT,cr=fe._malloc(sr),Ar=new Float32Array(fe.HEAPF32.buffer,cr,tr),_r=new Uint32Array(fe.HEAPU32.buffer,cr+ar,rr);Ar.set(ut,0),Ar.set(St,ut.length),Ar.set(Mt,ut.length+St.length),_r.set(mt,0),_r.set(bt,mt.length);let Dr;(Br=rt==null?void 0:rt.scaleBaked)!=null&&Br.some(Jr=>Jr!==1)&&(Dr=new Matrix4().makeScale(...rt.scaleBaked)),_&&(Dr?Dr.premultiply(_):Dr=_);let $r=Dr?fe.alloc_subdivision_surface2(cr,Bt,cr+ar,Ut,cr+ar+mt.length*Uint32Array.BYTES_PER_ELEMENT,Ht,Dr.elements):fe.alloc_subdivision_surface(cr,Bt,cr+ar,Ut,cr+ar+mt.length*Uint32Array.BYTES_PER_ELEMENT,Ht);return fe._free(cr),$r}static buildLevel(rt,_,ut,mt,bt){let St=bt?fe.get_mesh_data2(rt,_?fe.Level.CONTROL:fe.Level.REFINED,ut,bt.elements):fe.get_mesh_data(rt,_?fe.Level.CONTROL:fe.Level.REFINED,ut),Mt=8,Bt=fe.HEAPU32.subarray(St>>2,(St>>2)+Mt),Ut=Bt.subarray(4,8),Ht=0,tr=fe.HEAPU32[Bt[Ht]>>2],rr=fe.HEAPF32.subarray(tr>>2,(tr>>2)+Ut[Ht]);Ht++;let sr=fe.HEAPU32[Bt[Ht]>>2],ar=fe.HEAPF32.subarray(sr>>2,(sr>>2)+Ut[Ht]);Ht++;let cr=fe.HEAPU32[Bt[Ht]>>2],Ar=fe.HEAPU32.subarray(cr>>2,(cr>>2)+Ut[Ht]);Ht++;let _r=fe.HEAPU32[Bt[Ht]>>2],Dr=fe.HEAPU32.subarray(_r>>2,(_r>>2)+Ut[Ht]);if(Ht++,mt===void 0){let $r=new BufferGeometry;if($r.setIndex(new Uint32BufferAttribute(Dr,1)),$r.setAttribute("position",new Float32BufferAttribute(rr,3)),$r.setAttribute("normal",new Float32BufferAttribute(ar,3)),_){$r.setAttribute("faceMap",new Uint32BufferAttribute(Ar,1));let Br=new Float32Array(ar.length/3*4).fill(0);$r.setAttribute("color",new BufferAttribute(Br,4))}return fe.free_mesh_data(St),$r.userData.type="SubdivGeometry",$r}mt.getAttribute("position").copyArray(rr),mt.getAttribute("normal").copyArray(ar),mt.attributes.position.needsUpdate=!0,mt.attributes.normal.needsUpdate=!0,fe.free_mesh_data(St)}static freeSubdivPointer(rt){fe.free_bvh(rt),fe.free_subdivision_surface(rt)}static buildControlCageWireframe(rt,_,ut){let mt=fe.get_wireframe_data_for_base_level(rt),bt=4,St=fe.HEAPU32.subarray(mt>>2,(mt>>2)+bt),Mt=St.subarray(2,4),Bt=0,Ut=fe.HEAPU32[St[Bt]>>2],Ht=fe.HEAPF32.subarray(Ut>>2,(Ut>>2)+Mt[Bt]);Bt++;let tr=fe.HEAPU32[St[Bt]>>2],rr=fe.HEAPU32.subarray(tr>>2,(tr>>2)+Mt[Bt]);if(_===void 0){let sr=new BufferGeometry;sr.setAttribute("position",new Float32BufferAttribute(Ht,3));let ar=new Float32Array(Ht.length);for(let cr=0,Ar=Ht.length;cr<Ar;)ar[cr++]=ut.r,ar[cr++]=ut.g,ar[cr++]=ut.b;return sr.setAttribute("color",new BufferAttribute(ar,3)),sr.setIndex(new Uint32BufferAttribute(rr,1)),fe.free_wireframe_data_for_base_level(mt),sr}_.getAttribute("position").copyArray(Ht),_.attributes.position.needsUpdate=!0,fe.free_wireframe_data_for_base_level(mt)}static updateCollabMesh(rt,_,ut){let mt=_===0;mt||fe.set_destination_refinement_level(rt,_);let bt=ut?fe.get_topological_data2(rt,mt?fe.Level.CONTROL:fe.Level.REFINED,ut.elements):fe.get_topological_data(rt,mt?fe.Level.CONTROL:fe.Level.REFINED),St=6,Mt=fe.HEAPU32.subarray(bt>>2,(bt>>2)+St),Bt=Mt.subarray(3,6),Ut=0,Ht=fe.HEAPU32[Mt[Ut]>>2],tr=new Float32Array(fe.HEAPF32.subarray(Ht>>2,(Ht>>2)+Bt[Ut]));Ut++;let rr=fe.HEAPU32[Mt[Ut]>>2],sr=new Uint32Array(fe.HEAPU32.subarray(rr>>2,(rr>>2)+Bt[Ut]));Ut++;let ar=fe.HEAPU32[Mt[Ut]>>2],cr=new Uint8Array(fe.HEAPU32.subarray(ar>>2,(ar>>2)+Bt[Ut]));return fe.free_topological_data(bt),{positions:tr,indices:sr,verticesPerFace:cr}}},u0=["getX","getY","getZ"];function ep(rt,_){let ut={},mt=_?_.count:rt.count,bt=0,St=[],Mt=[],Bt=1e4;for(let Ht=0;Ht<mt;Ht++){let tr=_?_.getX(Ht):Ht,rr="";for(let sr=0;sr<3;sr++)rr+=`${~~(rt[u0[sr]](tr)*Bt)},`;if(rr in ut)St.push(ut[rr]);else{for(let sr=0;sr<3;sr++)Mt.push(rt[u0[sr]](tr));ut[rr]=bt,St.push(bt),bt++}}let Ut=[];for(let Ht=0;Ht<St.length;Ht+=3)St[Ht]===St[Ht+1]||St[Ht]===St[Ht+2]||St[Ht+1]===St[Ht+2]||Ut.push(St[Ht],St[Ht+1],St[Ht+2]);return{positions:Mt,triIndices:Ut}}var Mc=new Vector3,Qd=new Vector3,Zd=new Vector3,Jd=new Vector3;function tp(rt,_,ut,mt){let bt=[],St=[];if(ut.userData.shape!==void 0&&ut.userData.parameters.depth===0&&ut.userData.shape.shapeHoles.length===0){let Ut=ut.userData.shape.extractShapePointsToFlatArray([]),Ht=ut.userData.parameters.spikes;if(ut.userData.type==="EllipseGeometry"&&Ht<=24&&Ht%4===0&&ut.userData.parameters.angle>=360){let sr=Ut.length/2/Ht;Ut=Ut.filter((ar,cr)=>Math.floor(cr/2)%sr===0)}let tr=0;for(let sr=0;sr<Ut.length;sr+=2)tr+=(Ut[sr]-Ut[(sr===0?Ut.length:sr)-2])*(Ut[sr+1]+Ut[(sr===0?Ut.length:sr)-1]);rt.length=0;let rr=0;if(tr<0)for(let sr=0;sr<Ut.length;sr+=2)rt.push(Ut[sr],Ut[sr+1],0),bt.push(rr++);else for(let sr=Ut.length-2;sr>=0;sr-=2)rt.push(Ut[sr],Ut[sr+1],0),bt.push(rr++);return St.push(rr),{indices:bt,verticesPerFace:St}}let Mt=new Float32Array([ut.userData.parameters.depth])[0],Bt=0;for(;Bt<_.length;){if(ut.useNgonForTopBottomFaceDuringBake){let Ut=0;if((rt[_[Bt]*3+2]===Mt||rt[_[Bt]*3+2]===0)&&Ut++,(rt[_[Bt+1]*3+2]===Mt||rt[_[Bt+1]*3+2]===0)&&Ut++,(rt[_[Bt+2]*3+2]===Mt||rt[_[Bt+2]*3+2]===0)&&Ut++,Ut===3)break}if(_[Bt+1]===_[Bt+3]&&_[Bt+2]===_[Bt+5]||_[Bt+0]===_[Bt+3]&&_[Bt+2]===_[Bt+4]){Mc.set(rt[_[Bt]*3],rt[_[Bt]*3+1],rt[_[Bt]*3+2]),Qd.set(rt[_[Bt+1]*3],rt[_[Bt+1]*3+1],rt[_[Bt+1]*3+2]),Zd.set(rt[_[Bt+4]*3],rt[_[Bt+4]*3+1],rt[_[Bt+4]*3+2]),Jd.set(rt[_[Bt+5]*3],rt[_[Bt+5]*3+1],rt[_[Bt+5]*3+2]),Qd.sub(Mc).normalize(),Zd.sub(Mc).normalize(),Jd.sub(Mc).normalize();let Ut=Qd.cross(Zd).dot(Jd);Math.abs(Ut)>.005||mt&&mt.some((Ht,tr)=>tr%2===1?!1:Bt>=mt[tr]&&Bt<mt[tr+1])?(bt.push(_[Bt],_[Bt+1],_[Bt+2]),St.push(3),Bt+=3):(bt.push(_[Bt],_[Bt+1],_[Bt+4],_[Bt+5]),St.push(4),Bt+=6)}else bt.push(_[Bt],_[Bt+1],_[Bt+2]),St.push(3),Bt+=3}if(ut.useNgonForTopBottomFaceDuringBake){let Ut=[],Ht=[],tr=0;for(let rr=0,sr=0;rr<rt.length;rr+=3,sr++)rt[rr+2]===0&&(Ut.push(sr),tr++),rt[rr+2]===Mt&&Ht.push(sr);if(ut.userData.parameters.extrudeBevelSize===0){let rr=Ht[0];Ht[0]=Ht[1],Ht[1]=rr}Ut.reverse(),bt.push(...Ut,...Ht),St.push(tr,tr)}return{indices:bt,verticesPerFace:St}}var pr={};Qv(pr,{calcBoolean:()=>_2,calcBooleanTopological:()=>w2,freeMeshSet:()=>P2,getMeshSet:()=>A2,hasOpenEdges:()=>T2,transformMeshSet:()=>C2});var d0=new Promise(rt=>{}),we,na;d0.then(rt=>we=rt);function S2(rt,_,ut){let mt,bt;rt.userData.parameters.type==="TorusGeometry"&&rt.userData.parameters.arc===Math.PI*2?bt=rt.getClosedTorusIndicesForBooleanOrSubdiv():bt=rt.getIndex();let{positions:St,triIndices:Mt}=ep(rt.getAttribute("position"),bt),Bt;if(_&&ut){let{indices:Ut,verticesPerFace:Ht}=tp(St,Mt,rt);Bt=Ht.length,mt=[];for(let tr=0,rr=0;tr<Bt;tr++){mt.push(Ht[tr]);for(let sr=0;sr<Ht[tr];sr++)mt.push(Ut[rr++])}}else{let Ut=Mt.length;mt=Array(Ut+Ut/3),Bt=0;for(let Ht=0,tr=0;tr<mt.length;)mt[tr++]=3,Bt++,mt[tr++]=Mt[Ht++],mt[tr++]=Mt[Ht++],mt[tr++]=Mt[Ht++]}return{positions:St,faceIndices:mt,nFaces:Bt}}function f0(rt){let _=rt.length,ut=_*Uint32Array.BYTES_PER_ELEMENT,mt=_*Float32Array.BYTES_PER_ELEMENT,bt=Number.isInteger(rt[0])?ut:mt,St=we._malloc(bt);return(Number.isInteger(rt[0])?new Uint32Array(we.HEAPU32.buffer,St,_):new Float32Array(we.HEAPF32.buffer,St,_)).set(rt,0),St}function h0(rt){switch(rt){case 0:return we.OP.UNION;case 1:return we.OP.INTERSECTION;case 2:return we.OP.A_MINUS_B;case 3:return we.OP.B_MINUS_A;case 4:return we.OP.SYMMETRIC_DIFFERENCE;case 5:return we.OP.ALL;default:throw new Error("Unknown boolean operation "+rt)}}function w2(rt,_){na===void 0&&(na=we.init_csg());let ut=f0(rt),mt=we.csg_calc_topological(na,ut,rt.length,h0(_));we._free(ut);let bt=6,St=we.HEAPU32.subarray(mt>>2,(mt>>2)+bt),Mt=St.subarray(3,6),Bt=0,Ut=we.HEAPU32[St[Bt]>>2],Ht=new Float32Array(we.HEAPF32.subarray(Ut>>2,(Ut>>2)+Mt[Bt]));Bt++;let tr=we.HEAPU32[St[Bt]>>2],rr=new Uint32Array(we.HEAPU32.subarray(tr>>2,(tr>>2)+Mt[Bt]));Bt++;let sr=we.HEAPU32[St[Bt]>>2],ar=new Uint8Array(we.HEAPU32.subarray(sr>>2,(sr>>2)+Mt[Bt]));return we.free_mesh_data(mt),{positions:Ht,indices:rr,verticesPerFace:ar}}function _2(rt,_,ut,mt){na===void 0&&(na=we.init_csg());let bt=f0(rt),St=we.csg_calc(na,bt,rt.length,mt,h0(_));we._free(bt);let Mt=5,Bt=we.HEAPU32.subarray(St>>2,(St>>2)+Mt),Ut=Bt.subarray(2,5),Ht=0,tr=we.HEAPU32[Bt[Ht]>>2],rr=we.HEAPF32.subarray(tr>>2,(tr>>2)+Ut[Ht]);Ht++;let sr=we.HEAPU32[Bt[Ht]>>2],ar=we.HEAPF32.subarray(sr>>2,(sr>>2)+Ut[Ht]);Ht++;let cr=Ut[Ht];ut.setAttribute("position",new Float32BufferAttribute(rr,3)),ut.setAttribute("normal",new Float32BufferAttribute(ar,3));let Ar=we.HEAPF32.subarray((St>>2)+5,(St>>2)+5+6);return ut.boundingSphere===null&&(ut.boundingSphere=new Sphere$1),ut.boundingSphere.radius=-1,ut.userData.parameters={width:Ar[3]*2,height:Ar[4]*2,depth:Ar[5]*2},we.free_mesh_data(St),cr}function A2(rt,_,ut){if(we===void 0)return-1;let mt,bt,St;if(_&&rt.userData.positions!==void 0){let _r=rt.userData;St=_r.verticesPerFace.length,mt=_r.positions,bt=Array(_r.verticesPerFace.reduce((Dr,$r)=>Dr+$r,0)+St);for(let Dr=0,$r=0,Br=0;Dr<_r.verticesPerFace.length;Dr++){bt[Br++]=_r.verticesPerFace[Dr];for(let Jr=0;Jr<_r.verticesPerFace[Dr];Jr++)bt[Br++]=_r.indices[$r++]}}else({positions:mt,faceIndices:bt,nFaces:St}=S2(rt,_,ut));let Mt=mt.length,Bt=bt.length,Ut=mt.length,Ht=bt.length,tr=Ut*Float32Array.BYTES_PER_ELEMENT+Ht*Uint32Array.BYTES_PER_ELEMENT,rr=Ut*Float32Array.BYTES_PER_ELEMENT,sr=we._malloc(tr),ar=new Float32Array(we.HEAPF32.buffer,sr,Ut),cr=new Uint32Array(we.HEAPU32.buffer,sr+rr,Ht);ar.set(mt,0),cr.set(bt,0);let Ar=we.get_csg_mesh(sr,Mt,sr+rr,Bt,St);return we._free(sr),Ar}function T2(rt){return we.has_open_edges(rt)}function C2(rt,_){we.transform_csg_mesh(rt,_.elements)}function P2(rt){we.free_csg_mesh(rt)}var O2={ConeGeometry:$y,CubeGeometry:Yy,CylinderGeometry:Wy,DodecahedronGeometry:Xy,EllipseGeometry:Ki,HelixGeometry:Mg,IcosahedronGeometry:Ig,LatheGeometry:Ng,NonParametricGeometry:Fg,PolygonGeometry:_c,PyramidGeometry:jg,RectangleGeometry:Ac,SphereGeometry:Hg,PlaneGeometry:qg,BackdropGeometry:Wg,StarGeometry:Tc,TextFrameGeometry:$g,TorusGeometry:Yg,TorusKnotGeometry:Xg,TriangleGeometry:Kg,PathGeometry:e0,VectorGeometry:Xt},$d=rt=>O2[rt.type].create(rt);function ia(rt){return rt!==null&&"booleanOp"in rt}var aa=class extends ji(Mesh){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new Matrix4}updateVisible(rt){super.updateVisible(rt),this.visible=!ia(this.parent)&&this.visible,ia(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(pr.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(rt=!1){return rt?this.booleanWasTransformed=!0:this.freeBooleanPointer(),ia(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let rt of this.children)rt instanceof aa&&(rt.freeBooleanPointer(),ia(rt)&&rt.invalidateUpstreamBooleanData())}updateTransformState(rt,_){let ut=super.updateTransformState(rt,_);return ut&&ia(this.parent)&&this.invalidateDownstreamBooleanData(!0),ut}onVariableUpdate(rt=!1){super.onVariableUpdate(rt),ia(this.parent)&&this.invalidateDownstreamBooleanData(!0)}},Ic=new Box3;function ws(rt,_=0,ut=rt.count,mt,bt){let St=1/0,Mt=1/0,Bt=1/0,Ut=-1/0,Ht=-1/0,tr=-1/0;for(let rr=_;rr<ut;rr++){let sr=rt.getX(rr),ar=rt.getY(rr),cr=rt.getZ(rr);sr<St&&(St=sr),ar<Mt&&(Mt=ar),cr<Bt&&(Bt=cr),sr>Ut&&(Ut=sr),ar>Ht&&(Ht=ar),cr>tr&&(tr=cr)}Ic.min.set(St,Mt,Bt),Ic.max.set(Ut,Ht,tr),Ic.getCenter(mt),Ic.getSize(bt).multiplyScalar(.5)}var L2=new BufferGeometry,B2=new MeshBasicMaterial,It=class extends aa{constructor(rt,_){super(L2,B2),this.super_Entity(rt,_)}updateState(rt,_){this.updateState_Entity(rt,_)}updateEntityBoxSize(rt,_){let ut=this.geometry.getAttribute("position");ut!==void 0?ws(ut,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:ut.count,rt,_):super.updateEntityBoxSize(rt,_)}},_s=class{constructor(rt){rt=rt??{},this.name=rt.name,this.type=rt.type,this.node=rt.node,this.size=rt.size,this.needsUpdate=rt.needsUpdate}get value(){return this.node.value}set value(rt){this.node.value=rt}},wt=class{constructor(rt){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=MathUtils.generateUUID(),this.type=rt,this.name=""}analyze(rt,_){_=_??{},rt.analyzing=!0,this.build(rt.addFlow(_.slot,_.cache,_.context),"v4"),rt.clearVertexNodeCode(),rt.clearFragmentNodeCode(),rt.removeFlow(),rt.analyzing=!1}analyzeAndFlow(rt,_,ut){return ut=ut??{},this.analyze(rt,ut),this.flow(rt,_,ut)}flow(rt,_,ut){ut=ut??{},rt.addFlow(ut.slot,ut.cache,ut.context);let mt={result:this.build(rt,_),code:rt.clearNodeCode(),extra:rt.context.extra};return rt.removeFlow(),mt}build(rt,_,ut){_=_??this.getType(rt,_);let mt=rt.getNodeData(ut??this);return rt.analyzing&&this.appendDepsNode(rt,mt,_),rt.nodes.indexOf(this)===-1&&rt.nodes.push(this),this.updateFrame!==void 0&&rt.updaters.indexOf(this)===-1&&rt.updaters.push(this),this.generate(rt,_,ut)}updateFrame(rt){}generateReadonly(rt,_,ut,mt,bt,St){return""}generate(rt,_,ut,mt,bt){return""}parse(rt,_,ut,mt){}appendDepsNode(rt,_,ut){_.deps=(_.deps||0)+1;let mt=rt.getTypeLength(ut);(mt>(_.outputMax||0)||this.getType(rt,ut))&&(_.outputMax=mt,_.output=ut)}setName(rt){this.name=rt}getName(){return this.name}getType(rt,_){return _==="sampler2D"||_==="samplerCube"?_:this.type}getHash(){let rt="{",_,ut;for(_ in this)ut=this[_],ut instanceof wt&&(rt+='"'+_+'":'+ut.getHash()+",");if(this.hashProperties)for(let mt=0;mt<this.hashProperties.length;mt++)_=this.hashProperties[mt],ut=this[_],rt+='"'+_+'":"'+String(ut)+'",';return rt+='"id":"'+this.uuid+'"}',rt}},rp=class{constructor(){this.nodes={},this.keywords={}}add(rt){this.nodes[rt.name]=rt}addKeyword(rt,_,ut){ut=ut!==void 0?ut:!0,this.keywords[rt]={callback:_,cache:ut}}remove(rt){delete this.nodes[rt.name]}removeKeyword(rt){delete this.keywords[rt]}get(rt){return this.nodes[rt]}getKeyword(rt,_){return this.keywords[rt].callback(_)}getKeywordData(rt){return this.keywords[rt]}contains(rt){return this.nodes[rt]!==void 0}containsKeyword(rt){return this.keywords[rt]!==void 0}},ft=new rp,ae=class extends wt{constructor(rt,_){super(rt),this.scope="",_=_??{},this.shared=_.shared!==void 0?_.shared:!0,this.unique=_.unique!==void 0?_.unique:!1}build(rt,_,ut,mt){if(_=_??this.getType(rt),this.getShared(rt,_)){let bt=this.getUnique(rt,_);bt&&this.uuid===void 0&&(this.uuid=MathUtils.generateUUID()),ut=rt.getUUID(ut??this.getUUID(),!bt);let St=rt.getNodeData(ut),Mt=St.output||this.getType(rt);if(rt.analyzing)return(St.deps||0)>0||this.getLabel()?(this.appendDepsNode(rt,St,_),this.generate(rt,_,ut)):super.build(rt,_,ut);if(bt)return St.name=St.name||super.build(rt,_,ut),St.name;if(!this.getLabel()&&(!this.getShared(rt,Mt)||rt.context.ignoreCache||St.deps===1))return super.build(rt,_,ut);ut=this.getUUID(!1);let Bt=this.getTemp(rt,ut);if(Bt)return rt.format(Bt,Mt,_);{Bt=super.generate(rt,_,ut,St.output,mt);let Ut=this.generate(rt,Mt,ut);return rt.addNodeCode(Bt+" = "+Ut+";"),rt.format(Bt,Mt,_)}}return super.build(rt,_,ut)}getShared(rt,_){return _!=="sampler2D"&&_!=="samplerCube"&&this.shared}getUnique(rt,_){return this.unique}setLabel(rt){return this.label=rt,this}getLabel(){return this.label}getUUID(rt){let _=this.uuid;return typeof this.scope=="string"&&(_=this.scope+"-"+_),_}getTemp(rt,_){_=_||this.uuid;let ut=rt.getVars()[_];return ut?ut.name:void 0}generate(rt,_,ut,mt,bt){return this.getShared(rt,_)||console.error("TempNode is not shared"),ut=ut??this.uuid,rt.getTempVar(ut,mt??this.getType(rt),bt,this.getLabel()).name}},Re=class extends ae{constructor(rt,_){_=_??{},_.shared=_.shared!==void 0?_.shared:!1,super(rt,_),this.readonly=!1}setReadonly(rt){return this.readonly=rt,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(rt,_,ut,mt,bt,St){ut=rt.getUUID(ut??this.getUUID()),mt=mt??this.getType(rt);let Mt=rt.getNodeData(ut);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(rt,_,ut,mt,bt,St):rt.isShader("vertex")?(Mt.vertex||(Mt.vertex=rt.createVertexUniform(mt,this,bt,St,this.getLabel())),rt.format(Mt.vertex.name,mt,_)):(Mt.fragment||(Mt.fragment=rt.createFragmentUniform(mt,this,bt,St,this.getLabel())),rt.format(Mt.fragment.name,mt,_))}},Ke=class extends Re{constructor(rt=0,_){super("v2"),this.nodeType="Vector2",this.value=rt instanceof Vector2?rt:new Vector2(rt,_)}get x(){return this.value.x}set x(rt){this.value.x=rt}get y(){return this.value.y}set y(rt){this.value.y=rt}generateReadonly(rt,_,ut,mt,bt,St){return rt.format("vec2("+this.value.x+", "+this.value.y+")",mt,_)}},Nt=class extends Re{constructor(rt=0,_,ut){super("v3"),this.nodeType="Vector3",this.value=rt instanceof Vector3?rt:new Vector3(rt,_,ut)}get x(){return this.value.x}set x(rt){this.value.x=rt}get y(){return this.value.y}set y(rt){this.value.y=rt}get z(){return this.value.z}set z(rt){this.value.z=rt}generateReadonly(rt,_,ut,mt,bt,St){return rt.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",mt,_)}},ht=class extends Color$1{constructor(rt,_,ut,mt){super(rt,_,ut),this.isColorA=!0,this.a=mt}setRGBA(rt,_,ut,mt){super.setRGB(rt,_,ut),this.a=mt}copy(rt){return super.copy(rt),this.a="a"in rt?rt.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(rt,_="srgb"){let ut;if(rt==="transparent")return this.setRGBA(0,0,0,0),this;if(ut=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(rt)){let mt,bt=ut[1],St=ut[2];switch(bt){case"rgb":case"rgba":if(mt=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(St))return this.a=bt==="rgba"?parseFloat(mt[4]):1,super.setStyle(rt,_);break;case"hsl":case"hsla":if(mt=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(St))return this.a=bt==="hsla"?parseFloat(mt[4]):1,super.setStyle(rt,_);break}}return super.setStyle(rt,_)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(rt){this.r=rt}set y(rt){this.g=rt}set z(rt){this.b=rt}set w(rt){this.a=rt}},Kt=class extends Re{constructor(rt){super("v4"),this.nodeType="Vector4",this.value=rt instanceof ht?rt:new ht(rt.r,rt.g,rt.b,rt.a)}generateReadonly(rt,_,ut,mt,bt,St){return rt.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",mt,_)}},z2=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,g0=/[a-z_0-9]+/gi,K=class extends ae{constructor(rt,_,ut,mt,bt){super(bt),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=bt===void 0,this.isInterface=!1,this.parse(rt,_,ut,mt)}getShared(rt,_){return!this.isMethod}getType(rt){return rt.getTypeByFormat(this.type)}getInputByName(rt){if(this.inputs){let _=this.inputs.length;for(;_--;)if(this.inputs[_].name===rt)return this.inputs[_]}}getIncludeByName(rt){if(this.includes){let _=this.includes.length;for(;_--;)if(this.includes[_].name===rt)return this.includes[_]}}generate(rt,_,ut,mt,bt){let St,Mt=0,Bt=this.src;if(this.includes)for(let Ht=0;Ht<this.includes.length;Ht++)rt.include(this.includes[Ht],this);for(let Ht in this.extensions)rt.extensions[Ht]=!0;let Ut=[];for(;St=g0.exec(this.src);)Ut.push(St);for(let Ht=0;Ht<Ut.length;Ht++){let tr=Ut[Ht],rr=tr[0],sr=this.isMethod?!this.getInputByName(rr):!0,ar=rr;if(this.keywords[rr]||this.useKeywords&&sr&&ft.containsKeyword(rr)){let cr=this.keywords[rr];if(!cr){let Ar=ft.getKeywordData(rr);Ar.cache&&(cr=rt.keywords[rr]),cr=cr||ft.getKeyword(rr,rt),Ar.cache&&(rt.keywords[rr]=cr)}ar=cr.build(rt)}rr!==ar&&Bt[tr.index+Mt-1]!=="."&&(Bt=Bt.substring(0,tr.index+Mt)+ar+Bt.substring(tr.index+rr.length+Mt),Mt+=ar.length-rr.length),this.getIncludeByName(ar)===void 0&&ft.contains(ar)&&rt.include(ft.get(ar))}return _==="source"?Bt:this.isMethod?(this.isInterface||rt.include(this,void 0,Bt),this.name):rt.format("( "+Bt+" )",this.getType(rt),_)}parse(rt,_,ut,mt){if(this.src=rt||"",this.includes=_??[],this.extensions=ut??{},this.keywords=mt??{},this.isMethod){let bt=z2.exec(this.src);if(this.inputs=[],bt&&bt.length==4){this.type=bt[1],this.name=bt[2];let St=bt[3].match(g0);if(St){let Mt=0;for(;Mt<St.length;){let Bt=St[Mt++],Ut;Bt==="in"||Bt==="out"||Bt==="inout"?Ut=St[Mt++]:(Ut=Bt,Bt="");let Ht=St[Mt++];this.inputs.push({name:Ht,type:Ut,qualifier:Bt})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},k2=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,op=class extends ae{constructor(rt="",_){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(rt||op.PI,void 0,void 0,void 0,_)}getType(rt){return rt.getTypeByFormat(this.type)}parse(rt,_,ut,mt,bt){this.src=rt||"";let St,Mt,Bt="",Ut=k2.exec(rt);this.useDefine=bt??this.src.charAt(0)==="#",Ut&&Ut.length>1?(Mt=Ut[1],St=Ut[2],Bt=Ut[3]):(St=this.src,Mt="f"),this.name=St,this.type=Mt,this.value=Bt}build(rt,_){if(_==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return rt.include(this),rt.format(this.name,this.getType(rt),_)}generate(rt,_,ut,mt,bt){return rt.format(this.name,this.getType(rt),_)}},Ie=op;Ie.PI="PI",Ie.PI2="PI2",Ie.RECIPROCAL_PI="RECIPROCAL_PI",Ie.RECIPROCAL_PI2="RECIPROCAL_PI2",Ie.LOG2="LOG2",Ie.EPSILON="EPSILON";var F2=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),j2=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),sa=class extends ae{constructor(rt=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(rt)}getType(rt){return rt.getTypeByFormat(this.name)}getInputByName(rt){let _=this.inputs.length;for(;_--;)if(this.inputs[_].name===rt)return this.inputs[_]}generate(rt,_,ut,mt,bt){return _==="source"?this.src+";":rt.format("( "+this.src+" )",this.getType(rt),_)}parse(rt=""){this.src=rt,this.inputs=[];let _=F2.exec(rt);if(_){let ut=_[2],mt;for(;mt=j2.exec(ut);)this.inputs.push({type:mt[1],name:mt[2]});this.name=_[1]}else this.name="";this.type=this.name}},la=class extends ae{constructor(rt){super("v2",{shared:!1}),this.nodeType="UV",this.index=rt??0}generate(rt,_){rt.requires.uv[this.index]=!0;let ut=this.index>0?this.index+1:"",mt=rt.isShader("vertex")?"uv"+ut:"vUv"+ut;return rt.format(mt,this.getType(rt),_)}};ft.addKeyword("uv",function(){return new la});ft.addKeyword("uv2",function(){return new la(1)});var En=class extends ae{constructor(rt,_){super("v4"),this.nodeType="ColorSpace",this.input=rt,this.method=_??En.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(rt){switch(rt){case LinearEncoding$1:return["Linear"];case sRGBEncoding$1:return["sRGB"];default:return[]}}generate(rt,_){var Mt;let ut=this.input.build(rt,"v4"),mt=this.getType(rt),bt=En.Nodes[this.method],St=rt.include(bt);if(St===En.LINEAR_TO_LINEAR)return rt.format(ut,mt,_);if(((Mt=bt.inputs)==null?void 0:Mt.length)===2){let Bt=this.factor.build(rt,"f");return rt.format(St+"( "+ut+", "+Bt+" )",mt,_)}else return rt.format(St+"( "+ut+" )",mt,_)}fromEncoding(rt){let _=En.getEncodingComponents(rt);this.method="LinearTo"+_[0],this.factor=_[1]}fromDecoding(rt){let _=En.getEncodingComponents(rt);this.method=_[0]+"ToLinear",this.factor=_[1]}},kt=En;kt.Nodes={LinearToLinear:new K(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new K(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new K(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},kt.LINEAR_TO_LINEAR="LinearToLinear",kt.SRGB_TO_LINEAR="sRGBToLinear",kt.LINEAR_TO_SRGB="LinearTosRGB";var Ee=class extends K{constructor(rt="",_,ut,mt,bt){super(rt,bt,mt,ut,_),this.nodeType="Expression"}},Ft=class extends Re{constructor(rt=new Texture,_,ut,mt){super("v4",{shared:!0}),this.nodeType="Texture",this.value=rt,this.uv=_??new la,this.bias=ut,this.project=mt!==void 0?mt:!1}getTexture(rt,_){return super.generate(rt,_,this.value.uuid,"t")}generate(rt,_){if(_==="sampler2D")return this.getTexture(rt,_);let ut=this.getTexture(rt,_),mt=this.uv.build(rt,this.project?"v4":"v2"),bt=this.bias?this.bias.build(rt,"f"):void 0;bt===void 0&&rt.context.bias&&(bt=rt.context.bias.setTexture(this).build(rt,"f"));let St,Mt;this.project?St="texture2DProj":St=bt?"tex2DBias":"tex2D",bt?Mt=St+"( "+ut+", "+mt+", "+bt+" )":Mt=St+"( "+ut+", "+mt+" )";let Bt={include:rt.isShader("vertex"),ignoreCache:!0},Ut=this.getType(rt);return rt.addContext(Bt),this.colorSpace=this.colorSpace??new kt(new Ee("",Ut)),this.colorSpace.fromDecoding(rt.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(Mt),Mt=this.colorSpace.build(rt,Ut),rt.removeContext(),rt.format(Mt,Ut,_)}},J$2=class extends Re{constructor(_){super("f"),this.nodeType="Float",this.value=_??0}generateReadonly(_,ut,mt,bt,St,Mt){return _.format(this.value+(this.value%1?"":".0"),bt,ut)}},As=class extends ae{constructor(rt,_){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=rt,this.inputs=_??[]}getFunction(){return this.value}getType(rt){return this.value.getType(rt)}generate(rt,_,ut,mt,bt){mt=this.getType(rt);let St=this.value,Mt=St.build(rt,_)+"( ",Bt=[];if(St.inputs){for(let Ut=0;Ut<St.inputs.length;Ut++){let Ht=St.inputs[Ut],tr=this.inputs[Ut]||this.inputs[Ht.name];Bt.push(tr.build(rt,rt.getTypeByFormat(Ht.type)))}Mt+=Bt.join(", ")+" )"}return rt.format(Mt,mt,_)}},np=class extends ae{constructor(rt,_,ut=np.ADD){super(),this.nodeType="Operator",this.type=rt.type,this.a=rt,this.b=_,this.op=ut}getType(rt){let _=this.a.getType(rt),ut=this.b.getType(rt);return rt.isTypeMatrix(_)?"v4":rt.getTypeLength(ut)>rt.getTypeLength(_)?ut:_}generate(rt,_){let ut=this.getType(rt);this.type=ut;let mt=this.a.build(rt,ut),bt=this.b.build(rt,ut);return rt.format("( "+mt+" "+this.op+" "+bt+" )",ut,_)}},_t=np;_t.ADD="+",_t.SUB="-",_t.MUL="*",_t.DIV="/";var Ve=class extends ae{constructor(rt,_=Ve.ABS,ut,mt){super(),this.nodeType="Math",this.a=rt,typeof _!="string"?this.b=_:mt=_,typeof ut!="string"?this.c=ut:mt=ut,this.method=mt,this.hashProperties=["method"]}getNumInputs(rt){switch(this.method){case Ve.MIX:case Ve.CLAMP:case Ve.REFRACT:case Ve.SMOOTHSTEP:case Ve.FACEFORWARD:return 3;case Ve.MIN:case Ve.MAX:case Ve.MOD:case Ve.STEP:case Ve.REFLECT:case Ve.DISTANCE:case Ve.DOT:case Ve.CROSS:case Ve.POW:return 2;default:return 1}}getInputType(rt){let _=rt.getTypeLength(this.a.getType(rt)),ut=this.b?rt.getTypeLength(this.b.getType(rt)):0,mt=this.c?rt.getTypeLength(this.c.getType(rt)):0;return _>ut&&_>mt?this.a.getType(rt):ut>mt?this.b.getType(rt):this.c.getType(rt)}getType(rt){switch(this.method){case Ve.LENGTH:case Ve.DISTANCE:case Ve.DOT:return"f";case Ve.CROSS:return"v3"}return this.getInputType(rt)}generate(rt,_){let ut,mt,bt,St=this.a?rt.getTypeLength(this.a.getType(rt)):0,Mt=this.b?rt.getTypeLength(this.b.getType(rt)):0,Bt=this.c?rt.getTypeLength(this.c.getType(rt)):0,Ut=this.getInputType(rt),Ht=this.getType(rt);switch(this.type=Ht,this.method){case Ve.NEGATE:return rt.format("( -"+this.a.build(rt,Ut)+" )",Ut,_);case Ve.INVERT:return rt.format("( 1.0 - "+this.a.build(rt,Ut)+" )",Ut,_);case Ve.CROSS:ut=this.a.build(rt,"v3"),mt=this.b.build(rt,"v3");break;case Ve.STEP:ut=this.a.build(rt,St===1?"f":Ut),mt=this.b.build(rt,Ut);break;case Ve.MIN:case Ve.MAX:case Ve.MOD:ut=this.a.build(rt,Ut),mt=this.b.build(rt,Mt===1?"f":Ut);break;case Ve.REFRACT:ut=this.a.build(rt,Ut),mt=this.b.build(rt,Ut),bt=this.c.build(rt,"f");break;case Ve.MIX:ut=this.a.build(rt,Ut),mt=this.b.build(rt,Ut),bt=this.c.build(rt,Bt===1?"f":Ut);break;default:ut=this.a.build(rt,Ut),this.b&&(mt=this.b.build(rt,Ut)),this.c&&(bt=this.c.build(rt,Ut));break}let tr=[];tr.push(ut),mt&&tr.push(mt),bt&&tr.push(bt);let rr=this.getNumInputs(rt);if(tr.length!==rr)throw Error(`Arguments not match used in "${this.method}". Require ${rr}, currently ${tr.length}.`);return rt.format(this.method+"( "+tr.join(", ")+" )",Ht,_)}},xe$1=Ve;xe$1.RAD="radians",xe$1.DEG="degrees",xe$1.EXP="exp",xe$1.EXP2="exp2",xe$1.LOG="log",xe$1.LOG2="log2",xe$1.SQRT="sqrt",xe$1.INV_SQRT="inversesqrt",xe$1.FLOOR="floor",xe$1.CEIL="ceil",xe$1.NORMALIZE="normalize",xe$1.FRACT="fract",xe$1.SATURATE="saturate",xe$1.SIN="sin",xe$1.COS="cos",xe$1.TAN="tan",xe$1.ASIN="asin",xe$1.ACOS="acos",xe$1.ARCTAN="atan",xe$1.ABS="abs",xe$1.SIGN="sign",xe$1.LENGTH="length",xe$1.NEGATE="negate",xe$1.INVERT="invert",xe$1.MIN="min",xe$1.MAX="max",xe$1.MOD="mod",xe$1.STEP="step",xe$1.REFLECT="reflect",xe$1.DISTANCE="distance",xe$1.DOT="dot",xe$1.CROSS="cross",xe$1.POW="pow",xe$1.MIX="mix",xe$1.CLAMP="clamp",xe$1.REFRACT="refract",xe$1.SMOOTHSTEP="smoothstep",xe$1.FACEFORWARD="faceforward";var ca=class extends ae{constructor(rt,_,ut){super("v4"),this.nodeType="TextureCubeUV",this.value=rt,this.uv=_,this.bias=ut}bilinearCubeUV(rt,_,ut,mt){let bt=new As(ca.Nodes.bilinearCubeUV,[_,ut,mt]);this.colorSpaceTL=this.colorSpaceTL??new kt(new Ee("","v4")),this.colorSpaceTL.fromDecoding(rt.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(bt.build(rt)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new kt(new Ee("","v4")),this.colorSpaceTR.fromDecoding(rt.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(bt.build(rt)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new kt(new Ee("","v4")),this.colorSpaceBL.fromDecoding(rt.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(bt.build(rt)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new kt(new Ee("","v4")),this.colorSpaceBR.fromDecoding(rt.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(bt.build(rt)+".br");let St={include:rt.isShader("vertex"),ignoreCache:!0};rt.addContext(St),this.colorSpaceTLExp=new Ee(this.colorSpaceTL.build(rt,"v4"),"v4"),this.colorSpaceTRExp=new Ee(this.colorSpaceTR.build(rt,"v4"),"v4"),this.colorSpaceBLExp=new Ee(this.colorSpaceBL.build(rt,"v4"),"v4"),this.colorSpaceBRExp=new Ee(this.colorSpaceBR.build(rt,"v4"),"v4"),rt.removeContext();let Mt=new Ee("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return Mt.keywords.cubeUV_TL=this.colorSpaceTLExp,Mt.keywords.cubeUV_TR=this.colorSpaceTRExp,Mt.keywords.cubeUV_BL=this.colorSpaceBLExp,Mt.keywords.cubeUV_BR=this.colorSpaceBRExp,Mt.keywords.cubeUV=bt,Mt}generate(rt,_){if(rt.isShader("fragment")){let ut=this.uv,mt=this.bias||rt.context.roughness,bt=new As(ca.Nodes.roughnessToMip,[mt]),St=new xe$1(bt,ca.Nodes.m0,ca.Nodes.cubeUV_maxMipLevel,xe$1.CLAMP),Mt=new xe$1(St,xe$1.FLOOR),Bt=new xe$1(St,xe$1.FRACT),Ut=this.bilinearCubeUV(rt,this.value,ut,Mt),Ht=this.bilinearCubeUV(rt,this.value,ut,new _t(Mt,new J$2(1).setReadonly(!0),_t.ADD)),tr=new xe$1(Ut,Ht,Bt,xe$1.MIX);return rt.format(tr.build(rt),"v4",_)}else return console.warn("TextureCubeUVNode is not compatible with "+rt.shader+" shader."),rt.format("vec4( 0.0 )",this.getType(rt),_)}},ua=ca;ua.Nodes=function(){let rt=new sa(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),_=new Ie("float cubeUV_maxMipLevel 8.0",!0),ut=new Ie("float cubeUV_minMipLevel 4.0",!0),mt=new Ie("float cubeUV_maxTileSize 256.0",!0),bt=new Ie("float cubeUV_minTileSize 16.0",!0),St=new K(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);St.useKeywords=!1;let Mt=new K(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);Mt.useKeywords=!1;let Bt=new K(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[rt,St,Mt,_,ut,mt,bt]);Bt.useKeywords=!1;let Ut=new Ie("float r0 1.0",!0),Ht=new Ie("float v0 0.339",!0),tr=new Ie("float m0 -2.0",!0),rr=new Ie("float r1 0.8",!0),sr=new Ie("float v1 0.276",!0),ar=new Ie("float m1 -1.0",!0),cr=new Ie("float r4 0.4",!0),Ar=new Ie("float v4 0.046",!0),_r=new Ie("float m4 2.0",!0),Dr=new Ie("float r5 0.305",!0),$r=new Ie("float v5 0.016",!0),Br=new Ie("float m5 3.0",!0),Jr=new Ie("float r6 0.21",!0),mn=new Ie("float v6 0.0038",!0),Mn=new Ie("float m6 4.0",!0),$n=[Ut,Ht,tr,rr,sr,ar,cr,Ar,_r,Dr,$r,Br,Jr,mn,Mn],en=new K(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,$n);return{bilinearCubeUV:Bt,roughnessToMip:en,m0:tr,cubeUV_maxMipLevel:_}}();var Dn=class extends ae{constructor(rt){super("v3"),this.nodeType="Normal",this.scope=rt??Dn.VIEW}getShared(){return this.scope===Dn.WORLD}build(rt,_,ut,mt){let bt=rt.context[this.scope+"Normal"];return bt?bt.build(rt,_,ut,mt):super.build(rt,_,ut)}generate(rt,_,ut,mt,bt){let St;switch(this.scope){case Dn.VIEW:rt.isShader("vertex")?St="transformedNormal":St="geometryNormal";break;case Dn.LOCAL:rt.isShader("vertex")?St="objectNormal":(rt.requires.normal=!0,St="vObjectNormal");break;case Dn.WORLD:rt.isShader("vertex")?St="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(rt.requires.worldNormal=!0,St="vWNormal");break}return rt.format(St,this.getType(rt),_)}},At=Dn;At.LOCAL="local",At.WORLD="world",At.VIEW="view",At.NORMAL="normal";ft.addKeyword("viewNormal",function(){return new At(At.VIEW)});ft.addKeyword("localNormal",function(){return new At(At.NORMAL)});ft.addKeyword("worldNormal",function(){return new At(At.WORLD)});var Kr=class extends ae{constructor(rt){super("v3"),this.nodeType="Position",this.scope=rt??Kr.LOCAL}getType(){switch(this.scope){case Kr.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Kr.LOCAL:case Kr.WORLD:return!1}return!0}generate(rt,_,ut,mt,bt){let St;switch(this.scope){case Kr.LOCAL:rt.isShader("vertex")?St="transformed":(rt.requires.position=!0,St="vPosition");break;case Kr.WORLD:if(rt.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";rt.requires.worldPosition=!0,St="vWPosition";break;case Kr.VIEW:St=rt.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Kr.PROJECTION:St=rt.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return rt.format(St,this.getType(),_)}},Qt=Kr;Qt.LOCAL="local",Qt.WORLD="world",Qt.VIEW="view",Qt.PROJECTION="projection";ft.addKeyword("position",function(){return new Qt});ft.addKeyword("worldPosition",function(){return new Qt(Qt.WORLD)});ft.addKeyword("viewPosition",function(){return new Qt(Qt.VIEW)});var Pr=class extends ae{constructor(rt){super("v3"),this.nodeType="Reflect",this.scope=rt??Pr.CUBE}getUnique(rt){return!rt.context.viewNormal}getType(){switch(this.scope){case Pr.SPHERE:return"v2"}return this.type}generate(rt,_){let ut=this.getUnique(rt);if(rt.isShader("fragment")){let mt;switch(this.scope){case Pr.VECTOR:{let bt=new At(At.VIEW),St=rt.context.roughness,Mt=bt.build(rt,"v3"),Bt=new Qt(Qt.VIEW).build(rt,"v3"),Ut=St?St.build(rt,"f"):void 0,Ht=`reflect( -normalize( ${Bt} ), ${Mt} )`;Ut&&(Ht=`normalize( mix( ${Ht}, ${Mt}, ${Ut} * ${Ut} ) )`);let tr=`inverseTransformDirection( ${Ht}, viewMatrix )`;ut?(rt.addNodeCode(`vec3 reflectVec = ${tr};`),mt="reflectVec"):mt=tr;break}case Pr.CUBE:{let bt=new Pr(Pr.VECTOR).build(rt,"v3"),St="vec3( -"+bt+".x, "+bt+".yz )";ut?(rt.addNodeCode(`vec3 reflectCubeVec = ${St};`),mt="reflectCubeVec"):mt=St;break}case Pr.SPHERE:{let bt="normalize( ( viewMatrix * vec4( "+new Pr(Pr.VECTOR).build(rt,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";ut?(rt.addNodeCode(`vec2 reflectSphereVec = ${bt};`),mt="reflectSphereVec"):mt=bt;break}}return rt.format(mt,this.getType(),_)}else return console.warn("ReflectNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.type,_)}},Qr=Pr;Qr.CUBE="cube",Qr.SPHERE="sphere",Qr.VECTOR="vector";var Nc=class extends ae{constructor(rt=new Ft,_,ut){super("v4"),this.nodeType="TextureCube",this.value=rt,this.radianceNode=new ua(this.value,_??new Qr(Qr.VECTOR),ut),this.irradianceNode=new ua(this.value,new At(At.WORLD),new J$2(1).setReadonly(!0))}generate(rt,_){return rt.isShader("fragment")?(rt.require("irradiance"),rt.context.bias&&rt.context.bias.setTexture(this.value),(rt.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(rt,_)):(console.warn("TextureCubeNode is not compatible with "+rt.shader+" shader."),rt.format("vec4( 0.0 )",this.getType(rt),_))}},Ec=class extends Re{constructor(rt=new CubeTexture,_,ut){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=rt,this.uv=_??new Qr,this.bias=ut}getTexture(rt,_){return super.generate(rt,_,this.value.uuid,"tc")}generate(rt,_){var Ut;if(_==="samplerCube")return this.getTexture(rt,_);let ut=this.getTexture(rt,_),mt=(Ut=this.uv)==null?void 0:Ut.build(rt,"v3"),bt=this.bias?this.bias.build(rt,"f"):void 0;bt===void 0&&rt.context.bias&&(bt=rt.context.bias.setTexture(this).build(rt,"f"));let St;bt?St="texCubeBias( "+ut+", "+mt+", "+bt+" )":St="texCube( "+ut+", "+mt+" )";let Mt={include:rt.isShader("vertex"),ignoreCache:!0},Bt=this.getType(rt);return rt.addContext(Mt),this.colorSpace=this.colorSpace??new kt(new Ee("",Bt)),this.colorSpace.fromDecoding(rt.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(St),St=this.colorSpace.build(rt,Bt),rt.removeContext(),rt.format(St,Bt,_)}},x0=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,v0=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,b0=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,S0=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,_0=["x","y","z","w"],Q2=["float","vec2","vec3","vec4"],Z2={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},J2={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},Dc=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function rt(_,ut){return _.deps.length-ut.deps.length}return function(_,ut){let mt=this.getIncludes(_,ut);if(!mt)return"";let bt="";mt=mt.sort(rt);for(let St=0;St<mt.length;St++)mt[St].src&&(bt+=mt[St].src+`
`);return bt}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(rt,_){this.addVertexParsCode(x0),this.addFragmentParsCode(v0),this.buildShader("vertex",rt),this.buildShader("fragment",_);for(let ut=0;ut<this.requires.uv.length;ut++)if(this.requires.uv[ut]){let mt=ut>0?ut+1:"";this.addVaryCode("varying vec2 vUv"+mt+";"),ut>0&&this.addVertexParsCode("attribute vec2 uv"+mt+";"),this.addVertexFinalCode("vUv"+mt+" = uv"+mt+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(b0),this.addFragmentFinalCode(S0)),this}buildShader(rt,_){this.resultCode[rt]=_.build(this.setShader(rt),"v4")}setMaterial(rt,_){return this.defines={},this}addFlow(rt,_,ut){return this.addSlot(rt).addCache(_).addContext(ut)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(rt){return this.cache=rt??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(rt){return this.context=Object.assign({},this.context,rt),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(rt){return this.slot=rt||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(rt,_){this.fragmentVariables[rt]===void 0&&(this.addFragmentCode(`${_} ${rt};`),this.fragmentVariables[rt]="")}addFragmentParsVariable(rt,_){this.fragmentParsVariables[rt]===void 0&&(this.addFragmentParsCode(`${_} ${rt};`),this.fragmentParsVariables[rt]="")}addVertexParsVariable(rt,_){this.vertexParsVariables[rt]===void 0&&(this.addVertexParsCode(`${_} ${rt};`),this.vertexParsVariables[rt]="")}addVertexCode(rt){this.addCode(rt,"vertex")}addFragmentCode(rt){this.addCode(rt,"fragment")}addCode(rt,_){this.code[_??this.shader]+=rt+`
`}addVertexNodeCode(rt){this.addNodeCode(rt,"vertex")}addFragmentNodeCode(rt){this.addNodeCode(rt,"fragment")}addNodeCode(rt,_){this.nodeCode[_??this.shader]+=rt+`
`}clearNodeCode(rt){rt=rt??this.shader;let _=this.nodeCode[rt];return this.nodeCode[rt]="",_}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(rt){this.addFinalCode(rt,"vertex")}addFragmentFinalCode(rt){this.addFinalCode(rt,"fragment")}addFinalCode(rt,_){this.finalCode[_??this.shader]+=rt+`
`}addVertexParsCode(rt){this.addParsCode(rt,"vertex")}addFragmentParsCode(rt){this.addParsCode(rt,"fragment")}addParsCode(rt,_){this.parsCode[_??this.shader]+=rt+`
`}addVaryCode(rt){this.addVertexParsCode(rt),this.addFragmentParsCode(rt)}isCache(rt){return this.caches.indexOf(rt)!==-1}isSlot(rt){return this.slots.indexOf(rt)!==-1}define(rt,_){this.defines[rt]=_===void 0?1:_}require(rt){this.requires[rt]=!0}isDefined(rt){return this.defines[rt]!==void 0}getVar(rt,_,ut,mt="varying",bt="V",St=""){let Mt=this.getVars(mt),Bt=Mt[rt];if(!Bt){let Ut=Mt.length;Bt={name:ut||"node"+bt+Ut+(St?"_"+St:""),type:_},Mt.push(Bt),Mt[rt]=Bt}return Bt}getTempVar(rt,_,ut,mt){return this.getVar(rt,_,ut,this.shader,"T",mt)}getAttribute(rt,_){if(!this.attributes[rt]){let ut=this.getVar(rt,_);this.addVertexParsCode("attribute "+_+" "+rt+";"),this.addVertexFinalCode(ut.name+" = "+rt+";"),this.attributes[rt]={varying:ut,name:rt,type:_}}return this.attributes[rt]}getCode(rt){return[this.prefixCode,this.parsCode[rt],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[rt],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[rt],"uniform"),this.getIncludesCode("consts",rt),this.getIncludesCode("structs",rt),this.getIncludesCode("functions",rt),"void main() {",this.getVarListCode(this.getVars(rt)),this.code[rt],this.resultCode[rt],this.finalCode[rt],"}"].join(`
`)}getVarListCode(rt,_){_=_??"";let ut="";for(let mt=0,bt=rt.length;mt<bt;++mt){let St=rt[mt],Mt=St.type,Bt=St.name,Ut=St.size,Ht=this.getFormatByType(Mt);if(Ht===void 0)throw new Error("Node pars "+Ht+" not found.");Ht.includes("[]")?ut+=_+" "+Ht.substring(0,Ht.length-2)+" "+Bt+`[${Ut}];
`:ut+=_+" "+Ht+" "+Bt+`;
`}return ut}getVars(rt){return this.inputs.vars[rt??this.shader]}getNodeData(rt){let _=rt instanceof wt?rt.uuid:rt;return this.nodeData[_]=this.nodeData[_]||{}}createUniform(rt,_,ut,mt,bt,St){if(_.includes("[]")){let Mt=this.inputs.arrayUniforms,Bt=Mt.list.length,Ut=new _s({type:_,size:ut.size,name:mt||"nodeUA"+Bt+(St?"_"+St:""),node:ut,needsUpdate:bt});return Mt.list.push(Ut),Mt[rt].push(Ut),Mt[rt][Ut.name]=Ut,this.uniforms[Ut.name]=Ut,Ut}else{let Mt=this.inputs.uniforms,Bt=Mt.list.length,Ut=new _s({type:_,name:mt||"nodeU"+Bt+(St?"_"+St:""),node:ut,needsUpdate:bt});return Mt.list.push(Ut),Mt[rt].push(Ut),Mt[rt][Ut.name]=Ut,this.uniforms[Ut.name]=Ut,Ut}}createVertexUniform(rt,_,ut,mt,bt){return this.createUniform("vertex",rt,_,ut,mt,bt)}createFragmentUniform(rt,_,ut,mt,bt){return this.createUniform("fragment",rt,_,ut,mt,bt)}include(rt,_,ut){var St;let mt;if(rt=typeof rt=="string"?ft.get(rt):rt,this.context.include===!1)return rt.name;rt instanceof K?mt=this.includes.functions:rt instanceof Ie?mt=this.includes.consts:rt instanceof sa&&(mt=this.includes.structs);let bt=mt[this.shader]=mt[this.shader]||[];if(rt){let Mt=bt[rt.name];if(Mt||(Mt=bt[rt.name]={node:rt,deps:[]},bt.push(Mt),Mt.src=rt.build(this,"source")),rt instanceof K&&_&&bt[_.name]&&bt[_.name].deps.indexOf(rt)===-1&&(bt[_.name].deps.push(rt),(St=rt.includes)==null?void 0:St.length)){let Bt=0;do this.include(rt.includes[Bt++],_);while(Bt<rt.includes.length)}return ut&&(Mt.src=ut),rt.name}else throw new Error("Include not found.")}colorToVectorProperties(rt){return rt.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(rt){return rt.replace(/c/g,"v3")}getIncludes(rt,_){return this.includes[rt][_||this.shader]}getConstructorFromLength(rt){return Q2[rt-1]}isTypeMatrix(rt){return/^m/.test(rt)}getTypeLength(rt){return rt==="f"?1:parseInt(this.colorToVector(rt).substr(1))}getTypeFromLength(rt){return rt===1?"f":"v"+rt}findNode(...rt){for(let _=0;_<arguments.length;_++){let ut=rt[_];if(ut!=null&&ut.isNode)return ut}}resolve(...rt){for(let _=0;_<arguments.length;_++){let ut=rt[_];if(ut!==void 0){if(ut.isNode)return ut;if(ut.isTexture)switch(ut.mapping){case CubeReflectionMapping:case CubeRefractionMapping:return new Ec(ut);case CubeUVReflectionMapping:return new Nc(new Ft(ut));default:return new Ft(ut)}else{if(ut.isVector2)return new Ke(ut);if(ut.isVector3)return new Nt(ut);if(ut.isVector4)return new Kt(ut)}}}}format(rt,_,ut){switch(this.colorToVector(ut+" <- "+_)){case"f <- v2":return rt+".x";case"f <- v3":return rt+".x";case"f <- v4":return rt+".x";case"f <- i":case"f <- b":return"float( "+rt+" )";case"v2 <- f":return"vec2( "+rt+" )";case"v2 <- v3":return rt+".xy";case"v2 <- v4":return rt+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+rt+" ) )";case"v3 <- f":return"vec3( "+rt+" )";case"v3 <- v2":return"vec3( "+rt+", 0.0 )";case"v3 <- v4":return rt+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+rt+" ) )";case"v4 <- f":return"vec4( "+rt+" )";case"v4 <- v2":return"vec4( "+rt+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+rt+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+rt+" ) )";case"i <- f":case"i <- b":return"int( "+rt+" )";case"i <- v2":return"int( "+rt+".x )";case"i <- v3":return"int( "+rt+".x )";case"i <- v4":return"int( "+rt+".x )";case"b <- f":return"( "+rt+" != 0.0 )";case"b <- v2":return"( "+rt+" != vec2( 0.0 ) )";case"b <- v3":return"( "+rt+" != vec3( 0.0 ) )";case"b <- v4":return"( "+rt+" != vec4( 0.0 ) )";case"b <- i":return"( "+rt+" != 0 )"}return rt}getTypeByFormat(rt){return Z2[rt]||rt}getFormatByType(rt){return J2[rt]||rt}getUUID(rt,_){return _=_!==void 0?_:!0,_&&this.cache&&(rt=this.cache+"-"+rt),rt}getElementByIndex(rt){return _0[rt]}getIndexByElement(rt){return _0.indexOf(rt)}isShader(rt){return this.shader===rt}setShader(rt){return this.shader=rt,this}mergeDefines(rt){for(let _ in rt)this.defines[_]=rt[_];return this.defines}mergeUniform(rt){for(let _ in rt)this.uniforms[_]=rt[_];return this.uniforms}getTextureEncodingFromMap(rt){let _;return rt?rt.isTexture&&(_=rt.encoding):_=LinearEncoding$1,_===LinearEncoding$1&&this.context.gamma&&(_=sRGBEncoding$1),_}},Le=class extends Re{constructor(rt=0,_,ut,mt){super("c"),this.nodeType="Color",this.value=rt instanceof ht?rt:new ht(rt||0,_,ut,mt)}setRGBA(rt){this.value.setRGBA(rt.r,rt.g,rt.b,rt.a)}generate(rt,_,ut,mt,bt,St){ut=rt.getUUID(ut??this.getUUID()),mt=mt??this.getType(rt);let Mt=rt.getNodeData(ut),Bt=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let Ut=this.alpha.build(rt,"f");rt.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${Ut};`)}return Bt?this.generateReadonly(rt,_,ut,mt,bt,St):rt.isShader("vertex")?(Mt.vertex||(Mt.vertex=rt.createVertexUniform(mt,this,bt,St,this.getLabel())),rt.format(Mt.vertex.name,mt,_)):(Mt.fragment||(Mt.fragment=rt.createFragmentUniform(mt,this,bt,St,this.getLabel())),rt.format(Mt.fragment.name,mt,_))}generateReadonly(rt,_,ut,mt,bt,St){return rt.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",mt,_)}},_e=class extends Re{constructor(rt){super("i"),this.nodeType="Int",this.value=Math.floor(rt??0)}generateReadonly(rt,_,ut,mt,bt,St){return rt.format(this.value.toString(),mt,_)}},et=class extends Re{constructor(rt){super("b"),this.nodeType="Bool",this.value=rt??!1}generateReadonly(rt,_,ut,mt){return rt.format(this.value?"true":"false",mt,_)}},Or=class extends Re{constructor(rt=1,_){super("f[]"),this.nodeType="FloatArray",this.size=rt,this.value=Array.isArray(_)?_:typeof _=="number"?new Array(rt).fill(_):new Array(rt).fill(0)}},on$1=class extends Re{},Lc=class extends on$1{constructor(rt){super("v3"),this.image=rt,this._value=new Vector3}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},Ln=class extends on$1{constructor(rt,_){super("t"),this.image=rt,this.wrap=_}get value(){return this.image.getTexture(this.wrap)}},da=class extends Re{constructor(rt){super("m3"),this.nodeType="Matrix3",this.value=rt??new Matrix3}generateReadonly(rt,_,ut,mt,bt,St){return rt.format("mat3("+this.value.elements.join(", ")+")",mt,_)}get elements(){return this.value.elements}set elements(rt){this.value.fromArray(rt)}},Et=class extends Re{constructor(rt){super("m4"),this.nodeType="Matrix4",this.value=rt??new Matrix4}generateReadonly(rt,_,ut,mt,bt,St){return rt.format("mat4("+this.value.elements.join(", ")+")",mt,_)}get elements(){return this.value.elements}set elements(rt){this.value.fromArray(rt)}};function A0(rt,_,ut){rt.setUvTransform(ut[0],ut[1],_[0],_[1],0,0,0)}var Bc=class extends da{constructor(rt,_){super(new Matrix3),this.repeat=rt,this.offset=_,A0(this.value,rt,_)}updateMatrix(){A0(this.value,this.repeat,this.offset)}},Mr=class extends Re{constructor(rt=1,_){super("v4[]"),this.nodeType="Vector4Array",this.size=rt,this.value=Array.isArray(_)?_:_ instanceof Vector4?new Array(rt).fill(_):new Array(rt).fill(new Vector4(0))}},pa=class extends ae{constructor(rt,_,ut,mt){super("v3"),this.nodeType="Blend",this.a=rt,this.b=_,this.alpha=ut,this.mode=mt}generate(rt,_){if(rt.isShader("fragment")){let ut=[];return ut.push(this.a.build(rt,"c")),ut.push(this.b.build(rt,"c")),ut.push(this.alpha.build(rt,"f")),ut.push(this.mode.build(rt,"i")),rt.format("spe_blend("+ut.join(",")+")",this.getType(rt),_)}else return console.warn("BlendNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.getType(rt),_)}},ip=class extends ae{constructor(rt,_){super("v3"),this.nodeType="CustomColor",this.color=rt,this.alpha=_,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){if(rt.isShader("fragment")){let ut=rt.include(ip.Nodes.customColor);rt.addFragmentVariable(this.calpha,"float");let mt=[];return mt.push(this.color.build(rt,"v3")),mt.push(this.mask?`luminance(${this.mask.build(rt,"v3")})`:"1.0"),mt.push(this.alpha.build(rt,"f")),mt.push(this.calpha),rt.format(ut+"("+mt.join(",")+")",this.getType(rt),_)}else return console.warn("CustomColorNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.getType(rt),_)}},Bn=ip;Bn.Nodes=function(){return{customColor:new K(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var ap=class extends ae{constructor(rt,_){super("v3"),this.nodeType="CustomNormal",this.cnormal=rt,this.alpha=_,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){if(rt.isShader("fragment")){let ut=rt.include(ap.Nodes.customNormal);rt.addFragmentVariable(this.calpha,"float");let mt=[];return mt.push(this.cnormal.build(rt,"v3")),mt.push("normal"),mt.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),mt.push(this.alpha.build(rt,"f")),mt.push(this.calpha),rt.format(ut+"("+mt.join(",")+")",this.getType(rt),_)}else return console.warn("CustomNormalNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.getType(rt),_)}},fa=ap;fa.Nodes=function(){return{customNormal:new K(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var ha=class extends ae{constructor(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr){super("v3"),this.nodeType="CustomTexture",this.texture=rt,this.textureSize=_,this.crop=ut,this.projection=mt,this.axis=bt,this.side=St,this.size=Mt,this.blending=Bt,this.mat=Ut,this.isMask=rr,this.alpha=Ht,this.mode=tr,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){rt.require("position"),rt.require("normal"),rt.require("uv"),rt.requires.uv=[!0],rt.extensions.shaderTextureLOD=!0,rt.extensions.derivatives=!0;let ut=`g${this.uuid.toString().replace(/-/g,"")}`,mt;switch(this.projection.value){case 3:mt=rt.include(ha.Nodes.cylindrical);break;case 2:mt=rt.include(ha.Nodes.spherical);break;case 1:let St=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],Mt=["zy","xz","xy"][this.axis.value],Bt=new K(`
		vec3 ${ut}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${Mt})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, ${St}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);mt=rt.include(Bt);break;case 4:mt=rt.include(ha.Nodes.triplanar);break;default:mt=rt.include(ha.Nodes.uv);break}rt.addFragmentVariable(this.calpha,"float");let bt=[];if(bt.push("normal"),bt.push(this.texture.generate(rt,"t")),bt.push(this.textureSize.build(rt,"v2")),bt.push(this.crop.build(rt,"f")),bt.push(this.mat.build(rt,"mat3")),bt.push(this.size.build(rt,"v2")),bt.push(this.blending.build(rt,"f")),bt.push(this.isMask.build(rt,"b")),bt.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),bt.push(this.alpha.build(rt,"f")),bt.push(this.mode.build(rt,"i")),bt.push(this.calpha),this.projection.value===4){let St=`${ut}_writeUvs`,Mt=St+"0",Bt=St+"1",Ut=St+"2",Ht=`${ut}_triplanarWeights`;rt.addFragmentVariable(Mt,"vec2"),rt.addFragmentVariable(Bt,"vec2"),rt.addFragmentVariable(Ut,"vec2"),rt.addFragmentVariable(Ht,"vec3"),bt.push(Mt),bt.push(Bt),bt.push(Ut),bt.push(Ht)}else{let St=`${ut}_writeUvs`;rt.addFragmentVariable(St,"vec2"),bt.push(St)}return rt.format(mt+"("+bt.join(",")+")",this.getType(rt),_)}},nn=ha;nn.Nodes=function(){let rt=new K(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),_=new K(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),ut=new K(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),mt=new K(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:rt,spherical:_,uv:ut,triplanar:mt}}();var ma=class extends ae{constructor(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr){super("v3"),this.nodeType="Depth",this.gradientType=rt,this.smooth=_,this.near=ut,this.far=mt,this.isVector=bt,this.isWorldSpace=St,this.origin=Mt,this.direction=Bt,this.colors=Ut,this.steps=Ht,this.isMask=rr,this.alpha=tr,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){let ut=`g${this.uuid.toString().replace(/-/g,"")}`,mt=new K(`vec3 ${ut}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${ut}_MAX_COLORS], float steps[${ut}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${ut}_IS_VECTOR
                   #ifdef ${ut}_LINEAR
                       #ifdef ${ut}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${ut}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${ut}_SMOOTH
				for ( int i = 1; i < ${ut}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${ut}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[ma.Nodes.vectorLinearWorldSpaceDepth,ma.Nodes.vectorLinearObjectSpaceDepth,ma.Nodes.vectorSphericalObjectSpaceDepth,ma.Nodes.vectorSphericalWorldSpaceDepth]);if(rt.isShader("fragment")){rt.define(`${ut}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&rt.define(`${ut}_SMOOTH`),this.isVector.value>.5&&rt.define(`${ut}_IS_VECTOR`),this.gradientType.value===0&&rt.define(`${ut}_LINEAR`),this.isWorldSpace.value>.5&&rt.define(`${ut}_WORLDSPACE`),rt.require("worldPosition"),rt.addFragmentVariable(this.calpha,"float");let bt=rt.include(mt),St=[];return St.push(this.near.build(rt,"f")),St.push(this.far.build(rt,"f")),St.push(this.origin.build(rt,"v3")),St.push(this.direction.build(rt,"v3")),St.push(this.colors.build(rt,"v4[]")),St.push(this.steps.build(rt,"f[]")),St.push(this.isMask.build(rt,"b")),St.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),St.push(this.alpha.build(rt,"f")),St.push(this.calpha),rt.format(bt+"("+St.join(",")+")",this.getType(rt),_)}else return console.warn("DepthNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.getType(rt),_)}},ya=ma;ya.Nodes=function(){let rt=new K(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),_=new K(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),ut=new K(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),mt=new K(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:rt,vectorLinearObjectSpaceDepth:_,vectorSphericalWorldSpaceDepth:ut,vectorSphericalObjectSpaceDepth:mt}}();var Ts=class extends ae{constructor(rt,_,ut,mt,bt,St,Mt,Bt){super("v3"),this.nodeType="Fresnel",this.color=rt,this.bias=_,this.scale=ut,this.intensity=mt,this.factor=bt,this.isMask=Bt,this.alpha=St,this.mode=Mt,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){if(rt.require("vWorldViewDir"),rt.require("worldNormal"),rt.isShader("fragment")){rt.addFragmentVariable(this.calpha,"float");let ut=new K(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),mt=rt.include(ut),bt=[];return bt.push(this.color.build(rt,"c")),bt.push(this.bias.build(rt,"f")),bt.push(this.scale.build(rt,"f")),bt.push(this.intensity.build(rt,"f")),bt.push(this.factor.build(rt,"f")),bt.push(this.isMask.build(rt,"b")),bt.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),bt.push(this.alpha.build(rt,"f")),bt.push(this.mode.build(rt,"i")),bt.push(this.calpha),rt.format(mt+"("+bt.join(",")+")",this.getType(rt),_)}else return console.warn("FresnelNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.getType(rt),_)}},sp=class extends ae{constructor(rt,_,ut,mt,bt,St,Mt,Bt,Ut){super("v3"),this.nodeType="Gradient",this.gradientType=rt,this.smooth=_,this.colors=ut,this.steps=mt,this.offset=bt,this.morph=St,this.angle=Mt,this.isMask=Ut,this.alpha=Bt,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){if(rt.isShader("fragment")){rt.define("GRAD_MAX",10),rt.require("uv"),rt.requires.uv=[!0],rt.addFragmentVariable(this.calpha,"float");let ut=rt.include(sp.Nodes.gradient),mt=[];return mt.push(this.gradientType.build(rt,"i")),mt.push(this.smooth.build(rt,"b")),mt.push(this.colors.build(rt,"v4[]")),mt.push(this.steps.build(rt,"f[]")),mt.push(this.offset.build(rt,"v2")),mt.push(this.morph.build(rt,"v2")),mt.push(this.angle.build(rt,"f")),mt.push(this.isMask.build(rt,"b")),mt.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),mt.push(this.alpha.build(rt,"f")),mt.push(this.calpha),rt.format(ut+"("+mt.join(",")+")",this.getType(rt),_)}else return console.warn("GradientNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.getType(rt),_)}},ga=sp;ga.Nodes=function(){return{gradient:new K(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var lp=class extends ae{constructor(rt,_,ut,mt){super("v3"),this.nodeType="Matcap",this.texture=rt,this.isMask=mt,this.alpha=_,this.mode=ut,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){if(rt.isShader("fragment")){rt.addFragmentVariable(this.calpha,"float");let ut=rt.include(lp.Nodes.matcap);rt.require("normal"),rt.requires.normal=!0;let mt=[];return mt.push(this.texture.generate(rt,"t")),mt.push("normal"),mt.push(this.isMask.build(rt,"b")),mt.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),mt.push(this.alpha.build(rt,"f")),mt.push(this.mode.build(rt,"i")),mt.push(this.calpha),rt.format(ut+"("+mt.join(",")+")",this.getType(rt),_)}else return console.warn("MatcapNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.getType(rt),_)}},xa=lp;xa.Nodes=function(){return{matcap:new K(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var Cs=(rt=>(rt.SIMPLEX="simplex3d",rt.SIMPLEX_FRACTAL="simplex3dFractal",rt.ASHIMA="simplexAshima",rt.FBM="fbm",rt.PERLIN="perlin",rt.VORONOI="voronoi",rt))(Cs||{}),Tt=function(){let rt=new K(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),_=new K(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[rt]);_.keywords.F3=new Ie("float F3 0.3333333"),_.keywords.G3=new Ie("float G3 0.1666667");let ut=new K(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[_]),mt=new K("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),bt=new K("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),St=new K(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[mt,bt]),Mt=new K("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),Bt=new K("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[Mt]),Ut=new K(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[Bt]),Ht=new K(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[Ut]);Ht.keywords.NUM_OCTAVES=new Ie("int NUM_OCTAVES 5");let tr=new K("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),rr=new K(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[mt,bt,tr]),sr=new K(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),ar=new K(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),cr=new K(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),Ar=new K(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),_r=new K(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),Dr=new K(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),$r=new K(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[sr,ar,cr,Ar,_r,Dr]);return{simplex:_,simplexFractal:ut,simplexAshima:St,fbm:Ht,perlin:rr,voronoi:$r}}(),va=class extends ae{constructor(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar,_r,Dr,$r){super("v3"),this.nodeType="Noise",this.scale=rt,this.size=_,this.move=ut,this.fA=mt,this.fB=bt,this.distortion=St,this.colorA=Mt,this.colorB=Bt,this.colorC=Ut,this.colorD=Ht,this.noiseType=rr,this.voronoiStyle=ar,this.highCut=cr,this.lowCut=Ar,this.smoothness=_r,this.seed=Dr,this.quality=$r,this.isMask=sr,this.alpha=tr,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_,ut,mt,bt){rt.require("uv"),rt.requires.uv=[!0],rt.addFragmentVariable(this.calpha,"float");let St=Object.values(Cs)[this.noiseType.value],Mt=St=="voronoi"?`
		float v = ${St}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${St}(st),
					   ${St}(st + vec3(1.0)),
					   ${St}(st + vec3(1.0)));
		vec3 r = vec3(${St}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${St}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${St}(st * q));
		float f = ${St}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,Bt=new K(`vec3 ${St}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${Mt}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[Tt.simplex,Tt.simplexFractal,Tt.simplexAshima,Tt.fbm,Tt.perlin,Tt.voronoi]),Ut=rt.include(Bt),Ht=[];return Ht.push(this.scale.build(rt,"f")),Ht.push(this.size.build(rt,"v3")),Ht.push(this.move.build(rt,"f")),Ht.push(this.fA.build(rt,"v2")),Ht.push(this.fB.build(rt,"v2")),Ht.push(this.distortion.build(rt,"v2")),Ht.push(this.colorA.build(rt,"v4")),Ht.push(this.colorB.build(rt,"v4")),Ht.push(this.colorC.build(rt,"v4")),Ht.push(this.colorD.build(rt,"v4")),Ht.push(this.voronoiStyle.build(rt,"i")),Ht.push(this.highCut.build(rt,"f")),Ht.push(this.lowCut.build(rt,"f")),Ht.push(this.smoothness.build(rt,"f")),Ht.push(this.seed.build(rt,"f")),Ht.push(this.quality.build(rt,"i")),Ht.push(this.isMask.build(rt,"b")),Ht.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),Ht.push(this.alpha.build(rt,"f")),Ht.push(this.calpha),rt.format(Ut+"("+Ht.join(",")+")",this.getType(rt),_)}};va.numOctaves=5;var cp=class extends ae{constructor(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=rt,this.contourColor=_,this.outlineWidth=ut,this.contourWidth=mt,this.contourThreshold=bt,this.outlineThreshold=St,this.contourFrequency=Mt,this.outlineSmoothing=Bt,this.contourDirection=Ut,this.positionalLines=Ht,this.compensation=tr,this.resolution=rr,this.normalMap=sr,this.depthMap=ar,this.pixelRatio=cr,this.alpha=Ar,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){let ut=`g${this.uuid.toString().replace(/-/g,"")}`;if(rt.require("vWorldViewDir"),rt.require("worldNormal"),rt.extensions.derivatives=!0,this.compensation.value&&rt.define("OUTLINE_COMPENSATION",`${ut}_offset`),this.firstTime){let mt=this.outlineWidth.build(rt,"f"),bt=this.resolution.build(rt,"v2"),St=this.compensation.build(rt,"b"),Mt=this.pixelRatio.build(rt,"f");rt.addVertexParsVariable("randomColor","attribute vec3"),rt.addVertexParsVariable("extrudeNormal","attribute vec3"),rt.addVertexParsVariable(mt,"uniform float"),rt.addVertexParsVariable(bt,"uniform vec2"),rt.addVertexParsVariable(St,"uniform bool"),rt.addVertexParsVariable(Mt,"uniform float"),rt.addVertexParsVariable("vID","flat out float"),rt.addFragmentParsVariable("vID","flat in float"),rt.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${ut}_offset = vec2(0.0);
                if (${St}) {
                    vec4 ${ut}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${ut}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${ut}_offset = normalize(${ut}_clipNormal.xy) / ${bt} * (${mt} / 2.0) * ${ut}_clipPosition.w * 2.0 * ${Mt};
                    ${ut}_clipPosition.xy += ${ut}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${ut}_clipPosition;
                }
            `)}if(rt.isShader("fragment")){rt.require("uv"),rt.requires.uv=[!0],rt.addFragmentVariable(this.calpha,"float");let mt=rt.include(cp.Nodes.outline),bt=[];return bt.push(this.outlineColor.build(rt,"c")),bt.push(this.contourColor.build(rt,"c")),bt.push(this.outlineWidth.build(rt,"f")),bt.push(this.contourWidth.build(rt,"f")),bt.push(this.contourThreshold.build(rt,"f")),bt.push(this.outlineThreshold.build(rt,"f")),bt.push(this.contourFrequency.build(rt,"f")),bt.push(this.outlineSmoothing.build(rt,"f")),bt.push(this.contourDirection.build(rt,"v3")),bt.push(this.positionalLines.build(rt,"b")),bt.push(this.resolution.build(rt,"v2")),bt.push(this.normalMap.getTexture(rt,"t")),bt.push(this.depthMap.getTexture(rt,"t")),bt.push(this.pixelRatio.build(rt,"f")),bt.push(this.compensation.build(rt,"b")),bt.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),bt.push(this.alpha.build(rt,"f")),bt.push(this.calpha),this.firstTime=!this.firstTime,rt.format(mt+"("+bt.join(",")+")",this.getType(rt),_)}else return console.warn("OutlineNode is not compatible with "+rt.shader+" shader."),""}},ba=cp;ba.Nodes=function(){let rt=new K(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new K(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[rt])}}();var Zr=class extends ae{constructor(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar,_r,Dr){super("v3"),this.nodeType="Pattern",this.style=rt,this.projection=_,this.axis=ut,this.blending=mt,this.offset=bt,this.colorA=St,this.colorB=Mt,this.frequency=Bt,this.size=Ut,this.variation=Ht,this.smoothness=tr,this.zigzag=rr,this.rotation=sr,this.vertical=ar,this.horizontal=cr,this.sides=Ar,this.isMask=Dr,this.alpha=_r,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){if(rt.isShader("fragment")){rt.require("position"),rt.require("uv"),rt.requires.uv=[!0],rt.require("normal"),rt.requires.normal=!0,rt.addFragmentVariable(this.calpha,"float");let ut;switch(this.style.value){case 0:ut="circle";break;case 1:ut="ring";break;case 2:ut="polygon";break;case 3:ut="xcross";break;case 4:ut="diamond";break;case 5:ut="checkerboard";break;case 6:ut="line";break;case 7:ut="wave";break;default:ut="circle";break}let mt=`g${this.uuid.toString().replace(/-/g,"")}`,bt=new K(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),St=new K(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),Mt="";if(this.projection.value===4){let tr=this.style.value===2?`${ut}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${ut}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,rr=this.style.value===2?`${ut}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${ut}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,sr=this.style.value===2?`${ut}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${ut}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;Mt=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${tr};
				float d1 = ${rr};
				float d2 = ${sr};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let tr=this.style.value===2?`${ut}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${ut}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,rr="";this.axis.value===0?rr=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?rr=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,rr=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let sr="";switch(this.projection.value){case 0:sr="custom_uv = vUv.st;";break;case 1:break;case 2:sr=`
							vec3 p = position;
							${rr}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}Mt=`
				vec2 custom_uv;
				${sr}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${tr};
				`}let Bt=new K(`vec3 ${mt}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${Mt}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[St,bt,Zr.DrawFunctions.circle,Zr.DrawFunctions.ring,Zr.DrawFunctions.polygon,Zr.DrawFunctions.cross,Zr.DrawFunctions.diamond,Zr.DrawFunctions.checkerboard,Zr.DrawFunctions.line,Zr.DrawFunctions.wave]),Ut=rt.include(Bt),Ht=[];return Ht.push("normal"),Ht.push(this.blending.build(rt,"f")),Ht.push(this.style.build(rt,"i")),Ht.push(this.offset.build(rt,"v2")),Ht.push(this.colorA.build(rt,"v4")),Ht.push(this.colorB.build(rt,"v4")),Ht.push(this.frequency.build(rt,"v2")),Ht.push(this.size.build(rt,"f")),Ht.push(this.variation.build(rt,"f")),Ht.push(this.smoothness.build(rt,"f")),Ht.push(this.zigzag.build(rt,"f")),Ht.push(this.rotation.build(rt,"f")),Ht.push(this.vertical.build(rt,"v2")),Ht.push(this.horizontal.build(rt,"v2")),Ht.push(this.sides.build(rt,"i")),Ht.push(this.isMask.build(rt,"b")),Ht.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),Ht.push(this.alpha.build(rt,"f")),Ht.push(this.calpha),rt.format(Ut+"("+Ht.join(",")+")",this.getType(rt),_)}else return console.warn("PatterNode is not compatible with "+rt.shader+" shader."),rt.format("vec3(0.0)",this.getType(rt),_)}},Sa=Zr;Sa.DrawFunctions=function(){let rt=new K(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),_=new K(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[rt]),ut=new K(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[_]),mt=new K(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[_]),bt=new K(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[_]),St=new K(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[_]),Mt=new K(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[_]),Bt=new K(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),Ut=new K(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[_]),Ht=new K(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:_,circle:ut,ring:mt,polygon:bt,cross:St,diamond:Mt,checkerboard:Bt,line:Ut,wave:Ht}}();var up=class extends ae{constructor(rt,_,ut,mt,bt,St,Mt,Bt){super("v3"),this.nodeType="Rainbow",this.filmThickness=rt,this.movement=_,this.wavelengths=ut,this.noiseStrength=mt,this.noiseScale=bt,this.offset=St,this.isMask=Bt,this.alpha=Mt,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){if(rt.require("vWorldViewDir"),rt.require("worldNormal"),rt.isShader("fragment")){rt.require("uv"),rt.requires.uv=[!0],rt.addFragmentVariable(this.calpha,"float");let ut=rt.include(up.Nodes.rainbow),mt=[];return mt.push(this.filmThickness.build(rt,"f")),mt.push(this.movement.build(rt,"f")),mt.push(this.wavelengths.build(rt,"v3")),mt.push(this.noiseStrength.build(rt,"f")),mt.push(this.noiseScale.build(rt,"f")),mt.push(this.offset.build(rt,"v3")),mt.push(this.isMask.build(rt,"b")),mt.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),mt.push(this.alpha.build(rt,"f")),mt.push(this.calpha),rt.format(ut+"("+mt.join(",")+")",this.getType(rt),_)}else return console.warn("RainbowNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.getType(rt),_)}},wa=up;wa.Nodes=function(){let rt=new K(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[Tt.simplex]);return{rainbow:new K(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[rt])}}();var dp=class extends ae{constructor(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht){super("v3"),this.nodeType="Toon",this.positioning=rt,this.colors=_,this.steps=ut,this.source=mt,this.isWorldSpace=bt,this.noiseStrength=St,this.noiseScale=Mt,this.shadowColor=Bt,this.offset=Ut,this.alpha=Ht,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){if(rt.require("worldNormal"),rt.require("worldPosition"),rt.isShader("fragment")){rt.define("COLORS_MAX",10),rt.addFragmentVariable(this.calpha,"float");let ut=rt.include(dp.Nodes.toon),mt=[];return mt.push(this.positioning.build(rt,"i")),mt.push(this.colors.build(rt,"v4[]")),mt.push(this.steps.build(rt,"f[]")),mt.push(this.source.build(rt,"v3")),mt.push(this.isWorldSpace.build(rt,"b")),mt.push(this.noiseStrength.build(rt,"f")),mt.push(this.noiseScale.build(rt,"f")),mt.push(this.shadowColor.build(rt,"v4")),mt.push(this.offset.build(rt,"v3")),mt.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),mt.push(this.alpha.build(rt,"f")),mt.push(this.calpha),rt.format(ut+"("+mt.join(",")+")",this.getType(rt),_)}else return console.warn("ToonNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.getType(rt),_)}},_a=dp;_a.Nodes=function(){let rt=new K(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),_=new K(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),ut=new K(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[_]),mt=new K(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),bt=new K(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[mt]);return{toon:new K(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[Tt.simplex,rt,ut,bt])}}();var C0=function(){return{textureBicubic:new K(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function O0(rt,_){return rt>=_?new Vector2(_/rt,1):new Vector2(1,rt/_)}var pp=class extends ae{constructor(rt,_,ut,mt,bt,St,Mt,Bt){super("v3"),this.nodeType="Transmission",this.thickness=rt,this.ior=_,this.roughness=ut,this.transmissionSamplerSize=mt,this.transmissionSamplerMap=bt,this.transmissionDepthMap=St,this.aspectRatio=Mt,this.alpha=Bt,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(rt,_){if(rt.extensions.shaderTextureLOD=!0,rt.extensions.derivatives=!0,rt.isShader("fragment")){rt.define("NUM_SAMPLES",6),rt.define("BLUR_SLOD",Math.pow(2,be.transmissionLod.value)),rt.require("worldPosition"),rt.requires.worldNormal=!0,rt.requires.modelMatrix=!0,rt.requires.projectionMatrix=!0,rt.addFragmentVariable(this.calpha,"float");let ut=rt.include(pp.Nodes.transmission),mt=[];return mt.push(this.thickness.build(rt,"f")),mt.push(this.ior.build(rt,"f")),mt.push(this.roughness.build(rt,"f")),mt.push(this.transmissionSamplerSize.build(rt,"v2")),mt.push(this.transmissionSamplerMap.getTexture(rt,"t")),mt.push(this.transmissionDepthMap.getTexture(rt,"t")),mt.push(this.aspectRatio.build(rt,"v2")),mt.push("normal"),mt.push(this.mask?`luminance(${this.mask.flow(rt,"v3").result})`:"1.0"),mt.push(this.alpha.build(rt,"f")),mt.push(this.calpha),rt.format(ut+"("+mt.join(",")+")",this.getType(rt),_)}else return console.warn("TransmissionNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.getType(rt),_)}},Aa=pp;Aa.Nodes=function(){let rt=new K(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),_=new K(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),ut=new K(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),mt=new K(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[C0.textureBicubic,ut,rt]),bt=new K(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[mt,_]);return{transmission:new K(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[bt])}}();var fp=(rt=>(rt.NOISE="noise",rt.MAP="map",rt))(fp||{}),hp=class extends ae{constructor(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr){super("v3"),this.displacementTypeIndex=new _e(0),this.nodeType="VertexDisplacement",this.intensity=rt,this.movementOrTexture=_,Object.values(fp)[this.displacementTypeIndex.value]==="map"&&(this.mat=new da(this.movementOrTexture.value.matrix)),this.cropOrOffset=ut,this.scale=Ht,this.noiseFunctionIndex=tr,this.voronoiStyle=mt,this.smoothness=bt,this.seed=St,this.highCut=Mt,this.lowCut=Bt,this.quality=Ut}generate(rt,_){if(rt.isShader("vertex")){rt.define("USE_LAYER_DISPLACE");let ut,mt=[];switch(mt.push("displaced_position"),mt.push("displaced_normal"),Object.values(fp)[this.displacementTypeIndex.value]){case"map":{ut=rt.include(hp.Nodes.map),mt.push(this.movementOrTexture.getTexture(rt,"t")),mt.push("uv"),mt.push(this.cropOrOffset.build(rt,"f")),this.mat&&mt.push(this.mat.build(rt,"mat3"));break}case"noise":{let bt=Object.values(Cs)[this.noiseFunctionIndex.value],St=new K(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),Mt=bt=="voronoi"?`
					float v = ${bt}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${bt}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,Bt=new K(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${Mt}
						}`,[Tt.simplex,Tt.simplexFractal,Tt.simplexAshima,Tt.fbm,Tt.perlin,Tt.voronoi]),Ut=new K(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[Bt,St]);ut=rt.include(Ut),mt.push(this.scale.build(rt,"f")),mt.push(this.cropOrOffset.build(rt,"v3")),mt.push(this.movementOrTexture.build(rt,"f")),mt.push(this.voronoiStyle.build(rt,"i")),mt.push(this.smoothness.build(rt,"f")),mt.push(this.seed.build(rt,"f")),mt.push(this.highCut.build(rt,"f")),mt.push(this.lowCut.build(rt,"f")),mt.push(this.quality.build(rt,"i"));break}}return mt.push(this.intensity.build(rt,"f")),mt.push("displaced_normal"),rt.format(ut+"("+mt.join(",")+")",this.getType(rt),_)}else return console.warn("VertexDisplacementNode is not compatible with "+rt.shader+" shader."),rt.format("vec3( 0.0 )",this.getType(rt),_)}},Ta=hp;Ta.Nodes=function(){let rt=new K(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),_=new K(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new K(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[rt,_])}}();var be={normalRenderTarget:new Ft,normalRenderTargetDepth:new Ft,transmissionRenderTarget:new Ft,aspectRatio:new Ke,transmissionSize:new Ke(2048,2048),transmissionRenderTargetDepth:new Ft,aoRenderTarget:new Ft,aoEnabled:new et,pixelRatioNode:new J$2(1),resolution:new Ke,penumbraSize:new Or(5,.5),frameIndex:new _e(0),transmissionLod:new _e(2)};for(let rt of Object.values(be))rt.isRenderGlobal=!0;var Vn=class extends wt{constructor(){super("basic"),this.nodeType="Basic",this.color=new Le(dt),this.shadingAlpha=new J$2(1),this.shadingBlend=new _e(0),this.previousModelViewMatrix=new Et,this.previouseProjectionMatrix=new Et}get category(){return"phong"}generate(rt){let _;if(rt.isShader("vertex")){let ut=this.position?this.position.analyzeAndFlow(rt,"v3",{cache:"position"}):void 0;rt.mergeUniform({frameIndex:be.frameIndex}),rt.mergeUniform({resolution:be.resolution}),rt.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),rt.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),rt.mergeUniform(UniformsUtils.merge([UniformsLib.fog])),rt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let mt=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];ut&&mt.push(ut.code,ut.result?"displaced_position = "+ut.result+";":""),mt.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),mt.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),mt.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),_=mt.join(`
`)}else{this.color===void 0&&(this.color=new Le(dt)),this.color.analyze(rt,{slot:"color"}),this.alpha&&this.alpha.analyze(rt),this.afterColor&&this.afterColor.analyze(rt,{slot:"afterColor"});let ut=this.color.flow(rt,"c",{slot:"color"}),mt=this.alpha?this.alpha.flow(rt,"f"):void 0,bt=this.alphaOverride?this.alphaOverride.flow(rt,"f"):void 0,St=this.afterColor?this.afterColor.flow(rt,"c",{slot:"afterColor"}):void 0;rt.requires.transparent=mt!==void 0,rt.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let Mt=["#include <normal_fragment_begin>",ut.code];mt&&Mt.push(mt.code,"#ifdef ALPHATEST"," if ( "+mt.result+" <= ALPHATEST ) discard;","#endif"),St?Mt.push(St.code,`vec3 outgoingLight = ${ut.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${St.result}, 1.0, SPE_BLENDING_NORMAL);`):Mt.push(`vec3 finalColor = ${ut.result};`);let Bt="1.0";this.mask&&(this.mask.analyze(rt),Bt=`luminance(${this.mask.flow(rt,"v3").result})`),mt?Mt.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${mt.result} * ${Bt} );`):Mt.push("gl_FragColor = vec4("+ut.result+", 1.0 );"),bt&&Mt.push(`gl_FragColor.a *= ${bt.result};`),Mt.push("#include <fog_fragment>","#include <dithering_fragment>"),_=Mt.join(`
`)}return _}},Ps=class extends wt{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new Le(dt),this.emissive=new Le(0),this.emissiveIntensity=new J$2(1),this.previousModelViewMatrix=new Et,this.previouseProjectionMatrix=new Et,this.shadingAlpha=new J$2(1),this.shadingBlend=new _e(0),this.occlusion=new et(!0)}get category(){return"lambert"}build(rt){let _;if(rt.define("LAMBERT"),rt.requires.lights=!0,rt.extensions.derivatives=!0,rt.isShader("vertex")){let ut=this.position?this.position.analyzeAndFlow(rt,"v3",{cache:"position"}):void 0;rt.mergeUniform({frameIndex:be.frameIndex}),rt.mergeUniform({resolution:be.resolution}),rt.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),rt.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),rt.mergeUniform(UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights])),rt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let mt=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];ut&&mt.push(ut.code,ut.result?"displaced_position = "+ut.result+";":""),mt.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),mt.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),mt.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),mt.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),_=mt.join(`
`)}else{rt.mergeUniform({penumbraSize:be.penumbraSize}),rt.mergeUniform({frameIndex:be.frameIndex}),rt.mergeUniform({aoMap:be.aoRenderTarget}),rt.mergeUniform({aoEnabled:be.aoEnabled}),this.color===void 0&&(this.color=new Le(dt)),this.color.analyze(rt,{slot:"color"}),this.shadingAlpha.analyze(rt),this.shadingBlend.analyze(rt),this.afterColor&&this.afterColor.analyze(rt,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(rt);let ut=this.color.flow(rt,"c",{slot:"color"}),mt=this.emissive.flow(rt,"c",{slot:"emissive"}),bt=this.emissiveIntensity.flow(rt,"f",{slot:"emissive"}),St=this.occlusion.flow(rt,"b",{slot:"occlusion"}),Mt=this.shadingAlpha.flow(rt,"f"),Bt=this.shadingBlend.flow(rt,"i"),Ut=this.afterColor?this.afterColor.flow(rt,"c",{slot:"afterColor"}):void 0,Ht=this.alpha?this.alpha.flow(rt,"f"):void 0,tr=this.alphaOverride?this.alphaOverride.flow(rt,"f"):void 0;rt.requires.transparent=Ht!==void 0,rt.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let rr=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];rr.push(ut.code,"vec3 diffuseColor = "+ut.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),Ht&&rr.push(Ht.code,"#ifdef ALPHATEST","if ( "+Ht.result+" <= ALPHATEST ) discard;","#endif"),rr.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),mt&&rr.push(mt.code,"reflectedLight.directDiffuse += "+mt.result+" * "+bt.result+";"),rr.push("vec3 ao = aoEnabled && "+St.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let sr="1.0";this.mask&&(this.mask.analyze(rt),sr=`luminance(${this.mask.flow(rt,"v3").result})`),rr.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${Mt.result} * ${sr} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${Mt.result} * ${sr}, ${Bt.result} );

					outgoingLight *= ao;
				}
				`),Ut&&rr.push(Ut.code,`outgoingLight = spe_blend(outgoingLight, ${Ut.result}, 1.0, SPE_BLENDING_NORMAL);`),Ht?rr.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${Ht.result} );`):rr.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),tr&&rr.push(`gl_FragColor.a *= ${tr.result};`),rr.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),_=rr.join(`
`)}return _}},To=function(){let rt=new K(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),_=new K(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:rt,perturbNormalArb:_}}(),Os=class extends wt{constructor(){super("phong"),this.nodeType="Phong",this.color=new Le(dt),this.specular=new Le(1118481),this.shininess=new J$2(30),this.previousModelViewMatrix=new Et,this.previouseProjectionMatrix=new Et,this.shadingAlpha=new J$2(1),this.shadingBlend=new _e(0),this.occlusion=new et(!0)}get category(){return"phong"}build(rt){let _;if(rt.define("PHONG"),rt.requires.lights=!0,rt.extensions.derivatives=!0,rt.isShader("vertex")){let ut=this.position?this.position.analyzeAndFlow(rt,"v3",{cache:"position"}):void 0;rt.mergeUniform({frameIndex:be.frameIndex}),rt.mergeUniform({resolution:be.resolution}),rt.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),rt.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),rt.mergeUniform(UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights])),rt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let mt=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];ut&&mt.push(ut.code,ut.result?"displaced_position = "+ut.result+";":""),mt.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),mt.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),mt.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),_=mt.join(`
`)}else{rt.mergeUniform({penumbraSize:be.penumbraSize}),rt.mergeUniform({frameIndex:be.frameIndex}),rt.mergeUniform({aoMap:be.aoRenderTarget}),rt.mergeUniform({aoEnabled:be.aoEnabled}),this.color===void 0&&(this.color=new Le(dt)),this.color.analyze(rt,{slot:"color"}),this.specular.analyze(rt),this.shininess.analyze(rt);let ut=this.occlusion.flow(rt,"b",{slot:"occlusion"});this.shadingAlpha.analyze(rt),this.shadingBlend.analyze(rt),this.afterColor&&this.afterColor.analyze(rt,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(rt);let mt=this.color.flow(rt,"c",{slot:"color"}),bt=this.specular.flow(rt,"c"),St=this.shininess.flow(rt,"f"),Mt=this.shadingAlpha.flow(rt,"f"),Bt=this.shadingBlend.flow(rt,"i"),Ut=this.afterColor?this.afterColor.flow(rt,"c",{slot:"afterColor"}):void 0,Ht=this.alpha?this.alpha.flow(rt,"f"):void 0,tr=this.alphaOverride?this.alphaOverride.flow(rt,"f"):void 0;rt.requires.transparent=Ht!==void 0,rt.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let rr=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){rt.include(To.dHdxy),rt.include(To.perturbNormalArb);let ar=this.bumpMap.texture.flow(rt,"t"),cr=this.bumpMap.flow(rt,"v3"),Ar=this.bumpMapIntensity?this.bumpMapIntensity.flow(rt,"f").result:"1.0",_r="";this.bumpMap.projection.value===4?_r=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${ar.result}, uv0, ${Ar});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${ar.result}, uv1, ${Ar});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${ar.result}, uv2, ${Ar});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:_r=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${ar.result}, bumpMapCachedUv, ${Ar});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,rr.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${cr.result};
					${_r}
					`)}rr.push(mt.code,"	vec3 diffuseColor = "+mt.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",bt.code,"	vec3 specular = "+bt.result+";",St.code,"	float shininess = max( 0.0001, "+St.result+" );","	float specularStrength = 1.0;"),Ht&&rr.push(Ht.code,"#ifdef ALPHATEST","if ( "+Ht.result+" <= ALPHATEST ) discard;","#endif"),rr.push("material.diffuseColor = diffuseColor;"),rr.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),rr.push("vec3 ao = aoEnabled && "+ut.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let sr="1.0";this.mask&&(this.mask.analyze(rt),sr=`luminance(${this.mask.flow(rt,"v3").result})`),rr.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${Mt.result} * ${sr} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${Mt.result} * ${sr}, ${Bt.result} );
					
					outgoingLight *= ao;
				}
				`),Ut&&rr.push(Ut.code,`outgoingLight = spe_blend(outgoingLight, ${Ut.result}, 1.0, SPE_BLENDING_NORMAL);`),Ht?rr.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${Ht.result});`):rr.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),tr&&rr.push(`gl_FragColor.a *= ${tr.result};`),rr.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),_=rr.join(`
`)}return _}},Ms=class extends wt{constructor(){super("standard"),this.nodeType="Standard",this.color=new Le(dt),this.roughness=new J$2(.3),this.metalness=new J$2(0),this.reflectivity=new J$2(.5),this.previousModelViewMatrix=new Et,this.previouseProjectionMatrix=new Et,this.shadingAlpha=new J$2(1),this.shadingBlend=new _e(0),this.occlusion=new et(!0)}get category(){return"physical"}build(rt){let _;if(rt.define("STANDARD"),rt.requires.lights=!0,rt.extensions.derivatives=!0,rt.extensions.shaderTextureLOD=!0,rt.isShader("vertex")){let ut=this.position?this.position.analyzeAndFlow(rt,"v3",{cache:"position"}):void 0;rt.mergeUniform({frameIndex:be.frameIndex}),rt.mergeUniform({resolution:be.resolution}),rt.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),rt.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),rt.mergeUniform(UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights])),UniformsLib.LTC_1&&(rt.uniforms.ltc_1={value:void 0},rt.uniforms.ltc_2={value:void 0}),rt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let mt=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];ut&&mt.push(ut.code,ut.result?"displaced_position = "+ut.result+";":""),mt.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),mt.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),mt.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),_=mt.join(`
`)}else{rt.mergeUniform({penumbraSize:be.penumbraSize}),rt.mergeUniform({frameIndex:be.frameIndex}),rt.mergeUniform({aoMap:be.aoRenderTarget}),rt.mergeUniform({aoEnabled:be.aoEnabled});let ut={gamma:!0};this.color===void 0&&(this.color=new Le(dt)),this.color.analyze(rt,{slot:"color",context:ut}),this.roughness.analyze(rt),this.metalness.analyze(rt);let mt=this.occlusion.flow(rt,"b",{slot:"occlusion"});this.shadingAlpha.analyze(rt),this.shadingBlend.analyze(rt),this.afterColor&&this.afterColor.analyze(rt,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(rt),this.reflectivity&&this.reflectivity.analyze(rt);let bt=this.color.flow(rt,"c",{slot:"color",context:ut}),St=this.roughness.flow(rt,"f"),Mt=this.metalness.flow(rt,"f"),Bt=this.shadingAlpha.flow(rt,"f"),Ut=this.shadingBlend.flow(rt,"i"),Ht=this.afterColor?this.afterColor.flow(rt,"c",{slot:"afterColor"}):void 0,tr=this.alpha?this.alpha.flow(rt,"f"):void 0,rr=this.alphaOverride?this.alphaOverride.flow(rt,"f"):void 0,sr=this.reflectivity?this.reflectivity.flow(rt,"f"):void 0;rt.requires.transparent=tr!==void 0,rt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let ar=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){rt.include(To.dHdxy),rt.include(To.perturbNormalArb);let Ar=this.bumpMap.texture.flow(rt,"t"),_r=this.bumpMap.flow(rt,"v3"),Dr=this.bumpMapIntensity?this.bumpMapIntensity.flow(rt,"f").result:"1.0",$r="";this.bumpMap.projection.value===4?$r=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${Ar.result}, uv0, ${Dr});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${Ar.result}, uv1, ${Dr});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${Ar.result}, uv2, ${Dr});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:$r=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${Ar.result}, bumpMapCachedUv, ${Dr});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,ar.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${_r.result};
					${$r}
					`)}if(ar.push(bt.code,"	vec3 diffuseColor = "+bt.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",Mt.code,"	float metalnessFactor = "+Mt.result+";"),this.roughnessMap){let Ar=this.roughnessMap.texture.flow(rt,"t"),_r=this.roughnessMap.flow(rt,"v3"),Dr="";this.roughnessMap.projection.value===4?Dr=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${Ar.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${Ar.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${Ar.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${St.result};
					`:Dr=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${Ar.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${St.result};
					`,ar.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${_r.result};

					const float roughnessScale = 1.0;

					${Dr}
				`)}else ar.push(St.code,"	float roughnessFactor = "+St.result+";");tr&&ar.push(tr.code,"#ifdef ALPHATEST","	if ( "+tr.result+" <= ALPHATEST ) discard;","#endif"),ar.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),ar.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),sr?ar.push(sr.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+sr.result+" ) ), diffuseColor, metalnessFactor );"):ar.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),ar.push("#include <lights_fragment_begin>"),ar.push("#include <lights_fragment_end>"),ar.push("vec3 ao = aoEnabled && "+mt.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let cr="1.0";this.mask&&(this.mask.analyze(rt),cr=`luminance(${this.mask.flow(rt,"v3").result})`),ar.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${Bt.result} * ${cr} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${Bt.result} * ${cr}, ${Ut.result} );
					
					outgoingLight *= ao;
				}
				`),Ht&&ar.push(Ht.code,`outgoingLight = spe_blend(outgoingLight, ${Ht.result}, 1.0, SPE_BLENDING_NORMAL);`),tr?ar.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${tr.result} );`):ar.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),rr&&ar.push(`gl_FragColor.a *= ${rr.result};`),ar.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),_=ar.join(`
`)}return _}},Is=class extends wt{constructor(){super("toon"),this.nodeType="Toon",this.color=new Le(dt),this.specular=new Le(1118481),this.shininess=new J$2(30),this.previousModelViewMatrix=new Et,this.previouseProjectionMatrix=new Et,this.shadingAlpha=new J$2(1),this.shadingBlend=new _e(0)}get category(){return"toon"}build(rt){let _;if(rt.define("TOON"),rt.requires.lights=!0,rt.extensions.derivatives=!0,rt.isShader("vertex")){let ut=this.position?this.position.analyzeAndFlow(rt,"v3",{cache:"position"}):void 0;rt.mergeUniform({frameIndex:be.frameIndex}),rt.mergeUniform({resolution:be.resolution}),rt.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),rt.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),rt.mergeUniform(UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights])),rt.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let mt=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];ut&&mt.push(ut.code,ut.result?"displaced_position = "+ut.result+";":""),mt.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),mt.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),mt.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),_=mt.join(`
`)}else{rt.mergeUniform({penumbraSize:be.penumbraSize}),rt.mergeUniform({frameIndex:be.frameIndex}),rt.mergeUniform({aoMap:be.aoRenderTarget}),rt.mergeUniform({aoEnabled:be.aoEnabled}),this.color===void 0&&(this.color=new Le(dt)),this.color.analyze(rt,{slot:"color"}),this.specular.analyze(rt),this.shininess.analyze(rt),this.shadingAlpha.analyze(rt),this.shadingBlend.analyze(rt),this.afterColor&&this.afterColor.analyze(rt,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(rt);let ut=this.color.flow(rt,"c",{slot:"color"}),mt=this.specular.flow(rt,"c"),bt=this.shininess.flow(rt,"f"),St=this.shadingAlpha.flow(rt,"f"),Mt=this.shadingBlend.flow(rt,"i"),Bt=this.afterColor?this.afterColor.flow(rt,"c",{slot:"afterColor"}):void 0,Ut=this.alpha?this.alpha.flow(rt,"f"):void 0,Ht=this.alphaOverride?this.alphaOverride.flow(rt,"f"):void 0;rt.requires.transparent=Ut!==void 0,rt.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let tr=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){rt.include(To.dHdxy),rt.include(To.perturbNormalArb);let sr=this.bumpMap.texture.flow(rt,"t"),ar=this.bumpMap.flow(rt,"v3"),cr=this.bumpMapIntensity?this.bumpMapIntensity.flow(rt,"f").result:"1.0",Ar="";this.bumpMap.projection.value===4?Ar=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${sr.result}, uv0, ${cr});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${sr.result}, uv1, ${cr});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${sr.result}, uv2, ${cr});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:Ar=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${sr.result}, bumpMapCachedUv, ${cr});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,tr.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${ar.result};
					${Ar}
					`)}tr.push(ut.code,"	vec3 diffuseColor = "+ut.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",mt.code,"	vec3 specular = "+mt.result+";",bt.code,"	float shininess = max( 0.0001, "+bt.result+" );","	float specularStrength = 1.0;"),Ut&&tr.push(Ut.code,"#ifdef ALPHATEST","if ( "+Ut.result+" <= ALPHATEST ) discard;","#endif"),tr.push("material.diffuseColor = diffuseColor;"),tr.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),tr.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let rr="1.0";this.mask&&(this.mask.analyze(rt),rr=`luminance(${this.mask.flow(rt,"v3").result})`),tr.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${St.result} * ${rr} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${St.result} * ${rr}, ${Mt.result} );
				}
				`),Bt&&tr.push(Bt.code,`outgoingLight = spe_blend(outgoingLight, ${Bt.result}, 1.0, SPE_BLENDING_NORMAL);`),Ut?tr.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${Ut.result} );`):tr.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),Ht&&tr.push(`gl_FragColor.a *= ${Ht.result};`),tr.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),_=tr.join(`
`)}return _}},Rc=class{constructor(rt=1e3*10){this.timeout=rt,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...rt){}remove(rt){let _=this.cache.get(rt);_&&(this.dispose(rt,_.data),this.cache.delete(rt),_.prev.next=_.next,_.next.prev=_.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let rt=Date.now(),_=this.head.next;for(;_.time<rt-this.timeout;)this.dispose(_.src,_.data),this.cache.delete(_.src),_=_.next,_.prev=this.head,this.head.next=_;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(rt){var _;return(_=this.cache.get(rt))==null?void 0:_.data}load(rt){let _=Date.now(),ut=this.cache.get(rt);return ut===void 0?(ut={data:this.create(rt),src:rt,time:_,next:null,prev:null},this.cache.set(rt,ut)):(ut.time=_,ut.prev.next=ut.next,ut.next.prev=ut.prev),ut.prev=this.tail.prev,ut.next=this.tail,this.tail.prev.next=ut,this.tail.prev=ut,this.scheduleCleanup(),ut.data}},gp=class extends Rc{create(rt){return URL.createObjectURL(new Blob([rt]))}dispose(rt,_){URL.revokeObjectURL(_)}},yp;function E0(rt){return typeof rt=="string"?rt:(yp||(yp=new gp),yp.load(rt))}var Vc=class{constructor(rt,_){this.data=rt,this.cache=_,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},Gc=class{constructor(){this.cache=new Map}remove(rt){this.cache.delete(rt.data)}load(rt){let _=this.cache.get(rt);return _===void 0&&(_=this.create(rt),this.cache.set(rt,_)),_.refCount+=1,_}},Ca=class extends Vc{constructor(rt,_){super(rt,_.imageHolderCache),this.data=rt,this.shared=_,this.loaded=!1,this.isVideo=!1,this.isVideo=rt.type==="video",this.updateSrc(rt.data)}async updateSrc(rt){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let _=()=>{this.loaded=!0;let mt=[1e3,1001,1002];for(let bt of mt){let St=this[bt];St&&(St.image=this.img,St.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof rt!="string"){var ut=new FileReader;ut.readAsDataURL(new Blob([rt],{type:"video/mp4"}));let mt;await new Promise(bt=>{ut.onloadend=St=>{var Mt;mt=(Mt=St.target)==null?void 0:Mt.result,bt(null)}}),this.img.src=mt}else this.img.src=rt;this.img.onloadeddata=()=>{_()}}else this.img=new Image,this.img.src=E0(rt),this.img.onload=_}getTexture(rt){let _=this[rt];if(_)return _;{let ut;return this.isVideo?ut=new VideoTexture(this.img,void 0,rt,rt):ut=new Texture(this.img,void 0,rt,rt),this.loaded&&(ut.needsUpdate=!0),this[rt]=ut,ut}}disposeTextures(){var rt,_,ut;(rt=this[1e3])==null||rt.dispose(),this[1e3]=void 0,(_=this[1001])==null||_.dispose(),this[1001]=void 0,(ut=this[1002])==null||ut.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},fr=class extends Ca{};function Dt(rt,_){return _.color(rt)}function D0(rt,_){switch(rt.type){case"fresnel":return hO(rt,_);case"gradient":return mO(rt,_);case"depth":return yO(rt,_);case"normal":return gO(rt,_);case"noise":return xO(rt,_);case"rainbow":return vO(rt,_);case"toon":return bO(rt,_);case"outline":return SO(rt,_);case"transmission":return wO(rt,_);case"color":return fO(rt,_);case"pattern":return _O(rt,_)}}function pO(rt){return{type:rt.type}}function Ir(rt,_){let{alpha:ut,mode:mt,isMask:bt}=rt,St=typeof ut=="string"?(Number(_.getVariable(ut))??100)/100:ut;return{...pO(rt),alpha:St,mode:mt,isMask:bt}}function fO(rt,_){return{...Ir(rt,_),color:Dt(rt.color,_)}}function hO(rt,_){let{bias:ut,scale:mt,intensity:bt,factor:St,color:Mt}=rt;return{...Ir(rt,_),color:Dt(Mt,_),bias:ut,scale:mt,intensity:bt,factor:St}}function mO(rt,_){let{gradientType:ut,smooth:mt,colors:bt,steps:St,angle:Mt,offset:Bt,morph:Ut}=rt;return{...Ir(rt,_),gradientType:ut,smooth:mt,colors:bt.map(Ht=>new Vector4(Ht[0],Ht[1],Ht[2],Ht[3])),num:bt.length,steps:St,offset:new Vector2(...Bt),morph:new Vector2(...Ut),angle:Mt}}function yO(rt,_){let{gradientType:ut,near:mt,far:bt,isVector:St,isWorldSpace:Mt,origin:Bt,direction:Ut,colors:Ht,steps:tr,smooth:rr}=rt;return{...Ir(rt,_),gradientType:ut,near:mt,far:bt,isVector:St,isWorldSpace:Mt,origin:new Vector3(...Bt),direction:Ut?new Vector3(...Ut):new Vector3(1,0,0),colors:Ht.map(sr=>sr!==void 0?new Vector4(sr[0],sr[1],sr[2],sr[3]):new Vector4(0,0,0,0)),steps:tr.slice(0,Ht.length),smooth:rr}}function gO(rt,_){let{cnormal:ut}=rt;return{...Ir(rt,_),cnormal:new Vector3(ut[0],ut[1],ut[2])}}function xO(rt,_){return{...Ir(rt,_),scale:rt.scale,move:rt.move,fA:new Vector2(...rt.fA),fB:new Vector2(...rt.fB),size:new Vector3(...rt.size),distortion:new Vector2(...rt.distortion),colorA:Dt(rt.colorA,_),colorB:Dt(rt.colorB,_),colorC:Dt(rt.colorC,_),colorD:Dt(rt.colorD,_),noiseType:rt.noiseType,voronoiStyle:rt.voronoiStyle,highCut:rt.highCut,lowCut:rt.lowCut,smoothness:rt.smoothness,seed:rt.seed,quality:rt.quality}}function vO(rt,_){return{...Ir(rt,_),filmThickness:rt.filmThickness,movement:rt.movement,wavelengths:new Vector3(...rt.wavelengths),noiseStrength:rt.noiseStrength,noiseScale:rt.noiseScale,offset:new Vector3(...rt.offset)}}function bO(rt,_){return{...Ir(rt,_),positioning:rt.positioning,colors:rt.colors.map(ut=>new Vector4(ut[0],ut[1],ut[2],ut[3])),num:rt.colors.length,steps:rt.steps,source:new Vector3(...rt.source),isWorldSpace:rt.isWorldSpace,noiseStrength:rt.noiseStrength,noiseScale:rt.noiseScale,shadowColor:Dt(rt.shadowColor,_),offset:new Vector3(...rt.offset)}}function SO(rt,_){return{...Ir(rt,_),outlineColor:Dt(rt.outlineColor,_),contourColor:Dt(rt.contourColor,_),outlineWidth:rt.outlineWidth,contourWidth:rt.contourWidth,outlineThreshold:rt.outlineThreshold,contourThreshold:rt.contourThreshold,outlineSmoothing:rt.outlineSmoothing,contourFrequency:rt.contourFrequency,contourDirection:new Vector3(...rt.contourDirection),positionalLines:rt.positionalLines,compensation:rt.compensation}}function wO(rt,_){return{...Ir(rt,_),thickness:rt.thickness,ior:rt.ior,roughness:rt.roughness}}function _O(rt,_){return{...Ir(rt,_),style:rt.style,projection:rt.projection,axis:rt.axis,blending:rt.blending,offset:new Vector2(...rt.offset),colorA:Dt(rt.colorA,_),colorB:Dt(rt.colorB,_),frequency:new Vector2(...rt.frequency),size:rt.size,variation:rt.variation,smoothness:rt.smoothness,zigzag:rt.zigzag,rotation:rt.rotation,vertical:new Vector2(...rt.vertical),horizontal:new Vector2(...rt.horizontal),sides:rt.sides}}var an=class extends ht{},xp={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},vp={depth:["colors"]};function TO(rt,_,ut){var St,Mt;if(_==="isMask")return!0;let mt=xp[rt.type],bt=vp[rt.type];if(bt!==void 0){let Bt=rt.color;if(bt.includes(_)){let Ut=(Mt=(St=Bt[_])==null?void 0:St.value)==null?void 0:Mt.length;if(Ut!==void 0&&Ut!==ut.length)return!0}}return mt!==void 0?mt.includes(_):!1}function bp(rt,_,ut){let mt=ut.uniforms[`f${ut.id}_texture`];if(!mt)return!1;let bt=!1,St=rt;if("image"in St){let Mt=St.image,Bt=_.image(Mt),Ut=mt;Ut.image instanceof fr||Ut.image.deref(),Ut.image=Bt}if("video"in St){let Mt=St.video,Bt=_.video(Mt),Ut=mt;Ut.image instanceof fr||Ut.image.deref(),Ut.image=Bt}if("wrapping"in St){let Mt=mt;Mt.wrap=St.wrapping}if("repeat"in St||"offset"in St){let Mt="mat",Bt=ut.uniforms[`f${ut.id}_${Mt}`];"repeat"in St&&(Bt.repeat=St.repeat),"offset"in St&&(Bt.offset=St.offset),Bt.updateMatrix()}return bt}function L0(rt,_,ut,mt){let bt=!1;for(let[St,Mt]of Object.entries(rt)){if(St==="bumpMap"||St==="roughnessMap"){bt=!0;continue}if(!St||Mt===void 0)continue;if(Sp(St,ut,mt,_)){St==="visible"&&ut.type==="light"&&(bt=!0);continue}ut.visible=mt.visible;let Bt=ut.uniforms[`f${ut.id}_${St}`];if(Bt&&!(Bt instanceof on$1))switch(bt=bt||TO(ut,St,Mt),Bt.constructor){case Le:if(typeof Mt=="string"){let Ut=_.getColor(Mt);Ut&&(Bt.value=Ut);break}else{let Ut=Mt;Bt.value instanceof an?Bt.value=new ht(Ut.r,Ut.g,Ut.b,Ut.a):Bt.setRGBA(Ut);break}case Kt:if(typeof Mt=="string"){let Ut=_.getColor(Mt);Ut&&(Bt.value=Ut);break}else{let Ut=Mt;Bt.value instanceof an?Bt.value=new ht(Ut.r,Ut.g,Ut.b,Ut.a):Bt.value.setRGBA(Ut.r,Ut.g,Ut.b,Ut.a);break}case Ke:{let Ut=Mt;Bt.value.setX(Ut[0]),Bt.value.setY(Ut[1]);break}case Nt:{let Ut=Mt;Bt.value.setX(Ut[0]),Bt.value.setY(Ut[1]),Bt.value.setZ(Ut[2]);break}case Ft:{bp(Mt,_,ut);break}case Mr:{Bt.value=Mt.map(Ut=>new Vector4(...Ut));break}default:{Bt.value=Mt;break}}}return bt}var sn=(rt,_,ut)=>Math.max(0,Math.min(1,Number(_.getVariable(typeof rt=="number"?rt*100:rt,ut)??100)/100))??1,to=class{constructor(rt,_,ut,mt,bt){this.id=rt,this.uuid=_,this.data=ut,this.uniforms={};for(let St in mt)this.uniforms[`f${this.id}_${St}`]=mt[St];for(let St in ut)Sp(St,this,ut,bt)}get type(){return this.data.type}static create(rt,_,ut,mt){if(ut.type==="light")return lr.createLigherLayer(rt,_,ut,mt);if(ut.type==="texture"||ut.type==="video"){let bt=ut.type==="texture"?mt.image(ut.texture.image):mt.video(ut.texture.video),St=new Ln(bt,ut.texture.wrapping),Mt=new Lc(bt),Bt=new Bc(ut.texture.repeat,ut.texture.offset),Ut=new J$2(ut.crop?1:0),Ht=new _e(ut.projection??0),tr=new _e(["x","y","z"].indexOf(ut.axis)??0),rr=new _e(ut.side??0),sr=new Ke(ut.size?new Vector2(ut.size[0],ut.size[1]):new Vector2(100,100)),ar=new J$2(ut.blending??0),cr=new J$2(sn(ut.alpha,mt)),Ar=new _e(ut.mode??0),_r=new et(ut.isMask??!1),Dr=new nn(St,Mt,Ut,Ht,tr,rr,sr,ar,Bt,cr,Ar,_r),$r=new Ee(Dr.calpha,"f");return new We(rt,_,ut,{texture:St,textureSize:Mt,crop:Ut,projection:Ht,axis:tr,side:rr,size:sr,blending:ar,mat:Bt,alpha:cr,mode:Ar,isMask:_r},Dr,Ar,$r,_r,mt)}else if(ut.type==="matcap"){let bt=mt.image(ut.texture.image),St=new Ln(bt,ut.texture.wrapping),Mt=new J$2(sn(ut.alpha,mt)),Bt=new _e(ut.mode??0),Ut=new et(ut.isMask??!1),Ht=new xa(St,Mt,Bt,Ut),tr=new Ee(Ht.calpha,"f");return new We(rt,_,ut,{texture:St,alpha:Mt,mode:Bt,isMask:Ut},Ht,Bt,tr,Ut,mt)}else if(ut.type==="displace")if(ut.displacementType==="noise"){let bt=new Nt(new Vector3(...ut.offset)),St=new J$2(ut.scale??10),Mt=new J$2(ut.intensity??8),Bt=new J$2(ut.movement??1),Ut=new _e(ut.noiseType??0),Ht=new _e(ut.voronoiStyle??0),tr=new J$2(ut.smoothness??.5),rr=new J$2(ut.seed??0),sr=new J$2(ut.highCut??1),ar=new J$2(ut.lowCut??0),cr=new _e(ut.quality??1),Ar=new Ta(Mt,Bt,bt,Ht,tr,rr,sr,ar,cr,St,Ut);return new Ns(rt,_,ut,{offset:bt,scale:St,intensity:Mt,movement:Bt,noiseType:Ut,voronoiStyle:Ht,smoothness:tr,seed:rr,highCut:sr,lowCut:ar,quality:cr},Ar,mt)}else throw new Error;else return OO(rt,_,ut,mt)}updateByOp(rt,_,ut){let mt=rt;if(mt.path[0]===void 0){if(mt.type===0)return"type"in mt.props||"category"in mt.props||"visible"in mt.props?(ut.scene.markNeedsUpdateRendererDirty(),!0):L0(mt.props,ut.shared,this,_)}else if(mt.path[0]==="texture")return"texture"in _||"video"in _?bp(mt.props,ut.shared,this):!0;return!1}dispose(){if(CO(this)){let rt=this.uniforms[`f${this.id}_texture`];if(!rt)return!1;let _=rt;_.image instanceof fr||_.image.deref()}}hasValueByKey(rt){return this.uniforms[rt]!==void 0}hasValue(rt){return this.hasValueByKey(`f${this.id}_${rt}`)}setValue(rt,_){let ut=`f${this.id}_${rt}`;this.hasValueByKey(ut)&&_!==void 0&&(this.uniforms[ut].value=_)}getNode(rt){let _=`f${this.id}_${rt}`;if(this.hasValueByKey(_))return this.uniforms[_]}getValue(rt){let _=`f${this.id}_${rt}`;if(this.hasValueByKey(_))return this.uniforms[_].value}getName(rt){let _=/f\d+_(.*)/.exec(rt);if(_&&_.length>1)return _[1];console.log(`Layer.getName: error ${rt}`)}getNames(){let rt=[];for(let _ in this.uniforms){let ut=this.getName(_);ut&&rt.push(ut)}return rt}},We=class extends to{constructor(rt,_,ut,mt,bt,St,Mt,Bt,Ut){super(rt,_,ut,mt,Ut),this.params=mt,this.color=bt,this.mode=St,this.alpha=Mt,this.isMask=Bt}},Ns=class extends to{constructor(rt,_,ut,mt,bt,St){super(rt,_,ut,mt,St),this.position=bt}},lr=class extends to{constructor(rt,_,ut,mt,bt,St){super(rt,_,ut,bt,St),this.node=mt}static createLigherLayer(rt,_,ut,mt){let bt,St=new J$2(sn(ut.alpha,mt)),Mt=new _e(ut.mode),Bt=new J$2(ut.bumpMapIntensity),Ut=new J$2(sn(ut.alphaOverride,mt)),Ht;if(!ut.visible)bt=new Vn,Ht={};else if(ut.category==="lambert"){bt=new Ps;let tr=new Le(mt.color(ut.emissive)??0),rr=new et(ut.occlusion??!0);Ht={emissive:tr,occlusion:rr},bt.emissive=tr,bt.occlusion=rr}else if(ut.category==="toon"){bt=new Is;let tr=new J$2(ut.shininess??30),rr=new Le(mt.color(ut.specular)??1118481);Ht={shininess:tr,specular:rr},bt.shininess=tr,bt.specular=rr}else if(ut.category==="physical"){bt=new Ms;let tr=new J$2(ut.roughness??.3),rr=new J$2(ut.metalness??0),sr=new J$2(ut.reflectivity??.5),ar=new et(ut.occlusion??!0);Ht={roughness:tr,metalness:rr,reflectivity:sr,occlusion:ar},bt.roughness=tr,bt.metalness=rr,bt.reflectivity=sr,bt.occlusion=ar}else{bt=new Os;let tr=new J$2(ut.shininess??30),rr=new Le(ut.specular!==void 0?mt.color(ut.specular)??1118481:1118481),sr=new et(ut.occlusion??!0);Ht={shininess:tr,specular:rr,occlusion:sr},bt.shininess=tr,bt.specular=rr,bt.occlusion=sr}return bt.alpha=new J$2(1),bt.shadingAlpha=St,bt.shadingBlend=Mt,bt.bumpMapIntensity=Bt,bt.alphaOverride=Ut,Ht.alpha=bt.shadingAlpha,Ht.mode=bt.shadingBlend,Ht.bumpMapIntensity=bt.bumpMapIntensity,Ht.alphaOverride=bt.alphaOverride,new lr(rt,_,ut,bt,Ht,mt)}get category(){return this.node.category}};function CO(rt){let _=rt instanceof to?rt.type:rt;return _==="texture"||_==="video"||_==="displace_map"||_==="matcap"}function hr(rt){return{alpha:new J$2(rt.alpha??1),mode:new _e(rt.mode??0),isMask:new et(rt.isMask??!1)}}function PO(rt,_,ut,mt,bt){switch(rt.type){case"color":{let St=new Le(mt.color??dt),Mt=hr(mt),Bt=new Bn(St,Mt.alpha),Ut=new Ee(Bt.calpha,"f");return new We(_,ut,rt,{color:St,...Mt},Bt,Mt.mode,Ut,Mt.isMask,bt)}case"fresnel":{let St=new Le(mt.color??16777215),Mt=new J$2(mt.bias??.1),Bt=new J$2(mt.scale??1),Ut=new J$2(mt.intensity??2),Ht=new J$2(mt.factor??1),tr=hr(mt),rr=new Ts(St,Mt,Bt,Ut,Ht,tr.alpha,tr.mode,tr.isMask),sr=new Ee(rr.calpha,"f");return new We(_,ut,rt,{color:St,bias:Mt,scale:Bt,intensity:Ut,factor:Ht,...tr},rr,tr.mode,sr,tr.isMask,bt)}case"rainbow":{let St=new J$2(mt.filmThickness??30),Mt=new J$2(mt.movement??0),Bt=new Nt(mt.wavelengths??new Vector3(0,0,0)),Ut=new J$2(mt.noiseStrength??0),Ht=new J$2(mt.noiseScale??1),tr=new Nt(mt.offset??new Vector3(0,0,0)),rr=hr(mt),sr=new wa(St,Mt,Bt,Ut,Ht,tr,rr.alpha,rr.isMask),ar=new Ee(sr.calpha,"f");return new We(_,ut,rt,{filmThickness:St,movement:Mt,wavelengths:Bt,noiseStrength:Ut,noiseScale:Ht,offset:tr,...rr},sr,rr.mode,ar,rr.isMask,bt)}case"transmission":{let St=new J$2(mt.thickness??10),Mt=new J$2(mt.ior??1.5),Bt=new J$2(mt.roughness??.5),Ut=be.transmissionSize,Ht=be.transmissionRenderTarget,tr=be.transmissionRenderTargetDepth,rr=window.innerWidth,sr=window.innerHeight,ar=rr>=sr?new Ke(sr/rr,1):new Ke(1,rr/sr),cr=hr(mt),Ar=new Aa(St,Mt,Bt,Ut,Ht,tr,ar,cr.alpha),_r=new Ee(Ar.calpha,"f");return new We(_,ut,rt,{thickness:St,ior:Mt,roughness:Bt,aspectRatio:ar,...cr},Ar,cr.mode,_r,cr.isMask,bt)}case"toon":{let St=new _e(mt.positioning??0),Mt;mt.colors?Mt=new Mr(mt.colors.length,mt.colors):(Mt=new Mr(10,new Vector4(0,0,0,1)),Mt.value[1]=new Vector4(1,1,1,1));let Bt;mt.steps?Bt=new Or(mt.steps.length,mt.steps):(Bt=new Or(10,1),Bt.value[0]=0);let Ut=new Nt(mt.source??new Vector3(0,0,0)),Ht=new et(mt.isWorldSpace??!0),tr=new J$2(mt.noiseStrength??0),rr=new J$2(mt.noiseScale??1),sr=new Kt(mt.shadowColor),ar=new Nt(mt.offset??new Vector3(0,0,0)),cr=hr(mt),Ar=new _a(St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr.alpha),_r=new Ee(Ar.calpha,"f");return new We(_,ut,rt,{positioning:St,colors:Mt,steps:Bt,source:Ut,isWorldSpace:Ht,noiseStrength:tr,noiseScale:rr,shadowColor:sr,offset:ar,...cr},Ar,cr.mode,_r,cr.isMask,bt)}case"outline":{let St=new Le(mt.outlineColor??16777215),Mt=new Le(mt.contourColor??16777215),Bt=new J$2(mt.outlineWidth??.1),Ut=new J$2(mt.contourWidth??.1),Ht=new J$2(mt.outlineThreshold??.1),tr=new J$2(mt.contourThreshold??.1),rr=new J$2(mt.outlineSmoothing??.1),sr=new J$2(mt.contourFrequency??.1),ar=new Nt(mt.contourDirection??new Vector3(0,1,0)),cr=new et(mt.positionalLines??!1),Ar=new et(mt.compensation??!0),_r=be.normalRenderTarget,Dr=be.normalRenderTargetDepth,$r=be.pixelRatioNode,Br=be.resolution,Jr=hr(mt),mn=new ba(St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar,Br,_r,Dr,$r,Jr.alpha),Mn=new Ee(mn.calpha,"f");return new We(_,ut,rt,{outlineColor:St,contourColor:Mt,outlineWidth:Bt,contourWidth:Ut,outlineThreshold:Ht,contourThreshold:tr,outlineSmoothing:rr,contourFrequency:sr,contourDirection:ar,positionalLines:cr,compensation:Ar,...Jr},mn,Jr.mode,Mn,Jr.isMask,bt)}case"depth":{let St=new _e(mt.gradientType??0),Mt=new et(mt.smooth??!1),Bt=new J$2(mt.near??50),Ut=new J$2(mt.far??200),Ht=new J$2(mt.isVector??1),tr=new J$2(mt.isWorldSpace??0),rr=new Nt(mt.origin??new Vector3),sr=new Nt(mt.direction??new Vector3),ar;mt.colors?ar=new Mr(mt.colors.length,mt.colors):(ar=new Mr(2,new Vector4(0,0,0,1)),ar.value[1]=new Vector4(1,1,1,1));let cr;mt.steps?cr=new Or(mt.steps.length,mt.steps):(cr=new Or(2,1),cr.value[0]=0);let Ar=hr(mt),_r=new ya(St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar.alpha,Ar.isMask),Dr=new Ee(_r.calpha,"f");return new We(_,ut,rt,{gradientType:St,smooth:Mt,near:Bt,far:Ut,isVector:Ht,isWorldSpace:tr,origin:rr,direction:sr,colors:ar,steps:cr,...Ar},_r,Ar.mode,Dr,Ar.isMask,bt)}case"noise":{let St=new J$2(mt.scale??1),Mt=new Nt(mt.size??new Vector3(100,100,100)),Bt=new J$2(mt.move??1),Ut=new Ke(mt.fA??new Vector2(1.7,9.2)),Ht=new Ke(mt.fB??new Vector2(8.3,2.8)),tr=new Ke(mt.distortion??new Vector2(1,1)),rr=new Kt(mt.colorA),sr=new Kt(mt.colorB),ar=new Kt(mt.colorC),cr=new Kt(mt.colorD),Ar=new _e(mt.noiseType??0),_r=new _e(mt.voronoiStyle??0),Dr=new J$2(mt.highCut??1),$r=new J$2(mt.lowCut??0),Br=new J$2(mt.smoothness??.5),Jr=new J$2(mt.seed??.5),mn=new _e(mt.quality??1),Mn=hr(mt),$n=new va(St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Mn.alpha,Ar,Mn.isMask,_r,Dr,$r,Br,Jr,mn),en=new Ee($n.calpha,"f");return new We(_,ut,rt,{scale:St,size:Mt,move:Bt,fA:Ut,fB:Ht,distortion:tr,colorA:rr,colorB:sr,colorC:ar,colorD:cr,noiseType:Ar,...Mn,voronoiStyle:_r,highCut:Dr,lowCut:$r,smoothness:Br,seed:Jr,quality:mn},$n,Mn.mode,en,Mn.isMask,bt)}case"normal":{let St=new Nt(mt.cnormal??new Vector3(1,1,1)),Mt=hr(mt),Bt=new fa(St,Mt.alpha),Ut=new Ee(Bt.calpha,"f");return new We(_,ut,rt,{cnormal:St,...Mt},Bt,Mt.mode,Ut,Mt.isMask,bt)}case"gradient":{let St=new _e(mt.gradientType??0),Mt=new et(mt.smooth??!1),Bt;mt.colors?Bt=new Mr(mt.colors.length,mt.colors):(Bt=new Mr(10,new Vector4(0,0,0,1)),Bt.value[1]=new Vector4(1,1,1,1));let Ut;mt.steps?Ut=new Or(mt.steps.length,mt.steps):(Ut=new Or(10,1),Ut.value[0]=0);let Ht=new Ke(mt.offset??new Vector2(0,0)),tr=new Ke(mt.morph??new Vector2(0,0)),rr=new J$2(mt.angle??0),sr=hr(mt),ar=new ga(St,Mt,Bt,Ut,Ht,tr,rr,sr.alpha,sr.isMask),cr=new Ee(ar.calpha,"f");return new We(_,ut,rt,{gradientType:St,smooth:Mt,colors:Bt,steps:Ut,offset:Ht,morph:tr,angle:rr,...sr},ar,sr.mode,cr,sr.isMask,bt)}case"pattern":{let St=new _e(mt.style??0),Mt=new _e(mt.projection??0),Bt=new _e(["x","y","z"].indexOf(mt.axis)??0),Ut=new J$2(mt.blending??0),Ht=new Ke(mt.offset??new Vector2(0,0)),tr=new Kt(mt.colorA),rr=new Kt(mt.colorB),sr=new Ke(mt.frequency??new Vector2(10,10)),ar=new J$2(mt.size??.5),cr=new J$2(mt.variation??0),Ar=new J$2(mt.smoothness??.5),_r=new J$2(mt.zigzag??0),Dr=new J$2(mt.rotation??0),$r=new Ke(mt.vertical??new Vector2(0,1)),Br=new Ke(mt.horizontal??new Vector2(0,1)),Jr=new _e(mt.sides??6),mn=hr(mt),Mn=new Sa(St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar,_r,Dr,$r,Br,Jr,mn.alpha,mn.isMask),$n=new Ee(Mn.calpha,"f");return new We(_,ut,rt,{style:St,projection:Mt,axis:Bt,blending:Ut,offset:Ht,colorA:tr,colorB:rr,frequency:sr,size:ar,variation:cr,smoothness:Ar,zigzag:_r,rotation:Dr,vertical:$r,horizontal:Br,sides:Jr,...mn},Mn,mn.mode,$n,mn.isMask,bt)}default:{let St=new Le(1,0,0,1),Mt=hr(mt),Bt=new Bn(St,Mt.alpha),Ut=new Ee(Bt.calpha,"f");return new We(_,ut,rt,{color:St,...Mt},Bt,Mt.mode,Ut,Mt.isMask,bt)}}}function OO(rt,_,ut,mt){let bt=D0(ut,mt);return PO(ut,rt,_,bt,mt)}function Sp(rt,_,ut,mt){if(ut.type==="displace"&&(rt==="intensity"||rt==="visible")){let bt=_.uniforms[`f${_.id}_intensity`];return bt?(bt.value=ut.intensity*(ut.visible?1:0),bt):void 0}if(ut.type!=="displace"&&(rt==="alpha"||rt==="visible")){let bt=_.uniforms[`f${_.id}_alpha`];if(!bt)return;if(bt.value=sn(ut.alpha,mt)*(ut.visible?1:0),ut.type==="outline"&&rt==="visible"){let St=_.uniforms[`f${_.id}_compensation`];St&&(St.value=ut.compensation&&ut.visible)}return bt}}function kc(rt,_){let ut=0,mt=rt.layers.find(bt=>bt.data.type==="light");if(mt){let bt=mt.data,St=Number(_.getVariable(bt.alphaOverride));if((typeof bt.alphaOverride=="string"?St/100:bt.alphaOverride)<1)return!0}for(let bt of rt.layers){if(bt.data.type!=="displace"&&bt.data.isMask)return!0;if(bt.data.type!=="displace"&&"alpha"in bt.data&&bt.data.type!=="light"&&bt.data.type!=="fresnel"&&bt.data.type!=="texture"&&bt.data.type!=="matcap"&&bt.data.type!=="rainbow"&&bt.data.type!=="outline"&&bt.data.type!=="pattern"){let St=bt.data.visible?bt.data.alpha:0;if(typeof St=="string"&&(St=Math.max(0,Math.min(1,Number(_.getVariable(St)??100)/100))),St===1&&bt.data.type==="depth"||bt.data.type==="gradient"){for(let Mt of bt.data.colors)if(Mt[3]<1){St=Mt[3];break}}else if(St===1&&bt.data.type==="noise"){let Mt=_.color(bt.data.colorA).a,Bt=_.color(bt.data.colorB).a,Ut=_.color(bt.data.colorC).a,Ht=_.color(bt.data.colorD).a,tr=Math.min(Mt,Math.min(Bt,Math.min(Ut,Ht)));tr<1&&(St=tr)}ut+=(1-ut)*St}}return ut<1}var Zt=class extends ShaderMaterial{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},Fc=class extends Zt{constructor(rt,_,ut,mt){super(),this.flatShading=rt,this.side=_,this.wireframe=ut,this.root=mt}updateAfterBuild(){let rt=this.root;this.lights=rt.lights,this.vertexShader=rt.vertexShader,this.fragmentShader=rt.fragmentShader,this.defines=rt.defines,this.uniforms=rt.uniforms,this.extensions=rt.extensions,this.transparent=rt.transparent,this.cacheKey=rt.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(rt,_){this.root.onBeforeCompile(rt)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(rt,_,ut){return this.root.getFlavor(rt,_,ut)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(rt){return this.root.getLayersOfType(rt)}getLayerByUuid(rt){return this.root.getLayerByUuid(rt)}updateByOp(rt,_,ut){this.root.updateByOp(rt,_,ut)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},Gn=class extends Zt{constructor(rt,_,ut=!0){super(),this.data=rt,this.allowVariableSaves=ut,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.reset0(rt,_)}get nodeMaterial(){return this}getFlavor(rt,_,ut){let mt=ut?6:(rt?3:0)+_;if(mt===0)return this;this.flavors===void 0&&(this.flavors=[]),mt-=1;let bt=this.flavors[mt];return bt===void 0&&(bt=new Fc(rt,_,ut,this),this.flavors[mt]=bt,bt.flatShading=rt,bt.side=_,bt.updateAfterBuild()),bt}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var rt;return((rt=this.lightLayer.getNode("occlusion"))==null?void 0:rt.value)??!1}reset(rt,_){this.data!==rt&&this.reset0(rt,_)}reset0(rt,_){this.data=rt;let ut=rt.layers??Pt.defaultTwoLayerData("phong").layers;try{this.layers=ut.map(mt=>to.create(this.layerIdGen++,mt.id,mt.data,_.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=rt.name??"Untitled Material",this.onUpdate(_.shared),this.transparent=kc(rt,_.shared),this.saveVariableLocations(_)}onVariableUpdate(rt,_,ut){if(rt[0]==="alphaOverride")this.transparent=kc(this.data,ut.shared),this.lightLayer.setValue("alphaOverride",Math.max(0,Math.min(Number(_)/100,1)));else if(rt[0]==="layer"){let mt=rt[1],bt=rt[2];if(mt&&bt){let St=this.layers.find(Mt=>Mt.uuid===mt);St!=null&&St.hasValue(bt)&&(bt==="alpha"?(this.transparent=kc(this.data,ut.shared),St.setValue(bt,Math.max(0,Math.min(Number(_)/100,1)))):St.setValue(bt,_))}}}saveVariableLocations(rt){if(!this.allowVariableSaves)return;let _=this.data.layers.find(ut=>ut.data.type==="light");_&&rt.shared.getVariable(_.data.alphaOverride,["material",this.uuid,"alphaOverride"]),this.data.layers.forEach(ut=>{"alpha"in ut.data&&typeof ut.data.alpha=="string"&&rt.shared.getVariable(ut.data.alpha,["material",this.uuid,"layer",ut.id,"alpha"])})}getLayersOfType(rt){return this.layers.filter(_=>_.type===rt)}getLayerByUuid(rt){return this.layers.find(_=>_.uuid===rt)}onUpdate(rt){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(_=>_ instanceof lr),this.lightLayer===void 0&&(this.lightLayer=new lr(0,"",{...zt.defaultData("light","phong"),visible:!1},new Vn,{},rt)),this.dispose();for(let _ of this.flavors)_&&_.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions()}applyTextureMaps(){let rt=this.layers.find(bt=>bt instanceof lr);if(!rt)return;let _=rt.data,ut=_.bumpMap,mt=_.roughnessMap;rt.node.bumpMap=void 0,rt.node.roughnessMap=void 0;for(let bt=0;bt<this.layers.length;++bt){let St=this.layers[bt];St instanceof We&&St.color instanceof nn&&(St.uuid===ut&&(rt.node.bumpMap=St.color),St.uuid===mt&&(rt.node.roughnessMap=St.color))}}updateByOp(rt,_,ut){if(_!==void 0?this.data=_:_=this.data,this.transparent=kc(_,ut.shared),rt.path[0]==="layers"){this.data=_;let mt=ut.shared,bt=rt.path[1];if(bt===void 0){if(this.layers.reverse(),rt.type===4){let St=to.create(this.layerIdGen++,rt.id,rt.data,ut.shared);this.layers.splice(rt.localIndex,0,St),ut.scene.markNeedsUpdateRendererDirty()}else if(rt.type===5)this.layers.splice(rt.localIndex,1)[0].dispose(),ut.scene.markNeedsUpdateRendererDirty();else if(rt.type===6){let St=this.layers.findIndex(Bt=>Bt.uuid===rt.id),Mt=this.layers[St];this.layers.splice(St,1),this.layers.splice(rt.localIndex,0,Mt),ut.scene.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate(ut.shared)}else{rt.type===0&&rt.props.occlusion!==void 0&&ut.scene.markNeedsUpdateRendererDirty();let St=this.layers.find(Mt=>Mt.uuid===bt);if(St){let Mt=_.layers.data(bt),Bt;if(rt.type===0&&("alpha"in rt.props||"alphaOverride"in rt.props)&&("alpha"in rt.props?Bt={...rt.props,alpha:sn(rt.props.alpha,mt,["material",this.uuid,"layer",bt,"alpha"])}:Bt={...rt.props,alphaOverride:sn(rt.props.alphaOverride,mt,["material",this.uuid,"alphaOverride"])}),St.updateByOp({...rt,...Bt?{props:Bt}:{},path:rt.path.slice(2)},Mt,ut)){let Ut=to.create(this.layerIdGen++,bt,Mt,mt);this.layers.splice(this.layers.findIndex(Ht=>Ht.uuid===bt),1,Ut),this.onUpdate(ut.shared)}}}}else this.reset(_,ut)}applyMasks(){for(let rt=0;rt<this.layers.length;++rt){let _=this.layers[rt];_ instanceof We?_.color.mask=void 0:_ instanceof lr&&(_.node.mask=void 0)}for(let rt=0;rt<this.layers.length;++rt){let _=this.layers[rt];if(_ instanceof We&&_.isMask.value&&_.data.visible&&rt>0){let ut=rt-1,mt=this.layers[ut];mt instanceof lr?mt.node.mask=new _t(_.color,_.alpha,_t.MUL):mt instanceof We&&(mt.isMask.value||(mt.color.mask=new _t(_.color,_.alpha,_t.MUL)))}}}blendColors(){let rt=this.layers.findIndex(ut=>ut instanceof We),_=this.layers.findIndex(ut=>ut instanceof lr);if(rt!==-1&&rt<_){let ut=this.layers[rt].color;for(let mt=rt+1;mt<_;++mt){let bt=this.layers[mt];if(bt instanceof We){if(bt.isMask.value)continue;ut=new pa(ut,bt.color,bt.alpha,bt.mode)}}this.fragment.color=ut}else this.fragment.color=void 0}blendAfterColors(){let rt=new Ee("outgoingLight","f"),_=this.layers.findIndex(ut=>ut instanceof lr);if(this.layers.length>_+1){for(let ut=_+1;ut<this.layers.length;++ut){let mt=this.layers[ut];if(mt instanceof We){if(mt.isMask.value)continue;rt=new pa(rt,mt.color,mt.alpha,mt.mode)}}this.fragment.afterColor=rt}else this.fragment.afterColor=void 0}blendPositions(){let rt=this.layers.filter(_=>_ instanceof Ns);if(rt.length>0){let _=rt[0].position;for(let ut=1;ut<rt.length;++ut)rt[ut]&&(_=new _t(_,rt[ut].position,_t.ADD),_=new _t(_,new J$2(.5).setReadonly(!0),_t.MUL));this.fragment.position=_}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(rt){this.build(),rt.defines=this.defines,rt.uniforms=this.uniforms,rt.vertexShader=this.vertexShader,rt.fragmentShader=this.fragmentShader,rt.extensionDerivatives=this.extensions.derivatives===!0,rt.extensionFragDepth=this.extensions.fragDepth===!0,rt.extensionDrawBuffers=this.extensions.drawBuffers===!0,rt.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(rt,_){let ut=(mt,bt,St)=>Math.min(Math.max(mt,bt),St);for(let mt of this.layers)if(mt.type==="displace"){let bt=ut(mt.uniforms[`f${mt.id}_intensity`].value,rt,_);mt.uniforms[`f${mt.id}_intensity`].value=bt}}computeCacheKey(){let rt="[";for(let{data:_}of this.data.layers)if(_.type==="light")rt+=`"${_.visible?_.category.toUpperCase():"Basic"}"`;else{let ut=(xp[_.type]??[]).map(Bt=>_[Bt]),mt=(vp[_.type]??[]).map(Bt=>{var Ut;return((Ut=_[Bt])==null?void 0:Ut.length)??0}),bt=[...ut,...mt],St="isMask"in _&&_.isMask,Mt=`"${_.type}-${_.visible}-${St}"`;bt.length?rt+=`[${Mt}, "${bt.join('","')}"],`:rt+=Mt}return rt=rt.slice(0,-1)+"]",rt}updateFrame(rt){for(let _=0;_<this.updaters.length;++_)rt.updateNode(this.updaters[_])}build(){let rt=new Dc;rt.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,rt.build(this.fragment,this.fragment),this.vertexShader=rt.getCode("vertex"),this.fragmentShader=rt.getCode("fragment"),this.defines=rt.defines,this.uniforms=rt.uniforms,this.extensions=rt.extensions,this.updaters=rt.updaters;for(let _ of this.flavors)_&&_.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(rt=>rt.dispose()),super.dispose();for(let rt of this.flavors)rt&&rt.dispose()}assetsLoaded(){for(let rt of this.layers)if(rt instanceof We){let _=rt.params.texture;if(_ instanceof Ln&&!_.image.loaded)return!1}return!0}getHash(){let rt="{";return rt+='"fragment":'+this.fragment.getHash(),rt+="}",rt}};Object.defineProperties(Zt.prototype,{properties:{get:function(){return this.fragment.properties}}});var zn=class extends Gn{constructor(rt,_,ut){super(rt,_,!1),this.uuid=ut,this.allowVariableSaves=!0,this.saveVariableLocations(_)}},G0=Rt(B0()),R0=new Map;function V0(rt){if(typeof rt=="string")return rt;let _=R0.get(rt);return _||(_={url:URL.createObjectURL(new Blob([rt]))},R0.set(rt,_)),_.url}var kn=class{constructor({src:rt,volume:_,delay:ut,loop:mt}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let bt;typeof rt=="string"?bt={src:rt}:bt={src:V0(rt),format:"wav"},this.sound=new G0.Howl(bt),this.sound.on("end",this.onEnd),this.src=rt,_!==void 0&&(this.volume=_),ut!==void 0&&(this.delay=ut),mt!==void 0&&(this.loop=mt)}get status(){return this._status}get volume(){return this._volume}set volume(rt){this._volume=rt,this.sound.volume(rt)}get loop(){return this._loop}set loop(rt){this._loop=rt,this.loopsRemaining=rt}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(rt,_=1e3){rt?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,_),this.clearFade()},rt)):this.sound.fade(this._volume,0,_)}on(rt,_,ut){this.sound.on(rt,_,ut)}off(rt,_,ut){this.sound.off(rt,_,ut)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(rt=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},Uc=class{constructor(){this.type="ShapePath",this.color=new Color$1,this.subPaths=[],this.currentPath=null}moveTo(rt,_){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(rt,_),this}lineTo(rt,_){var ut;return(ut=this.currentPath)==null||ut.lineTo(rt,_),this}quadraticCurveTo(rt,_,ut,mt){var bt;return(bt=this.currentPath)==null||bt.quadraticCurveTo(rt,_,ut,mt),this}bezierCurveTo(rt,_,ut,mt,bt,St){var Mt;return(Mt=this.currentPath)==null||Mt.bezierCurveTo(rt,_,ut,mt,bt,St),this}splineThru(rt){var _;return(_=this.currentPath)==null||_.splineThru(rt),this}toShapes(){let rt={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},_={loc:rt.ORIGIN,t:0};function ut(ar,cr,Ar,_r){let Dr=ar.x,$r=cr.x,Br=Ar.x,Jr=_r.x,mn=ar.y,Mn=cr.y,$n=Ar.y,en=_r.y,In=(Jr-Br)*(mn-$n)-(en-$n)*(Dr-Br),Rn=($r-Dr)*(mn-$n)-(Mn-mn)*(Dr-Br),qn=(en-$n)*($r-Dr)-(Jr-Br)*(Mn-mn),Qn=In/qn,xs=Rn/qn;if(qn===0&&In!==0||Qn<=0||Qn>=1||xs<0||xs>1)return null;if(In===0&&qn===0){for(let cs=0;cs<2;cs++)if(mt(cs===0?Ar:_r,ar,cr),_.loc===rt.ORIGIN){let ks=cs===0?Ar:_r;return{x:ks.x,y:ks.y,t:_.t}}else if(_.loc===rt.BETWEEN){let ks=+(Dr+_.t*($r-Dr)).toPrecision(10),_o=+(mn+_.t*(Mn-mn)).toPrecision(10);return{x:ks,y:_o,t:_.t}}return null}else{for(let _o=0;_o<2;_o++)if(mt(_o===0?Ar:_r,ar,cr),_.loc===rt.ORIGIN){let qs=_o===0?Ar:_r;return{x:qs.x,y:qs.y,t:_.t}}let cs=+(Dr+Qn*($r-Dr)).toPrecision(10),ks=+(mn+Qn*(Mn-mn)).toPrecision(10);return{x:cs,y:ks,t:Qn}}}function mt(ar,cr,Ar){let _r=Ar.x-cr.x,Dr=Ar.y-cr.y,$r=ar.x-cr.x,Br=ar.y-cr.y,Jr=_r*Br-$r*Dr;if(ar.x===cr.x&&ar.y===cr.y){_.loc=rt.ORIGIN,_.t=0;return}if(ar.x===Ar.x&&ar.y===Ar.y){_.loc=rt.DESTINATION,_.t=1;return}if(Jr<-Number.EPSILON){_.loc=rt.LEFT;return}if(Jr>Number.EPSILON){_.loc=rt.RIGHT;return}if(_r*$r<0||Dr*Br<0){_.loc=rt.BEHIND;return}if(Math.sqrt(_r*_r+Dr*Dr)<Math.sqrt($r*$r+Br*Br)){_.loc=rt.BEYOND;return}let mn;_r!==0?mn=$r/_r:mn=Br/Dr,_.loc=rt.BETWEEN,_.t=mn}function bt(ar,cr){let Ar=[],_r=[];for(let Dr=1;Dr<ar.length;Dr++){let $r=ar[Dr-1],Br=ar[Dr];for(let Jr=1;Jr<cr.length;Jr++){let mn=cr[Jr-1],Mn=cr[Jr],$n=ut($r,Br,mn,Mn);$n!==null&&Ar.find(en=>en.t<=$n.t+Number.EPSILON&&en.t>=$n.t-Number.EPSILON)===void 0&&(Ar.push($n),_r.push(new Vector2($n.x,$n.y)))}}return _r}function St(ar,cr,Ar){let _r=new Vector2;cr.getCenter(_r);let Dr=[];return Ar.forEach($r=>{$r.boundingBox.containsPoint(_r)&&bt(ar,$r.points).forEach(Br=>{Dr.push({identifier:$r.identifier,isCW:$r.isCW,point:Br})})}),Dr.sort(($r,Br)=>$r.point.x-Br.point.x),Dr}function Mt(ar,cr,Ar,_r,Dr){(Dr==null||Dr==="")&&(Dr="nonzero");let $r=new Vector2;ar.boundingBox.getCenter($r);let Br=[new Vector2(Ar,$r.y),new Vector2(_r,$r.y)],Jr=St(Br,ar.boundingBox,cr);Jr.sort((Rn,qn)=>Rn.point.x-qn.point.x);let mn=[],Mn=[];Jr.forEach(Rn=>{Rn.identifier===ar.identifier?mn.push(Rn):Mn.push(Rn)});let $n=mn[0].point.x,en=[],In=0;for(;In<Mn.length&&Mn[In].point.x<$n;)en.length>0&&en[en.length-1]===Mn[In].identifier?en.pop():en.push(Mn[In].identifier),In++;if(en.push(ar.identifier),Dr==="evenodd"){let Rn=en.length%2===0,qn=en[en.length-2];return{identifier:ar.identifier,isHole:Rn,for:qn}}else if(Dr==="nonzero"){let Rn=!0,qn=null,Qn=null;for(let xs=0;xs<en.length;xs++){let cs=en[xs];cr[cs]&&(Rn?(Qn=cr[cs].isCW,Rn=!1,qn=cs):Qn!==cr[cs].isCW&&(Qn=cr[cs].isCW,Rn=!0))}return{identifier:ar.identifier,isHole:Rn,for:qn}}else console.warn('fill-rule: "'+Dr+'" is currently not implemented.')}let Bt=0,Ut=999999999,Ht=-999999999,tr=[];this.subPaths.forEach(ar=>{let cr=ar.getPoints(),Ar=-999999999,_r=999999999,Dr=-999999999,$r=999999999;for(let Br=0;Br<cr.length;Br++){let Jr=cr[Br];Jr.y>Ar&&(Ar=Jr.y),Jr.y<_r&&(_r=Jr.y),Jr.x>Dr&&(Dr=Jr.x),Jr.x<$r&&($r=Jr.x)}Ht<=Dr&&(Ht=Dr+1),Ut>=$r&&(Ut=$r-1),cr.length&&tr.push({curves:ar.curves,points:cr,isCW:ShapeUtils.isClockWise(cr),identifier:Bt++,boundingBox:new Box2(new Vector2($r,_r),new Vector2(Dr,Ar))})});let rr=tr.map(ar=>{var cr;return Mt(ar,tr,Ut,Ht,(cr=this.userData)==null?void 0:cr.style.fillRule)}),sr=[];return tr.forEach(ar=>{let cr=rr[ar.identifier];if(cr&&!cr.isHole){let Ar=new Shape;Ar.curves=ar.curves,rr.filter(_r=>(_r==null?void 0:_r.isHole)&&_r.for===ar.identifier).forEach(_r=>{if(_r){let Dr=tr[_r.identifier],$r=new Path;$r.curves=Dr.curves,Ar.holes.push($r)}}),sr.push(Ar)}}),sr}},F0,wp=new Promise(rt=>{F0=rt}),k0=!1,Hc;function j0(){if(k0)return;if(Hc)return Hc;async function rt(){let _=await __vitePreload(()=>import("./opentype-D6jUvuOk.js"),[]);F0(_),k0=!0}return Hc=rt(),Hc}var Es=class{async load(rt,_,ut=()=>{}){let{load:mt}=await wp;mt(rt,(bt,St)=>{bt||!St?ut(bt??"Something went wrong"):_(St)})}async parse(rt){let{parse:_,Bidi:ut}=await wp;try{let mt=_(rt),bt=new ut,St=Mt=>mt.charToGlyphIndex(Mt.char);return bt.registerModifier("glyphIndex",null,St),bt.applyFeatures(mt,mt.defaultRenderOptions.features),{font:mt,bidi:bt}}catch(mt){console.error(mt)}}};async function LO(rt){return await(await fetch(rt)).arrayBuffer()}var BO=new Es;async function _p(rt){let _,ut,mt=!1;if(rt.url?(_=await LO(rt.url),ut=rt.url,mt=rt.url.startsWith("/")):rt.data&&(_=rt.data.buffer.slice(rt.data.byteOffset,rt.data.byteOffset+rt.data.byteLength)),_){let bt=await BO.parse(_);if(bt)return{font:bt.font,url:ut,intercepted:mt,arr:_,bidi:bt.bidi}}}function zO(rt,_){return _.state.glyphIndex===rt||_.state.fina===rt||_.state.medi===rt||_.state.init===rt}var qc=class{constructor(rt){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=rt.isUserFont??!1,this._loadingPromise=_p(rt).then(_=>{_&&(this._arrayBuffer=_.arr,this._url=_.url,this.font=_.font,this._intercepted=_.intercepted,this._isLoaded=!0,this._bidi=_.bidi)})}update(rt){this._isLoaded=!1,this._isUserFont=rt.isUserFont??!1,this._loadingPromise=_p(rt).then(_=>{_&&(this._arrayBuffer=_.arr,this._url=_.url,this.font=_.font,this._intercepted=_.intercepted,this._isLoaded=!0,this._bidi=_.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(rt,_,ut){if(!this._bidi)return[];let mt=this._bidi;mt.getTextGlyphs(_);let bt=mt.tokenizer.tokens,St=[],Mt=0,Bt=ut.length===bt.length;for(let Ut=0;Ut<ut.length;Ut++){let Ht=ut[Ut].index,tr=String.fromCharCode(ut[Ut].unicode),rr=bt[Mt];if(zO(Ht,rr)||Bt)St.push({char:tr,index:Ht,replacements:[rr.state.glyphIndex],replacementChars:[rr.char]}),Mt++;else{let sr=rr.char,ar="",cr=[rr.state.glyphIndex],Ar=[],_r=!1;for(;!_r;)Mt++,ar=_.charAt(Mt),sr+=ar,cr.push(rt.charToGlyphIndex(ar)),Ar=rt.stringToGlyphs(sr),Ar.length===1&&Ar[0].index===Ht&&(_r=!0),Mt>_.length&&(_r=!0);St.push({char:tr,index:Ht,replacements:cr,replacementChars:Array.from(sr)}),Mt++}}return St}generateShapes(rt,_){if(!this._isLoaded)return;let ut=this.font,mt=_.fontSize/this.unitsPerEm,bt=_.fontSize*_.lineHeight,St=rt.map(Dr=>this.getTextWidth(Dr,_)),Mt=_.width,Bt=this.getCharWidth(`
`,_),Ut=_.horizontalAlign===1?Bt:0,Ht=this.computeSpaceWidthForLine(rt,0,_),tr=this.getLineInitialOffsetX(St[0],Mt,_.horizontalAlign,rt[0],Bt),rr=this.getLineInitialOffsetY(bt,rt.length,_.height,mt,_.verticalAlign),sr=[],ar=rt.map(Dr=>[]),cr=rt.map(Dr=>[]),Ar;for(let Dr=0;Dr<rt.length;Dr++){let $r=rt[Dr],Br={features:{liga:!0}},Jr=[];try{Jr=ut.stringToGlyphs($r,Br)}catch(Mn){console.warn(Mn)}tr=this.getLineInitialOffsetX(St[Dr],Mt,_.horizontalAlign,$r,Bt);let mn=[];try{mn=this.reverseLigaturesTable(ut,$r,Jr)}catch(Mn){console.warn(Mn)}Ht=this.computeSpaceWidthForLine(rt,Dr,_);for(let Mn=0;Mn<Jr.length;Mn++){let $n=Jr[Mn],en=$n.index===0?`
`:$n.unicode?String.fromCharCode($n.unicode):void 0,In=mn[Mn],Rn=0,qn=0;Mn===0&&_.horizontalAlign===2&&$n.leftSideBearing!==void 0&&(qn=-$n.leftSideBearing*mt),Ar&&(Rn=ut.getKerningValue($n,Ar)*mt),tr+=qn+Rn;let Qn=0;if(en===`
`)Qn=Ut;else if(en===" ")Qn=Ht;else{let xs=this.createPath($n,mt,tr,rr,_);xs&&(Qn=xs.offsetX-(Rn+qn),sr.push(xs.path))}if(In.replacements.length===1)cr[Dr].push([tr,rr]),ar[Dr].push(Qn);else{let xs=In.replacements.map(qs=>(ut.glyphs.get(qs).advanceWidth??0)*mt),cs=xs.reduce((qs,Ss)=>qs+=Ss,0),ks=xs.map(qs=>qs/cs),_o=tr;for(let qs=0;qs<ks.length;qs++){let Ss=Qn*ks[qs];cr[Dr].push([_o,rr]),ar[Dr].push(Ss),_o+=Ss}}tr+=Qn,Ar=$n}rr-=bt}let _r=[];for(let Dr=0,$r=sr.length;Dr<$r;Dr++)_r.push(...sr[Dr].toShapes());return{shapes:_r,charWidths:ar,lineWidths:St,charCoords:cr}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var rt;return((rt=this.font)==null?void 0:rt.ascender)??0}get descender(){var rt;return((rt=this.font)==null?void 0:rt.descender)??0}get familyName(){var rt;return((rt=this.font)==null?void 0:rt.names.fontFamily)??""}get subfamilyName(){var rt;return((rt=this.font)==null?void 0:rt.names.fontSubfamily)??""}get unitsPerEm(){var rt;return((rt=this.font)==null?void 0:rt.unitsPerEm)??1}getLineInitialOffsetX(rt,_,ut,mt,bt){return(ut===3||ut===2)&&mt.indexOf(`
`)>=0&&(rt-=bt),ut===3?_*.5-rt*.5:ut===2?_-rt:0}getLineInitialOffsetY(rt,_,ut,mt,bt){let St=_*rt,Mt=Math.abs(this.ascender-this.descender)*mt,Bt=rt-Mt,Ut=-this.ascender*mt-Bt/2;return bt===3?-(ut-St-Ut):bt===2?-(ut*.5-St*.5-Ut):Ut}createPath(rt,_,ut,mt,bt){var Ut;let St=rt.getPath(ut,-mt,bt.fontSize,{kerning:!1,letterSpacing:bt.letterSpacing});if(!St){console.error('THREE.Font: character "'+rt+'" does not exists in font family '+this.familyName+".");return}let Mt=new Uc,Bt=(rt.advanceWidth??1)*_;if(rt)for(let Ht of St.commands){let tr=(Ut=Mt.currentPath)==null?void 0:Ut.currentPoint;if(!(tr&&Ht.type!=="Z"&&tr.x===Ht.x&&-tr.y===Ht.y))switch(Ht.type){case"M":Mt.moveTo(Ht.x,-Ht.y);break;case"L":Mt.lineTo(Ht.x,-Ht.y);break;case"Q":Mt.quadraticCurveTo(Ht.x1,-Ht.y1,Ht.x,-Ht.y);break;case"C":Mt.bezierCurveTo(Ht.x1,-Ht.y1,Ht.x2,-Ht.y2,Ht.x,-Ht.y);break}}return Mt.subPaths.forEach(Ht=>{let tr=kO(Ht.curves);tr!==void 0&&Ht.currentPoint.distanceTo(tr)>0&&Ht.lineTo(tr.x,tr.y)}),{offsetX:Bt+bt.fontSize*bt.letterSpacing,path:Mt}}getCharWidth(rt,_){var ut;return((ut=this.font)==null?void 0:ut.getAdvanceWidth(rt,_.fontSize,{kerning:!0,letterSpacing:_.letterSpacing}))??0}getTextWidth(rt,_){var ut;return((ut=this.font)==null?void 0:ut.getAdvanceWidth(rt,_.fontSize,{kerning:!0,letterSpacing:_.letterSpacing}))??0}computeSpaceWidthForLine(rt,_,ut){let mt=this.getCharWidth(" ",ut),bt=rt[_];if(bt){let St=this.countSpaces(bt.trimEnd());if(ut.horizontalAlign===4&&_<rt.length-1&&St){let Mt=ut.width,Bt=this.getTextWidth(bt,ut);return(Mt-(Bt-St*mt))/St}}return mt}countSpaces(rt){return(rt.match(/ /g)||[]).length}};function kO(rt){if(rt.length){let _=rt[0];if(_ instanceof LineCurve)return _.v1;if(_ instanceof CubicBezierCurve||_ instanceof QuadraticBezierCurve)return _.v0}}var Ap=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(rt){return this.objects.get(rt)}get size(){return this.objects.size}get(rt,_,ut){let mt=this.objects.get(rt);return mt===void 0?(mt=this.createObject(rt,_,ut),this.objects.set(rt,mt)):mt.isShared=!0,mt}forceDelete(rt){let _=this.objects.get(rt);_&&(this.disposeObject(_),this.objects.delete(rt))}mutateIfUnique(rt,_){let ut=this.objects.get(rt);if(ut&&ut.isShared!==!0)return this.objects.delete(rt),this.objects.set(_,ut),ut}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(rt,_){let ut=this.objects.get(rt);_===ut&&this.unreachable.delete(rt)}endGc(){this.unreachable.forEach(rt=>{this.disposeObject(this.objects.get(rt)),this.objects.delete(rt)}),this.unreachable.clear()}dispose(){this.objects.forEach(rt=>{this.disposeObject(rt)}),this.objects.clear()}},Ds=class extends Ap{constructor(rt){super(),this.flatShading=rt}disposeObject(rt){rt.dispose()}createObject(rt,_,ut){let mt=Nn(rt,_,this.flatShading,ut);return mt.computeBoundingSphere(),mt}},U0={markNeedsUpdateRendererDirty:()=>{}},Tp=class extends Gc{constructor(rt){super(),this.shared=rt}create(rt){return new Ca(rt,this.shared)}},jn=class{constructor(rt,_={}){if(this.data=rt,this.geometryCache=new Ds(!0),this.geometryCache2=new Ds(!1),this.imageHolderCache=new Tp(this),this.thisContext={scene:U0,shared:this},this.deletedMaterial=new zn(Pt.defaultTwoLayerData("phong"),this.thisContext,""),this.deletedImage=new fr(Ri.emptyImage,this),this.deletedVideo=new fr(Pi.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.variables={},this.mouseProperty=null,this.raycastProperty=null,this.requestRender=()=>{this._requestRender&&this._requestRender()},_.images)for(let[ut,mt]of Object.entries(_.images))this.addImage(ut,mt);if(_.videos)for(let[ut,mt]of Object.entries(_.videos))this.addVideo(ut,mt);if(_.audios)for(let[ut,mt]of Object.entries(_.audios))this.addAudio(ut,mt);this.reset(rt)}setRequestRender(rt){this._requestRender=rt}setEntityOpContext(rt){this.entityOpContext=rt}reset(rt,_=!1){this.resetLib(rt.lib);for(let{id:ut,data:mt}of rt.variables)this.addVariableHolder(ut,mt),_&&this.updateVariableHolder(ut,mt);for(let[ut,mt]of Object.entries(rt.images))this.addImage(ut,mt);for(let[ut,mt]of Object.entries(rt.videos))this.addVideo(ut,mt);for(let[ut,mt]of Object.entries(rt.colors))this.addColor(ut,mt);for(let[ut,mt]of Object.entries(rt.materials))this.addMaterial(ut,mt);for(let[ut,mt]of Object.entries(rt.audios))this.addAudio(ut,mt);for(let[ut,mt]of Object.entries(rt.fonts))this.addFont(ut,mt)}addMaterial(rt,_){if(this.materials[rt]){let ut=this.materials[rt];ut.reset(_,this.thisContext),ut.dispose()}else{let ut=new zn(_,this.thisContext,rt);this.materials[rt]=ut}}deleteMaterial(rt){this.materials[rt]&&(this.materials[rt].nodeMaterialDispose(),delete this.materials[rt])}getMaterial(rt){return this.materials[rt]}getMaterialOrDeletedPlaceholder(rt){return this.materials[rt]??this.deletedMaterial}material(rt){return typeof rt=="string"?this.getMaterialOrDeletedPlaceholder(rt):rt==null?(console.error("material is undefined or null"),this.deletedMaterial):new Gn(rt,this.thisContext)}getMaterials(){return this.materials}addImage(rt,_){return this.images[rt]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[rt].updateSrc(_.data),!0):(this.images[rt]=new fr(_,this),!1)}deleteImage(rt){let _=this.images[rt];_&&(_.dispose(),delete this.images[rt])}getDefaultImage(){return this.images.image_0}getImage(rt){return this.images[rt]??this.deletedImage}image(rt){return typeof rt=="string"?this.getImage(rt):this.imageHolderCache.load(rt)}addVideo(rt,_){return this.videos[rt]?(this.videos[rt].updateSrc(_.data),!0):(this.videos[rt]=new fr(_,this),!1)}deleteVideo(rt){let _=this.videos[rt];_&&(_.dispose(),delete this.videos[rt])}getVideo(rt){return this.videos[rt]??this.deletedVideo}video(rt){return typeof rt=="string"?this.getVideo(rt):this.imageHolderCache.load(rt)}addColor(rt,_){return this.colors[rt]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in _?this.colors[rt].setRGBA(_.r,_.g,_.b,_.a):this.colors[rt].setRGBA(_.r,_.g,_.b,1),!0):("a"in _?this.colors[rt]=new an(_.r,_.g,_.b,_.a):this.colors[rt]=new an(_.r,_.g,_.b,1),!1)}updateColor(rt,_){if(this.colors[rt]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let ut=this.colors[rt];return this.colors[rt].r=_.r??ut.r,this.colors[rt].g=_.g??ut.g,this.colors[rt].b=_.b??ut.b,this.colors[rt].a=_.a??ut.a,!0}return!1}deleteColor(rt){this.colors[rt]&&delete this.colors[rt]}getColor(rt){return this.colors[rt]}color(rt){let _;if(typeof rt=="string"){let ut=this.getColor(rt);ut?_=ut:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),_=new ht(0,0,0,0))}else return"a"in rt?new ht(rt.r,rt.g,rt.b,rt.a):new ht(rt.r,rt.g,rt.b,1);return _}addAudio(rt,_){this.audios[rt]=_}getAudio(rt){let _=this.audios[rt];if(_ instanceof kn)return _;{let ut=new kn({src:_.data});return this.audios[rt]=ut,ut}}deleteAudio(rt){let _=this.audios[rt];_&&(_ instanceof kn&&_.dispose(),delete this.audios[rt])}addFont(rt,_){this.fonts[rt]=new qc(_),this.fonts[rt].loadingPromise.then(()=>this.requestRender())}getFont(rt){return this.fonts[rt]}deleteFont(rt){this.fonts[rt]&&delete this.fonts[rt]}dispose(){Object.keys(this.materials).forEach(rt=>this.deleteMaterial(rt)),this._requestRender=void 0,Object.values(this.audios).forEach(rt=>{rt instanceof kn&&rt.dispose()}),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}addVariableHolder(rt,_){return this.variables[rt]===void 0?(this.variables[rt]={value:_.value,locations:[]},"dynamicVariableType"in _&&(this.variables[rt].dynamicVariablePlayState="Playing",this.variables[rt].dynamicVariableToggleIsForward=void 0),!0):(this.variables[rt].value=_.value,!1)}resetDynamicVariablePlayState(){for(let rt in this.variables)this.variables[rt].dynamicVariablePlayState!==void 0&&(this.variables[rt].dynamicVariablePlayState="Playing",this.variables[rt].dynamicVariableToggleIsForward=void 0)}updateVariableHolder(rt,_){this.updateVariable(rt,_.value)}updateVariable(rt,_){if(this.variables[rt]===void 0)return!1;this.variables[rt].value=_;let ut=_;for(;typeof ut=="string";)ut=this.variables[ut].value;let mt=this.entityOpContext.scene;for(let bt=this.variables[rt].locations.length-1;bt>=0;bt--){let St=this.variables[rt].locations[bt];if(St[0]==="material"){let Mt=St[1],Bt=ut,Ut={scene:mt,shared:this},Ht=St.slice(2);mt.traverseMaterial(rr=>{let sr=rr.root??rr;sr.uuid===Mt&&sr.onVariableUpdate(Ht,Bt,Ut)});let tr=this.materials[Mt];tr&&tr.onVariableUpdate(Ht,Bt,Ut)}else{let Mt=mt.find(St[0]);if(Mt===void 0){this.variables[rt].locations.splice(bt,1);continue}if(St[1]!=="geometry"){for(let Bt=1;Bt<St.length-1;Bt++)Mt=Mt[St[Bt]];St[1]==="rotation"?Mt[St[St.length-1]]=ut*MathUtils.DEG2RAD:Mt[St[St.length-1]]=ut}if(Mt=mt.find(St[0]),Ae.is(Mt)){if(St[1]==="position"||St[1]==="rotation"||St[1]==="scale")Mt.onVariableUpdate();else if(St[1]==="geometry"){let Bt=Mt;Mt.component&&(Bt=Mt.component);let Ut=Bt.dataPatched;Bt.chooseGeoemtryCache(this).forceDelete(Ut.geometry),Bt.createGeometryDelayed(this.entityOpContext),Bt.onVariableUpdate(!0),Bt.instances.forEach(Ht=>{let tr=Ht.dataPatched;Ht.chooseGeoemtryCache(this).forceDelete(tr.geometry),Ht.createGeometryDelayed(this.entityOpContext),Ht.onVariableUpdate(!0)})}}}}return!0}deleteVariable(rt){this.variables[rt]&&delete this.variables[rt]}getVariable(rt,_){var ut,mt,bt;if(Array.isArray(rt)){if(rt[0]==="mouse")return((ut=this.mouseProperty)==null?void 0:ut[rt[1]])??0;if(rt[0]==="raycast")return((mt=this.raycastProperty)==null?void 0:mt[rt[1]])??0;let St=this.entityOpContext.scene.find(rt[0]);if(rt[1]==="width"||rt[1]==="height"||rt[1]==="depth")return St.geometry.userData.parameters[rt[1]];for(let Mt=1;Mt<rt.length;Mt++)St=St[rt[Mt]];return rt[1]==="rotation"&&(St*=MathUtils.RAD2DEG),St}for(let St in this.variables){if(_===void 0)break;let Mt=this.variables[St],Bt=(bt=Mt.locations)==null?void 0:bt.findIndex(Ut=>ot.equal(Ut,_));Bt!==void 0&&Bt!==-1&&Mt.locations.splice(Bt,1)}if(typeof rt=="string"){let St=rt,Mt=rt;do{if(Mt=St,this.variables[St]===void 0)break;St=this.variables[St].value}while(typeof St=="string");return _&&this.variables[Mt]!==void 0&&this.variables[Mt].locations.push(_),St}else return rt}getVariables(){return this.variables}getDynamicVariablePlayState(rt){var _;return(_=this.variables[rt])==null?void 0:_.dynamicVariablePlayState}setDynamicVariablePlayState(rt,_){this.variables[rt]!==void 0&&(this.variables[rt].dynamicVariablePlayState=_)}getDynamicVariableToggleIsForward(rt){var _;return(_=this.variables[rt])==null?void 0:_.dynamicVariableToggleIsForward}setDynamicVariableToggleIsForward(rt,_){this.variables[rt]!==void 0&&(this.variables[rt].dynamicVariableToggleIsForward=_)}resetLib(rt){for(let[_,ut]of Object.entries(rt.images))this.addImage(_,ut.asset);for(let[_,ut]of Object.entries(rt.audios))this.addAudio(_,ut.asset);for(let[_,ut]of Object.entries(rt.colors))this.addColor(_,ut.asset);for(let[_,ut]of Object.entries(rt.fonts))this.addFont(_,ut.asset);for(let[_,ut]of Object.entries(rt.materials))this.addMaterial(_,ut.asset);for(let[_,ut]of Object.entries(rt.videos))this.addVideo(_,ut.asset);for(let[_,ut]of Object.entries(rt.variables))this.addVariableHolder(_,ut.asset)}updateLibByOp(rt,_){rt.path[0]==="images"?rt.path.length===1&&rt.type===1?this.addImage(rt.id,rt.data.asset):rt.path.length===1&&rt.type===2&&this.deleteImage(rt.id):rt.path[0]==="videos"?rt.path.length===1&&rt.type===1?this.addVideo(rt.id,rt.data.asset):rt.path.length===1&&rt.type===2&&this.deleteVideo(rt.id):rt.path[0]==="audios"?rt.path.length===1&&rt.type===1?this.addAudio(rt.id,rt.data.asset):rt.path.length===1&&rt.type===2&&this.deleteAudio(rt.id):rt.path[0]==="colors"?rt.path.length===1&&rt.type===1?this.addColor(rt.id,rt.data.asset):rt.path.length===1&&rt.type===2&&this.deleteColor(rt.id):rt.path[0]==="materials"?rt.path.length===1&&rt.type===1?this.addMaterial(rt.id,rt.data.asset):rt.path.length===1&&rt.type===2&&this.deleteMaterial(rt.id):rt.path[0]==="fonts"?rt.path.length===1&&rt.type===1?this.addFont(rt.id,rt.data.asset):rt.path.length===1&&rt.type===2&&this.deleteFont(rt.id):rt.path[0]==="variables"?rt.path.length===1&&rt.type===1?this.addVariableHolder(rt.id,rt.data.asset):rt.path.length===1&&rt.type===2&&this.deleteVariable(rt.id):rt.path[0]==="components"&&_.updateByLibOp(rt,this)}updateByOp(rt,_,ut){this.data=_,rt.path[0]==="images"?rt.path.length===2&&rt.type===0?rt.props.data&&this.getImage(rt.path[1]).updateSrc(rt.props.data):rt.path.length===1&&rt.type===1?this.addImage(rt.id,rt.data):rt.path.length===1&&rt.type===2&&this.deleteImage(rt.id):rt.path[0]==="videos"?rt.path.length===2&&rt.type===0?rt.props.data&&this.getVideo(rt.path[1]).updateSrc(rt.props.data):rt.path.length===1&&rt.type===1?this.addVideo(rt.id,rt.data):rt.path.length===1&&rt.type===2&&this.deleteVideo(rt.id):rt.path[0]==="audios"?rt.path.length===2&&rt.type===0?rt.props.data&&this.addAudio(rt.path[1],_.audios[rt.path[1]]):rt.path.length===1&&rt.type===1?this.addAudio(rt.id,rt.data):rt.path.length===1&&rt.type===2&&this.deleteAudio(rt.id):rt.path[0]==="colors"?rt.path.length===2&&rt.type===0?this.updateColor(rt.path[1],rt.props):rt.path.length===1&&rt.type===1?this.addColor(rt.id,rt.data):rt.path.length===1&&rt.type===2&&this.deleteColor(rt.id):rt.path[0]==="materials"?rt.path.length===1&&rt.type===1?this.addMaterial(rt.id,rt.data):rt.path.length===1&&rt.type===2?this.deleteMaterial(rt.id):rt.path.length>1&&this.getMaterial(rt.path[1]).updateByOp(nt.drop(rt,2),_.materials[rt.path[1]],{shared:this,scene:ut}):rt.path[0]==="fonts"?rt.path.length===2&&rt.type===0?this.updateFont(rt.path[1],rt,ut):rt.path.length===1&&rt.type===1?this.addFont(rt.id,rt.data):rt.path.length===1&&rt.type===2&&this.deleteFont(rt.id):rt.path[0]==="variables"?rt.path.length===2&&rt.type===0&&"value"in rt.props?this.updateVariable(rt.path[1],rt.props.value):rt.path.length===1&&rt.type===4?this.addVariableHolder(rt.id,rt.data):rt.path.length===1&&rt.type===5&&this.deleteVariable(rt.id):rt.path[0]==="lib"&&this.updateLibByOp(nt.drop(rt,1),ut)}updateFont(rt,_,ut){if(_.props.url){let mt=this.getFont(rt),bt={...this.data.fonts[rt],url:_.props.url};mt.update(bt),mt.loadingPromise.then(()=>this.requestRender()),ut.updateFont(rt,this)}}},q0=new jn(br.emptyData()),Jt=class extends It{updateByPatchedOp(rt,_,ut){if(super.updateByPatchedOp(rt,_,ut),Lm(rt.path,["materials"])!==null&&rt.type===0&&Array.isArray(this.material))for(let[mt,bt]of Object.entries(rt.props)){let St=ut.shared.material(bt);this.material[Number(mt)]=St}else if(Lt(rt.path,["material"])&&this.material instanceof Zt)"material"in _&&typeof _.material!="string"&&this.material.updateByOp(nt.drop(rt,1),_.material,ut);else if(Lt(rt.path,["materials","*"])&&Array.isArray(this.material)){let mt=rt.path[1];if("materials"in _&&mt<this.material.length){let bt=_.materials[mt];typeof bt!="string"&&this.material[mt].updateByOp(nt.drop(rt,2),bt,ut)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(rt,_){var mt,bt;super.updateState(rt,_),rt.castShadow!==void 0&&(this.castShadow=rt.castShadow),rt.receiveShadow!==void 0&&(this.receiveShadow=rt.receiveShadow);let ut=this.dataPatched;if(((mt=rt.geometry)==null?void 0:mt.type)!=="NonParametricGeometry"&&"material"in rt&&rt.material!==void 0&&(this.disposeMaterial(),this.material=_.shared.material(rt.material).getFlavor(ut.flatShading,ut.side,ut.wireframe),_.scene.markNeedsUpdateRendererDirty()),((bt=rt.geometry)==null?void 0:bt.type)==="NonParametricGeometry"&&("materials"in rt&&rt.materials!==void 0?(this.disposeMaterial(),this.material=rt.materials.map(St=>_.shared.material(St).getFlavor(ut.flatShading,ut.side,ut.wireframe)),_.scene.markNeedsUpdateRendererDirty()):"material"in rt&&rt.material!==void 0&&(this.disposeMaterial(),this.material=[_.shared.material(rt.material).getFlavor(ut.flatShading,ut.side,ut.wireframe)],_.scene.markNeedsUpdateRendererDirty())),rt.flatShading!==void 0||rt.wireframe!==void 0||rt.side!==void 0)if(Array.isArray(this.material))for(let St=0;St<this.material.length;St++)this.material[St]=this.material[St].getFlavor(ut.flatShading,ut.side,ut.wireframe);else this.material=this.material.getFlavor(ut.flatShading,ut.side,ut.wireframe)}disposeMaterial(){this.material&&$s(this.material).forEach(rt=>{rt instanceof Zt&&(rt instanceof zn||rt.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},W0=new Vector3,$0=new Vector4,Y0=new Vector4,UO=new Vector3,X0=new Matrix4,st=class extends Jt{constructor(rt,_,ut){super(rt,_),this.data=_,this.isSkinnedMesh=!1,this.localGeometry=void 0,_.bindMode&&_.bindMatrix&&(this.bindMode=_.bindMode,this.bindMatrix=new Matrix4().fromArray(_.bindMatrix),this.bindMatrixInverse=new Matrix4)}chooseGeoemtryCache(rt){return rt.geometryCache}markGeometryAsReachable(rt){this.geometryCreateDeleyed instanceof BufferGeometry&&this.chooseGeoemtryCache(rt).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof jn){let rt=this.geometryCreateDeleyed,_=this.chooseGeoemtryCache(rt);this.geometryCreateDeleyed=_.get(this.dataPatched.geometry,rt,this)}return this.geometryCreateDeleyed}set geometry(rt){this.localGeometry=rt}get is2DAndNoDepth(){let rt=this.dataPatched.geometry;return rs.is2DParametricMesh(rt.type)&&rt.depth===0}get is2DType(){return rs.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(rt,_,ut){super.updateByPatchedOp(rt,_,ut),Lt(rt.path,["geometry"])&&this.updateByPatchedOpGeometry(nt.drop(rt,1),_.geometry,ut)}removeInteractionGeometry(){var rt;(rt=this.localGeometry)==null||rt.dispose(),this.localGeometry=void 0}updateGeometryInteractions(rt,_){var mt;this.invalidateDownstreamBooleanData();let ut=this.data.geometry.type;if(ut==="NonParametricGeometry"||ut==="SubdivGeometry"){let bt=rt;if(this.localGeometry===void 0){let Ht={...this.data.geometry,...bt};this.localGeometry=Nn(Ht,_,this.data.flatShading,this)}let St,Mt,Bt;bt.scaleBaked?[St,Mt,Bt]=bt.scaleBaked:{width:St,height:Mt,depth:Bt}=bt;let Ut=this.localGeometry.userData;Ut.sxPrev!==void 0&&bs(this.localGeometry.attributes,St/Ut.sxPrev,Mt/Ut.syPrev,Bt/Ut.szPrev),Ut.sxPrev=St,Ut.syPrev=Mt,Ut.szPrev=Bt}else{let bt={...this.data.geometry,...rt};(mt=this.localGeometry)==null||mt.dispose(),this.localGeometry=Nn(bt,_,this.data.flatShading,this)}}refreshAttachedCloners(rt){for(let _ of this.attachedSurfaceCloners)rt.scene.addPendingUpdateCloner(_.object)}refreshAttachedPaths(rt){for(let _ of this.attachedPaths)rt.scene.addPendingCommand(()=>_.updateShape())}createGeometryDelayed(rt){this.geometryCreateDeleyed=rt.shared,this.refreshAttachedCloners(rt),this.refreshAttachedPaths(rt)}updateByPatchedOpGeometry(rt,_,ut){var bt;let mt=!1;rt.type===0&&rt.path.length===0&&Object.keys(rt.props).includes("scaleBaked")&&this.geometryCreateDeleyed instanceof at&&this.chooseGeoemtryCache(ut.shared).mutateIfUnique(this.geometryCreateDeleyed.data,_)===this.geometryCreateDeleyed&&(mt=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(_,rt.props.scaleBaked),this.refreshAttachedCloners(ut),this.refreshAttachedPaths(ut)),mt||((bt=ut.scene)==null||bt.markGeometryCacheDirty(),this.createGeometryDelayed(ut)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(rt,_){this.createGeometryDelayed(_)}updateState(rt,_){rt.geometry!==void 0&&this.updateGeometryOnStateUpdate(rt.geometry,_),super.updateState(rt,_)}updateGeometryGroupsIfNeeded(){var rt;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((rt=this.geometry.getIndex())==null?void 0:rt.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(rt,_){let ut=this.geometry.userData.parameters;this.is2DType?rt.set(0,0,ut.depth*.5):this.isNonParametric?(rt.setScalar(0),this.geometry.boundingSphere&&rt.copy(this.geometry.boundingSphere.center),_.set(ut.width,ut.height,ut.depth??0).multiplyScalar(.5)):rt.setScalar(0),_.set(ut.width,ut.height,ut.depth??0).multiplyScalar(.5)}updateMatrixWorld(rt){super.updateMatrixWorld(rt),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(rt,_){this.skeleton=rt,this.isSkinnedMesh=!0,_===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),_=this.matrixWorld),this.bindMatrix.copy(_),this.bindMatrixInverse.copy(_).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(rt){let _=new Vector4,ut=this.geometry.attributes.skinWeight;for(let mt=0,bt=ut.count;mt<bt;mt++){_.fromBufferAttribute(ut,mt);let St=1/_.manhattanLength();St!==1/0?_.multiplyScalar(St):_.set(1,0,0,0),ut.setXYZW(mt,_.x,_.y,_.z,_.w)}}boneTransform(rt,_){let ut=this.skeleton;if(ut===void 0)return;let mt=this.geometry;$0.fromBufferAttribute(mt.attributes.skinIndex,rt),Y0.fromBufferAttribute(mt.attributes.skinWeight,rt),W0.copy(_).applyMatrix4(this.bindMatrix),_.set(0,0,0);for(let bt=0;bt<4;bt++){let St=Y0.getComponent(bt);if(St!==0){let Mt=$0.getComponent(bt);X0.multiplyMatrices(ut.bones[Mt].matrixWorld,ut.boneInverses[Mt]),_.addScaledVector(UO.copy(W0).applyMatrix4(X0),St)}}return _.applyMatrix4(this.bindMatrixInverse)}};function qO(rt){var Mt,Bt;if(rt.geometry.attributes.extrudeNormal||!rt.geometry.attributes.position||!rt.geometry.attributes.normal)return;let _=new Map,ut=rt.geometry.attributes,mt=ut.position.array,bt=ut.normal.array,St=new Float32Array(mt.length);for(let Ut=0;Ut<mt.length;Ut+=3){let Ht=`${mt[Ut]}_${mt[Ut+1]}_${mt[Ut+2]}`,tr=new Vector3(bt[Ut],bt[Ut+1],bt[Ut+2]);_.has(Ht)?(Mt=_.get(Ht))==null||Mt.normals.push(tr):_.set(Ht,{normals:[tr],result:new Vector3})}_.forEach((Ut,Ht)=>{for(let tr of Ut.normals)Ut.result.add(tr);Ut.result.divideScalar(Ut.normals.length)});for(let Ut=0;Ut<mt.length;Ut+=3){let Ht=`${mt[Ut]}_${mt[Ut+1]}_${mt[Ut+2]}`,tr=(Bt=_.get(Ht))==null?void 0:Bt.result;tr&&(St[Ut]=tr.x,St[Ut+1]=tr.y,St[Ut+2]=tr.z)}rt.geometry.setAttribute("extrudeNormal",new Float32BufferAttribute(St,3))}function WO(rt){if(rt.geometry.attributes.extrudeNormals||!rt.geometry.attributes.position)return;let _=rt.geometry.attributes.position.array,ut=new Float32Array(_.length),mt=new Vector3;for(let bt=0;bt<_.length;bt+=3)mt.set(_[bt],_[bt+1],_[bt+2]).normalize(),ut[bt]=mt.x,ut[bt+1]=mt.y,ut[bt+2]=mt.z;rt.geometry.setAttribute("extrudeNormal",new Float32BufferAttribute(ut,3))}function Oa(rt){if(Array.isArray(rt.material)){for(let _ of rt.material)if(_.getLayersOfType("outline").length===0)return}else if(!(rt.material instanceof Zt)||rt.material.getLayersOfType("outline").length===0)return;rt instanceof st&&rt.is2DAndNoDepth?WO(rt):qO(rt)}function Ma(rt){if(!rt.geometry.attributes.position)return;let _=rt.geometry.attributes.position.array,ut=new Float32Array(_.length),mt=parseInt(rt.uuid.replace(/\D/g,"")),bt=[MathUtils.seededRandom(mt),MathUtils.seededRandom(mt+1e4),MathUtils.seededRandom(mt+2e4)];for(let St=0;St<_.length;St++)ut[St]=bt[St%3];rt.geometry.setAttribute("randomColor",new BufferAttribute(ut,3))}ra.then(rt=>{});var ro=new Box3,Ls=new Vector3;function J0(rt){let _=!1;return rt.scene.objects.traverse((ut,mt)=>{mt.type==="Mesh"&&mt.geometry.type==="SubdivGeometry"&&(_=!0)}),_}var Un=class extends st{constructor(rt,_,ut){super(rt,_,ut),this.data=_,this.hiddenMatrixOld=new Matrix4,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(rt){return this.dataPatched.flatShading?rt.geometryCache:rt.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(rt,_){let ut=this.geometry.userData.parameters;rt.copy(this.originalGeometryNew.boundingSphere.center),_.set(ut.width,ut.height,ut.depth??0).multiplyScalar(.5)}createGeometryByControls(rt){var St,Mt,Bt;if(this.skipReactionUpdate===!0)return;let _=(St=this.localGeometry)==null?void 0:St.uuid,{originalGeometry:ut,subdividedGeometry:mt,subdivPointer:bt}=at.build(rt,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=bt,ut!==void 0&&((Mt=this.originalGeometry)==null||Mt.dispose(),this.originalGeometry=ut),mt!==void 0&&((Bt=this.subdividedGeometry)==null||Bt.dispose(),this.subdividedGeometry=mt??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,Oa(this),Ma(this),this.calcBoundingBox(),_&&(this.localGeometry.uuid=_)}updateState(rt,_){if(super.updateState(rt,_),rt.flatShading!==void 0){let ut=this.material;this.material=ut.getFlavor(!1,ut.side,ut.wireframe),this.smoothShading=!rt.flatShading,this.createGeometryDelayed(_)}}updateMesh(rt=!1){at.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,rt&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&at.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,rt&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=at.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=at.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(rt,_){let ut=this.localGeometry;this.localGeometry=this.originalGeometryNew,It.prototype.raycast.call(this,rt,_),this.localGeometry=ut}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let rt=this.originalGeometry;rt.boundingSphere===null&&(rt.boundingSphere=new Sphere$1,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=rt.boundingSphere));let _=rt.attributes.position,ut=rt.boundingSphere.center;ro.setFromBufferAttribute(_),ro.getCenter(ut),rt.boundingSphere.radius=ut.distanceTo(ro.max),isNaN(rt.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),ro.getSize(Ls),this.hasNonUniformScale&&Ls.divide(this.scale);let mt={width:Ls.x,height:Ls.y,depth:Ls.z};return this.geometry.userData.parameters=mt,mt}updateBoundingSphere(rt){let _=this.originalGeometry;ro.min.set(rt[0],rt[2],rt[4]),ro.max.set(rt[1],rt[3],rt[5]),this.hasNonUniformScale&&(ro.min.applyMatrix4(this.shearScaleInv),ro.max.applyMatrix4(this.shearScaleInv)),_.boundingSphere===null&&(_.boundingSphere=new Sphere$1);let ut=_.boundingSphere.center;ro.getCenter(ut),_.boundingSphere.radius=ut.distanceTo(ro.max)}freeSubdivPointer(){var rt,_;this.subdivPointer&&(at.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(rt=this.originalGeometry)==null||rt.dispose(),(_=this.subdividedGeometry)==null||_.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(rt,_,ut){super.updateByPatchedOpGeometry(rt,_,ut),this.localGeometry&&this.createGeometryByControls(_)}},ex=-1,ZO=1,tx={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},rx={polygon_center:0,edge:1,vertex:2},Bs=(rt,_)=>(ut,mt)=>!_||ut===0||rt===0?0:rt*mt/100,ve=(rt,_)=>{let ut=Math.abs(_),mt=ut*-1;return(rt-ex)*(ut-mt)/(ZO-ex)+mt};function ox(rt){let _=[],ut={};for(var mt=0,bt=rt.length;mt<bt;mt++){var St=JSON.stringify(rt[mt].pos.map(Mt=>Math.round(Mt*1e4)/1e4));ut[St]||(_.push(rt[mt]),ut[St]=!0)}return _}var JO=new Vector3,Wc=new Vector3,eM=new Vector3,tM=new Vector3;function Ia(rt,_){let ut=eM.fromArray(rt),mt=tM.fromArray(_);Wc.copy(mt).sub(ut);let bt=Wc.length();return Wc.normalize().multiplyScalar(bt*.5),JO.copy(ut).add(Wc).toArray()}var mr=new Triangle,$c=new Vector3,Yc=new Vector3,Hn=new Vector3;function nx(rt){let _=[];for(let ut=0;ut<=rt.index.count;ut++)if($c.fromArray(rt.index.array,ut*3),mr.setFromAttributeAndIndices(rt.attributes.position,$c.x,$c.y,$c.z),mr.getNormal(Yc),mr.getMidpoint(Hn),!(isNaN(Hn.x)||isNaN(Hn.y)||isNaN(Hn.z))){let{a:mt,b:bt,c:St}=mr,Mt=mt.toArray(),Bt=bt.toArray(),Ut=St.toArray(),Ht=mt.distanceTo(bt),tr=bt.distanceTo(St),rr=St.distanceTo(mt),sr=Ia(Mt,Bt),ar=Ia(Bt,Ut),cr=Ia(Ut,Mt),Ar=[Ht,tr,rr],_r=Math.max(...Ar),Dr=Ar.filter(Jr=>Math.round(Jr)===Math.round(_r)).length>1,$r=[],Br=mr.getMidpoint(Hn).toArray();_r===Ht&&!Dr&&($r=[ar,cr,cr],Br=sr),_r===tr&&!Dr&&($r=[sr,cr,cr],Br=ar),_r===rr&&!Dr&&($r=[sr,ar,ar],Br=cr),Dr&&($r=[sr,ar,cr]),_.push({vertices:[Mt,Bt,Ut],faceCenters:$r,midpoint:Br,norm:mr.getNormal(Yc).toArray()})}return _}function ix(rt){let _=[],{position:ut}=rt.attributes;for(let mt=0;mt<ut.count;mt++){mr.setFromAttributeAndIndices(ut,mt*3,mt*3+1,mt*3+2),mr.getNormal(Yc),mr.getMidpoint(Hn);let bt=mr.a.toArray(),St=mr.b.toArray(),Mt=mr.c.toArray();_.push({vertices:[bt,St,Mt],faceCenters:[Ia(bt,St),Ia(St,Mt),Ia(Mt,bt)],midpoint:Hn.toArray(),norm:Yc.toArray()})}return _}var rM=4,oM=.5,Ip=rt=>.5*(1-Math.cos(rt*Math.PI)),Np=class{constructor(){this.perlin=new Array(4096)}noise(rt,_=0,ut=0){if(this.perlin==null){this.perlin=new Array(4096);for(let _r=0;_r<4096;_r++)this.perlin[_r]=Math.random()}rt<0&&(rt=-rt),_<0&&(_=-_),ut<0&&(ut=-ut);let mt=Math.floor(rt),bt=Math.floor(_),St=Math.floor(ut),Mt=rt-mt,Bt=_-bt,Ut=ut-St,Ht,tr,rr=0,sr=.5,ar,cr,Ar;for(let _r=0;_r<rM;_r++){let Dr=mt+(bt<<4)+(St<<8);Ht=Ip(Mt),tr=Ip(Bt),ar=this.perlin[Dr&4095],ar+=Ht*(this.perlin[Dr+1&4095]-ar),cr=this.perlin[Dr+16&4095],cr+=Ht*(this.perlin[Dr+16+1&4095]-cr),ar+=tr*(cr-ar),Dr+=256,cr=this.perlin[Dr&4095],cr+=Ht*(this.perlin[Dr+1&4095]-cr),Ar=this.perlin[Dr+16&4095],Ar+=Ht*(this.perlin[Dr+16+1&4095]-Ar),cr+=tr*(Ar-cr),ar+=Ip(Ut)*(cr-ar),rr+=ar*sr,sr*=oM,mt<<=1,Mt*=2,bt<<=1,Bt*=2,St<<=1,Ut*=2,Mt>=1&&(mt++,Mt--),Bt>=1&&(bt++,Bt--),Ut>=1&&(St++,Ut--)}return rr}noiseSeed(rt){let _=(()=>{let ut,mt;return{setSeed(bt){mt=ut=(bt??Math.random()*4294967296)>>>0},getSeed(){return ut},rand(){return mt=(1664525*mt+1013904223)%4294967296,mt/4294967296}}})();_.setSeed(rt),this.perlin=new Array(4096);for(let ut=0;ut<4096;ut++)this.perlin[ut]=_.rand()}},ax=Np,sx=new Vector3,lx=new Matrix4,cx=new Ray;function ux(rt){let _=!1;return rt.scene.objects.traverse((ut,mt)=>{mt.type==="Mesh"&&mt.geometry.type==="TextGeometry"&&(_=!0)}),_}var Na=class extends st{constructor(rt,_,ut){super(rt,_,ut),this.data=_}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var _;let rt=this.dataPatched;return((_=this.font)==null?void 0:_.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,rt.geometry.height,this.fontScale,rt.geometry.verticalAlign))??0}get fontScale(){let rt=this.dataPatched;return this.font?rt.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var rt;return(((rt=this.font)==null?void 0:rt.ascender)??1)*this.fontScale}get descender(){var rt;return(((rt=this.font)==null?void 0:rt.descender)??1)*this.fontScale}get lineHeight(){let rt=this.dataPatched;return rt.geometry.fontSize*rt.geometry.lineHeight}raycast(rt,_){let{matrixWorld:ut}=this;if(!(isNaN(rt.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(lx.copy(ut).invert(),cx.copy(rt.ray).applyMatrix4(lx),cx.intersectBox(this.singleBBox,sx))){let mt=sx.applyMatrix4(ut),bt=rt.ray.origin.distanceTo(mt);_.push({distance:bt,point:mt.clone(),object:this})}}},jt=1e-4,oo,hx,mx,yx,px$1=new Vector3,fx=new Vector3;ra.then(rt=>{oo=rt,hx=[oo.get_face_center,oo.get_edge_midpoint,oo.get_vertex_position],mx=[oo.get_face_normal,oo.get_edge_normal,oo.get_vertex_normal],yx=[oo.face_count,oo.edge_count,oo.vertex_count]});var lM=new Matrix4,cM=new Matrix4,ln=new Vector3,Wn=new Vector3,Rs=new Vector3,Dp=new Vector3,uM=new Vector3,dM=new Vector3,Po=new ax,Da=class extends zi(Object3D){constructor(rt,_){super(),this.parameters=_,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=rt}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(rt){if(this.parent===null)this.updateState(this.parameters,rt);else for(let _ of this.children)_ instanceof wo&&_.expand()}invalidateTransform(rt){this.matrixWorldNeedsUpdate=!0,this.traverse(_=>{_ instanceof wo&&_.object===rt&&(_.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let rt of this.children)rt.updateMatrix(),rt.hasNonUniformScale&&(rt.updateMatrixWorld(),rt.updateMatrixWorldSVD())}_updateCount(rt){let _;if(rt!==void 0?_=rt:_=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(_=0),this.parameters.type==="toObject"&&this.objectForSample){for(let mt=0,bt=this.children.length;mt<bt;++mt)this.remove(this.children[0]);let ut=this.children;if(ut.length===_)return;if(ut.length<_)for(let mt=0,bt=_-ut.length;mt<bt;++mt){let St=new wo(this.object);St.expand(),this.add(St)}else for(let mt=0,bt=ut.length-_;mt<bt;++mt)this.remove(ut[mt])}else{if(this.children.length===_)return;if(this.children.length<_)for(let ut=0,mt=_-this.children.length;ut<mt;++ut){let bt=new wo(this.object);bt.expand(),this.add(bt)}else for(let ut=0,mt=this.children.length-_;ut<mt;++ut)this.remove(this.children[0])}}_updateRadial(rt){let _=rt.radial,ut=_.start*MathUtils.DEG2RAD,mt=_.end*MathUtils.DEG2RAD,bt=ut-mt,St=new Euler(_.rotation[0],_.rotation[1],_.rotation[2]),Mt;switch(_.axis){case"z":Mt=new Vector3(0,0,1);break;case"y":Mt=new Vector3(0,1,0);break;default:case"x":Mt=new Vector3(1,0,0);break}let Bt=rt.randomnessObject??Ur.defaultData([1,1,1]).randomnessObject,Ut=Bt.noiseType==="perlin";Po.noiseSeed(Bt.seed);let Ht=tc((0,Ea.default)(Bt.seed)),tr=Bs(Bt.strength,this.parameters.randomness);for(let[rr,sr]of this.children.entries()){let ar=rr*(Bt.freqScale/10)+Bt.movement,cr=Ut?Po.noise(ar):Ht(ar,ar),Ar=rr+1;sr.scale.x=_.scale[0]+tr(Ar,ve(cr,Bt.scale[0]))||jt,sr.scale.y=_.scale[1]+tr(Ar,ve(cr,Bt.scale[1]))||jt,sr.scale.z=_.scale[2]+tr(Ar,ve(cr,Bt.scale[2]))||jt,sr.position.setScalar(0);let _r=bt/rt.count*rr-ut;switch(_.axis){case"x":sr.rotation.set(0,_r,0);break;case"y":sr.rotation.set(0,0,_r);break;case"z":sr.rotation.set(_r,0,0);break}sr.translateOnAxis(Mt,_.radius),sr.position.x+=_.position[0]+tr(Ar,ve(cr,Bt.position[0])),sr.position.y+=_.position[1]+tr(Ar,ve(cr,Bt.position[1])),sr.position.z+=_.position[2]+tr(Ar,ve(cr,Bt.position[2]));let Dr=tr(Ar,ve(cr,Bt.rotation[0])),$r=tr(Ar,ve(cr,Bt.rotation[1])),Br=tr(Ar,ve(cr,Bt.rotation[2]));_.alignment===!0?(sr.rotation.x+=St.x+Dr,sr.rotation.y+=St.y+$r,sr.rotation.z+=St.z+Br):sr.rotation.set(St.x+Dr,St.y+$r,St.z+Br)}}_updateLinear(rt){if(rt.type!=="linear")throw new Error;let _=rt.linear,ut=new Euler(_.rotation[0],_.rotation[1],_.rotation[2]),mt=rt.randomnessObject??Ur.defaultData([1,1,1]).randomnessObject,bt=mt.noiseType==="perlin";Po.noiseSeed(mt.seed);let St=tc((0,Ea.default)(mt.seed)),Mt=Bs(mt.strength,this.parameters.randomness);for(let[Bt,Ut]of this.children.entries()){let Ht=Bt*(mt.freqScale/10)+mt.movement,tr=bt?Po.noise(Ht):St(Ht,Ht),rr=Bt+1,sr=Mt(rr,ve(tr,mt.rotation[0])),ar=Mt(rr,ve(tr,mt.rotation[1])),cr=Mt(rr,ve(tr,mt.rotation[2]));Ut.scale.x=1+(_.scale[0]-1)*Bt+Mt(rr,ve(tr,mt.scale[0]))||jt,Ut.scale.y=1+(_.scale[1]-1)*Bt+Mt(rr,ve(tr,mt.scale[1]))||jt,Ut.scale.z=1+(_.scale[2]-1)*Bt+Mt(rr,ve(tr,mt.scale[2]))||jt,Ut.rotation.x=ut.x*Bt+sr,Ut.rotation.y=ut.y*Bt+ar,Ut.rotation.z=ut.z*Bt+cr,Ut.position.x=_.position[0]*Bt+Mt(rr,ve(tr,mt.position[0])),Ut.position.y=_.position[1]*Bt+Mt(rr,ve(tr,mt.position[1])),Ut.position.z=_.position[2]*Bt+Mt(rr,ve(tr,mt.position[2]))}}_updateGrid(rt){let _=0,ut=rt.grid,mt=rt.randomnessObject??Ur.defaultData([1,1,1]).randomnessObject,bt=Bs(mt.strength,this.parameters.randomness),St=mt.noiseType==="perlin";Po.noiseSeed(mt.seed);let Mt=Ry((0,Ea.default)(mt.seed));if(ut.useCenter===!0){let Bt={x:ut.count[0]%2===0?2:1,y:ut.count[1]%2===0?2:1,z:ut.count[2]%2===0?2:1},Ut=new Vector3(ut.size[0]*(ut.count[0]-Bt.x)*.5,ut.size[1]*(ut.count[1]-Bt.y)*.5,ut.size[2]*(ut.count[2]-Bt.z)*.5);for(let Ht=0;Ht<ut.count[0];Ht++)for(let tr=0;tr<ut.count[1];tr++)for(let rr=0;rr<ut.count[2];rr++){let sr=[(Ht+1)*(mt.freqScale/10)+mt.movement,(tr+1)*(mt.freqScale/10)+mt.movement,(rr+1)*(mt.freqScale/10)+mt.movement],ar=St?Po.noise(...sr):Mt(...sr),cr=this.children[_++];cr.scale.x=1+bt(_,ve(ar,mt.scale[0]))||jt,cr.scale.y=1+bt(_,ve(ar,mt.scale[1]))||jt,cr.scale.z=1+bt(_,ve(ar,mt.scale[2]))||jt;let Ar=bt(_,ve(ar,mt.rotation[0])),_r=bt(_,ve(ar,mt.rotation[1])),Dr=bt(_,ve(ar,mt.rotation[2]));cr.rotation.set(Ar,_r,Dr),cr.position.x=ut.size[0]*Ht-Ut.x+bt(_,ve(ar,mt.position[0])),cr.position.y=ut.size[1]*tr-Ut.y+bt(_,ve(ar,mt.position[1])),cr.position.z=ut.size[2]*rr-Ut.z+bt(_,ve(ar,mt.position[2]))}}else for(let Bt=0;Bt<ut.count[0];Bt++)for(let Ut=0;Ut<ut.count[1];Ut++)for(let Ht=0;Ht<ut.count[2];Ht++){let tr=[(Bt+1)*(mt.freqScale/10)+mt.movement,(Ut+1)*(mt.freqScale/10)+mt.movement,(Ht+1)*(mt.freqScale/10)+mt.movement],rr=St?Po.noise(...tr):Mt(...tr),sr=this.children[_++];sr.scale.x=1+bt(_,ve(rr,mt.scale[0]))||jt,sr.scale.y=1+bt(_,ve(rr,mt.scale[1]))||jt,sr.scale.z=1+bt(_,ve(rr,mt.scale[2]))||jt;let ar=bt(_,ve(rr,mt.rotation[0])),cr=bt(_,ve(rr,mt.rotation[1])),Ar=bt(_,ve(rr,mt.rotation[2]));sr.rotation.set(ar,cr,Ar),sr.position.x=ut.size[0]*Bt+bt(_,ve(rr,mt.position[0])),sr.position.y=-ut.size[1]*Ut+bt(_,ve(rr,mt.position[1])),sr.position.z=-ut.size[2]*Ht+bt(_,ve(rr,mt.position[2]))}}_updateToObject(rt){var Ar;if(rt.type!=="toObject")throw new Error;let{toObject:_}=rt,ut=new Euler(_.rotation[0],_.rotation[1],_.rotation[2]),mt=rt.randomnessObject??Ur.defaultData([1,1,1]).randomnessObject,bt=mt.noiseType==="perlin";Po.noiseSeed(mt.seed);let St=tc((0,Ea.default)(mt.seed)),Mt=Bs(mt.strength,this.parameters.randomness);if(!_.object){for(let[,_r]of this.children.entries())_r.position.set(0,0,0),_r.scale.setScalar(1),_r.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof Na)if(!((Ar=this.objectForSample.font)!=null&&Ar.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let Bt=this.getSubdivData(),Ut=[],Ht=_r=>{let Dr=_r.length,$r=_r.map(mn=>mn[0]).reduce((mn,Mn)=>mn+Mn,0),Br=_r.map(mn=>mn[1]).reduce((mn,Mn)=>mn+Mn,0),Jr=_r.map(mn=>mn[2]).reduce((mn,Mn)=>mn+Mn,0);return[$r/Dr,Br/Dr,Jr/Dr]},tr=_r=>Math.round(_r*1e6)/1e6;Bt.forEach(_r=>{let Dr=Bt.filter($r=>tr(_r.pos[0])===tr($r.pos[0])&&tr(_r.pos[1])===tr($r.pos[1])&&tr(_r.pos[2])===tr($r.pos[2]));Dr.length>1?Ut.push({pos:_r.pos,norm:Ht(Dr.map($r=>$r.norm))}):Ut.push(_r)});let rr=ox(Ut);if(rr.length>0){let _r=Math.round(rr.length*_.count/100);this._updateCount(_r)}else{let _r=this.objectForSample.geometry.getAttribute("position");if(!_r||isNaN(_r.count)||_r.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let sr=new rc(this.objectForSample).build(),ar=tx[_.axis],cr=this.children;sr.setRandomGenerator((0,Ea.default)(this.object.uuid+_.seed));for(let[_r,Dr]of cr.entries()){let $r=_r*(mt.freqScale/10)+mt.movement,Br=bt?Po.noise($r):St($r,$r),Jr=_r+1,mn=Mt(Jr,ve(Br,mt.rotation[0])),Mn=Mt(Jr,ve(Br,mt.rotation[1])),$n=Mt(Jr,ve(Br,mt.rotation[2]));_.spreadType==="random"?sr.sample(Rs,Dp):(rr.length&&(Rs.fromArray(rr[_r].pos),Dp.fromArray(rr[_r].norm)),this.objectForSample instanceof Un&&Rs.applyMatrix4(lM.copy(this.objectForSample.matrixWorld).invert())),Rs.applyMatrix4(this.object.hiddenMatrix.clone().invert()),Dr.position.copy(Rs),ln.fromArray(ar);let en=_.align==="normal"?Dp:this.object.getWorldDirection(dM),In=Wn.fromArray(_.position);Wn.x+=Wn.x+Mt(Jr,ve(Br,mt.position[0])),Wn.y+=Wn.y+Mt(Jr,ve(Br,mt.position[1])),Wn.z+=Wn.z+Mt(Jr,ve(Br,mt.position[2]));let Rn=Math.acos(en.dot(ln)),qn=uM.crossVectors(ln,en).normalize(),Qn=cM.makeRotationAxis(qn,Rn),xs=en.clone().cross(this.object.up).normalize(),cs=xs.clone().cross(en).normalize(),ks=new Matrix4().makeBasis(xs,en,cs),_o=new Vector3(ln.y,ln.z,ln.x).normalize(),qs=_o.clone().cross(ln).normalize(),Ss=new Matrix4().makeBasis(_o,ln,qs).invert(),eo=new Matrix4().multiplyMatrices(ks,Ss);Dr.rotation.setFromRotationMatrix(eo),In.applyMatrix4(Qn),Dr.position.add(In),Dr.rotation.x=Dr.rotation.x+ut.x+mn,Dr.rotation.y=Dr.rotation.y+ut.y+Mn,Dr.rotation.z=Dr.rotation.z+ut.z+$n,Dr.scale.setScalar(1),Dr.scale.x=Dr.scale.x+_.scale[0]+Mt(Jr,ve(Br,mt.scale[0]))||jt,Dr.scale.y=Dr.scale.y+_.scale[1]+Mt(Jr,ve(Br,mt.scale[1]))||jt,Dr.scale.z=Dr.scale.z+_.scale[2]+Mt(Jr,ve(Br,mt.scale[2]))||jt,Dr.scale.multiply(this.object.scale),Dr.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let rt=this.parameters.toObject.spreadType;if(rt==="random")return[];if(this.objectForSample instanceof Un){let _=this.objectForSample,ut=rx[rt],mt=yx[ut],bt=hx[ut],St=mx[ut],Mt=[],Bt=mt(_.subdivPointerNew);for(let Ut=0;Ut<=Bt-1;Ut++){let Ht=bt(_.subdivPointerNew,Ut),tr=St(_.subdivPointerNew,Ut);px$1.fromArray(Ht).applyMatrix4(_.matrixWorld),fx.fromArray(tr),Mt.push({pos:px$1.toArray(),norm:fx.toArray()})}return Mt}else return(this.objectForSample.geometry.index?nx(this.objectForSample.geometry):ix(this.objectForSample.geometry)).map((_,ut)=>rt==="polygon_center"?{pos:_.midpoint,norm:_.norm}:rt==="vertex"?[{pos:_.vertices[0],norm:_.norm},{pos:_.vertices[1],norm:_.norm},{pos:_.vertices[2],norm:_.norm}]:rt==="edge"?[{pos:_.faceCenters[0],norm:_.norm},{pos:_.faceCenters[1],norm:_.norm},{pos:_.faceCenters[2],norm:_.norm}]:[]).flat()}updateState(rt,_){var ut;if(this.parameters=yo(rt),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(ut=this.object.parent)==null||ut.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let mt=_.find(this.parameters.toObject.object);mt instanceof It?this.objectForSample=mt:this.objectForSample=void 0,this.matrix=new Matrix4,this.hiddenMatrix=new Matrix4,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,mt&&mt.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},no=rt=>{var _;return _=class extends rt{},_.geometryHelper=new BoxGeometry(30,30,30),_},Xc=new Ray,Lp=new Sphere$1,gx=new Matrix4,io=(rt,_,ut,mt,bt=!1)=>{let St=_,Mt=rt.matrixWorld;if(St.boundingSphere===null&&St.computeBoundingSphere(),Lp.copy(St.boundingSphere),Lp.applyMatrix4(Mt),ut.ray.intersectsSphere(Lp)===!1||(gx.copy(Mt).invert(),Xc.copy(ut.ray).applyMatrix4(gx),St.boundingBox!==null&&Xc.intersectsBox(St.boundingBox)===!1))return;let Bt,Ut,Ht,tr,rr=St.index,sr=St.attributes.position,ar=St.drawRange,cr,Ar;if(bt===!1){let Dr=Math.max(0,ar.start),$r=Math.min(rr.count,ar.start+ar.count);for(cr=Dr,Ar=$r;cr<Ar;cr+=3)if(Ut=rr.getX(cr),Ht=rr.getX(cr+1),tr=rr.getX(cr+2),Bt=_r(rt,ut,Xc,sr,Ut,Ht,tr),Bt){Bt.faceIndex=Math.floor(cr/3),mt.push(Bt);return}}else{let Dr=St.attributes.position,$r=new Vector3,Br=new Vector3,Jr=new Vector3,mn=new Vector3,Mn=2,$n=1/((rt.scale.x+rt.scale.y+rt.scale.z)/3),en=$n*$n,In=Math.max(0,ar.start),Rn=Math.min(Dr.count,ar.start+ar.count);for(let qn=In,Qn=Rn-1;qn<Qn;qn+=Mn){if($r.fromBufferAttribute(Dr,qn),Br.fromBufferAttribute(Dr,qn+1),Xc.distanceSqToSegment($r,Br,mn,Jr)>en)continue;mn.applyMatrix4(rt.matrixWorld);let xs=ut.ray.origin.distanceTo(mn);xs<ut.near||xs>ut.far||mt.push({distance:xs,point:Jr.clone().applyMatrix4(rt.matrixWorld),object:rt})}}function _r(Dr,$r,Br,Jr,mn,Mn,$n){let en=new Vector3,In=new Vector3,Rn=new Vector3,qn=new Vector3,Qn=new Vector3;if(en.fromBufferAttribute(Jr,mn),In.fromBufferAttribute(Jr,Mn),Rn.fromBufferAttribute(Jr,$n),Br.intersectTriangle(en,In,Rn,!1,qn)===null)return null;Qn.copy(qn),Qn.applyMatrix4(Dr.matrixWorld);let xs=$r.ray.origin.distanceTo(Qn);return xs<$r.near||xs>$r.far?null:{faceIndex:1,distance:xs,point:Qn.clone(),object:Dr}}},Kc=new Vector3,yr=new Camera,Rp=class extends LineSegments{constructor(rt){let _=new BufferGeometry,ut=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),mt=[],bt=[],St={},Mt=new Color$1(15711266),Bt=new Color$1(15711266),Ut=new Color$1(2857471);Ht("n1","n2",Mt),Ht("n2","n4",Mt),Ht("n4","n3",Mt),Ht("n3","n1",Mt),Ht("f1","f2",Mt),Ht("f2","f4",Mt),Ht("f4","f3",Mt),Ht("f3","f1",Mt),Ht("n1","f1",Mt),Ht("n2","f2",Mt),Ht("n3","f3",Mt),Ht("n4","f4",Mt),Ht("p","n1",Bt),Ht("p","n2",Bt),Ht("p","n3",Bt),Ht("p","n4",Bt),Ht("u1","u2",Ut),Ht("u2","u3",Ut),Ht("u3","u1",Ut);function Ht(rr,sr,ar){tr(rr,ar),tr(sr,ar)}function tr(rr,sr){mt.push(0,0,0),bt.push(sr.r,sr.g,sr.b),St[rr]===void 0&&(St[rr]=[]),St[rr].push(mt.length/3-1)}_.setAttribute("position",new Float32BufferAttribute(mt,3)),_.setAttribute("color",new Float32BufferAttribute(bt,3)),super(_,ut),this.type="CameraHelper",this.camera=rt,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=rt.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=St,this.update()}update(){let rt=this.geometry,_=this.pointMap;yr.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let ut=1,mt=1,bt=.8;Er("n1",_,rt,yr,-ut,-mt,bt),Er("n2",_,rt,yr,ut,-mt,bt),Er("n3",_,rt,yr,-ut,mt,bt),Er("n4",_,rt,yr,ut,mt,bt);let St=bt;Er("f1",_,rt,yr,-ut,-mt,St),Er("f2",_,rt,yr,ut,-mt,St),Er("f3",_,rt,yr,-ut,mt,St),Er("f4",_,rt,yr,ut,mt,St);let Mt=St,Bt=.5;Er("u1",_,rt,yr,ut*.7*Bt,mt*1.1,Mt),Er("u2",_,rt,yr,-ut*.7*Bt,mt*1.1,Mt),Er("u3",_,rt,yr,0,mt*(1.1+.9*Bt),Mt),rt.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Er(rt,_,ut,mt,bt,St,Mt){Kc.set(bt,St,Mt).unproject(mt);let Bt=_[rt];if(Bt!==void 0){let Ut=ut.getAttribute("position");for(let Ht=0,tr=Bt.length;Ht<tr;Ht++)Ut.setXYZ(Bt[Ht],Kc.x,Kc.y,Kc.z)}}var Qc=class extends no(Rp){constructor(rt){super(rt),this.object=rt,this.object=rt,this.name=`CombinedCameraHelper: ${rt.uuid}`}updateMatrixWorld(rt){super.updateMatrixWorld(rt),this.updateTarget()}updateTarget(){let rt=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(rt)}raycast(rt,_){io(this.object,this.geometry,rt,_,!0)}},Zc;(rt=>rt.is=_=>"objectHelper"in _)(Zc||(Zc={}));var ao=(rt,_)=>class extends ji(rt){constructor(){super(...arguments),this.objectHelper=new _(this),this.gizmos={}}get geometryHelper(){return _.geometryHelper}raycast(ut,mt){this.objectHelper.raycast(ut,mt)}showGizmos(){for(let ut in this.gizmos){let mt=this.gizmos[ut];mt instanceof Box3Helper&&(mt.visible=!0)}}updateEntityBoxSize(ut,mt){this.objectHelper.visible&&this.geometryHelper instanceof BoxGeometry?(ut.setScalar(0),mt.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(ut,mt)}hideGizmos(){for(let ut in this.gizmos){let mt=this.gizmos[ut];mt instanceof Box3Helper&&(mt.visible=!1)}}},Jc=790,La=new Vector3,Vp=new Vector3,Gp=new Quaternion,zp=new Vector3,Vs=new Vector3,kp=new Vector3,Mo=class extends ao(Camera,Qc){constructor(rt="",_={...Tn.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=qo.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(rt,_),this.previousProjectionMatrix=new Matrix4,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let ut=this.width,mt=this.height;this.orthoCamera=new OrthographicCamera$1(ut*-.5,ut*.5,mt*.5,mt*-.5,-5e4,1e4),this.perspCamera=new PerspectiveCamera$1(45,ut/mt,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(rt){this.perspCamera.fov=rt}get fov(){return this.perspCamera.fov}setNear(rt,_){rt==="PerspectiveCamera"?this.perspCamera.near=_:this.orthoCamera.near=_}setZoom(rt,_){_>=0&&(rt==="PerspectiveCamera"?this.perspCamera.zoom=_:this.orthoCamera.zoom=_)}set cameraType(rt){rt==="PerspectiveCamera"?this.toPerspective():rt==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(rt){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=rt:this.orthoCamera.near=rt}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(rt){rt>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=rt:this.orthoCamera.zoom=rt)}lookAt(rt,_,ut){typeof rt=="number"&&(rt=new Vector3(rt,_,ut)),super.lookAt(rt),this.getWorldPosition(La),this.targetOffset=La.distanceTo(rt)}getTarget(rt=new Vector3){return this.getWorldDirection(Vp),this.getWorldPosition(La),Vp.multiplyScalar(this.targetOffset),rt.copy(La).add(Vp),rt}getDistanceToTarget(){let rt=this.getTarget();return this.getWorldPosition(La),La.distanceTo(rt)}updateUp(){this.getWorldQuaternion(Gp),zp.set(0,0,1).applyQuaternion(Gp),Vs.copy(Object3D.DEFAULT_UP),this.isUpVectorFlipped&&Vs.negate(),Vs.applyQuaternion(Gp),kp.copy(Object3D.DEFAULT_UP).projectOnPlane(zp),this.angleOffsetFromUp=kp.angleTo(Vs),this.angleOffsetFromUp*=kp.cross(Vs).dot(zp)>=0?1:-1}updateTransformState(rt,_){let ut=super.updateTransformState(rt,_);return rt.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=rt.isUpVectorFlipped),this.updateUp(),ut}getViewFrontToObject(rt){let _=rt.getWorldPosition(new Vector3),ut=rt.getWorldDirection(new Vector3).multiplyScalar(this.targetOffset);return{position:_.clone().add(ut),target:_}}getViewToTarget(rt){let _=this.getWorldDirection(new Vector3).multiplyScalar(this.targetOffset);return{position:rt.clone().sub(_),target:rt}}getViewToObject(rt){let _=new Vector3;return rt.getWorldPosition(_),this.getViewToTarget(_)}setViewplaneSize(rt,_,ut=!1){if(this.aspect=rt/_,ut){let mt=rt>_?this.aspect:1,bt=rt>_?1:this.aspect;this.left=-Jc*.5*mt,this.right=Jc*.5*mt,this.top=Jc*.5*(1/bt),this.bottom=-Jc*.5*(1/bt)}else this.left=-rt*.5,this.right=rt*.5,this.top=_*.5,this.bottom=-_*.5;this.updateProjectionMatrix()}copyViewPlaneSize(rt){this.aspect=rt.aspect,this.left=rt.left,this.right=rt.right,this.top=rt.top,this.bottom=rt.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(rt){this.perspCamera.setFocalLength(rt),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(rt,_,ut,mt,bt,St){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(rt,_,ut,mt,bt,St):this.orthoCamera.setViewOffset(rt,_,ut,mt,bt,St)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(rt){super.updateMatrixWorld(rt),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(rt,_){super.updateWorldMatrix(rt,_),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(rt,_){return super.copy(rt,_),this.parent=rt.parent,this.orthoCamera.copy(rt.orthoCamera),this.perspCamera.copy(rt.perspCamera),this.left=rt.left,this.right=rt.right,this.top=rt.top,this.bottom=rt.bottom,this.far=rt.far,this.view=rt.view===null?null:Object.assign({},rt.view),this._cameraType=rt._cameraType,this.aspect=rt.aspect,this.fov=rt.fov,this.focus=rt.focus,this.filmGauge=rt.filmGauge,this.filmOffset=rt.filmOffset,this.targetOffset=rt.targetOffset,this.updateProjectionMatrix(),this}toCameraState(rt=[]){let _={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return vi(_,rt)}updateCameraSubtype(rt,_){let ut=rt==="perspective"?"PerspectiveCamera":"OrthographicCamera";_.zoom!==void 0&&this.setZoom(ut,_.zoom),_.near!==void 0&&this.setNear(ut,_.near),_.fov!==void 0&&ut==="PerspectiveCamera"&&(this.fov=_.fov)}updateState(rt,_){this.updateCameraState(rt,_)}updateCameraState(rt,_){this.updateState_Entity(rt,_),rt.far!==void 0&&(this.far=rt.far),rt.orthographic!==void 0&&this.updateCameraSubtype("orthographic",rt.orthographic),rt.perspective!==void 0&&this.updateCameraSubtype("perspective",rt.perspective),rt.type!==void 0&&(this.cameraType=rt.type),rt.up!==void 0&&this.up.fromArray(rt.up),rt.targetOffset!==void 0&&(this.targetOffset=rt.targetOffset),rt.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=rt.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(rt,_,ut){super.updateByPatchedOp(rt,_,ut),rt.path.length===1&&rt.type===0&&this.updateCameraSubtype(rt.path[0],rt.props)}toState(rt){return{...super.toState(rt),...this.toCameraState(rt),type:this.cameraType}}},Ba=new Matrix4,MM=new Matrix4,eu=new Matrix4,wx=new Vector3,_x=new Vector3,er=class extends Jt{constructor(rt,_,ut){super(rt,_),this.data=_,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new BufferGeometry,this.onAfterRender=(mt,bt,St,Mt,Bt,Ut)=>{super.onAfterRender(mt,bt,St,Mt,Bt,Ut),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(rt,_,ut){super.updateByPatchedOp(rt,_,ut),rt.path.length===1&&rt.path[0]==="geometry"&&rt.type===0&&rt.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(rt,_=!0){var mt;if(this.booleanMeshSetAddress!==-1&&!rt)return;for(let bt=0;bt<this.children.length;bt++){let St=this.children[bt];St instanceof er&&St.dataPatched.visible===!0&&St.recomputeBoolean(rt===!0,_)}this.meshSetAddresses=[];for(let bt=0;bt<this.children.length;bt++){let St=this.children[bt];if(St instanceof It&&St.dataPatched.visible===!0&&((mt=St.geometry.attributes.position)==null?void 0:mt.count)>0&&St.geometry.drawRange.count>0&&St.booleanMeshSetAddress!==0){Ba.multiplyMatrices(St.hiddenMatrix,St.matrix);try{if(St.booleanMeshSetAddress===-1){if((St.geometry.index??St.geometry.getAttribute("position")).count/3<15e5&&(St.booleanMeshSetAddress=pr.getMeshSet(St.geometry,rt===!0,_)),St.booleanMeshSetAddress===-1)return;pr.transformMeshSet(St.booleanMeshSetAddress,Ba),St.booleanMatrixInvOld.copy(Ba).invert(),St.booleanWasTransformed=!1}else St instanceof er&&St.needsTransformForDownstream===!0?(pr.transformMeshSet(St.booleanMeshSetAddress,Ba),St.needsTransformForDownstream=!1):St.booleanWasTransformed===!0&&(pr.transformMeshSet(St.booleanMeshSetAddress,MM.multiplyMatrices(Ba,St.booleanMatrixInvOld)),St.booleanMatrixInvOld.copy(Ba).invert(),St.booleanWasTransformed=!1)}catch(Mt){console.error(Mt),St.booleanMeshSetAddress=0,St.geometry.userData.booleanOperationDidFail=!0;continue}pr.hasOpenEdges(St.booleanMeshSetAddress)===!1||bt===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(St.booleanMeshSetAddress),St.geometry.userData.booleanOperationDidFail=!1):St.geometry.userData.booleanOperationDidFail="openEdges"}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new Float32BufferAttribute([],0)),this.geometry.setDrawRange(0,0);return}if(rt===!0)return pr.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let ut=this.geometry;ut.dispose(),this.geometry=new BufferGeometry,this.geometry.userData=ut.userData,this.geometry.boundingSphere=ut.boundingSphere;try{this.booleanMeshSetAddress=pr.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(bt){this.booleanMeshSetAddress=0,this.geometry.userData.booleanOperationDidFail=!0,console.error(bt)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,Oa(this),Ma(this)}dispose(){super.dispose(),this.geometry.dispose()}get recursiveBBox(){var _;let rt=super.recursiveBBox;return((_=this.geometry.boundingSphere)==null?void 0:_.radius)===-1&&(rt.getCenter(this.geometry.boundingSphere.center),eu.copy(this.matrixWorld).invert(),this.geometry.boundingSphere.center.applyMatrix4(eu),wx.copy(rt.max).applyMatrix4(eu),_x.copy(rt.min).applyMatrix4(eu),this.geometry.boundingSphere.radius=wx.distanceTo(_x)/2),rt}},Tx;(rt=>{function _(ut){return Ae.is(ut)&&ut instanceof Light}rt.is=_})(Tx||(Tx={}));var Ra=(rt,_)=>class extends ao(rt,_){updateState_Light(ut,mt){this.updateState_Entity(ut,mt),ut.color!==void 0&&(this.color=mt.shared.color(ut.color)),ut.intensity!==void 0&&(this.intensity=ut.intensity),ut.depth!==void 0&&(this.shadow.camera.far=ut.depth,this.shadow.needsUpdate=!0),ut.shadows!==void 0&&(this.castShadow=ut.shadows)}},cn=rt=>rt instanceof It,Gs=rt=>rt!==null&&rt instanceof er,zs=rt=>Zc.is(rt),so=class extends no(AxesHelper){constructor(rt,_=15){super(_),this.object=rt,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${rt.uuid}`,this.matrix=rt.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(rt,_){io(this.object,so.geometryHelper,rt,_)}update(){}},un=class extends ao(Group$1,so){constructor(rt,_){super(),this.super_Entity(rt,_),this.objectHelper.update()}updateState(rt,_){this.updateState_Entity(rt,_),"buffer"in rt&&Object.keys(rt).length===1&&_.scene.reloadSplats()}},DM=rt=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${rt};
const int gShadowSamples = ${rt};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,LM=ShaderChunk.lights_fragment_begin,BM=ShaderChunk.shadowmask_pars_fragment,Cx=null,RM=rt=>{switch(rt){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},Px=(rt="medium")=>{if(Cx===rt)return!1;Cx=rt;let _=RM(rt);ShaderChunk.shadowmap_pars_fragment=DM(_);let ut=LM.slice();ut=ut.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),ut=ut.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),ShaderChunk.lights_fragment_begin=ut;let mt=BM.slice();return mt=mt.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),ShaderChunk.shadowmask_pars_fragment=mt,!0},Va=class extends no(DirectionalLightHelper){constructor(rt,_=15,ut=10066329){super(rt,_,ut),this.object=rt,this.added=!1,this.name=`DirectionalLightHelper: ${rt.uuid}`}raycast(rt,_){io(this.object,Va.geometryHelper,rt,_)}},Ga=class extends no(PointLightHelper){constructor(rt,_=15,ut=6710886){super(rt,_,ut),this.object=rt,this.name=`PointLightHelper: ${rt.uuid}`}raycast(rt,_){io(this.object,Ga.geometryHelper,rt,_)}},tu=class extends no(SpotLightHelper){constructor(rt,_=6710886){super(rt,_),this.object=rt,this.name=`SpotLightHelper: ${rt.uuid}`}raycast(rt,_){io(this.object,tu.geometryHelper,rt,_)}update(){if(this.object!==void 0){let rt=tu._vector,_=this.object.distance?this.object.distance:1e3,ut=_*Math.tan(this.object.angle);this.cone.scale.set(ut,ut,_),rt.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(rt);let mt=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let bt=0,St=this.cone.material.length;bt<St;bt++)this.cone.material[bt].color.set(mt);else this.cone.material.color.set(mt)}}},Fs=tu;Fs._vector=new Vector3;function jM(rt,_){rt.shadow.camera.right=_/2,rt.shadow.camera.left=-_/2,rt.shadow.camera.top=_/2,rt.shadow.camera.bottom=-_/2,rt.shadow.needsUpdate=!0}var za=class extends Ra(DirectionalLight,Va){constructor(rt,_,ut){super(),this.super_Entity(rt,_),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let mt=this.shadow.camera;mt.top=1250,mt.bottom=-1250,mt.right=1250,mt.left=-1250,mt.near=-1e4,mt.far=2500;let bt=new CameraHelper(this.shadow.camera);bt.visible=!1,this.gizmos.shadowmap=bt}update(){this.shadow.camera.updateProjectionMatrix();for(let rt in this.gizmos){let _=this.gizmos[rt];_ instanceof CameraHelper&&_.update()}}updateMatrixWorld(rt){super.updateMatrixWorld(rt),this.objectHelper&&this.objectHelper.update()}updateState(rt,_){this.updateState_Light(rt,_);let ut=rt.depth!==void 0&&rt.depth!==this.shadow.camera.far||rt.size!==void 0&&rt.size/2!==this.shadow.camera.right;rt.size!==void 0&&jM(this,rt.size),rt.shadowRadius!==void 0&&(this.shadow.radius=rt.shadowRadius),rt.shadowResolution!==void 0&&(this.shadow.mapSize.set(rt.shadowResolution,rt.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),rt.penumbraSize!==void 0&&_.scene.markPenumbraSizeDirty(),ut&&this.update()}},Ix=new Vector3,Nx=new Vector3,Ex=new Quaternion,ka=class extends Ra(SpotLight,Fs){constructor(rt,_,ut){super(),this.super_Entity(rt,_),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let mt=this.shadow.camera;mt.fov=MathUtils.RAD2DEG*2*this.angle,mt.aspect=1,mt.near=100,mt.far=2500;let bt=new CameraHelper(this.shadow.camera);bt.visible=!1,this.gizmos.shadowmap=bt,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let rt in this.gizmos){let _=this.gizmos[rt];_ instanceof CameraHelper&&_.update()}}updateMatrixWorld(rt){super.updateMatrixWorld(rt),Nx.setFromMatrixPosition(this.matrixWorld),Ex.setFromRotationMatrix(this.matrixWorld),Ix.copy(this.up).applyQuaternion(Ex).negate().multiplyScalar(this.distance),this.target.position.copy(Nx).add(Ix),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(rt,_){this.updateState_Light(rt,_),rt.distance!==void 0&&(this.distance=rt.distance),rt.decay!==void 0&&(this.decay=rt.decay),rt.angle!==void 0&&(this.angle=rt.angle),rt.penumbra!==void 0&&(this.penumbra=rt.penumbra),rt.shadowRadius!==void 0&&(this.shadow.radius=rt.shadowRadius),rt.penumbraSize!==void 0&&_.scene.markPenumbraSizeDirty(),rt.shadowResolution!==void 0&&(this.shadow.mapSize.set(rt.shadowResolution,rt.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},dn=class extends ji(Scene$3){constructor(rt,_){super(),this.data=_,this.bgColor=new ht(1,1,1,1),this.fog=null,this.backupFog=new Fog(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new Color$1,this.penumbraSizeArrayCache=null,this.super_Entity(rt,_),this.personalCamera=new Mo(Uo,{...Tn.defaultData,..._.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new HemisphereLight(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}updateVisible(){}setBackgroundColor(rt){this.bgColor=rt,this.fogUseBGColor===!0&&(this.backupFog.color=rt)}updateAmbientLight(rt,_){rt.color!==void 0&&(this.ambientLight.color=Dt(rt.color,_)),rt.intensity!==void 0&&(this.ambientLight.intensity=rt.intensity),rt.enabled!==void 0&&(rt.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(rt){this.isActive=!0,rt.fog=this.fog,this.traverseEntity(_=>{_ instanceof er&&_.recomputeBoolean()}),this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(rt=>{if(rt instanceof Jt)if(Array.isArray(rt.material))for(let _ of rt.material)_.needsUpdate=!0;else rt.material.needsUpdate=!0,rt.material.dispose()})}updateShadow(rt){rt.softShadowQuality!==void 0&&this.isActive&&Px(rt.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(rt,_){if(rt.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let ut=this.scene;ut.fog=this.fog}this.fogUseBGColor=rt.useBackgroundColor,rt.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=Dt(rt.color,_),this.backupFog.near=rt.near,this.backupFog.far=rt.far}updateAo(rt,_){rt.aoColor!==void 0&&(this.aoColor=Dt(rt.aoColor,_))}updateByOp(rt,_,ut,mt){super.updateByOp(rt,_,ut,mt);let bt=_;Lt(rt.path,["fog"])?this.updateFog(bt.fog,ut.shared):Lt(rt.path,["ao"])?this.updateAo(bt.ao,ut.shared):Lt(rt.path,["ambient"])?this.updateAmbientLight(bt.ambient,ut.shared):Lt(rt.path,["shadow"])&&this.updateShadow(bt.shadow)}updateState(rt,_){this.updateState_Entity(rt,_),rt.backgroundColor!==void 0&&this.setBackgroundColor(Dt(rt.backgroundColor,_.shared)),rt.fog!==void 0&&this.updateFog(rt.fog,_.shared),rt.ambient!==void 0&&this.updateAmbientLight(rt.ambient,_.shared),rt.ao!==void 0&&this.updateAo(rt.ao,_.shared),rt.shadow!==void 0&&this.updateShadow(rt.shadow)}raycast(rt,_){super.raycast(rt,_)}switchActiveCamera(rt){rt&&rt.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=rt,rt.objectHelper.visible=!1)}get playCamera(){var rt;return((rt=this.scene)==null?void 0:rt.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let rt=0,_=0;this.traverseEntity(ut=>{if(!ut.visible)return!0;ut instanceof za&&ut.visible&&rt<3&&(this.penumbraSizeArrayCache[rt]=ut.data.penumbraSize,rt+=1),ut instanceof ka&&ut.visible&&rt<2&&(this.penumbraSizeArrayCache[3+_]=ut.data.penumbraSize,_+=1)})}raycastWithClones(rt){let _=[],ut=mt=>{for(let bt of mt.children){let St=bt.cloner;Ae.is(bt)&&(bt.visible||St!=null&&St.object.data.visible)&&((cn(bt)||zs(bt)&&this.scene.enableHelpers&&bt.objectHelper.visible)&&(rt.intersectObject(bt,!1,_),Us(bt,rt,_,!0)),ut(bt))}};return ut(this),_}},ou=class extends Ra(PointLight,Ga){constructor(rt,_,ut){super(),this.super_Entity(rt,_),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let mt=this.shadow.camera;mt.fov=90,mt.aspect=1,mt.near=100,mt.far=2500;let bt=new Vector3(-mt.far+this.position.x,-mt.far+this.position.y,-mt.far+this.position.z),St=new Vector3(mt.far+this.position.x,mt.far+this.position.y,mt.far+this.position.z),Mt=new Box3(bt,St),Bt=new Box3Helper(Mt,new Color$1(16755200));Bt.visible=!1,this.gizmos.shadowmap=Bt,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let rt in this.gizmos){let _=this.gizmos[rt];if(_ instanceof Box3Helper){let ut=this.shadow.camera,mt=new Vector3(-ut.far+this.position.x,-ut.far+this.position.y,-ut.far+this.position.z),bt=new Vector3(ut.far+this.position.x,ut.far+this.position.y,ut.far+this.position.z);_.box.set(mt,bt),_.updateMatrixWorld(!0)}}}updateMatrixWorld(rt){super.updateMatrixWorld(rt),this.objectHelper&&this.objectHelper.update()}updateState(rt,_){this.updateState_Light(rt,_),rt.distance!==void 0&&(this.distance=rt.distance),rt.decay!==void 0&&(this.decay=rt.decay),rt.shadowRadius!==void 0&&(this.shadow.radius=rt.shadowRadius),rt.shadowResolution!==void 0&&(this.shadow.mapSize.set(rt.shadowResolution,rt.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},nu=class extends st{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(rt,_){let ut=this.geometry.getAttribute("position");ut!==void 0?ws(ut,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:ut.count,rt,_):super.updateEntityBoxSize(rt,_)}},Fa=class extends st{constructor(rt,_,ut){super(rt,_,ut),this._shapeId=null,this._context=ut}updateState(rt,_){super.updateState(rt,_),this.updateShape()}updateShape(){var mt;let rt={...this.data.geometry.extrusion.shape};for(let bt in rt)typeof rt[bt]=="string"&&(rt[bt]=this._context.shared.getVariable(rt[bt],[this.uuid,"geometry","extrusion","shape",bt]));let _;if(rt.type==="Custom"){let bt=rt.shapeId;if(bt!==this._shapeId&&this.detachShape(),bt){this._shapeId=bt;let St=this._context.scene.find(bt);St!=null&&St.data&&(St.attachedPaths.add(this),_=(mt=St.geometry.userData)==null?void 0:mt.shape),_||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let bt;switch(rt.type){case"Rectangle":bt=Ac;break;case"Ellipse":bt=Ki;break;case"Polygon":bt=_c;break;case"Star":bt=Tc;break;default:throw new Error(`Unknown shape type: ${rt.type}`)}_=bt.create({parameters:rt}).userData.shape}let ut=this.geometry;_&&ut.inputs&&(ut.inputs.shapeData=_,ut.build(),this.attachedSurfaceCloners.forEach(bt=>bt.update()))}detachShape(){var rt;this._shapeId!==null&&((rt=this._context.scene.find(this._shapeId))==null||rt.attachedPaths.delete(this))}createGeometryDelayed(rt){this.geometryCreateDeleyed=rt.shared,this.updateShape(),this.refreshAttachedPaths(rt)}updateTransformState(rt,_){return super.updateTransformState(rt,_)}updateGeometryInteractions(rt,_){super.updateGeometryInteractions(rt,_),this.updateShape()}updateEntityBoxSize(rt,_){let ut=this.geometry.getAttribute("position");ut!==void 0?ws(ut,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:ut.count,rt,_):super.updateEntityBoxSize(rt,_)}},Io=class extends ao(Group$1,so){constructor(rt,_,ut){super(),_.type==="Instance"&&typeof rt=="string"&&(_=this.transformAssignData(_,ut)),this.super_Entity(rt,_),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(rt,_){let ut=Li.getComponentData({scene:_.scene.data,shared:_.shared.data},rt.component);if(ut){let mt,bt;for(let St of Hr.rootOverrideProps)rt[St]===void 0?(mt===void 0&&(mt={...rt}),mt[St]=ut.data[St]):(bt===void 0&&(bt={}),bt[St]=rt[St],mt===void 0&&(mt={...rt}),mt[St]=Gr.apply(ut.data[St],rt[St]));return this.overrideData=bt,mt}else return{...Ot.defaultData,...rt,...xr(Ot.defaultData,Hr.rootOverrideProps)}}updateByOp(rt,_,ut,mt){let bt;if(this.isInstanceRoot&&!mt){if(_=this.transformAssignData(_,ut),rt.type===0&&rt.path.length===0&&this.component)for(let St of Hr.rootOverrideProps)St in rt.props&&rt.props[St]===void 0&&(bt===void 0&&(bt={...rt,props:{...rt.props}}),bt.props[St]=this.component.data[St]);else if(rt.type===0&&rt.path.length>0&&Hr.rootOverrideProps.includes(rt.path[0])){let St=rt.path[0];bt===void 0&&(bt={...rt,path:[],props:{[St]:_[St]}})}}super.updateByOp(bt??rt,_,ut,mt)}updateState(rt,_){this.updateState_Entity(rt,_)}expandInstanceChildren(rt){let _=this.data;if(this.component===void 0){let ut=rt.scene.find(_.component)??null,mt=!1;if(ut!==this.oldComponent){if(this.oldComponent){let bt=0;for(let St of this.children)if(Ae.is(St))rt.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(St),iu(St),bt+=1;else break;this.children.splice(0,bt)}mt=!0}if(ut){let bt={};Rx(rt,[this.uuid],_.overrides,this,ut,ut,0,mt,bt);for(let St of this.children)if(Ae.is(St)){let Mt=St.data;Mt.type==="Empty"&&Mt.animations&&St.traverseEntity(Bt=>{if(Bt instanceof st&&Bt.isSkinnedMesh){let Ut=Bt.dataPatched;if(Ut.bones&&Ut.boneInverses){let Ht=Ut.bones.map(sr=>rt.scene.find(bt[sr])),tr=Ut.boneInverses.map(sr=>new Matrix4().fromArray(sr)),rr=new Skeleton(Ht,tr);Bt.bind(rr,Bt.bindMatrix)}}else Bt.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function iu(rt){if(rt.component){let _=rt.component.instances.indexOf(rt);_>=0&&rt.component.instances.splice(_,1);for(let ut of rt.children)Ae.is(ut)&&iu(ut)}}function Bx(rt,_,ut,mt){return rt.component===_&&Su(rt.identity,mt)?rt.overrideData===ut?2:1:0}function Rx(rt,_,ut,mt,bt,St,Mt,Bt,Ut){if(Mt>50)return!1;if(mt.component!==bt){if(mt.component){let tr=mt.component.instances.indexOf(mt);tr>=0&&mt.component.instances.splice(tr,1)}bt.instances.push(mt),mt.component=bt}bt instanceof Io&&bt.isInstanceRoot&&bt.expandInstanceChildren(rt);let Ht=0;for(let tr of bt.children)if(Ae.is(tr)){let rr=[..._,...typeof tr.identity=="string"?[tr.identity]:tr.identity],sr=Ni.resolve(ut,rr,1);sr!=null&&!(sr instanceof ke)&&(Object.setPrototypeOf(sr,ke.prototype),console.error("wrong prototype"));let ar=null,cr;if(!Bt){let Ar=mt.children[Ht];if(ar=Ae.is(Ar)?Ar:null,ar!==null){let _r=Bx(ar,tr,sr,rr);cr=_r>=1?ar.stateSelection:void 0,_r!==2&&(ar=null)}if(ar===null&&(ar=rt.scene.findInstance(rr)??null,ar!==null)){let _r=Bx(ar,tr,sr,rr);if(cr=_r>=1?ar.stateSelection:void 0,_r!==2)ar=null;else{let Dr=ar.parent.children.indexOf(ar);ar.parent.children.splice(Dr,1),mt.children.splice(Ht,0,ar),ar.parent===mt?Dr<=Ht&&console.error("not possible"):(ar.parent=mt,ar.matrixWorldNeedsUpdate=!0,ar.resetBBoxNeedsUpdate(),ar.updateVisible(),rt.pendingDeletes.delete(ar))}}}if(ar===null){let Ar=sr?Gr.apply(tr.data,sr):tr.data;vr.is(Ar.type)&&(Ar={...Ar,type:"Empty"}),ar=wr.createEntity(rr,Ar,rt),ar.overrideData=sr,mt.add(ar),mt.children.splice(mt.children.length-1,1),mt.children.splice(Ht,0,ar),ar.updateState(ar.data,rt),cr&&ar.changeSelectedState(cr,rt),rt.scene.registerInstanceAndSetUuid(ar)}if(ar.isBone){let Ar=ar.identity[ar.identity.length-1];Ut[Ar]=ar.uuid}Ht+=1,Rx(rt,_,ut,ar,tr,St,Mt+1,Bt,Ut)}if(!Bt){let tr=Ht;for(;;){let rr=mt.children[Ht];if(Ae.is(rr))rt.pendingDeletes.add(rr);else break;Ht+=1}mt.children.splice(tr,Ht-tr)}return!0}var au=class extends ao(Bone,so){constructor(rt,_){super(),this.super_Entity(rt,_),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(rt,_){this.updateState_Entity(rt,_)}};function oI(rt,_,ut){let mt;return _.geometry.type==="TextGeometry"?new Na(rt,_,ut):(_.geometry.type==="SubdivGeometry"?mt=new Un(rt,_,ut):_.geometry.type==="PathGeometry"?mt=new Fa(rt,_,ut):_.geometry.type==="VectorGeometry"?mt=new nu(rt,_,ut):_.geometry.type==="BooleanGeometry"?mt=new er(rt,_,ut):mt=new st(rt,_,ut),mt)}function su(rt,_,ut){return _.type==="Mesh"?oI(rt,_,ut):_.type==="Empty"?new un(rt,_):_.type==="Splat"?new un(rt,_):_.type==="Bone"?new au(rt,_):_.type==="Page"?new dn(rt,_):_.type==="PointLight"?new ou(rt,_,ut):_.type==="SpotLight"?new ka(rt,_,ut):_.type==="DirectionalLight"?new za(rt,_,ut):_.type==="Component"||_.type==="Instance"?new Io(rt,_,ut):vr.is(_.type)?new Mo(rt,_):(console.error(_),new un(rt,_))}wr.createEntity=su;function nI(rt,_,ut){let mt=su(rt.identity,_,ut),bt=rt.children,St=rt.attachedPaths,Mt=rt.parent,Bt=rt.component,Ut=rt.instances,Ht=rt.overrideData,tr=rt.uuid,rr=rt.stateSelection;rt.dispose();for(let sr of Object.keys(rt))delete rt[sr];Object.setPrototypeOf(rt,Object.getPrototypeOf(mt));for(let sr of Object.keys(mt))rt[sr]=mt[sr];rt.children=[...rt.children,...bt],rt.attachedPaths=St,rt.parent=Mt,rt.component=Bt,rt.instances=Ut,rt.uuid=tr,rt.overrideData=Ht,rt.updateState(rt.data,ut),rr&&rt.changeSelectedState(rr,ut),rt.resetBBoxNeedsUpdate()}wr.changeEntityProptotype=nI;wr.Cloner=Da;function Vx(rt,_,ut,mt){rt.updateByOp(_,ut,mt,!1)}function Gx(rt,_){let ut=!1,mt=_.getLayersOfType("transmission"),bt=_.getLayersOfType("outline");return bt.length>0&&(rt.layers.set(8),mt.length>0&&rt.layers.enable(3),ut=!0,Ma(rt),Oa(rt)),mt.length===0&&bt.length===0&&rt.layers.set(0),rt instanceof Jt&&rt.needsAO&&rt.layers.enable(5),ut}function zx(rt,_){if(!_.layers)return!1;let ut=!1,mt=_.getLayersOfType("transmission").filter(St=>St.data.visible),bt=_.getLayersOfType("outline").filter(St=>St.data.visible);return mt.length>0&&(rt.layers.set(3),bt.length>0&&rt.layers.enable(8),ut=!0),mt.length===0&&bt.length===0&&rt.layers.set(0),rt.needsAO&&rt.layers.enable(5),ut}function kx(rt){let _=!1;return rt.traverseEntity(ut=>{if(ut instanceof Jt)if(Array.isArray(ut.material))for(let mt=0;mt<ut.material.length;mt++)Gx(ut,ut.material[mt])&&(_=!0);else Gx(ut,ut.material)&&(_=!0)}),_}function Fx(rt){let _=!1;return rt.traverseEntity(ut=>{if(ut instanceof Jt)if(Array.isArray(ut.material))for(let mt=0;mt<ut.material.length;mt++)zx(ut,ut.material[mt])&&(_=!0);else zx(ut,ut.material)&&(_=!0)}),_}var uI=new Raycaster,dI=new Matrix4,pI=new Ray;function Us(rt,_,ut,mt=!1){let bt=rt.cloner;if(bt)for(let St of bt.children){let Mt=dI.copy(St.matrixWorld).invert(),Bt=pI.copy(_.ray).applyMatrix4(Mt),Ut=rt.matrixWorld;Bt.applyMatrix4(Ut);let Ht=uI;Ht.set(Bt.origin,Bt.direction),Ht.near=_.near,Ht.far=_.far;let tr=Ht.intersectObject(rt,!1);tr.length>0&&ut.push({...tr[0],object:mt?St:rt})}}var lu=class{constructor(){this._constraints=new Map}setConstraint(rt,_){_===null?this._constraints.delete(rt):this._constraints.set(rt,_)}removeDependencies(rt){this._constraints.delete(rt)}applyConstraints(rt){let _=new Set;this._constraints.forEach((ut,mt)=>{let bt=[mt,ut],St=ut;for(;this._constraints.has(St);)St=this._constraints.get(St),_.has(St)||bt.push(St);for(let Mt=bt.length-2;Mt>=0;Mt--)if(!_.has(bt[Mt])){let Bt=rt.find(bt[Mt]);Bt?Bt.applyPathSnapping(rt):console.warn(`missing entity ${bt[Mt]}`),_.add(bt[Mt])}})}findDependency(rt,_){let ut=rt;for(;this._constraints.has(ut);)if(ut=this._constraints.get(ut),ut===_)return!0;return!1}},Lr=Rt(ja()),lo=Rt(Ua()),tt=Rt(ja()),ce=Rt(Ua()),pn=class{constructor(rt,_,ut){this._dataNormalized=rt,this._minD=_,this._maxD=ut}static createFromUnnormalized(rt){let _=ce.sup(rt),ut=ce.inf(rt),mt=(0,tt.default)(new Float32Array(rt.size),rt.shape),bt=_-ut;return bt<1e-4?ce.assigns(mt,0):(ce.subs(mt,rt,ut),ce.divs(mt,mt,bt)),new pn(mt,ut,_)}get data(){return this._dataNormalized}get minD(){return this._minD}get maxD(){return this._maxD}denormalize(){let rt=(0,tt.default)(new Float32Array(this._dataNormalized.size),this._dataNormalized.shape);return ce.muls(rt,this._dataNormalized,this._maxD-this._minD),ce.adds(rt,rt,this._minD),rt}},Fe=class{constructor(rt,_){this._quantized=rt,this._method=_}get quantized(){return this._quantized}static maxIntBits(rt){return 2**rt-1}static fromNormalized(rt,_){let ut=rt.data,mt;if(_==="norm8x"){let bt=Fe.maxIntBits(8),St=(0,tt.default)(new Float32Array(ut.size),ut.shape);ce.muls(St,ut,bt),ce.roundeq(St),mt=(0,tt.default)(new Uint8Array(St.data),ut.shape)}else if(_==="norm565"){let bt=(0,tt.default)(new Float32Array(ut.size),ut.shape);ce.assign(bt,ut),ce.mulseq(bt.pick(null,0),Fe.maxIntBits(5)),ce.mulseq(bt.pick(null,1),Fe.maxIntBits(6)),ce.mulseq(bt.pick(null,2),Fe.maxIntBits(5)),ce.roundeq(bt);let St=(0,tt.default)(new Uint16Array(bt.data),ut.shape),Mt=(0,tt.default)(new Uint16Array(ut.shape[0]),[ut.shape[0]]),Bt=(0,tt.default)(new Uint16Array(ut.shape[0]),[ut.shape[0]]);ce.lshifts(Mt,St.pick(null,0),11),ce.lshifts(Bt,St.pick(null,1),5),ce.boreq(Mt,Bt),ce.boreq(Mt,St.pick(null,2)),mt=Mt}else{let bt=(0,tt.default)(new Float32Array(ut.size),ut.shape);ce.assign(bt,ut),ce.mulseq(bt.pick(null,0),Fe.maxIntBits(11)),ce.mulseq(bt.pick(null,1),Fe.maxIntBits(10)),ce.mulseq(bt.pick(null,2),Fe.maxIntBits(11)),ce.roundeq(bt);let St=(0,tt.default)(new Uint32Array(bt.data),ut.shape),Mt=(0,tt.default)(new Uint32Array(ut.shape[0]),[ut.shape[0]]),Bt=(0,tt.default)(new Uint32Array(ut.shape[0]),[ut.shape[0]]);ce.lshifts(Mt,St.pick(null,0),21),ce.lshifts(Bt,St.pick(null,1),11),ce.boreq(Mt,Bt),ce.boreq(Mt,St.pick(null,2)),mt=Mt}return new Fe(mt,_)}dequantize(rt,_){let ut=this._method,mt,bt=this._quantized;if(ut==="norm8x"){let St=Fe.maxIntBits(8);mt=(0,tt.default)(new Float32Array(bt.size),bt.shape),ce.muls(mt,bt,1/St)}else if(ut==="norm565"){let St=(0,tt.default)(new Uint8Array(bt.shape[0]),[bt.shape[0]]),Mt=(0,tt.default)(new Uint8Array(bt.shape[0]),[bt.shape[0]]),Bt=(0,tt.default)(new Uint8Array(bt.shape[0]),[bt.shape[0]]);ce.rrshifts(St,bt,11),ce.rrshifts(Mt,bt,5),ce.bandseq(Mt,Fe.maxIntBits(6)),ce.bands(Bt,bt,Fe.maxIntBits(5)),mt=(0,tt.default)(new Float32Array(bt.shape[0]*3),[bt.shape[0],3]),ce.muls(mt.pick(null,0),St,1/Fe.maxIntBits(5)),ce.muls(mt.pick(null,1),Mt,1/Fe.maxIntBits(6)),ce.muls(mt.pick(null,2),Bt,1/Fe.maxIntBits(5))}else{let St=(0,tt.default)(new Uint16Array(bt.shape[0]),[bt.shape[0]]),Mt=(0,tt.default)(new Uint16Array(bt.shape[0]),[bt.shape[0]]),Bt=(0,tt.default)(new Uint16Array(bt.shape[0]),[bt.shape[0]]);ce.rrshifts(St,bt,21),ce.rrshifts(Mt,bt,11),ce.bandseq(Mt,Fe.maxIntBits(10)),ce.bands(Bt,bt,Fe.maxIntBits(11)),mt=(0,tt.default)(new Float32Array(bt.shape[0]*3),[bt.shape[0],3]),ce.muls(mt.pick(null,0),St,1/Fe.maxIntBits(11)),ce.muls(mt.pick(null,1),Mt,1/Fe.maxIntBits(10)),ce.muls(mt.pick(null,2),Bt,1/Fe.maxIntBits(11))}return new pn(mt,rt,_)}},je=class{constructor(rt,_,ut,mt,bt,St=!1){this._quantized=rt,this._minMaxMatrix=_,this._chunkSize=ut,this._quantizationMethod=mt,this._variableChunkSize=bt,this._isDynamicChunks=St}get length(){return this._quantized.shape[0]}get nchunks(){return this._minMaxMatrix.shape[0]}get quantized(){return this._quantized}get method(){return this._quantizationMethod}get minmaxMatrix(){return this._minMaxMatrix}_createPrunedMinMax(rt){let _=rt.length,ut=this.minmaxMatrix.shape[0]-_,mt=(0,Lr.default)(new Float32Array(ut*2),[ut,2]),bt=0,St=ut,Mt=0,Bt=this.minmaxMatrix.shape[0];for(let Ut=0;Ut<rt.length;Ut++)Bt=rt[Ut],St=Bt-Mt+bt,St>bt&&lo.assign(mt.hi(St,2).lo(bt,0),this.minmaxMatrix.hi(Bt,2).lo(Mt,0)),bt=St,Mt=Bt+1;return bt<ut&&lo.assign(mt.lo(bt,0),this.minmaxMatrix.lo(Mt,0)),mt}_createPrunedQuantized(rt){let _=rt.length,ut=this.quantized.shape[0]-_,mt=this._quantizationMethod,bt,St;if(mt==="norm8x"){St=this._quantized.shape[1];let tr=St?ut*St:ut;bt=(0,Lr.default)(new Uint8Array(tr),St?[ut,St]:[ut,1])}else mt==="norm565"?bt=(0,Lr.default)(new Uint16Array(ut),[ut]):bt=(0,Lr.default)(new Uint32Array(ut),[ut]);let Mt=0,Bt=ut,Ut=0,Ht=bt.shape[0];for(let tr=0;tr<rt.length;tr++)Ht=rt[tr],Bt=Ht-Ut+Mt,Bt>Mt&&(St?lo.assign(bt.hi(Bt,St).lo(Mt,0),this._quantized.hi(Ht,St).lo(Ut,0)):lo.assign(bt.hi(Bt).lo(Mt),this._quantized.hi(Ht).lo(Ut))),Mt=Bt,Ut=Ht+1;return Mt<ut&&(St?lo.assign(bt.lo(Mt,0),this._quantized.lo(Ut,0)):lo.assign(bt.lo(Mt),this._quantized.lo(Ut))),bt}pruneFeature(rt,_,ut){let mt=this._createPrunedQuantized(rt),bt=this._createPrunedMinMax(_);return new je(mt,bt,this._chunkSize,this._quantizationMethod,ut,!0)}static getRequiredNChunks(rt,_){return Math.floor(rt/_)}static fromArray(rt,_,ut){let mt=rt.shape[0],bt=Math.floor(mt/ut),St=(0,Lr.default)(new Float32Array(bt*2),[bt,2],[2,1]),Mt;_==="norm8x"?Mt=(0,Lr.default)(new Uint8Array(rt.size),rt.shape):_==="norm565"?Mt=(0,Lr.default)(new Uint16Array(rt.shape[0]),[rt.shape[0]]):Mt=(0,Lr.default)(new Uint32Array(rt.shape[0]),[rt.shape[0]]);for(let Bt=0;Bt<bt;Bt++){let Ut=Bt*ut,Ht=Bt+1<bt?(Bt+1)*ut:mt,tr;rt.shape.length>1?tr=pn.createFromUnnormalized(rt.hi(Ht,rt.shape[1]).lo(Ut,0)):tr=pn.createFromUnnormalized(rt.hi(Ht).lo(Ut)),St.set(Bt,0,tr.minD),St.set(Bt,1,tr.maxD),Mt.shape.length>1?lo.assign(Mt.hi(Ht,Mt.shape[1]).lo(Ut,0),Fe.fromNormalized(tr,_).quantized):lo.assign(Mt.hi(Ht).lo(Ut),Fe.fromNormalized(tr,_).quantized)}return new je(Mt,St,ut,_)}denormDequant(){let rt=this._minMaxMatrix.shape[0],_=this._quantized,ut=_.shape[0],mt=this._quantizationMethod,bt=this._chunkSize,St;if(this._isDynamicChunks){if(!this._variableChunkSize)throw new Error("variable chunk must exists if chunkSize isDynamic");St=this._variableChunkSize}let Mt;mt==="norm8x"?Mt=(0,Lr.default)(new Float32Array(_.size),_.shape):Mt=(0,Lr.default)(new Float32Array(ut*3),[ut,3]);let Bt=0,Ut=bt;for(let Ht=0;Ht<rt;Ht++){let[tr,rr]=[this._minMaxMatrix.get(Ht,0),this._minMaxMatrix.get(Ht,1)];this._isDynamicChunks&&(Ut=St[Ht]);let sr=Ht+1<rt?Bt+Ut:ut,ar;_.shape.length>1?ar=new Fe(_.hi(sr,_.shape[1]).lo(Bt,0),mt):ar=new Fe(_.hi(sr).lo(Bt),mt),lo.assign(Mt.hi(sr,Mt.shape[1]).lo(Bt,0),ar.dequantize(tr,rr).denormalize()),Bt=sr}return Mt}static async fetchArrayBuffer(rt){return await(await fetch(rt,{mode:"cors"})).arrayBuffer()}},No=Rt(ja()),Ce$1=Rt(Ua()),cv="http://127.0.0.1:8000",Yn=Rt(ja()),ze=Rt(Ua()),uv=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function dv(rt){return rt<1e5?rt<100?rt<10?0:1:rt<1e4?rt<1e3?2:3:4:rt<1e7?rt<1e6?5:6:rt<1e9?rt<1e8?7:8:9}function pv(rt,_){if(rt===_)return 0;if(~~rt===rt&&~~_===_){if(rt===0||_===0)return rt<_?-1:1;if(rt<0||_<0){if(_>=0)return-1;if(rt>=0)return 1;rt=-rt,_=-_}let bt=dv(rt),St=dv(_),Mt=0;return bt<St?(rt*=uv[St-bt-1],_/=10,Mt=-1):bt>St&&(_*=uv[bt-St-1],rt/=10,Mt=1),rt===_?Mt:rt<_?-1:1}let ut=String(rt),mt=String(_);return ut===mt?0:ut<mt?-1:1}function VI(rt){let _=0;for(;rt>=32;)_|=rt&1,rt>>=1;return rt+_}function fv(rt,_,ut,mt){let bt=_+1;if(bt===ut)return 1;if(mt(rt[bt++],rt[_])<0){for(;bt<ut&&mt(rt[bt],rt[bt-1])<0;)bt++;GI(rt,_,bt)}else for(;bt<ut&&mt(rt[bt],rt[bt-1])>=0;)bt++;return bt-_}function GI(rt,_,ut){for(ut--;_<ut;){let mt=rt[_];rt[_++]=rt[ut],rt[ut--]=mt}}function hv(rt,_,ut,mt,bt){for(mt===_&&mt++;mt<ut;mt++){let St=rt[mt],Mt=_,Bt=mt;for(;Mt<Bt;){let Ht=Mt+Bt>>>1;bt(St,rt[Ht])<0?Bt=Ht:Mt=Ht+1}let Ut=mt-Mt;switch(Ut){case 3:rt[Mt+3]=rt[Mt+2];case 2:rt[Mt+2]=rt[Mt+1];case 1:rt[Mt+1]=rt[Mt];break;default:for(;Ut>0;)rt[Mt+Ut]=rt[Mt+Ut-1],Ut--}rt[Mt]=St}}function qp(rt,_,ut,mt,bt,St){let Mt=0,Bt=0,Ut=1;if(St(rt,_[ut+bt])>0){for(Bt=mt-bt;Ut<Bt&&St(rt,_[ut+bt+Ut])>0;)Mt=Ut,Ut=(Ut<<1)+1,Ut<=0&&(Ut=Bt);Ut>Bt&&(Ut=Bt),Mt+=bt,Ut+=bt}else{for(Bt=bt+1;Ut<Bt&&St(rt,_[ut+bt-Ut])<=0;)Mt=Ut,Ut=(Ut<<1)+1,Ut<=0&&(Ut=Bt);Ut>Bt&&(Ut=Bt);let Ht=Mt;Mt=bt-Ut,Ut=bt-Ht}for(Mt++;Mt<Ut;){let Ht=Mt+(Ut-Mt>>>1);St(rt,_[ut+Ht])>0?Mt=Ht+1:Ut=Ht}return Ut}function Wp(rt,_,ut,mt,bt,St){let Mt=0,Bt=0,Ut=1;if(St(rt,_[ut+bt])<0){for(Bt=bt+1;Ut<Bt&&St(rt,_[ut+bt-Ut])<0;)Mt=Ut,Ut=(Ut<<1)+1,Ut<=0&&(Ut=Bt);Ut>Bt&&(Ut=Bt);let Ht=Mt;Mt=bt-Ut,Ut=bt-Ht}else{for(Bt=mt-bt;Ut<Bt&&St(rt,_[ut+bt+Ut])>=0;)Mt=Ut,Ut=(Ut<<1)+1,Ut<=0&&(Ut=Bt);Ut>Bt&&(Ut=Bt),Mt+=bt,Ut+=bt}for(Mt++;Mt<Ut;){let Ht=Mt+(Ut-Mt>>>1);St(rt,_[ut+Ht])<0?Ut=Ht:Mt=Ht+1}return Ut}var $p=class{constructor(rt,_){yt(this,"array",null),yt(this,"compare",null),yt(this,"minGallop",7),yt(this,"length",0),yt(this,"tmpStorageLength",256),yt(this,"stackLength",0),yt(this,"runStart",null),yt(this,"runLength",null),yt(this,"stackSize",0),this.array=rt,this.compare=_,this.length=rt.length,this.length<2*256&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}pushRun(rt,_){this.runStart[this.stackSize]=rt,this.runLength[this.stackSize]=_,this.stackSize+=1}mergeRuns(){for(;this.stackSize>1;){let rt=this.stackSize-2;if(rt>=1&&this.runLength[rt-1]<=this.runLength[rt]+this.runLength[rt+1]||rt>=2&&this.runLength[rt-2]<=this.runLength[rt]+this.runLength[rt-1])this.runLength[rt-1]<this.runLength[rt+1]&&rt--;else if(this.runLength[rt]>this.runLength[rt+1])break;this.mergeAt(rt)}}forceMergeRuns(){for(;this.stackSize>1;){let rt=this.stackSize-2;rt>0&&this.runLength[rt-1]<this.runLength[rt+1]&&rt--,this.mergeAt(rt)}}mergeAt(rt){let _=this.compare,ut=this.array,mt=this.runStart[rt],bt=this.runLength[rt],St=this.runStart[rt+1],Mt=this.runLength[rt+1];this.runLength[rt]=bt+Mt,rt===this.stackSize-3&&(this.runStart[rt+1]=this.runStart[rt+2],this.runLength[rt+1]=this.runLength[rt+2]),this.stackSize--;let Bt=Wp(ut[St],ut,mt,bt,0,_);mt+=Bt,bt-=Bt,bt!==0&&(Mt=qp(ut[mt+bt-1],ut,St,Mt,Mt-1,_),Mt!==0&&(bt<=Mt?this.mergeLow(mt,bt,St,Mt):this.mergeHigh(mt,bt,St,Mt)))}mergeLow(rt,_,ut,mt){let bt=this.compare,St=this.array,Mt=this.tmp,Bt=0;for(Bt=0;Bt<_;Bt++)Mt[Bt]=St[rt+Bt];let Ut=0,Ht=ut,tr=rt;if(St[tr++]=St[Ht++],--mt===0){for(Bt=0;Bt<_;Bt++)St[tr+Bt]=Mt[Ut+Bt];return}if(_===1){for(Bt=0;Bt<mt;Bt++)St[tr+Bt]=St[Ht+Bt];St[tr+mt]=Mt[Ut];return}let rr=this.minGallop;for(;;){let sr=0,ar=0,cr=!1;do if(bt(St[Ht],Mt[Ut])<0){if(St[tr++]=St[Ht++],ar++,sr=0,--mt===0){cr=!0;break}}else if(St[tr++]=Mt[Ut++],sr++,ar=0,--_===1){cr=!0;break}while((sr|ar)<rr);if(cr)break;do{if(sr=Wp(St[Ht],Mt,Ut,_,0,bt),sr!==0){for(Bt=0;Bt<sr;Bt++)St[tr+Bt]=Mt[Ut+Bt];if(tr+=sr,Ut+=sr,_-=sr,_<=1){cr=!0;break}}if(St[tr++]=St[Ht++],--mt===0){cr=!0;break}if(ar=qp(Mt[Ut],St,Ht,mt,0,bt),ar!==0){for(Bt=0;Bt<ar;Bt++)St[tr+Bt]=St[Ht+Bt];if(tr+=ar,Ht+=ar,mt-=ar,mt===0){cr=!0;break}}if(St[tr++]=Mt[Ut++],--_===1){cr=!0;break}rr--}while(sr>=7||ar>=7);if(cr)break;rr<0&&(rr=0),rr+=2}if(this.minGallop=rr,rr<1&&(this.minGallop=1),_===1){for(Bt=0;Bt<mt;Bt++)St[tr+Bt]=St[Ht+Bt];St[tr+mt]=Mt[Ut]}else{if(_===0)throw new Error("mergeLow preconditions were not respected");for(Bt=0;Bt<_;Bt++)St[tr+Bt]=Mt[Ut+Bt]}}mergeHigh(rt,_,ut,mt){let bt=this.compare,St=this.array,Mt=this.tmp,Bt=0;for(Bt=0;Bt<mt;Bt++)Mt[Bt]=St[ut+Bt];let Ut=rt+_-1,Ht=mt-1,tr=ut+mt-1,rr=0,sr=0;if(St[tr--]=St[Ut--],--_===0){for(rr=tr-(mt-1),Bt=0;Bt<mt;Bt++)St[rr+Bt]=Mt[Bt];return}if(mt===1){for(tr-=_,Ut-=_,sr=tr+1,rr=Ut+1,Bt=_-1;Bt>=0;Bt--)St[sr+Bt]=St[rr+Bt];St[tr]=Mt[Ht];return}let ar=this.minGallop;for(;;){let cr=0,Ar=0,_r=!1;do if(bt(Mt[Ht],St[Ut])<0){if(St[tr--]=St[Ut--],cr++,Ar=0,--_===0){_r=!0;break}}else if(St[tr--]=Mt[Ht--],Ar++,cr=0,--mt===1){_r=!0;break}while((cr|Ar)<ar);if(_r)break;do{if(cr=_-Wp(Mt[Ht],St,rt,_,_-1,bt),cr!==0){for(tr-=cr,Ut-=cr,_-=cr,sr=tr+1,rr=Ut+1,Bt=cr-1;Bt>=0;Bt--)St[sr+Bt]=St[rr+Bt];if(_===0){_r=!0;break}}if(St[tr--]=Mt[Ht--],--mt===1){_r=!0;break}if(Ar=mt-qp(St[Ut],Mt,0,mt,mt-1,bt),Ar!==0){for(tr-=Ar,Ht-=Ar,mt-=Ar,sr=tr+1,rr=Ht+1,Bt=0;Bt<Ar;Bt++)St[sr+Bt]=Mt[rr+Bt];if(mt<=1){_r=!0;break}}if(St[tr--]=St[Ut--],--_===0){_r=!0;break}ar--}while(cr>=7||Ar>=7);if(_r)break;ar<0&&(ar=0),ar+=2}if(this.minGallop=ar,ar<1&&(this.minGallop=1),mt===1){for(tr-=_,Ut-=_,sr=tr+1,rr=Ut+1,Bt=_-1;Bt>=0;Bt--)St[sr+Bt]=St[rr+Bt];St[tr]=Mt[Ht]}else{if(mt===0)throw new Error("mergeHigh preconditions were not respected");for(rr=tr-(mt-1),Bt=0;Bt<mt;Bt++)St[rr+Bt]=Mt[Bt]}}};function mv(rt,_,ut,mt){if(!Array.isArray(rt))throw new TypeError("Can only sort arrays");_?typeof _!="function"&&(mt=ut,ut=_,_=pv):_=pv,ut||(ut=0),mt||(mt=rt.length);let bt=mt-ut;if(bt<2)return;let St=0;if(bt<32){St=fv(rt,ut,mt,_),hv(rt,ut,mt,ut+St,_);return}let Mt=new $p(rt,_),Bt=VI(bt);do{if(St=fv(rt,ut,mt,_),St<Bt){let Ut=bt;Ut>Bt&&(Ut=Bt),hv(rt,ut,ut+Ut,ut+St,_),St=Ut}Mt.pushRun(ut,St),Mt.mergeRuns(),bt-=St,ut+=St}while(bt!==0);Mt.forceMergeRuns()}function Yp(rt){let _=(0,Yn.default)(new Int32Array(rt.shape[0]),[rt.shape[0]]),ut=(0,Yn.default)(new Int32Array(rt.shape[0]),[rt.shape[0]]);return ze.bands(_,rt,1023),ze.lshifts(ut,_,16),ze.bxoreq(_,ut),ze.bandseq(_,4278190335),ze.lshifts(ut,_,8),ze.bxoreq(_,ut),ze.bandseq(_,50393103),ze.lshifts(ut,_,4),ze.bxoreq(_,ut),ze.bandseq(_,51130563),ze.lshifts(ut,_,2),ze.bxoreq(_,ut),ze.bandseq(_,153391689),_}function zI(rt){let _=Yp(rt.pick(null,0)),ut=Yp(rt.pick(null,1));ze.lshiftseq(ut,1);let mt=Yp(rt.pick(null,2));return ze.lshiftseq(mt,2),ze.boreq(_,ut),ze.boreq(_,mt),_}function fn(rt,_){if(rt.shape[0]!==_.shape[0])throw new Error("wrong length");let ut=(0,Yn.default)(new Float32Array(rt.size),rt.shape,rt.stride,rt.offset);for(let mt=0;mt<_.shape[0];mt++){let bt=_.get(mt);if(rt.shape.length>1)for(let St=0;St<rt.shape[1];St++)ut.set(mt,St,rt.get(bt,St));else ut.set(mt,rt.get(bt))}return ut}function Xp(rt){let _=ze.sup(rt),ut=ze.inf(rt),mt=1e3/Math.min(1e3,_-ut),bt=(0,Yn.default)(new Float32Array(rt.data),rt.shape);ze.mulseq(bt,mt);let St=(0,Yn.default)(new Int32Array(bt.data),rt.shape),Mt=zI(St),Bt=Array.from(Mt.data).map((Ht,tr)=>[Ht,tr]);mv(Bt,(Ht,tr)=>Ht[0]-tr[0]);let Ut=Bt.map(([Ht,tr])=>tr);return(0,Yn.default)(Uint32Array.from(Ut))}var gr=class{constructor(rt,_,ut,mt,bt,St,Mt,Bt,Ut,Ht){this.propertyDescs=rt,this.format=_,this.nsplats=ut,this.xyz=mt,this.colors=bt,this.harmonics=St,this.opacity=Mt,this.scaling=Bt,this.rotation=Ut,this.maxSHDegree=Ht}getPlyBinary(){let rt=gr._generateHeaderString(this.propertyDescs,this.format,this.nsplats),_=new TextEncoder().encode(rt),ut=Object.keys(this.propertyDescs).length,mt=(0,No.default)(new Float32Array(this.nsplats*ut),[this.nsplats,ut]);if(Ce$1.assign(mt.pick(null,this.propertyDescs.x.index),this.xyz.pick(null,0)),Ce$1.assign(mt.pick(null,this.propertyDescs.y.index),this.xyz.pick(null,1)),Ce$1.assign(mt.pick(null,this.propertyDescs.z.index),this.xyz.pick(null,2)),Ce$1.assign(mt.pick(null,this.propertyDescs.f_dc_0.index),this.colors.pick(null,0)),Ce$1.assign(mt.pick(null,this.propertyDescs.f_dc_1.index),this.colors.pick(null,1)),Ce$1.assign(mt.pick(null,this.propertyDescs.f_dc_2.index),this.colors.pick(null,2)),Ce$1.assign(mt.pick(null,this.propertyDescs.opacity.index),this.opacity.pick(null,0)),Ce$1.assign(mt.pick(null,this.propertyDescs.scale_0.index),this.scaling.pick(null,0)),Ce$1.assign(mt.pick(null,this.propertyDescs.scale_1.index),this.scaling.pick(null,1)),Ce$1.assign(mt.pick(null,this.propertyDescs.scale_2.index),this.scaling.pick(null,2)),Ce$1.assign(mt.pick(null,this.propertyDescs.rot_0.index),this.rotation.pick(null,0)),Ce$1.assign(mt.pick(null,this.propertyDescs.rot_1.index),this.rotation.pick(null,1)),Ce$1.assign(mt.pick(null,this.propertyDescs.rot_2.index),this.rotation.pick(null,2)),Ce$1.assign(mt.pick(null,this.propertyDescs.rot_3.index),this.rotation.pick(null,3)),this.harmonics&&this.harmonics.length>0)for(let Mt=0;Mt<this.harmonics.length;Mt++){let Bt=Mt*3;Ce$1.assign(mt.pick(null,this.propertyDescs[`f_rest_${Bt}`].index),this.harmonics[Mt].pick(null,0)),Ce$1.assign(mt.pick(null,this.propertyDescs[`f_rest_${Bt+1}`].index),this.harmonics[Mt].pick(null,1)),Ce$1.assign(mt.pick(null,this.propertyDescs[`f_rest_${Bt+2}`].index),this.harmonics[Mt].pick(null,2))}let bt=new Uint8Array(mt.data.buffer),St=new Uint8Array(bt.length+_.length);return St.set(_),St.set(bt,_.length),St.buffer}save(rt,_){let ut=this.getPlyBinary(),mt=new Blob([ut],{type:"application/octet-stream"}),bt=new File([mt],rt),St=new FormData;St.append("file",bt),St.append("filename",rt),St.append("basedir",_),fetch(`${cv}/push_file`,{method:"POST",body:St})}static async loadFile(rt){return await(await fetch(rt)).arrayBuffer()}mortonPositionSplatsSort(){let rt=Xp(this.xyz),_=fn(this.xyz,rt),ut=fn(this.colors,rt),mt=fn(this.opacity,rt),bt=fn(this.scaling,rt),St=fn(this.rotation,rt),Mt=[];for(let Bt=0;Bt<this.harmonics.length;Bt++)Mt.push(fn(this.harmonics[Bt],rt));return new gr(this.propertyDescs,this.format,this.nsplats,_,ut,Mt,mt,bt,St,this.maxSHDegree)}static _generateHeaderString(rt,_,ut){let mt=`ply
format ${_.format} ${_.version}
element vertex ${ut}`,bt=Object.keys(rt).length,St=Array(bt);for(let Mt in rt){let Bt=rt[Mt];St[Bt.index]={name:Mt,dtype:Bt.dtype}}for(let Mt=0;Mt<St.length;Mt++)mt=`${mt}
property ${St[Mt].dtype} ${St[Mt].name}`;return`${mt}
end_header
`}static fromArrayBuffer(rt,_=3){let{splatCount:ut,vertexData:mt,propertiesDesc:bt,format:St}=gr.decodeHeader(rt),Mt=mt.buffer.slice(mt.byteOffset),Bt=Object.keys(bt).length,Ut=(0,No.default)(new Float32Array(Mt),[ut,Bt]),Ht=0,tr={},rr={double:8,int:4,uint:4,float:4,short:2,ushort:2,uchar:1};for(let Br in bt)if(bt.hasOwnProperty(Br)){let Jr=bt[Br].dtype;tr[Br]=Ht,Ht+=rr[Jr]}let sr=(0,No.default)(new Float32Array(ut*3),[ut,3]);Ce$1.assign(sr.pick(null,0),Ut.pick(null,tr.x/4)),Ce$1.assign(sr.pick(null,1),Ut.pick(null,tr.y/4)),Ce$1.assign(sr.pick(null,2),Ut.pick(null,tr.z/4));let ar=(0,No.default)(new Float32Array(ut*3),[ut,3]);Ce$1.assign(ar.pick(null,0),Ut.pick(null,tr.scale_0/4)),Ce$1.assign(ar.pick(null,1),Ut.pick(null,tr.scale_1/4)),Ce$1.assign(ar.pick(null,2),Ut.pick(null,tr.scale_2/4));let cr=(0,No.default)(new Float32Array(ut*3),[ut,3]);Ce$1.assign(cr.pick(null,0),Ut.pick(null,tr.f_dc_0/4)),Ce$1.assign(cr.pick(null,1),Ut.pick(null,tr.f_dc_1/4)),Ce$1.assign(cr.pick(null,2),Ut.pick(null,tr.f_dc_2/4));let Ar=(0,No.default)(new Float32Array(ut*4),[ut,4]);Ce$1.assign(Ar.pick(null,0),Ut.pick(null,tr.rot_1/4)),Ce$1.assign(Ar.pick(null,1),Ut.pick(null,tr.rot_2/4)),Ce$1.assign(Ar.pick(null,2),Ut.pick(null,tr.rot_3/4)),Ce$1.assign(Ar.pick(null,3),Ut.pick(null,tr.rot_0/4));for(let Br=0;Br<ut;Br++){let Jr=Ar.pick(Br,null),mn=Math.sqrt(Jr.get(0)**2+Jr.get(1)**2+Jr.get(2)**2+Jr.get(3)**2);Ce$1.divseq(Jr,mn)}let _r=(0,No.default)(new Float32Array(ut*1),[ut,1]);Ce$1.assign(_r.pick(null,0),Ut.pick(null,tr.opacity/4));let Dr=(Math.min(Math.max(_,0),3)+1)**2-1,$r=[];for(let Br=0;Br<Dr;Br++){let Jr=(0,No.default)(new Float32Array(ut*3),[ut,3]),mn=Br*3;Ce$1.assign(Jr.pick(null,0),Ut.pick(null,tr[`f_rest_${mn}`]/4)),Ce$1.assign(Jr.pick(null,1),Ut.pick(null,tr[`f_rest_${mn+1}`]/4)),Ce$1.assign(Jr.pick(null,2),Ut.pick(null,tr[`f_rest_${mn+2}`]/4)),$r.push(Jr)}return new gr(bt,St,ut,sr,cr,$r,_r,ar,Ar,_)}static async fromPLYFile(rt,_=3){let ut=await gr.loadFile(rt);return gr.fromArrayBuffer(ut,_)}static decodeHeader(rt){let _=new TextDecoder,ut=0,mt="",bt=100;for(;;){if(ut+bt>=rt.byteLength)throw new Error("End of file reached while searching for end of header");let sr=new Uint8Array(rt,ut,bt);mt+=_.decode(sr),ut+=bt;let ar=ut-bt*2,cr=new Uint8Array(rt,Math.max(0,ar),ar>0?bt*2:bt);if(_.decode(cr).includes("end_header"))break}let St=mt.split(`
`),Mt=0,Bt={},Ut=0,Ht;for(let sr=0;sr<St.length;sr++){let ar=St[sr].trim();if(ar.startsWith("element vertex")){let cr=ar.match(/\d+/);cr&&(Mt=parseInt(cr[0]))}else if(ar.startsWith("property")){let cr=ar.match(/(\w+)\s+(\w+)\s+(\w+)/);if(cr){let Ar=cr[2],_r=cr[3];Bt[_r]={dtype:Ar,index:Ut},Ut++}}else if(ar.startsWith("format")){let cr=ar.match(/(\w+)\s+(\w+)\s+(\d+\.?\d*)/);cr&&(Ht={format:cr[2],version:cr[3]})}else if(ar==="end_header")break}let tr=mt.indexOf("end_header")+10+1,rr=new DataView(rt,tr);return{splatCount:Mt,vertexData:rr,headerOffset:ut,propertiesDesc:Bt,format:Ht}}},Xn=class{constructor(rt,_,ut,mt,bt,St,Mt,Bt){this.config=rt,this.xyz=_,this.scaling=ut,this.color=mt,this.opacity=bt,this.harmonics=Mt,this.quaternion=St,this.variableChunkSize=Bt}get isDynamicChunks(){return this.variableChunkSize&&this.variableChunkSize.length>0}get nchunks(){return this.xyz.nchunks}get nsplats(){return this.xyz.length}get chunkSize(){return this.config.chunkSize}static compressFromGaussianData(rt,_){let ut=je.fromArray(rt.xyz,_.xyz,_.chunkSize),mt=je.fromArray(rt.scaling,_.scaling,_.chunkSize),bt=je.fromArray(rt.colors,_.color,_.chunkSize),St=je.fromArray(rt.opacity,_.opacity,_.chunkSize),Mt=je.fromArray(rt.rotation,_.quaternion,_.chunkSize),Bt=rt.harmonics,Ut=[];if(_.harmonics)for(let Ht=0;Ht<Bt.length;Ht++){let tr=je.fromArray(Bt[Ht],_.harmonics,_.chunkSize);Ut.push(tr)}return new Xn(_,ut,mt,bt,St,Mt,Ut)}_countIndexesInChunks(rt){let _=[],ut=this.nchunks,mt=this.chunkSize,bt=this.nsplats,St=je.getRequiredNChunks(bt,mt);if(ut===St)for(let Mt=0;Mt<rt.length;Mt++){let Bt=rt[Mt],Ut=Math.floor(Bt/this.chunkSize);Ut in _?_[Ut].push(Bt):_[Ut]=[Bt]}else{let Mt=this.variableChunkSize,Bt={},Ut=0;for(let Ht=0;Ht<ut;Ht++)Bt[Ht]=Ut,Ut+=Mt[Ht];for(let Ht=0;Ht<rt.length;Ht++){let tr=rt[Ht],rr=Math.min(Math.floor(tr/mt),ut-1);for(;tr>=Bt[rr]+Mt[rr];)rr++;rr in _?_[rr].push(tr):_[rr]=[tr]}}return _}pruneSplats(rt){let _=this._countIndexesInChunks(rt),ut,mt=[];return _.length>0&&(ut=this.variableChunkSize?[...this.variableChunkSize]:Array(this.nchunks).fill(this.chunkSize),_.forEach((bt,St)=>{ut[St]-=bt.length,ut[St]<=0&&mt.push(St)}),ut=ut.filter(bt=>bt>0)),new Xn(this.config,this.xyz.pruneFeature(rt,mt,ut),this.scaling.pruneFeature(rt,mt,ut),this.color.pruneFeature(rt,mt,ut),this.opacity.pruneFeature(rt,mt,ut),this.quaternion.pruneFeature(rt,mt,ut),this.harmonics?this.harmonics.map(bt=>bt.pruneFeature(rt,mt,this.variableChunkSize)):void 0,ut)}static async loadConfig(rt){return await(await fetch(rt,{method:"GET",mode:"cors",headers:{Accept:"application/json"}})).json()}toGaussians(){var bt;let rt={format:"binary_little_endian",version:"1.0"},_={},ut=0;if(_.x={dtype:"float",index:ut},ut++,_.y={dtype:"float",index:ut},ut++,_.z={dtype:"float",index:ut},ut++,_.f_dc_0={dtype:"float",index:ut},ut++,_.f_dc_1={dtype:"float",index:ut},ut++,_.f_dc_2={dtype:"float",index:ut},ut++,this.harmonics&&this.harmonics.length>0)for(let St=0;St<this.harmonics.length;St++)_[`f_rest_${St}`]={dtype:"float",index:ut},ut++,_[`f_rest_${St+1}`]={dtype:"float",index:ut},ut++,_[`f_rest_${St+2}`]={dtype:"float",index:ut},ut++;_.opacity={dtype:"float",index:ut},ut++,_.scale_0={dtype:"float",index:ut},ut++,_.scale_1={dtype:"float",index:ut},ut++,_.scale_2={dtype:"float",index:ut},ut++,_.rot_0={dtype:"float",index:ut},ut++,_.rot_1={dtype:"float",index:ut},ut++,_.rot_2={dtype:"float",index:ut},ut++,_.rot_3={dtype:"float",index:ut},ut++;let mt=(bt=this.harmonics)==null?void 0:bt.map(St=>St.denormDequant());return new gr(_,rt,this.xyz.length,this.xyz.denormDequant(),this.color.denormDequant(),mt||[],this.opacity.denormDequant(),this.scaling.denormDequant(),this.quaternion.denormDequant(),3)}},Kn=Rt(ja()),ct=Rt(Ua()),yv={xyz:3,color:3,opacity:1,scaling:3,quaternion:4,harmonics:3},hn=class{constructor(rt){this._buffer=rt}get buffer(){return this._buffer}get decoded(){return this._decoded||(this._decoded=this.decodeBuffer()),this._decoded}get colorsA(){let rt=.28209479177387814,_=this.decoded.color.denormDequant(),ut=this.decoded.opacity.denormDequant(),mt=(0,Kn.default)(new Float32Array(_.shape[0]*4),[_.shape[0],4]);return ct.mulseq(_,rt),ct.addseq(_,.5),ct.mulseq(_,255),ct.maxseq(_,0),ct.minseq(_,255),ct.negeq(ut),ct.expeq(ut),ct.addseq(ut,1),ct.recipeq(ut),ct.mulseq(ut,255),ct.assign(mt.hi(_.shape[0],3).lo(0,0),_),ct.assign(mt.hi(_.shape[0],4).lo(0,3),ut),(0,Kn.default)(new Uint8Array(mt.data),[_.shape[0],4]).data}get nsplats(){return this.decoded.nsplats}getSplatCount(){return this.decoded.nsplats}get precomputedCovarianceBufferData(){return this._precomputedCovarianceBufferData}decodeBuffer(){let{splatCount:rt,chunkCount:_,chunkSize:ut,typeChunks:mt,vertexData:bt,propertiesDesc:St}=this.decodeHeader(),Mt={xyz:St.xyz.compressionMethod,color:St.color.compressionMethod,opacity:St.opacity.compressionMethod,scaling:St.scaling.compressionMethod,quaternion:St.quaternion.compressionMethod,chunkSize:ut};St.harmonics_0&&(Mt.harmonics=St.harmonics_0.compressionMethod);let Bt=bt.byteOffset,Ut=Array(Object.keys(St).length);for(let _r in St)Ut[St[_r].index]={name:_r,method:St[_r].compressionMethod};let Ht=_*2*4,tr=Bt,rr=mt==="dynamic"?_*2:0,sr,ar=!1;if(rr>0){let _r=new Uint16Array(bt.buffer.slice(tr,tr+rr));tr+=rr,sr=Array.from(_r),ar=!0}let cr={};for(let _r of Ut){let Dr=0,$r=!0;if(_r.method==="norm8x")Dr=rt*1*yv[_r.name];else if(_r.method==="norm11")Dr=rt*4;else if(_r.method==="norm565")Dr=rt*2;else throw $r=!1,new Error(`Not Implemented format: ${_r.method}`);let Br;if($r){let Mn=bt.buffer.slice(tr,tr+Ht);Br=(0,Kn.default)(new Float32Array(Mn),[_,2]),tr+=Ht}else throw new Error("loading chunk byt hasnot minmax!");let Jr=bt.buffer.slice(tr,tr+Dr);tr+=Dr;let mn;if(_r.method==="norm8x")mn=(0,Kn.default)(new Uint8Array(Jr),[rt,yv[_r.name]]);else if(_r.method==="norm11")mn=(0,Kn.default)(new Uint32Array(Jr));else if(_r.method==="norm565")mn=(0,Kn.default)(new Uint16Array(Jr));else throw new Error(`Not Implemented format: ${_r.method}`);cr[_r.name]=new je(mn,Br,ut,_r.method,sr,ar)}let Ar=[];for(let _r=0;_r<15;_r++){let Dr=cr[`harmonics_${_r}`];Dr&&(Ar.push(Dr),delete cr[`harmonics_${_r}`])}return Ar.length>0&&(cr.harmonics=Ar),new Xn(Mt,cr.xyz,cr.scaling,cr.color,cr.opacity,cr.quaternion,cr.harmonics,sr)}buildPreComputedBuffers(){let rt=this.decoded,_=rt.nsplats,ut=new ArrayBuffer(24*_),mt=new Float32Array(ut),bt=rt.scaling.denormDequant(),St=rt.quaternion.denormDequant(),Mt=new Quaternion,Bt=new Matrix3,Ut=new Matrix3,Ht=new Matrix3,tr=new Matrix4;for(let rr=0;rr<_;rr++){tr.makeScale(Math.exp(bt.get(rr,0)),Math.exp(bt.get(rr,1)),Math.exp(bt.get(rr,2))),Ut.setFromMatrix4(tr),Mt.set(St.get(rr,0),St.get(rr,1),St.get(rr,2),St.get(rr,3)),tr.makeRotationFromQuaternion(Mt),Bt.setFromMatrix4(tr),Ht.copy(Bt).multiply(Ut);let sr=Ht.elements;mt[6*rr]=sr[0]*sr[0]+sr[3]*sr[3]+sr[6]*sr[6],mt[6*rr+1]=sr[0]*sr[1]+sr[3]*sr[4]+sr[6]*sr[7],mt[6*rr+2]=sr[0]*sr[2]+sr[3]*sr[5]+sr[6]*sr[8],mt[6*rr+3]=sr[1]*sr[1]+sr[4]*sr[4]+sr[7]*sr[7],mt[6*rr+4]=sr[1]*sr[2]+sr[4]*sr[5]+sr[7]*sr[8],mt[6*rr+5]=sr[2]*sr[2]+sr[5]*sr[5]+sr[8]*sr[8]}this._precomputedCovarianceBufferData=ut}decodeHeader(){let rt=this._buffer,_=new TextDecoder,ut=0,mt="",bt=100;for(;;){if(ut+bt>=rt.byteLength)throw new Error("End of file reached while searching for end of header");let cr=new Uint8Array(rt,ut,bt);mt+=_.decode(cr),ut+=bt;let Ar=ut-bt*2,_r=new Uint8Array(rt,Math.max(0,Ar),Ar>=0?bt*2:bt);if(_.decode(_r).includes("end_header"))break}let St=mt.split(`
`),Mt=0,Bt=0,Ut=0,Ht=0,tr="",rr={};for(let cr=0;cr<St.length;cr++){let Ar=St[cr].trim();if(Ar.startsWith("element vertex")){let _r=Ar.match(/\d+/);_r&&(Mt=parseInt(_r[0]))}else if(Ar.startsWith("property")){let _r=Ar.match(/(\w+)\s+(\w+)\s+(\w+)/);if(_r){let Dr=_r[2],$r=_r[3];rr[Dr]={compressionMethod:$r,index:Ht},Ht++}}else if(Ar.startsWith("element chunks")){let _r=Ar.match(/\d+/);_r&&(Bt=parseInt(_r[0]))}else if(Ar.startsWith("element chunkSize")){let _r=Ar.match(/\d+/);_r&&(Ut=parseInt(_r[0]))}else if(Ar.startsWith("element typeChunks")){let _r=Ar.match(/(\w+)\s+(\w+)\s+(\w+)/);_r&&(tr=_r[3])}else if(Ar==="end_header")break}let sr=mt.indexOf("end_header")+10+1,ar=new DataView(rt,sr);return{splatCount:Mt,chunkCount:Bt,chunkSize:Ut,typeChunks:tr,vertexData:ar,propertiesDesc:rr}}pruneSplats(rt){let _=this.decodeBuffer().pruneSplats(rt);return hn.fromCompressedGaussianSplats(_)}static fromCompressedGaussianSplats(rt){let _=rt.xyz.length,ut=rt.xyz.nchunks,mt=`gspline
element vertex ${_}
element chunks ${ut}
element chunkSize ${rt.chunkSize}
element typeChunks ${rt.isDynamicChunks?"dynamic":"static"}
property xyz ${rt.xyz.method}
property color ${rt.color.method}
property opacity ${rt.opacity.method}
property scaling ${rt.scaling.method}
property quaternion ${rt.quaternion.method}`;if(rt.harmonics&&rt.harmonics.length>0)for(let $n=0;$n<rt.harmonics.length;$n++)mt=`${mt}
property harmonics_${$n} ${rt.harmonics[$n].method}`;mt=`${mt}
end_header
`;let bt=new TextEncoder().encode(mt),St=ut*2*4,Mt=rt.xyz.quantized.data.buffer.byteLength,Bt=rt.xyz instanceof je?St:0,Ut=rt.color.quantized.data.buffer.byteLength,Ht=rt.color instanceof je?St:0,tr=rt.opacity.quantized.data.buffer.byteLength,rr=rt.opacity instanceof je?St:0,sr=rt.scaling.quantized.data.buffer.byteLength,ar=rt.scaling instanceof je?St:0,cr=rt.quaternion.quantized.data.buffer.byteLength,Ar=rt.quaternion instanceof je?St:0,_r=rt.variableChunkSize?Uint16Array.from(rt.variableChunkSize):void 0,Dr=_r?_r.byteLength:0,$r=bt.byteLength+Dr+Mt+Bt+Ut+Ht+tr+rr+sr+ar+cr+Ar,Br=0,Jr=0;if(rt.harmonics&&rt.harmonics.length>0)for(let $n=0;$n<rt.harmonics.length;$n++)Br+=rt.harmonics[$n].quantized.data.buffer.byteLength,Jr+=rt.harmonics[$n]instanceof je?St:0;Br=0,Jr=0,$r+=Br+Jr;let mn=new Uint8Array($r),Mn=0;if(mn.set(bt,Mn),Mn+=bt.byteLength,Dr>0&&(mn.set(new Uint8Array(_r.buffer),Mn),Mn+=Dr),rt.xyz instanceof je&&(mn.set(new Uint8Array(rt.xyz.minmaxMatrix.data.buffer),Mn),Mn+=St),mn.set(new Uint8Array(rt.xyz.quantized.data.buffer),Mn),Mn+=Mt,rt.color instanceof je&&(mn.set(new Uint8Array(rt.color.minmaxMatrix.data.buffer),Mn),Mn+=St),mn.set(new Uint8Array(rt.color.quantized.data.buffer),Mn),Mn+=Ut,rt.opacity instanceof je&&(mn.set(new Uint8Array(rt.opacity.minmaxMatrix.data.buffer),Mn),Mn+=St),mn.set(new Uint8Array(rt.opacity.quantized.data.buffer),Mn),Mn+=tr,rt.scaling instanceof je&&(mn.set(new Uint8Array(rt.scaling.minmaxMatrix.data.buffer),Mn),Mn+=St),mn.set(new Uint8Array(rt.scaling.quantized.data.buffer),Mn),Mn+=sr,rt.quaternion instanceof je&&(mn.set(new Uint8Array(rt.quaternion.minmaxMatrix.data.buffer),Mn),Mn+=St),mn.set(new Uint8Array(rt.quaternion.quantized.data.buffer),Mn),Mn+=cr,Br>0&&rt.harmonics&&rt.harmonics.length>0)for(let $n=0;$n<rt.harmonics.length;$n++){let en=rt.harmonics[$n];en instanceof je&&(mn.set(new Uint8Array(en.minmaxMatrix.data.buffer),Mn),Mn+=St),mn.set(new Uint8Array(en.quantized.data.buffer),Mn),Mn+=en.quantized.data.byteLength}return new hn(mn.buffer)}},gv="AGFzbQEAAAAADwhkeWxpbmsuMAEEAAAAAAETA2AAAGAIf39/f39/f38AYAABfwISAQNlbnYGbWVtb3J5AgMAgIAEAwQDAAECBzkDEV9fd2FzbV9jYWxsX2N0b3JzAAALc29ydEluZGV4ZXMAARNlbXNjcmlwdGVuX3Rsc19pbml0AAIK3gMDAwABC9IDAwF/BnwBfgJAIAdFDQAgAysDUCEMIAMrAzAhDSADKwMQIQ5BACEDRP///////+9/IQtEAAAAAAAAEAAhCgNAIAIgA0ECdGoCfyAOIAEgA0EMbGoiCCoCALuiIA0gCCoCBLuioCAMIAgqAgi7oqBEAAAAAAAAsECiIgmZRAAAAAAAAOBBYwRAIAmqDAELQYCAgIB4CzYCACAJIAsgCSALYxshCyAJIAogCSAKZBshCiADQQFqIgMgB0cNAAsgB0UNACAGuCAKIAuhoyEJQQAhAwNAAn8gCSACIANBAnRqIgEoAgC3IAuhoiIKmUQAAAAAAADgQWMEQCAKqgwBC0GAgICAeAshCCABIAg2AgAgBCAIQQJ0aiIBIAEoAgBBAWo2AgAgA0EBaiIDIAdHDQALCyAGQQJPBEAgBCgCACEIQQEhAwNAIAQgA0ECdGoiASABKAIAIAhqIgg2AgAgA0EBaiIDIAZHDQALCyAHQQFrIgGtIQ8DQCAEIAIgD6dBAnQiA2ooAgBBAnRqIgcgBygCAEEBayIHNgIAIAUgASAHa0ECdGogACADaigCADYCACAPUCEDIA9CAX0hDyADRQ0ACyAGBEAgBEEAIAZBAnT8CwALCwQAQQAL",co=class{};yt(co,"DepthMapRange",65536),yt(co,"MemoryPageSize",65536),yt(co,"BytesPerFloat",4),yt(co,"BytesPerInt",4);function jI(rt){let _,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr,Ar,_r;function Dr(qn){let Qn=new Float64Array(tr,Mt,16);for(let cs=0;cs<16;cs++)Qn[cs]=qn[cs];let xs;if(mt>1){_.exports.sortIndexes(bt,St,Ht,Mt,Bt,Ut,sr.DepthMapRange,mt);let cs=new Uint32Array(mt);xs=cs.buffer,cs.set(new Uint32Array(tr,Ut,mt))}else if(mt===1){let cs=new Uint32Array(mt);cs[0]=new Uint32Array(tr,bt,ut)[0],xs=cs.buffer}else xs=new ArrayBuffer(0);rt.postMessage({sortDone:!0,indexesBuffer:xs},[xs])}function $r(qn,Qn,xs){let cs=new Float32Array(tr,St,ut*3);mt=0;let ks=new Uint32Array(tr,bt,ut);for(let _o=0;_o<xs.length-1;_o++){let qs=Qn[_o],Ss=qn[_o].elements,eo=qs.filter(Oo=>Oo.enabled&&Oo.mode==="Include").map(Oo=>Oo.type==="Box"?Mn(Oo):In(Oo)),Ao=qs.filter(Oo=>Oo.enabled&&Oo.mode==="Exclude").map(Oo=>Oo.type==="Box"?Mn(Oo):In(Oo));for(let Oo=xs[_o];Oo<xs[_o+1];Oo++){let uo=ar[Oo*3],uu=ar[Oo*3+1],cu=ar[Oo*3+2];if((eo.length===0||Jr(uo,uu,cu,eo))&&(Ao.length===0||!Jr(uo,uu,cu,Ao))){let Jl=1/(Ss[3]*uo+Ss[7]*uu+Ss[11]*cu+Ss[15]);cs[mt*3]=(Ss[0]*uo+Ss[4]*uu+Ss[8]*cu+Ss[12])*Jl,cs[mt*3+1]=(Ss[1]*uo+Ss[5]*uu+Ss[9]*cu+Ss[13])*Jl,cs[mt*3+2]=(Ss[2]*uo+Ss[6]*uu+Ss[10]*cu+Ss[14])*Jl,ks[mt]=Oo,mt++}}}}function Br(qn,Qn){let xs=[],cs=Qn.filter(qs=>qs.enabled&&qs.mode==="Include").map(qs=>qs.type==="Box"?Mn(qs):In(qs)),ks=Qn.filter(qs=>qs.enabled&&qs.mode==="Exclude").map(qs=>qs.type==="Box"?Mn(qs):In(qs)),_o=qn.length;for(let qs=0;qs<_o;qs+=3){let Ss=qn[qs],eo=qn[qs+1],Ao=qn[qs+2];(cs.length===0||Jr(Ss,eo,Ao,cs))&&(ks.length===0||!Jr(Ss,eo,Ao,ks))||xs.push(qs/3)}return console.log(xs),xs}function Jr(qn,Qn,xs,cs,ks){return cs.some(_o=>{let qs=mn(qn,Qn,xs,_o.invRotationMatrix,_o.cropCenter);return Array.isArray(_o)?en(qs.x,qs.y,qs.z,_o):Rn(qs.x,qs.y,qs.z,_o)})}function mn(qn,Qn,xs,cs,ks){let _o=qn-ks[0],qs=Qn-ks[1],Ss=xs-ks[2],eo=1/(cs[3]*_o+cs[7]*qs+cs[11]*Ss+cs[15]);return{x:(cs[0]*_o+cs[4]*qs+cs[8]*Ss+cs[12])*eo+ks[0],y:(cs[1]*_o+cs[5]*qs+cs[9]*Ss+cs[13])*eo+ks[1],z:(cs[2]*_o+cs[6]*qs+cs[10]*Ss+cs[14])*eo+ks[2]}}function Mn(qn){let Qn=qn.cropSize[0]/2,xs=qn.cropSize[1]/2,cs=qn.cropSize[2]/2,ks=[qn.cropCenter[0]-Qn,qn.cropCenter[1]-xs,qn.cropCenter[2]-cs,qn.cropCenter[0]+Qn,qn.cropCenter[1]+xs,qn.cropCenter[2]+cs],_o=$n(qn.cropRotation);return Object.assign(ks,{invRotationMatrix:_o,cropCenter:qn.cropCenter})}function $n(qn){let Qn=[],xs=qn[0]*Math.PI/180,cs=qn[1]*Math.PI/180,ks=qn[2]*Math.PI/180,_o=Math.cos(xs),qs=Math.sin(xs),Ss=Math.cos(cs),eo=Math.sin(cs),Ao=Math.cos(ks),Oo=Math.sin(ks),uo=_o*Ao,uu=_o*Oo,cu=qs*Ao,Jl=qs*Oo;return Qn[0]=Ss*Ao,Qn[1]=-Ss*Oo,Qn[2]=eo,Qn[4]=uu+cu*eo,Qn[5]=uo-Jl*eo,Qn[6]=-qs*Ss,Qn[8]=Jl-uo*eo,Qn[9]=cu+uu*eo,Qn[10]=_o*Ss,Qn[12]=0,Qn[13]=0,Qn[14]=0,Qn[3]=0,Qn[7]=0,Qn[11]=0,Qn[15]=1,Qn}function en(qn,Qn,xs,cs){return qn>=cs[0]&&qn<=cs[3]&&Qn>=cs[1]&&Qn<=cs[4]&&xs>=cs[2]&&xs<=cs[5]}function In(qn){let Qn=2/qn.cropSize[0],xs=2/qn.cropSize[1],cs=2/qn.cropSize[2],ks=$n(qn.cropRotation);return{invRadiusX:Qn,invRadiusY:xs,invRadiusZ:cs,cropCenter:qn.cropCenter,invRotationMatrix:ks}}function Rn(qn,Qn,xs,cs){let ks=(qn-cs.cropCenter[0])*cs.invRadiusX,_o=(Qn-cs.cropCenter[1])*cs.invRadiusY,qs=(xs-cs.cropCenter[2])*cs.invRadiusZ;return ks*ks+_o*_o+qs*qs<=1}rt.onmessage=qn=>{if(qn.data.getCroppedIndexes){let Qn=new Uint32Array(Br(new Float32Array(qn.data.positions),qn.data.crops)).buffer;rt.postMessage({outOfBoundsIndexes:Qn},[Qn])}else if(qn.data.positions)rr=qn.data.positions,ar=new Float32Array(rr),Ar=qn.data.meshMatrixWorlds,_r=qn.data.cropsArray,cr=qn.data.meshIndexIntervals,$r(Ar,_r,cr),rt.postMessage({sortSetupComplete:!0});else if(qn.data.sort||qn.data.newMatrixWorlds||qn.data.newCropsArray)(qn.data.newMatrixWorlds||qn.data.newCropsArray)&&(_r=qn.data.newCropsArray||_r,Ar=qn.data.newMatrixWorlds||Ar,$r(Ar,_r,cr)),Dr(qn.data.sort.view,qn.data.sort.cameraPosition);else if(qn.data.init){sr=qn.data.init.Constants,ut=qn.data.init.splatCount;let Qn=sr.BytesPerInt,xs=sr.BytesPerFloat*3,cs=new Uint8Array(qn.data.init.sorterWasmBytes),ks=Qn+xs,_o=ut*ks,qs=ut*sr.BytesPerInt*2+sr.DepthMapRange*sr.BytesPerInt*2,Ss=sr.MemoryPageSize*32,eo=_o+qs+Ss,Ao=Math.floor(eo/sr.MemoryPageSize)+1,Oo={module:{},env:{memory:new WebAssembly.Memory({initial:Ao*2,maximum:Ao*3,shared:!0})}};WebAssembly.compile(cs).then(uo=>WebAssembly.instantiate(uo,Oo)).then(uo=>{_=uo,bt=0,St=ut*Qn,Mt=St+ut*xs,Ht=Mt+16*sr.BytesPerFloat*2,Bt=Ht+ut*sr.BytesPerInt,Ut=Bt+sr.DepthMapRange*sr.BytesPerInt,tr=Oo.env.memory.buffer,rt.postMessage({sortSetupPhase1Complete:!0})})}}}function xv(rt){let _=new Worker(URL.createObjectURL(new Blob(["(",jI.toString(),")(self)"],{type:"application/javascript"}))),ut=atob(gv),mt=new Uint8Array(ut.length);for(let bt=0;bt<ut.length;bt++)mt[bt]=ut.charCodeAt(bt);return _.postMessage({init:{sorterWasmBytes:mt.buffer,splatCount:rt,Constants:{BytesPerFloat:co.BytesPerFloat,BytesPerInt:co.BytesPerInt,DepthMapRange:co.DepthMapRange,MemoryPageSize:co.MemoryPageSize}}}),_}var du=function(){let rt=new Float32Array(1),_=new Int32Array(rt.buffer);return function(ut){return rt[0]=ut,_[0]}}(),vv=function(rt,_,ut,mt){return rt+(_<<8)+(ut<<16)+(mt<<24)},fu=new Vector2,yn=class extends Mesh{constructor(rt,_,ut,mt,bt=!1,St=1,Mt,Bt){super(ut,mt),this.splatCount=_,this.meshIndexIntervals=Mt,this.meshMatrixWorlds=Bt,this.splatBuffers=rt,this.geometry=ut,this.material=mt,this.splatDataTextures=null,this.halfPrecisionCovariancesOnGPU=bt,this.devicePixelRatio=St,this.resetLocalSplatDataAndTexturesFromSplatBuffer()}static buildMesh(rt,_,ut=!1,mt=1,bt,St){let Mt=yn.buildGeomtery(_),Bt=yn.buildMaterial(bt);return new yn(rt,_,Mt,Bt,ut,mt,bt,St)}static buildMaterial(rt){let _=`
            precision highp float;
            #include <common>

            attribute uint splatIndex;

            uniform highp sampler2D covariancesTexture;
            uniform highp usampler2D centersColorsTexture;
            uniform vec2 focal;
            uniform vec2 viewport;
            uniform vec2 basisViewport;
            uniform vec2 covariancesTextureSize;
            uniform vec2 centersColorsTextureSize;
						uniform highp sampler2D meshMatrixWorldsTexture;
						uniform uint meshIndexIntervals[257];
						uniform float orthoZoom;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;

            const vec4 encodeNorm4 = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0);
            const uvec4 mask4 = uvec4(uint(0x000000FF), uint(0x0000FF00), uint(0x00FF0000), uint(0xFF000000));
            const uvec4 shift4 = uvec4(0, 8, 16, 24);
            vec4 uintToRGBAVec (uint u) {
               uvec4 urgba = mask4 & u;
               urgba = urgba >> shift4;
               vec4 rgba = vec4(urgba) * encodeNorm4;
               return rgba;
            }

            vec2 getDataUV(in int stride, in int offset, in vec2 dimensions) {
                vec2 samplerUV = vec2(0.0, 0.0);
                float d = float(splatIndex * uint(stride) + uint(offset)) / dimensions.x;
                samplerUV.y = float(floor(d)) / dimensions.y;
                samplerUV.x = fract(d);
                return samplerUV;
            }

            void main () {
                uvec4 sampledCenterColor = texture(centersColorsTexture, getDataUV(1, 0, centersColorsTextureSize));
                vec3 splatCenter = uintBitsToFloat(uvec3(sampledCenterColor.gba));
                vColor = uintToRGBAVec(sampledCenterColor.r);

                vPosition = position.xy * 2.0;

								uint meshIndex;
								for (int i = 1; i < 257; i++) {
									if (splatIndex < meshIndexIntervals[i]) {
										meshIndex = uint(i - 1);
										break;
									}
								}

								float strideMulmeshIndex = float(4u*meshIndex);
								float meshMatrixWorldsTextureLength = float(256*4);

								mat4 modelMat = mat4(
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+0.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+1.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+2.0)/meshMatrixWorldsTextureLength, 0)),
									texture(meshMatrixWorldsTexture, vec2((strideMulmeshIndex+3.0)/meshMatrixWorldsTextureLength, 0))
								);
								mat4 modelViewMat = viewMatrix * modelMat;
								vec4 viewCenter = modelViewMat * vec4(splatCenter, 1.0); 
                vec4 clipCenter = projectionMatrix * viewCenter;

                vec2 sampledCovarianceA = texture(covariancesTexture, getDataUV(3, 0, covariancesTextureSize)).rg;
                vec2 sampledCovarianceB = texture(covariancesTexture, getDataUV(3, 1, covariancesTextureSize)).rg;
                vec2 sampledCovarianceC = texture(covariancesTexture, getDataUV(3, 2, covariancesTextureSize)).rg;

                vec3 cov3D_M11_M12_M13 = vec3(sampledCovarianceA.rg, sampledCovarianceB.r);
                vec3 cov3D_M22_M23_M33 = vec3(sampledCovarianceB.g, sampledCovarianceC.rg);

                // Compute the 2D covariance matrix from the upper-right portion of the 3D covariance matrix
                mat3 Vrk = mat3(
                    cov3D_M11_M12_M13.x, cov3D_M11_M12_M13.y, cov3D_M11_M12_M13.z,
                    cov3D_M11_M12_M13.y, cov3D_M22_M23_M33.x, cov3D_M22_M23_M33.y,
                    cov3D_M11_M12_M13.z, cov3D_M22_M23_M33.y, cov3D_M22_M23_M33.z
                );
                float s = 1.0 / (viewCenter.z * viewCenter.z);

                mat3 W = transpose(mat3(modelViewMat));
                mat3 T = orthoZoom > 0.0 ? W : W * mat3(
									focal.x / viewCenter.z, 0., -(focal.x * viewCenter.x) * s,
									0., focal.y / viewCenter.z, -(focal.y * viewCenter.y) * s,
									0., 0., 0.
								);
                mat3 cov2Dm = transpose(T) * Vrk * T;
                cov2Dm[0][0] += 0.3;
                cov2Dm[1][1] += 0.3;

                // We are interested in the upper-left 2x2 portion of the projected 3D covariance matrix because
                // we only care about the X and Y values. We want the X-diagonal, cov2Dm[0][0],
                // the Y-diagonal, cov2Dm[1][1], and the correlation between the two cov2Dm[0][1]. We don't
                // need cov2Dm[1][0] because it is a symetric matrix.
                vec3 cov2Dv = vec3(cov2Dm[0][0], cov2Dm[0][1], cov2Dm[1][1]);

                vec3 ndcCenter = clipCenter.xyz / clipCenter.w;

                // We now need to solve for the eigen-values and eigen vectors of the 2D covariance matrix
                // so that we can determine the 2D basis for the splat. This is done using the method described
                // here: https://people.math.harvard.edu/~knill/teaching/math21b2004/exhibits/2dmatrices/index.html
                //
                // This is a different approach than in the original work at INRIA. In that work they compute the
                // max extents of the 2D covariance matrix in screen space to form an axis aligned bounding rectangle
                // which forms the geometry that is actually rasterized. They then use the inverse 2D covariance
                // matrix (called 'conic') to determine fragment opacity.
                float a = cov2Dv.x;
                float d = cov2Dv.z;
                float b = cov2Dv.y;
                float D = a * d - b * b;
                float trace = a + d;
                float traceOver2 = 0.5 * trace;
                float term2 = sqrt(trace * trace / 4.0 - D);
                float eigenValue1 = traceOver2 + term2;
								float eigenValue2 = max(traceOver2 - term2, 0.00); // prevent negative eigen value

                const float maxSplatSize = 1024.0;
                vec2 eigenVector1 = normalize(vec2(b, eigenValue1 - a));
                // since the eigen vectors are orthogonal, we derive the second one from the first
                vec2 eigenVector2 = vec2(eigenVector1.y, -eigenVector1.x);
                vec2 basisVector1 = eigenVector1 * min(sqrt(2.0 * eigenValue1), maxSplatSize);
                vec2 basisVector2 = eigenVector2 * min(sqrt(2.0 * eigenValue2), maxSplatSize);

                vec2 ndcOffset = vec2(vPosition.x * basisVector1 + vPosition.y * basisVector2) * basisViewport;

								if (orthoZoom > 0.0) {
									ndcOffset *= orthoZoom;
								}

                gl_Position = vec4(ndcCenter.xy + ndcOffset, ndcCenter.z, 1.0);
            }`,ut=`
            precision highp float;
            #include <common>

            uniform vec3 debugColor;

            varying vec4 vColor;
            varying vec2 vUv;

            varying vec2 vPosition;
						layout(location = 1) out vec4 gVelocity; 

            void main () {
                // compute the negative squared distance from the center of the splat to the
                // current fragment in the splat's local space.
                float A = -dot(vPosition, vPosition);
                if (A < -4.0) discard;
                vec3 color = vColor.rgb;
                A = exp(A) * vColor.a;
                gl_FragColor = vec4(color.rgb, A);
								gVelocity = vec4(0.0); // so it is ignored by TAA
            }`,mt={covariancesTexture:{type:"t",value:null},centersColorsTexture:{type:"t",value:null},meshIndexIntervals:{value:rt},meshMatrixWorldsTexture:{type:"t",value:null},focal:{type:"v2",value:new Vector2},viewport:{type:"v2",value:new Vector2},basisViewport:{type:"v2",value:new Vector2},debugColor:{type:"v3",value:new Color$1},covariancesTextureSize:{type:"v2",value:new Vector2(1024,1024)},centersColorsTextureSize:{type:"v2",value:new Vector2(1024,1024)},orthoZoom:{type:"f",value:-1}};return new ShaderMaterial({uniforms:mt,vertexShader:_,fragmentShader:ut,transparent:!0,alphaTest:1,blending:NormalBlending,depthTest:!0,depthWrite:!1,side:DoubleSide})}static buildGeomtery(rt){let _=new BufferGeometry;_.setIndex([0,1,2,0,2,3]);let ut=new Float32Array(4*3),mt=new BufferAttribute(ut,3);_.setAttribute("position",mt),mt.setXYZ(0,-1,-1,0),mt.setXYZ(1,-1,1,0),mt.setXYZ(2,1,1,0),mt.setXYZ(3,1,-1,0),mt.needsUpdate=!0;let bt=new InstancedBufferGeometry().copy(_),St=new Uint32Array(rt),Mt=new InstancedBufferAttribute(St,1,!1);return Mt.setUsage(DynamicDrawUsage),bt.setAttribute("splatIndex",Mt),bt.instanceCount=rt,bt}resetLocalSplatDataAndTexturesFromSplatBuffer(){this.updateLocalSplatDataFromSplatBuffer(),this.allocateAndStoreLocalSplatDataInTextures()}updateLocalSplatDataFromSplatBuffer(){this.splatBuffers.forEach(mt=>mt.buildPreComputedBuffers()),this.covariances=new Float32Array(this.splatCount*6),this.colors=new Uint8Array(this.splatCount*4),this.centers=new Float32Array(this.splatCount*3);let rt=0,_=0,ut=0;for(let mt of this.splatBuffers){let bt=mt.nsplats;this.colors.subarray(rt,rt+bt*4).set(mt.colorsA),rt+=bt*4,this.centers.subarray(_,_+bt*3).set(mt.decoded.xyz.denormDequant().data),_+=bt*3,this.covariances.subarray(ut,ut+bt*6).set(new Float32Array(mt.precomputedCovarianceBufferData)),ut+=bt*6}}allocateAndStoreLocalSplatDataInTextures(){let rt=this.splatCount,_=new Vector2(4096,1024);for(;_.x*_.y*2<rt*6;)_.y*=2;let ut=new Vector2(4096,1024);for(;ut.x*ut.y*4<rt*4;)ut.y*=2;let mt,bt;if(this.halfPrecisionCovariancesOnGPU){bt=new Uint16Array(_.x*_.y*2);for(let tr=0;tr<this.covariances.length;tr++)bt[tr]=DataUtils.toHalfFloat(this.covariances[tr]);mt=new DataTexture(bt,_.x,_.y,RGFormat,HalfFloatType)}else bt=new Float32Array(_.x*_.y*2),bt.set(this.covariances),mt=new DataTexture(bt,_.x,_.y,RGFormat,FloatType);mt.needsUpdate=!0,this.material.uniforms.covariancesTexture.value=mt,this.material.uniforms.covariancesTextureSize.value.copy(_);let St=new Uint32Array(ut.x*ut.y*4);for(let tr=0;tr<rt;tr++){let rr=tr*4,sr=tr*3,ar=tr*4;St[ar]=vv(this.colors[rr],this.colors[rr+1],this.colors[rr+2],this.colors[rr+3]),St[ar+1]=du(this.centers[sr]),St[ar+2]=du(this.centers[sr+1]),St[ar+3]=du(this.centers[sr+2])}let Mt=new DataTexture(St,ut.x,ut.y,RGBAIntegerFormat,UnsignedIntType);Mt.internalFormat="RGBA32UI",Mt.needsUpdate=!0,this.material.uniforms.centersColorsTexture.value=Mt,this.material.uniforms.centersColorsTextureSize.value.copy(ut);let Bt=256*4,Ut=new Float32Array(256*16);for(let tr=0;tr<this.meshMatrixWorlds.length;tr++)Ut.set(this.meshMatrixWorlds[tr].elements,tr*16);let Ht=new DataTexture(Ut,Bt,1,RGBAFormat,FloatType);Ht.needsUpdate=!0,this.material.uniforms.meshMatrixWorldsTexture.value=Ht,this.material.uniformsNeedUpdate=!0,this.splatDataTextures={covariances:{data:bt,texture:mt,size:_},centerColors:{data:St,texture:Mt,size:ut},meshMatrixWorlds:{data:Ut,texture:Ht}}}updateIndexes(rt){let _=this.geometry;_.attributes.splatIndex.set(rt),_.attributes.splatIndex.needsUpdate=!0,_.instanceCount=rt.length}updateUniforms(rt,_,ut,mt){this.splatCount>0&&(fu.set(rt.x*this.devicePixelRatio,rt.y*this.devicePixelRatio),this.material.uniforms.viewport.value.copy(fu),this.material.uniforms.basisViewport.value.set(2/fu.x,2/fu.y),this.material.uniforms.focal.value.set(_,ut),this.material.uniforms.orthoZoom.value=mt,this.material.uniformsNeedUpdate=!0)}getSplatDataTextures(){return this.splatDataTextures}getSplatCount(){return this.splatCount}getCenters(){return this.centers}getColors(){return this.colors}getCovariances(){return this.covariances}dispose(){this.geometry.dispose(),this.material.dispose(),this.splatDataTextures&&(this.splatDataTextures.covariances.texture.dispose(),this.splatDataTextures.centerColors.texture.dispose(),this.splatDataTextures.meshMatrixWorlds.texture.dispose())}},Hs=class{constructor(rt={}){yt(this,"updateSplatMeshUniforms",function(){let _=new Vector2;return function(){this.splatMesh!==null&&this.splatMesh.getSplatCount()>0&&(this.renderer.getSize(_),this.cameraFocalLengthX=this.camera.projectionMatrix.elements[0]*this.devicePixelRatio*_.x*.45,this.cameraFocalLengthY=this.camera.projectionMatrix.elements[5]*this.devicePixelRatio*_.y*.45,this.splatMesh.updateUniforms(_,this.cameraFocalLengthX,this.cameraFocalLengthY,this.camera.isPerspectiveCamera?-1:this.camera.zoom*this.devicePixelRatio))}}()),yt(this,"updateView",function(){let _=new Matrix4,ut=[],mt=new Vector3(0,0,-1),bt=new Vector3(0,0,-1),St=new Vector3,Mt=new Vector3;return function(Bt=!1){let Ut=this.updateMatrixWorldsInWorkerIfNeeded(),Ht=this.cropsChanged();if(!Bt){bt.set(0,0,-1).applyQuaternion(this.camera.quaternion);let rr=!1,sr=!1;if(bt.dot(mt)<=.95&&(rr=!0),Mt.copy(this.camera.position).sub(St).length()>=1&&(sr=!0),!rr&&!sr&&!Ut&&!Ht)return}St.copy(this.camera.position),mt.copy(bt),_.copy(this.camera.matrixWorld).invert(),_.premultiply(this.camera.perspCamera.projectionMatrix),ut[0]=this.camera.position.x,ut[1]=this.camera.position.y,ut[2]=this.camera.position.z;let tr={sort:{view:_.elements,cameraPosition:ut,splatRenderCount:this.splatRenderCount,splatSortCount:this.splatRenderCount},...Ut?{newMatrixWorlds:this.meshMatrixWorlds}:{},...Ht?{newCropsArray:this.cropsArray}:{}};this.sortRunning?this.queuedMessage=tr:(this.queuedMessage=null,this.sortRunning=!0,this.sortWorker.postMessage(tr))}}()),this.scene=rt.scene,this.currentPage=null,this.renderer=rt.renderer,this.devicePixelRatio=window.devicePixelRatio,this.sortWorker=null,this.splatRenderCount=0,this.splatSortCount=0,this.splatMesh=null,this.sortRunning=!1,this.splatRenderingInitialized=!1,this.meshMatrixWorlds=null,this.meshMatrixWorldsOld=null,this.cropsArray=null,this.splatEntries=null,this.queuedMessage=null}get camera(){return this.scene.activeCamera}reloadSplats(){this.splatRenderingInitialized=!1;let rt=this.loadSplat();this.renderer.pipeline.opaquePass.splatViewer=rt?this:null}loadSplat(rt={}){this.activePage=this.scene.activePage,rt.position&&(rt.position=new Vector3().fromArray(rt.position)),rt.orientation&&(rt.orientation=new Quaternion().fromArray(rt.orientation)),rt.halfPrecisionCovariances=!!rt.halfPrecisionCovariances;let _=[];if(this.splatEntries=_,this.activePage.traverseEntity(St=>{if(St.data.type==="Splat"){let Mt=St.visible;St.traverseAncestors(Bt=>{Mt&&(Mt=Bt.visible)}),Mt&&_.push(St)}}),this.splatMesh&&this.splatMesh.dispose(),_.length===0)return this.splatMesh=null,!1;this.meshMatrixWorlds=_.map(St=>St.matrixWorld),this.meshMatrixWorldsOld=_.map(St=>St.matrixWorld.clone()),this.cropsArray=_.map(St=>St.data.crops.map(Mt=>Mt.data));let ut=_.map(St=>new hn(new Uint8Array(St.data.buffer).buffer)),mt=0,bt=[0];for(let St of ut)mt+=St.getSplatCount(),bt.push(mt);return this.setupSplatMesh(ut,mt,rt.position,rt.orientation,rt.halfPrecisionCovariances,this.devicePixelRatio,bt,this.meshMatrixWorlds),this.setupSortWorker(mt),!0}updateMatrixWorldsInWorkerIfNeeded(){let rt=this.splatDataTextures.meshMatrixWorlds.data;for(let _=0;_<this.meshMatrixWorlds.length;_++)rt.set(this.meshMatrixWorlds[_].elements,_*16);return this.splatDataTextures.meshMatrixWorlds.texture.needsUpdate=!0,this.meshMatrixWorlds.every((_,ut)=>_.equals(this.meshMatrixWorldsOld[ut]))?!1:(this.meshMatrixWorldsOld=this.meshMatrixWorlds.map(_=>_.clone()),!0)}cropsChanged(){let rt=!1;return this.splatEntries.forEach((_,ut)=>{var mt;_.data.crops.forEach((bt,St)=>{this.cropsArray[ut][St]===void 0?(rt=!0,this.cropsArray[ut][St]=bt.data):Object.entries(bt.data).forEach(([Mt,Bt])=>{var Ut;Array.isArray(Bt)&&Bt.some((Ht,tr)=>Ht!==this.cropsArray[ut][St][Mt][tr])?(rt=!0,this.cropsArray[ut][St][Mt]=Bt):Bt!==((Ut=this.cropsArray[ut][St])==null?void 0:Ut[Mt])&&(rt=!0,this.cropsArray[ut][St][Mt]=Bt)})}),_.data.crops.length!==((mt=this.cropsArray[ut])==null?void 0:mt.length)&&(this.cropsArray[ut].length=_.data.crops.length,rt=!0)}),rt}setupSplatMesh(rt,_,ut=new Vector3,mt=new Quaternion,bt=!1,St=1,Mt,Bt){this.splatMesh=yn.buildMesh(rt,_,bt,St,Mt,Bt),this.splatMesh.position.copy(ut),this.splatMesh.quaternion.copy(mt),this.splatMesh.frustumCulled=!1,this.splatMesh.renderOrder=10,this.updateSplatMeshUniforms(),this.splatRenderCount=_}setupSortWorker(rt){this.sortWorker=xv(rt),this.sortWorker.onmessage=_=>{var ut;_.data.sortDone?(this.sortRunning=!1,(ut=this.splatMesh)==null||ut.updateIndexes(new Uint32Array(_.data.indexesBuffer)),this.lastSortTime=_.data.sortTime,this.queuedMessage&&(this.sortWorker.postMessage(this.queuedMessage),this.queuedMessage=null)):_.data.sortCanceled?this.sortRunning=!1:_.data.sortSetupPhase1Complete?this.sortWorker.postMessage({positions:this.splatMesh.getCenters().buffer,meshMatrixWorlds:this.splatMesh.meshMatrixWorlds,meshIndexIntervals:this.splatMesh.meshIndexIntervals,cropsArray:this.cropsArray}):_.data.sortSetupComplete&&(this.splatDataTextures=this.splatMesh.getSplatDataTextures(),this.updateView(!0,!0),this.splatRenderingInitialized=!0)}}update(){this.splatRenderingInitialized!==!1&&(this.updateSplatMeshUniforms(),this.updateView())}getSplatMesh(){return this.splatMesh}},pN=new MeshBasicMaterial;pN.wireframe=!0;var _v=new Vector3,hu=class extends Scene$3{constructor(rt,_){super(),this.data=rt,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.splatViewer=null,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new lu,this.errorPage=new dn("fdasfa",{...xo.defaultData,name:""}),this.invisibleObjects=new un("jflkdsafjasdifjaslk",{...$l.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(rt,_),this.matrixAutoUpdate=!1}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=Fx(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=kx(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(rt){let _=rt.identity.join("-"),ut=this.entityIdentityToEntity[_];ut&&(rt.uuid=ut.uuid),this.entityIdentityToEntity[_]=rt,this.entityByUuid[rt.uuid]=rt}markPenumbraSizeDirty(){for(let rt of this.children)rt instanceof dn&&(rt.penumbraSizeArrayCache=null)}findInstance(rt){return this.entityIdentityToEntity[rt.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(rt){let _=this.find(rt);if(_===void 0)return;let ut=[],mt=_;for(;mt!==this;){let bt=mt;mt=mt.parent;let St=mt.children.indexOf(bt);ut.splice(0,0,St)}return{entity:_,sortKey:ut}}getAllSorted(rt){let _=[];for(let ut of rt){let mt=this.getWithSortKey(ut.id);mt!==void 0&&_.push(mt)}return _.sort((ut,mt)=>tf(ut.sortKey,mt.sortKey)),_.map(ut=>ut.entity)}nonExistOrDescendantOf(rt,_){let ut=this.find(rt);if(ut===void 0)return!0;for(;ut;){if(ut.uuid===_)return!0;ut=ut.parent}return!1}find(rt){if(this.activePage&&this.activePage.personalCamera.parent){if(rt==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(rt===Uo)return this.activePage.personalCamera}if(rt===""||rt===void 0)return;let _=this.entityByUuid[rt];return _===void 0?this.getObjectByProperty("uuid",rt):_}debugEnsureEntity(rt){let _=this.find(rt);if(_){if(Array.isArray(_.identity)&&this.findInstance(_.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(rt){this.toExpandCloner.add(rt)}addPendingUpdateCloner(rt){this.toUpdateCloner.add(rt)}markToExpandCloner(rt){this.toExpandCloner.add(rt),rt.traverseEntityAncestors(_=>{this.toExpandCloner.add(_)})}doPendingExpandCloner(){this.toExpandCloner.forEach(rt=>{rt.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(rt=>{var _;(_=rt.cloner)==null||_.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(rt){this.pendingCommands.push(rt)}applyPendingCommands(){this.pendingCommands.forEach(rt=>rt()),this.pendingCommands.length=0}updateByLibOp(rt,_){rt.path.length===1&&rt.path[0]==="components"&&rt.type===1&&this.createChildrenObjects([{...rt.data.asset,id:rt.id}],this.invisibleObjects,_)}updateTreeByOp(rt,_){var ut;if(rt.path.length===0&&rt.type===7){let mt=rt.parent===null?this:this.find(rt.parent);if(mt===void 0)throw new Error("unexpected");let bt=this.createObject(rt.id,rt.data,rt.children,mt,rt.localIndex,_);bt.updateVisible(),bt.resetBBoxNeedsUpdate(),cn(bt)&&Gs(bt.parent)&&(bt.invalidateUpstreamBooleanData(),bt.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(mt),this.markNeedsRecomputeInstancesForChildren(bt),this.markToExpandCloner(bt),this.markPenumbraSizeDirty(),bt.updatePathSnapping()}else if(rt.path.length===0&&rt.type===8){let mt=this.find(rt.id);if(mt===void 0)throw new Error("unexpected");this.markToExpandCloner(mt),mt.resetBBoxNeedsUpdate(),this.unregisterObject(mt);let bt=mt.parent;this.markNeedsRecomputeInstancesForAncessors(bt),this.markNeedsRecomputeInstancesForChildren(mt),this.markPenumbraSizeDirty(),mt.parent.remove(mt),Gs(mt.parent)&&(mt.parent.invalidateUpstreamBooleanData(),mt.parent.invalidateDownstreamBooleanData().recomputeBoolean()),cn(mt)&&(mt.freeBooleanPointer(),bt instanceof er&&bt.invalidateDownstreamBooleanData().recomputeBoolean()),mt instanceof Fa&&mt.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(mt),this.pathConstraints.removeDependencies(mt.uuid),mt.updatePathSnapping()}else if(rt.path.length===0&&rt.type===9){let mt=this.find(rt.id);if(mt===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(mt);let bt=mt.parent;this.markNeedsRecomputeInstancesForAncessors(bt),(ut=mt.cloner)==null||ut.resetOnMove(),this.markToExpandCloner(mt);let St=rt.parent===null?this:this.find(rt.parent);if(St===void 0)throw new Error("unexpected");St.add(mt),this.markNeedsRecomputeInstancesForAncessors(St),this.markToExpandCloner(mt),mt.invalidateClonerTransform(mt),mt.updateVisible(),mt.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let Mt=rt.localIndex;St.children.splice(Mt,0,St.children.pop()),cn(mt)&&(mt.invalidateUpstreamBooleanData(),Gs(mt.parent)?mt.parent.invalidateDownstreamBooleanData().recomputeBoolean():bt instanceof er&&bt.invalidateDownstreamBooleanData().recomputeBoolean()),mt.updatePathSnapping()}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(rt){var _;this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let ut of this.children)ut instanceof dn&&(ut.visible=ut.uuid===rt,ut.visible&&(this.activePage=ut,this.activePage.onActive(this)));this.activePage!==((_=this.splatViewer)==null?void 0:_.activePage)&&this.reloadSplats()}updateEntityByOp(rt,_,ut,mt){if(_.type===0){if(("overrides"in _.props||"component"in _.props)&&this.markNeedsRecomputeInstances(),"visible"in _.props&&this.markPenumbraSizeDirty(),_.path.includes("overrides")&&"states"in _.props){let{rest:St}=_.props;_={..._,props:St},this.markNeedsRecomputeInstances()}_.path[0]==="pathSnapping"&&_.props.pathId!==void 0&&this.pathConstraints.setConstraint(rt,_.props.pathId)}let bt=this.find(rt);if(bt)try{Vx(bt,_,ut,{scene:this,shared:mt}),bt instanceof st&&bt.updateGeometryGroupsIfNeeded()}catch(St){console.error(St)}}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(rt){this.activePage.switchActiveCamera(rt)}isInvisibleObjects(rt){return rt===this.invisibleObjects||rt.hasAnccestor(this.invisibleObjects)}init(rt,_){let ut=Object.entries(_.data.lib.components).map((mt,bt)=>({data:mt[1].asset.data,children:mt[1].asset.children,id:mt[0],fi:bt}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:_}),this.add(this.invisibleObjects),this.createChildrenObjects(ut,this.invisibleObjects,_),this.createChildrenObjects(rt.objects,this,_),this.updatePage(rt.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(_,!0),this.traverseEntity(mt=>{mt instanceof Mo&&mt.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(rt){rt.traverseEntity(_=>{(_.data.type==="Component"||_.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(rt){Ae.is(rt)&&(rt.data.type==="Component"&&this.markNeedsRecomputeInstances(),rt.traverseAncestors(_=>{Ae.is(_)&&_.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(rt,_,ut,mt,bt,St,Mt){if(rt){let Bt=mt.find(rt);Bt&&Bt!==mt&&bt.forInstancesRec(Ut=>{Ut.data=Vo(Ut.data,Ht=>{let tr=Ht.events.data(Mt.id),rr=Ut.goUp(St);if(rr){let sr=[...$s(rr.identity),rt].join("-"),ar=this.entityIdentityToEntity[sr];if(ar){let cr=ar.uuid,Ar=ot.zoom(tr,_);Ar[ut]=cr}else console.warn("cannot find instance")}}).data})}}rewriteActions(rt,_,ut,mt,bt,St){rt.forEach(Mt=>{Mt.data.type==="Transition"?this.relativeizeInner(Mt.data.object,[..._,Mt.id],"object",ut,mt,bt,St):Mt.data.type==="Animation"&&this.relativeizeInner(Mt.data.object,[..._,Mt.id],"object",ut,mt,bt,St)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(rt=>{if(rt instanceof Io&&typeof rt.identity=="string"&&rt.data.type==="Component")return rt.traverseEntity((_,ut)=>{_.data.events.forEach(mt=>{if(mt.data.type==="GameControl"){let bt=!1;if(_.forInstancesRec(St=>{St.data=Vo(St.data,Mt=>{St.isInstanceRoot||(Mt.events.delete(mt.id),bt=!0)}).data}),bt===!1)for(let St of Ql.list)this.rewriteActions(mt.data.gameActions[St],["gameActions",St],rt,_,ut,mt)}else mt.data.type==="Conditional"?(mt.data.condition.type==="Distance"?(this.relativeizeInner(mt.data.condition.fromObject,["condition"],"fromObject",rt,_,ut,mt),this.relativeizeInner(mt.data.condition.toObject,["condition"],"toObject",rt,_,ut,mt)):mt.data.condition.type==="State"?this.relativeizeInner(mt.data.condition.object,["condition"],"object",rt,_,ut,mt):mt.data.condition.type==="Comparison"&&(mt.data.condition.lOperand.type==="Property"&&this.relativeizeInner(mt.data.condition.lOperand.value[0],["condition","lOperand","value"],0,rt,_,ut,mt),mt.data.condition.rOperand.type==="Property"&&this.relativeizeInner(mt.data.condition.rOperand.value[0],["condition","rOperand","value"],0,rt,_,ut,mt)),this.rewriteActions(mt.data.inActions,["inActions"],rt,_,ut,mt),this.rewriteActions(mt.data.outActions,["outActions"],rt,_,ut,mt)):"actions"in mt.data&&this.rewriteActions(mt.data.actions,["actions"],rt,_,ut,mt)})}),!0})}expandInstances(rt,_,ut){let mt=new Set;this.traverseEntity(bt=>{if(bt instanceof Io&&bt.isInstanceRoot)return bt.expandInstanceChildren({scene:this,shared:rt,pendingDeletes:mt}),_||bt.resetBBoxNeedsUpdate(),ut&&bt.traverseEntity(St=>{ut.addClip(St)}),!0});for(let bt of mt)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(bt),iu(bt)}recomputeInstances(rt,_){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(ut=>{ut instanceof Io&&ut.isInstanceRoot&&(ut.component=void 0)}),this.expandInstances(rt,!1,_))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(rt){rt.traverseEntity(_=>{let ut=typeof _.identity=="string"?_.identity:_.identity.join("-");this.entityIdentityToEntity[ut]===_&&(delete this.entityByUuid[_.uuid],delete this.entityIdentityToEntity[ut]),_.dispose()})}clearScene(){for(let rt of this.children)Ae.is(rt)&&rt.disposeRecursively();this.children.length=0}resetAfterClear(rt,_){this.init(rt,_)}raycast(rt){return this.raycast1(rt,!1)}raycast1(rt,_){let ut=[],mt=bt=>{for(let St of bt.children){let Mt=St.cloner;if(Ae.is(St)&&!St.raycastLock&&(St.visible||Mt!=null&&Mt.object.data.visible))if(_===!0&&St.isInstanceRoot){let Bt=[];if(rt.intersectObject(St,!0,Bt),Bt.length){let Ut=Bt[0];Ut.object=St,Ut.point.applyMatrix4(Ut.object.matrixWorld);let Ht=St.matrixWorld.clone().invert();Ut.point.applyMatrix4(Ht),ut.push(Ut)}}else(cn(St)||zs(St)&&this.enableHelpers&&St.objectHelper.visible)&&(rt.intersectObject(St,!1,ut),Us(St,rt,ut)),mt(St)}};return mt(this),ut}raycastWithClones(rt){let _=[],ut=mt=>{for(let bt of mt.children){let St=bt.cloner;Ae.is(bt)&&(bt.visible||St!=null&&St.object.data.visible)&&((cn(bt)||zs(bt)&&this.enableHelpers&&bt.objectHelper.visible)&&(rt.intersectObject(bt,!1,_),Us(bt,rt,_,!0)),ut(bt))}};return ut(this),_}forEachEntity(rt){for(let _ of this.children)Ae.is(_)&&rt(_)}traverseConcreteEntity(rt){for(let _ of this.children)Ae.is(_)&&_.isConcreteEntity&&_.traverseEntity(rt)}traverseEntity(rt){for(let _ of this.children)Ae.is(_)&&_.traverseEntity(rt)}updateFont(rt,_){this.traverseEntity(ut=>{if(ut instanceof st&&ut.data.type==="Mesh"&&ut.data.geometry.type==="TextGeometry"&&ut.data.geometry.font===rt){let mt=ut.geometry,bt=ut.data.geometry;mt.updateFont(rt,_).then(()=>{mt.update(bt);let St=ut.invalidateDownstreamBooleanData();Gs(St)&&St.recomputeBoolean()})}})}traverseObject(rt){for(let _ of this.children)Gi.is(_)&&_.traverseObject(rt)}traverseVisibleEntity(rt){for(let _ of this.children)Ae.is(_)&&_.visible&&_.traverseVisibleEntity(rt)}dispose(){this.clearScene()}createChildrenObjects(rt,_,ut){let mt=0;for(let bt of rt)this.createObject(bt.id,bt.data,bt.children,_,mt,ut),mt+=1}registerObjectCreatedInLegacy(rt){this.entityByUuid[rt.uuid]=rt}unregisterObject(rt){delete this.entityByUuid[rt.uuid];for(let _ of rt.children)this.unregisterObject(_)}createObject(rt,_,ut,mt,bt,St){var Ut;let Mt={scene:this,shared:St},Bt=su(rt,_,Mt);return Bt&&(this.entityByUuid[rt]=Bt,mt.add(Bt),mt.children.splice(bt,0,mt.children.pop()),ut.length>0&&(Bt.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(ut,Bt,St)),Bt.updateState(_,Mt),Bt instanceof st&&Bt.updateGeometryGroupsIfNeeded(),Bt.updateVisible(),Bt.cloner&&this.toExpandCloner.add(Bt),(Ut=_.pathSnapping)!=null&&Ut.pathId&&this.pathConstraints.setConstraint(rt,_.pathSnapping.pathId)),_.type==="Empty"&&_.animations&&Bt.traverseEntity(Ht=>{let tr=Ht.dataPatched;if(Ht instanceof st&&tr.bones&&tr.boneInverses){let rr=tr.bones.map(cr=>this.find(cr)),sr=tr.boneInverses.map(cr=>new Matrix4().fromArray(cr)),ar=new Skeleton(rr,sr);Ht.bind(ar,Ht.bindMatrix)}else Ht.matrixAutoUpdate=!0}),Bt}getCenter(rt){let _=[];for(let mt=0,bt=rt.length;mt<bt;++mt){let{id:St,recursive:Mt}=rt[mt],Bt=this.find(St),Ut=Mt?Bt.recursiveBBox:Bt.singleBBox;_.push(...Ut.vertices)}let ut=new Box3;return ut.setFromPoints(_),ut.getCenter(_v),_v}copyMatrixWorld(rt,_){if(rt===null){_.identity();return}let ut=this.find(rt);ut?_.copy(ut.matrixWorld):_.identity()}copyParentMatrixWorld(rt,_){var mt;if(rt===null){_.identity();return}let ut=(mt=this.find(rt))==null?void 0:mt.parent;ut?_.copy(ut.matrixWorld):_.identity()}traverseMaterial(rt){this.traverseEntity(_=>{if(_ instanceof It)if(Array.isArray(_.material))for(let ut=0;ut<_.material.length;ut++)_.material[ut]instanceof Zt&&rt(_.material[ut]);else _.material instanceof Zt&&rt(_.material)})}updateViewPlaneSize(rt,_,ut=!1){this.traverseConcreteEntity(mt=>{mt instanceof Mo&&mt.setViewplaneSize(rt,_,ut)})}initializeSplatViewer(rt){this.splatViewer=new Hs({scene:this,renderer:rt}),this.reloadSplats()}reloadSplats(){var rt;(rt=this.splatViewer)==null||rt.reloadSplats()}},gn;function hN(){return gn||(gn=new DRACOLoader,gn.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),gn.decoderPending}async function mN(rt){if(gn){let _={attributeIDs:gn.defaultAttributeIDs,attributeTypes:gn.defaultAttributeTypes,useUniqueIDs:!1},ut;try{ut=await gn.decodeGeometry(new Int8Array(rt).buffer,_)}catch(mt){console.error(mt)}if(ut)return{index:ut.index?{array:ut.index.array}:void 0,attributes:Object.entries(ut.attributes).map(([mt,bt])=>({name:mt,itemSize:bt.itemSize,array:bt.array}))}}return null}async function Av(rt,_){let[ut,mt]=Pu(Bl.deserialize(new Uint8Array(rt)));ec(ut);let bt=[];ut.scene.objects.traverse((St,Mt)=>{Mt.type==="Mesh"&&Mt.geometry.type==="NonParametricGeometry"&&Mt.geometry.data.draco!==void 0&&bt.push(Mt)}),bt.length&&await hN();for(let St of bt){let Mt=await mN(Ye(St.geometry.data.draco));if(Mt){Mt.index&&(St.geometry.data.index={array:Mt.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let Bt={};Mt.attributes.forEach(({name:Ut,array:Ht,itemSize:tr})=>{Bt[Ut]={array:Ht,itemSize:tr,type:"Float32Array",normalized:!1}}),St.geometry.data.attributes=Bt,St.geometry.data.draco=void 0}}return _&&_(ut),mt.result().data}function Tv(rt){let _;if(rt.index)for(let ut=0;ut<rt.index.array.length;ut+=3)_=rt.index.array[ut],rt.index.array[ut]=rt.index.array[ut+2],rt.index.array[ut+2]=_}function Pv(rt){let _=new Set;return rt.traverse(ut=>{if(ut instanceof Jt)if(Ze(ut.material))ut.material.forEach(mt=>{let bt=mt;_.has(bt)||_.add(bt)});else{let mt=ut.material;_.has(mt)||_.add(mt)}}),_.forEach(ut=>{if(ut instanceof Array)return;let mt=ut.onBeforeCompile.bind(ut);if(gN(ut)){Object.assign(ut,{isMeshStandardMaterial:!0,isMeshPhysicalMaterial:!0,transmission:1,attenuationColor:new Color$1,specularColor:new Color$1});let bt=0;ut.onBeforeCompile=(St,Mt)=>{mt&&mt(St,Mt),St.uniforms=Object.assign({},ShaderLib.physical.uniforms,St.uniforms),ut.getLayersOfType("transmission").forEach(Bt=>{if(St.uniforms.transmissionSamplerMap.value){let Ut=Bt.color;Ut&&(Ut.transmissionSamplerMap.value=St.uniforms.transmissionSamplerMap.value,Ut.transmissionSamplerSize.value=St.uniforms.transmissionSamplerSize.value,Ut.aspectRatio.value=O0(window.innerWidth,window.innerHeight),ut.defines.IS_THREEJS_EXPORT=!0)}else bt++,bt<2&&(ut.needsUpdate=!0)})}}else xN(ut)||(ut.onBeforeCompile=(bt,St)=>{mt&&mt(bt,St),ut.transparent=!1})}),rt}function gN(rt){return rt.getLayersOfType("transmission").length>0}function xN(rt){let _=0;for(let ut of rt.layers){if(ut.data.type!=="displace"&&ut.data.isMask)return!0;if(ut.type!=="light"&&ut.type!=="fresnel"){let mt=ut.uniforms["f"+ut.id+"_alpha"];mt&&(_+=(1-_)*mt.value)}}return _<1}function Ov(rt){return rt.traverse(_=>{if(_.type==="Camera"){let ut=_;ut.type=ut.cameraType}}),rt}function Mv(rt){let _=[],ut=(mt,bt=0)=>{let St=bt>0?mt+bt:mt;return _.includes(St)?ut(mt,bt+1):St};return rt.traverse(mt=>{if(_.includes(mt.name)){let bt=mt.name,St=ut(mt.name);if(mt.name=St,mt.isMesh){let Mt=mt;Mt.material instanceof Array?Mt.material.forEach(Bt=>{Bt.name=Bt.name.replace(bt,St)}):Mt.material.isAsset||(Mt.material.name=Mt.material.name.replace(bt,St))}}_.push(mt.name)}),rt}function Iv(rt){let _=[];return rt.traverse(ut=>{ut instanceof Da&&_.push(ut)}),_.forEach(ut=>{let mt=ut.object,bt=[...ut.children.map(St=>{St.updateMatrix();let Mt;if(St.geometry!==void 0)try{Mt=St.geometry.clone().applyMatrix4(St.matrix)}catch(Bt){console.error(Bt)}return Mt!==void 0&&St.matrix.determinant()<0&&Tv(Mt),Mt}).filter(St=>St!==void 0)];if(!ut.parameters.hideBase&&mt instanceof It&&bt.unshift(mt.geometry),bt.length){let St=mergeBufferGeometries(bt);mt instanceof It&&(mt.geometry=St)}ut.removeFromParent(),mt.setFromClonerState(null,{scene:rt,shared:q0})}),rt}function Nv(rt){return rt.traverse(_=>{_.matrixAutoUpdate=!0}),rt}function Ev(rt){Object.values(rt.shared.materials).forEach(_=>{Qp(_)}),rt.scene.objects.traverse((_,ut)=>{"material"in ut?Qp(ut.material):"materials"in ut&&ut.materials.forEach(mt=>{Qp(mt)})})}function Qp(rt){if(typeof rt=="string")return;let _=[];rt.layers.forEach((ut,mt)=>{ut.type==="outline"&&_.push(mt)}),_.reverse().forEach(ut=>{rt.layers.delete(ut)}),_.length&&console.warn("The Spline Loader currently does not support the outline layer.")}var Vv=Rt(Lv(),1);function Bv(rt){return rt.traverseMaterial(_=>{_.needsJitter=!1}),rt}var Rv="The SplineLoader only accepts .splinecode files that are generated from Spline export panel.",Zp=class extends Loader{load(rt,_,ut,mt=console.error){let bt=new FileLoader(this.manager);bt.setPath(this.path),bt.setResponseType("arraybuffer"),bt.setRequestHeader(this.requestHeader),bt.setWithCredentials(this.withCredentials),rt.endsWith(".spline")?console.warn(Rv+" The .spline files are only meant to be used by the Editor."):rt.endsWith(".splinecode")||console.warn(Rv),bt.load(rt,async St=>{try{if(typeof St=="string")throw new Error("The .spline file is not binary!");let Mt=await this.parse(St);_(Mt)}catch(Mt){mt(Mt)}},ut,mt)}async parse(rt){let _=await Av(rt,Ev);_.version&&(0,Vv.default)(_.version,"0.9.526")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/loader to the latest version."),await Promise.all([J0(_)&&i0(),ux(_)&&j0()].filter(Boolean));let ut=new jn(_.shared);Object.values(ut.getMaterials()).forEach(St=>Object.assign(St,{isAsset:!0}));let mt=new hu(_.scene,ut),bt=mt.activeCamera;return bt&&Object.assign(bt,{makeDefault:!0}),mt=Iv(mt),mt=Pv(mt),mt=Ov(mt),mt=Mv(mt),mt=Nv(mt),mt=Bv(mt),mt}};function useSpline(rt){const _=useLoader(Zp,rt);return useGraph(_)}const PACKET_TYPES=Object.create(null);PACKET_TYPES.open="0";PACKET_TYPES.close="1";PACKET_TYPES.ping="2";PACKET_TYPES.pong="3";PACKET_TYPES.message="4";PACKET_TYPES.upgrade="5";PACKET_TYPES.noop="6";const PACKET_TYPES_REVERSE=Object.create(null);Object.keys(PACKET_TYPES).forEach(rt=>{PACKET_TYPES_REVERSE[PACKET_TYPES[rt]]=rt});const ERROR_PACKET={type:"error",data:"parser error"},withNativeBlob$1=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",withNativeArrayBuffer$2=typeof ArrayBuffer=="function",isView$1=rt=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(rt):rt&&rt.buffer instanceof ArrayBuffer,encodePacket=({type:rt,data:_},ut,mt)=>withNativeBlob$1&&_ instanceof Blob?ut?mt(_):encodeBlobAsBase64(_,mt):withNativeArrayBuffer$2&&(_ instanceof ArrayBuffer||isView$1(_))?ut?mt(_):encodeBlobAsBase64(new Blob([_]),mt):mt(PACKET_TYPES[rt]+(_||"")),encodeBlobAsBase64=(rt,_)=>{const ut=new FileReader;return ut.onload=function(){const mt=ut.result.split(",")[1];_("b"+(mt||""))},ut.readAsDataURL(rt)};function toArray$2(rt){return rt instanceof Uint8Array?rt:rt instanceof ArrayBuffer?new Uint8Array(rt):new Uint8Array(rt.buffer,rt.byteOffset,rt.byteLength)}let TEXT_ENCODER;function encodePacketToBinary(rt,_){if(withNativeBlob$1&&rt.data instanceof Blob)return rt.data.arrayBuffer().then(toArray$2).then(_);if(withNativeArrayBuffer$2&&(rt.data instanceof ArrayBuffer||isView$1(rt.data)))return _(toArray$2(rt.data));encodePacket(rt,!1,ut=>{TEXT_ENCODER||(TEXT_ENCODER=new TextEncoder),_(TEXT_ENCODER.encode(ut))})}const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let rt=0;rt<chars.length;rt++)lookup$1[chars.charCodeAt(rt)]=rt;const decode$1=rt=>{let _=rt.length*.75,ut=rt.length,mt,bt=0,St,Mt,Bt,Ut;rt[rt.length-1]==="="&&(_--,rt[rt.length-2]==="="&&_--);const Ht=new ArrayBuffer(_),tr=new Uint8Array(Ht);for(mt=0;mt<ut;mt+=4)St=lookup$1[rt.charCodeAt(mt)],Mt=lookup$1[rt.charCodeAt(mt+1)],Bt=lookup$1[rt.charCodeAt(mt+2)],Ut=lookup$1[rt.charCodeAt(mt+3)],tr[bt++]=St<<2|Mt>>4,tr[bt++]=(Mt&15)<<4|Bt>>2,tr[bt++]=(Bt&3)<<6|Ut&63;return Ht},withNativeArrayBuffer$1=typeof ArrayBuffer=="function",decodePacket=(rt,_)=>{if(typeof rt!="string")return{type:"message",data:mapBinary(rt,_)};const ut=rt.charAt(0);return ut==="b"?{type:"message",data:decodeBase64Packet(rt.substring(1),_)}:PACKET_TYPES_REVERSE[ut]?rt.length>1?{type:PACKET_TYPES_REVERSE[ut],data:rt.substring(1)}:{type:PACKET_TYPES_REVERSE[ut]}:ERROR_PACKET},decodeBase64Packet=(rt,_)=>{if(withNativeArrayBuffer$1){const ut=decode$1(rt);return mapBinary(ut,_)}else return{base64:!0,data:rt}},mapBinary=(rt,_)=>{switch(_){case"blob":return rt instanceof Blob?rt:new Blob([rt]);case"arraybuffer":default:return rt instanceof ArrayBuffer?rt:rt.buffer}},SEPARATOR="",encodePayload=(rt,_)=>{const ut=rt.length,mt=new Array(ut);let bt=0;rt.forEach((St,Mt)=>{encodePacket(St,!1,Bt=>{mt[Mt]=Bt,++bt===ut&&_(mt.join(SEPARATOR))})})},decodePayload=(rt,_)=>{const ut=rt.split(SEPARATOR),mt=[];for(let bt=0;bt<ut.length;bt++){const St=decodePacket(ut[bt],_);if(mt.push(St),St.type==="error")break}return mt};function createPacketEncoderStream(){return new TransformStream({transform(rt,_){encodePacketToBinary(rt,ut=>{const mt=ut.length;let bt;if(mt<126)bt=new Uint8Array(1),new DataView(bt.buffer).setUint8(0,mt);else if(mt<65536){bt=new Uint8Array(3);const St=new DataView(bt.buffer);St.setUint8(0,126),St.setUint16(1,mt)}else{bt=new Uint8Array(9);const St=new DataView(bt.buffer);St.setUint8(0,127),St.setBigUint64(1,BigInt(mt))}rt.data&&typeof rt.data!="string"&&(bt[0]|=128),_.enqueue(bt),_.enqueue(ut)})}})}let TEXT_DECODER;function totalLength(rt){return rt.reduce((_,ut)=>_+ut.length,0)}function concatChunks(rt,_){if(rt[0].length===_)return rt.shift();const ut=new Uint8Array(_);let mt=0;for(let bt=0;bt<_;bt++)ut[bt]=rt[0][mt++],mt===rt[0].length&&(rt.shift(),mt=0);return rt.length&&mt<rt[0].length&&(rt[0]=rt[0].slice(mt)),ut}function createPacketDecoderStream(rt,_){TEXT_DECODER||(TEXT_DECODER=new TextDecoder);const ut=[];let mt=0,bt=-1,St=!1;return new TransformStream({transform(Mt,Bt){for(ut.push(Mt);;){if(mt===0){if(totalLength(ut)<1)break;const Ut=concatChunks(ut,1);St=(Ut[0]&128)===128,bt=Ut[0]&127,bt<126?mt=3:bt===126?mt=1:mt=2}else if(mt===1){if(totalLength(ut)<2)break;const Ut=concatChunks(ut,2);bt=new DataView(Ut.buffer,Ut.byteOffset,Ut.length).getUint16(0),mt=3}else if(mt===2){if(totalLength(ut)<8)break;const Ut=concatChunks(ut,8),Ht=new DataView(Ut.buffer,Ut.byteOffset,Ut.length),tr=Ht.getUint32(0);if(tr>Math.pow(2,21)-1){Bt.enqueue(ERROR_PACKET);break}bt=tr*Math.pow(2,32)+Ht.getUint32(4),mt=3}else{if(totalLength(ut)<bt)break;const Ut=concatChunks(ut,bt);Bt.enqueue(decodePacket(St?Ut:TEXT_DECODER.decode(Ut),_)),mt=0}if(bt===0||bt>rt){Bt.enqueue(ERROR_PACKET);break}}}})}const protocol$1=4;function Emitter(rt){if(rt)return mixin(rt)}function mixin(rt){for(var _ in Emitter.prototype)rt[_]=Emitter.prototype[_];return rt}Emitter.prototype.on=Emitter.prototype.addEventListener=function(rt,_){return this._callbacks=this._callbacks||{},(this._callbacks["$"+rt]=this._callbacks["$"+rt]||[]).push(_),this};Emitter.prototype.once=function(rt,_){function ut(){this.off(rt,ut),_.apply(this,arguments)}return ut.fn=_,this.on(rt,ut),this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(rt,_){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var ut=this._callbacks["$"+rt];if(!ut)return this;if(arguments.length==1)return delete this._callbacks["$"+rt],this;for(var mt,bt=0;bt<ut.length;bt++)if(mt=ut[bt],mt===_||mt.fn===_){ut.splice(bt,1);break}return ut.length===0&&delete this._callbacks["$"+rt],this};Emitter.prototype.emit=function(rt){this._callbacks=this._callbacks||{};for(var _=new Array(arguments.length-1),ut=this._callbacks["$"+rt],mt=1;mt<arguments.length;mt++)_[mt-1]=arguments[mt];if(ut){ut=ut.slice(0);for(var mt=0,bt=ut.length;mt<bt;++mt)ut[mt].apply(this,_)}return this};Emitter.prototype.emitReserved=Emitter.prototype.emit;Emitter.prototype.listeners=function(rt){return this._callbacks=this._callbacks||{},this._callbacks["$"+rt]||[]};Emitter.prototype.hasListeners=function(rt){return!!this.listeners(rt).length};const globalThisShim=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function pick$1(rt,..._){return _.reduce((ut,mt)=>(rt.hasOwnProperty(mt)&&(ut[mt]=rt[mt]),ut),{})}const NATIVE_SET_TIMEOUT=globalThisShim.setTimeout,NATIVE_CLEAR_TIMEOUT=globalThisShim.clearTimeout;function installTimerFunctions(rt,_){_.useNativeTimers?(rt.setTimeoutFn=NATIVE_SET_TIMEOUT.bind(globalThisShim),rt.clearTimeoutFn=NATIVE_CLEAR_TIMEOUT.bind(globalThisShim)):(rt.setTimeoutFn=globalThisShim.setTimeout.bind(globalThisShim),rt.clearTimeoutFn=globalThisShim.clearTimeout.bind(globalThisShim))}const BASE64_OVERHEAD=1.33;function byteLength(rt){return typeof rt=="string"?utf8Length(rt):Math.ceil((rt.byteLength||rt.size)*BASE64_OVERHEAD)}function utf8Length(rt){let _=0,ut=0;for(let mt=0,bt=rt.length;mt<bt;mt++)_=rt.charCodeAt(mt),_<128?ut+=1:_<2048?ut+=2:_<55296||_>=57344?ut+=3:(mt++,ut+=4);return ut}function encode$3(rt){let _="";for(let ut in rt)rt.hasOwnProperty(ut)&&(_.length&&(_+="&"),_+=encodeURIComponent(ut)+"="+encodeURIComponent(rt[ut]));return _}function decode(rt){let _={},ut=rt.split("&");for(let mt=0,bt=ut.length;mt<bt;mt++){let St=ut[mt].split("=");_[decodeURIComponent(St[0])]=decodeURIComponent(St[1])}return _}class TransportError extends Error{constructor(_,ut,mt){super(_),this.description=ut,this.context=mt,this.type="TransportError"}}class Transport extends Emitter{constructor(_){super(),this.writable=!1,installTimerFunctions(this,_),this.opts=_,this.query=_.query,this.socket=_.socket}onError(_,ut,mt){return super.emitReserved("error",new TransportError(_,ut,mt)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(_){this.readyState==="open"&&this.write(_)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(_){const ut=decodePacket(_,this.socket.binaryType);this.onPacket(ut)}onPacket(_){super.emitReserved("packet",_)}onClose(_){this.readyState="closed",super.emitReserved("close",_)}pause(_){}createUri(_,ut={}){return _+"://"+this._hostname()+this._port()+this.opts.path+this._query(ut)}_hostname(){const _=this.opts.hostname;return _.indexOf(":")===-1?_:"["+_+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(_){const ut=encode$3(_);return ut.length?"?"+ut:""}}const alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map={};let seed=0,i$4=0,prev;function encode$2(rt){let _="";do _=alphabet[rt%length]+_,rt=Math.floor(rt/length);while(rt>0);return _}function yeast(){const rt=encode$2(+new Date);return rt!==prev?(seed=0,prev=rt):rt+"."+encode$2(seed++)}for(;i$4<length;i$4++)map[alphabet[i$4]]=i$4;let value=!1;try{value=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch(rt){}const hasCORS=value;function XHR(rt){const _=rt.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!_||hasCORS))return new XMLHttpRequest}catch{}if(!_)try{return new globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function createCookieJar(){}function empty(){}const hasXHR2=function(){return new XHR({xdomain:!1}).responseType!=null}();class Polling extends Transport{constructor(_){if(super(_),this.polling=!1,typeof location<"u"){const mt=location.protocol==="https:";let bt=location.port;bt||(bt=mt?"443":"80"),this.xd=typeof location<"u"&&_.hostname!==location.hostname||bt!==_.port}const ut=_&&_.forceBase64;this.supportsBinary=hasXHR2&&!ut,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(_){this.readyState="pausing";const ut=()=>{this.readyState="paused",_()};if(this.polling||!this.writable){let mt=0;this.polling&&(mt++,this.once("pollComplete",function(){--mt||ut()})),this.writable||(mt++,this.once("drain",function(){--mt||ut()}))}else ut()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(_){const ut=mt=>{if(this.readyState==="opening"&&mt.type==="open"&&this.onOpen(),mt.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(mt)};decodePayload(_,this.socket.binaryType).forEach(ut),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const _=()=>{this.write([{type:"close"}])};this.readyState==="open"?_():this.once("open",_)}write(_){this.writable=!1,encodePayload(_,ut=>{this.doWrite(ut,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const _=this.opts.secure?"https":"http",ut=this.query||{};return this.opts.timestampRequests!==!1&&(ut[this.opts.timestampParam]=yeast()),!this.supportsBinary&&!ut.sid&&(ut.b64=1),this.createUri(_,ut)}request(_={}){return Object.assign(_,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Request$1(this.uri(),_)}doWrite(_,ut){const mt=this.request({method:"POST",data:_});mt.on("success",ut),mt.on("error",(bt,St)=>{this.onError("xhr post error",bt,St)})}doPoll(){const _=this.request();_.on("data",this.onData.bind(this)),_.on("error",(ut,mt)=>{this.onError("xhr poll error",ut,mt)}),this.pollXhr=_}}let Request$1=class A3 extends Emitter{constructor(_,ut){super(),installTimerFunctions(this,ut),this.opts=ut,this.method=ut.method||"GET",this.uri=_,this.data=ut.data!==void 0?ut.data:null,this.create()}create(){var _;const ut=pick$1(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");ut.xdomain=!!this.opts.xd;const mt=this.xhr=new XHR(ut);try{mt.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){mt.setDisableHeaderCheck&&mt.setDisableHeaderCheck(!0);for(let bt in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(bt)&&mt.setRequestHeader(bt,this.opts.extraHeaders[bt])}}catch{}if(this.method==="POST")try{mt.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{mt.setRequestHeader("Accept","*/*")}catch{}(_=this.opts.cookieJar)===null||_===void 0||_.addCookies(mt),"withCredentials"in mt&&(mt.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(mt.timeout=this.opts.requestTimeout),mt.onreadystatechange=()=>{var bt;mt.readyState===3&&((bt=this.opts.cookieJar)===null||bt===void 0||bt.parseCookies(mt)),mt.readyState===4&&(mt.status===200||mt.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof mt.status=="number"?mt.status:0)},0))},mt.send(this.data)}catch(bt){this.setTimeoutFn(()=>{this.onError(bt)},0);return}typeof document<"u"&&(this.index=A3.requestsCount++,A3.requests[this.index]=this)}onError(_){this.emitReserved("error",_,this.xhr),this.cleanup(!0)}cleanup(_){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=empty,_)try{this.xhr.abort()}catch{}typeof document<"u"&&delete A3.requests[this.index],this.xhr=null}}onLoad(){const _=this.xhr.responseText;_!==null&&(this.emitReserved("data",_),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};Request$1.requestsCount=0;Request$1.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",unloadHandler);else if(typeof addEventListener=="function"){const rt="onpagehide"in globalThisShim?"pagehide":"unload";addEventListener(rt,unloadHandler,!1)}}function unloadHandler(){for(let rt in Request$1.requests)Request$1.requests.hasOwnProperty(rt)&&Request$1.requests[rt].abort()}const nextTick=typeof Promise=="function"&&typeof Promise.resolve=="function"?_=>Promise.resolve().then(_):(_,ut)=>ut(_,0),WebSocket=globalThisShim.WebSocket||globalThisShim.MozWebSocket,usingBrowserWebSocket=!0,defaultBinaryType="arraybuffer",isReactNative=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class WS extends Transport{constructor(_){super(_),this.supportsBinary=!_.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const _=this.uri(),ut=this.opts.protocols,mt=isReactNative?{}:pick$1(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(mt.headers=this.opts.extraHeaders);try{this.ws=usingBrowserWebSocket&&!isReactNative?ut?new WebSocket(_,ut):new WebSocket(_):new WebSocket(_,ut,mt)}catch(bt){return this.emitReserved("error",bt)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=_=>this.onClose({description:"websocket connection closed",context:_}),this.ws.onmessage=_=>this.onData(_.data),this.ws.onerror=_=>this.onError("websocket error",_)}write(_){this.writable=!1;for(let ut=0;ut<_.length;ut++){const mt=_[ut],bt=ut===_.length-1;encodePacket(mt,this.supportsBinary,St=>{const Mt={};try{usingBrowserWebSocket&&this.ws.send(St)}catch{}bt&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const _=this.opts.secure?"wss":"ws",ut=this.query||{};return this.opts.timestampRequests&&(ut[this.opts.timestampParam]=yeast()),this.supportsBinary||(ut.b64=1),this.createUri(_,ut)}check(){return!!WebSocket}}class WT extends Transport{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(_=>{this.onError("webtransport error",_)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(_=>{const ut=createPacketDecoderStream(Number.MAX_SAFE_INTEGER,this.socket.binaryType),mt=_.readable.pipeThrough(ut).getReader(),bt=createPacketEncoderStream();bt.readable.pipeTo(_.writable),this.writer=bt.writable.getWriter();const St=()=>{mt.read().then(({done:Bt,value:Ut})=>{Bt||(this.onPacket(Ut),St())}).catch(Bt=>{})};St();const Mt={type:"open"};this.query.sid&&(Mt.data=`{"sid":"${this.query.sid}"}`),this.writer.write(Mt).then(()=>this.onOpen())})}))}write(_){this.writable=!1;for(let ut=0;ut<_.length;ut++){const mt=_[ut],bt=ut===_.length-1;this.writer.write(mt).then(()=>{bt&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var _;(_=this.transport)===null||_===void 0||_.close()}}const transports={websocket:WS,webtransport:WT,polling:Polling},re$1=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse$1(rt){if(rt.length>2e3)throw"URI too long";const _=rt,ut=rt.indexOf("["),mt=rt.indexOf("]");ut!=-1&&mt!=-1&&(rt=rt.substring(0,ut)+rt.substring(ut,mt).replace(/:/g,";")+rt.substring(mt,rt.length));let bt=re$1.exec(rt||""),St={},Mt=14;for(;Mt--;)St[parts[Mt]]=bt[Mt]||"";return ut!=-1&&mt!=-1&&(St.source=_,St.host=St.host.substring(1,St.host.length-1).replace(/;/g,":"),St.authority=St.authority.replace("[","").replace("]","").replace(/;/g,":"),St.ipv6uri=!0),St.pathNames=pathNames(St,St.path),St.queryKey=queryKey(St,St.query),St}function pathNames(rt,_){const ut=/\/{2,9}/g,mt=_.replace(ut,"/").split("/");return(_.slice(0,1)=="/"||_.length===0)&&mt.splice(0,1),_.slice(-1)=="/"&&mt.splice(mt.length-1,1),mt}function queryKey(rt,_){const ut={};return _.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(mt,bt,St){bt&&(ut[bt]=St)}),ut}let Socket$1=class YM extends Emitter{constructor(_,ut={}){super(),this.binaryType=defaultBinaryType,this.writeBuffer=[],_&&typeof _=="object"&&(ut=_,_=null),_?(_=parse$1(_),ut.hostname=_.host,ut.secure=_.protocol==="https"||_.protocol==="wss",ut.port=_.port,_.query&&(ut.query=_.query)):ut.host&&(ut.hostname=parse$1(ut.host).host),installTimerFunctions(this,ut),this.secure=ut.secure!=null?ut.secure:typeof location<"u"&&location.protocol==="https:",ut.hostname&&!ut.port&&(ut.port=this.secure?"443":"80"),this.hostname=ut.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=ut.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=ut.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},ut),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(_){const ut=Object.assign({},this.opts.query);ut.EIO=protocol$1,ut.transport=_,this.id&&(ut.sid=this.id);const mt=Object.assign({},this.opts,{query:ut,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[_]);return new transports[_](mt)}open(){let _;if(this.opts.rememberUpgrade&&YM.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)_="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else _=this.transports[0];this.readyState="opening";try{_=this.createTransport(_)}catch{this.transports.shift(),this.open();return}_.open(),this.setTransport(_)}setTransport(_){this.transport&&this.transport.removeAllListeners(),this.transport=_,_.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",ut=>this.onClose("transport close",ut))}probe(_){let ut=this.createTransport(_),mt=!1;YM.priorWebsocketSuccess=!1;const bt=()=>{mt||(ut.send([{type:"ping",data:"probe"}]),ut.once("packet",rr=>{if(!mt)if(rr.type==="pong"&&rr.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",ut),!ut)return;YM.priorWebsocketSuccess=ut.name==="websocket",this.transport.pause(()=>{mt||this.readyState!=="closed"&&(tr(),this.setTransport(ut),ut.send([{type:"upgrade"}]),this.emitReserved("upgrade",ut),ut=null,this.upgrading=!1,this.flush())})}else{const sr=new Error("probe error");sr.transport=ut.name,this.emitReserved("upgradeError",sr)}}))};function St(){mt||(mt=!0,tr(),ut.close(),ut=null)}const Mt=rr=>{const sr=new Error("probe error: "+rr);sr.transport=ut.name,St(),this.emitReserved("upgradeError",sr)};function Bt(){Mt("transport closed")}function Ut(){Mt("socket closed")}function Ht(rr){ut&&rr.name!==ut.name&&St()}const tr=()=>{ut.removeListener("open",bt),ut.removeListener("error",Mt),ut.removeListener("close",Bt),this.off("close",Ut),this.off("upgrading",Ht)};ut.once("open",bt),ut.once("error",Mt),ut.once("close",Bt),this.once("close",Ut),this.once("upgrading",Ht),this.upgrades.indexOf("webtransport")!==-1&&_!=="webtransport"?this.setTimeoutFn(()=>{mt||ut.open()},200):ut.open()}onOpen(){if(this.readyState="open",YM.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let _=0;const ut=this.upgrades.length;for(;_<ut;_++)this.probe(this.upgrades[_])}}onPacket(_){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",_),this.emitReserved("heartbeat"),this.resetPingTimeout(),_.type){case"open":this.onHandshake(JSON.parse(_.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const ut=new Error("server error");ut.code=_.data,this.onError(ut);break;case"message":this.emitReserved("data",_.data),this.emitReserved("message",_.data);break}}onHandshake(_){this.emitReserved("handshake",_),this.id=_.sid,this.transport.query.sid=_.sid,this.upgrades=this.filterUpgrades(_.upgrades),this.pingInterval=_.pingInterval,this.pingTimeout=_.pingTimeout,this.maxPayload=_.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const _=this.getWritablePackets();this.transport.send(_),this.prevBufferLen=_.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let ut=1;for(let mt=0;mt<this.writeBuffer.length;mt++){const bt=this.writeBuffer[mt].data;if(bt&&(ut+=byteLength(bt)),mt>0&&ut>this.maxPayload)return this.writeBuffer.slice(0,mt);ut+=2}return this.writeBuffer}write(_,ut,mt){return this.sendPacket("message",_,ut,mt),this}send(_,ut,mt){return this.sendPacket("message",_,ut,mt),this}sendPacket(_,ut,mt,bt){if(typeof ut=="function"&&(bt=ut,ut=void 0),typeof mt=="function"&&(bt=mt,mt=null),this.readyState==="closing"||this.readyState==="closed")return;mt=mt||{},mt.compress=mt.compress!==!1;const St={type:_,data:ut,options:mt};this.emitReserved("packetCreate",St),this.writeBuffer.push(St),bt&&this.once("flush",bt),this.flush()}close(){const _=()=>{this.onClose("forced close"),this.transport.close()},ut=()=>{this.off("upgrade",ut),this.off("upgradeError",ut),_()},mt=()=>{this.once("upgrade",ut),this.once("upgradeError",ut)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?mt():_()}):this.upgrading?mt():_()),this}onError(_){YM.priorWebsocketSuccess=!1,this.emitReserved("error",_),this.onClose("transport error",_)}onClose(_,ut){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",_,ut),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(_){const ut=[];let mt=0;const bt=_.length;for(;mt<bt;mt++)~this.transports.indexOf(_[mt])&&ut.push(_[mt]);return ut}};Socket$1.protocol=protocol$1;function url(rt,_="",ut){let mt=rt;ut=ut||typeof location<"u"&&location,rt==null&&(rt=ut.protocol+"//"+ut.host),typeof rt=="string"&&(rt.charAt(0)==="/"&&(rt.charAt(1)==="/"?rt=ut.protocol+rt:rt=ut.host+rt),/^(https?|wss?):\/\//.test(rt)||(typeof ut<"u"?rt=ut.protocol+"//"+rt:rt="https://"+rt),mt=parse$1(rt)),mt.port||(/^(http|ws)$/.test(mt.protocol)?mt.port="80":/^(http|ws)s$/.test(mt.protocol)&&(mt.port="443")),mt.path=mt.path||"/";const St=mt.host.indexOf(":")!==-1?"["+mt.host+"]":mt.host;return mt.id=mt.protocol+"://"+St+":"+mt.port+_,mt.href=mt.protocol+"://"+St+(ut&&ut.port===mt.port?"":":"+mt.port),mt}const withNativeArrayBuffer=typeof ArrayBuffer=="function",isView=rt=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(rt):rt.buffer instanceof ArrayBuffer,toString$2=Object.prototype.toString,withNativeBlob=typeof Blob=="function"||typeof Blob<"u"&&toString$2.call(Blob)==="[object BlobConstructor]",withNativeFile=typeof File=="function"||typeof File<"u"&&toString$2.call(File)==="[object FileConstructor]";function isBinary(rt){return withNativeArrayBuffer&&(rt instanceof ArrayBuffer||isView(rt))||withNativeBlob&&rt instanceof Blob||withNativeFile&&rt instanceof File}function hasBinary(rt,_){if(!rt||typeof rt!="object")return!1;if(Array.isArray(rt)){for(let ut=0,mt=rt.length;ut<mt;ut++)if(hasBinary(rt[ut]))return!0;return!1}if(isBinary(rt))return!0;if(rt.toJSON&&typeof rt.toJSON=="function"&&arguments.length===1)return hasBinary(rt.toJSON(),!0);for(const ut in rt)if(Object.prototype.hasOwnProperty.call(rt,ut)&&hasBinary(rt[ut]))return!0;return!1}function deconstructPacket(rt){const _=[],ut=rt.data,mt=rt;return mt.data=_deconstructPacket(ut,_),mt.attachments=_.length,{packet:mt,buffers:_}}function _deconstructPacket(rt,_){if(!rt)return rt;if(isBinary(rt)){const ut={_placeholder:!0,num:_.length};return _.push(rt),ut}else if(Array.isArray(rt)){const ut=new Array(rt.length);for(let mt=0;mt<rt.length;mt++)ut[mt]=_deconstructPacket(rt[mt],_);return ut}else if(typeof rt=="object"&&!(rt instanceof Date)){const ut={};for(const mt in rt)Object.prototype.hasOwnProperty.call(rt,mt)&&(ut[mt]=_deconstructPacket(rt[mt],_));return ut}return rt}function reconstructPacket(rt,_){return rt.data=_reconstructPacket(rt.data,_),delete rt.attachments,rt}function _reconstructPacket(rt,_){if(!rt)return rt;if(rt&&rt._placeholder===!0){if(typeof rt.num=="number"&&rt.num>=0&&rt.num<_.length)return _[rt.num];throw new Error("illegal attachments")}else if(Array.isArray(rt))for(let ut=0;ut<rt.length;ut++)rt[ut]=_reconstructPacket(rt[ut],_);else if(typeof rt=="object")for(const ut in rt)Object.prototype.hasOwnProperty.call(rt,ut)&&(rt[ut]=_reconstructPacket(rt[ut],_));return rt}const RESERVED_EVENTS$1=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],protocol=5;var PacketType;(function(rt){rt[rt.CONNECT=0]="CONNECT",rt[rt.DISCONNECT=1]="DISCONNECT",rt[rt.EVENT=2]="EVENT",rt[rt.ACK=3]="ACK",rt[rt.CONNECT_ERROR=4]="CONNECT_ERROR",rt[rt.BINARY_EVENT=5]="BINARY_EVENT",rt[rt.BINARY_ACK=6]="BINARY_ACK"})(PacketType||(PacketType={}));class Encoder{constructor(_){this.replacer=_}encode(_){return(_.type===PacketType.EVENT||_.type===PacketType.ACK)&&hasBinary(_)?this.encodeAsBinary({type:_.type===PacketType.EVENT?PacketType.BINARY_EVENT:PacketType.BINARY_ACK,nsp:_.nsp,data:_.data,id:_.id}):[this.encodeAsString(_)]}encodeAsString(_){let ut=""+_.type;return(_.type===PacketType.BINARY_EVENT||_.type===PacketType.BINARY_ACK)&&(ut+=_.attachments+"-"),_.nsp&&_.nsp!=="/"&&(ut+=_.nsp+","),_.id!=null&&(ut+=_.id),_.data!=null&&(ut+=JSON.stringify(_.data,this.replacer)),ut}encodeAsBinary(_){const ut=deconstructPacket(_),mt=this.encodeAsString(ut.packet),bt=ut.buffers;return bt.unshift(mt),bt}}function isObject$a(rt){return Object.prototype.toString.call(rt)==="[object Object]"}class Decoder extends Emitter{constructor(_){super(),this.reviver=_}add(_){let ut;if(typeof _=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");ut=this.decodeString(_);const mt=ut.type===PacketType.BINARY_EVENT;mt||ut.type===PacketType.BINARY_ACK?(ut.type=mt?PacketType.EVENT:PacketType.ACK,this.reconstructor=new BinaryReconstructor(ut),ut.attachments===0&&super.emitReserved("decoded",ut)):super.emitReserved("decoded",ut)}else if(isBinary(_)||_.base64)if(this.reconstructor)ut=this.reconstructor.takeBinaryData(_),ut&&(this.reconstructor=null,super.emitReserved("decoded",ut));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+_)}decodeString(_){let ut=0;const mt={type:Number(_.charAt(0))};if(PacketType[mt.type]===void 0)throw new Error("unknown packet type "+mt.type);if(mt.type===PacketType.BINARY_EVENT||mt.type===PacketType.BINARY_ACK){const St=ut+1;for(;_.charAt(++ut)!=="-"&&ut!=_.length;);const Mt=_.substring(St,ut);if(Mt!=Number(Mt)||_.charAt(ut)!=="-")throw new Error("Illegal attachments");mt.attachments=Number(Mt)}if(_.charAt(ut+1)==="/"){const St=ut+1;for(;++ut&&!(_.charAt(ut)===","||ut===_.length););mt.nsp=_.substring(St,ut)}else mt.nsp="/";const bt=_.charAt(ut+1);if(bt!==""&&Number(bt)==bt){const St=ut+1;for(;++ut;){const Mt=_.charAt(ut);if(Mt==null||Number(Mt)!=Mt){--ut;break}if(ut===_.length)break}mt.id=Number(_.substring(St,ut+1))}if(_.charAt(++ut)){const St=this.tryParse(_.substr(ut));if(Decoder.isPayloadValid(mt.type,St))mt.data=St;else throw new Error("invalid payload")}return mt}tryParse(_){try{return JSON.parse(_,this.reviver)}catch{return!1}}static isPayloadValid(_,ut){switch(_){case PacketType.CONNECT:return isObject$a(ut);case PacketType.DISCONNECT:return ut===void 0;case PacketType.CONNECT_ERROR:return typeof ut=="string"||isObject$a(ut);case PacketType.EVENT:case PacketType.BINARY_EVENT:return Array.isArray(ut)&&(typeof ut[0]=="number"||typeof ut[0]=="string"&&RESERVED_EVENTS$1.indexOf(ut[0])===-1);case PacketType.ACK:case PacketType.BINARY_ACK:return Array.isArray(ut)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class BinaryReconstructor{constructor(_){this.packet=_,this.buffers=[],this.reconPack=_}takeBinaryData(_){if(this.buffers.push(_),this.buffers.length===this.reconPack.attachments){const ut=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),ut}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const parser=Object.freeze(Object.defineProperty({__proto__:null,Decoder,Encoder,get PacketType(){return PacketType},protocol},Symbol.toStringTag,{value:"Module"}));function on(rt,_,ut){return rt.on(_,ut),function(){rt.off(_,ut)}}const RESERVED_EVENTS=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Socket extends Emitter{constructor(_,ut,mt){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=_,this.nsp=ut,mt&&mt.auth&&(this.auth=mt.auth),this._opts=Object.assign({},mt),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const _=this.io;this.subs=[on(_,"open",this.onopen.bind(this)),on(_,"packet",this.onpacket.bind(this)),on(_,"error",this.onerror.bind(this)),on(_,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(..._){return _.unshift("message"),this.emit.apply(this,_),this}emit(_,...ut){if(RESERVED_EVENTS.hasOwnProperty(_))throw new Error('"'+_.toString()+'" is a reserved event name');if(ut.unshift(_),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(ut),this;const mt={type:PacketType.EVENT,data:ut};if(mt.options={},mt.options.compress=this.flags.compress!==!1,typeof ut[ut.length-1]=="function"){const Mt=this.ids++,Bt=ut.pop();this._registerAckCallback(Mt,Bt),mt.id=Mt}const bt=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!bt||!this.connected)||(this.connected?(this.notifyOutgoingListeners(mt),this.packet(mt)):this.sendBuffer.push(mt)),this.flags={},this}_registerAckCallback(_,ut){var mt;const bt=(mt=this.flags.timeout)!==null&&mt!==void 0?mt:this._opts.ackTimeout;if(bt===void 0){this.acks[_]=ut;return}const St=this.io.setTimeoutFn(()=>{delete this.acks[_];for(let Bt=0;Bt<this.sendBuffer.length;Bt++)this.sendBuffer[Bt].id===_&&this.sendBuffer.splice(Bt,1);ut.call(this,new Error("operation has timed out"))},bt),Mt=(...Bt)=>{this.io.clearTimeoutFn(St),ut.apply(this,Bt)};Mt.withError=!0,this.acks[_]=Mt}emitWithAck(_,...ut){return new Promise((mt,bt)=>{const St=(Mt,Bt)=>Mt?bt(Mt):mt(Bt);St.withError=!0,ut.push(St),this.emit(_,...ut)})}_addToQueue(_){let ut;typeof _[_.length-1]=="function"&&(ut=_.pop());const mt={id:this._queueSeq++,tryCount:0,pending:!1,args:_,flags:Object.assign({fromQueue:!0},this.flags)};_.push((bt,...St)=>mt!==this._queue[0]?void 0:(bt!==null?mt.tryCount>this._opts.retries&&(this._queue.shift(),ut&&ut(bt)):(this._queue.shift(),ut&&ut(null,...St)),mt.pending=!1,this._drainQueue())),this._queue.push(mt),this._drainQueue()}_drainQueue(_=!1){if(!this.connected||this._queue.length===0)return;const ut=this._queue[0];ut.pending&&!_||(ut.pending=!0,ut.tryCount++,this.flags=ut.flags,this.emit.apply(this,ut.args))}packet(_){_.nsp=this.nsp,this.io._packet(_)}onopen(){typeof this.auth=="function"?this.auth(_=>{this._sendConnectPacket(_)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(_){this.packet({type:PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},_):_})}onerror(_){this.connected||this.emitReserved("connect_error",_)}onclose(_,ut){this.connected=!1,delete this.id,this.emitReserved("disconnect",_,ut),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(_=>{if(!this.sendBuffer.some(mt=>String(mt.id)===_)){const mt=this.acks[_];delete this.acks[_],mt.withError&&mt.call(this,new Error("socket has been disconnected"))}})}onpacket(_){if(_.nsp===this.nsp)switch(_.type){case PacketType.CONNECT:_.data&&_.data.sid?this.onconnect(_.data.sid,_.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case PacketType.EVENT:case PacketType.BINARY_EVENT:this.onevent(_);break;case PacketType.ACK:case PacketType.BINARY_ACK:this.onack(_);break;case PacketType.DISCONNECT:this.ondisconnect();break;case PacketType.CONNECT_ERROR:this.destroy();const mt=new Error(_.data.message);mt.data=_.data.data,this.emitReserved("connect_error",mt);break}}onevent(_){const ut=_.data||[];_.id!=null&&ut.push(this.ack(_.id)),this.connected?this.emitEvent(ut):this.receiveBuffer.push(Object.freeze(ut))}emitEvent(_){if(this._anyListeners&&this._anyListeners.length){const ut=this._anyListeners.slice();for(const mt of ut)mt.apply(this,_)}super.emit.apply(this,_),this._pid&&_.length&&typeof _[_.length-1]=="string"&&(this._lastOffset=_[_.length-1])}ack(_){const ut=this;let mt=!1;return function(...bt){mt||(mt=!0,ut.packet({type:PacketType.ACK,id:_,data:bt}))}}onack(_){const ut=this.acks[_.id];typeof ut=="function"&&(delete this.acks[_.id],ut.withError&&_.data.unshift(null),ut.apply(this,_.data))}onconnect(_,ut){this.id=_,this.recovered=ut&&this._pid===ut,this._pid=ut,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(_=>this.emitEvent(_)),this.receiveBuffer=[],this.sendBuffer.forEach(_=>{this.notifyOutgoingListeners(_),this.packet(_)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(_=>_()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:PacketType.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(_){return this.flags.compress=_,this}get volatile(){return this.flags.volatile=!0,this}timeout(_){return this.flags.timeout=_,this}onAny(_){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(_),this}prependAny(_){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(_),this}offAny(_){if(!this._anyListeners)return this;if(_){const ut=this._anyListeners;for(let mt=0;mt<ut.length;mt++)if(_===ut[mt])return ut.splice(mt,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(_){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(_),this}prependAnyOutgoing(_){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(_),this}offAnyOutgoing(_){if(!this._anyOutgoingListeners)return this;if(_){const ut=this._anyOutgoingListeners;for(let mt=0;mt<ut.length;mt++)if(_===ut[mt])return ut.splice(mt,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(_){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const ut=this._anyOutgoingListeners.slice();for(const mt of ut)mt.apply(this,_.data)}}}function Backoff(rt){rt=rt||{},this.ms=rt.min||100,this.max=rt.max||1e4,this.factor=rt.factor||2,this.jitter=rt.jitter>0&&rt.jitter<=1?rt.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var rt=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var _=Math.random(),ut=Math.floor(_*this.jitter*rt);rt=Math.floor(_*10)&1?rt+ut:rt-ut}return Math.min(rt,this.max)|0};Backoff.prototype.reset=function(){this.attempts=0};Backoff.prototype.setMin=function(rt){this.ms=rt};Backoff.prototype.setMax=function(rt){this.max=rt};Backoff.prototype.setJitter=function(rt){this.jitter=rt};class Manager extends Emitter{constructor(_,ut){var mt;super(),this.nsps={},this.subs=[],_&&typeof _=="object"&&(ut=_,_=void 0),ut=ut||{},ut.path=ut.path||"/socket.io",this.opts=ut,installTimerFunctions(this,ut),this.reconnection(ut.reconnection!==!1),this.reconnectionAttempts(ut.reconnectionAttempts||1/0),this.reconnectionDelay(ut.reconnectionDelay||1e3),this.reconnectionDelayMax(ut.reconnectionDelayMax||5e3),this.randomizationFactor((mt=ut.randomizationFactor)!==null&&mt!==void 0?mt:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(ut.timeout==null?2e4:ut.timeout),this._readyState="closed",this.uri=_;const bt=ut.parser||parser;this.encoder=new bt.Encoder,this.decoder=new bt.Decoder,this._autoConnect=ut.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(_){return arguments.length?(this._reconnection=!!_,this):this._reconnection}reconnectionAttempts(_){return _===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=_,this)}reconnectionDelay(_){var ut;return _===void 0?this._reconnectionDelay:(this._reconnectionDelay=_,(ut=this.backoff)===null||ut===void 0||ut.setMin(_),this)}randomizationFactor(_){var ut;return _===void 0?this._randomizationFactor:(this._randomizationFactor=_,(ut=this.backoff)===null||ut===void 0||ut.setJitter(_),this)}reconnectionDelayMax(_){var ut;return _===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=_,(ut=this.backoff)===null||ut===void 0||ut.setMax(_),this)}timeout(_){return arguments.length?(this._timeout=_,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(_){if(~this._readyState.indexOf("open"))return this;this.engine=new Socket$1(this.uri,this.opts);const ut=this.engine,mt=this;this._readyState="opening",this.skipReconnect=!1;const bt=on(ut,"open",function(){mt.onopen(),_&&_()}),St=Bt=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",Bt),_?_(Bt):this.maybeReconnectOnOpen()},Mt=on(ut,"error",St);if(this._timeout!==!1){const Bt=this._timeout,Ut=this.setTimeoutFn(()=>{bt(),St(new Error("timeout")),ut.close()},Bt);this.opts.autoUnref&&Ut.unref(),this.subs.push(()=>{this.clearTimeoutFn(Ut)})}return this.subs.push(bt),this.subs.push(Mt),this}connect(_){return this.open(_)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const _=this.engine;this.subs.push(on(_,"ping",this.onping.bind(this)),on(_,"data",this.ondata.bind(this)),on(_,"error",this.onerror.bind(this)),on(_,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(_){try{this.decoder.add(_)}catch(ut){this.onclose("parse error",ut)}}ondecoded(_){nextTick(()=>{this.emitReserved("packet",_)},this.setTimeoutFn)}onerror(_){this.emitReserved("error",_)}socket(_,ut){let mt=this.nsps[_];return mt?this._autoConnect&&!mt.active&&mt.connect():(mt=new Socket(this,_,ut),this.nsps[_]=mt),mt}_destroy(_){const ut=Object.keys(this.nsps);for(const mt of ut)if(this.nsps[mt].active)return;this._close()}_packet(_){const ut=this.encoder.encode(_);for(let mt=0;mt<ut.length;mt++)this.engine.write(ut[mt],_.options)}cleanup(){this.subs.forEach(_=>_()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(_,ut){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",_,ut),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const _=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const ut=this.backoff.duration();this._reconnecting=!0;const mt=this.setTimeoutFn(()=>{_.skipReconnect||(this.emitReserved("reconnect_attempt",_.backoff.attempts),!_.skipReconnect&&_.open(bt=>{bt?(_._reconnecting=!1,_.reconnect(),this.emitReserved("reconnect_error",bt)):_.onreconnect()}))},ut);this.opts.autoUnref&&mt.unref(),this.subs.push(()=>{this.clearTimeoutFn(mt)})}}onreconnect(){const _=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",_)}}const cache={};function lookup(rt,_){typeof rt=="object"&&(_=rt,rt=void 0),_=_||{};const ut=url(rt,_.path||"/socket.io"),mt=ut.source,bt=ut.id,St=ut.path,Mt=cache[bt]&&St in cache[bt].nsps,Bt=_.forceNew||_["force new connection"]||_.multiplex===!1||Mt;let Ut;return Bt?Ut=new Manager(mt,_):(cache[bt]||(cache[bt]=new Manager(mt,_)),Ut=cache[bt]),ut.query&&!_.query&&(_.query=ut.queryKey),Ut.socket(ut.path,_)}Object.assign(lookup,{Manager,Socket,io:lookup,connect:lookup});const useSocketIO=()=>{const rt="871410a4-9675-447a-94ee-2933c7fd1f97",[_,ut]=reactExports.useState(),[mt,bt]=reactExports.useState(0),St=reactExports.useCallback(()=>{const Mt=lookup("wss://aiopen.cytelab.net",{transports:["websocket"],reconnectionDelay:6e4,reconnectionAttempts:10,auth:{uid:rt},path:"/paid/ws"});ut(Mt),Mt.on("connect",()=>{console.log("socket connected"),bt(0)}),Mt.on("disconnect",()=>{console.log("socket disconnected"),bt(Ut=>Ut+1)});const Bt=()=>{Mt.close()};return()=>{Bt()}},[_,rt]);return reactExports.useEffect(()=>{mt>0&&console.log("wsfailed",mt)},[mt]),reactExports.useEffect(()=>{const Mt=St();return()=>{Mt()}},[rt]),{socket:_}};function bind(rt,_){return function(){return rt.apply(_,arguments)}}const{toString:toString$1}=Object.prototype,{getPrototypeOf}=Object,kindOf=(rt=>_=>{const ut=toString$1.call(_);return rt[ut]||(rt[ut]=ut.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=rt=>(rt=rt.toLowerCase(),_=>kindOf(_)===rt),typeOfTest=rt=>_=>typeof _===rt,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(rt){return rt!==null&&!isUndefined(rt)&&rt.constructor!==null&&!isUndefined(rt.constructor)&&isFunction(rt.constructor.isBuffer)&&rt.constructor.isBuffer(rt)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(rt){let _;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?_=ArrayBuffer.isView(rt):_=rt&&rt.buffer&&isArrayBuffer(rt.buffer),_}const isString$2=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber$1=typeOfTest("number"),isObject$9=rt=>rt!==null&&typeof rt=="object",isBoolean=rt=>rt===!0||rt===!1,isPlainObject$3=rt=>{if(kindOf(rt)!=="object")return!1;const _=getPrototypeOf(rt);return(_===null||_===Object.prototype||Object.getPrototypeOf(_)===null)&&!(Symbol.toStringTag in rt)&&!(Symbol.iterator in rt)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=rt=>isObject$9(rt)&&isFunction(rt.pipe),isFormData=rt=>{let _;return rt&&(typeof FormData=="function"&&rt instanceof FormData||isFunction(rt.append)&&((_=kindOf(rt))==="formdata"||_==="object"&&isFunction(rt.toString)&&rt.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=rt=>rt.trim?rt.trim():rt.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(rt,_,{allOwnKeys:ut=!1}={}){if(rt===null||typeof rt>"u")return;let mt,bt;if(typeof rt!="object"&&(rt=[rt]),isArray(rt))for(mt=0,bt=rt.length;mt<bt;mt++)_.call(null,rt[mt],mt,rt);else{const St=ut?Object.getOwnPropertyNames(rt):Object.keys(rt),Mt=St.length;let Bt;for(mt=0;mt<Mt;mt++)Bt=St[mt],_.call(null,rt[Bt],Bt,rt)}}function findKey(rt,_){_=_.toLowerCase();const ut=Object.keys(rt);let mt=ut.length,bt;for(;mt-- >0;)if(bt=ut[mt],_===bt.toLowerCase())return bt;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=rt=>!isUndefined(rt)&&rt!==_global;function merge$2(){const{caseless:rt}=isContextDefined(this)&&this||{},_={},ut=(mt,bt)=>{const St=rt&&findKey(_,bt)||bt;isPlainObject$3(_[St])&&isPlainObject$3(mt)?_[St]=merge$2(_[St],mt):isPlainObject$3(mt)?_[St]=merge$2({},mt):isArray(mt)?_[St]=mt.slice():_[St]=mt};for(let mt=0,bt=arguments.length;mt<bt;mt++)arguments[mt]&&forEach(arguments[mt],ut);return _}const extend$2=(rt,_,ut,{allOwnKeys:mt}={})=>(forEach(_,(bt,St)=>{ut&&isFunction(bt)?rt[St]=bind(bt,ut):rt[St]=bt},{allOwnKeys:mt}),rt),stripBOM=rt=>(rt.charCodeAt(0)===65279&&(rt=rt.slice(1)),rt),inherits=(rt,_,ut,mt)=>{rt.prototype=Object.create(_.prototype,mt),rt.prototype.constructor=rt,Object.defineProperty(rt,"super",{value:_.prototype}),ut&&Object.assign(rt.prototype,ut)},toFlatObject=(rt,_,ut,mt)=>{let bt,St,Mt;const Bt={};if(_=_||{},rt==null)return _;do{for(bt=Object.getOwnPropertyNames(rt),St=bt.length;St-- >0;)Mt=bt[St],(!mt||mt(Mt,rt,_))&&!Bt[Mt]&&(_[Mt]=rt[Mt],Bt[Mt]=!0);rt=ut!==!1&&getPrototypeOf(rt)}while(rt&&(!ut||ut(rt,_))&&rt!==Object.prototype);return _},endsWith=(rt,_,ut)=>{rt=String(rt),(ut===void 0||ut>rt.length)&&(ut=rt.length),ut-=_.length;const mt=rt.indexOf(_,ut);return mt!==-1&&mt===ut},toArray$1=rt=>{if(!rt)return null;if(isArray(rt))return rt;let _=rt.length;if(!isNumber$1(_))return null;const ut=new Array(_);for(;_-- >0;)ut[_]=rt[_];return ut},isTypedArray=(rt=>_=>rt&&_ instanceof rt)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(rt,_)=>{const mt=(rt&&rt[Symbol.iterator]).call(rt);let bt;for(;(bt=mt.next())&&!bt.done;){const St=bt.value;_.call(rt,St[0],St[1])}},matchAll=(rt,_)=>{let ut;const mt=[];for(;(ut=rt.exec(_))!==null;)mt.push(ut);return mt},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=rt=>rt.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(ut,mt,bt){return mt.toUpperCase()+bt}),hasOwnProperty=(({hasOwnProperty:rt})=>(_,ut)=>rt.call(_,ut))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(rt,_)=>{const ut=Object.getOwnPropertyDescriptors(rt),mt={};forEach(ut,(bt,St)=>{let Mt;(Mt=_(bt,St,rt))!==!1&&(mt[St]=Mt||bt)}),Object.defineProperties(rt,mt)},freezeMethods=rt=>{reduceDescriptors(rt,(_,ut)=>{if(isFunction(rt)&&["arguments","caller","callee"].indexOf(ut)!==-1)return!1;const mt=rt[ut];if(isFunction(mt)){if(_.enumerable=!1,"writable"in _){_.writable=!1;return}_.set||(_.set=()=>{throw Error("Can not rewrite read-only method '"+ut+"'")})}})},toObjectSet=(rt,_)=>{const ut={},mt=bt=>{bt.forEach(St=>{ut[St]=!0})};return isArray(rt)?mt(rt):mt(String(rt).split(_)),ut},noop$2=()=>{},toFiniteNumber=(rt,_)=>(rt=+rt,Number.isFinite(rt)?rt:_),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(rt=16,_=ALPHABET.ALPHA_DIGIT)=>{let ut="";const{length:mt}=_;for(;rt--;)ut+=_[Math.random()*mt|0];return ut};function isSpecCompliantForm(rt){return!!(rt&&isFunction(rt.append)&&rt[Symbol.toStringTag]==="FormData"&&rt[Symbol.iterator])}const toJSONObject=rt=>{const _=new Array(10),ut=(mt,bt)=>{if(isObject$9(mt)){if(_.indexOf(mt)>=0)return;if(!("toJSON"in mt)){_[bt]=mt;const St=isArray(mt)?[]:{};return forEach(mt,(Mt,Bt)=>{const Ut=ut(Mt,bt+1);!isUndefined(Ut)&&(St[Bt]=Ut)}),_[bt]=void 0,St}}return mt};return ut(rt,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=rt=>rt&&(isObject$9(rt)||isFunction(rt))&&isFunction(rt.then)&&isFunction(rt.catch),utils$2={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString:isString$2,isNumber:isNumber$1,isBoolean,isObject:isObject$9,isPlainObject:isPlainObject$3,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge:merge$2,extend:extend$2,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray:toArray$1,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop:noop$2,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(rt,_,ut,mt,bt){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=rt,this.name="AxiosError",_&&(this.code=_),ut&&(this.config=ut),mt&&(this.request=mt),bt&&(this.response=bt)}utils$2.inherits(AxiosError,Error,{toJSON:function rt(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$2.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(rt=>{descriptors[rt]={value:rt}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(rt,_,ut,mt,bt,St)=>{const Mt=Object.create(prototype$1);return utils$2.toFlatObject(rt,Mt,function(Ut){return Ut!==Error.prototype},Bt=>Bt!=="isAxiosError"),AxiosError.call(Mt,rt.message,_,ut,mt,bt),Mt.cause=rt,Mt.name=rt.name,St&&Object.assign(Mt,St),Mt};const httpAdapter=null;function isVisitable(rt){return utils$2.isPlainObject(rt)||utils$2.isArray(rt)}function removeBrackets(rt){return utils$2.endsWith(rt,"[]")?rt.slice(0,-2):rt}function renderKey(rt,_,ut){return rt?rt.concat(_).map(function(bt,St){return bt=removeBrackets(bt),!ut&&St?"["+bt+"]":bt}).join(ut?".":""):_}function isFlatArray(rt){return utils$2.isArray(rt)&&!rt.some(isVisitable)}const predicates=utils$2.toFlatObject(utils$2,{},null,function rt(_){return/^is[A-Z]/.test(_)});function toFormData(rt,_,ut){if(!utils$2.isObject(rt))throw new TypeError("target must be an object");_=_||new FormData,ut=utils$2.toFlatObject(ut,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Ar,_r){return!utils$2.isUndefined(_r[Ar])});const mt=ut.metaTokens,bt=ut.visitor||tr,St=ut.dots,Mt=ut.indexes,Ut=(ut.Blob||typeof Blob<"u"&&Blob)&&utils$2.isSpecCompliantForm(_);if(!utils$2.isFunction(bt))throw new TypeError("visitor must be a function");function Ht(cr){if(cr===null)return"";if(utils$2.isDate(cr))return cr.toISOString();if(!Ut&&utils$2.isBlob(cr))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$2.isArrayBuffer(cr)||utils$2.isTypedArray(cr)?Ut&&typeof Blob=="function"?new Blob([cr]):Buffer.from(cr):cr}function tr(cr,Ar,_r){let Dr=cr;if(cr&&!_r&&typeof cr=="object"){if(utils$2.endsWith(Ar,"{}"))Ar=mt?Ar:Ar.slice(0,-2),cr=JSON.stringify(cr);else if(utils$2.isArray(cr)&&isFlatArray(cr)||(utils$2.isFileList(cr)||utils$2.endsWith(Ar,"[]"))&&(Dr=utils$2.toArray(cr)))return Ar=removeBrackets(Ar),Dr.forEach(function(Br,Jr){!(utils$2.isUndefined(Br)||Br===null)&&_.append(Mt===!0?renderKey([Ar],Jr,St):Mt===null?Ar:Ar+"[]",Ht(Br))}),!1}return isVisitable(cr)?!0:(_.append(renderKey(_r,Ar,St),Ht(cr)),!1)}const rr=[],sr=Object.assign(predicates,{defaultVisitor:tr,convertValue:Ht,isVisitable});function ar(cr,Ar){if(!utils$2.isUndefined(cr)){if(rr.indexOf(cr)!==-1)throw Error("Circular reference detected in "+Ar.join("."));rr.push(cr),utils$2.forEach(cr,function(Dr,$r){(!(utils$2.isUndefined(Dr)||Dr===null)&&bt.call(_,Dr,utils$2.isString($r)?$r.trim():$r,Ar,sr))===!0&&ar(Dr,Ar?Ar.concat($r):[$r])}),rr.pop()}}if(!utils$2.isObject(rt))throw new TypeError("data must be an object");return ar(rt),_}function encode$1(rt){const _={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(rt).replace(/[!'()~]|%20|%00/g,function(mt){return _[mt]})}function AxiosURLSearchParams(rt,_){this._pairs=[],rt&&toFormData(rt,this,_)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function rt(_,ut){this._pairs.push([_,ut])};prototype.toString=function rt(_){const ut=_?function(mt){return _.call(this,mt,encode$1)}:encode$1;return this._pairs.map(function(bt){return ut(bt[0])+"="+ut(bt[1])},"").join("&")};function encode(rt){return encodeURIComponent(rt).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(rt,_,ut){if(!_)return rt;const mt=ut&&ut.encode||encode,bt=ut&&ut.serialize;let St;if(bt?St=bt(_,ut):St=utils$2.isURLSearchParams(_)?_.toString():new AxiosURLSearchParams(_,ut).toString(mt),St){const Mt=rt.indexOf("#");Mt!==-1&&(rt=rt.slice(0,Mt)),rt+=(rt.indexOf("?")===-1?"?":"&")+St}return rt}class InterceptorManager{constructor(){this.handlers=[]}use(_,ut,mt){return this.handlers.push({fulfilled:_,rejected:ut,synchronous:mt?mt.synchronous:!1,runWhen:mt?mt.runWhen:null}),this.handlers.length-1}eject(_){this.handlers[_]&&(this.handlers[_]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(_){utils$2.forEach(this.handlers,function(mt){mt!==null&&_(mt)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$2={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(rt=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(rt)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",utils$1=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv},Symbol.toStringTag,{value:"Module"})),platform$1={...utils$1,...platform$2};function toURLEncodedForm(rt,_){return toFormData(rt,new platform$1.classes.URLSearchParams,Object.assign({visitor:function(ut,mt,bt,St){return platform$1.isNode&&utils$2.isBuffer(ut)?(this.append(mt,ut.toString("base64")),!1):St.defaultVisitor.apply(this,arguments)}},_))}function parsePropPath(rt){return utils$2.matchAll(/\w+|\[(\w*)]/g,rt).map(_=>_[0]==="[]"?"":_[1]||_[0])}function arrayToObject(rt){const _={},ut=Object.keys(rt);let mt;const bt=ut.length;let St;for(mt=0;mt<bt;mt++)St=ut[mt],_[St]=rt[St];return _}function formDataToJSON(rt){function _(ut,mt,bt,St){let Mt=ut[St++];if(Mt==="__proto__")return!0;const Bt=Number.isFinite(+Mt),Ut=St>=ut.length;return Mt=!Mt&&utils$2.isArray(bt)?bt.length:Mt,Ut?(utils$2.hasOwnProp(bt,Mt)?bt[Mt]=[bt[Mt],mt]:bt[Mt]=mt,!Bt):((!bt[Mt]||!utils$2.isObject(bt[Mt]))&&(bt[Mt]=[]),_(ut,mt,bt[Mt],St)&&utils$2.isArray(bt[Mt])&&(bt[Mt]=arrayToObject(bt[Mt])),!Bt)}if(utils$2.isFormData(rt)&&utils$2.isFunction(rt.entries)){const ut={};return utils$2.forEachEntry(rt,(mt,bt)=>{_(parsePropPath(mt),bt,ut,0)}),ut}return null}function stringifySafely(rt,_,ut){if(utils$2.isString(rt))try{return(_||JSON.parse)(rt),utils$2.trim(rt)}catch(mt){if(mt.name!=="SyntaxError")throw mt}return(ut||JSON.stringify)(rt)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http"],transformRequest:[function rt(_,ut){const mt=ut.getContentType()||"",bt=mt.indexOf("application/json")>-1,St=utils$2.isObject(_);if(St&&utils$2.isHTMLForm(_)&&(_=new FormData(_)),utils$2.isFormData(_))return bt?JSON.stringify(formDataToJSON(_)):_;if(utils$2.isArrayBuffer(_)||utils$2.isBuffer(_)||utils$2.isStream(_)||utils$2.isFile(_)||utils$2.isBlob(_))return _;if(utils$2.isArrayBufferView(_))return _.buffer;if(utils$2.isURLSearchParams(_))return ut.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),_.toString();let Bt;if(St){if(mt.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(_,this.formSerializer).toString();if((Bt=utils$2.isFileList(_))||mt.indexOf("multipart/form-data")>-1){const Ut=this.env&&this.env.FormData;return toFormData(Bt?{"files[]":_}:_,Ut&&new Ut,this.formSerializer)}}return St||bt?(ut.setContentType("application/json",!1),stringifySafely(_)):_}],transformResponse:[function rt(_){const ut=this.transitional||defaults.transitional,mt=ut&&ut.forcedJSONParsing,bt=this.responseType==="json";if(_&&utils$2.isString(_)&&(mt&&!this.responseType||bt)){const Mt=!(ut&&ut.silentJSONParsing)&&bt;try{return JSON.parse(_)}catch(Bt){if(Mt)throw Bt.name==="SyntaxError"?AxiosError.from(Bt,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):Bt}}return _}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform$1.classes.FormData,Blob:platform$1.classes.Blob},validateStatus:function rt(_){return _>=200&&_<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$2.forEach(["delete","get","head","post","put","patch"],rt=>{defaults.headers[rt]={}});const ignoreDuplicateOf=utils$2.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=rt=>{const _={};let ut,mt,bt;return rt&&rt.split(`
`).forEach(function(Mt){bt=Mt.indexOf(":"),ut=Mt.substring(0,bt).trim().toLowerCase(),mt=Mt.substring(bt+1).trim(),!(!ut||_[ut]&&ignoreDuplicateOf[ut])&&(ut==="set-cookie"?_[ut]?_[ut].push(mt):_[ut]=[mt]:_[ut]=_[ut]?_[ut]+", "+mt:mt)}),_},$internals=Symbol("internals");function normalizeHeader(rt){return rt&&String(rt).trim().toLowerCase()}function normalizeValue(rt){return rt===!1||rt==null?rt:utils$2.isArray(rt)?rt.map(normalizeValue):String(rt)}function parseTokens(rt){const _=Object.create(null),ut=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let mt;for(;mt=ut.exec(rt);)_[mt[1]]=mt[2];return _}const isValidHeaderName=rt=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(rt.trim());function matchHeaderValue(rt,_,ut,mt,bt){if(utils$2.isFunction(mt))return mt.call(this,_,ut);if(bt&&(_=ut),!!utils$2.isString(_)){if(utils$2.isString(mt))return _.indexOf(mt)!==-1;if(utils$2.isRegExp(mt))return mt.test(_)}}function formatHeader(rt){return rt.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(_,ut,mt)=>ut.toUpperCase()+mt)}function buildAccessors(rt,_){const ut=utils$2.toCamelCase(" "+_);["get","set","has"].forEach(mt=>{Object.defineProperty(rt,mt+ut,{value:function(bt,St,Mt){return this[mt].call(this,_,bt,St,Mt)},configurable:!0})})}class AxiosHeaders{constructor(_){_&&this.set(_)}set(_,ut,mt){const bt=this;function St(Bt,Ut,Ht){const tr=normalizeHeader(Ut);if(!tr)throw new Error("header name must be a non-empty string");const rr=utils$2.findKey(bt,tr);(!rr||bt[rr]===void 0||Ht===!0||Ht===void 0&&bt[rr]!==!1)&&(bt[rr||Ut]=normalizeValue(Bt))}const Mt=(Bt,Ut)=>utils$2.forEach(Bt,(Ht,tr)=>St(Ht,tr,Ut));return utils$2.isPlainObject(_)||_ instanceof this.constructor?Mt(_,ut):utils$2.isString(_)&&(_=_.trim())&&!isValidHeaderName(_)?Mt(parseHeaders(_),ut):_!=null&&St(ut,_,mt),this}get(_,ut){if(_=normalizeHeader(_),_){const mt=utils$2.findKey(this,_);if(mt){const bt=this[mt];if(!ut)return bt;if(ut===!0)return parseTokens(bt);if(utils$2.isFunction(ut))return ut.call(this,bt,mt);if(utils$2.isRegExp(ut))return ut.exec(bt);throw new TypeError("parser must be boolean|regexp|function")}}}has(_,ut){if(_=normalizeHeader(_),_){const mt=utils$2.findKey(this,_);return!!(mt&&this[mt]!==void 0&&(!ut||matchHeaderValue(this,this[mt],mt,ut)))}return!1}delete(_,ut){const mt=this;let bt=!1;function St(Mt){if(Mt=normalizeHeader(Mt),Mt){const Bt=utils$2.findKey(mt,Mt);Bt&&(!ut||matchHeaderValue(mt,mt[Bt],Bt,ut))&&(delete mt[Bt],bt=!0)}}return utils$2.isArray(_)?_.forEach(St):St(_),bt}clear(_){const ut=Object.keys(this);let mt=ut.length,bt=!1;for(;mt--;){const St=ut[mt];(!_||matchHeaderValue(this,this[St],St,_,!0))&&(delete this[St],bt=!0)}return bt}normalize(_){const ut=this,mt={};return utils$2.forEach(this,(bt,St)=>{const Mt=utils$2.findKey(mt,St);if(Mt){ut[Mt]=normalizeValue(bt),delete ut[St];return}const Bt=_?formatHeader(St):String(St).trim();Bt!==St&&delete ut[St],ut[Bt]=normalizeValue(bt),mt[Bt]=!0}),this}concat(..._){return this.constructor.concat(this,..._)}toJSON(_){const ut=Object.create(null);return utils$2.forEach(this,(mt,bt)=>{mt!=null&&mt!==!1&&(ut[bt]=_&&utils$2.isArray(mt)?mt.join(", "):mt)}),ut}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([_,ut])=>_+": "+ut).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(_){return _ instanceof this?_:new this(_)}static concat(_,...ut){const mt=new this(_);return ut.forEach(bt=>mt.set(bt)),mt}static accessor(_){const mt=(this[$internals]=this[$internals]={accessors:{}}).accessors,bt=this.prototype;function St(Mt){const Bt=normalizeHeader(Mt);mt[Bt]||(buildAccessors(bt,Mt),mt[Bt]=!0)}return utils$2.isArray(_)?_.forEach(St):St(_),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$2.reduceDescriptors(AxiosHeaders.prototype,({value:rt},_)=>{let ut=_[0].toUpperCase()+_.slice(1);return{get:()=>rt,set(mt){this[ut]=mt}}});utils$2.freezeMethods(AxiosHeaders);function transformData(rt,_){const ut=this||defaults,mt=_||ut,bt=AxiosHeaders.from(mt.headers);let St=mt.data;return utils$2.forEach(rt,function(Bt){St=Bt.call(ut,St,bt.normalize(),_?_.status:void 0)}),bt.normalize(),St}function isCancel(rt){return!!(rt&&rt.__CANCEL__)}function CanceledError(rt,_,ut){AxiosError.call(this,rt??"canceled",AxiosError.ERR_CANCELED,_,ut),this.name="CanceledError"}utils$2.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(rt,_,ut){const mt=ut.config.validateStatus;!ut.status||!mt||mt(ut.status)?rt(ut):_(new AxiosError("Request failed with status code "+ut.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(ut.status/100)-4],ut.config,ut.request,ut))}const cookies=platform$1.hasStandardBrowserEnv?{write(rt,_,ut,mt,bt,St){const Mt=[rt+"="+encodeURIComponent(_)];utils$2.isNumber(ut)&&Mt.push("expires="+new Date(ut).toGMTString()),utils$2.isString(mt)&&Mt.push("path="+mt),utils$2.isString(bt)&&Mt.push("domain="+bt),St===!0&&Mt.push("secure"),document.cookie=Mt.join("; ")},read(rt){const _=document.cookie.match(new RegExp("(^|;\\s*)("+rt+")=([^;]*)"));return _?decodeURIComponent(_[3]):null},remove(rt){this.write(rt,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(rt){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(rt)}function combineURLs(rt,_){return _?rt.replace(/\/?\/$/,"")+"/"+_.replace(/^\/+/,""):rt}function buildFullPath(rt,_){return rt&&!isAbsoluteURL(_)?combineURLs(rt,_):_}const isURLSameOrigin=platform$1.hasStandardBrowserEnv?function rt(){const _=/(msie|trident)/i.test(navigator.userAgent),ut=document.createElement("a");let mt;function bt(St){let Mt=St;return _&&(ut.setAttribute("href",Mt),Mt=ut.href),ut.setAttribute("href",Mt),{href:ut.href,protocol:ut.protocol?ut.protocol.replace(/:$/,""):"",host:ut.host,search:ut.search?ut.search.replace(/^\?/,""):"",hash:ut.hash?ut.hash.replace(/^#/,""):"",hostname:ut.hostname,port:ut.port,pathname:ut.pathname.charAt(0)==="/"?ut.pathname:"/"+ut.pathname}}return mt=bt(window.location.href),function(Mt){const Bt=utils$2.isString(Mt)?bt(Mt):Mt;return Bt.protocol===mt.protocol&&Bt.host===mt.host}}():function rt(){return function(){return!0}}();function parseProtocol(rt){const _=/^([-+\w]{1,25})(:?\/\/|:)/.exec(rt);return _&&_[1]||""}function speedometer(rt,_){rt=rt||10;const ut=new Array(rt),mt=new Array(rt);let bt=0,St=0,Mt;return _=_!==void 0?_:1e3,function(Ut){const Ht=Date.now(),tr=mt[St];Mt||(Mt=Ht),ut[bt]=Ut,mt[bt]=Ht;let rr=St,sr=0;for(;rr!==bt;)sr+=ut[rr++],rr=rr%rt;if(bt=(bt+1)%rt,bt===St&&(St=(St+1)%rt),Ht-Mt<_)return;const ar=tr&&Ht-tr;return ar?Math.round(sr*1e3/ar):void 0}}function progressEventReducer(rt,_){let ut=0;const mt=speedometer(50,250);return bt=>{const St=bt.loaded,Mt=bt.lengthComputable?bt.total:void 0,Bt=St-ut,Ut=mt(Bt),Ht=St<=Mt;ut=St;const tr={loaded:St,total:Mt,progress:Mt?St/Mt:void 0,bytes:Bt,rate:Ut||void 0,estimated:Ut&&Mt&&Ht?(Mt-St)/Ut:void 0,event:bt};tr[_?"download":"upload"]=!0,rt(tr)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(rt){return new Promise(function(ut,mt){let bt=rt.data;const St=AxiosHeaders.from(rt.headers).normalize();let{responseType:Mt,withXSRFToken:Bt}=rt,Ut;function Ht(){rt.cancelToken&&rt.cancelToken.unsubscribe(Ut),rt.signal&&rt.signal.removeEventListener("abort",Ut)}let tr;if(utils$2.isFormData(bt)){if(platform$1.hasStandardBrowserEnv||platform$1.hasStandardBrowserWebWorkerEnv)St.setContentType(!1);else if((tr=St.getContentType())!==!1){const[Ar,..._r]=tr?tr.split(";").map(Dr=>Dr.trim()).filter(Boolean):[];St.setContentType([Ar||"multipart/form-data",..._r].join("; "))}}let rr=new XMLHttpRequest;if(rt.auth){const Ar=rt.auth.username||"",_r=rt.auth.password?unescape(encodeURIComponent(rt.auth.password)):"";St.set("Authorization","Basic "+btoa(Ar+":"+_r))}const sr=buildFullPath(rt.baseURL,rt.url);rr.open(rt.method.toUpperCase(),buildURL(sr,rt.params,rt.paramsSerializer),!0),rr.timeout=rt.timeout;function ar(){if(!rr)return;const Ar=AxiosHeaders.from("getAllResponseHeaders"in rr&&rr.getAllResponseHeaders()),Dr={data:!Mt||Mt==="text"||Mt==="json"?rr.responseText:rr.response,status:rr.status,statusText:rr.statusText,headers:Ar,config:rt,request:rr};settle(function(Br){ut(Br),Ht()},function(Br){mt(Br),Ht()},Dr),rr=null}if("onloadend"in rr?rr.onloadend=ar:rr.onreadystatechange=function(){!rr||rr.readyState!==4||rr.status===0&&!(rr.responseURL&&rr.responseURL.indexOf("file:")===0)||setTimeout(ar)},rr.onabort=function(){rr&&(mt(new AxiosError("Request aborted",AxiosError.ECONNABORTED,rt,rr)),rr=null)},rr.onerror=function(){mt(new AxiosError("Network Error",AxiosError.ERR_NETWORK,rt,rr)),rr=null},rr.ontimeout=function(){let _r=rt.timeout?"timeout of "+rt.timeout+"ms exceeded":"timeout exceeded";const Dr=rt.transitional||transitionalDefaults;rt.timeoutErrorMessage&&(_r=rt.timeoutErrorMessage),mt(new AxiosError(_r,Dr.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,rt,rr)),rr=null},platform$1.hasStandardBrowserEnv&&(Bt&&utils$2.isFunction(Bt)&&(Bt=Bt(rt)),Bt||Bt!==!1&&isURLSameOrigin(sr))){const Ar=rt.xsrfHeaderName&&rt.xsrfCookieName&&cookies.read(rt.xsrfCookieName);Ar&&St.set(rt.xsrfHeaderName,Ar)}bt===void 0&&St.setContentType(null),"setRequestHeader"in rr&&utils$2.forEach(St.toJSON(),function(_r,Dr){rr.setRequestHeader(Dr,_r)}),utils$2.isUndefined(rt.withCredentials)||(rr.withCredentials=!!rt.withCredentials),Mt&&Mt!=="json"&&(rr.responseType=rt.responseType),typeof rt.onDownloadProgress=="function"&&rr.addEventListener("progress",progressEventReducer(rt.onDownloadProgress,!0)),typeof rt.onUploadProgress=="function"&&rr.upload&&rr.upload.addEventListener("progress",progressEventReducer(rt.onUploadProgress)),(rt.cancelToken||rt.signal)&&(Ut=Ar=>{rr&&(mt(!Ar||Ar.type?new CanceledError(null,rt,rr):Ar),rr.abort(),rr=null)},rt.cancelToken&&rt.cancelToken.subscribe(Ut),rt.signal&&(rt.signal.aborted?Ut():rt.signal.addEventListener("abort",Ut)));const cr=parseProtocol(sr);if(cr&&platform$1.protocols.indexOf(cr)===-1){mt(new AxiosError("Unsupported protocol "+cr+":",AxiosError.ERR_BAD_REQUEST,rt));return}rr.send(bt||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils$2.forEach(knownAdapters,(rt,_)=>{if(rt){try{Object.defineProperty(rt,"name",{value:_})}catch{}Object.defineProperty(rt,"adapterName",{value:_})}});const renderReason=rt=>`- ${rt}`,isResolvedHandle=rt=>utils$2.isFunction(rt)||rt===null||rt===!1,adapters={getAdapter:rt=>{rt=utils$2.isArray(rt)?rt:[rt];const{length:_}=rt;let ut,mt;const bt={};for(let St=0;St<_;St++){ut=rt[St];let Mt;if(mt=ut,!isResolvedHandle(ut)&&(mt=knownAdapters[(Mt=String(ut)).toLowerCase()],mt===void 0))throw new AxiosError(`Unknown adapter '${Mt}'`);if(mt)break;bt[Mt||"#"+St]=mt}if(!mt){const St=Object.entries(bt).map(([Bt,Ut])=>`adapter ${Bt} `+(Ut===!1?"is not supported by the environment":"is not available in the build"));let Mt=_?St.length>1?`since :
`+St.map(renderReason).join(`
`):" "+renderReason(St[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+Mt,"ERR_NOT_SUPPORT")}return mt},adapters:knownAdapters};function throwIfCancellationRequested(rt){if(rt.cancelToken&&rt.cancelToken.throwIfRequested(),rt.signal&&rt.signal.aborted)throw new CanceledError(null,rt)}function dispatchRequest(rt){return throwIfCancellationRequested(rt),rt.headers=AxiosHeaders.from(rt.headers),rt.data=transformData.call(rt,rt.transformRequest),["post","put","patch"].indexOf(rt.method)!==-1&&rt.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(rt.adapter||defaults.adapter)(rt).then(function(mt){return throwIfCancellationRequested(rt),mt.data=transformData.call(rt,rt.transformResponse,mt),mt.headers=AxiosHeaders.from(mt.headers),mt},function(mt){return isCancel(mt)||(throwIfCancellationRequested(rt),mt&&mt.response&&(mt.response.data=transformData.call(rt,rt.transformResponse,mt.response),mt.response.headers=AxiosHeaders.from(mt.response.headers))),Promise.reject(mt)})}const headersToObject=rt=>rt instanceof AxiosHeaders?{...rt}:rt;function mergeConfig(rt,_){_=_||{};const ut={};function mt(Ht,tr,rr){return utils$2.isPlainObject(Ht)&&utils$2.isPlainObject(tr)?utils$2.merge.call({caseless:rr},Ht,tr):utils$2.isPlainObject(tr)?utils$2.merge({},tr):utils$2.isArray(tr)?tr.slice():tr}function bt(Ht,tr,rr){if(utils$2.isUndefined(tr)){if(!utils$2.isUndefined(Ht))return mt(void 0,Ht,rr)}else return mt(Ht,tr,rr)}function St(Ht,tr){if(!utils$2.isUndefined(tr))return mt(void 0,tr)}function Mt(Ht,tr){if(utils$2.isUndefined(tr)){if(!utils$2.isUndefined(Ht))return mt(void 0,Ht)}else return mt(void 0,tr)}function Bt(Ht,tr,rr){if(rr in _)return mt(Ht,tr);if(rr in rt)return mt(void 0,Ht)}const Ut={url:St,method:St,data:St,baseURL:Mt,transformRequest:Mt,transformResponse:Mt,paramsSerializer:Mt,timeout:Mt,timeoutMessage:Mt,withCredentials:Mt,withXSRFToken:Mt,adapter:Mt,responseType:Mt,xsrfCookieName:Mt,xsrfHeaderName:Mt,onUploadProgress:Mt,onDownloadProgress:Mt,decompress:Mt,maxContentLength:Mt,maxBodyLength:Mt,beforeRedirect:Mt,transport:Mt,httpAgent:Mt,httpsAgent:Mt,cancelToken:Mt,socketPath:Mt,responseEncoding:Mt,validateStatus:Bt,headers:(Ht,tr)=>bt(headersToObject(Ht),headersToObject(tr),!0)};return utils$2.forEach(Object.keys(Object.assign({},rt,_)),function(tr){const rr=Ut[tr]||bt,sr=rr(rt[tr],_[tr],tr);utils$2.isUndefined(sr)&&rr!==Bt||(ut[tr]=sr)}),ut}const VERSION$1="1.6.8",validators$1={};["object","boolean","number","function","string","symbol"].forEach((rt,_)=>{validators$1[rt]=function(mt){return typeof mt===rt||"a"+(_<1?"n ":" ")+rt}});const deprecatedWarnings={};validators$1.transitional=function rt(_,ut,mt){function bt(St,Mt){return"[Axios v"+VERSION$1+"] Transitional option '"+St+"'"+Mt+(mt?". "+mt:"")}return(St,Mt,Bt)=>{if(_===!1)throw new AxiosError(bt(Mt," has been removed"+(ut?" in "+ut:"")),AxiosError.ERR_DEPRECATED);return ut&&!deprecatedWarnings[Mt]&&(deprecatedWarnings[Mt]=!0,console.warn(bt(Mt," has been deprecated since v"+ut+" and will be removed in the near future"))),_?_(St,Mt,Bt):!0}};function assertOptions(rt,_,ut){if(typeof rt!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const mt=Object.keys(rt);let bt=mt.length;for(;bt-- >0;){const St=mt[bt],Mt=_[St];if(Mt){const Bt=rt[St],Ut=Bt===void 0||Mt(Bt,St,rt);if(Ut!==!0)throw new AxiosError("option "+St+" must be "+Ut,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(ut!==!0)throw new AxiosError("Unknown option "+St,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(_){this.defaults=_,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(_,ut){try{return await this._request(_,ut)}catch(mt){if(mt instanceof Error){let bt;Error.captureStackTrace?Error.captureStackTrace(bt={}):bt=new Error;const St=bt.stack?bt.stack.replace(/^.+\n/,""):"";mt.stack?St&&!String(mt.stack).endsWith(St.replace(/^.+\n.+\n/,""))&&(mt.stack+=`
`+St):mt.stack=St}throw mt}}_request(_,ut){typeof _=="string"?(ut=ut||{},ut.url=_):ut=_||{},ut=mergeConfig(this.defaults,ut);const{transitional:mt,paramsSerializer:bt,headers:St}=ut;mt!==void 0&&validator.assertOptions(mt,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),bt!=null&&(utils$2.isFunction(bt)?ut.paramsSerializer={serialize:bt}:validator.assertOptions(bt,{encode:validators.function,serialize:validators.function},!0)),ut.method=(ut.method||this.defaults.method||"get").toLowerCase();let Mt=St&&utils$2.merge(St.common,St[ut.method]);St&&utils$2.forEach(["delete","get","head","post","put","patch","common"],cr=>{delete St[cr]}),ut.headers=AxiosHeaders.concat(Mt,St);const Bt=[];let Ut=!0;this.interceptors.request.forEach(function(Ar){typeof Ar.runWhen=="function"&&Ar.runWhen(ut)===!1||(Ut=Ut&&Ar.synchronous,Bt.unshift(Ar.fulfilled,Ar.rejected))});const Ht=[];this.interceptors.response.forEach(function(Ar){Ht.push(Ar.fulfilled,Ar.rejected)});let tr,rr=0,sr;if(!Ut){const cr=[dispatchRequest.bind(this),void 0];for(cr.unshift.apply(cr,Bt),cr.push.apply(cr,Ht),sr=cr.length,tr=Promise.resolve(ut);rr<sr;)tr=tr.then(cr[rr++],cr[rr++]);return tr}sr=Bt.length;let ar=ut;for(rr=0;rr<sr;){const cr=Bt[rr++],Ar=Bt[rr++];try{ar=cr(ar)}catch(_r){Ar.call(this,_r);break}}try{tr=dispatchRequest.call(this,ar)}catch(cr){return Promise.reject(cr)}for(rr=0,sr=Ht.length;rr<sr;)tr=tr.then(Ht[rr++],Ht[rr++]);return tr}getUri(_){_=mergeConfig(this.defaults,_);const ut=buildFullPath(_.baseURL,_.url);return buildURL(ut,_.params,_.paramsSerializer)}}utils$2.forEach(["delete","get","head","options"],function rt(_){Axios.prototype[_]=function(ut,mt){return this.request(mergeConfig(mt||{},{method:_,url:ut,data:(mt||{}).data}))}});utils$2.forEach(["post","put","patch"],function rt(_){function ut(mt){return function(St,Mt,Bt){return this.request(mergeConfig(Bt||{},{method:_,headers:mt?{"Content-Type":"multipart/form-data"}:{},url:St,data:Mt}))}}Axios.prototype[_]=ut(),Axios.prototype[_+"Form"]=ut(!0)});class CancelToken{constructor(_){if(typeof _!="function")throw new TypeError("executor must be a function.");let ut;this.promise=new Promise(function(St){ut=St});const mt=this;this.promise.then(bt=>{if(!mt._listeners)return;let St=mt._listeners.length;for(;St-- >0;)mt._listeners[St](bt);mt._listeners=null}),this.promise.then=bt=>{let St;const Mt=new Promise(Bt=>{mt.subscribe(Bt),St=Bt}).then(bt);return Mt.cancel=function(){mt.unsubscribe(St)},Mt},_(function(St,Mt,Bt){mt.reason||(mt.reason=new CanceledError(St,Mt,Bt),ut(mt.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(_){if(this.reason){_(this.reason);return}this._listeners?this._listeners.push(_):this._listeners=[_]}unsubscribe(_){if(!this._listeners)return;const ut=this._listeners.indexOf(_);ut!==-1&&this._listeners.splice(ut,1)}static source(){let _;return{token:new CancelToken(function(bt){_=bt}),cancel:_}}}function spread(rt){return function(ut){return rt.apply(null,ut)}}function isAxiosError(rt){return utils$2.isObject(rt)&&rt.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([rt,_])=>{HttpStatusCode[_]=rt});function createInstance(rt){const _=new Axios(rt),ut=bind(Axios.prototype.request,_);return utils$2.extend(ut,Axios.prototype,_,{allOwnKeys:!0}),utils$2.extend(ut,_,null,{allOwnKeys:!0}),ut.create=function(bt){return createInstance(mergeConfig(rt,bt))},ut}const axios=createInstance(defaults);axios.Axios=Axios;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken;axios.isCancel=isCancel;axios.VERSION=VERSION$1;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function rt(_){return Promise.all(_)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders;axios.formToJSON=rt=>formDataToJSON(utils$2.isHTMLForm(rt)?new FormData(rt):rt);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode;axios.default=axios;const postGenerate=rt=>axios({url:"https://aiopen.cytelab.net/paid/create",method:"post",data:{...rt,uid:"871410a4-9675-447a-94ee-2933c7fd1f97"},timeout:30*1e3}).then(_=>_.data),Clock=()=>{const[rt,_]=reactExports.useState(new Date);reactExports.useEffect(()=>{const mt=setInterval(()=>{_(new Date)},6e4);return()=>clearInterval(mt)},[]);const ut=rt.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});return jsxRuntimeExports.jsx("div",{className:"timeIfo",children:ut})},Iconator=()=>{const{socket:rt}=useSocketIO(),[_,ut]=reactExports.useState(""),mt="Icon, app icon, flat, iOS style, not realist, cartoon, simple,minimalism",[bt,St]=reactExports.useState(null),[Mt,Bt]=reactExports.useState(null);reactExports.useEffect(()=>{const Ht=tr=>{St(tr);const rr=new Uint8Array(tr.data),sr=new Blob([rr],{type:"image/webp"}),ar=window.URL||window.webkitURL,cr=ar.createObjectURL(sr);Bt(Ar=>(Ar&&ar.revokeObjectURL(Ar),cr))};rt==null||rt.on("progress",Ht),rt==null||rt.on("finish",tr=>{Ht(tr)})},[rt]);const Ut=()=>{postGenerate({prompt:_,premise:mt}).catch(Ht=>{console.error("请求失败:",Ht)}),console.log("clicked the genbutton",_,mt,bt)};return jsxRuntimeExports.jsxs("div",{className:"bg",children:[jsxRuntimeExports.jsxs("div",{className:"topBar",children:[jsxRuntimeExports.jsx("div",{className:"lf",children:jsxRuntimeExports.jsx(Clock,{})}),jsxRuntimeExports.jsx("div",{className:"md",children:jsxRuntimeExports.jsx("div",{className:"island"})}),jsxRuntimeExports.jsx("div",{className:"rg",children:jsxRuntimeExports.jsxs("div",{className:"iconInfo",children:[jsxRuntimeExports.jsx("div",{style:{width:"27.401px",height:"13px"},children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"19",height:"12",viewBox:"0 0 19 12",fill:"none",children:[jsxRuntimeExports.jsx("path",{d:"M10.5494 3C10.5494 2.44772 10.9971 2 11.5494 2H12.5494C13.1017 2 13.5494 2.44772 13.5494 3V11C13.5494 11.5523 13.1017 12 12.5494 12H11.5494C10.9971 12 10.5494 11.5523 10.5494 11V3Z",fill:"black"}),jsxRuntimeExports.jsx("path",{d:"M15.5494 1C15.5494 0.447715 15.9971 0 16.5494 0H17.5494C18.1017 0 18.5494 0.447715 18.5494 1V11C18.5494 11.5523 18.1017 12 17.5494 12H16.5494C15.9971 12 15.5494 11.5523 15.5494 11V1Z",fill:"black"}),jsxRuntimeExports.jsx("path",{d:"M5.54938 6.5C5.54938 5.94772 5.99709 5.5 6.54938 5.5H7.54938C8.10166 5.5 8.54938 5.94772 8.54938 6.5V11C8.54938 11.5523 8.10166 12 7.54938 12H6.54938C5.99709 12 5.54938 11.5523 5.54938 11V6.5Z",fill:"black"}),jsxRuntimeExports.jsx("path",{d:"M0.549377 9C0.549377 8.44772 0.997093 8 1.54938 8H2.54938C3.10166 8 3.54938 8.44772 3.54938 9V11C3.54938 11.5523 3.10166 12 2.54938 12H1.54938C0.997093 12 0.549377 11.5523 0.549377 11V9Z",fill:"black"})]})}),jsxRuntimeExports.jsx("div",{style:{width:"27.401px",height:"13px"},children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"12",viewBox:"0 0 18 12",fill:"none",children:jsxRuntimeExports.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.04984 2.58753C11.5164 2.58764 13.8886 3.55505 15.6763 5.28982C15.8109 5.42375 16.026 5.42206 16.1586 5.28603L17.4454 3.96045C17.5125 3.89146 17.5499 3.798 17.5494 3.70076C17.5488 3.60353 17.5103 3.51052 17.4424 3.44234C12.7505 -1.14745 5.34845 -1.14745 0.65654 3.44234C0.588575 3.51047 0.550012 3.60345 0.549385 3.70069C0.548758 3.79792 0.58612 3.89141 0.653201 3.96045L1.94034 5.28603C2.07283 5.42226 2.28816 5.42396 2.42269 5.28982C4.21053 3.55494 6.58304 2.58752 9.04984 2.58753ZM9.08529 6.58937C10.4405 6.58929 11.7474 7.10346 12.7519 8.03199C12.8878 8.16376 13.1018 8.16091 13.2343 8.02555L14.5195 6.69997C14.5872 6.63044 14.6248 6.53611 14.6238 6.4381C14.6228 6.34008 14.5834 6.24656 14.5144 6.17844C11.4553 3.27385 6.7179 3.27385 3.65882 6.17844C3.58973 6.24656 3.5503 6.34013 3.54939 6.43817C3.54849 6.53622 3.58617 6.63054 3.654 6.69997L4.93891 8.02555C5.07136 8.16091 5.2854 8.16376 5.42127 8.03199C6.42516 7.10408 7.73097 6.58995 9.08529 6.58937ZM11.6989 9.17672C11.7009 9.27501 11.663 9.36977 11.5943 9.43863L9.37103 11.7289C9.30585 11.7962 9.217 11.834 9.12429 11.834C9.03157 11.834 8.94272 11.7962 8.87754 11.7289L6.6539 9.43863C6.58521 9.36972 6.54742 9.27492 6.54946 9.17663C6.55149 9.07834 6.59317 8.98527 6.66466 8.91938C8.08453 7.69354 10.164 7.69354 11.5839 8.91938C11.6553 8.98532 11.697 9.07843 11.6989 9.17672Z",fill:"black"})})}),jsxRuntimeExports.jsx("div",{style:{width:"27.401px",height:"13px"},children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"13",viewBox:"0 0 28 13",fill:"none",children:[jsxRuntimeExports.jsx("path",{opacity:"0.35",d:"M1.04938 4C1.04938 2.067 2.61638 0.5 4.54938 0.5H21.5494C23.4824 0.5 25.0494 2.067 25.0494 4V9C25.0494 10.933 23.4824 12.5 21.5494 12.5H4.54938C2.61638 12.5 1.04938 10.933 1.04938 9V4Z",stroke:"black"}),jsxRuntimeExports.jsx("path",{opacity:"0.4",d:"M26.5493 5V9.22034C27.3984 8.86291 27.9505 8.0314 27.9505 7.11017C27.9505 6.18894 27.3984 5.35744 26.5493 5Z",fill:"black"}),jsxRuntimeExports.jsx("path",{d:"M2.54938 4C2.54938 2.89543 3.44481 2 4.54938 2H21.5494C22.6539 2 23.5494 2.89543 23.5494 4V9C23.5494 10.1046 22.6539 11 21.5494 11H4.54938C3.44481 11 2.54938 10.1046 2.54938 9V4Z",fill:"black"})]})})]})})]}),jsxRuntimeExports.jsxs("div",{className:"content",children:[jsxRuntimeExports.jsxs("div",{className:"contentTop",children:[jsxRuntimeExports.jsxs("div",{className:"contentHeader",children:[jsxRuntimeExports.jsx("div",{className:"headerText",children:"ICONATOR"}),jsxRuntimeExports.jsxs("div",{className:"headerIcon",children:[jsxRuntimeExports.jsx("div",{className:"action",children:jsxRuntimeExports.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"33",height:"33",viewBox:"0 0 33 33",fill:"none",children:jsxRuntimeExports.jsx("path",{d:"M16.5 32.9992C7.45312 32.9992 0 25.5617 0 16.4992C0 7.45233 7.4375 -0.000793457 16.5 -0.000793457C25.5469 -0.000793457 33 7.45233 33 16.4992C33 25.5617 25.5625 32.9992 16.5 32.9992ZM16.375 17.9836C16.9062 17.9836 17.3281 17.5617 17.3281 17.0461V9.68671L17.1875 8.88983L17.8594 9.62421L18.3281 10.1242C18.4844 10.3117 18.7188 10.4055 19.0156 10.4055C19.5469 10.4055 19.9062 10.0617 19.9062 9.56171C19.9062 9.29608 19.8125 9.07733 19.6094 8.88983L17.0469 6.43671C16.8281 6.21796 16.5938 6.10858 16.375 6.10858C16.1406 6.10858 15.9062 6.21796 15.6875 6.43671L13.1406 8.88983C12.9375 9.07733 12.8438 9.29608 12.8438 9.56171C12.8438 10.0617 13.2188 10.4055 13.7344 10.4055C14.0312 10.4055 14.25 10.3117 14.4219 10.1242L14.8906 9.62421L15.5625 8.88983L15.4219 9.68671V17.0461C15.4219 17.5617 15.8438 17.9836 16.375 17.9836ZM11.9844 24.2961H20.7812C22.5625 24.2961 23.5312 23.3586 23.5312 21.5461V14.093C23.5312 12.3117 22.5781 11.3273 20.7812 11.3273H18.7188V13.3117H20.75C21.2812 13.3117 21.5469 13.6086 21.5469 14.1555V21.4992C21.5469 22.0617 21.2812 22.3586 20.75 22.3586H12.0156C11.4844 22.3586 11.2031 22.0773 11.2031 21.4992V14.1555C11.2031 13.6086 11.4844 13.3117 12.0156 13.3117H14.0469V11.3273H11.9844C10.1875 11.3273 9.23438 12.3273 9.23438 14.093V21.5461C9.23438 23.343 10.2188 24.2961 11.9844 24.2961Z",fill:"black"})})}),jsxRuntimeExports.jsx("div",{className:"action",children:jsxRuntimeExports.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"33",height:"33",viewBox:"0 0 33 33",fill:"none",children:[jsxRuntimeExports.jsx("circle",{cx:"16.5",cy:"16.4992",r:"16.5",fill:"black"}),jsxRuntimeExports.jsx("path",{d:"M16.5 26.5826C22.0162 26.5826 26.5834 22.0055 26.5834 16.4992C26.5834 10.9831 22.0063 6.41589 16.4901 6.41589C10.9838 6.41589 6.41669 10.9831 6.41669 16.4992C6.41669 22.0055 10.9937 26.5826 16.5 26.5826ZM16.5 24.902C11.834 24.902 8.10713 21.1652 8.10713 16.4992C8.10713 11.8332 11.8241 8.09645 16.4901 8.09645C21.1561 8.09645 24.8929 11.8332 24.9028 16.4992C24.9127 21.1652 21.166 24.902 16.5 24.902ZM11.8834 17.9326C12.6743 17.9326 13.3169 17.2901 13.3169 16.4893C13.3169 15.6985 12.6644 15.0559 11.8834 15.0559C11.0827 15.0559 10.4401 15.6985 10.4401 16.4893C10.4401 17.2901 11.0827 17.9326 11.8834 17.9326ZM16.4901 17.9326C17.281 17.9326 17.9334 17.2901 17.9334 16.4893C17.9334 15.6985 17.281 15.0559 16.4901 15.0559C15.6993 15.0559 15.0468 15.6985 15.0468 16.4893C15.0468 17.2901 15.6993 17.9326 16.4901 17.9326ZM21.1067 17.9326C21.8976 17.9326 22.5401 17.2901 22.5401 16.4893C22.5401 15.6985 21.8976 15.0559 21.1067 15.0559C20.306 15.0559 19.6634 15.6985 19.6634 16.4893C19.6634 17.2901 20.306 17.9326 21.1067 17.9326Z",fill:"white"})]})})]})]}),jsxRuntimeExports.jsx("div",{className:"preview",children:jsxRuntimeExports.jsx("img",{src:Mt||"https://telegraph-image-3k8.pages.dev/file/928a3b2569d791f7e650d.png",alt:"Preview"})})]}),jsxRuntimeExports.jsxs("div",{className:"contentBottom",children:[jsxRuntimeExports.jsx("div",{className:"promptInput",children:jsxRuntimeExports.jsx("textarea",{maxLength:300,placeholder:"Type your prompt",value:_,onChange:Ht=>ut(Ht.target.value),style:{width:"290px",height:"200px",backgroundColor:"#F2F2F2",color:"#3e3e3e",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"1px",paddingRight:"1px",resize:"none"}})}),jsxRuntimeExports.jsx("div",{className:"generateButton",onClick:()=>{Ut()},style:{cursor:"pointer !important"},children:jsxRuntimeExports.jsx("div",{className:"generateText",children:"Generate"})}),jsxRuntimeExports.jsx("div",{className:"homeBar",children:jsxRuntimeExports.jsx("div",{className:"homeBarBar"})})]})]})]})};function Scene$2({...rt}){const{nodes:_,materials:ut}=useSpline("https://prod.spline.design/51Ri4Eceg2OpQnva/scene.splinecode"),mt=useMask(1,!0);return reactExports.useLayoutEffect(()=>{Object.values(_).forEach(bt=>bt&&(bt.material&&bt.name.startsWith("hand")&&Object.assign(bt.material,mt),bt))}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("group",{...rt,dispose:null,position:[-140,-60,0],scale:1.2,rotation:[0,Math.PI/18*1,Math.PI/18*1],children:jsxRuntimeExports.jsx("mesh",{name:"handl",geometry:_.handl.geometry,material:ut.skin,castShadow:!0,receiveShadow:!0,position:[-87.42,-145.16,-109.79],rotation:[0,0,-.59],scale:[-2.3,2.3,2.3]})}),jsxRuntimeExports.jsx(Mask,{id:1,colorWrite:!1,depthWrite:!1,geometry:_.screen.geometry,receiveShadow:!0,scale:.5,position:[-50,0,0],children:jsxRuntimeExports.jsx(Html,{className:"content-embed",scale:40,transform:!0,zIndexRange:[-1,0]})})]})}const Scene$1=()=>{let rt;const _=new Vector3,ut=reactExports.useRef(0),mt=reactExports.useRef(null),[bt,St]=reactExports.useState(!1),{nodes:Mt}=useSpline("https://prod.spline.design/rrcy3gRnny6zWc8M/scene.splinecode"),Bt=useMask(1,!0);return reactExports.useLayoutEffect(()=>{Object.values(Mt).forEach(Ut=>Ut&&(Ut.material&&(Ut.name.startsWith("hand")||Object.assign(Ut.material,Bt)),Ut))}),useFrame(Ut=>{_.copy({x:Ut.pointer.x,y:Ut.pointer.y,z:0}),_.unproject(Ut.camera),mt.current&&(mt.current.rotation.x=MathUtils.lerp(mt.current.rotation.x,bt?-.7:-.5,.2),mt.current.position.lerp({x:_.x-100,y:ut.current+_.y,z:_.z},.4)),Ut.camera.zoom=MathUtils.lerp(Ut.camera.zoom,bt?1.2:.98,bt?.025:.15),Ut.camera.position.lerp({x:-Ut.pointer.x*120,y:-Ut.pointer.y*200,z:1e3},.1),Ut.camera.lookAt(0,0,0),Ut.camera.updateProjectionMatrix()}),jsxRuntimeExports.jsxs("group",{position:[0,0,-50],children:[jsxRuntimeExports.jsx(Float,{object:Mt["Bg-stuff"]}),jsxRuntimeExports.jsx(Float,{object:Mt["Emoji-4"]}),jsxRuntimeExports.jsx(Float,{object:Mt["Emoji-2"]}),jsxRuntimeExports.jsx(Float,{object:Mt["Emoji-3"]}),jsxRuntimeExports.jsx(Float,{object:Mt["Emoji-1"]}),jsxRuntimeExports.jsx(Float,{object:Mt["Icon-text-2"]}),jsxRuntimeExports.jsx(Float,{object:Mt["Icon-like"]}),jsxRuntimeExports.jsx(Float,{object:Mt["Icon-star"]}),jsxRuntimeExports.jsx(Float,{object:Mt["Icon-play"]}),jsxRuntimeExports.jsx(Float,{object:Mt["Icon-text-1"]}),jsxRuntimeExports.jsx("group",{ref:mt,scale:1.25,position:[0,0,400],"rotation-y":.35,children:jsxRuntimeExports.jsx(Clone,{object:Mt.handr,"rotation-y":-.35})}),jsxRuntimeExports.jsx(Clone,{object:Mt["Bubble-BG"],scale:.8,position:[0,180,-400]}),jsxRuntimeExports.jsx(Float$1,{floatIntensity:100,rotationIntensity:.5,speed:1,children:jsxRuntimeExports.jsxs("group",{position:[0,-50,0],rotation:[-.15,0,0],children:[jsxRuntimeExports.jsx(Scene$2,{stencil:Bt}),jsxRuntimeExports.jsxs("group",{name:"phone",scale:1,position:[-50,0,-68],children:[jsxRuntimeExports.jsx(Mask,{id:1,scale:.99,colorWrite:!1,depthWrite:!1,geometry:Mt.screen.geometry,position:[0,0,9.89],children:jsxRuntimeExports.jsx(Html,{className:"content-embed",scale:40,transform:!0,zIndexRange:[-1,0],children:jsxRuntimeExports.jsx(Iconator,{})})}),jsxRuntimeExports.jsx(Clone,{object:[Mt["Boolean 2"]]}),jsxRuntimeExports.jsx("mesh",{position:[0,150,9.89],scale:1.1,onWheel:Ut=>{ut.current=-Ut.deltaY/2,clearTimeout(rt),rt=setTimeout(()=>ut.current=0,100)},onPointerDown:Ut=>{const Ht=Ut.target;Ht&&(Ht.setPointerCapture(Ut.pointerId),St(!0))},onPointerUp:Ut=>{const Ht=Ut.target;Ht&&(Ht.releasePointerCapture(Ut.pointerId),St(!1))},receiveShadow:!0,geometry:Mt.screenCut.geometry,children:jsxRuntimeExports.jsx("meshStandardMaterial",{color:"red",transparent:!0,opacity:1})})]})]})})]})},Float=({object:rt,intensity:_=300,rotation:ut=1,...mt})=>jsxRuntimeExports.jsx(Float$1,{floatIntensity:_,rotationIntensity:ut,speed:2,children:jsxRuntimeExports.jsx(Clone,{object:rt,...mt})}),In3=()=>{const rt=reactExports.useRef(null),[_,ut]=reactExports.useState(!1);return reactExports.useEffect(()=>{rt.current&&(console.log(rt.current),ut(!0))},[]),reactExports.useEffect(()=>{rt.current&&console.log(rt.current)},[]),jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs("div",{ref:rt,className:"content-container",style:{backgroundColor:"#272727 "},children:[jsxRuntimeExports.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"}}),jsxRuntimeExports.jsxs(reactExports.Suspense,{fallback:jsxRuntimeExports.jsx(LoadingIndicator,{}),children:[jsxRuntimeExports.jsx("div",{style:{zIndex:-1,display:"none"},children:_}),rt.current&&jsxRuntimeExports.jsxs(Canvas$1,{shadows:!0,flat:!0,linear:!0,style:{pointerEvents:"none"},eventSource:rt.current,eventPrefix:"page",children:[jsxRuntimeExports.jsx("directionalLight",{castShadow:!0,intensity:.4,position:[-10,50,300],"shadow-mapSize":[512,512],"shadow-bias":-.002,children:jsxRuntimeExports.jsx("orthographicCamera",{attach:"shadow-camera",args:[-2e3,2e3,2e3,-2e3,-1e4,1e4]})}),jsxRuntimeExports.jsx(OrthographicCamera,{makeDefault:!0,zoom:.98,far:1e5,near:-1e5,position:[25.48,-44.14,1e3]}),jsxRuntimeExports.jsx("hemisphereLight",{intensity:.5,color:"#eaeaea",position:[0,1,0]}),jsxRuntimeExports.jsx(Scene$1,{})]})]})]})})},LoadingIndicator=()=>{const[rt,_]=reactExports.useState(0);return reactExports.useEffect(()=>{const ut=setInterval(()=>{_(mt=>(mt+1)%4)},500);return()=>clearInterval(ut)},[]),jsxRuntimeExports.jsx("div",{className:"h-screen w-screen p-8 max-w-screen-2xl mx-auto flex flex-col items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-6xl font-extrabold leading-snug font-Nunito text-cyan-200",style:{color:"cyan"},children:["Loading",".".repeat(rt)]})})},MotionConfigContext=reactExports.createContext({transformPagePoint:rt=>rt,isStatic:!1,reducedMotion:"never"}),MotionContext=reactExports.createContext({}),PresenceContext=reactExports.createContext(null),isBrowser=typeof document<"u",useIsomorphicLayoutEffect=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,LazyContext=reactExports.createContext({strict:!1}),camelToDash=rt=>rt.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),MotionGlobalConfig={skipAnimations:!1,useManualTiming:!1};class Queue{constructor(){this.order=[],this.scheduled=new Set}add(_){if(!this.scheduled.has(_))return this.scheduled.add(_),this.order.push(_),!0}remove(_){const ut=this.order.indexOf(_);ut!==-1&&(this.order.splice(ut,1),this.scheduled.delete(_))}clear(){this.order.length=0,this.scheduled.clear()}}function createRenderStep(rt){let _=new Queue,ut=new Queue,mt=0,bt=!1,St=!1;const Mt=new WeakSet,Bt={schedule:(Ut,Ht=!1,tr=!1)=>{const rr=tr&&bt,sr=rr?_:ut;return Ht&&Mt.add(Ut),sr.add(Ut)&&rr&&bt&&(mt=_.order.length),Ut},cancel:Ut=>{ut.remove(Ut),Mt.delete(Ut)},process:Ut=>{if(bt){St=!0;return}if(bt=!0,[_,ut]=[ut,_],ut.clear(),mt=_.order.length,mt)for(let Ht=0;Ht<mt;Ht++){const tr=_.order[Ht];Mt.has(tr)&&(Bt.schedule(tr),rt()),tr(Ut)}bt=!1,St&&(St=!1,Bt.process(Ut))}};return Bt}const stepsOrder=["read","resolveKeyframes","update","preRender","render","postRender"],maxElapsed=40;function createRenderBatcher(rt,_){let ut=!1,mt=!0;const bt={delta:0,timestamp:0,isProcessing:!1},St=stepsOrder.reduce((rr,sr)=>(rr[sr]=createRenderStep(()=>ut=!0),rr),{}),Mt=rr=>{St[rr].process(bt)},Bt=()=>{const rr=performance.now();ut=!1,bt.delta=mt?1e3/60:Math.max(Math.min(rr-bt.timestamp,maxElapsed),1),bt.timestamp=rr,bt.isProcessing=!0,stepsOrder.forEach(Mt),bt.isProcessing=!1,ut&&_&&(mt=!1,rt(Bt))},Ut=()=>{ut=!0,mt=!0,bt.isProcessing||rt(Bt)};return{schedule:stepsOrder.reduce((rr,sr)=>{const ar=St[sr];return rr[sr]=(cr,Ar=!1,_r=!1)=>(ut||Ut(),ar.schedule(cr,Ar,_r)),rr},{}),cancel:rr=>stepsOrder.forEach(sr=>St[sr].cancel(rr)),state:bt,steps:St}}const{schedule:microtask,cancel:cancelMicrotask}=createRenderBatcher(queueMicrotask,!1);function useVisualElement(rt,_,ut,mt){const{visualElement:bt}=reactExports.useContext(MotionContext),St=reactExports.useContext(LazyContext),Mt=reactExports.useContext(PresenceContext),Bt=reactExports.useContext(MotionConfigContext).reducedMotion,Ut=reactExports.useRef();mt=mt||St.renderer,!Ut.current&&mt&&(Ut.current=mt(rt,{visualState:_,parent:bt,props:ut,presenceContext:Mt,blockInitialAnimation:Mt?Mt.initial===!1:!1,reducedMotionConfig:Bt}));const Ht=Ut.current;reactExports.useInsertionEffect(()=>{Ht&&Ht.update(ut,Mt)});const tr=reactExports.useRef(!!(ut[optimizedAppearDataAttribute]&&!window.HandoffComplete));return useIsomorphicLayoutEffect(()=>{Ht&&(microtask.postRender(Ht.render),tr.current&&Ht.animationState&&Ht.animationState.animateChanges())}),reactExports.useEffect(()=>{Ht&&(Ht.updateFeatures(),!tr.current&&Ht.animationState&&Ht.animationState.animateChanges(),tr.current&&(tr.current=!1,window.HandoffComplete=!0))}),Ht}function isRefObject(rt){return rt&&typeof rt=="object"&&Object.prototype.hasOwnProperty.call(rt,"current")}function useMotionRef(rt,_,ut){return reactExports.useCallback(mt=>{mt&&rt.mount&&rt.mount(mt),_&&(mt?_.mount(mt):_.unmount()),ut&&(typeof ut=="function"?ut(mt):isRefObject(ut)&&(ut.current=mt))},[_])}function isVariantLabel(rt){return typeof rt=="string"||Array.isArray(rt)}function isAnimationControls(rt){return rt!==null&&typeof rt=="object"&&typeof rt.start=="function"}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(rt){return isAnimationControls(rt.animate)||variantProps.some(_=>isVariantLabel(rt[_]))}function isVariantNode(rt){return!!(isControllingVariants(rt)||rt.variants)}function getCurrentTreeVariants(rt,_){if(isControllingVariants(rt)){const{initial:ut,animate:mt}=rt;return{initial:ut===!1||isVariantLabel(ut)?ut:void 0,animate:isVariantLabel(mt)?mt:void 0}}return rt.inherit!==!1?_:{}}function useCreateMotionContext(rt){const{initial:_,animate:ut}=getCurrentTreeVariants(rt,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:_,animate:ut}),[variantLabelsAsDependency(_),variantLabelsAsDependency(ut)])}function variantLabelsAsDependency(rt){return Array.isArray(rt)?rt.join(" "):rt}const featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const rt in featureProps)featureDefinitions[rt]={isEnabled:_=>featureProps[rt].some(ut=>!!_[ut])};function loadFeatures(rt){for(const _ in rt)featureDefinitions[_]={...featureDefinitions[_],...rt[_]}}const LayoutGroupContext=reactExports.createContext({}),SwitchLayoutGroupContext=reactExports.createContext({}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function createMotionComponent({preloadedFeatures:rt,createVisualElement:_,useRender:ut,useVisualState:mt,Component:bt}){rt&&loadFeatures(rt);function St(Bt,Ut){let Ht;const tr={...reactExports.useContext(MotionConfigContext),...Bt,layoutId:useLayoutId(Bt)},{isStatic:rr}=tr,sr=useCreateMotionContext(Bt),ar=mt(Bt,rr);if(!rr&&isBrowser){sr.visualElement=useVisualElement(bt,ar,tr,_);const cr=reactExports.useContext(SwitchLayoutGroupContext),Ar=reactExports.useContext(LazyContext).strict;sr.visualElement&&(Ht=sr.visualElement.loadFeatures(tr,Ar,rt,cr))}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:sr,children:[Ht&&sr.visualElement?jsxRuntimeExports.jsx(Ht,{visualElement:sr.visualElement,...tr}):null,ut(bt,Bt,useMotionRef(ar,sr.visualElement,Ut),ar,rr,sr.visualElement)]})}const Mt=reactExports.forwardRef(St);return Mt[motionComponentSymbol]=bt,Mt}function useLayoutId({layoutId:rt}){const _=reactExports.useContext(LayoutGroupContext).id;return _&&rt!==void 0?_+"-"+rt:rt}function createMotionProxy(rt){function _(mt,bt={}){return createMotionComponent(rt(mt,bt))}if(typeof Proxy>"u")return _;const ut=new Map;return new Proxy(_,{get:(mt,bt)=>(ut.has(bt)||ut.set(bt,_(bt)),ut.get(bt))})}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(rt){return typeof rt!="string"||rt.includes("-")?!1:!!(lowercaseSVGElements.indexOf(rt)>-1||/[A-Z]/u.test(rt))}const scaleCorrectors={};function addScaleCorrector(rt){Object.assign(scaleCorrectors,rt)}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder);function isForcedMotionValue(rt,{layout:_,layoutId:ut}){return transformProps.has(rt)||rt.startsWith("origin")||(_||ut!==void 0)&&(!!scaleCorrectors[rt]||rt==="opacity")}const isMotionValue=rt=>!!(rt&&rt.getVelocity),translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(rt,{enableHardwareAcceleration:_=!0,allowTransformNone:ut=!0},mt,bt){let St="";for(let Mt=0;Mt<numTransforms;Mt++){const Bt=transformPropOrder[Mt];if(rt[Bt]!==void 0){const Ut=translateAlias[Bt]||Bt;St+=`${Ut}(${rt[Bt]}) `}}return _&&!rt.z&&(St+="translateZ(0)"),St=St.trim(),bt?St=bt(rt,mt?"":St):ut&&mt&&(St="none"),St}const checkStringStartsWith=rt=>_=>typeof _=="string"&&_.startsWith(rt),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=rt=>startsAsVariableToken(rt)?singleCssVariableRegex.test(rt.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,getValueAsType=(rt,_)=>_&&typeof rt=="number"?_.transform(rt):rt,clamp$3=(rt,_,ut)=>ut>_?_:ut<rt?rt:ut,number$2={test:rt=>typeof rt=="number",parse:parseFloat,transform:rt=>rt},alpha={...number$2,transform:rt=>clamp$3(0,1,rt)},scale={...number$2,default:1},sanitize$6=rt=>Math.round(rt*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu;function isString$1(rt){return typeof rt=="string"}const createUnitType=rt=>({test:_=>isString$1(_)&&_.endsWith(rt)&&_.split(" ").length===1,parse:parseFloat,transform:_=>`${_}${rt}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:rt=>percent.parse(rt)/100,transform:rt=>percent.transform(rt*100)},int={...number$2,transform:Math.round},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,size:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px,zIndex:int,backgroundPositionX:px,backgroundPositionY:px,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int};function buildHTMLStyles(rt,_,ut,mt){const{style:bt,vars:St,transform:Mt,transformOrigin:Bt}=rt;let Ut=!1,Ht=!1,tr=!0;for(const rr in _){const sr=_[rr];if(isCSSVariableName(rr)){St[rr]=sr;continue}const ar=numberValueTypes[rr],cr=getValueAsType(sr,ar);if(transformProps.has(rr)){if(Ut=!0,Mt[rr]=cr,!tr)continue;sr!==(ar.default||0)&&(tr=!1)}else rr.startsWith("origin")?(Ht=!0,Bt[rr]=cr):bt[rr]=cr}if(_.transform||(Ut||mt?bt.transform=buildTransform(rt.transform,ut,tr,mt):bt.transform&&(bt.transform="none")),Ht){const{originX:rr="50%",originY:sr="50%",originZ:ar=0}=Bt;bt.transformOrigin=`${rr} ${sr} ${ar}`}}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(rt,_,ut){for(const mt in _)!isMotionValue(_[mt])&&!isForcedMotionValue(mt,ut)&&(rt[mt]=_[mt])}function useInitialMotionValues({transformTemplate:rt},_,ut){return reactExports.useMemo(()=>{const mt=createHtmlRenderState();return buildHTMLStyles(mt,_,{enableHardwareAcceleration:!ut},rt),Object.assign({},mt.vars,mt.style)},[_])}function useStyle(rt,_,ut){const mt=rt.style||{},bt={};return copyRawValuesOnly(bt,mt,rt),Object.assign(bt,useInitialMotionValues(rt,_,ut)),bt}function useHTMLProps(rt,_,ut){const mt={},bt=useStyle(rt,_,ut);return rt.drag&&rt.dragListener!==!1&&(mt.draggable=!1,bt.userSelect=bt.WebkitUserSelect=bt.WebkitTouchCallout="none",bt.touchAction=rt.drag===!0?"none":`pan-${rt.drag==="x"?"y":"x"}`),rt.tabIndex===void 0&&(rt.onTap||rt.onTapStart||rt.whileTap)&&(mt.tabIndex=0),mt.style=bt,mt}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(rt){return rt.startsWith("while")||rt.startsWith("drag")&&rt!=="draggable"||rt.startsWith("layout")||rt.startsWith("onTap")||rt.startsWith("onPan")||rt.startsWith("onLayout")||validMotionProps.has(rt)}let shouldForward=rt=>!isValidMotionProp(rt);function loadExternalIsValidProp(rt){rt&&(shouldForward=_=>_.startsWith("on")?!isValidMotionProp(_):rt(_))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch(rt){}function filterProps(rt,_,ut){const mt={};for(const bt in rt)bt==="values"&&typeof rt.values=="object"||(shouldForward(bt)||ut===!0&&isValidMotionProp(bt)||!_&&!isValidMotionProp(bt)||rt.draggable&&bt.startsWith("onDrag"))&&(mt[bt]=rt[bt]);return mt}function calcOrigin$1(rt,_,ut){return typeof rt=="string"?rt:px.transform(_+ut*rt)}function calcSVGTransformOrigin(rt,_,ut){const mt=calcOrigin$1(_,rt.x,rt.width),bt=calcOrigin$1(ut,rt.y,rt.height);return`${mt} ${bt}`}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(rt,_,ut=1,mt=0,bt=!0){rt.pathLength=1;const St=bt?dashKeys:camelKeys;rt[St.offset]=px.transform(-mt);const Mt=px.transform(_),Bt=px.transform(ut);rt[St.array]=`${Mt} ${Bt}`}function buildSVGAttrs(rt,{attrX:_,attrY:ut,attrScale:mt,originX:bt,originY:St,pathLength:Mt,pathSpacing:Bt=1,pathOffset:Ut=0,...Ht},tr,rr,sr){if(buildHTMLStyles(rt,Ht,tr,sr),rr){rt.style.viewBox&&(rt.attrs.viewBox=rt.style.viewBox);return}rt.attrs=rt.style,rt.style={};const{attrs:ar,style:cr,dimensions:Ar}=rt;ar.transform&&(Ar&&(cr.transform=ar.transform),delete ar.transform),Ar&&(bt!==void 0||St!==void 0||cr.transform)&&(cr.transformOrigin=calcSVGTransformOrigin(Ar,bt!==void 0?bt:.5,St!==void 0?St:.5)),_!==void 0&&(ar.x=_),ut!==void 0&&(ar.y=ut),mt!==void 0&&(ar.scale=mt),Mt!==void 0&&buildSVGPath(ar,Mt,Bt,Ut,!1)}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=rt=>typeof rt=="string"&&rt.toLowerCase()==="svg";function useSVGProps(rt,_,ut,mt){const bt=reactExports.useMemo(()=>{const St=createSvgRenderState();return buildSVGAttrs(St,_,{enableHardwareAcceleration:!1},isSVGTag(mt),rt.transformTemplate),{...St.attrs,style:{...St.style}}},[_]);if(rt.style){const St={};copyRawValuesOnly(St,rt.style,rt),bt.style={...St,...bt.style}}return bt}function createUseRender(rt=!1){return(ut,mt,bt,{latestValues:St},Mt)=>{const Ut=(isSVGComponent(ut)?useSVGProps:useHTMLProps)(mt,St,Mt,ut),Ht=filterProps(mt,typeof ut=="string",rt),tr=ut!==reactExports.Fragment?{...Ht,...Ut,ref:bt}:{},{children:rr}=mt,sr=reactExports.useMemo(()=>isMotionValue(rr)?rr.get():rr,[rr]);return reactExports.createElement(ut,{...tr,children:sr})}}function renderHTML(rt,{style:_,vars:ut},mt,bt){Object.assign(rt.style,_,bt&&bt.getProjectionStyles(mt));for(const St in ut)rt.style.setProperty(St,ut[St])}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(rt,_,ut,mt){renderHTML(rt,_,void 0,mt);for(const bt in _.attrs)rt.setAttribute(camelCaseAttributes.has(bt)?bt:camelToDash(bt),_.attrs[bt])}function scrapeMotionValuesFromProps$2(rt,_,ut){var mt;const{style:bt}=rt,St={};for(const Mt in bt)(isMotionValue(bt[Mt])||_.style&&isMotionValue(_.style[Mt])||isForcedMotionValue(Mt,rt)||((mt=ut==null?void 0:ut.getValue(Mt))===null||mt===void 0?void 0:mt.liveStyle)!==void 0)&&(St[Mt]=bt[Mt]);return St}function scrapeMotionValuesFromProps$1(rt,_,ut){const mt=scrapeMotionValuesFromProps$2(rt,_,ut);for(const bt in rt)if(isMotionValue(rt[bt])||isMotionValue(_[bt])){const St=transformPropOrder.indexOf(bt)!==-1?"attr"+bt.charAt(0).toUpperCase()+bt.substring(1):bt;mt[St]=rt[bt]}return mt}function resolveVariantFromProps(rt,_,ut,mt={},bt={}){return typeof _=="function"&&(_=_(ut!==void 0?ut:rt.custom,mt,bt)),typeof _=="string"&&(_=rt.variants&&rt.variants[_]),typeof _=="function"&&(_=_(ut!==void 0?ut:rt.custom,mt,bt)),_}function useConstant(rt){const _=reactExports.useRef(null);return _.current===null&&(_.current=rt()),_.current}const isKeyframesTarget=rt=>Array.isArray(rt),isCustomValue=rt=>!!(rt&&typeof rt=="object"&&rt.mix&&rt.toValue),resolveFinalValueInKeyframes=rt=>isKeyframesTarget(rt)?rt[rt.length-1]||0:rt;function resolveMotionValue(rt){const _=isMotionValue(rt)?rt.get():rt;return isCustomValue(_)?_.toValue():_}function makeState({scrapeMotionValuesFromProps:rt,createRenderState:_,onMount:ut},mt,bt,St){const Mt={latestValues:makeLatestValues(mt,bt,St,rt),renderState:_()};return ut&&(Mt.mount=Bt=>ut(mt,Bt,Mt)),Mt}const makeUseVisualState=rt=>(_,ut)=>{const mt=reactExports.useContext(MotionContext),bt=reactExports.useContext(PresenceContext),St=()=>makeState(rt,_,mt,bt);return ut?St():useConstant(St)};function makeLatestValues(rt,_,ut,mt){const bt={},St=mt(rt,{});for(const sr in St)bt[sr]=resolveMotionValue(St[sr]);let{initial:Mt,animate:Bt}=rt;const Ut=isControllingVariants(rt),Ht=isVariantNode(rt);_&&Ht&&!Ut&&rt.inherit!==!1&&(Mt===void 0&&(Mt=_.initial),Bt===void 0&&(Bt=_.animate));let tr=ut?ut.initial===!1:!1;tr=tr||Mt===!1;const rr=tr?Bt:Mt;return rr&&typeof rr!="boolean"&&!isAnimationControls(rr)&&(Array.isArray(rr)?rr:[rr]).forEach(ar=>{const cr=resolveVariantFromProps(rt,ar);if(!cr)return;const{transitionEnd:Ar,transition:_r,...Dr}=cr;for(const $r in Dr){let Br=Dr[$r];if(Array.isArray(Br)){const Jr=tr?Br.length-1:0;Br=Br[Jr]}Br!==null&&(bt[$r]=Br)}for(const $r in Ar)bt[$r]=Ar[$r]}),bt}const noop$1=rt=>rt,{schedule:frame,cancel:cancelFrame,state:frameData,steps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop$1,!0),svgMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createSvgRenderState,onMount:(rt,_,{renderState:ut,latestValues:mt})=>{frame.read(()=>{try{ut.dimensions=typeof _.getBBox=="function"?_.getBBox():_.getBoundingClientRect()}catch{ut.dimensions={x:0,y:0,width:0,height:0}}}),frame.render(()=>{buildSVGAttrs(ut,mt,{enableHardwareAcceleration:!1},isSVGTag(_.tagName),rt.transformTemplate),renderSVG(_,ut)})}})},htmlMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$2,createRenderState:createHtmlRenderState})};function createDomMotionConfig(rt,{forwardMotionProps:_=!1},ut,mt){return{...isSVGComponent(rt)?svgMotionConfig:htmlMotionConfig,preloadedFeatures:ut,useRender:createUseRender(_),createVisualElement:mt,Component:rt}}function addDomEvent(rt,_,ut,mt={passive:!0}){return rt.addEventListener(_,ut,mt),()=>rt.removeEventListener(_,ut)}const isPrimaryPointer=rt=>rt.pointerType==="mouse"?typeof rt.button!="number"||rt.button<=0:rt.isPrimary!==!1;function extractEventInfo(rt,_="page"){return{point:{x:rt[`${_}X`],y:rt[`${_}Y`]}}}const addPointerInfo=rt=>_=>isPrimaryPointer(_)&&rt(_,extractEventInfo(_));function addPointerEvent(rt,_,ut,mt){return addDomEvent(rt,_,addPointerInfo(ut),mt)}const combineFunctions=(rt,_)=>ut=>_(rt(ut)),pipe$1=(...rt)=>rt.reduce(combineFunctions);function createLock(rt){let _=null;return()=>{const ut=()=>{_=null};return _===null?(_=rt,ut):!1}}const globalHorizontalLock=createLock("dragHorizontal"),globalVerticalLock=createLock("dragVertical");function getGlobalLock(rt){let _=!1;if(rt==="y")_=globalVerticalLock();else if(rt==="x")_=globalHorizontalLock();else{const ut=globalHorizontalLock(),mt=globalVerticalLock();ut&&mt?_=()=>{ut(),mt()}:(ut&&ut(),mt&&mt())}return _}function isDragActive(){const rt=getGlobalLock(!0);return rt?(rt(),!1):!0}class Feature{constructor(_){this.isMounted=!1,this.node=_}update(){}}function addHoverEvent(rt,_){const ut=_?"pointerenter":"pointerleave",mt=_?"onHoverStart":"onHoverEnd",bt=(St,Mt)=>{if(St.pointerType==="touch"||isDragActive())return;const Bt=rt.getProps();rt.animationState&&Bt.whileHover&&rt.animationState.setActive("whileHover",_);const Ut=Bt[mt];Ut&&frame.postRender(()=>Ut(St,Mt))};return addPointerEvent(rt.current,ut,bt,{passive:!rt.getProps()[mt]})}class HoverGesture extends Feature{mount(){this.unmount=pipe$1(addHoverEvent(this.node,!0),addHoverEvent(this.node,!1))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let _=!1;try{_=this.node.current.matches(":focus-visible")}catch{_=!0}!_||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe$1(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const isNodeOrChild=(rt,_)=>_?rt===_?!0:isNodeOrChild(rt,_.parentElement):!1;function fireSyntheticPointerEvent(rt,_){if(!_)return;const ut=new PointerEvent("pointer"+rt);_(ut,extractEventInfo(ut))}class PressGesture extends Feature{constructor(){super(...arguments),this.removeStartListeners=noop$1,this.removeEndListeners=noop$1,this.removeAccessibleListeners=noop$1,this.startPointerPress=(_,ut)=>{if(this.isPressing)return;this.removeEndListeners();const mt=this.node.getProps(),St=addPointerEvent(window,"pointerup",(Bt,Ut)=>{if(!this.checkPressEnd())return;const{onTap:Ht,onTapCancel:tr,globalTapTarget:rr}=this.node.getProps(),sr=!rr&&!isNodeOrChild(this.node.current,Bt.target)?tr:Ht;sr&&frame.update(()=>sr(Bt,Ut))},{passive:!(mt.onTap||mt.onPointerUp)}),Mt=addPointerEvent(window,"pointercancel",(Bt,Ut)=>this.cancelPress(Bt,Ut),{passive:!(mt.onTapCancel||mt.onPointerCancel)});this.removeEndListeners=pipe$1(St,Mt),this.startPress(_,ut)},this.startAccessiblePress=()=>{const _=St=>{if(St.key!=="Enter"||this.isPressing)return;const Mt=Bt=>{Bt.key!=="Enter"||!this.checkPressEnd()||fireSyntheticPointerEvent("up",(Ut,Ht)=>{const{onTap:tr}=this.node.getProps();tr&&frame.postRender(()=>tr(Ut,Ht))})};this.removeEndListeners(),this.removeEndListeners=addDomEvent(this.node.current,"keyup",Mt),fireSyntheticPointerEvent("down",(Bt,Ut)=>{this.startPress(Bt,Ut)})},ut=addDomEvent(this.node.current,"keydown",_),mt=()=>{this.isPressing&&fireSyntheticPointerEvent("cancel",(St,Mt)=>this.cancelPress(St,Mt))},bt=addDomEvent(this.node.current,"blur",mt);this.removeAccessibleListeners=pipe$1(ut,bt)}}startPress(_,ut){this.isPressing=!0;const{onTapStart:mt,whileTap:bt}=this.node.getProps();bt&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),mt&&frame.postRender(()=>mt(_,ut))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!isDragActive()}cancelPress(_,ut){if(!this.checkPressEnd())return;const{onTapCancel:mt}=this.node.getProps();mt&&frame.postRender(()=>mt(_,ut))}mount(){const _=this.node.getProps(),ut=addPointerEvent(_.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(_.onTapStart||_.onPointerStart)}),mt=addDomEvent(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=pipe$1(ut,mt)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=rt=>{const _=observerCallbacks.get(rt.target);_&&_(rt)},fireAllObserverCallbacks=rt=>{rt.forEach(fireObserverCallback)};function initIntersectionObserver({root:rt,..._}){const ut=rt||document;observers.has(ut)||observers.set(ut,{});const mt=observers.get(ut),bt=JSON.stringify(_);return mt[bt]||(mt[bt]=new IntersectionObserver(fireAllObserverCallbacks,{root:rt,..._})),mt[bt]}function observeIntersection(rt,_,ut){const mt=initIntersectionObserver(_);return observerCallbacks.set(rt,ut),mt.observe(rt),()=>{observerCallbacks.delete(rt),mt.unobserve(rt)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:_={}}=this.node.getProps(),{root:ut,margin:mt,amount:bt="some",once:St}=_,Mt={root:ut?ut.current:void 0,rootMargin:mt,threshold:typeof bt=="number"?bt:thresholdNames[bt]},Bt=Ut=>{const{isIntersecting:Ht}=Ut;if(this.isInView===Ht||(this.isInView=Ht,St&&!Ht&&this.hasEnteredView))return;Ht&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",Ht);const{onViewportEnter:tr,onViewportLeave:rr}=this.node.getProps(),sr=Ht?tr:rr;sr&&sr(Ut)};return observeIntersection(this.node.current,Mt,Bt)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:_,prevProps:ut}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(_,ut))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:rt={}},{viewport:_={}}={}){return ut=>rt[ut]!==_[ut]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}};function shallowCompare(rt,_){if(!Array.isArray(_))return!1;const ut=_.length;if(ut!==rt.length)return!1;for(let mt=0;mt<ut;mt++)if(_[mt]!==rt[mt])return!1;return!0}function getCurrent(rt){const _={};return rt.values.forEach((ut,mt)=>_[mt]=ut.get()),_}function getVelocity$1(rt){const _={};return rt.values.forEach((ut,mt)=>_[mt]=ut.getVelocity()),_}function resolveVariant(rt,_,ut){const mt=rt.getProps();return resolveVariantFromProps(mt,_,ut!==void 0?ut:mt.custom,getCurrent(rt),getVelocity$1(rt))}const secondsToMilliseconds=rt=>rt*1e3,millisecondsToSeconds=rt=>rt/1e3,underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=rt=>({type:"spring",stiffness:550,damping:rt===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(rt,{keyframes:_})=>_.length>2?keyframesTransition:transformProps.has(rt)?rt.startsWith("scale")?criticallyDampedSpring(_[1]):underDampedSpring:ease;function isTransitionDefined({when:rt,delay:_,delayChildren:ut,staggerChildren:mt,staggerDirection:bt,repeat:St,repeatType:Mt,repeatDelay:Bt,from:Ut,elapsed:Ht,...tr}){return!!Object.keys(tr).length}function getValueTransition$1(rt,_){return rt[_]||rt.default||rt}const isNotNull=rt=>rt!==null;function getFinalKeyframe(rt,{repeat:_,repeatType:ut="loop"},mt){const bt=rt.filter(isNotNull),St=_&&ut!=="loop"&&_%2===1?0:bt.length-1;return!St||mt===void 0?bt[St]:mt}let now$1;function clearTime(){now$1=void 0}const time={now:()=>(now$1===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now$1),set:rt=>{now$1=rt,queueMicrotask(clearTime)}},isZeroValueString=rt=>/^0[^.\s]+$/u.test(rt);function isNone(rt){return typeof rt=="number"?rt===0:rt!==null?rt==="none"||rt==="0"||isZeroValueString(rt):!0}let invariant=noop$1;const isNumericalString=rt=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(rt),splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(rt){const _=splitCSSVariableRegex.exec(rt);if(!_)return[,];const[,ut,mt,bt]=_;return[`--${ut??mt}`,bt]}function getVariableValue(rt,_,ut=1){const[mt,bt]=parseCSSVariable(rt);if(!mt)return;const St=window.getComputedStyle(_).getPropertyValue(mt);if(St){const Mt=St.trim();return isNumericalString(Mt)?parseFloat(Mt):Mt}return isCSSVariableToken(bt)?getVariableValue(bt,_,ut+1):bt}const positionalKeys=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),isNumOrPxType=rt=>rt===number$2||rt===px,getPosFromMatrix=(rt,_)=>parseFloat(rt.split(", ")[_]),getTranslateFromMatrix=(rt,_)=>(ut,{transform:mt})=>{if(mt==="none"||!mt)return 0;const bt=mt.match(/^matrix3d\((.+)\)$/u);if(bt)return getPosFromMatrix(bt[1],_);{const St=mt.match(/^matrix\((.+)\)$/u);return St?getPosFromMatrix(St[1],rt):0}},transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(rt=>!transformKeys.has(rt));function removeNonTranslationalTransform(rt){const _=[];return nonTranslationalTransformKeys.forEach(ut=>{const mt=rt.getValue(ut);mt!==void 0&&(_.push([ut,mt.get()]),mt.set(ut.startsWith("scale")?1:0))}),_}const positionalValues={width:({x:rt},{paddingLeft:_="0",paddingRight:ut="0"})=>rt.max-rt.min-parseFloat(_)-parseFloat(ut),height:({y:rt},{paddingTop:_="0",paddingBottom:ut="0"})=>rt.max-rt.min-parseFloat(_)-parseFloat(ut),top:(rt,{top:_})=>parseFloat(_),left:(rt,{left:_})=>parseFloat(_),bottom:({y:rt},{top:_})=>parseFloat(_)+(rt.max-rt.min),right:({x:rt},{left:_})=>parseFloat(_)+(rt.max-rt.min),x:getTranslateFromMatrix(4,13),y:getTranslateFromMatrix(5,14)};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const testValueType=rt=>_=>_.test(rt),auto={test:rt=>rt==="auto",parse:rt=>rt},dimensionValueTypes=[number$2,px,percent,degrees,vw,vh,auto],findDimensionValueType=rt=>dimensionValueTypes.find(testValueType(rt)),toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const rt=Array.from(toResolve).filter(mt=>mt.needsMeasurement),_=new Set(rt.map(mt=>mt.element)),ut=new Map;_.forEach(mt=>{const bt=removeNonTranslationalTransform(mt);bt.length&&(ut.set(mt,bt),mt.render())}),rt.forEach(mt=>mt.measureInitialState()),_.forEach(mt=>{mt.render();const bt=ut.get(mt);bt&&bt.forEach(([St,Mt])=>{var Bt;(Bt=mt.getValue(St))===null||Bt===void 0||Bt.set(Mt)})}),rt.forEach(mt=>mt.measureEndState()),rt.forEach(mt=>{mt.suspendedScrollY!==void 0&&window.scrollTo(0,mt.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(rt=>rt.complete()),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(rt=>{rt.readKeyframes(),rt.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){readAllKeyframes(),measureAllKeyframes()}class KeyframeResolver{constructor(_,ut,mt,bt,St,Mt=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[..._],this.onComplete=ut,this.name=mt,this.motionValue=bt,this.element=St,this.isAsync=Mt}scheduleResolve(){this.isScheduled=!0,this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:_,name:ut,element:mt,motionValue:bt}=this;for(let St=0;St<_.length;St++)if(_[St]===null)if(St===0){const Mt=bt==null?void 0:bt.get(),Bt=_[_.length-1];if(Mt!==void 0)_[0]=Mt;else if(mt&&ut){const Ut=mt.readValue(ut,Bt);Ut!=null&&(_[0]=Ut)}_[0]===void 0&&(_[0]=Bt),bt&&Mt===void 0&&bt.set(_[0])}else _[St]=_[St-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),toResolve.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,toResolve.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const isColorString=(rt,_)=>ut=>!!(isString$1(ut)&&singleColorRegex.test(ut)&&ut.startsWith(rt)||_&&Object.prototype.hasOwnProperty.call(ut,_)),splitColor$1=(rt,_,ut)=>mt=>{if(!isString$1(mt))return mt;const[bt,St,Mt,Bt]=mt.match(floatRegex);return{[rt]:parseFloat(bt),[_]:parseFloat(St),[ut]:parseFloat(Mt),alpha:Bt!==void 0?parseFloat(Bt):1}},clampRgbUnit=rt=>clamp$3(0,255,rt),rgbUnit={...number$2,transform:rt=>Math.round(clampRgbUnit(rt))},rgba={test:isColorString("rgb","red"),parse:splitColor$1("red","green","blue"),transform:({red:rt,green:_,blue:ut,alpha:mt=1})=>"rgba("+rgbUnit.transform(rt)+", "+rgbUnit.transform(_)+", "+rgbUnit.transform(ut)+", "+sanitize$6(alpha.transform(mt))+")"};function parseHex(rt){let _="",ut="",mt="",bt="";return rt.length>5?(_=rt.substring(1,3),ut=rt.substring(3,5),mt=rt.substring(5,7),bt=rt.substring(7,9)):(_=rt.substring(1,2),ut=rt.substring(2,3),mt=rt.substring(3,4),bt=rt.substring(4,5),_+=_,ut+=ut,mt+=mt,bt+=bt),{red:parseInt(_,16),green:parseInt(ut,16),blue:parseInt(mt,16),alpha:bt?parseInt(bt,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},hsla={test:isColorString("hsl","hue"),parse:splitColor$1("hue","saturation","lightness"),transform:({hue:rt,saturation:_,lightness:ut,alpha:mt=1})=>"hsla("+Math.round(rt)+", "+percent.transform(sanitize$6(_))+", "+percent.transform(sanitize$6(ut))+", "+sanitize$6(alpha.transform(mt))+")"},color$2={test:rt=>rgba.test(rt)||hex.test(rt)||hsla.test(rt),parse:rt=>rgba.test(rt)?rgba.parse(rt):hsla.test(rt)?hsla.parse(rt):hex.parse(rt),transform:rt=>isString$1(rt)?rt:rt.hasOwnProperty("red")?rgba.transform(rt):hsla.transform(rt)};function test(rt){var _,ut;return isNaN(rt)&&isString$1(rt)&&(((_=rt.match(floatRegex))===null||_===void 0?void 0:_.length)||0)+(((ut=rt.match(colorRegex))===null||ut===void 0?void 0:ut.length)||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(rt){const _=rt.toString(),ut=[],mt={color:[],number:[],var:[]},bt=[];let St=0;const Bt=_.replace(complexRegex,Ut=>(color$2.test(Ut)?(mt.color.push(St),bt.push(COLOR_TOKEN),ut.push(color$2.parse(Ut))):Ut.startsWith(VAR_FUNCTION_TOKEN)?(mt.var.push(St),bt.push(VAR_TOKEN),ut.push(Ut)):(mt.number.push(St),bt.push(NUMBER_TOKEN),ut.push(parseFloat(Ut))),++St,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:ut,split:Bt,indexes:mt,types:bt}}function parseComplexValue(rt){return analyseComplexValue(rt).values}function createTransformer(rt){const{split:_,types:ut}=analyseComplexValue(rt),mt=_.length;return bt=>{let St="";for(let Mt=0;Mt<mt;Mt++)if(St+=_[Mt],bt[Mt]!==void 0){const Bt=ut[Mt];Bt===NUMBER_TOKEN?St+=sanitize$6(bt[Mt]):Bt===COLOR_TOKEN?St+=color$2.transform(bt[Mt]):St+=bt[Mt]}return St}}const convertNumbersToZero=rt=>typeof rt=="number"?0:rt;function getAnimatableNone$1(rt){const _=parseComplexValue(rt);return createTransformer(rt)(_.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1},maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(rt){const[_,ut]=rt.slice(0,-1).split("(");if(_==="drop-shadow")return rt;const[mt]=ut.match(floatRegex)||[];if(!mt)return rt;const bt=ut.replace(mt,"");let St=maxDefaults.has(_)?1:0;return mt!==ut&&(St*=100),_+"("+St+bt+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:rt=>{const _=rt.match(functionRegex);return _?_.map(applyDefaultFilter).join(" "):rt}},defaultValueTypes={...numberValueTypes,color:color$2,backgroundColor:color$2,outlineColor:color$2,fill:color$2,stroke:color$2,borderColor:color$2,borderTopColor:color$2,borderRightColor:color$2,borderBottomColor:color$2,borderLeftColor:color$2,filter,WebkitFilter:filter},getDefaultValueType=rt=>defaultValueTypes[rt];function getAnimatableNone(rt,_){let ut=getDefaultValueType(rt);return ut!==filter&&(ut=complex),ut.getAnimatableNone?ut.getAnimatableNone(_):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(rt,_,ut){let mt=0,bt;for(;mt<rt.length&&!bt;){const St=rt[mt];typeof St=="string"&&!invalidTemplates.has(St)&&(bt=rt[mt]),mt++}if(bt&&ut)for(const St of _)rt[St]=getAnimatableNone(ut,bt)}class DOMKeyframesResolver extends KeyframeResolver{constructor(_,ut,mt,bt){super(_,ut,mt,bt,bt==null?void 0:bt.owner,!0)}readKeyframes(){const{unresolvedKeyframes:_,element:ut,name:mt}=this;if(!ut.current)return;super.readKeyframes();for(let Ut=0;Ut<_.length;Ut++){const Ht=_[Ut];if(typeof Ht=="string"&&isCSSVariableToken(Ht)){const tr=getVariableValue(Ht,ut.current);tr!==void 0&&(_[Ut]=tr),Ut===_.length-1&&(this.finalKeyframe=Ht)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(mt)||_.length!==2)return;const[bt,St]=_,Mt=findDimensionValueType(bt),Bt=findDimensionValueType(St);if(Mt!==Bt)if(isNumOrPxType(Mt)&&isNumOrPxType(Bt))for(let Ut=0;Ut<_.length;Ut++){const Ht=_[Ut];typeof Ht=="string"&&(_[Ut]=parseFloat(Ht))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:_,name:ut}=this,mt=[];for(let bt=0;bt<_.length;bt++)isNone(_[bt])&&mt.push(bt);mt.length&&makeNoneKeyframesAnimatable(_,mt,ut)}measureInitialState(){const{element:_,unresolvedKeyframes:ut,name:mt}=this;if(!_.current)return;mt==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[mt](_.measureViewportBox(),window.getComputedStyle(_.current)),ut[0]=this.measuredOrigin;const bt=ut[ut.length-1];bt!==void 0&&_.getValue(mt,bt).jump(bt,!1)}measureEndState(){var _;const{element:ut,name:mt,unresolvedKeyframes:bt}=this;if(!ut.current)return;const St=ut.getValue(mt);St&&St.jump(this.measuredOrigin,!1);const Mt=bt.length-1,Bt=bt[Mt];bt[Mt]=positionalValues[mt](ut.measureViewportBox(),window.getComputedStyle(ut.current)),Bt!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=Bt),!((_=this.removedTransforms)===null||_===void 0)&&_.length&&this.removedTransforms.forEach(([Ut,Ht])=>{ut.getValue(Ut).set(Ht)}),this.resolveNoneKeyframes()}}function memo(rt){let _;return()=>(_===void 0&&(_=rt()),_)}const isAnimatable=(rt,_)=>_==="zIndex"?!1:!!(typeof rt=="number"||Array.isArray(rt)||typeof rt=="string"&&(complex.test(rt)||rt==="0")&&!rt.startsWith("url("));function hasKeyframesChanged(rt){const _=rt[0];if(rt.length===1)return!0;for(let ut=0;ut<rt.length;ut++)if(rt[ut]!==_)return!0}function canAnimate(rt,_,ut,mt){const bt=rt[0];if(bt===null)return!1;const St=rt[rt.length-1],Mt=isAnimatable(bt,_),Bt=isAnimatable(St,_);return!Mt||!Bt?!1:hasKeyframesChanged(rt)||ut==="spring"&&mt}class BaseAnimation{constructor({autoplay:_=!0,delay:ut=0,type:mt="keyframes",repeat:bt=0,repeatDelay:St=0,repeatType:Mt="loop",...Bt}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.options={autoplay:_,delay:ut,type:mt,repeat:bt,repeatDelay:St,repeatType:Mt,...Bt},this.updateFinishedPromise()}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&flushKeyframeResolvers(),this._resolved}onKeyframesResolved(_,ut){this.hasAttemptedResolve=!0;const{name:mt,type:bt,velocity:St,delay:Mt,onComplete:Bt,onUpdate:Ut,isGenerator:Ht}=this.options;if(!Ht&&!canAnimate(_,mt,bt,St))if(Mt)this.options.duration=0;else{Ut==null||Ut(getFinalKeyframe(_,this.options,ut)),Bt==null||Bt(),this.resolveFinishedPromise();return}const tr=this.initPlayback(_,ut);tr!==!1&&(this._resolved={keyframes:_,finalKeyframe:ut,...tr},this.onPostResolved())}onPostResolved(){}then(_,ut){return this.currentFinishedPromise.then(_,ut)}updateFinishedPromise(){this.currentFinishedPromise=new Promise(_=>{this.resolveFinishedPromise=_})}}function velocityPerSecond(rt,_){return _?rt*(1e3/_):0}const velocitySampleDuration=5;function calcGeneratorVelocity(rt,_,ut){const mt=Math.max(_-velocitySampleDuration,0);return velocityPerSecond(ut-rt(mt),_-mt)}const safeMin=.001,minDuration=.01,maxDuration$1=10,minDamping=.05,maxDamping=1;function findSpring({duration:rt=800,bounce:_=.25,velocity:ut=0,mass:mt=1}){let bt,St,Mt=1-_;Mt=clamp$3(minDamping,maxDamping,Mt),rt=clamp$3(minDuration,maxDuration$1,millisecondsToSeconds(rt)),Mt<1?(bt=Ht=>{const tr=Ht*Mt,rr=tr*rt,sr=tr-ut,ar=calcAngularFreq(Ht,Mt),cr=Math.exp(-rr);return safeMin-sr/ar*cr},St=Ht=>{const rr=Ht*Mt*rt,sr=rr*ut+ut,ar=Math.pow(Mt,2)*Math.pow(Ht,2)*rt,cr=Math.exp(-rr),Ar=calcAngularFreq(Math.pow(Ht,2),Mt);return(-bt(Ht)+safeMin>0?-1:1)*((sr-ar)*cr)/Ar}):(bt=Ht=>{const tr=Math.exp(-Ht*rt),rr=(Ht-ut)*rt+1;return-safeMin+tr*rr},St=Ht=>{const tr=Math.exp(-Ht*rt),rr=(ut-Ht)*(rt*rt);return tr*rr});const Bt=5/rt,Ut=approximateRoot(bt,St,Bt);if(rt=secondsToMilliseconds(rt),isNaN(Ut))return{stiffness:100,damping:10,duration:rt};{const Ht=Math.pow(Ut,2)*mt;return{stiffness:Ht,damping:Mt*2*Math.sqrt(mt*Ht),duration:rt}}}const rootIterations=12;function approximateRoot(rt,_,ut){let mt=ut;for(let bt=1;bt<rootIterations;bt++)mt=mt-rt(mt)/_(mt);return mt}function calcAngularFreq(rt,_){return rt*Math.sqrt(1-_*_)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(rt,_){return _.some(ut=>rt[ut]!==void 0)}function getSpringOptions(rt){let _={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...rt};if(!isSpringType(rt,physicsKeys)&&isSpringType(rt,durationKeys)){const ut=findSpring(rt);_={..._,...ut,mass:1},_.isResolvedFromDuration=!0}return _}function spring({keyframes:rt,restDelta:_,restSpeed:ut,...mt}){const bt=rt[0],St=rt[rt.length-1],Mt={done:!1,value:bt},{stiffness:Bt,damping:Ut,mass:Ht,duration:tr,velocity:rr,isResolvedFromDuration:sr}=getSpringOptions({...mt,velocity:-millisecondsToSeconds(mt.velocity||0)}),ar=rr||0,cr=Ut/(2*Math.sqrt(Bt*Ht)),Ar=St-bt,_r=millisecondsToSeconds(Math.sqrt(Bt/Ht)),Dr=Math.abs(Ar)<5;ut||(ut=Dr?.01:2),_||(_=Dr?.005:.5);let $r;if(cr<1){const Br=calcAngularFreq(_r,cr);$r=Jr=>{const mn=Math.exp(-cr*_r*Jr);return St-mn*((ar+cr*_r*Ar)/Br*Math.sin(Br*Jr)+Ar*Math.cos(Br*Jr))}}else if(cr===1)$r=Br=>St-Math.exp(-_r*Br)*(Ar+(ar+_r*Ar)*Br);else{const Br=_r*Math.sqrt(cr*cr-1);$r=Jr=>{const mn=Math.exp(-cr*_r*Jr),Mn=Math.min(Br*Jr,300);return St-mn*((ar+cr*_r*Ar)*Math.sinh(Mn)+Br*Ar*Math.cosh(Mn))/Br}}return{calculatedDuration:sr&&tr||null,next:Br=>{const Jr=$r(Br);if(sr)Mt.done=Br>=tr;else{let mn=ar;Br!==0&&(cr<1?mn=calcGeneratorVelocity($r,Br,Jr):mn=0);const Mn=Math.abs(mn)<=ut,$n=Math.abs(St-Jr)<=_;Mt.done=Mn&&$n}return Mt.value=Mt.done?St:Jr,Mt}}}function inertia({keyframes:rt,velocity:_=0,power:ut=.8,timeConstant:mt=325,bounceDamping:bt=10,bounceStiffness:St=500,modifyTarget:Mt,min:Bt,max:Ut,restDelta:Ht=.5,restSpeed:tr}){const rr=rt[0],sr={done:!1,value:rr},ar=en=>Bt!==void 0&&en<Bt||Ut!==void 0&&en>Ut,cr=en=>Bt===void 0?Ut:Ut===void 0||Math.abs(Bt-en)<Math.abs(Ut-en)?Bt:Ut;let Ar=ut*_;const _r=rr+Ar,Dr=Mt===void 0?_r:Mt(_r);Dr!==_r&&(Ar=Dr-rr);const $r=en=>-Ar*Math.exp(-en/mt),Br=en=>Dr+$r(en),Jr=en=>{const In=$r(en),Rn=Br(en);sr.done=Math.abs(In)<=Ht,sr.value=sr.done?Dr:Rn};let mn,Mn;const $n=en=>{ar(sr.value)&&(mn=en,Mn=spring({keyframes:[sr.value,cr(sr.value)],velocity:calcGeneratorVelocity(Br,en,sr.value),damping:bt,stiffness:St,restDelta:Ht,restSpeed:tr}))};return $n(0),{calculatedDuration:null,next:en=>{let In=!1;return!Mn&&mn===void 0&&(In=!0,Jr(en),$n(en)),mn!==void 0&&en>=mn?Mn.next(en-mn):(!In&&Jr(en),sr)}}}const calcBezier=(rt,_,ut)=>(((1-3*ut+3*_)*rt+(3*ut-6*_))*rt+3*_)*rt,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(rt,_,ut,mt,bt){let St,Mt,Bt=0;do Mt=_+(ut-_)/2,St=calcBezier(Mt,mt,bt)-rt,St>0?ut=Mt:_=Mt;while(Math.abs(St)>subdivisionPrecision&&++Bt<subdivisionMaxIterations);return Mt}function cubicBezier(rt,_,ut,mt){if(rt===_&&ut===mt)return noop$1;const bt=St=>binarySubdivide(St,0,1,rt,ut);return St=>St===0||St===1?St:calcBezier(bt(St),_,mt)}const easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=rt=>Array.isArray(rt)&&typeof rt[0]!="number",mirrorEasing=rt=>_=>_<=.5?rt(2*_)/2:(2-rt(2*(1-_)))/2,reverseEasing=rt=>_=>1-rt(1-_),circIn=rt=>1-Math.sin(Math.acos(rt)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=rt=>(rt*=2)<1?.5*backIn(rt):.5*(2-Math.pow(2,-10*(rt-1))),easingLookup={linear:noop$1,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},easingDefinitionToFunction=rt=>{if(Array.isArray(rt)){invariant(rt.length===4);const[_,ut,mt,bt]=rt;return cubicBezier(_,ut,mt,bt)}else if(typeof rt=="string")return invariant(easingLookup[rt]!==void 0),easingLookup[rt];return rt},progress=(rt,_,ut)=>{const mt=_-rt;return mt===0?1:(ut-rt)/mt},mixNumber$1=(rt,_,ut)=>rt+(_-rt)*ut;function hueToRgb(rt,_,ut){return ut<0&&(ut+=1),ut>1&&(ut-=1),ut<1/6?rt+(_-rt)*6*ut:ut<1/2?_:ut<2/3?rt+(_-rt)*(2/3-ut)*6:rt}function hslaToRgba({hue:rt,saturation:_,lightness:ut,alpha:mt}){rt/=360,_/=100,ut/=100;let bt=0,St=0,Mt=0;if(!_)bt=St=Mt=ut;else{const Bt=ut<.5?ut*(1+_):ut+_-ut*_,Ut=2*ut-Bt;bt=hueToRgb(Ut,Bt,rt+1/3),St=hueToRgb(Ut,Bt,rt),Mt=hueToRgb(Ut,Bt,rt-1/3)}return{red:Math.round(bt*255),green:Math.round(St*255),blue:Math.round(Mt*255),alpha:mt}}const mixLinearColor=(rt,_,ut)=>{const mt=rt*rt,bt=ut*(_*_-mt)+mt;return bt<0?0:Math.sqrt(bt)},colorTypes=[hex,rgba,hsla],getColorType=rt=>colorTypes.find(_=>_.test(rt));function asRGBA(rt){const _=getColorType(rt);let ut=_.parse(rt);return _===hsla&&(ut=hslaToRgba(ut)),ut}const mixColor=(rt,_)=>{const ut=asRGBA(rt),mt=asRGBA(_),bt={...ut};return St=>(bt.red=mixLinearColor(ut.red,mt.red,St),bt.green=mixLinearColor(ut.green,mt.green,St),bt.blue=mixLinearColor(ut.blue,mt.blue,St),bt.alpha=mixNumber$1(ut.alpha,mt.alpha,St),rgba.transform(bt))};function mixImmediate(rt,_){return ut=>ut>0?_:rt}function mixNumber(rt,_){return ut=>mixNumber$1(rt,_,ut)}function getMixer(rt){return typeof rt=="number"?mixNumber:typeof rt=="string"?isCSSVariableToken(rt)?mixImmediate:color$2.test(rt)?mixColor:mixComplex:Array.isArray(rt)?mixArray:typeof rt=="object"?color$2.test(rt)?mixColor:mixObject:mixImmediate}function mixArray(rt,_){const ut=[...rt],mt=ut.length,bt=rt.map((St,Mt)=>getMixer(St)(St,_[Mt]));return St=>{for(let Mt=0;Mt<mt;Mt++)ut[Mt]=bt[Mt](St);return ut}}function mixObject(rt,_){const ut={...rt,..._},mt={};for(const bt in ut)rt[bt]!==void 0&&_[bt]!==void 0&&(mt[bt]=getMixer(rt[bt])(rt[bt],_[bt]));return bt=>{for(const St in mt)ut[St]=mt[St](bt);return ut}}function matchOrder(rt,_){var ut;const mt=[],bt={color:0,var:0,number:0};for(let St=0;St<_.values.length;St++){const Mt=_.types[St],Bt=rt.indexes[Mt][bt[Mt]],Ut=(ut=rt.values[Bt])!==null&&ut!==void 0?ut:0;mt[St]=Ut,bt[Mt]++}return mt}const mixComplex=(rt,_)=>{const ut=complex.createTransformer(_),mt=analyseComplexValue(rt),bt=analyseComplexValue(_);return mt.indexes.var.length===bt.indexes.var.length&&mt.indexes.color.length===bt.indexes.color.length&&mt.indexes.number.length>=bt.indexes.number.length?pipe$1(mixArray(matchOrder(mt,bt),bt.values),ut):mixImmediate(rt,_)};function mix(rt,_,ut){return typeof rt=="number"&&typeof _=="number"&&typeof ut=="number"?mixNumber$1(rt,_,ut):getMixer(rt)(rt,_)}function createMixers(rt,_,ut){const mt=[],bt=ut||mix,St=rt.length-1;for(let Mt=0;Mt<St;Mt++){let Bt=bt(rt[Mt],rt[Mt+1]);if(_){const Ut=Array.isArray(_)?_[Mt]||noop$1:_;Bt=pipe$1(Ut,Bt)}mt.push(Bt)}return mt}function interpolate$1(rt,_,{clamp:ut=!0,ease:mt,mixer:bt}={}){const St=rt.length;if(invariant(St===_.length),St===1)return()=>_[0];if(St===2&&rt[0]===rt[1])return()=>_[1];rt[0]>rt[St-1]&&(rt=[...rt].reverse(),_=[..._].reverse());const Mt=createMixers(_,mt,bt),Bt=Mt.length,Ut=Ht=>{let tr=0;if(Bt>1)for(;tr<rt.length-2&&!(Ht<rt[tr+1]);tr++);const rr=progress(rt[tr],rt[tr+1],Ht);return Mt[tr](rr)};return ut?Ht=>Ut(clamp$3(rt[0],rt[St-1],Ht)):Ut}function fillOffset(rt,_){const ut=rt[rt.length-1];for(let mt=1;mt<=_;mt++){const bt=progress(0,_,mt);rt.push(mixNumber$1(ut,1,bt))}}function defaultOffset(rt){const _=[0];return fillOffset(_,rt.length-1),_}function convertOffsetToTimes(rt,_){return rt.map(ut=>ut*_)}function defaultEasing(rt,_){return rt.map(()=>_||easeInOut).splice(0,rt.length-1)}function keyframes$1({duration:rt=300,keyframes:_,times:ut,ease:mt="easeInOut"}){const bt=isEasingArray(mt)?mt.map(easingDefinitionToFunction):easingDefinitionToFunction(mt),St={done:!1,value:_[0]},Mt=convertOffsetToTimes(ut&&ut.length===_.length?ut:defaultOffset(_),rt),Bt=interpolate$1(Mt,_,{ease:Array.isArray(bt)?bt:defaultEasing(_,bt)});return{calculatedDuration:rt,next:Ut=>(St.value=Bt(Ut),St.done=Ut>=rt,St)}}const maxGeneratorDuration=2e4;function calcGeneratorDuration(rt){let _=0;const ut=50;let mt=rt.next(_);for(;!mt.done&&_<maxGeneratorDuration;)_+=ut,mt=rt.next(_);return _>=maxGeneratorDuration?1/0:_}const frameloopDriver=rt=>{const _=({timestamp:ut})=>rt(ut);return{start:()=>frame.update(_,!0),stop:()=>cancelFrame(_),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generators={decay:inertia,inertia,tween:keyframes$1,keyframes:keyframes$1,spring},percentToProgress=rt=>rt/100;class MainThreadAnimation extends BaseAnimation{constructor({KeyframeResolver:_=KeyframeResolver,...ut}){super(ut),this.holdTime=null,this.startTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:Bt}=this.options;Bt&&Bt()};const{name:mt,motionValue:bt,keyframes:St}=this.options,Mt=(Bt,Ut)=>this.onKeyframesResolved(Bt,Ut);mt&&bt&&bt.owner?this.resolver=bt.owner.resolveKeyframes(St,Mt,mt,bt):this.resolver=new _(St,Mt,mt,bt),this.resolver.scheduleResolve()}initPlayback(_){const{type:ut="keyframes",repeat:mt=0,repeatDelay:bt=0,repeatType:St,velocity:Mt=0}=this.options,Bt=generators[ut]||keyframes$1;let Ut,Ht;Bt!==keyframes$1&&typeof _[0]!="number"&&(Ut=pipe$1(percentToProgress,mix(_[0],_[1])),_=[0,100]);const tr=Bt({...this.options,keyframes:_});St==="mirror"&&(Ht=Bt({...this.options,keyframes:[..._].reverse(),velocity:-Mt})),tr.calculatedDuration===null&&(tr.calculatedDuration=calcGeneratorDuration(tr));const{calculatedDuration:rr}=tr,sr=rr+bt,ar=sr*(mt+1)-bt;return{generator:tr,mirroredGenerator:Ht,mapPercentToKeyframes:Ut,calculatedDuration:rr,resolvedDuration:sr,totalDuration:ar}}onPostResolved(){const{autoplay:_=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!_?this.pause():this.state=this.pendingPlayState}tick(_,ut=!1){const{resolved:mt}=this;if(!mt){const{keyframes:en}=this.options;return{done:!0,value:en[en.length-1]}}const{finalKeyframe:bt,generator:St,mirroredGenerator:Mt,mapPercentToKeyframes:Bt,keyframes:Ut,calculatedDuration:Ht,totalDuration:tr,resolvedDuration:rr}=mt;if(this.startTime===null)return St.next(0);const{delay:sr,repeat:ar,repeatType:cr,repeatDelay:Ar,onUpdate:_r}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,_):this.speed<0&&(this.startTime=Math.min(_-tr/this.speed,this.startTime)),ut?this.currentTime=_:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(_-this.startTime)*this.speed;const Dr=this.currentTime-sr*(this.speed>=0?1:-1),$r=this.speed>=0?Dr<0:Dr>tr;this.currentTime=Math.max(Dr,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=tr);let Br=this.currentTime,Jr=St;if(ar){const en=Math.min(this.currentTime,tr)/rr;let In=Math.floor(en),Rn=en%1;!Rn&&en>=1&&(Rn=1),Rn===1&&In--,In=Math.min(In,ar+1),!!(In%2)&&(cr==="reverse"?(Rn=1-Rn,Ar&&(Rn-=Ar/rr)):cr==="mirror"&&(Jr=Mt)),Br=clamp$3(0,1,Rn)*rr}const mn=$r?{done:!1,value:Ut[0]}:Jr.next(Br);Bt&&(mn.value=Bt(mn.value));let{done:Mn}=mn;!$r&&Ht!==null&&(Mn=this.speed>=0?this.currentTime>=tr:this.currentTime<=0);const $n=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Mn);return $n&&bt!==void 0&&(mn.value=getFinalKeyframe(Ut,this.options,bt)),_r&&_r(mn.value),$n&&this.finish(),mn}get duration(){const{resolved:_}=this;return _?millisecondsToSeconds(_.calculatedDuration):0}get time(){return millisecondsToSeconds(this.currentTime)}set time(_){_=secondsToMilliseconds(_),this.currentTime=_,this.holdTime!==null||this.speed===0?this.holdTime=_:this.driver&&(this.startTime=this.driver.now()-_/this.speed)}get speed(){return this.playbackSpeed}set speed(_){const ut=this.playbackSpeed!==_;this.playbackSpeed=_,ut&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:_=frameloopDriver,onPlay:ut}=this.options;this.driver||(this.driver=_(bt=>this.tick(bt))),ut&&ut();const mt=this.driver.now();this.holdTime!==null?this.startTime=mt-this.holdTime:(!this.startTime||this.state==="finished")&&(this.startTime=mt),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var _;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(_=this.currentTime)!==null&&_!==void 0?_:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:_}=this.options;_&&_()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(_){return this.startTime=0,this.tick(_,!0)}}const isBezierDefinition=rt=>Array.isArray(rt)&&typeof rt[0]=="number";function isWaapiSupportedEasing(rt){return!!(!rt||typeof rt=="string"&&rt in supportedWaapiEasing||isBezierDefinition(rt)||Array.isArray(rt)&&rt.every(isWaapiSupportedEasing))}const cubicBezierAsString=([rt,_,ut,mt])=>`cubic-bezier(${rt}, ${_}, ${ut}, ${mt})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasingWithDefault(rt){return mapEasingToNativeEasing(rt)||supportedWaapiEasing.easeOut}function mapEasingToNativeEasing(rt){if(rt)return isBezierDefinition(rt)?cubicBezierAsString(rt):Array.isArray(rt)?rt.map(mapEasingToNativeEasingWithDefault):supportedWaapiEasing[rt]}function animateStyle(rt,_,ut,{delay:mt=0,duration:bt=300,repeat:St=0,repeatType:Mt="loop",ease:Bt,times:Ut}={}){const Ht={[_]:ut};Ut&&(Ht.offset=Ut);const tr=mapEasingToNativeEasing(Bt);return Array.isArray(tr)&&(Ht.easing=tr),rt.animate(Ht,{delay:mt,duration:bt,easing:Array.isArray(tr)?"linear":tr,fill:"both",iterations:St+1,direction:Mt==="reverse"?"alternate":"normal"})}const supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),acceleratedValues=new Set(["opacity","clipPath","filter","transform"]),sampleDelta=10,maxDuration=2e4;function requiresPregeneratedKeyframes(rt){return rt.type==="spring"||rt.name==="backgroundColor"||!isWaapiSupportedEasing(rt.ease)}function pregenerateKeyframes(rt,_){const ut=new MainThreadAnimation({..._,keyframes:rt,repeat:0,delay:0,isGenerator:!0});let mt={done:!1,value:rt[0]};const bt=[];let St=0;for(;!mt.done&&St<maxDuration;)mt=ut.sample(St),bt.push(mt.value),St+=sampleDelta;return{times:void 0,keyframes:bt,duration:St-sampleDelta,ease:"linear"}}class AcceleratedAnimation extends BaseAnimation{constructor(_){super(_);const{name:ut,motionValue:mt,keyframes:bt}=this.options;this.resolver=new DOMKeyframesResolver(bt,(St,Mt)=>this.onKeyframesResolved(St,Mt),ut,mt),this.resolver.scheduleResolve()}initPlayback(_,ut){var mt;let{duration:bt=300,times:St,ease:Mt,type:Bt,motionValue:Ut,name:Ht}=this.options;if(!(!((mt=Ut.owner)===null||mt===void 0)&&mt.current))return!1;if(requiresPregeneratedKeyframes(this.options)){const{onComplete:rr,onUpdate:sr,motionValue:ar,...cr}=this.options,Ar=pregenerateKeyframes(_,cr);_=Ar.keyframes,_.length===1&&(_[1]=_[0]),bt=Ar.duration,St=Ar.times,Mt=Ar.ease,Bt="keyframes"}const tr=animateStyle(Ut.owner.current,Ht,_,{...this.options,duration:bt,times:St,ease:Mt});return tr.startTime=time.now(),this.pendingTimeline?(tr.timeline=this.pendingTimeline,this.pendingTimeline=void 0):tr.onfinish=()=>{const{onComplete:rr}=this.options;Ut.set(getFinalKeyframe(_,this.options,ut)),rr&&rr(),this.cancel(),this.resolveFinishedPromise()},{animation:tr,duration:bt,times:St,type:Bt,ease:Mt,keyframes:_}}get duration(){const{resolved:_}=this;if(!_)return 0;const{duration:ut}=_;return millisecondsToSeconds(ut)}get time(){const{resolved:_}=this;if(!_)return 0;const{animation:ut}=_;return millisecondsToSeconds(ut.currentTime||0)}set time(_){const{resolved:ut}=this;if(!ut)return;const{animation:mt}=ut;mt.currentTime=secondsToMilliseconds(_)}get speed(){const{resolved:_}=this;if(!_)return 1;const{animation:ut}=_;return ut.playbackRate}set speed(_){const{resolved:ut}=this;if(!ut)return;const{animation:mt}=ut;mt.playbackRate=_}get state(){const{resolved:_}=this;if(!_)return"idle";const{animation:ut}=_;return ut.playState}attachTimeline(_){if(!this._resolved)this.pendingTimeline=_;else{const{resolved:ut}=this;if(!ut)return noop$1;const{animation:mt}=ut;mt.timeline=_,mt.onfinish=null}return noop$1}play(){if(this.isStopped)return;const{resolved:_}=this;if(!_)return;const{animation:ut}=_;ut.playState==="finished"&&this.updateFinishedPromise(),ut.play()}pause(){const{resolved:_}=this;if(!_)return;const{animation:ut}=_;ut.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;const{resolved:_}=this;if(!_)return;const{animation:ut,keyframes:mt,duration:bt,type:St,ease:Mt,times:Bt}=_;if(!(ut.playState==="idle"||ut.playState==="finished")){if(this.time){const{motionValue:Ut,onUpdate:Ht,onComplete:tr,...rr}=this.options,sr=new MainThreadAnimation({...rr,keyframes:mt,duration:bt,type:St,ease:Mt,times:Bt,isGenerator:!0}),ar=secondsToMilliseconds(this.time);Ut.setWithVelocity(sr.sample(ar-sampleDelta).value,sr.sample(ar).value,sampleDelta)}this.cancel()}}complete(){const{resolved:_}=this;_&&_.animation.finish()}cancel(){const{resolved:_}=this;_&&_.animation.cancel()}static supports(_){const{motionValue:ut,name:mt,repeatDelay:bt,repeatType:St,damping:Mt,type:Bt}=_;return supportsWaapi()&&mt&&acceleratedValues.has(mt)&&ut&&ut.owner&&ut.owner.current instanceof HTMLElement&&!ut.owner.getProps().onUpdate&&!bt&&St!=="mirror"&&Mt!==0&&Bt!=="inertia"}}const animateMotionValue=(rt,_,ut,mt={},bt,St)=>Mt=>{const Bt=getValueTransition$1(mt,rt)||{},Ut=Bt.delay||mt.delay||0;let{elapsed:Ht=0}=mt;Ht=Ht-secondsToMilliseconds(Ut);let tr={keyframes:Array.isArray(ut)?ut:[null,ut],ease:"easeOut",velocity:_.getVelocity(),...Bt,delay:-Ht,onUpdate:sr=>{_.set(sr),Bt.onUpdate&&Bt.onUpdate(sr)},onComplete:()=>{Mt(),Bt.onComplete&&Bt.onComplete()},name:rt,motionValue:_,element:St?void 0:bt};isTransitionDefined(Bt)||(tr={...tr,...getDefaultTransition(rt,tr)}),tr.duration&&(tr.duration=secondsToMilliseconds(tr.duration)),tr.repeatDelay&&(tr.repeatDelay=secondsToMilliseconds(tr.repeatDelay)),tr.from!==void 0&&(tr.keyframes[0]=tr.from);let rr=!1;if((tr.type===!1||tr.duration===0&&!tr.repeatDelay)&&(tr.duration=0,tr.delay===0&&(rr=!0)),rr&&!St&&_.get()!==void 0){const sr=getFinalKeyframe(tr.keyframes,Bt);if(sr!==void 0){frame.update(()=>{tr.onUpdate(sr),tr.onComplete()});return}}return!St&&AcceleratedAnimation.supports(tr)?new AcceleratedAnimation(tr):new MainThreadAnimation(tr)};function isWillChangeMotionValue(rt){return!!(isMotionValue(rt)&&rt.add)}function addUniqueItem(rt,_){rt.indexOf(_)===-1&&rt.push(_)}function removeItem(rt,_){const ut=rt.indexOf(_);ut>-1&&rt.splice(ut,1)}class SubscriptionManager{constructor(){this.subscriptions=[]}add(_){return addUniqueItem(this.subscriptions,_),()=>removeItem(this.subscriptions,_)}notify(_,ut,mt){const bt=this.subscriptions.length;if(bt)if(bt===1)this.subscriptions[0](_,ut,mt);else for(let St=0;St<bt;St++){const Mt=this.subscriptions[St];Mt&&Mt(_,ut,mt)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const MAX_VELOCITY_DELTA=30,isFloat=rt=>!isNaN(parseFloat(rt));class MotionValue{constructor(_,ut={}){this.version="11.1.9",this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(mt,bt=!0)=>{const St=time.now();this.updatedAt!==St&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(mt),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),bt&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(_),this.canTrackVelocity=isFloat(this.current),this.owner=ut.owner}setCurrent(_){this.current=_,this.updatedAt=time.now()}setPrevFrameValue(_=this.current){this.prevFrameValue=_,this.prevUpdatedAt=this.updatedAt}onChange(_){return this.on("change",_)}on(_,ut){this.events[_]||(this.events[_]=new SubscriptionManager);const mt=this.events[_].add(ut);return _==="change"?()=>{mt(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:mt}clearListeners(){for(const _ in this.events)this.events[_].clear()}attach(_,ut){this.passiveEffect=_,this.stopPassiveEffect=ut}set(_,ut=!0){!ut||!this.passiveEffect?this.updateAndNotify(_,ut):this.passiveEffect(_,this.updateAndNotify)}setWithVelocity(_,ut,mt){this.set(ut),this.prev=void 0,this.prevFrameValue=_,this.prevUpdatedAt=this.updatedAt-mt}jump(_,ut=!0){this.updateAndNotify(_),this.prev=_,this.prevUpdatedAt=this.prevFrameValue=void 0,ut&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const _=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||_-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const ut=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),ut)}start(_){return this.stop(),new Promise(ut=>{this.hasAnimated=!0,this.animation=_(ut),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(rt,_){return new MotionValue(rt,_)}function setMotionValue(rt,_,ut){rt.hasValue(_)?rt.getValue(_).set(ut):rt.addValue(_,motionValue(ut))}function setTarget(rt,_){const ut=resolveVariant(rt,_);let{transitionEnd:mt={},transition:bt={},...St}=ut||{};St={...St,...mt};for(const Mt in St){const Bt=resolveFinalValueInKeyframes(St[Mt]);setMotionValue(rt,Mt,Bt)}}function shouldBlockAnimation({protectedKeys:rt,needsAnimating:_},ut){const mt=rt.hasOwnProperty(ut)&&_[ut]!==!0;return _[ut]=!1,mt}function animateTarget(rt,_,{delay:ut=0,transitionOverride:mt,type:bt}={}){var St;let{transition:Mt=rt.getDefaultTransition(),transitionEnd:Bt,...Ut}=_;const Ht=rt.getValue("willChange");mt&&(Mt=mt);const tr=[],rr=bt&&rt.animationState&&rt.animationState.getState()[bt];for(const sr in Ut){const ar=rt.getValue(sr,(St=rt.latestValues[sr])!==null&&St!==void 0?St:null),cr=Ut[sr];if(cr===void 0||rr&&shouldBlockAnimation(rr,sr))continue;const Ar={delay:ut,elapsed:0,...getValueTransition$1(Mt||{},sr)};let _r=!1;if(window.HandoffAppearAnimations){const Br=rt.getProps()[optimizedAppearDataAttribute];if(Br){const Jr=window.HandoffAppearAnimations(Br,sr);Jr!==null&&(Ar.elapsed=Jr,_r=!0)}}ar.start(animateMotionValue(sr,ar,cr,rt.shouldReduceMotion&&transformProps.has(sr)?{type:!1}:Ar,rt,_r));const Dr=ar.animation;Dr&&(isWillChangeMotionValue(Ht)&&(Ht.add(sr),Dr.then(()=>Ht.remove(sr))),tr.push(Dr))}return Bt&&Promise.all(tr).then(()=>{frame.update(()=>{Bt&&setTarget(rt,Bt)})}),tr}function animateVariant(rt,_,ut={}){var mt;const bt=resolveVariant(rt,_,ut.type==="exit"?(mt=rt.presenceContext)===null||mt===void 0?void 0:mt.custom:void 0);let{transition:St=rt.getDefaultTransition()||{}}=bt||{};ut.transitionOverride&&(St=ut.transitionOverride);const Mt=bt?()=>Promise.all(animateTarget(rt,bt,ut)):()=>Promise.resolve(),Bt=rt.variantChildren&&rt.variantChildren.size?(Ht=0)=>{const{delayChildren:tr=0,staggerChildren:rr,staggerDirection:sr}=St;return animateChildren(rt,_,tr+Ht,rr,sr,ut)}:()=>Promise.resolve(),{when:Ut}=St;if(Ut){const[Ht,tr]=Ut==="beforeChildren"?[Mt,Bt]:[Bt,Mt];return Ht().then(()=>tr())}else return Promise.all([Mt(),Bt(ut.delay)])}function animateChildren(rt,_,ut=0,mt=0,bt=1,St){const Mt=[],Bt=(rt.variantChildren.size-1)*mt,Ut=bt===1?(Ht=0)=>Ht*mt:(Ht=0)=>Bt-Ht*mt;return Array.from(rt.variantChildren).sort(sortByTreeOrder).forEach((Ht,tr)=>{Ht.notify("AnimationStart",_),Mt.push(animateVariant(Ht,_,{...St,delay:ut+Ut(tr)}).then(()=>Ht.notify("AnimationComplete",_)))}),Promise.all(Mt)}function sortByTreeOrder(rt,_){return rt.sortNodePosition(_)}function animateVisualElement(rt,_,ut={}){rt.notify("AnimationStart",_);let mt;if(Array.isArray(_)){const bt=_.map(St=>animateVariant(rt,St,ut));mt=Promise.all(bt)}else if(typeof _=="string")mt=animateVariant(rt,_,ut);else{const bt=typeof _=="function"?resolveVariant(rt,_,ut.custom):_;mt=Promise.all(animateTarget(rt,bt,ut))}return mt.then(()=>{frame.postRender(()=>{rt.notify("AnimationComplete",_)})})}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(rt){return _=>Promise.all(_.map(({animation:ut,options:mt})=>animateVisualElement(rt,ut,mt)))}function createAnimationState(rt){let _=animateList(rt);const ut=createState();let mt=!0;const bt=Ut=>(Ht,tr)=>{var rr;const sr=resolveVariant(rt,tr,Ut==="exit"?(rr=rt.presenceContext)===null||rr===void 0?void 0:rr.custom:void 0);if(sr){const{transition:ar,transitionEnd:cr,...Ar}=sr;Ht={...Ht,...Ar,...cr}}return Ht};function St(Ut){_=Ut(rt)}function Mt(Ut){const Ht=rt.getProps(),tr=rt.getVariantContext(!0)||{},rr=[],sr=new Set;let ar={},cr=1/0;for(let _r=0;_r<numAnimationTypes;_r++){const Dr=reversePriorityOrder[_r],$r=ut[Dr],Br=Ht[Dr]!==void 0?Ht[Dr]:tr[Dr],Jr=isVariantLabel(Br),mn=Dr===Ut?$r.isActive:null;mn===!1&&(cr=_r);let Mn=Br===tr[Dr]&&Br!==Ht[Dr]&&Jr;if(Mn&&mt&&rt.manuallyAnimateOnMount&&(Mn=!1),$r.protectedKeys={...ar},!$r.isActive&&mn===null||!Br&&!$r.prevProp||isAnimationControls(Br)||typeof Br=="boolean")continue;let en=checkVariantsDidChange($r.prevProp,Br)||Dr===Ut&&$r.isActive&&!Mn&&Jr||_r>cr&&Jr,In=!1;const Rn=Array.isArray(Br)?Br:[Br];let qn=Rn.reduce(bt(Dr),{});mn===!1&&(qn={});const{prevResolvedValues:Qn={}}=$r,xs={...Qn,...qn},cs=ks=>{en=!0,sr.has(ks)&&(In=!0,sr.delete(ks)),$r.needsAnimating[ks]=!0;const _o=rt.getValue(ks);_o&&(_o.liveStyle=!1)};for(const ks in xs){const _o=qn[ks],qs=Qn[ks];if(ar.hasOwnProperty(ks))continue;let Ss=!1;isKeyframesTarget(_o)&&isKeyframesTarget(qs)?Ss=!shallowCompare(_o,qs):Ss=_o!==qs,Ss?_o!=null?cs(ks):sr.add(ks):_o!==void 0&&sr.has(ks)?cs(ks):$r.protectedKeys[ks]=!0}$r.prevProp=Br,$r.prevResolvedValues=qn,$r.isActive&&(ar={...ar,...qn}),mt&&rt.blockInitialAnimation&&(en=!1),en&&(!Mn||In)&&rr.push(...Rn.map(ks=>({animation:ks,options:{type:Dr}})))}if(sr.size){const _r={};sr.forEach(Dr=>{const $r=rt.getBaseTarget(Dr),Br=rt.getValue(Dr);Br&&(Br.liveStyle=!0),_r[Dr]=$r??null}),rr.push({animation:_r})}let Ar=!!rr.length;return mt&&(Ht.initial===!1||Ht.initial===Ht.animate)&&!rt.manuallyAnimateOnMount&&(Ar=!1),mt=!1,Ar?_(rr):Promise.resolve()}function Bt(Ut,Ht){var tr;if(ut[Ut].isActive===Ht)return Promise.resolve();(tr=rt.variantChildren)===null||tr===void 0||tr.forEach(sr=>{var ar;return(ar=sr.animationState)===null||ar===void 0?void 0:ar.setActive(Ut,Ht)}),ut[Ut].isActive=Ht;const rr=Mt(Ut);for(const sr in ut)ut[sr].protectedKeys={};return rr}return{animateChanges:Mt,setActive:Bt,setAnimateFunction:St,getState:()=>ut}}function checkVariantsDidChange(rt,_){return typeof _=="string"?_!==rt:Array.isArray(_)?!shallowCompare(_,rt):!1}function createTypeState(rt=!1){return{isActive:rt,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class AnimationFeature extends Feature{constructor(_){super(_),_.animationState||(_.animationState=createAnimationState(_))}updateAnimationControlsSubscription(){const{animate:_}=this.node.getProps();this.unmount(),isAnimationControls(_)&&(this.unmount=_.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:_}=this.node.getProps(),{animate:ut}=this.node.prevProps||{};_!==ut&&this.updateAnimationControlsSubscription()}unmount(){}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:_,onExitComplete:ut}=this.node.presenceContext,{isPresent:mt}=this.node.prevPresenceContext||{};if(!this.node.animationState||_===mt)return;const bt=this.node.animationState.setActive("exit",!_);ut&&!_&&bt.then(()=>ut(this.id))}mount(){const{register:_}=this.node.presenceContext||{};_&&(this.unmount=_(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}},distance=(rt,_)=>Math.abs(rt-_);function distance2D(rt,_){const ut=distance(rt.x,_.x),mt=distance(rt.y,_.y);return Math.sqrt(ut**2+mt**2)}class PanSession{constructor(_,ut,{transformPagePoint:mt,contextWindow:bt,dragSnapToOrigin:St=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const rr=getPanInfo(this.lastMoveEventInfo,this.history),sr=this.startEvent!==null,ar=distance2D(rr.offset,{x:0,y:0})>=3;if(!sr&&!ar)return;const{point:cr}=rr,{timestamp:Ar}=frameData;this.history.push({...cr,timestamp:Ar});const{onStart:_r,onMove:Dr}=this.handlers;sr||(_r&&_r(this.lastMoveEvent,rr),this.startEvent=this.lastMoveEvent),Dr&&Dr(this.lastMoveEvent,rr)},this.handlePointerMove=(rr,sr)=>{this.lastMoveEvent=rr,this.lastMoveEventInfo=transformPoint(sr,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(rr,sr)=>{this.end();const{onEnd:ar,onSessionEnd:cr,resumeAnimation:Ar}=this.handlers;if(this.dragSnapToOrigin&&Ar&&Ar(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _r=getPanInfo(rr.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(sr,this.transformPagePoint),this.history);this.startEvent&&ar&&ar(rr,_r),cr&&cr(rr,_r)},!isPrimaryPointer(_))return;this.dragSnapToOrigin=St,this.handlers=ut,this.transformPagePoint=mt,this.contextWindow=bt||window;const Mt=extractEventInfo(_),Bt=transformPoint(Mt,this.transformPagePoint),{point:Ut}=Bt,{timestamp:Ht}=frameData;this.history=[{...Ut,timestamp:Ht}];const{onSessionStart:tr}=ut;tr&&tr(_,getPanInfo(Bt,this.history)),this.removeListeners=pipe$1(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(_){this.handlers=_}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(rt,_){return _?{point:_(rt.point)}:rt}function subtractPoint(rt,_){return{x:rt.x-_.x,y:rt.y-_.y}}function getPanInfo({point:rt},_){return{point:rt,delta:subtractPoint(rt,lastDevicePoint(_)),offset:subtractPoint(rt,startDevicePoint(_)),velocity:getVelocity(_,.1)}}function startDevicePoint(rt){return rt[0]}function lastDevicePoint(rt){return rt[rt.length-1]}function getVelocity(rt,_){if(rt.length<2)return{x:0,y:0};let ut=rt.length-1,mt=null;const bt=lastDevicePoint(rt);for(;ut>=0&&(mt=rt[ut],!(bt.timestamp-mt.timestamp>secondsToMilliseconds(_)));)ut--;if(!mt)return{x:0,y:0};const St=millisecondsToSeconds(bt.timestamp-mt.timestamp);if(St===0)return{x:0,y:0};const Mt={x:(bt.x-mt.x)/St,y:(bt.y-mt.y)/St};return Mt.x===1/0&&(Mt.x=0),Mt.y===1/0&&(Mt.y=0),Mt}function calcLength(rt){return rt.max-rt.min}function isNear(rt,_=0,ut=.01){return Math.abs(rt-_)<=ut}function calcAxisDelta(rt,_,ut,mt=.5){rt.origin=mt,rt.originPoint=mixNumber$1(_.min,_.max,rt.origin),rt.scale=calcLength(ut)/calcLength(_),(isNear(rt.scale,1,1e-4)||isNaN(rt.scale))&&(rt.scale=1),rt.translate=mixNumber$1(ut.min,ut.max,rt.origin)-rt.originPoint,(isNear(rt.translate)||isNaN(rt.translate))&&(rt.translate=0)}function calcBoxDelta(rt,_,ut,mt){calcAxisDelta(rt.x,_.x,ut.x,mt?mt.originX:void 0),calcAxisDelta(rt.y,_.y,ut.y,mt?mt.originY:void 0)}function calcRelativeAxis(rt,_,ut){rt.min=ut.min+_.min,rt.max=rt.min+calcLength(_)}function calcRelativeBox(rt,_,ut){calcRelativeAxis(rt.x,_.x,ut.x),calcRelativeAxis(rt.y,_.y,ut.y)}function calcRelativeAxisPosition(rt,_,ut){rt.min=_.min-ut.min,rt.max=rt.min+calcLength(_)}function calcRelativePosition(rt,_,ut){calcRelativeAxisPosition(rt.x,_.x,ut.x),calcRelativeAxisPosition(rt.y,_.y,ut.y)}function applyConstraints(rt,{min:_,max:ut},mt){return _!==void 0&&rt<_?rt=mt?mixNumber$1(_,rt,mt.min):Math.max(rt,_):ut!==void 0&&rt>ut&&(rt=mt?mixNumber$1(ut,rt,mt.max):Math.min(rt,ut)),rt}function calcRelativeAxisConstraints(rt,_,ut){return{min:_!==void 0?rt.min+_:void 0,max:ut!==void 0?rt.max+ut-(rt.max-rt.min):void 0}}function calcRelativeConstraints(rt,{top:_,left:ut,bottom:mt,right:bt}){return{x:calcRelativeAxisConstraints(rt.x,ut,bt),y:calcRelativeAxisConstraints(rt.y,_,mt)}}function calcViewportAxisConstraints(rt,_){let ut=_.min-rt.min,mt=_.max-rt.max;return _.max-_.min<rt.max-rt.min&&([ut,mt]=[mt,ut]),{min:ut,max:mt}}function calcViewportConstraints(rt,_){return{x:calcViewportAxisConstraints(rt.x,_.x),y:calcViewportAxisConstraints(rt.y,_.y)}}function calcOrigin(rt,_){let ut=.5;const mt=calcLength(rt),bt=calcLength(_);return bt>mt?ut=progress(_.min,_.max-mt,rt.min):mt>bt&&(ut=progress(rt.min,rt.max-bt,_.min)),clamp$3(0,1,ut)}function rebaseAxisConstraints(rt,_){const ut={};return _.min!==void 0&&(ut.min=_.min-rt.min),_.max!==void 0&&(ut.max=_.max-rt.min),ut}const defaultElastic=.35;function resolveDragElastic(rt=defaultElastic){return rt===!1?rt=0:rt===!0&&(rt=defaultElastic),{x:resolveAxisElastic(rt,"left","right"),y:resolveAxisElastic(rt,"top","bottom")}}function resolveAxisElastic(rt,_,ut){return{min:resolvePointElastic(rt,_),max:resolvePointElastic(rt,ut)}}function resolvePointElastic(rt,_){return typeof rt=="number"?rt:rt[_]||0}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()});function eachAxis(rt){return[rt("x"),rt("y")]}function convertBoundingBoxToBox({top:rt,left:_,right:ut,bottom:mt}){return{x:{min:_,max:ut},y:{min:rt,max:mt}}}function convertBoxToBoundingBox({x:rt,y:_}){return{top:_.min,right:rt.max,bottom:_.max,left:rt.min}}function transformBoxPoints(rt,_){if(!_)return rt;const ut=_({x:rt.left,y:rt.top}),mt=_({x:rt.right,y:rt.bottom});return{top:ut.y,left:ut.x,bottom:mt.y,right:mt.x}}function isIdentityScale(rt){return rt===void 0||rt===1}function hasScale({scale:rt,scaleX:_,scaleY:ut}){return!isIdentityScale(rt)||!isIdentityScale(_)||!isIdentityScale(ut)}function hasTransform(rt){return hasScale(rt)||has2DTranslate(rt)||rt.z||rt.rotate||rt.rotateX||rt.rotateY||rt.skewX||rt.skewY}function has2DTranslate(rt){return is2DTranslate(rt.x)||is2DTranslate(rt.y)}function is2DTranslate(rt){return rt&&rt!=="0%"}function scalePoint(rt,_,ut){const mt=rt-ut,bt=_*mt;return ut+bt}function applyPointDelta(rt,_,ut,mt,bt){return bt!==void 0&&(rt=scalePoint(rt,bt,mt)),scalePoint(rt,ut,mt)+_}function applyAxisDelta(rt,_=0,ut=1,mt,bt){rt.min=applyPointDelta(rt.min,_,ut,mt,bt),rt.max=applyPointDelta(rt.max,_,ut,mt,bt)}function applyBoxDelta(rt,{x:_,y:ut}){applyAxisDelta(rt.x,_.translate,_.scale,_.originPoint),applyAxisDelta(rt.y,ut.translate,ut.scale,ut.originPoint)}function applyTreeDeltas(rt,_,ut,mt=!1){const bt=ut.length;if(!bt)return;_.x=_.y=1;let St,Mt;for(let Bt=0;Bt<bt;Bt++){St=ut[Bt],Mt=St.projectionDelta;const Ut=St.instance;Ut&&Ut.style&&Ut.style.display==="contents"||(mt&&St.options.layoutScroll&&St.scroll&&St!==St.root&&transformBox(rt,{x:-St.scroll.offset.x,y:-St.scroll.offset.y}),Mt&&(_.x*=Mt.x.scale,_.y*=Mt.y.scale,applyBoxDelta(rt,Mt)),mt&&hasTransform(St.latestValues)&&transformBox(rt,St.latestValues))}_.x=snapToDefault(_.x),_.y=snapToDefault(_.y)}function snapToDefault(rt){return Number.isInteger(rt)||rt>1.0000000000001||rt<.999999999999?rt:1}function translateAxis(rt,_){rt.min=rt.min+_,rt.max=rt.max+_}function transformAxis(rt,_,[ut,mt,bt]){const St=_[bt]!==void 0?_[bt]:.5,Mt=mixNumber$1(rt.min,rt.max,St);applyAxisDelta(rt,_[ut],_[mt],Mt,_.scale)}const xKeys$1=["x","scaleX","originX"],yKeys$1=["y","scaleY","originY"];function transformBox(rt,_){transformAxis(rt.x,_,xKeys$1),transformAxis(rt.y,_,yKeys$1)}function measureViewportBox(rt,_){return convertBoundingBoxToBox(transformBoxPoints(rt.getBoundingClientRect(),_))}function measurePageBox(rt,_,ut){const mt=measureViewportBox(rt,ut),{scroll:bt}=_;return bt&&(translateAxis(mt.x,bt.offset.x),translateAxis(mt.y,bt.offset.y)),mt}const getContextWindow=({current:rt})=>rt?rt.ownerDocument.defaultView:null,elementDragControls=new WeakMap;class VisualElementDragControls{constructor(_){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.visualElement=_}start(_,{snapToCursor:ut=!1}={}){const{presenceContext:mt}=this.visualElement;if(mt&&mt.isPresent===!1)return;const bt=tr=>{const{dragSnapToOrigin:rr}=this.getProps();rr?this.pauseAnimation():this.stopAnimation(),ut&&this.snapToCursor(extractEventInfo(tr,"page").point)},St=(tr,rr)=>{const{drag:sr,dragPropagation:ar,onDragStart:cr}=this.getProps();if(sr&&!ar&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=getGlobalLock(sr),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(_r=>{let Dr=this.getAxisMotionValue(_r).get()||0;if(percent.test(Dr)){const{projection:$r}=this.visualElement;if($r&&$r.layout){const Br=$r.layout.layoutBox[_r];Br&&(Dr=calcLength(Br)*(parseFloat(Dr)/100))}}this.originPoint[_r]=Dr}),cr&&frame.postRender(()=>cr(tr,rr));const{animationState:Ar}=this.visualElement;Ar&&Ar.setActive("whileDrag",!0)},Mt=(tr,rr)=>{const{dragPropagation:sr,dragDirectionLock:ar,onDirectionLock:cr,onDrag:Ar}=this.getProps();if(!sr&&!this.openGlobalLock)return;const{offset:_r}=rr;if(ar&&this.currentDirection===null){this.currentDirection=getCurrentDirection(_r),this.currentDirection!==null&&cr&&cr(this.currentDirection);return}this.updateAxis("x",rr.point,_r),this.updateAxis("y",rr.point,_r),this.visualElement.render(),Ar&&Ar(tr,rr)},Bt=(tr,rr)=>this.stop(tr,rr),Ut=()=>eachAxis(tr=>{var rr;return this.getAnimationState(tr)==="paused"&&((rr=this.getAxisMotionValue(tr).animation)===null||rr===void 0?void 0:rr.play())}),{dragSnapToOrigin:Ht}=this.getProps();this.panSession=new PanSession(_,{onSessionStart:bt,onStart:St,onMove:Mt,onSessionEnd:Bt,resumeAnimation:Ut},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:Ht,contextWindow:getContextWindow(this.visualElement)})}stop(_,ut){const mt=this.isDragging;if(this.cancel(),!mt)return;const{velocity:bt}=ut;this.startAnimation(bt);const{onDragEnd:St}=this.getProps();St&&frame.postRender(()=>St(_,ut))}cancel(){this.isDragging=!1;const{projection:_,animationState:ut}=this.visualElement;_&&(_.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:mt}=this.getProps();!mt&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),ut&&ut.setActive("whileDrag",!1)}updateAxis(_,ut,mt){const{drag:bt}=this.getProps();if(!mt||!shouldDrag(_,bt,this.currentDirection))return;const St=this.getAxisMotionValue(_);let Mt=this.originPoint[_]+mt[_];this.constraints&&this.constraints[_]&&(Mt=applyConstraints(Mt,this.constraints[_],this.elastic[_])),St.set(Mt)}resolveConstraints(){var _;const{dragConstraints:ut,dragElastic:mt}=this.getProps(),bt=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(_=this.visualElement.projection)===null||_===void 0?void 0:_.layout,St=this.constraints;ut&&isRefObject(ut)?this.constraints||(this.constraints=this.resolveRefConstraints()):ut&&bt?this.constraints=calcRelativeConstraints(bt.layoutBox,ut):this.constraints=!1,this.elastic=resolveDragElastic(mt),St!==this.constraints&&bt&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(Mt=>{this.constraints!==!1&&this.getAxisMotionValue(Mt)&&(this.constraints[Mt]=rebaseAxisConstraints(bt.layoutBox[Mt],this.constraints[Mt]))})}resolveRefConstraints(){const{dragConstraints:_,onMeasureDragConstraints:ut}=this.getProps();if(!_||!isRefObject(_))return!1;const mt=_.current,{projection:bt}=this.visualElement;if(!bt||!bt.layout)return!1;const St=measurePageBox(mt,bt.root,this.visualElement.getTransformPagePoint());let Mt=calcViewportConstraints(bt.layout.layoutBox,St);if(ut){const Bt=ut(convertBoxToBoundingBox(Mt));this.hasMutatedConstraints=!!Bt,Bt&&(Mt=convertBoundingBoxToBox(Bt))}return Mt}startAnimation(_){const{drag:ut,dragMomentum:mt,dragElastic:bt,dragTransition:St,dragSnapToOrigin:Mt,onDragTransitionEnd:Bt}=this.getProps(),Ut=this.constraints||{},Ht=eachAxis(tr=>{if(!shouldDrag(tr,ut,this.currentDirection))return;let rr=Ut&&Ut[tr]||{};Mt&&(rr={min:0,max:0});const sr=bt?200:1e6,ar=bt?40:1e7,cr={type:"inertia",velocity:mt?_[tr]:0,bounceStiffness:sr,bounceDamping:ar,timeConstant:750,restDelta:1,restSpeed:10,...St,...rr};return this.startAxisValueAnimation(tr,cr)});return Promise.all(Ht).then(Bt)}startAxisValueAnimation(_,ut){const mt=this.getAxisMotionValue(_);return mt.start(animateMotionValue(_,mt,0,ut,this.visualElement))}stopAnimation(){eachAxis(_=>this.getAxisMotionValue(_).stop())}pauseAnimation(){eachAxis(_=>{var ut;return(ut=this.getAxisMotionValue(_).animation)===null||ut===void 0?void 0:ut.pause()})}getAnimationState(_){var ut;return(ut=this.getAxisMotionValue(_).animation)===null||ut===void 0?void 0:ut.state}getAxisMotionValue(_){const ut=`_drag${_.toUpperCase()}`,mt=this.visualElement.getProps(),bt=mt[ut];return bt||this.visualElement.getValue(_,(mt.initial?mt.initial[_]:void 0)||0)}snapToCursor(_){eachAxis(ut=>{const{drag:mt}=this.getProps();if(!shouldDrag(ut,mt,this.currentDirection))return;const{projection:bt}=this.visualElement,St=this.getAxisMotionValue(ut);if(bt&&bt.layout){const{min:Mt,max:Bt}=bt.layout.layoutBox[ut];St.set(_[ut]-mixNumber$1(Mt,Bt,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:_,dragConstraints:ut}=this.getProps(),{projection:mt}=this.visualElement;if(!isRefObject(ut)||!mt||!this.constraints)return;this.stopAnimation();const bt={x:0,y:0};eachAxis(Mt=>{const Bt=this.getAxisMotionValue(Mt);if(Bt&&this.constraints!==!1){const Ut=Bt.get();bt[Mt]=calcOrigin({min:Ut,max:Ut},this.constraints[Mt])}});const{transformTemplate:St}=this.visualElement.getProps();this.visualElement.current.style.transform=St?St({},""):"none",mt.root&&mt.root.updateScroll(),mt.updateLayout(),this.resolveConstraints(),eachAxis(Mt=>{if(!shouldDrag(Mt,_,null))return;const Bt=this.getAxisMotionValue(Mt),{min:Ut,max:Ht}=this.constraints[Mt];Bt.set(mixNumber$1(Ut,Ht,bt[Mt]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const _=this.visualElement.current,ut=addPointerEvent(_,"pointerdown",Ut=>{const{drag:Ht,dragListener:tr=!0}=this.getProps();Ht&&tr&&this.start(Ut)}),mt=()=>{const{dragConstraints:Ut}=this.getProps();isRefObject(Ut)&&(this.constraints=this.resolveRefConstraints())},{projection:bt}=this.visualElement,St=bt.addEventListener("measure",mt);bt&&!bt.layout&&(bt.root&&bt.root.updateScroll(),bt.updateLayout()),mt();const Mt=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),Bt=bt.addEventListener("didUpdate",({delta:Ut,hasLayoutChanged:Ht})=>{this.isDragging&&Ht&&(eachAxis(tr=>{const rr=this.getAxisMotionValue(tr);rr&&(this.originPoint[tr]+=Ut[tr].translate,rr.set(rr.get()+Ut[tr].translate))}),this.visualElement.render())});return()=>{Mt(),ut(),St(),Bt&&Bt()}}getProps(){const _=this.visualElement.getProps(),{drag:ut=!1,dragDirectionLock:mt=!1,dragPropagation:bt=!1,dragConstraints:St=!1,dragElastic:Mt=defaultElastic,dragMomentum:Bt=!0}=_;return{..._,drag:ut,dragDirectionLock:mt,dragPropagation:bt,dragConstraints:St,dragElastic:Mt,dragMomentum:Bt}}}function shouldDrag(rt,_,ut){return(_===!0||_===rt)&&(ut===null||ut===rt)}function getCurrentDirection(rt,_=10){let ut=null;return Math.abs(rt.y)>_?ut="y":Math.abs(rt.x)>_&&(ut="x"),ut}class DragGesture extends Feature{constructor(_){super(_),this.removeGroupControls=noop$1,this.removeListeners=noop$1,this.controls=new VisualElementDragControls(_)}mount(){const{dragControls:_}=this.node.getProps();_&&(this.removeGroupControls=_.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop$1}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=rt=>(_,ut)=>{rt&&frame.postRender(()=>rt(_,ut))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop$1}onPointerDown(_){this.session=new PanSession(_,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:_,onPanStart:ut,onPan:mt,onPanEnd:bt}=this.node.getProps();return{onSessionStart:asyncHandler(_),onStart:asyncHandler(ut),onMove:mt,onEnd:(St,Mt)=>{delete this.session,bt&&frame.postRender(()=>bt(St,Mt))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",_=>this.onPointerDown(_))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function usePresence(){const rt=reactExports.useContext(PresenceContext);if(rt===null)return[!0,null];const{isPresent:_,onExitComplete:ut,register:mt}=rt,bt=reactExports.useId();return reactExports.useEffect(()=>mt(bt),[]),!_&&ut?[!1,()=>ut&&ut(bt)]:[!0]}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(rt,_){return _.max===_.min?0:rt/(_.max-_.min)*100}const correctBorderRadius={correct:(rt,_)=>{if(!_.target)return rt;if(typeof rt=="string")if(px.test(rt))rt=parseFloat(rt);else return rt;const ut=pixelsToPercent(rt,_.target.x),mt=pixelsToPercent(rt,_.target.y);return`${ut}% ${mt}%`}},correctBoxShadow={correct:(rt,{treeScale:_,projectionDelta:ut})=>{const mt=rt,bt=complex.parse(rt);if(bt.length>5)return mt;const St=complex.createTransformer(rt),Mt=typeof bt[0]!="number"?1:0,Bt=ut.x.scale*_.x,Ut=ut.y.scale*_.y;bt[0+Mt]/=Bt,bt[1+Mt]/=Ut;const Ht=mixNumber$1(Bt,Ut,.5);return typeof bt[2+Mt]=="number"&&(bt[2+Mt]/=Ht),typeof bt[3+Mt]=="number"&&(bt[3+Mt]/=Ht),St(bt)}};class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:_,layoutGroup:ut,switchLayoutGroup:mt,layoutId:bt}=this.props,{projection:St}=_;addScaleCorrector(defaultScaleCorrectors),St&&(ut.group&&ut.group.add(St),mt&&mt.register&&bt&&mt.register(St),St.root.didUpdate(),St.addEventListener("animationComplete",()=>{this.safeToRemove()}),St.setOptions({...St.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(_){const{layoutDependency:ut,visualElement:mt,drag:bt,isPresent:St}=this.props,Mt=mt.projection;return Mt&&(Mt.isPresent=St,bt||_.layoutDependency!==ut||ut===void 0?Mt.willUpdate():this.safeToRemove(),_.isPresent!==St&&(St?Mt.promote():Mt.relegate()||frame.postRender(()=>{const Bt=Mt.getStack();(!Bt||!Bt.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:_}=this.props.visualElement;_&&(_.root.didUpdate(),microtask.postRender(()=>{!_.currentAnimation&&_.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:_,layoutGroup:ut,switchLayoutGroup:mt}=this.props,{projection:bt}=_;bt&&(bt.scheduleCheckAfterUnmount(),ut&&ut.group&&ut.group.remove(bt),mt&&mt.deregister&&mt.deregister(bt))}safeToRemove(){const{safeToRemove:_}=this.props;_&&_()}render(){return null}}function MeasureLayout(rt){const[_,ut]=usePresence(),mt=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...rt,layoutGroup:mt,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:_,safeToRemove:ut})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow},borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=rt=>typeof rt=="string"?parseFloat(rt):rt,isPx=rt=>typeof rt=="number"||px.test(rt);function mixValues(rt,_,ut,mt,bt,St){bt?(rt.opacity=mixNumber$1(0,ut.opacity!==void 0?ut.opacity:1,easeCrossfadeIn(mt)),rt.opacityExit=mixNumber$1(_.opacity!==void 0?_.opacity:1,0,easeCrossfadeOut(mt))):St&&(rt.opacity=mixNumber$1(_.opacity!==void 0?_.opacity:1,ut.opacity!==void 0?ut.opacity:1,mt));for(let Mt=0;Mt<numBorders;Mt++){const Bt=`border${borders[Mt]}Radius`;let Ut=getRadius(_,Bt),Ht=getRadius(ut,Bt);if(Ut===void 0&&Ht===void 0)continue;Ut||(Ut=0),Ht||(Ht=0),Ut===0||Ht===0||isPx(Ut)===isPx(Ht)?(rt[Bt]=Math.max(mixNumber$1(asNumber(Ut),asNumber(Ht),mt),0),(percent.test(Ht)||percent.test(Ut))&&(rt[Bt]+="%")):rt[Bt]=Ht}(_.rotate||ut.rotate)&&(rt.rotate=mixNumber$1(_.rotate||0,ut.rotate||0,mt))}function getRadius(rt,_){return rt[_]!==void 0?rt[_]:rt.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop$1);function compress(rt,_,ut){return mt=>mt<rt?0:mt>_?1:ut(progress(rt,_,mt))}function copyAxisInto(rt,_){rt.min=_.min,rt.max=_.max}function copyBoxInto(rt,_){copyAxisInto(rt.x,_.x),copyAxisInto(rt.y,_.y)}function removePointDelta(rt,_,ut,mt,bt){return rt-=_,rt=scalePoint(rt,1/ut,mt),bt!==void 0&&(rt=scalePoint(rt,1/bt,mt)),rt}function removeAxisDelta(rt,_=0,ut=1,mt=.5,bt,St=rt,Mt=rt){if(percent.test(_)&&(_=parseFloat(_),_=mixNumber$1(Mt.min,Mt.max,_/100)-Mt.min),typeof _!="number")return;let Bt=mixNumber$1(St.min,St.max,mt);rt===St&&(Bt-=_),rt.min=removePointDelta(rt.min,_,ut,Bt,bt),rt.max=removePointDelta(rt.max,_,ut,Bt,bt)}function removeAxisTransforms(rt,_,[ut,mt,bt],St,Mt){removeAxisDelta(rt,_[ut],_[mt],_[bt],_.scale,St,Mt)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(rt,_,ut,mt){removeAxisTransforms(rt.x,_,xKeys,ut?ut.x:void 0,mt?mt.x:void 0),removeAxisTransforms(rt.y,_,yKeys,ut?ut.y:void 0,mt?mt.y:void 0)}function isAxisDeltaZero(rt){return rt.translate===0&&rt.scale===1}function isDeltaZero(rt){return isAxisDeltaZero(rt.x)&&isAxisDeltaZero(rt.y)}function boxEquals(rt,_){return rt.x.min===_.x.min&&rt.x.max===_.x.max&&rt.y.min===_.y.min&&rt.y.max===_.y.max}function boxEqualsRounded(rt,_){return Math.round(rt.x.min)===Math.round(_.x.min)&&Math.round(rt.x.max)===Math.round(_.x.max)&&Math.round(rt.y.min)===Math.round(_.y.min)&&Math.round(rt.y.max)===Math.round(_.y.max)}function aspectRatio(rt){return calcLength(rt.x)/calcLength(rt.y)}class NodeStack{constructor(){this.members=[]}add(_){addUniqueItem(this.members,_),_.scheduleRender()}remove(_){if(removeItem(this.members,_),_===this.prevLead&&(this.prevLead=void 0),_===this.lead){const ut=this.members[this.members.length-1];ut&&this.promote(ut)}}relegate(_){const ut=this.members.findIndex(bt=>_===bt);if(ut===0)return!1;let mt;for(let bt=ut;bt>=0;bt--){const St=this.members[bt];if(St.isPresent!==!1){mt=St;break}}return mt?(this.promote(mt),!0):!1}promote(_,ut){const mt=this.lead;if(_!==mt&&(this.prevLead=mt,this.lead=_,_.show(),mt)){mt.instance&&mt.scheduleRender(),_.scheduleRender(),_.resumeFrom=mt,ut&&(_.resumeFrom.preserveOpacity=!0),mt.snapshot&&(_.snapshot=mt.snapshot,_.snapshot.latestValues=mt.animationValues||mt.latestValues),_.root&&_.root.isUpdating&&(_.isLayoutDirty=!0);const{crossfade:bt}=_.options;bt===!1&&mt.hide()}}exitAnimationComplete(){this.members.forEach(_=>{const{options:ut,resumingFrom:mt}=_;ut.onExitComplete&&ut.onExitComplete(),mt&&mt.options.onExitComplete&&mt.options.onExitComplete()})}scheduleRender(){this.members.forEach(_=>{_.instance&&_.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(rt,_,ut){let mt="";const bt=rt.x.translate/_.x,St=rt.y.translate/_.y,Mt=(ut==null?void 0:ut.z)||0;if((bt||St||Mt)&&(mt=`translate3d(${bt}px, ${St}px, ${Mt}px) `),(_.x!==1||_.y!==1)&&(mt+=`scale(${1/_.x}, ${1/_.y}) `),ut){const{transformPerspective:Ht,rotate:tr,rotateX:rr,rotateY:sr,skewX:ar,skewY:cr}=ut;Ht&&(mt=`perspective(${Ht}px) ${mt}`),tr&&(mt+=`rotate(${tr}deg) `),rr&&(mt+=`rotateX(${rr}deg) `),sr&&(mt+=`rotateY(${sr}deg) `),ar&&(mt+=`skewX(${ar}deg) `),cr&&(mt+=`skewY(${cr}deg) `)}const Bt=rt.x.scale*_.x,Ut=rt.y.scale*_.y;return(Bt!==1||Ut!==1)&&(mt+=`scale(${Bt}, ${Ut})`),mt||"none"}const compareByDepth=(rt,_)=>rt.depth-_.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(_){addUniqueItem(this.children,_),this.isDirty=!0}remove(_){removeItem(this.children,_),this.isDirty=!0}forEach(_){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(_)}}function delay(rt,_){const ut=time.now(),mt=({timestamp:bt})=>{const St=bt-ut;St>=_&&(cancelFrame(mt),rt(St-_))};return frame.read(mt,!0),()=>cancelFrame(mt)}function record(rt){window.MotionDebug&&window.MotionDebug.record(rt)}function isSVGElement(rt){return rt instanceof SVGElement&&rt.tagName!=="svg"}function animateSingleValue(rt,_,ut){const mt=isMotionValue(rt)?rt:motionValue(rt);return mt.start(animateMotionValue("",mt,_,ut)),mt.animation}const transformAxes=["","X","Y","Z"],hiddenVisibility={visibility:"hidden"},animationTarget=1e3;let id=0;const projectionFrameData={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function resetDistortingTransform(rt,_,ut,mt){const{latestValues:bt}=_;bt[rt]&&(ut[rt]=bt[rt],_.setStaticValue(rt,0),mt&&(mt[rt]=0))}function createProjectionNode({attachResizeListener:rt,defaultParent:_,measureScroll:ut,checkIsScrollRoot:mt,resetTransform:bt}){return class{constructor(Mt={},Bt=_==null?void 0:_()){this.id=id++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,projectionFrameData.totalNodes=projectionFrameData.resolvedTargetDeltas=projectionFrameData.recalculatedProjection=0,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes),record(projectionFrameData)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=Mt,this.root=Bt?Bt.root||Bt:this,this.path=Bt?[...Bt.path,Bt]:[],this.parent=Bt,this.depth=Bt?Bt.depth+1:0;for(let Ut=0;Ut<this.path.length;Ut++)this.path[Ut].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(Mt,Bt){return this.eventHandlers.has(Mt)||this.eventHandlers.set(Mt,new SubscriptionManager),this.eventHandlers.get(Mt).add(Bt)}notifyListeners(Mt,...Bt){const Ut=this.eventHandlers.get(Mt);Ut&&Ut.notify(...Bt)}hasListeners(Mt){return this.eventHandlers.has(Mt)}mount(Mt,Bt=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=isSVGElement(Mt),this.instance=Mt;const{layoutId:Ut,layout:Ht,visualElement:tr}=this.options;if(tr&&!tr.current&&tr.mount(Mt),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),Bt&&(Ht||Ut)&&(this.isLayoutDirty=!0),rt){let rr;const sr=()=>this.root.updateBlockedByResize=!1;rt(Mt,()=>{this.root.updateBlockedByResize=!0,rr&&rr(),rr=delay(sr,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation))})}Ut&&this.root.registerSharedNode(Ut,this),this.options.animate!==!1&&tr&&(Ut||Ht)&&this.addEventListener("didUpdate",({delta:rr,hasLayoutChanged:sr,hasRelativeTargetChanged:ar,layout:cr})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const Ar=this.options.transition||tr.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:_r,onLayoutAnimationComplete:Dr}=tr.getProps(),$r=!this.targetLayout||!boxEqualsRounded(this.targetLayout,cr)||ar,Br=!sr&&ar;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||Br||sr&&($r||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(rr,Br);const Jr={...getValueTransition$1(Ar,"layout"),onPlay:_r,onComplete:Dr};(tr.shouldReduceMotion||this.options.layoutRoot)&&(Jr.delay=0,Jr.type=!1),this.startAnimation(Jr)}else sr||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=cr})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const Mt=this.getStack();Mt&&Mt.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:Mt}=this.options;return Mt&&Mt.getProps().transformTemplate}willUpdate(Mt=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let tr=0;tr<this.path.length;tr++){const rr=this.path[tr];rr.shouldResetTransform=!0,rr.updateScroll("snapshot"),rr.options.layoutRoot&&rr.willUpdate(!1)}const{layoutId:Bt,layout:Ut}=this.options;if(Bt===void 0&&!Ut)return;const Ht=this.getTransformTemplate();this.prevTransformTemplateValue=Ht?Ht(this.latestValues,""):void 0,this.updateSnapshot(),Mt&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}this.isUpdating||this.nodes.forEach(clearIsLayoutDirty),this.isUpdating=!1,window.HandoffCancelAllAnimations&&window.HandoffCancelAllAnimations(),this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate),this.clearAllSnapshots();const Bt=time.now();frameData.delta=clamp$3(0,1e3/60,Bt-frameData.timestamp),frameData.timestamp=Bt,frameData.isProcessing=!0,steps.update.process(frameData),steps.preRender.process(frameData),steps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let Ut=0;Ut<this.path.length;Ut++)this.path[Ut].updateScroll();const Mt=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:Bt}=this.options;Bt&&Bt.notify("LayoutMeasure",this.layout.layoutBox,Mt?Mt.layoutBox:void 0)}updateScroll(Mt="measure"){let Bt=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===Mt&&(Bt=!1),Bt&&(this.scroll={animationId:this.root.animationId,phase:Mt,isRoot:mt(this.instance),offset:ut(this.instance)})}resetTransform(){if(!bt)return;const Mt=this.isLayoutDirty||this.shouldResetTransform,Bt=this.projectionDelta&&!isDeltaZero(this.projectionDelta),Ut=this.getTransformTemplate(),Ht=Ut?Ut(this.latestValues,""):void 0,tr=Ht!==this.prevTransformTemplateValue;Mt&&(Bt||hasTransform(this.latestValues)||tr)&&(bt(this.instance,Ht),this.shouldResetTransform=!1,this.scheduleRender())}measure(Mt=!0){const Bt=this.measurePageBox();let Ut=this.removeElementScroll(Bt);return Mt&&(Ut=this.removeTransform(Ut)),roundBox(Ut),{animationId:this.root.animationId,measuredBox:Bt,layoutBox:Ut,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:Mt}=this.options;if(!Mt)return createBox();const Bt=Mt.measureViewportBox(),{scroll:Ut}=this.root;return Ut&&(translateAxis(Bt.x,Ut.offset.x),translateAxis(Bt.y,Ut.offset.y)),Bt}removeElementScroll(Mt){const Bt=createBox();copyBoxInto(Bt,Mt);for(let Ut=0;Ut<this.path.length;Ut++){const Ht=this.path[Ut],{scroll:tr,options:rr}=Ht;if(Ht!==this.root&&tr&&rr.layoutScroll){if(tr.isRoot){copyBoxInto(Bt,Mt);const{scroll:sr}=this.root;sr&&(translateAxis(Bt.x,-sr.offset.x),translateAxis(Bt.y,-sr.offset.y))}translateAxis(Bt.x,tr.offset.x),translateAxis(Bt.y,tr.offset.y)}}return Bt}applyTransform(Mt,Bt=!1){const Ut=createBox();copyBoxInto(Ut,Mt);for(let Ht=0;Ht<this.path.length;Ht++){const tr=this.path[Ht];!Bt&&tr.options.layoutScroll&&tr.scroll&&tr!==tr.root&&transformBox(Ut,{x:-tr.scroll.offset.x,y:-tr.scroll.offset.y}),hasTransform(tr.latestValues)&&transformBox(Ut,tr.latestValues)}return hasTransform(this.latestValues)&&transformBox(Ut,this.latestValues),Ut}removeTransform(Mt){const Bt=createBox();copyBoxInto(Bt,Mt);for(let Ut=0;Ut<this.path.length;Ut++){const Ht=this.path[Ut];if(!Ht.instance||!hasTransform(Ht.latestValues))continue;hasScale(Ht.latestValues)&&Ht.updateSnapshot();const tr=createBox(),rr=Ht.measurePageBox();copyBoxInto(tr,rr),removeBoxTransforms(Bt,Ht.latestValues,Ht.snapshot?Ht.snapshot.layoutBox:void 0,tr)}return hasTransform(this.latestValues)&&removeBoxTransforms(Bt,this.latestValues),Bt}setTargetDelta(Mt){this.targetDelta=Mt,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(Mt){this.options={...this.options,...Mt,crossfade:Mt.crossfade!==void 0?Mt.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(Mt=!1){var Bt;const Ut=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=Ut.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=Ut.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=Ut.isSharedProjectionDirty);const Ht=!!this.resumingFrom||this!==Ut;if(!(Mt||Ht&&this.isSharedProjectionDirty||this.isProjectionDirty||!((Bt=this.parent)===null||Bt===void 0)&&Bt.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:rr,layoutId:sr}=this.options;if(!(!this.layout||!(rr||sr))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const ar=this.getClosestProjectingParent();ar&&ar.layout&&this.animationProgress!==1?(this.relativeParent=ar,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,ar.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const ar=this.getClosestProjectingParent();ar&&!!ar.resumingFrom==!!this.resumingFrom&&!ar.options.layoutScroll&&ar.target&&this.animationProgress!==1?(this.relativeParent=ar,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,ar.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}projectionFrameData.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var Mt;const Bt=this.getLead(),Ut=!!this.resumingFrom||this!==Bt;let Ht=!0;if((this.isProjectionDirty||!((Mt=this.parent)===null||Mt===void 0)&&Mt.isProjectionDirty)&&(Ht=!1),Ut&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(Ht=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(Ht=!1),Ht)return;const{layout:tr,layoutId:rr}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(tr||rr))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const sr=this.treeScale.x,ar=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,Ut),Bt.layout&&!Bt.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(Bt.target=Bt.layout.layoutBox,Bt.targetWithTransforms=createBox());const{target:cr}=Bt;if(!cr){this.projectionTransform&&(this.projectionDelta=createDelta(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta());const Ar=this.projectionTransform;calcBoxDelta(this.projectionDelta,this.layoutCorrected,cr,this.latestValues),this.projectionTransform=buildProjectionTransform(this.projectionDelta,this.treeScale),(this.projectionTransform!==Ar||this.treeScale.x!==sr||this.treeScale.y!==ar)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",cr)),projectionFrameData.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(Mt=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),Mt){const Bt=this.getStack();Bt&&Bt.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(Mt,Bt=!1){const Ut=this.snapshot,Ht=Ut?Ut.latestValues:{},tr={...this.latestValues},rr=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!Bt;const sr=createBox(),ar=Ut?Ut.source:void 0,cr=this.layout?this.layout.source:void 0,Ar=ar!==cr,_r=this.getStack(),Dr=!_r||_r.members.length<=1,$r=!!(Ar&&!Dr&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let Br;this.mixTargetDelta=Jr=>{const mn=Jr/1e3;mixAxisDelta(rr.x,Mt.x,mn),mixAxisDelta(rr.y,Mt.y,mn),this.setTargetDelta(rr),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(sr,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,sr,mn),Br&&boxEquals(this.relativeTarget,Br)&&(this.isProjectionDirty=!1),Br||(Br=createBox()),copyBoxInto(Br,this.relativeTarget)),Ar&&(this.animationValues=tr,mixValues(tr,Ht,this.latestValues,mn,$r,Dr)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=mn},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(Mt){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.currentAnimation=animateSingleValue(0,animationTarget,{...Mt,onUpdate:Bt=>{this.mixTargetDelta(Bt),Mt.onUpdate&&Mt.onUpdate(Bt)},onComplete:()=>{Mt.onComplete&&Mt.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const Mt=this.getStack();Mt&&Mt.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const Mt=this.getLead();let{targetWithTransforms:Bt,target:Ut,layout:Ht,latestValues:tr}=Mt;if(!(!Bt||!Ut||!Ht)){if(this!==Mt&&this.layout&&Ht&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,Ht.layoutBox)){Ut=this.target||createBox();const rr=calcLength(this.layout.layoutBox.x);Ut.x.min=Mt.target.x.min,Ut.x.max=Ut.x.min+rr;const sr=calcLength(this.layout.layoutBox.y);Ut.y.min=Mt.target.y.min,Ut.y.max=Ut.y.min+sr}copyBoxInto(Bt,Ut),transformBox(Bt,tr),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,Bt,tr)}}registerSharedNode(Mt,Bt){this.sharedNodes.has(Mt)||this.sharedNodes.set(Mt,new NodeStack),this.sharedNodes.get(Mt).add(Bt);const Ht=Bt.options.initialPromotionConfig;Bt.promote({transition:Ht?Ht.transition:void 0,preserveFollowOpacity:Ht&&Ht.shouldPreserveFollowOpacity?Ht.shouldPreserveFollowOpacity(Bt):void 0})}isLead(){const Mt=this.getStack();return Mt?Mt.lead===this:!0}getLead(){var Mt;const{layoutId:Bt}=this.options;return Bt?((Mt=this.getStack())===null||Mt===void 0?void 0:Mt.lead)||this:this}getPrevLead(){var Mt;const{layoutId:Bt}=this.options;return Bt?(Mt=this.getStack())===null||Mt===void 0?void 0:Mt.prevLead:void 0}getStack(){const{layoutId:Mt}=this.options;if(Mt)return this.root.sharedNodes.get(Mt)}promote({needsReset:Mt,transition:Bt,preserveFollowOpacity:Ut}={}){const Ht=this.getStack();Ht&&Ht.promote(this,Ut),Mt&&(this.projectionDelta=void 0,this.needsReset=!0),Bt&&this.setOptions({transition:Bt})}relegate(){const Mt=this.getStack();return Mt?Mt.relegate(this):!1}resetSkewAndRotation(){const{visualElement:Mt}=this.options;if(!Mt)return;let Bt=!1;const{latestValues:Ut}=Mt;if((Ut.z||Ut.rotate||Ut.rotateX||Ut.rotateY||Ut.rotateZ||Ut.skewX||Ut.skewY)&&(Bt=!0),!Bt)return;const Ht={};Ut.z&&resetDistortingTransform("z",Mt,Ht,this.animationValues);for(let tr=0;tr<transformAxes.length;tr++)resetDistortingTransform(`rotate${transformAxes[tr]}`,Mt,Ht,this.animationValues),resetDistortingTransform(`skew${transformAxes[tr]}`,Mt,Ht,this.animationValues);Mt.render();for(const tr in Ht)Mt.setStaticValue(tr,Ht[tr]),this.animationValues&&(this.animationValues[tr]=Ht[tr]);Mt.scheduleRender()}getProjectionStyles(Mt){var Bt,Ut;if(!this.instance||this.isSVG)return;if(!this.isVisible)return hiddenVisibility;const Ht={visibility:""},tr=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,Ht.opacity="",Ht.pointerEvents=resolveMotionValue(Mt==null?void 0:Mt.pointerEvents)||"",Ht.transform=tr?tr(this.latestValues,""):"none",Ht;const rr=this.getLead();if(!this.projectionDelta||!this.layout||!rr.target){const Ar={};return this.options.layoutId&&(Ar.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,Ar.pointerEvents=resolveMotionValue(Mt==null?void 0:Mt.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(Ar.transform=tr?tr({},""):"none",this.hasProjected=!1),Ar}const sr=rr.animationValues||rr.latestValues;this.applyTransformsToTarget(),Ht.transform=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,sr),tr&&(Ht.transform=tr(sr,Ht.transform));const{x:ar,y:cr}=this.projectionDelta;Ht.transformOrigin=`${ar.origin*100}% ${cr.origin*100}% 0`,rr.animationValues?Ht.opacity=rr===this?(Ut=(Bt=sr.opacity)!==null&&Bt!==void 0?Bt:this.latestValues.opacity)!==null&&Ut!==void 0?Ut:1:this.preserveOpacity?this.latestValues.opacity:sr.opacityExit:Ht.opacity=rr===this?sr.opacity!==void 0?sr.opacity:"":sr.opacityExit!==void 0?sr.opacityExit:0;for(const Ar in scaleCorrectors){if(sr[Ar]===void 0)continue;const{correct:_r,applyTo:Dr}=scaleCorrectors[Ar],$r=Ht.transform==="none"?sr[Ar]:_r(sr[Ar],rr);if(Dr){const Br=Dr.length;for(let Jr=0;Jr<Br;Jr++)Ht[Dr[Jr]]=$r}else Ht[Ar]=$r}return this.options.layoutId&&(Ht.pointerEvents=rr===this?resolveMotionValue(Mt==null?void 0:Mt.pointerEvents)||"":"none"),Ht}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(Mt=>{var Bt;return(Bt=Mt.currentAnimation)===null||Bt===void 0?void 0:Bt.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(rt){rt.updateLayout()}function notifyLayoutUpdate(rt){var _;const ut=((_=rt.resumeFrom)===null||_===void 0?void 0:_.snapshot)||rt.snapshot;if(rt.isLead()&&rt.layout&&ut&&rt.hasListeners("didUpdate")){const{layoutBox:mt,measuredBox:bt}=rt.layout,{animationType:St}=rt.options,Mt=ut.source!==rt.layout.source;St==="size"?eachAxis(rr=>{const sr=Mt?ut.measuredBox[rr]:ut.layoutBox[rr],ar=calcLength(sr);sr.min=mt[rr].min,sr.max=sr.min+ar}):shouldAnimatePositionOnly(St,ut.layoutBox,mt)&&eachAxis(rr=>{const sr=Mt?ut.measuredBox[rr]:ut.layoutBox[rr],ar=calcLength(mt[rr]);sr.max=sr.min+ar,rt.relativeTarget&&!rt.currentAnimation&&(rt.isProjectionDirty=!0,rt.relativeTarget[rr].max=rt.relativeTarget[rr].min+ar)});const Bt=createDelta();calcBoxDelta(Bt,mt,ut.layoutBox);const Ut=createDelta();Mt?calcBoxDelta(Ut,rt.applyTransform(bt,!0),ut.measuredBox):calcBoxDelta(Ut,mt,ut.layoutBox);const Ht=!isDeltaZero(Bt);let tr=!1;if(!rt.resumeFrom){const rr=rt.getClosestProjectingParent();if(rr&&!rr.resumeFrom){const{snapshot:sr,layout:ar}=rr;if(sr&&ar){const cr=createBox();calcRelativePosition(cr,ut.layoutBox,sr.layoutBox);const Ar=createBox();calcRelativePosition(Ar,mt,ar.layoutBox),boxEqualsRounded(cr,Ar)||(tr=!0),rr.options.layoutRoot&&(rt.relativeTarget=Ar,rt.relativeTargetOrigin=cr,rt.relativeParent=rr)}}}rt.notifyListeners("didUpdate",{layout:mt,snapshot:ut,delta:Ut,layoutDelta:Bt,hasLayoutChanged:Ht,hasRelativeTargetChanged:tr})}else if(rt.isLead()){const{onExitComplete:mt}=rt.options;mt&&mt()}rt.options.transition=void 0}function propagateDirtyNodes(rt){projectionFrameData.totalNodes++,rt.parent&&(rt.isProjecting()||(rt.isProjectionDirty=rt.parent.isProjectionDirty),rt.isSharedProjectionDirty||(rt.isSharedProjectionDirty=!!(rt.isProjectionDirty||rt.parent.isProjectionDirty||rt.parent.isSharedProjectionDirty)),rt.isTransformDirty||(rt.isTransformDirty=rt.parent.isTransformDirty))}function cleanDirtyNodes(rt){rt.isProjectionDirty=rt.isSharedProjectionDirty=rt.isTransformDirty=!1}function clearSnapshot(rt){rt.clearSnapshot()}function clearMeasurements(rt){rt.clearMeasurements()}function clearIsLayoutDirty(rt){rt.isLayoutDirty=!1}function resetTransformStyle(rt){const{visualElement:_}=rt.options;_&&_.getProps().onBeforeLayoutMeasure&&_.notify("BeforeLayoutMeasure"),rt.resetTransform()}function finishAnimation(rt){rt.finishAnimation(),rt.targetDelta=rt.relativeTarget=rt.target=void 0,rt.isProjectionDirty=!0}function resolveTargetDelta(rt){rt.resolveTargetDelta()}function calcProjection(rt){rt.calcProjection()}function resetSkewAndRotation(rt){rt.resetSkewAndRotation()}function removeLeadSnapshots(rt){rt.removeLeadSnapshot()}function mixAxisDelta(rt,_,ut){rt.translate=mixNumber$1(_.translate,0,ut),rt.scale=mixNumber$1(_.scale,1,ut),rt.origin=_.origin,rt.originPoint=_.originPoint}function mixAxis(rt,_,ut,mt){rt.min=mixNumber$1(_.min,ut.min,mt),rt.max=mixNumber$1(_.max,ut.max,mt)}function mixBox(rt,_,ut,mt){mixAxis(rt.x,_.x,ut.x,mt),mixAxis(rt.y,_.y,ut.y,mt)}function hasOpacityCrossfade(rt){return rt.animationValues&&rt.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=rt=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(rt),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop$1;function roundAxis(rt){rt.min=roundPoint(rt.min),rt.max=roundPoint(rt.max)}function roundBox(rt){roundAxis(rt.x),roundAxis(rt.y)}function shouldAnimatePositionOnly(rt,_,ut){return rt==="position"||rt==="preserve-aspect"&&!isNear(aspectRatio(_),aspectRatio(ut),.2)}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(rt,_)=>addDomEvent(rt,"resize",_),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:rt=>({x:rt.scrollLeft,y:rt.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const rt=new DocumentProjectionNode({});rt.mount(window),rt.setOptions({layoutScroll:!0}),rootProjectionNode.current=rt}return rootProjectionNode.current},resetTransform:(rt,_)=>{rt.style.transform=_!==void 0?_:"none"},checkIsScrollRoot:rt=>window.getComputedStyle(rt).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}},prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const rt=window.matchMedia("(prefers-reduced-motion)"),_=()=>prefersReducedMotion.current=rt.matches;rt.addListener(_),_()}else prefersReducedMotion.current=!1}function updateMotionValuesFromProps(rt,_,ut){const{willChange:mt}=_;for(const bt in _){const St=_[bt],Mt=ut[bt];if(isMotionValue(St))rt.addValue(bt,St),isWillChangeMotionValue(mt)&&mt.add(bt);else if(isMotionValue(Mt))rt.addValue(bt,motionValue(St,{owner:rt})),isWillChangeMotionValue(mt)&&mt.remove(bt);else if(Mt!==St)if(rt.hasValue(bt)){const Bt=rt.getValue(bt);Bt.liveStyle===!0?Bt.jump(St):Bt.hasAnimated||Bt.set(St)}else{const Bt=rt.getStaticValue(bt);rt.addValue(bt,motionValue(Bt!==void 0?Bt:St,{owner:rt}))}}for(const bt in ut)_[bt]===void 0&&rt.removeValue(bt);return _}const visualElementStore=new WeakMap,valueTypes=[...dimensionValueTypes,color$2,complex],findValueType=rt=>valueTypes.find(testValueType(rt)),featureNames=Object.keys(featureDefinitions),numFeatures=featureNames.length,propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],numVariantProps=variantProps.length;function getClosestProjectingNode(rt){if(rt)return rt.options.allowProjection!==!1?rt.projection:getClosestProjectingNode(rt.parent)}class VisualElement{scrapeMotionValuesFromProps(_,ut,mt){return{}}constructor({parent:_,props:ut,presenceContext:mt,reducedMotionConfig:bt,blockInitialAnimation:St,visualState:Mt},Bt={}){this.resolveKeyframes=(sr,ar,cr,Ar)=>new this.KeyframeResolver(sr,ar,cr,Ar,this),this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>frame.render(this.render,!1,!0);const{latestValues:Ut,renderState:Ht}=Mt;this.latestValues=Ut,this.baseTarget={...Ut},this.initialValues=ut.initial?{...Ut}:{},this.renderState=Ht,this.parent=_,this.props=ut,this.presenceContext=mt,this.depth=_?_.depth+1:0,this.reducedMotionConfig=bt,this.options=Bt,this.blockInitialAnimation=!!St,this.isControllingVariants=isControllingVariants(ut),this.isVariantNode=isVariantNode(ut),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(_&&_.current);const{willChange:tr,...rr}=this.scrapeMotionValuesFromProps(ut,{},this);for(const sr in rr){const ar=rr[sr];Ut[sr]!==void 0&&isMotionValue(ar)&&(ar.set(Ut[sr],!1),isWillChangeMotionValue(tr)&&tr.add(sr))}}mount(_){this.current=_,visualElementStore.set(_,this),this.projection&&!this.projection.instance&&this.projection.mount(_),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((ut,mt)=>this.bindToMotionValue(mt,ut)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){var _;visualElementStore.delete(this.current),this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(ut=>ut()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const ut in this.events)this.events[ut].clear();for(const ut in this.features)(_=this.features[ut])===null||_===void 0||_.unmount();this.current=null}bindToMotionValue(_,ut){const mt=transformProps.has(_),bt=ut.on("change",Mt=>{this.latestValues[_]=Mt,this.props.onUpdate&&frame.preRender(this.notifyUpdate),mt&&this.projection&&(this.projection.isTransformDirty=!0)}),St=ut.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(_,()=>{bt(),St(),ut.owner&&ut.stop()})}sortNodePosition(_){return!this.current||!this.sortInstanceNodePosition||this.type!==_.type?0:this.sortInstanceNodePosition(this.current,_.current)}loadFeatures({children:_,...ut},mt,bt,St){let Mt,Bt;for(let Ut=0;Ut<numFeatures;Ut++){const Ht=featureNames[Ut],{isEnabled:tr,Feature:rr,ProjectionNode:sr,MeasureLayout:ar}=featureDefinitions[Ht];sr&&(Mt=sr),tr(ut)&&(!this.features[Ht]&&rr&&(this.features[Ht]=new rr(this)),ar&&(Bt=ar))}if((this.type==="html"||this.type==="svg")&&!this.projection&&Mt){this.projection=new Mt(this.latestValues,getClosestProjectingNode(this.parent));const{layoutId:Ut,layout:Ht,drag:tr,dragConstraints:rr,layoutScroll:sr,layoutRoot:ar}=ut;this.projection.setOptions({layoutId:Ut,layout:Ht,alwaysMeasureLayout:!!tr||rr&&isRefObject(rr),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof Ht=="string"?Ht:"both",initialPromotionConfig:St,layoutScroll:sr,layoutRoot:ar})}return Bt}updateFeatures(){for(const _ in this.features){const ut=this.features[_];ut.isMounted?ut.update():(ut.mount(),ut.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(_){return this.latestValues[_]}setStaticValue(_,ut){this.latestValues[_]=ut}update(_,ut){(_.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=_,this.prevPresenceContext=this.presenceContext,this.presenceContext=ut;for(let mt=0;mt<propEventHandlers.length;mt++){const bt=propEventHandlers[mt];this.propEventSubscriptions[bt]&&(this.propEventSubscriptions[bt](),delete this.propEventSubscriptions[bt]);const St="on"+bt,Mt=_[St];Mt&&(this.propEventSubscriptions[bt]=this.on(bt,Mt))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(_,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(_){return this.props.variants?this.props.variants[_]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(_=!1){if(_)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const mt=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(mt.initial=this.props.initial),mt}const ut={};for(let mt=0;mt<numVariantProps;mt++){const bt=variantProps[mt],St=this.props[bt];(isVariantLabel(St)||St===!1)&&(ut[bt]=St)}return ut}addVariantChild(_){const ut=this.getClosestVariantNode();if(ut)return ut.variantChildren&&ut.variantChildren.add(_),()=>ut.variantChildren.delete(_)}addValue(_,ut){const mt=this.values.get(_);ut!==mt&&(mt&&this.removeValue(_),this.bindToMotionValue(_,ut),this.values.set(_,ut),this.latestValues[_]=ut.get())}removeValue(_){this.values.delete(_);const ut=this.valueSubscriptions.get(_);ut&&(ut(),this.valueSubscriptions.delete(_)),delete this.latestValues[_],this.removeValueFromRenderState(_,this.renderState)}hasValue(_){return this.values.has(_)}getValue(_,ut){if(this.props.values&&this.props.values[_])return this.props.values[_];let mt=this.values.get(_);return mt===void 0&&ut!==void 0&&(mt=motionValue(ut===null?void 0:ut,{owner:this}),this.addValue(_,mt)),mt}readValue(_,ut){var mt;let bt=this.latestValues[_]!==void 0||!this.current?this.latestValues[_]:(mt=this.getBaseTargetFromProps(this.props,_))!==null&&mt!==void 0?mt:this.readValueFromInstance(this.current,_,this.options);return bt!=null&&(typeof bt=="string"&&(isNumericalString(bt)||isZeroValueString(bt))?bt=parseFloat(bt):!findValueType(bt)&&complex.test(ut)&&(bt=getAnimatableNone(_,ut)),this.setBaseTarget(_,isMotionValue(bt)?bt.get():bt)),isMotionValue(bt)?bt.get():bt}setBaseTarget(_,ut){this.baseTarget[_]=ut}getBaseTarget(_){var ut;const{initial:mt}=this.props;let bt;if(typeof mt=="string"||typeof mt=="object"){const Mt=resolveVariantFromProps(this.props,mt,(ut=this.presenceContext)===null||ut===void 0?void 0:ut.custom);Mt&&(bt=Mt[_])}if(mt&&bt!==void 0)return bt;const St=this.getBaseTargetFromProps(this.props,_);return St!==void 0&&!isMotionValue(St)?St:this.initialValues[_]!==void 0&&bt===void 0?void 0:this.baseTarget[_]}on(_,ut){return this.events[_]||(this.events[_]=new SubscriptionManager),this.events[_].add(ut)}notify(_,...ut){this.events[_]&&this.events[_].notify(...ut)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(_,ut){return _.compareDocumentPosition(ut)&2?1:-1}getBaseTargetFromProps(_,ut){return _.style?_.style[ut]:void 0}removeValueFromRenderState(_,{vars:ut,style:mt}){delete ut[_],delete mt[_]}}function getComputedStyle$2(rt){return window.getComputedStyle(rt)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html"}readValueFromInstance(_,ut){if(transformProps.has(ut)){const mt=getDefaultValueType(ut);return mt&&mt.default||0}else{const mt=getComputedStyle$2(_),bt=(isCSSVariableName(ut)?mt.getPropertyValue(ut):mt[ut])||0;return typeof bt=="string"?bt.trim():bt}}measureInstanceViewportBox(_,{transformPagePoint:ut}){return measureViewportBox(_,ut)}build(_,ut,mt,bt){buildHTMLStyles(_,ut,mt,bt.transformTemplate)}scrapeMotionValuesFromProps(_,ut,mt){return scrapeMotionValuesFromProps$2(_,ut,mt)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:_}=this.props;isMotionValue(_)&&(this.childSubscription=_.on("change",ut=>{this.current&&(this.current.textContent=`${ut}`)}))}renderInstance(_,ut,mt,bt){renderHTML(_,ut,mt,bt)}}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(_,ut){return _[ut]}readValueFromInstance(_,ut){if(transformProps.has(ut)){const mt=getDefaultValueType(ut);return mt&&mt.default||0}return ut=camelCaseAttributes.has(ut)?ut:camelToDash(ut),_.getAttribute(ut)}measureInstanceViewportBox(){return createBox()}scrapeMotionValuesFromProps(_,ut,mt){return scrapeMotionValuesFromProps$1(_,ut,mt)}build(_,ut,mt,bt){buildSVGAttrs(_,ut,mt,this.isSVGTag,bt.transformTemplate)}renderInstance(_,ut,mt,bt){renderSVG(_,ut,mt,bt)}mount(_){this.isSVGTag=isSVGTag(_.tagName),super.mount(_)}}const createDomVisualElement=(rt,_)=>isSVGComponent(rt)?new SVGVisualElement(_,{enableHardwareAcceleration:!1}):new HTMLVisualElement(_,{allowProjection:rt!==reactExports.Fragment,enableHardwareAcceleration:!0}),layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},preloadedFeatures$1={...animations,...gestureAnimations,...drag,...layout},motion$1=createMotionProxy((rt,_)=>createDomMotionConfig(rt,_,preloadedFeatures$1,createDomVisualElement));function MotionConfig({children:rt,isValidProp:_,...ut}){_&&loadExternalIsValidProp(_),ut={...reactExports.useContext(MotionConfigContext),...ut},ut.isStatic=useConstant(()=>ut.isStatic);const mt=reactExports.useMemo(()=>ut,[JSON.stringify(ut.transition),ut.transformPagePoint,ut.reducedMotion]);return jsxRuntimeExports.jsx(MotionConfigContext.Provider,{value:mt,children:rt})}function useMotionValue(rt){const _=useConstant(()=>motionValue(rt)),{isStatic:ut}=reactExports.useContext(MotionConfigContext);if(ut){const[,mt]=reactExports.useState(rt);reactExports.useEffect(()=>_.on("change",mt),[])}return _}function resolveElements(rt,_,ut){var mt;if(typeof rt=="string"){let bt=document;ut?((mt=ut[rt])!==null&&mt!==void 0||(ut[rt]=bt.querySelectorAll(rt)),rt=ut[rt]):rt=bt.querySelectorAll(rt)}else rt instanceof Element&&(rt=[rt]);return Array.from(rt||[])}function observeTimeline(rt,_){let ut;const mt=()=>{const{currentTime:bt}=_,Mt=(bt===null?0:bt.value)/100;ut!==Mt&&rt(Mt),ut=Mt};return frame.update(mt,!0),()=>cancelFrame(mt)}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0);class GroupPlaybackControls{constructor(_){this.animations=_.filter(Boolean)}then(_,ut){return Promise.all(this.animations).then(_).catch(ut)}getAll(_){return this.animations[0][_]}setAll(_,ut){for(let mt=0;mt<this.animations.length;mt++)this.animations[mt][_]=ut}attachTimeline(_){const ut=this.animations.map(mt=>{if(supportsScrollTimeline()&&mt.attachTimeline)mt.attachTimeline(_);else return mt.pause(),observeTimeline(bt=>{mt.time=mt.duration*bt},_)});return()=>{ut.forEach((mt,bt)=>{mt&&mt(),this.animations[bt].stop()})}}get time(){return this.getAll("time")}set time(_){this.setAll("time",_)}get speed(){return this.getAll("speed")}set speed(_){this.setAll("speed",_)}get duration(){let _=0;for(let ut=0;ut<this.animations.length;ut++)_=Math.max(_,this.animations[ut].duration);return _}runAll(_){this.animations.forEach(ut=>ut[_]())}play(){this.runAll("play")}pause(){this.runAll("pause")}stop(){this.runAll("stop")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}function isDOMKeyframes(rt){return typeof rt=="object"&&!Array.isArray(rt)}function createVisualElement$1(rt){const _={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},ut=isSVGElement(rt)?new SVGVisualElement(_,{enableHardwareAcceleration:!1}):new HTMLVisualElement(_,{enableHardwareAcceleration:!0});ut.mount(rt),visualElementStore.set(rt,ut)}function createGeneratorEasing(rt,_=100){const ut=spring({keyframes:[0,_],...rt}),mt=Math.min(calcGeneratorDuration(ut),maxGeneratorDuration);return{type:"keyframes",ease:bt=>ut.next(mt*bt).value/_,duration:millisecondsToSeconds(mt)}}function calcNextTime(rt,_,ut,mt){var bt;return typeof _=="number"?_:_.startsWith("-")||_.startsWith("+")?Math.max(0,rt+parseFloat(_)):_==="<"?ut:(bt=mt.get(_))!==null&&bt!==void 0?bt:rt}const wrap$1=(rt,_,ut)=>{const mt=_-rt;return((ut-rt)%mt+mt)%mt+rt};function getEasingForSegment(rt,_){return isEasingArray(rt)?rt[wrap$1(0,rt.length,_)]:rt}function eraseKeyframes(rt,_,ut){for(let mt=0;mt<rt.length;mt++){const bt=rt[mt];bt.at>_&&bt.at<ut&&(removeItem(rt,bt),mt--)}}function addKeyframes(rt,_,ut,mt,bt,St){eraseKeyframes(rt,bt,St);for(let Mt=0;Mt<_.length;Mt++)rt.push({value:_[Mt],at:mixNumber$1(bt,St,mt[Mt]),easing:getEasingForSegment(ut,Mt)})}function compareByTime(rt,_){return rt.at===_.at?rt.value===null?1:_.value===null?-1:0:rt.at-_.at}const defaultSegmentEasing="easeInOut";function createAnimationsFromSequence(rt,{defaultTransition:_={},...ut}={},mt){const bt=_.duration||.3,St=new Map,Mt=new Map,Bt={},Ut=new Map;let Ht=0,tr=0,rr=0;for(let sr=0;sr<rt.length;sr++){const ar=rt[sr];if(typeof ar=="string"){Ut.set(ar,tr);continue}else if(!Array.isArray(ar)){Ut.set(ar.name,calcNextTime(tr,ar.at,Ht,Ut));continue}let[cr,Ar,_r={}]=ar;_r.at!==void 0&&(tr=calcNextTime(tr,_r.at,Ht,Ut));let Dr=0;const $r=(Br,Jr,mn,Mn=0,$n=0)=>{const en=keyframesAsList(Br),{delay:In=0,times:Rn=defaultOffset(en),type:qn="keyframes",...Qn}=Jr;let{ease:xs=_.ease||"easeOut",duration:cs}=Jr;const ks=typeof In=="function"?In(Mn,$n):In,_o=en.length;if(_o<=2&&qn==="spring"){let Ao=100;if(_o===2&&isNumberKeyframesArray(en)){const uu=en[1]-en[0];Ao=Math.abs(uu)}const Oo={...Qn};cs!==void 0&&(Oo.duration=secondsToMilliseconds(cs));const uo=createGeneratorEasing(Oo,Ao);xs=uo.ease,cs=uo.duration}cs??(cs=bt);const qs=tr+ks,Ss=qs+cs;Rn.length===1&&Rn[0]===0&&(Rn[1]=1);const eo=Rn.length-en.length;eo>0&&fillOffset(Rn,eo),en.length===1&&en.unshift(null),addKeyframes(mn,en,xs,Rn,qs,Ss),Dr=Math.max(ks+cs,Dr),rr=Math.max(Ss,rr)};if(isMotionValue(cr)){const Br=getSubjectSequence(cr,Mt);$r(Ar,_r,getValueSequence("default",Br))}else{const Br=resolveElements(cr,mt,Bt),Jr=Br.length;for(let mn=0;mn<Jr;mn++){Ar=Ar,_r=_r;const Mn=Br[mn],$n=getSubjectSequence(Mn,Mt);for(const en in Ar)$r(Ar[en],getValueTransition(_r,en),getValueSequence(en,$n),mn,Jr)}}Ht=tr,tr+=Dr}return Mt.forEach((sr,ar)=>{for(const cr in sr){const Ar=sr[cr];Ar.sort(compareByTime);const _r=[],Dr=[],$r=[];for(let Jr=0;Jr<Ar.length;Jr++){const{at:mn,value:Mn,easing:$n}=Ar[Jr];_r.push(Mn),Dr.push(progress(0,rr,mn)),$r.push($n||"easeOut")}Dr[0]!==0&&(Dr.unshift(0),_r.unshift(_r[0]),$r.unshift(defaultSegmentEasing)),Dr[Dr.length-1]!==1&&(Dr.push(1),_r.push(null)),St.has(ar)||St.set(ar,{keyframes:{},transition:{}});const Br=St.get(ar);Br.keyframes[cr]=_r,Br.transition[cr]={..._,duration:rr,ease:$r,times:Dr,...ut}}}),St}function getSubjectSequence(rt,_){return!_.has(rt)&&_.set(rt,{}),_.get(rt)}function getValueSequence(rt,_){return _[rt]||(_[rt]=[]),_[rt]}function keyframesAsList(rt){return Array.isArray(rt)?rt:[rt]}function getValueTransition(rt,_){return rt[_]?{...rt,...rt[_]}:{...rt}}const isNumber=rt=>typeof rt=="number",isNumberKeyframesArray=rt=>rt.every(isNumber);function animateElements(rt,_,ut,mt){const bt=resolveElements(rt),St=bt.length,Mt=[];for(let Bt=0;Bt<St;Bt++){const Ut=bt[Bt];visualElementStore.has(Ut)||createVisualElement$1(Ut);const Ht=visualElementStore.get(Ut),tr={...ut};typeof tr.delay=="function"&&(tr.delay=tr.delay(Bt,St)),Mt.push(...animateTarget(Ht,{..._,transition:tr},{}))}return new GroupPlaybackControls(Mt)}const isSequence=rt=>Array.isArray(rt)&&Array.isArray(rt[0]);function animateSequence(rt,_,ut){const mt=[];return createAnimationsFromSequence(rt,_,ut).forEach(({keyframes:St,transition:Mt},Bt)=>{let Ut;isMotionValue(Bt)?Ut=animateSingleValue(Bt,St.default,Mt.default):Ut=animateElements(Bt,St,Mt),mt.push(Ut)}),new GroupPlaybackControls(mt)}const createScopedAnimate=rt=>{function _(ut,mt,bt){let St;return isSequence(ut)?St=animateSequence(ut,mt,rt):isDOMKeyframes(mt)?St=animateElements(ut,mt,bt):St=animateSingleValue(ut,mt,bt),St}return _},animate=createScopedAnimate();function useHover(rt,{whileHover:_,onHoverStart:ut,onHoverEnd:mt,onPointerOver:bt,onPointerOut:St},Mt){return rt||!Mt||!(_||ut||mt)?{}:{onPointerOver:Ut=>{var Ht;(Ht=Mt.animationState)===null||Ht===void 0||Ht.setActive("whileHover",!0),bt&&bt(Ut)},onPointerOut:Ut=>{var Ht;(Ht=Mt.animationState)===null||Ht===void 0||Ht.setActive("whileHover",!1),St&&St(Ut)}}}function useTap(rt,{whileTap:_,onTapStart:ut,onTap:mt,onTapCancel:bt,onPointerDown:St},Mt){const Bt=mt||ut||bt||_,Ut=reactExports.useRef(!1),Ht=reactExports.useRef(null);if(rt||!Mt||!Bt)return{};function tr(){var cr;(cr=Ht.current)===null||cr===void 0||cr.call(Ht),Ht.current=null}function rr(){var cr;return tr(),Ut.current=!1,(cr=Mt.animationState)===null||cr===void 0||cr.setActive("whileTap",!1),!isDragActive()}function sr(cr,Ar){rr()&&(mt==null||mt(cr,Ar))}function ar(cr,Ar){rr()&&(bt==null||bt(cr,Ar))}return{onPointerDown:addPointerInfo((cr,Ar)=>{var _r;if(tr(),Ut.current)return;Ut.current=!0;const Dr={passive:!(ut||mt||bt||St)};Ht.current=pipe$1(addPointerEvent(window,"pointerup",sr,Dr),addPointerEvent(window,"pointercancel",ar,Dr)),(_r=Mt.animationState)===null||_r===void 0||_r.setActive("whileTap",!0),St==null||St(cr),ut==null||ut(cr,Ar)})}}const useRender=(rt,_,ut,mt,bt,St)=>{const Mt=useVisualProps(_);return reactExports.createElement(rt,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({ref:ut},filterProps(_,!1,!1)),Mt),{onUpdate:_.onInstanceUpdate}),useHover(bt,_,St)),useTap(bt,_,St)))};function useVisualProps(rt){return reactExports.useMemo(()=>{const _={};for(const ut in rt){const mt=rt[ut];isMotionValue(mt)?_[ut]=mt.get():Array.isArray(mt)&&mt.includes(isMotionValue)&&(_[ut]=mt.map(resolveMotionValue))}return _},[])}const setVector=(rt,_)=>ut=>(mt,bt)=>{mt[rt]===void 0&&(mt[rt]=new Vector3(_)),mt[rt].setComponent(ut,bt)},setEuler=(rt,_)=>ut=>(mt,bt)=>{mt[rt]===void 0&&(mt[rt]=new Euler(_));const St=mt[rt];St[ut]=bt},setColor=rt=>(_,ut)=>{_[rt]===void 0&&(_[rt]=new Color$1(ut)),_[rt].set(ut)},setScale=setVector("scale",1),setPosition=setVector("position",0),setRotation=setEuler("rotation",0),setters={x:setPosition(0),y:setPosition(1),z:setPosition(2),scale:(rt,_)=>{rt.scale===void 0&&(rt.scale=new Vector3(1)),rt.scale.set(_,_,_)},scaleX:setScale(0),scaleY:setScale(1),scaleZ:setScale(2),rotateX:setRotation("x"),rotateY:setRotation("y"),rotateZ:setRotation("z"),color:setColor("color"),specular:setColor("specular")};function setThreeValue(rt,_,ut){_ in setters?setters[_](rt,ut[_]):(_==="opacity"&&!rt.transparent&&(rt.transparent=!0),rt[_]=ut[_])}const readVector=(rt,_)=>ut=>mt=>{const bt=mt[rt];return bt?bt[ut]:_},readPosition=readVector("position",0),readScale=readVector("scale",1),readRotation=readVector("rotation",0),readers={x:readPosition("x"),y:readPosition("y"),z:readPosition("z"),scale:readScale("x"),scaleX:readScale("x"),scaleY:readScale("y"),scaleZ:readScale("z"),rotateX:readRotation("x"),rotateY:readRotation("y"),rotateZ:readRotation("z")};function readAnimatableValue(rt){if(rt!==void 0)return rt instanceof Color$1?rt.getStyle():rt}function readThreeValue(rt,_){return _ in readers?readers[_](rt):readAnimatableValue(rt[_])||0}const axes=["x","y","z"],valueMap={"position-x":"x","position-y":"y","position-z":"z","rotation-x":"rotateX","rotation-y":"rotateY","rotation-z":"rotateZ","scale-x":"scaleX","scale-y":"scaleY","scale-z":"scaleZ"},scrapeMotionValuesFromProps=(rt,_)=>{const ut={};let mt;for(mt in rt){const bt=rt[mt];if(isMotionValue(bt)||isMotionValue(_[mt])){const St=valueMap[mt]||mt;ut[St]=bt}else if(Array.isArray(bt))for(let St=0;St<bt.length;St++){const Mt=bt[St],Bt=_[mt],Ut=Array.isArray(Bt)?Bt[St]:void 0;if(isMotionValue(Mt)||Ut!==void 0&&isMotionValue(Ut)){const Ht=valueMap[`${mt}-${axes[St]}`];ut[Ht]=Mt}}}return ut},createRenderState=()=>({});class ThreeVisualElement extends VisualElement{constructor(){super(...arguments),this.type="three"}readValueFromInstance(_,ut){return readThreeValue(_,ut)}getBaseTargetFromProps(){}sortInstanceNodePosition(_,ut){return _.id-ut.id}removeValueFromRenderState(){}measureInstanceViewportBox(){return createBox()}scrapeMotionValuesFromProps(_,ut){return scrapeMotionValuesFromProps(_,ut)}build(_,ut){for(const mt in ut)_[mt]=ut[mt]}renderInstance(_,ut){for(const mt in ut)setThreeValue(_,mt,ut)}}const createVisualElement=(rt,_)=>new ThreeVisualElement(_,{}),useVisualState=makeUseVisualState({scrapeMotionValuesFromProps,createRenderState}),preloadedFeatures=Object.assign({},animations);function custom(rt){return createMotionComponent({Component:rt,preloadedFeatures,useRender,useVisualState,createVisualElement})}const componentCache=new Map,motion=new Proxy(custom,{get:(rt,_)=>(!componentCache.has(_)&&componentCache.set(_,custom(_)),componentCache.get(_))});function __awaiter(rt,_,ut,mt){function bt(St){return St instanceof ut?St:new ut(function(Mt){Mt(St)})}return new(ut||(ut=Promise))(function(St,Mt){function Bt(tr){try{Ht(mt.next(tr))}catch(rr){Mt(rr)}}function Ut(tr){try{Ht(mt.throw(tr))}catch(rr){Mt(rr)}}function Ht(tr){tr.done?St(tr.value):bt(tr.value).then(Bt,Ut)}Ht((mt=mt.apply(rt,_||[])).next())})}function __generator(rt,_){var ut={label:0,sent:function(){if(St[0]&1)throw St[1];return St[1]},trys:[],ops:[]},mt,bt,St,Mt;return Mt={next:Bt(0),throw:Bt(1),return:Bt(2)},typeof Symbol=="function"&&(Mt[Symbol.iterator]=function(){return this}),Mt;function Bt(Ht){return function(tr){return Ut([Ht,tr])}}function Ut(Ht){if(mt)throw new TypeError("Generator is already executing.");for(;Mt&&(Mt=0,Ht[0]&&(ut=0)),ut;)try{if(mt=1,bt&&(St=Ht[0]&2?bt.return:Ht[0]?bt.throw||((St=bt.return)&&St.call(bt),0):bt.next)&&!(St=St.call(bt,Ht[1])).done)return St;switch(bt=0,St&&(Ht=[Ht[0]&2,St.value]),Ht[0]){case 0:case 1:St=Ht;break;case 4:return ut.label++,{value:Ht[1],done:!1};case 5:ut.label++,bt=Ht[1],Ht=[0];continue;case 7:Ht=ut.ops.pop(),ut.trys.pop();continue;default:if(St=ut.trys,!(St=St.length>0&&St[St.length-1])&&(Ht[0]===6||Ht[0]===2)){ut=0;continue}if(Ht[0]===3&&(!St||Ht[1]>St[0]&&Ht[1]<St[3])){ut.label=Ht[1];break}if(Ht[0]===6&&ut.label<St[1]){ut.label=St[1],St=Ht;break}if(St&&ut.label<St[2]){ut.label=St[2],ut.ops.push(Ht);break}St[2]&&ut.ops.pop(),ut.trys.pop();continue}Ht=_.call(rt,ut)}catch(tr){Ht=[6,tr],bt=0}finally{mt=St=0}if(Ht[0]&5)throw Ht[1];return{value:Ht[0]?Ht[1]:void 0,done:!0}}}function __read(rt,_){var ut=typeof Symbol=="function"&&rt[Symbol.iterator];if(!ut)return rt;var mt=ut.call(rt),bt,St=[],Mt;try{for(;(_===void 0||_-- >0)&&!(bt=mt.next()).done;)St.push(bt.value)}catch(Bt){Mt={error:Bt}}finally{try{bt&&!bt.done&&(ut=mt.return)&&ut.call(mt)}finally{if(Mt)throw Mt.error}}return St}function __spread(){for(var rt=[],_=0;_<arguments.length;_++)rt=rt.concat(__read(arguments[_]));return rt}typeof SuppressedError=="function"&&SuppressedError;const projects=[{title:"One",url:"https://www.bilibili.com/video/BV1mJ4m1G7T1?spm_id_from=333.1007.tianma.2-2-4.click",image:"/threeDCharacter/image/020.png",description:"which is a bilibili video"},{title:"Two",url:"https://www.bilibili.com/video/BV1mJ4m1G7T1?spm_id_from=333.1007.tianma.2-2-4.click",image:"/threeDCharacter/image/021.png",description:"which is a bilibili video"},{title:"Three",url:"https://www.bilibili.com/video/BV1mJ4m1G7T1?spm_id_from=333.1007.tianma.2-2-4.click",image:"/threeDCharacter/image/008.png",description:"which is a bilibili video"},{title:"Four",url:"https://www.bilibili.com/video/BV1mJ4m1G7T1?spm_id_from=333.1007.tianma.2-2-4.click",image:"/threeDCharacter/image/045.png",description:"which is a bilibili video"},{title:"Five",url:"https://www.bilibili.com/video/BV1mJ4m1G7T1?spm_id_from=333.1007.tianma.2-2-4.click",image:"/threeDCharacter/image/068.png",description:"which is a bilibili video"}],Project=rt=>{const{project:_,hightlighted:ut}=rt,mt=reactExports.useRef(null),bt=useMotionValue(.4);return reactExports.useEffect(()=>{animate(bt,ut?1:.4,{duration:.5})},[ut]),useFrame(()=>{mt.current&&(mt.current.material.opacity=bt.get())}),jsxRuntimeExports.jsxs("group",{...rt,"position-y":.6,children:[jsxRuntimeExports.jsxs("mesh",{onClick:()=>window.open(_.url,"_blank"),"position-z":-.001,"position-y":-1,ref:mt,children:[jsxRuntimeExports.jsx("planeGeometry",{attach:"geometry",args:[.9,.9]}),jsxRuntimeExports.jsx("meshBasicMaterial",{attach:"material",color:"black",transparent:!0,opacity:.4})]}),jsxRuntimeExports.jsx(Image$1,{scale:[.6,.5],url:_.image,toneMapped:!1,"position-y":-.9}),jsxRuntimeExports.jsx(Text,{maxWidth:.85,anchorX:"left",anchorY:"top",fontSize:.1,position:[0-.32,-1.18,0],children:_.title.toUpperCase()}),jsxRuntimeExports.jsx(Text,{maxWidth:.85,anchorX:"left",anchorY:"top",fontSize:.06,position:[0-.32,-1.32,0],children:_.description})]})},currentProjectAtom=atom(Math.floor(projects.length/2)),Projects=()=>{const[rt]=useAtom(currentProjectAtom),{viewport:_}=useThree();return jsxRuntimeExports.jsx("group",{"position-y":-_.height*2+1,children:projects.map((ut,mt)=>jsxRuntimeExports.jsx(motion.group,{animate:{x:0+(mt-rt)*1,y:rt===mt?.08:.1,z:rt===mt?.03:-.05,rotateX:rt===mt?-Math.PI/8:Math.PI/900,rotateZ:rt===mt?0:-Math.PI/60},children:jsxRuntimeExports.jsx(Project,{project:ut,hightlighted:mt===rt})},"project_"+mt))})},Section=rt=>{const{children:_}=rt;return jsxRuntimeExports.jsx(motion$1.section,{className:"h-screen w-screen p-8 max-w-screen-2xl mx-auto flex flex-col items-start justify-center",children:_})},Interface=()=>jsxRuntimeExports.jsx("div",{className:"flex flex-col items-center w-screen",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(HomeSection,{}),jsxRuntimeExports.jsx(SkillsSection,{}),jsxRuntimeExports.jsx(ProjectSection,{}),jsxRuntimeExports.jsx(ContactMeSection,{})]})}),HomeSection=()=>jsxRuntimeExports.jsxs(Section,{children:[jsxRuntimeExports.jsxs("h1",{className:"text-6xl font-extrabold leading-snug font-Nunito",children:["Hi, I' m",jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("span",{className:"bg-white px-1 italic font-Nunito",children:"Loop_Shen"})]}),jsxRuntimeExports.jsxs(motion$1.p,{className:"text-lg font-tilt text-gray-600 mt-4",initial:{opacity:0,y:15},whileInView:{opacity:1,y:0},transition:{duration:1},children:["I watch YouTube video to boost my mind",jsxRuntimeExports.jsx("br",{}),"upgrating development Skills"]}),jsxRuntimeExports.jsx(motion$1.button,{className:"bg-indigo-600 text-white py-4 px-8 round-lg font-bold text-lg mt-16 font-tilt",initial:{opacity:0,y:15},whileInView:{opacity:1,y:0},transition:{duration:1,delay:2},children:"Contact me"})]}),SkillsSection=()=>{const rt=[{title:"TypeScript ",level:30},{title:"Treejs / React Three Fiber",level:50},{title:"3d Modeling",level:20},{title:"AI Prompt Engineer",level:20},{title:"SD-WebUI / ComfyUI",level:20}],_=[{title:"🇭🇰 Cantonese",level:80},{title:"🇨🇳 Chinese",level:90},{title:"🇺🇸 English",level:80}];return jsxRuntimeExports.jsx(Section,{children:jsxRuntimeExports.jsxs(motion$1.div,{whileInView:"visible",children:[jsxRuntimeExports.jsx("h2",{className:"text-5xl font-bold font-Nunito",children:"Skills "}),jsxRuntimeExports.jsx("div",{className:"mt-8 space-y-4",children:rt.map((ut,mt)=>jsxRuntimeExports.jsxs("div",{className:"w-64",children:[jsxRuntimeExports.jsx(motion$1.h3,{className:"text-xl font-bold text-gray-800",initial:{opacity:0},variants:{visible:{opacity:1,transition:{duration:1,delay:1+mt*.2}}},children:ut.title}),jsxRuntimeExports.jsx("div",{className:"h-2 w-full bg-gray-200 rounded-full mt-2",children:jsxRuntimeExports.jsx(motion$1.div,{className:"h-full bg-indigo-500 rounded-full",style:{width:`${ut.level}%`},initial:{scaleX:0,originX:0},variants:{visible:{scaleX:1,transition:{duration:1,delay:1+mt*.2}}}})})]},mt))}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("br",{}),jsxRuntimeExports.jsx("h2",{className:"text-5xl font-bold font-Nunito",children:"Languges "}),jsxRuntimeExports.jsx("div",{className:"mt-8 space-y-4",children:_.map((ut,mt)=>jsxRuntimeExports.jsxs("div",{className:"w-64",children:[jsxRuntimeExports.jsx(motion$1.h3,{className:"text-xl font-bold text-gray-800",initial:{opacity:0},variants:{visible:{opacity:1,transition:{duration:1,delay:1+mt*.2}}},children:ut.title}),jsxRuntimeExports.jsx("div",{className:"h-2 w-full bg-gray-200 rounded-full mt-2",children:jsxRuntimeExports.jsx(motion$1.div,{className:"h-full bg-indigo-500 rounded-full",style:{width:`${ut.level}%`},initial:{scaleX:0,originX:0},variants:{visible:{scaleX:1,transition:{duration:1,delay:2+mt*.2}}}})})]},mt))})]})})},ContactMeSection=()=>jsxRuntimeExports.jsxs(Section,{children:[jsxRuntimeExports.jsx("h2",{className:"text-5xl font-bold font-Nunito",children:"Contact me"}),jsxRuntimeExports.jsx("div",{className:"mt-8 p-8 rounded-md bg-white w-96 max-w-full font-Nunito",children:jsxRuntimeExports.jsxs("form",{children:[jsxRuntimeExports.jsx("label",{htmlFor:"name",className:"font-medium text-gray-900 block mb-1",children:"Name"}),jsxRuntimeExports.jsx("input",{type:"text",name:"name",id:"name",className:"block w-full rounded-md border-0 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 p-3"}),jsxRuntimeExports.jsx("label",{htmlFor:"email",className:"font-medium text-gray-900 block mb-1 mt-8",children:"Email"}),jsxRuntimeExports.jsx("input",{type:"email",name:"email",id:"email",className:"block w-full rounded-md border-0 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 p-3"}),jsxRuntimeExports.jsx("label",{htmlFor:"email",className:"font-medium text-gray-900 block mb-1 mt-8",children:"Message"}),jsxRuntimeExports.jsx("textarea",{name:"message",id:"message",className:"h-32 block w-full rounded-md border-0 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 p-3"}),jsxRuntimeExports.jsx("button",{className:"bg-indigo-600 text-white py-4 px-8 rounded-lg font-bold text-lg mt-16 ",children:"Submit"})]})})]}),ProjectSection=()=>{const[rt,_]=useAtom(currentProjectAtom),ut=()=>{_((rt+1)%projects.length)},mt=()=>{_((rt-1+projects.length)%projects.length)};return jsxRuntimeExports.jsx(Section,{children:jsxRuntimeExports.jsxs("div",{className:"flex w-full h-full gap-8 items-center justify-center ",children:[jsxRuntimeExports.jsx("button",{className:"hover:text-indigo-600 transition-colors font-Nunito ",onClick:mt,children:"⬅️ Previous"}),jsxRuntimeExports.jsx("h2",{className:"text-5xl font-bold font-Nunito ",children:"Projects"}),jsxRuntimeExports.jsx("button",{className:"hover:text-indigo-600 transition-colors font-Nunito ",onClick:ut,children:"Next ➡️"})]})})};function RoomScene(rt){const _=useTexture("/threeDCharacter/scenes/roomScene.png");_.flipY=!1;const ut=new MeshStandardMaterial({map:_}),{nodes:mt}=useGLTF("/threeDCharacter/scenes/roomScene.gltf"),{section:bt}=rt,St=reactExports.useRef(null);return jsxRuntimeExports.jsxs("group",{...rt,ref:St,dispose:null,scale:1.15,rotation:[0,Math.PI/2,0],children:[jsxRuntimeExports.jsxs(motion.group,{scale:[0,0,0],animate:{scale:bt===0?1:0},name:"RootNode",position:[-.812,0,1.105],children:[jsxRuntimeExports.jsx("mesh",{name:"Cube",geometry:mt.Cube.geometry,material:ut,rotation:[-Math.PI/2,0,0]}),jsxRuntimeExports.jsx("mesh",{name:"Icosphere003",geometry:mt.Icosphere003.geometry,material:ut,position:[.044,.696,-.077],rotation:[-Math.PI/2,0,0]})]}),jsxRuntimeExports.jsxs("group",{name:"Empty",position:[-.977,.536,-.151],children:[jsxRuntimeExports.jsx(motion.mesh,{scale:[0,0,0],animate:{scale:bt===0?1:0},name:"Cube001",geometry:mt.Cube001.geometry,material:ut,position:[1.72,-.536,-.067]}),jsxRuntimeExports.jsxs(motion.group,{scale:[0,0,0],animate:{scale:bt===0?1:0},name:"Cube004",position:[.169,-.21,.042],children:[jsxRuntimeExports.jsx("mesh",{name:"Cube004-Mesh",geometry:mt["Cube004-Mesh"].geometry,material:ut}),jsxRuntimeExports.jsx("mesh",{name:"Cube004-Mesh_1",geometry:mt["Cube004-Mesh_1"].geometry,material:ut}),jsxRuntimeExports.jsx("mesh",{name:"Cube004-Mesh_2",geometry:mt["Cube004-Mesh_2"].geometry,material:ut})]}),jsxRuntimeExports.jsxs(motion.group,{scale:[0,0,0],animate:{scale:bt===0?1:0},name:"Cube006",position:[.426+.55-.3,-.323,.332-.15],children:[jsxRuntimeExports.jsx("mesh",{name:"Cube006-Mesh",geometry:mt["Cube006-Mesh"].geometry,material:ut}),jsxRuntimeExports.jsx("mesh",{name:"Cube006-Mesh_1",geometry:mt["Cube006-Mesh_1"].geometry,material:ut})]}),jsxRuntimeExports.jsxs(motion.group,{scale:[0,0,0],animate:{scale:bt===0?1:0},name:"Cylinder",position:[.081,.008,.202],children:[jsxRuntimeExports.jsx("mesh",{name:"Cylinder-Mesh",geometry:mt["Cylinder-Mesh"].geometry,material:ut}),jsxRuntimeExports.jsx("mesh",{name:"Cylinder-Mesh_1",geometry:mt["Cylinder-Mesh_1"].geometry,material:ut}),jsxRuntimeExports.jsx("mesh",{name:"Cylinder-Mesh_2",geometry:mt["Cylinder-Mesh_2"].geometry,material:ut})]}),jsxRuntimeExports.jsx(motion.mesh,{scale:[0,0,0],animate:{scale:bt===0?1:0},name:"Cylinder001",geometry:mt.Cylinder001.geometry,material:ut,position:[-.158,.004,-.23]}),jsxRuntimeExports.jsxs(motion.group,{animate:{scale:bt===0?1.2:0},name:"Laptop_Cube010",position:[-.171+.2,.067,.142],children:[jsxRuntimeExports.jsx("mesh",{name:"Laptop_Cube010-Mesh",geometry:mt["Laptop_Cube010-Mesh"].geometry,material:ut}),jsxRuntimeExports.jsx("mesh",{name:"Laptop_Cube010-Mesh_1",geometry:mt["Laptop_Cube010-Mesh_1"].geometry,material:ut}),jsxRuntimeExports.jsx("mesh",{name:"Laptop_Cube010-Mesh_2",geometry:mt["Laptop_Cube010-Mesh_2"].geometry,material:ut})]})]}),jsxRuntimeExports.jsx(motion.mesh,{scale:[0,0,0],animate:{scale:bt===0?1:0},name:"rubber_duck_toy001",geometry:mt.rubber_duck_toy001.geometry,material:ut,position:[-.935,-.005,-1.005],rotation:[-Math.PI,.708,-Math.PI]}),jsxRuntimeExports.jsxs(motion.group,{scale:[0,0,0],animate:{scale:bt===0?1:0},children:[jsxRuntimeExports.jsx("mesh",{name:"Plane-Mesh",geometry:mt["Plane-Mesh"].geometry,material:ut}),jsxRuntimeExports.jsx("mesh",{name:"Plane-Mesh_1",geometry:mt["Plane-Mesh_1"].geometry,material:ut})]})]})}useGLTF.preload("/threeDCharacter/scenes/roomScene.gltf");function $6ed0406888f73fc4$var$setRef(rt,_){typeof rt=="function"?rt(_):rt!=null&&(rt.current=_)}function $6ed0406888f73fc4$export$43e446d32b3d21af(...rt){return _=>rt.forEach(ut=>$6ed0406888f73fc4$var$setRef(ut,_))}function $6ed0406888f73fc4$export$c7b2cbe3552a0d05(...rt){return reactExports.useCallback($6ed0406888f73fc4$export$43e446d32b3d21af(...rt),rt)}const $5e63c961fc1ce211$export$8c6ed5c666ac1360=reactExports.forwardRef((rt,_)=>{const{children:ut,...mt}=rt,bt=reactExports.Children.toArray(ut),St=bt.find($5e63c961fc1ce211$var$isSlottable);if(St){const Mt=St.props.children,Bt=bt.map(Ut=>Ut===St?reactExports.Children.count(Mt)>1?reactExports.Children.only(null):reactExports.isValidElement(Mt)?Mt.props.children:null:Ut);return reactExports.createElement($5e63c961fc1ce211$var$SlotClone,_extends$4({},mt,{ref:_}),reactExports.isValidElement(Mt)?reactExports.cloneElement(Mt,void 0,Bt):null)}return reactExports.createElement($5e63c961fc1ce211$var$SlotClone,_extends$4({},mt,{ref:_}),ut)});$5e63c961fc1ce211$export$8c6ed5c666ac1360.displayName="Slot";const $5e63c961fc1ce211$var$SlotClone=reactExports.forwardRef((rt,_)=>{const{children:ut,...mt}=rt;return reactExports.isValidElement(ut)?reactExports.cloneElement(ut,{...$5e63c961fc1ce211$var$mergeProps(mt,ut.props),ref:_?$6ed0406888f73fc4$export$43e446d32b3d21af(_,ut.ref):ut.ref}):reactExports.Children.count(ut)>1?reactExports.Children.only(null):null});$5e63c961fc1ce211$var$SlotClone.displayName="SlotClone";const $5e63c961fc1ce211$export$d9f1ccf0bdb05d45=({children:rt})=>reactExports.createElement(reactExports.Fragment,null,rt);function $5e63c961fc1ce211$var$isSlottable(rt){return reactExports.isValidElement(rt)&&rt.type===$5e63c961fc1ce211$export$d9f1ccf0bdb05d45}function $5e63c961fc1ce211$var$mergeProps(rt,_){const ut={..._};for(const mt in _){const bt=rt[mt],St=_[mt];/^on[A-Z]/.test(mt)?bt&&St?ut[mt]=(...Bt)=>{St(...Bt),bt(...Bt)}:bt&&(ut[mt]=bt):mt==="style"?ut[mt]={...bt,...St}:mt==="className"&&(ut[mt]=[bt,St].filter(Boolean).join(" "))}return{...rt,...ut}}const $8927f6f2acc4f386$var$NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],$8927f6f2acc4f386$export$250ffa63cdc0d034=$8927f6f2acc4f386$var$NODES.reduce((rt,_)=>{const ut=reactExports.forwardRef((mt,bt)=>{const{asChild:St,...Mt}=mt,Bt=St?$5e63c961fc1ce211$export$8c6ed5c666ac1360:_;return reactExports.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),reactExports.createElement(Bt,_extends$4({},Mt,{ref:bt}))});return ut.displayName=`Primitive.${_}`,{...rt,[_]:ut}},{});function $8927f6f2acc4f386$export$6d1a0317bde7de7f(rt,_){rt&&reactDomExports.flushSync(()=>rt.dispatchEvent(_))}const $f1701beae083dbae$export$602eac185826482c=reactExports.forwardRef((rt,_)=>{var ut;const{container:mt=globalThis==null||(ut=globalThis.document)===null||ut===void 0?void 0:ut.body,...bt}=rt;return mt?ReactDOM.createPortal(reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$4({},bt,{ref:_})),mt):null}),$f1701beae083dbae$export$be92b6f5f03c0fe9=$f1701beae083dbae$export$602eac185826482c;var has=Object.prototype.hasOwnProperty;function dequal(rt,_){var ut,mt;if(rt===_)return!0;if(rt&&_&&(ut=rt.constructor)===_.constructor){if(ut===Date)return rt.getTime()===_.getTime();if(ut===RegExp)return rt.toString()===_.toString();if(ut===Array){if((mt=rt.length)===_.length)for(;mt--&&dequal(rt[mt],_[mt]););return mt===-1}if(!ut||typeof rt=="object"){mt=0;for(ut in rt)if(has.call(rt,ut)&&++mt&&!has.call(_,ut)||!(ut in _)||!dequal(rt[ut],_[ut]))return!1;return Object.keys(_).length===mt}}return rt!==rt&&_!==_}var Rule=function rt(_,ut,mt,bt){this.name=_,this.fn=ut,this.args=mt,this.modifiers=bt};Rule.prototype._test=function rt(_){var ut=this.fn;try{testAux(this.modifiers.slice(),ut,this)(_)}catch{ut=function(){return!1}}try{return testAux(this.modifiers.slice(),ut,this)(_)}catch{return!1}};Rule.prototype._check=function rt(_){try{testAux(this.modifiers.slice(),this.fn,this)(_)}catch{if(testAux(this.modifiers.slice(),function(mt){return mt},this)(!1))return}if(!testAux(this.modifiers.slice(),this.fn,this)(_))throw null};Rule.prototype._testAsync=function rt(_){var ut=this;return new Promise(function(mt,bt){testAsyncAux(ut.modifiers.slice(),ut.fn,ut)(_).then(function(St){St?mt(_):bt(null)}).catch(function(St){return bt(St)})})};function pickFn(rt,_){return _===void 0&&(_="simple"),typeof rt=="object"?rt[_]:rt}function testAux(rt,_,ut){if(rt.length){var mt=rt.shift(),bt=testAux(rt,_,ut);return mt.perform(bt,ut)}else return pickFn(_)}function testAsyncAux(rt,_,ut){if(rt.length){var mt=rt.shift(),bt=testAsyncAux(rt,_,ut);return mt.performAsync(bt,ut)}else return function(St){return Promise.resolve(pickFn(_,"async")(St))}}var Modifier=function rt(_,ut,mt){this.name=_,this.perform=ut,this.performAsync=mt},ValidationError=function(rt){function _(ut,mt,bt,St){for(var Mt=[],Bt=arguments.length-4;Bt-- >0;)Mt[Bt]=arguments[Bt+4];rt.call(this,Mt),rt.captureStackTrace&&rt.captureStackTrace(this,_),this.rule=ut,this.value=mt,this.cause=bt,this.target=St}return rt&&(_.__proto__=rt),_.prototype=Object.create(rt&&rt.prototype),_.prototype.constructor=_,_}(Error),Context$1=function rt(_,ut){_===void 0&&(_=[]),ut===void 0&&(ut=[]),this.chain=_,this.nextRuleModifiers=ut};Context$1.prototype._applyRule=function rt(_,ut){var mt=this;return function(){for(var bt=[],St=arguments.length;St--;)bt[St]=arguments[St];return mt.chain.push(new Rule(ut,_.apply(mt,bt),bt,mt.nextRuleModifiers)),mt.nextRuleModifiers=[],mt}};Context$1.prototype._applyModifier=function rt(_,ut){return this.nextRuleModifiers.push(new Modifier(ut,_.simple,_.async)),this};Context$1.prototype._clone=function rt(){return new Context$1(this.chain.slice(),this.nextRuleModifiers.slice())};Context$1.prototype.test=function rt(_){return this.chain.every(function(ut){return ut._test(_)})};Context$1.prototype.testAll=function rt(_){var ut=[];return this.chain.forEach(function(mt){try{mt._check(_)}catch(bt){ut.push(new ValidationError(mt,_,bt))}}),ut};Context$1.prototype.check=function rt(_){this.chain.forEach(function(ut){try{ut._check(_)}catch(mt){throw new ValidationError(ut,_,mt)}})};Context$1.prototype.testAsync=function rt(_){var ut=this;return new Promise(function(mt,bt){executeAsyncRules(_,ut.chain.slice(),mt,bt)})};function executeAsyncRules(rt,_,ut,mt){if(_.length){var bt=_.shift();bt._testAsync(rt).then(function(){executeAsyncRules(rt,_,ut,mt)},function(St){mt(new ValidationError(bt,rt,St))})}else ut(rt)}var consideredEmpty=function(rt,_){return _&&typeof rt=="string"&&rt.trim().length===0?!0:rt==null};function optional(rt,_){return _===void 0&&(_=!1),{simple:function(ut){return consideredEmpty(ut,_)||rt.check(ut)===void 0},async:function(ut){return consideredEmpty(ut,_)||rt.testAsync(ut)}}}function v8n(){return typeof Proxy<"u"?proxyContext(new Context$1):proxylessContext(new Context$1)}var customRules={};v8n.extend=function(rt){Object.assign(customRules,rt)};v8n.clearCustomRules=function(){customRules={}};function proxyContext(rt){return new Proxy(rt,{get:function(ut,mt){if(mt in ut)return ut[mt];var bt=proxyContext(rt._clone());if(mt in availableModifiers)return bt._applyModifier(availableModifiers[mt],mt);if(mt in customRules)return bt._applyRule(customRules[mt],mt);if(mt in availableRules)return bt._applyRule(availableRules[mt],mt)}})}function proxylessContext(rt){var _=function(bt,St){return Object.keys(bt).forEach(function(Mt){St[Mt]=function(){for(var Bt=[],Ut=arguments.length;Ut--;)Bt[Ut]=arguments[Ut];var Ht=proxylessContext(St._clone()),tr=Ht._applyRule(bt[Mt],Mt).apply(void 0,Bt);return tr}}),St},ut=_(availableRules,rt),mt=_(customRules,ut);return Object.keys(availableModifiers).forEach(function(bt){Object.defineProperty(mt,bt,{get:function(){var St=proxylessContext(mt._clone());return St._applyModifier(availableModifiers[bt],bt)}})}),mt}var availableModifiers={not:{simple:function(rt){return function(_){return!rt(_)}},async:function(rt){return function(_){return Promise.resolve(rt(_)).then(function(ut){return!ut}).catch(function(){return!0})}}},some:{simple:function(rt){return function(_){return split$1(_).some(function(ut){try{return rt(ut)}catch{return!1}})}},async:function(rt){return function(_){return Promise.all(split$1(_).map(function(ut){try{return rt(ut).catch(function(){return!1})}catch{return!1}})).then(function(ut){return ut.some(Boolean)})}}},every:{simple:function(rt){return function(_){return _!==!1&&split$1(_).every(rt)}},async:function(rt){return function(_){return Promise.all(split$1(_).map(rt)).then(function(ut){return ut.every(Boolean)})}}},strict:{simple:function(rt,_){return function(ut){return isSchemaRule(_)&&ut&&typeof ut=="object"?Object.keys(_.args[0]).length===Object.keys(ut).length&&rt(ut):rt(ut)}},async:function(rt,_){return function(ut){return Promise.resolve(rt(ut)).then(function(mt){return isSchemaRule(_)&&ut&&typeof ut=="object"?Object.keys(_.args[0]).length===Object.keys(ut).length&&mt:mt}).catch(function(){return!1})}}}};function isSchemaRule(rt){return rt&&rt.name==="schema"&&rt.args.length>0&&typeof rt.args[0]=="object"}function split$1(rt){return typeof rt=="string"?rt.split(""):rt}var availableRules={equal:function(rt){return function(_){return _==rt}},exact:function(rt){return function(_){return _===rt}},number:function(rt){return rt===void 0&&(rt=!0),function(_){return typeof _=="number"&&(rt||isFinite(_))}},integer:function(){return function(rt){var _=Number.isInteger||isIntegerPolyfill;return _(rt)}},numeric:function(){return function(rt){return!isNaN(parseFloat(rt))&&isFinite(rt)}},string:function(){return testType("string")},boolean:function(){return testType("boolean")},undefined:function(){return testType("undefined")},null:function(){return testType("null")},array:function(){return testType("array")},object:function(){return testType("object")},instanceOf:function(rt){return function(_){return _ instanceof rt}},pattern:function(rt){return function(_){return rt.test(_)}},lowercase:function(){return function(rt){return typeof rt=="boolean"||rt===rt.toLowerCase()&&rt.trim()!==""}},uppercase:function(){return function(rt){return rt===rt.toUpperCase()&&rt.trim()!==""}},vowel:function(){return function(rt){return/^[aeiou]+$/i.test(rt)}},consonant:function(){return function(rt){return/^(?=[^aeiou])([a-z]+)$/i.test(rt)}},first:function(rt){return function(_){return _[0]==rt}},last:function(rt){return function(_){return _[_.length-1]==rt}},empty:function(){return function(rt){return rt.length===0}},length:function(rt,_){return function(ut){return ut.length>=rt&&ut.length<=(_||rt)}},minLength:function(rt){return function(_){return _.length>=rt}},maxLength:function(rt){return function(_){return _.length<=rt}},negative:function(){return function(rt){return rt<0}},positive:function(){return function(rt){return rt>=0}},between:function(rt,_){return function(ut){return ut>=rt&&ut<=_}},range:function(rt,_){return function(ut){return ut>=rt&&ut<=_}},lessThan:function(rt){return function(_){return _<rt}},lessThanOrEqual:function(rt){return function(_){return _<=rt}},greaterThan:function(rt){return function(_){return _>rt}},greaterThanOrEqual:function(rt){return function(_){return _>=rt}},even:function(){return function(rt){return rt%2===0}},odd:function(){return function(rt){return rt%2!==0}},includes:function(rt){return function(_){return~_.indexOf(rt)}},schema:function(rt){return testSchema(rt)},passesAnyOf:function(){for(var rt=[],_=arguments.length;_--;)rt[_]=arguments[_];return function(ut){return rt.some(function(mt){return mt.test(ut)})}},optional};function testType(rt){return function(_){return Array.isArray(_)&&rt==="array"||_===null&&rt==="null"||typeof _===rt}}function isIntegerPolyfill(rt){return typeof rt=="number"&&isFinite(rt)&&Math.floor(rt)===rt}function testSchema(rt){return{simple:function(_){var ut=[];if(Object.keys(rt).forEach(function(mt){var bt=rt[mt];try{bt.check((_||{})[mt])}catch(St){St.target=mt,ut.push(St)}}),ut.length>0)throw ut;return!0},async:function(_){var ut=[],mt=Object.keys(rt).map(function(bt){var St=rt[bt];return St.testAsync((_||{})[bt]).catch(function(Mt){Mt.target=bt,ut.push(Mt)})});return Promise.all(mt).then(function(){if(ut.length>0)throw ut;return!0})}}}var e$1="colors",t$1="sizes",r$1="space",n$1={gap:r$1,gridGap:r$1,columnGap:r$1,gridColumnGap:r$1,rowGap:r$1,gridRowGap:r$1,inset:r$1,insetBlock:r$1,insetBlockEnd:r$1,insetBlockStart:r$1,insetInline:r$1,insetInlineEnd:r$1,insetInlineStart:r$1,margin:r$1,marginTop:r$1,marginRight:r$1,marginBottom:r$1,marginLeft:r$1,marginBlock:r$1,marginBlockEnd:r$1,marginBlockStart:r$1,marginInline:r$1,marginInlineEnd:r$1,marginInlineStart:r$1,padding:r$1,paddingTop:r$1,paddingRight:r$1,paddingBottom:r$1,paddingLeft:r$1,paddingBlock:r$1,paddingBlockEnd:r$1,paddingBlockStart:r$1,paddingInline:r$1,paddingInlineEnd:r$1,paddingInlineStart:r$1,top:r$1,right:r$1,bottom:r$1,left:r$1,scrollMargin:r$1,scrollMarginTop:r$1,scrollMarginRight:r$1,scrollMarginBottom:r$1,scrollMarginLeft:r$1,scrollMarginX:r$1,scrollMarginY:r$1,scrollMarginBlock:r$1,scrollMarginBlockEnd:r$1,scrollMarginBlockStart:r$1,scrollMarginInline:r$1,scrollMarginInlineEnd:r$1,scrollMarginInlineStart:r$1,scrollPadding:r$1,scrollPaddingTop:r$1,scrollPaddingRight:r$1,scrollPaddingBottom:r$1,scrollPaddingLeft:r$1,scrollPaddingX:r$1,scrollPaddingY:r$1,scrollPaddingBlock:r$1,scrollPaddingBlockEnd:r$1,scrollPaddingBlockStart:r$1,scrollPaddingInline:r$1,scrollPaddingInlineEnd:r$1,scrollPaddingInlineStart:r$1,fontSize:"fontSizes",background:e$1,backgroundColor:e$1,backgroundImage:e$1,borderImage:e$1,border:e$1,borderBlock:e$1,borderBlockEnd:e$1,borderBlockStart:e$1,borderBottom:e$1,borderBottomColor:e$1,borderColor:e$1,borderInline:e$1,borderInlineEnd:e$1,borderInlineStart:e$1,borderLeft:e$1,borderLeftColor:e$1,borderRight:e$1,borderRightColor:e$1,borderTop:e$1,borderTopColor:e$1,caretColor:e$1,color:e$1,columnRuleColor:e$1,fill:e$1,outline:e$1,outlineColor:e$1,stroke:e$1,textDecorationColor:e$1,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:t$1,minBlockSize:t$1,maxBlockSize:t$1,inlineSize:t$1,minInlineSize:t$1,maxInlineSize:t$1,width:t$1,minWidth:t$1,maxWidth:t$1,height:t$1,minHeight:t$1,maxHeight:t$1,flexBasis:t$1,gridTemplateColumns:t$1,gridTemplateRows:t$1,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},i$3=(rt,_)=>typeof _=="function"?{"()":Function.prototype.toString.call(_)}:_,o$1=()=>{const rt=Object.create(null);return(_,ut,...mt)=>{const bt=(St=>JSON.stringify(St,i$3))(_);return bt in rt?rt[bt]:rt[bt]=ut(_,...mt)}},l$1=Symbol.for("sxs.internal"),s$2=(rt,_)=>Object.defineProperties(rt,Object.getOwnPropertyDescriptors(_)),a$1=rt=>{for(const _ in rt)return!0;return!1},{hasOwnProperty:c$2}=Object.prototype,d$2=rt=>rt.includes("-")?rt:rt.replace(/[A-Z]/g,_=>"-"+_.toLowerCase()),g$2=/\s+(?![^()]*\))/,p$2=rt=>_=>rt(...typeof _=="string"?String(_).split(g$2):[_]),u$2={appearance:rt=>({WebkitAppearance:rt,appearance:rt}),backfaceVisibility:rt=>({WebkitBackfaceVisibility:rt,backfaceVisibility:rt}),backdropFilter:rt=>({WebkitBackdropFilter:rt,backdropFilter:rt}),backgroundClip:rt=>({WebkitBackgroundClip:rt,backgroundClip:rt}),boxDecorationBreak:rt=>({WebkitBoxDecorationBreak:rt,boxDecorationBreak:rt}),clipPath:rt=>({WebkitClipPath:rt,clipPath:rt}),content:rt=>({content:rt.includes('"')||rt.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(rt)?rt:`"${rt}"`}),hyphens:rt=>({WebkitHyphens:rt,hyphens:rt}),maskImage:rt=>({WebkitMaskImage:rt,maskImage:rt}),maskSize:rt=>({WebkitMaskSize:rt,maskSize:rt}),tabSize:rt=>({MozTabSize:rt,tabSize:rt}),textSizeAdjust:rt=>({WebkitTextSizeAdjust:rt,textSizeAdjust:rt}),userSelect:rt=>({WebkitUserSelect:rt,userSelect:rt}),marginBlock:p$2((rt,_)=>({marginBlockStart:rt,marginBlockEnd:_||rt})),marginInline:p$2((rt,_)=>({marginInlineStart:rt,marginInlineEnd:_||rt})),maxSize:p$2((rt,_)=>({maxBlockSize:rt,maxInlineSize:_||rt})),minSize:p$2((rt,_)=>({minBlockSize:rt,minInlineSize:_||rt})),paddingBlock:p$2((rt,_)=>({paddingBlockStart:rt,paddingBlockEnd:_||rt})),paddingInline:p$2((rt,_)=>({paddingInlineStart:rt,paddingInlineEnd:_||rt}))},h$2=/([\d.]+)([^]*)/,f$2=(rt,_)=>rt.length?rt.reduce((ut,mt)=>(ut.push(..._.map(bt=>bt.includes("&")?bt.replace(/&/g,/[ +>|~]/.test(mt)&&/&.*&/.test(bt)?`:is(${mt})`:mt):mt+" "+bt)),ut),[]):_,m$2=(rt,_)=>rt in b$2&&typeof _=="string"?_.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(ut,mt,bt,St)=>mt+(bt==="stretch"?`-moz-available${St};${d$2(rt)}:${mt}-webkit-fill-available`:`-moz-fit-content${St};${d$2(rt)}:${mt}fit-content`)+St):String(_),b$2={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},S$2=rt=>rt?rt+"-":"",k$2=(rt,_,ut)=>rt.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(mt,bt,St,Mt,Bt)=>Mt=="$"==!!St?mt:(bt||Mt=="--"?"calc(":"")+"var(--"+(Mt==="$"?S$2(_)+(Bt.includes("$")?"":S$2(ut))+Bt.replace(/\$/g,"-"):Bt)+")"+(bt||Mt=="--"?"*"+(bt||"")+(St||"1")+")":"")),y$2=/\s*,\s*(?![^()]*\))/,B=Object.prototype.toString,$$2=(rt,_,ut,mt,bt)=>{let St,Mt,Bt;const Ut=(Ht,tr,rr)=>{let sr,ar;const cr=Ar=>{for(sr in Ar){const $r=sr.charCodeAt(0)===64,Br=$r&&Array.isArray(Ar[sr])?Ar[sr]:[Ar[sr]];for(ar of Br){const Jr=/[A-Z]/.test(Dr=sr)?Dr:Dr.replace(/-[^]/g,Mn=>Mn[1].toUpperCase()),mn=typeof ar=="object"&&ar&&ar.toString===B&&(!mt.utils[Jr]||!tr.length);if(Jr in mt.utils&&!mn){const Mn=mt.utils[Jr];if(Mn!==Mt){Mt=Mn,cr(Mn(ar)),Mt=null;continue}}else if(Jr in u$2){const Mn=u$2[Jr];if(Mn!==Bt){Bt=Mn,cr(Mn(ar)),Bt=null;continue}}if($r&&(_r=sr.slice(1)in mt.media?"@media "+mt.media[sr.slice(1)]:sr,sr=_r.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(Mn,$n,en,In,Rn,qn)=>{const Qn=h$2.test($n),xs=.0625*(Qn?-1:1),[cs,ks]=Qn?[In,$n]:[$n,In];return"("+(en[0]==="="?"":en[0]===">"===Qn?"max-":"min-")+cs+":"+(en[0]!=="="&&en.length===1?ks.replace(h$2,(_o,qs,Ss)=>Number(qs)+xs*(en===">"?1:-1)+Ss):ks)+(Rn?") and ("+(Rn[0]===">"?"min-":"max-")+cs+":"+(Rn.length===1?qn.replace(h$2,(_o,qs,Ss)=>Number(qs)+xs*(Rn===">"?-1:1)+Ss):qn):"")+")"})),mn){const Mn=$r?rr.concat(sr):[...rr],$n=$r?[...tr]:f$2(tr,sr.split(y$2));St!==void 0&&bt(x$1(...St)),St=void 0,Ut(ar,$n,Mn)}else St===void 0&&(St=[[],tr,rr]),sr=$r||sr.charCodeAt(0)!==36?sr:`--${S$2(mt.prefix)}${sr.slice(1).replace(/\$/g,"-")}`,ar=mn?ar:typeof ar=="number"?ar&&Jr in I$2?String(ar)+"px":String(ar):k$2(m$2(Jr,ar??""),mt.prefix,mt.themeMap[Jr]),St[0].push(`${$r?`${sr} `:`${d$2(sr)}:`}${ar}`)}}var _r,Dr};cr(Ht),St!==void 0&&bt(x$1(...St)),St=void 0};Ut(rt,_,ut)},x$1=(rt,_,ut)=>`${ut.map(mt=>`${mt}{`).join("")}${_.length?`${_.join(",")}{`:""}${rt.join(";")}${_.length?"}":""}${Array(ut.length?ut.length+1:0).join("}")}`,I$2={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},R=rt=>String.fromCharCode(rt+(rt>25?39:97)),z=rt=>(_=>{let ut,mt="";for(ut=Math.abs(_);ut>52;ut=ut/52|0)mt=R(ut%52)+mt;return R(ut%52)+mt})(((_,ut)=>{let mt=ut.length;for(;mt;)_=33*_^ut.charCodeAt(--mt);return _})(5381,JSON.stringify(rt))>>>0),W=["themed","global","styled","onevar","resonevar","allvar","inline"],j$1=rt=>{if(rt.href&&!rt.href.startsWith(location.origin))return!1;try{return!!rt.cssRules}catch{return!1}},E=rt=>{let _;const ut=()=>{const{cssRules:bt}=_.sheet;return[].map.call(bt,(St,Mt)=>{const{cssText:Bt}=St;let Ut="";if(Bt.startsWith("--sxs"))return"";if(bt[Mt-1]&&(Ut=bt[Mt-1].cssText).startsWith("--sxs")){if(!St.cssRules.length)return"";for(const Ht in _.rules)if(_.rules[Ht].group===St)return`--sxs{--sxs:${[..._.rules[Ht].cache].join(" ")}}${Bt}`;return St.cssRules.length?`${Ut}${Bt}`:""}return Bt}).join("")},mt=()=>{if(_){const{rules:Bt,sheet:Ut}=_;if(!Ut.deleteRule){for(;Object(Object(Ut.cssRules)[0]).type===3;)Ut.cssRules.splice(0,1);Ut.cssRules=[]}for(const Ht in Bt)delete Bt[Ht]}const bt=Object(rt).styleSheets||[];for(const Bt of bt)if(j$1(Bt)){for(let Ut=0,Ht=Bt.cssRules;Ht[Ut];++Ut){const tr=Object(Ht[Ut]);if(tr.type!==1)continue;const rr=Object(Ht[Ut+1]);if(rr.type!==4)continue;++Ut;const{cssText:sr}=tr;if(!sr.startsWith("--sxs"))continue;const ar=sr.slice(14,-3).trim().split(/\s+/),cr=W[ar[0]];cr&&(_||(_={sheet:Bt,reset:mt,rules:{},toString:ut}),_.rules[cr]={group:rr,index:Ut,cache:new Set(ar)})}if(_)break}if(!_){const Bt=(Ut,Ht)=>({type:Ht,cssRules:[],insertRule(tr,rr){this.cssRules.splice(rr,0,Bt(tr,{import:3,undefined:1}[(tr.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return Ut==="@media{}"?`@media{${[].map.call(this.cssRules,tr=>tr.cssText).join("")}}`:Ut}});_={sheet:rt?(rt.head||rt).appendChild(document.createElement("style")).sheet:Bt("","text/css"),rules:{},reset:mt,toString:ut}}const{sheet:St,rules:Mt}=_;for(let Bt=W.length-1;Bt>=0;--Bt){const Ut=W[Bt];if(!Mt[Ut]){const Ht=W[Bt+1],tr=Mt[Ht]?Mt[Ht].index:St.cssRules.length;St.insertRule("@media{}",tr),St.insertRule(`--sxs{--sxs:${Bt}}`,tr),Mt[Ut]={group:St.cssRules[tr+1],index:tr,cache:new Set([Bt])}}v$2(Mt[Ut])}};return mt(),_},v$2=rt=>{const _=rt.group;let ut=_.cssRules.length;rt.apply=mt=>{try{_.insertRule(mt,ut),++ut}catch{}}},T$1=Symbol(),w$1=o$1(),M$1=(rt,_)=>w$1(rt,()=>(...ut)=>{let mt={type:null,composers:new Set};for(const bt of ut)if(bt!=null)if(bt[l$1]){mt.type==null&&(mt.type=bt[l$1].type);for(const St of bt[l$1].composers)mt.composers.add(St)}else bt.constructor!==Object||bt.$$typeof?mt.type==null&&(mt.type=bt):mt.composers.add(C(bt,rt));return mt.type==null&&(mt.type="span"),mt.composers.size||mt.composers.add(["PJLV",{},[],[],{},[]]),P(rt,mt,_)}),C=({variants:rt,compoundVariants:_,defaultVariants:ut,...mt},bt)=>{const St=`${S$2(bt.prefix)}c-${z(mt)}`,Mt=[],Bt=[],Ut=Object.create(null),Ht=[];for(const sr in ut)Ut[sr]=String(ut[sr]);if(typeof rt=="object"&&rt)for(const sr in rt){tr=Ut,rr=sr,c$2.call(tr,rr)||(Ut[sr]="undefined");const ar=rt[sr];for(const cr in ar){const Ar={[sr]:String(cr)};String(cr)==="undefined"&&Ht.push(sr);const _r=ar[cr],Dr=[Ar,_r,!a$1(_r)];Mt.push(Dr)}}var tr,rr;if(typeof _=="object"&&_)for(const sr of _){let{css:ar,...cr}=sr;ar=typeof ar=="object"&&ar||{};for(const _r in cr)cr[_r]=String(cr[_r]);const Ar=[cr,ar,!a$1(ar)];Bt.push(Ar)}return[St,mt,Mt,Bt,Ut,Ht]},P=(rt,_,ut)=>{const[mt,bt,St,Mt]=L$1(_.composers),Bt=typeof _.type=="function"||_.type.$$typeof?(rr=>{function sr(){for(let ar=0;ar<sr[T$1].length;ar++){const[cr,Ar]=sr[T$1][ar];rr.rules[cr].apply(Ar)}return sr[T$1]=[],null}return sr[T$1]=[],sr.rules={},W.forEach(ar=>sr.rules[ar]={apply:cr=>sr[T$1].push([ar,cr])}),sr})(ut):null,Ut=(Bt||ut).rules,Ht=`.${mt}${bt.length>1?`:where(.${bt.slice(1).join(".")})`:""}`,tr=rr=>{rr=typeof rr=="object"&&rr||A;const{css:sr,...ar}=rr,cr={};for(const Dr in St)if(delete ar[Dr],Dr in rr){let $r=rr[Dr];typeof $r=="object"&&$r?cr[Dr]={"@initial":St[Dr],...$r}:($r=String($r),cr[Dr]=$r!=="undefined"||Mt.has(Dr)?$r:St[Dr])}else cr[Dr]=St[Dr];const Ar=new Set([...bt]);for(const[Dr,$r,Br,Jr]of _.composers){ut.rules.styled.cache.has(Dr)||(ut.rules.styled.cache.add(Dr),$$2($r,[`.${Dr}`],[],rt,$n=>{Ut.styled.apply($n)}));const mn=O(Br,cr,rt.media),Mn=O(Jr,cr,rt.media,!0);for(const $n of mn)if($n!==void 0)for(const[en,In,Rn]of $n){const qn=`${Dr}-${z(In)}-${en}`;Ar.add(qn);const Qn=(Rn?ut.rules.resonevar:ut.rules.onevar).cache,xs=Rn?Ut.resonevar:Ut.onevar;Qn.has(qn)||(Qn.add(qn),$$2(In,[`.${qn}`],[],rt,cs=>{xs.apply(cs)}))}for(const $n of Mn)if($n!==void 0)for(const[en,In]of $n){const Rn=`${Dr}-${z(In)}-${en}`;Ar.add(Rn),ut.rules.allvar.cache.has(Rn)||(ut.rules.allvar.cache.add(Rn),$$2(In,[`.${Rn}`],[],rt,qn=>{Ut.allvar.apply(qn)}))}}if(typeof sr=="object"&&sr){const Dr=`${mt}-i${z(sr)}-css`;Ar.add(Dr),ut.rules.inline.cache.has(Dr)||(ut.rules.inline.cache.add(Dr),$$2(sr,[`.${Dr}`],[],rt,$r=>{Ut.inline.apply($r)}))}for(const Dr of String(rr.className||"").trim().split(/\s+/))Dr&&Ar.add(Dr);const _r=ar.className=[...Ar].join(" ");return{type:_.type,className:_r,selector:Ht,props:ar,toString:()=>_r,deferredInjector:Bt}};return s$2(tr,{className:mt,selector:Ht,[l$1]:_,toString:()=>(ut.rules.styled.cache.has(mt)||tr(),mt)})},L$1=rt=>{let _="";const ut=[],mt={},bt=[];for(const[St,,,,Mt,Bt]of rt){_===""&&(_=St),ut.push(St),bt.push(...Bt);for(const Ut in Mt){const Ht=Mt[Ut];(mt[Ut]===void 0||Ht!=="undefined"||Bt.includes(Ht))&&(mt[Ut]=Ht)}}return[_,ut,mt,new Set(bt)]},O=(rt,_,ut,mt)=>{const bt=[];e:for(let[St,Mt,Bt]of rt){if(Bt)continue;let Ut,Ht=0,tr=!1;for(Ut in St){const rr=St[Ut];let sr=_[Ut];if(sr!==rr){if(typeof sr!="object"||!sr)continue e;{let ar,cr,Ar=0;for(const _r in sr){if(rr===String(sr[_r])){if(_r!=="@initial"){const Dr=_r.slice(1);(cr=cr||[]).push(Dr in ut?ut[Dr]:_r.replace(/^@media ?/,"")),tr=!0}Ht+=Ar,ar=!0}++Ar}if(cr&&cr.length&&(Mt={["@media "+cr.join(", ")]:Mt}),!ar)continue e}}}(bt[Ht]=bt[Ht]||[]).push([mt?"cv":`${Ut}-${St[Ut]}`,Mt,tr])}return bt},A={},N$1=o$1(),D=(rt,_)=>N$1(rt,()=>(...ut)=>{const mt=()=>{for(let bt of ut){bt=typeof bt=="object"&&bt||{};let St=z(bt);if(!_.rules.global.cache.has(St)){if(_.rules.global.cache.add(St),"@import"in bt){let Mt=[].indexOf.call(_.sheet.cssRules,_.rules.themed.group)-1;for(let Bt of[].concat(bt["@import"]))Bt=Bt.includes('"')||Bt.includes("'")?Bt:`"${Bt}"`,_.sheet.insertRule(`@import ${Bt};`,Mt++);delete bt["@import"]}$$2(bt,[],[],rt,Mt=>{_.rules.global.apply(Mt)})}}return""};return s$2(mt,{toString:mt})}),H$1=o$1(),V$1=(rt,_)=>H$1(rt,()=>ut=>{const mt=`${S$2(rt.prefix)}k-${z(ut)}`,bt=()=>{if(!_.rules.global.cache.has(mt)){_.rules.global.cache.add(mt);const St=[];$$2(ut,[],[],rt,Bt=>St.push(Bt));const Mt=`@keyframes ${mt}{${St.join("")}}`;_.rules.global.apply(Mt)}return mt};return s$2(bt,{get name(){return bt()},toString:bt})}),G=class{constructor(rt,_,ut,mt){this.token=rt==null?"":String(rt),this.value=_==null?"":String(_),this.scale=ut==null?"":String(ut),this.prefix=mt==null?"":String(mt)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+S$2(this.prefix)+S$2(this.scale)+this.token}toString(){return this.computedValue}},F$1=o$1(),J$1=(rt,_)=>F$1(rt,()=>(ut,mt)=>{mt=typeof ut=="object"&&ut||Object(mt);const bt=`.${ut=(ut=typeof ut=="string"?ut:"")||`${S$2(rt.prefix)}t-${z(mt)}`}`,St={},Mt=[];for(const Ut in mt){St[Ut]={};for(const Ht in mt[Ut]){const tr=`--${S$2(rt.prefix)}${Ut}-${Ht}`,rr=k$2(String(mt[Ut][Ht]),rt.prefix,Ut);St[Ut][Ht]=new G(Ht,rr,Ut,rt.prefix),Mt.push(`${tr}:${rr}`)}}const Bt=()=>{if(Mt.length&&!_.rules.themed.cache.has(ut)){_.rules.themed.cache.add(ut);const Ut=`${mt===rt.theme?":root,":""}.${ut}{${Mt.join(";")}}`;_.rules.themed.apply(Ut)}return ut};return{...St,get className(){return Bt()},selector:bt,toString:Bt}}),U$1=o$1(),Y$1=o$1(),q$1=rt=>{const _=(ut=>{let mt=!1;const bt=U$1(ut,St=>{mt=!0;const Mt="prefix"in(St=typeof St=="object"&&St||{})?String(St.prefix):"",Bt=typeof St.media=="object"&&St.media||{},Ut=typeof St.root=="object"?St.root||null:globalThis.document||null,Ht=typeof St.theme=="object"&&St.theme||{},tr={prefix:Mt,media:Bt,theme:Ht,themeMap:typeof St.themeMap=="object"&&St.themeMap||{...n$1},utils:typeof St.utils=="object"&&St.utils||{}},rr=E(Ut),sr={css:M$1(tr,rr),globalCss:D(tr,rr),keyframes:V$1(tr,rr),createTheme:J$1(tr,rr),reset(){rr.reset(),sr.theme.toString()},theme:{},sheet:rr,config:tr,prefix:Mt,getCssText:rr.toString,toString:rr.toString};return String(sr.theme=sr.createTheme(Ht)),sr});return mt||bt.reset(),bt})(rt);return _.styled=(({config:ut,sheet:mt})=>Y$1(ut,()=>{const bt=M$1(ut,mt);return(...St)=>{const Mt=bt(...St),Bt=Mt[l$1].type,Ut=React.forwardRef((Ht,tr)=>{const rr=Ht&&Ht.as||Bt,{props:sr,deferredInjector:ar}=Mt(Ht);return delete sr.as,sr.ref=tr,ar?React.createElement(React.Fragment,null,React.createElement(rr,sr),React.createElement(ar,null)):React.createElement(rr,sr)});return Ut.className=Mt.className,Ut.displayName=`Styled.${Bt.displayName||Bt.name||Bt}`,Ut.selector=Mt.selector,Ut.toString=()=>Mt.selector,Ut[l$1]=Mt[l$1],Ut}}))(_),_};function $e42e1063c40fb3ef$export$b9ecd428b558ff10(rt,_,{checkForDefaultPrevented:ut=!0}={}){return function(bt){if(rt==null||rt(bt),ut===!1||!bt.defaultPrevented)return _==null?void 0:_(bt)}}function $c512c27ab02ef895$export$50c7b4e9d9f19c1(rt,_=[]){let ut=[];function mt(St,Mt){const Bt=reactExports.createContext(Mt),Ut=ut.length;ut=[...ut,Mt];function Ht(rr){const{scope:sr,children:ar,...cr}=rr,Ar=(sr==null?void 0:sr[rt][Ut])||Bt,_r=reactExports.useMemo(()=>cr,Object.values(cr));return reactExports.createElement(Ar.Provider,{value:_r},ar)}function tr(rr,sr){const ar=(sr==null?void 0:sr[rt][Ut])||Bt,cr=reactExports.useContext(ar);if(cr)return cr;if(Mt!==void 0)return Mt;throw new Error(`\`${rr}\` must be used within \`${St}\``)}return Ht.displayName=St+"Provider",[Ht,tr]}const bt=()=>{const St=ut.map(Mt=>reactExports.createContext(Mt));return function(Bt){const Ut=(Bt==null?void 0:Bt[rt])||St;return reactExports.useMemo(()=>({[`__scope${rt}`]:{...Bt,[rt]:Ut}}),[Bt,Ut])}};return bt.scopeName=rt,[mt,$c512c27ab02ef895$var$composeContextScopes(bt,..._)]}function $c512c27ab02ef895$var$composeContextScopes(...rt){const _=rt[0];if(rt.length===1)return _;const ut=()=>{const mt=rt.map(bt=>({useScope:bt(),scopeName:bt.scopeName}));return function(St){const Mt=mt.reduce((Bt,{useScope:Ut,scopeName:Ht})=>{const rr=Ut(St)[`__scope${Ht}`];return{...Bt,...rr}},{});return reactExports.useMemo(()=>({[`__scope${_.scopeName}`]:Mt}),[Mt])}};return ut.scopeName=_.scopeName,ut}function $b1b2314f5f9a1d84$export$25bec8c6f54ee79a(rt){const _=reactExports.useRef(rt);return reactExports.useEffect(()=>{_.current=rt}),reactExports.useMemo(()=>(...ut)=>{var mt;return(mt=_.current)===null||mt===void 0?void 0:mt.call(_,...ut)},[])}function $addc16e1bbe58fd0$export$3a72a57244d6e765(rt,_=globalThis==null?void 0:globalThis.document){const ut=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(rt);reactExports.useEffect(()=>{const mt=bt=>{bt.key==="Escape"&&ut(bt)};return _.addEventListener("keydown",mt),()=>_.removeEventListener("keydown",mt)},[ut,_])}const $5cb92bef7577960e$var$CONTEXT_UPDATE="dismissableLayer.update",$5cb92bef7577960e$var$POINTER_DOWN_OUTSIDE="dismissableLayer.pointerDownOutside",$5cb92bef7577960e$var$FOCUS_OUTSIDE="dismissableLayer.focusOutside";let $5cb92bef7577960e$var$originalBodyPointerEvents;const $5cb92bef7577960e$var$DismissableLayerContext=reactExports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),$5cb92bef7577960e$export$177fb62ff3ec1f22=reactExports.forwardRef((rt,_)=>{var ut;const{disableOutsidePointerEvents:mt=!1,onEscapeKeyDown:bt,onPointerDownOutside:St,onFocusOutside:Mt,onInteractOutside:Bt,onDismiss:Ut,...Ht}=rt,tr=reactExports.useContext($5cb92bef7577960e$var$DismissableLayerContext),[rr,sr]=reactExports.useState(null),ar=(ut=rr==null?void 0:rr.ownerDocument)!==null&&ut!==void 0?ut:globalThis==null?void 0:globalThis.document,[,cr]=reactExports.useState({}),Ar=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(_,en=>sr(en)),_r=Array.from(tr.layers),[Dr]=[...tr.layersWithOutsidePointerEventsDisabled].slice(-1),$r=_r.indexOf(Dr),Br=rr?_r.indexOf(rr):-1,Jr=tr.layersWithOutsidePointerEventsDisabled.size>0,mn=Br>=$r,Mn=$5cb92bef7577960e$var$usePointerDownOutside(en=>{const In=en.target,Rn=[...tr.branches].some(qn=>qn.contains(In));!mn||Rn||(St==null||St(en),Bt==null||Bt(en),en.defaultPrevented||Ut==null||Ut())},ar),$n=$5cb92bef7577960e$var$useFocusOutside(en=>{const In=en.target;[...tr.branches].some(qn=>qn.contains(In))||(Mt==null||Mt(en),Bt==null||Bt(en),en.defaultPrevented||Ut==null||Ut())},ar);return $addc16e1bbe58fd0$export$3a72a57244d6e765(en=>{Br===tr.layers.size-1&&(bt==null||bt(en),!en.defaultPrevented&&Ut&&(en.preventDefault(),Ut()))},ar),reactExports.useEffect(()=>{if(rr)return mt&&(tr.layersWithOutsidePointerEventsDisabled.size===0&&($5cb92bef7577960e$var$originalBodyPointerEvents=ar.body.style.pointerEvents,ar.body.style.pointerEvents="none"),tr.layersWithOutsidePointerEventsDisabled.add(rr)),tr.layers.add(rr),$5cb92bef7577960e$var$dispatchUpdate(),()=>{mt&&tr.layersWithOutsidePointerEventsDisabled.size===1&&(ar.body.style.pointerEvents=$5cb92bef7577960e$var$originalBodyPointerEvents)}},[rr,ar,mt,tr]),reactExports.useEffect(()=>()=>{rr&&(tr.layers.delete(rr),tr.layersWithOutsidePointerEventsDisabled.delete(rr),$5cb92bef7577960e$var$dispatchUpdate())},[rr,tr]),reactExports.useEffect(()=>{const en=()=>cr({});return document.addEventListener($5cb92bef7577960e$var$CONTEXT_UPDATE,en),()=>document.removeEventListener($5cb92bef7577960e$var$CONTEXT_UPDATE,en)},[]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$4({},Ht,{ref:Ar,style:{pointerEvents:Jr?mn?"auto":"none":void 0,...rt.style},onFocusCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(rt.onFocusCapture,$n.onFocusCapture),onBlurCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(rt.onBlurCapture,$n.onBlurCapture),onPointerDownCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(rt.onPointerDownCapture,Mn.onPointerDownCapture)}))});function $5cb92bef7577960e$var$usePointerDownOutside(rt,_=globalThis==null?void 0:globalThis.document){const ut=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(rt),mt=reactExports.useRef(!1),bt=reactExports.useRef(()=>{});return reactExports.useEffect(()=>{const St=Bt=>{if(Bt.target&&!mt.current){let tr=function(){$5cb92bef7577960e$var$handleAndDispatchCustomEvent($5cb92bef7577960e$var$POINTER_DOWN_OUTSIDE,ut,Ht,{discrete:!0})};var Ut=tr;const Ht={originalEvent:Bt};Bt.pointerType==="touch"?(_.removeEventListener("click",bt.current),bt.current=tr,_.addEventListener("click",bt.current,{once:!0})):tr()}else _.removeEventListener("click",bt.current);mt.current=!1},Mt=window.setTimeout(()=>{_.addEventListener("pointerdown",St)},0);return()=>{window.clearTimeout(Mt),_.removeEventListener("pointerdown",St),_.removeEventListener("click",bt.current)}},[_,ut]),{onPointerDownCapture:()=>mt.current=!0}}function $5cb92bef7577960e$var$useFocusOutside(rt,_=globalThis==null?void 0:globalThis.document){const ut=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(rt),mt=reactExports.useRef(!1);return reactExports.useEffect(()=>{const bt=St=>{St.target&&!mt.current&&$5cb92bef7577960e$var$handleAndDispatchCustomEvent($5cb92bef7577960e$var$FOCUS_OUTSIDE,ut,{originalEvent:St},{discrete:!1})};return _.addEventListener("focusin",bt),()=>_.removeEventListener("focusin",bt)},[_,ut]),{onFocusCapture:()=>mt.current=!0,onBlurCapture:()=>mt.current=!1}}function $5cb92bef7577960e$var$dispatchUpdate(){const rt=new CustomEvent($5cb92bef7577960e$var$CONTEXT_UPDATE);document.dispatchEvent(rt)}function $5cb92bef7577960e$var$handleAndDispatchCustomEvent(rt,_,ut,{discrete:mt}){const bt=ut.originalEvent.target,St=new CustomEvent(rt,{bubbles:!1,cancelable:!0,detail:ut});_&&bt.addEventListener(rt,_,{once:!0}),mt?$8927f6f2acc4f386$export$6d1a0317bde7de7f(bt,St):bt.dispatchEvent(St)}const $9f79659886946c16$export$e5c5a5f917a5871c=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{},$1746a345f3d73bb7$var$useReactId=$2AODx$react.useId||(()=>{});let $1746a345f3d73bb7$var$count=0;function $1746a345f3d73bb7$export$f680877a34711e37(rt){const[_,ut]=reactExports.useState($1746a345f3d73bb7$var$useReactId());return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{ut(mt=>mt??String($1746a345f3d73bb7$var$count++))},[rt]),_?`radix-${_}`:""}const sides=["top","right","bottom","left"],min=Math.min,max=Math.max,round=Math.round,floor=Math.floor,createCoords=rt=>({x:rt,y:rt}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp$2(rt,_,ut){return max(rt,min(_,ut))}function evaluate$1(rt,_){return typeof rt=="function"?rt(_):rt}function getSide(rt){return rt.split("-")[0]}function getAlignment(rt){return rt.split("-")[1]}function getOppositeAxis(rt){return rt==="x"?"y":"x"}function getAxisLength(rt){return rt==="y"?"height":"width"}function getSideAxis(rt){return["top","bottom"].includes(getSide(rt))?"y":"x"}function getAlignmentAxis(rt){return getOppositeAxis(getSideAxis(rt))}function getAlignmentSides(rt,_,ut){ut===void 0&&(ut=!1);const mt=getAlignment(rt),bt=getAlignmentAxis(rt),St=getAxisLength(bt);let Mt=bt==="x"?mt===(ut?"end":"start")?"right":"left":mt==="start"?"bottom":"top";return _.reference[St]>_.floating[St]&&(Mt=getOppositePlacement(Mt)),[Mt,getOppositePlacement(Mt)]}function getExpandedPlacements(rt){const _=getOppositePlacement(rt);return[getOppositeAlignmentPlacement(rt),_,getOppositeAlignmentPlacement(_)]}function getOppositeAlignmentPlacement(rt){return rt.replace(/start|end/g,_=>oppositeAlignmentMap[_])}function getSideList(rt,_,ut){const mt=["left","right"],bt=["right","left"],St=["top","bottom"],Mt=["bottom","top"];switch(rt){case"top":case"bottom":return ut?_?bt:mt:_?mt:bt;case"left":case"right":return _?St:Mt;default:return[]}}function getOppositeAxisPlacements(rt,_,ut,mt){const bt=getAlignment(rt);let St=getSideList(getSide(rt),ut==="start",mt);return bt&&(St=St.map(Mt=>Mt+"-"+bt),_&&(St=St.concat(St.map(getOppositeAlignmentPlacement)))),St}function getOppositePlacement(rt){return rt.replace(/left|right|bottom|top/g,_=>oppositeSideMap[_])}function expandPaddingObject(rt){return{top:0,right:0,bottom:0,left:0,...rt}}function getPaddingObject(rt){return typeof rt!="number"?expandPaddingObject(rt):{top:rt,right:rt,bottom:rt,left:rt}}function rectToClientRect(rt){const{x:_,y:ut,width:mt,height:bt}=rt;return{width:mt,height:bt,top:ut,left:_,right:_+mt,bottom:ut+bt,x:_,y:ut}}function computeCoordsFromPlacement(rt,_,ut){let{reference:mt,floating:bt}=rt;const St=getSideAxis(_),Mt=getAlignmentAxis(_),Bt=getAxisLength(Mt),Ut=getSide(_),Ht=St==="y",tr=mt.x+mt.width/2-bt.width/2,rr=mt.y+mt.height/2-bt.height/2,sr=mt[Bt]/2-bt[Bt]/2;let ar;switch(Ut){case"top":ar={x:tr,y:mt.y-bt.height};break;case"bottom":ar={x:tr,y:mt.y+mt.height};break;case"right":ar={x:mt.x+mt.width,y:rr};break;case"left":ar={x:mt.x-bt.width,y:rr};break;default:ar={x:mt.x,y:mt.y}}switch(getAlignment(_)){case"start":ar[Mt]-=sr*(ut&&Ht?-1:1);break;case"end":ar[Mt]+=sr*(ut&&Ht?-1:1);break}return ar}const computePosition$1=async(rt,_,ut)=>{const{placement:mt="bottom",strategy:bt="absolute",middleware:St=[],platform:Mt}=ut,Bt=St.filter(Boolean),Ut=await(Mt.isRTL==null?void 0:Mt.isRTL(_));let Ht=await Mt.getElementRects({reference:rt,floating:_,strategy:bt}),{x:tr,y:rr}=computeCoordsFromPlacement(Ht,mt,Ut),sr=mt,ar={},cr=0;for(let Ar=0;Ar<Bt.length;Ar++){const{name:_r,fn:Dr}=Bt[Ar],{x:$r,y:Br,data:Jr,reset:mn}=await Dr({x:tr,y:rr,initialPlacement:mt,placement:sr,strategy:bt,middlewareData:ar,rects:Ht,platform:Mt,elements:{reference:rt,floating:_}});tr=$r??tr,rr=Br??rr,ar={...ar,[_r]:{...ar[_r],...Jr}},mn&&cr<=50&&(cr++,typeof mn=="object"&&(mn.placement&&(sr=mn.placement),mn.rects&&(Ht=mn.rects===!0?await Mt.getElementRects({reference:rt,floating:_,strategy:bt}):mn.rects),{x:tr,y:rr}=computeCoordsFromPlacement(Ht,sr,Ut)),Ar=-1)}return{x:tr,y:rr,placement:sr,strategy:bt,middlewareData:ar}};async function detectOverflow(rt,_){var ut;_===void 0&&(_={});const{x:mt,y:bt,platform:St,rects:Mt,elements:Bt,strategy:Ut}=rt,{boundary:Ht="clippingAncestors",rootBoundary:tr="viewport",elementContext:rr="floating",altBoundary:sr=!1,padding:ar=0}=evaluate$1(_,rt),cr=getPaddingObject(ar),_r=Bt[sr?rr==="floating"?"reference":"floating":rr],Dr=rectToClientRect(await St.getClippingRect({element:(ut=await(St.isElement==null?void 0:St.isElement(_r)))==null||ut?_r:_r.contextElement||await(St.getDocumentElement==null?void 0:St.getDocumentElement(Bt.floating)),boundary:Ht,rootBoundary:tr,strategy:Ut})),$r=rr==="floating"?{x:mt,y:bt,width:Mt.floating.width,height:Mt.floating.height}:Mt.reference,Br=await(St.getOffsetParent==null?void 0:St.getOffsetParent(Bt.floating)),Jr=await(St.isElement==null?void 0:St.isElement(Br))?await(St.getScale==null?void 0:St.getScale(Br))||{x:1,y:1}:{x:1,y:1},mn=rectToClientRect(St.convertOffsetParentRelativeRectToViewportRelativeRect?await St.convertOffsetParentRelativeRectToViewportRelativeRect({elements:Bt,rect:$r,offsetParent:Br,strategy:Ut}):$r);return{top:(Dr.top-mn.top+cr.top)/Jr.y,bottom:(mn.bottom-Dr.bottom+cr.bottom)/Jr.y,left:(Dr.left-mn.left+cr.left)/Jr.x,right:(mn.right-Dr.right+cr.right)/Jr.x}}const arrow$2=rt=>({name:"arrow",options:rt,async fn(_){const{x:ut,y:mt,placement:bt,rects:St,platform:Mt,elements:Bt,middlewareData:Ut}=_,{element:Ht,padding:tr=0}=evaluate$1(rt,_)||{};if(Ht==null)return{};const rr=getPaddingObject(tr),sr={x:ut,y:mt},ar=getAlignmentAxis(bt),cr=getAxisLength(ar),Ar=await Mt.getDimensions(Ht),_r=ar==="y",Dr=_r?"top":"left",$r=_r?"bottom":"right",Br=_r?"clientHeight":"clientWidth",Jr=St.reference[cr]+St.reference[ar]-sr[ar]-St.floating[cr],mn=sr[ar]-St.reference[ar],Mn=await(Mt.getOffsetParent==null?void 0:Mt.getOffsetParent(Ht));let $n=Mn?Mn[Br]:0;(!$n||!await(Mt.isElement==null?void 0:Mt.isElement(Mn)))&&($n=Bt.floating[Br]||St.floating[cr]);const en=Jr/2-mn/2,In=$n/2-Ar[cr]/2-1,Rn=min(rr[Dr],In),qn=min(rr[$r],In),Qn=Rn,xs=$n-Ar[cr]-qn,cs=$n/2-Ar[cr]/2+en,ks=clamp$2(Qn,cs,xs),_o=!Ut.arrow&&getAlignment(bt)!=null&&cs!==ks&&St.reference[cr]/2-(cs<Qn?Rn:qn)-Ar[cr]/2<0,qs=_o?cs<Qn?cs-Qn:cs-xs:0;return{[ar]:sr[ar]+qs,data:{[ar]:ks,centerOffset:cs-ks-qs,..._o&&{alignmentOffset:qs}},reset:_o}}}),flip$1=function(rt){return rt===void 0&&(rt={}),{name:"flip",options:rt,async fn(_){var ut,mt;const{placement:bt,middlewareData:St,rects:Mt,initialPlacement:Bt,platform:Ut,elements:Ht}=_,{mainAxis:tr=!0,crossAxis:rr=!0,fallbackPlacements:sr,fallbackStrategy:ar="bestFit",fallbackAxisSideDirection:cr="none",flipAlignment:Ar=!0,..._r}=evaluate$1(rt,_);if((ut=St.arrow)!=null&&ut.alignmentOffset)return{};const Dr=getSide(bt),$r=getSide(Bt)===Bt,Br=await(Ut.isRTL==null?void 0:Ut.isRTL(Ht.floating)),Jr=sr||($r||!Ar?[getOppositePlacement(Bt)]:getExpandedPlacements(Bt));!sr&&cr!=="none"&&Jr.push(...getOppositeAxisPlacements(Bt,Ar,cr,Br));const mn=[Bt,...Jr],Mn=await detectOverflow(_,_r),$n=[];let en=((mt=St.flip)==null?void 0:mt.overflows)||[];if(tr&&$n.push(Mn[Dr]),rr){const Qn=getAlignmentSides(bt,Mt,Br);$n.push(Mn[Qn[0]],Mn[Qn[1]])}if(en=[...en,{placement:bt,overflows:$n}],!$n.every(Qn=>Qn<=0)){var In,Rn;const Qn=(((In=St.flip)==null?void 0:In.index)||0)+1,xs=mn[Qn];if(xs)return{data:{index:Qn,overflows:en},reset:{placement:xs}};let cs=(Rn=en.filter(ks=>ks.overflows[0]<=0).sort((ks,_o)=>ks.overflows[1]-_o.overflows[1])[0])==null?void 0:Rn.placement;if(!cs)switch(ar){case"bestFit":{var qn;const ks=(qn=en.map(_o=>[_o.placement,_o.overflows.filter(qs=>qs>0).reduce((qs,Ss)=>qs+Ss,0)]).sort((_o,qs)=>_o[1]-qs[1])[0])==null?void 0:qn[0];ks&&(cs=ks);break}case"initialPlacement":cs=Bt;break}if(bt!==cs)return{reset:{placement:cs}}}return{}}}};function getSideOffsets(rt,_){return{top:rt.top-_.height,right:rt.right-_.width,bottom:rt.bottom-_.height,left:rt.left-_.width}}function isAnySideFullyClipped(rt){return sides.some(_=>rt[_]>=0)}const hide$1=function(rt){return rt===void 0&&(rt={}),{name:"hide",options:rt,async fn(_){const{rects:ut}=_,{strategy:mt="referenceHidden",...bt}=evaluate$1(rt,_);switch(mt){case"referenceHidden":{const St=await detectOverflow(_,{...bt,elementContext:"reference"}),Mt=getSideOffsets(St,ut.reference);return{data:{referenceHiddenOffsets:Mt,referenceHidden:isAnySideFullyClipped(Mt)}}}case"escaped":{const St=await detectOverflow(_,{...bt,altBoundary:!0}),Mt=getSideOffsets(St,ut.floating);return{data:{escapedOffsets:Mt,escaped:isAnySideFullyClipped(Mt)}}}default:return{}}}}};async function convertValueToCoords(rt,_){const{placement:ut,platform:mt,elements:bt}=rt,St=await(mt.isRTL==null?void 0:mt.isRTL(bt.floating)),Mt=getSide(ut),Bt=getAlignment(ut),Ut=getSideAxis(ut)==="y",Ht=["left","top"].includes(Mt)?-1:1,tr=St&&Ut?-1:1,rr=evaluate$1(_,rt);let{mainAxis:sr,crossAxis:ar,alignmentAxis:cr}=typeof rr=="number"?{mainAxis:rr,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...rr};return Bt&&typeof cr=="number"&&(ar=Bt==="end"?cr*-1:cr),Ut?{x:ar*tr,y:sr*Ht}:{x:sr*Ht,y:ar*tr}}const offset$1=function(rt){return rt===void 0&&(rt=0),{name:"offset",options:rt,async fn(_){var ut,mt;const{x:bt,y:St,placement:Mt,middlewareData:Bt}=_,Ut=await convertValueToCoords(_,rt);return Mt===((ut=Bt.offset)==null?void 0:ut.placement)&&(mt=Bt.arrow)!=null&&mt.alignmentOffset?{}:{x:bt+Ut.x,y:St+Ut.y,data:{...Ut,placement:Mt}}}}},shift$1=function(rt){return rt===void 0&&(rt={}),{name:"shift",options:rt,async fn(_){const{x:ut,y:mt,placement:bt}=_,{mainAxis:St=!0,crossAxis:Mt=!1,limiter:Bt={fn:_r=>{let{x:Dr,y:$r}=_r;return{x:Dr,y:$r}}},...Ut}=evaluate$1(rt,_),Ht={x:ut,y:mt},tr=await detectOverflow(_,Ut),rr=getSideAxis(getSide(bt)),sr=getOppositeAxis(rr);let ar=Ht[sr],cr=Ht[rr];if(St){const _r=sr==="y"?"top":"left",Dr=sr==="y"?"bottom":"right",$r=ar+tr[_r],Br=ar-tr[Dr];ar=clamp$2($r,ar,Br)}if(Mt){const _r=rr==="y"?"top":"left",Dr=rr==="y"?"bottom":"right",$r=cr+tr[_r],Br=cr-tr[Dr];cr=clamp$2($r,cr,Br)}const Ar=Bt.fn({..._,[sr]:ar,[rr]:cr});return{...Ar,data:{x:Ar.x-ut,y:Ar.y-mt}}}}},limitShift$1=function(rt){return rt===void 0&&(rt={}),{options:rt,fn(_){const{x:ut,y:mt,placement:bt,rects:St,middlewareData:Mt}=_,{offset:Bt=0,mainAxis:Ut=!0,crossAxis:Ht=!0}=evaluate$1(rt,_),tr={x:ut,y:mt},rr=getSideAxis(bt),sr=getOppositeAxis(rr);let ar=tr[sr],cr=tr[rr];const Ar=evaluate$1(Bt,_),_r=typeof Ar=="number"?{mainAxis:Ar,crossAxis:0}:{mainAxis:0,crossAxis:0,...Ar};if(Ut){const Br=sr==="y"?"height":"width",Jr=St.reference[sr]-St.floating[Br]+_r.mainAxis,mn=St.reference[sr]+St.reference[Br]-_r.mainAxis;ar<Jr?ar=Jr:ar>mn&&(ar=mn)}if(Ht){var Dr,$r;const Br=sr==="y"?"width":"height",Jr=["top","left"].includes(getSide(bt)),mn=St.reference[rr]-St.floating[Br]+(Jr&&((Dr=Mt.offset)==null?void 0:Dr[rr])||0)+(Jr?0:_r.crossAxis),Mn=St.reference[rr]+St.reference[Br]+(Jr?0:(($r=Mt.offset)==null?void 0:$r[rr])||0)-(Jr?_r.crossAxis:0);cr<mn?cr=mn:cr>Mn&&(cr=Mn)}return{[sr]:ar,[rr]:cr}}}},size$1=function(rt){return rt===void 0&&(rt={}),{name:"size",options:rt,async fn(_){const{placement:ut,rects:mt,platform:bt,elements:St}=_,{apply:Mt=()=>{},...Bt}=evaluate$1(rt,_),Ut=await detectOverflow(_,Bt),Ht=getSide(ut),tr=getAlignment(ut),rr=getSideAxis(ut)==="y",{width:sr,height:ar}=mt.floating;let cr,Ar;Ht==="top"||Ht==="bottom"?(cr=Ht,Ar=tr===(await(bt.isRTL==null?void 0:bt.isRTL(St.floating))?"start":"end")?"left":"right"):(Ar=Ht,cr=tr==="end"?"top":"bottom");const _r=ar-Ut[cr],Dr=sr-Ut[Ar],$r=!_.middlewareData.shift;let Br=_r,Jr=Dr;if(rr){const Mn=sr-Ut.left-Ut.right;Jr=tr||$r?min(Dr,Mn):Mn}else{const Mn=ar-Ut.top-Ut.bottom;Br=tr||$r?min(_r,Mn):Mn}if($r&&!tr){const Mn=max(Ut.left,0),$n=max(Ut.right,0),en=max(Ut.top,0),In=max(Ut.bottom,0);rr?Jr=sr-2*(Mn!==0||$n!==0?Mn+$n:max(Ut.left,Ut.right)):Br=ar-2*(en!==0||In!==0?en+In:max(Ut.top,Ut.bottom))}await Mt({..._,availableWidth:Jr,availableHeight:Br});const mn=await bt.getDimensions(St.floating);return sr!==mn.width||ar!==mn.height?{reset:{rects:!0}}:{}}}};function getNodeName(rt){return isNode(rt)?(rt.nodeName||"").toLowerCase():"#document"}function getWindow(rt){var _;return(rt==null||(_=rt.ownerDocument)==null?void 0:_.defaultView)||window}function getDocumentElement(rt){var _;return(_=(isNode(rt)?rt.ownerDocument:rt.document)||window.document)==null?void 0:_.documentElement}function isNode(rt){return rt instanceof Node||rt instanceof getWindow(rt).Node}function isElement(rt){return rt instanceof Element||rt instanceof getWindow(rt).Element}function isHTMLElement(rt){return rt instanceof HTMLElement||rt instanceof getWindow(rt).HTMLElement}function isShadowRoot(rt){return typeof ShadowRoot>"u"?!1:rt instanceof ShadowRoot||rt instanceof getWindow(rt).ShadowRoot}function isOverflowElement(rt){const{overflow:_,overflowX:ut,overflowY:mt,display:bt}=getComputedStyle$1(rt);return/auto|scroll|overlay|hidden|clip/.test(_+mt+ut)&&!["inline","contents"].includes(bt)}function isTableElement(rt){return["table","td","th"].includes(getNodeName(rt))}function isContainingBlock(rt){const _=isWebKit(),ut=getComputedStyle$1(rt);return ut.transform!=="none"||ut.perspective!=="none"||(ut.containerType?ut.containerType!=="normal":!1)||!_&&(ut.backdropFilter?ut.backdropFilter!=="none":!1)||!_&&(ut.filter?ut.filter!=="none":!1)||["transform","perspective","filter"].some(mt=>(ut.willChange||"").includes(mt))||["paint","layout","strict","content"].some(mt=>(ut.contain||"").includes(mt))}function getContainingBlock(rt){let _=getParentNode(rt);for(;isHTMLElement(_)&&!isLastTraversableNode(_);){if(isContainingBlock(_))return _;_=getParentNode(_)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(rt){return["html","body","#document"].includes(getNodeName(rt))}function getComputedStyle$1(rt){return getWindow(rt).getComputedStyle(rt)}function getNodeScroll(rt){return isElement(rt)?{scrollLeft:rt.scrollLeft,scrollTop:rt.scrollTop}:{scrollLeft:rt.pageXOffset,scrollTop:rt.pageYOffset}}function getParentNode(rt){if(getNodeName(rt)==="html")return rt;const _=rt.assignedSlot||rt.parentNode||isShadowRoot(rt)&&rt.host||getDocumentElement(rt);return isShadowRoot(_)?_.host:_}function getNearestOverflowAncestor(rt){const _=getParentNode(rt);return isLastTraversableNode(_)?rt.ownerDocument?rt.ownerDocument.body:rt.body:isHTMLElement(_)&&isOverflowElement(_)?_:getNearestOverflowAncestor(_)}function getOverflowAncestors(rt,_,ut){var mt;_===void 0&&(_=[]),ut===void 0&&(ut=!0);const bt=getNearestOverflowAncestor(rt),St=bt===((mt=rt.ownerDocument)==null?void 0:mt.body),Mt=getWindow(bt);return St?_.concat(Mt,Mt.visualViewport||[],isOverflowElement(bt)?bt:[],Mt.frameElement&&ut?getOverflowAncestors(Mt.frameElement):[]):_.concat(bt,getOverflowAncestors(bt,[],ut))}function getCssDimensions(rt){const _=getComputedStyle$1(rt);let ut=parseFloat(_.width)||0,mt=parseFloat(_.height)||0;const bt=isHTMLElement(rt),St=bt?rt.offsetWidth:ut,Mt=bt?rt.offsetHeight:mt,Bt=round(ut)!==St||round(mt)!==Mt;return Bt&&(ut=St,mt=Mt),{width:ut,height:mt,$:Bt}}function unwrapElement(rt){return isElement(rt)?rt:rt.contextElement}function getScale(rt){const _=unwrapElement(rt);if(!isHTMLElement(_))return createCoords(1);const ut=_.getBoundingClientRect(),{width:mt,height:bt,$:St}=getCssDimensions(_);let Mt=(St?round(ut.width):ut.width)/mt,Bt=(St?round(ut.height):ut.height)/bt;return(!Mt||!Number.isFinite(Mt))&&(Mt=1),(!Bt||!Number.isFinite(Bt))&&(Bt=1),{x:Mt,y:Bt}}const noOffsets=createCoords(0);function getVisualOffsets(rt){const _=getWindow(rt);return!isWebKit()||!_.visualViewport?noOffsets:{x:_.visualViewport.offsetLeft,y:_.visualViewport.offsetTop}}function shouldAddVisualOffsets(rt,_,ut){return _===void 0&&(_=!1),!ut||_&&ut!==getWindow(rt)?!1:_}function getBoundingClientRect(rt,_,ut,mt){_===void 0&&(_=!1),ut===void 0&&(ut=!1);const bt=rt.getBoundingClientRect(),St=unwrapElement(rt);let Mt=createCoords(1);_&&(mt?isElement(mt)&&(Mt=getScale(mt)):Mt=getScale(rt));const Bt=shouldAddVisualOffsets(St,ut,mt)?getVisualOffsets(St):createCoords(0);let Ut=(bt.left+Bt.x)/Mt.x,Ht=(bt.top+Bt.y)/Mt.y,tr=bt.width/Mt.x,rr=bt.height/Mt.y;if(St){const sr=getWindow(St),ar=mt&&isElement(mt)?getWindow(mt):mt;let cr=sr,Ar=cr.frameElement;for(;Ar&&mt&&ar!==cr;){const _r=getScale(Ar),Dr=Ar.getBoundingClientRect(),$r=getComputedStyle$1(Ar),Br=Dr.left+(Ar.clientLeft+parseFloat($r.paddingLeft))*_r.x,Jr=Dr.top+(Ar.clientTop+parseFloat($r.paddingTop))*_r.y;Ut*=_r.x,Ht*=_r.y,tr*=_r.x,rr*=_r.y,Ut+=Br,Ht+=Jr,cr=getWindow(Ar),Ar=cr.frameElement}}return rectToClientRect({width:tr,height:rr,x:Ut,y:Ht})}const topLayerSelectors=[":popover-open",":modal"];function isTopLayer(rt){return topLayerSelectors.some(_=>{try{return rt.matches(_)}catch{return!1}})}function convertOffsetParentRelativeRectToViewportRelativeRect(rt){let{elements:_,rect:ut,offsetParent:mt,strategy:bt}=rt;const St=bt==="fixed",Mt=getDocumentElement(mt),Bt=_?isTopLayer(_.floating):!1;if(mt===Mt||Bt&&St)return ut;let Ut={scrollLeft:0,scrollTop:0},Ht=createCoords(1);const tr=createCoords(0),rr=isHTMLElement(mt);if((rr||!rr&&!St)&&((getNodeName(mt)!=="body"||isOverflowElement(Mt))&&(Ut=getNodeScroll(mt)),isHTMLElement(mt))){const sr=getBoundingClientRect(mt);Ht=getScale(mt),tr.x=sr.x+mt.clientLeft,tr.y=sr.y+mt.clientTop}return{width:ut.width*Ht.x,height:ut.height*Ht.y,x:ut.x*Ht.x-Ut.scrollLeft*Ht.x+tr.x,y:ut.y*Ht.y-Ut.scrollTop*Ht.y+tr.y}}function getClientRects(rt){return Array.from(rt.getClientRects())}function getWindowScrollBarX(rt){return getBoundingClientRect(getDocumentElement(rt)).left+getNodeScroll(rt).scrollLeft}function getDocumentRect(rt){const _=getDocumentElement(rt),ut=getNodeScroll(rt),mt=rt.ownerDocument.body,bt=max(_.scrollWidth,_.clientWidth,mt.scrollWidth,mt.clientWidth),St=max(_.scrollHeight,_.clientHeight,mt.scrollHeight,mt.clientHeight);let Mt=-ut.scrollLeft+getWindowScrollBarX(rt);const Bt=-ut.scrollTop;return getComputedStyle$1(mt).direction==="rtl"&&(Mt+=max(_.clientWidth,mt.clientWidth)-bt),{width:bt,height:St,x:Mt,y:Bt}}function getViewportRect(rt,_){const ut=getWindow(rt),mt=getDocumentElement(rt),bt=ut.visualViewport;let St=mt.clientWidth,Mt=mt.clientHeight,Bt=0,Ut=0;if(bt){St=bt.width,Mt=bt.height;const Ht=isWebKit();(!Ht||Ht&&_==="fixed")&&(Bt=bt.offsetLeft,Ut=bt.offsetTop)}return{width:St,height:Mt,x:Bt,y:Ut}}function getInnerBoundingClientRect(rt,_){const ut=getBoundingClientRect(rt,!0,_==="fixed"),mt=ut.top+rt.clientTop,bt=ut.left+rt.clientLeft,St=isHTMLElement(rt)?getScale(rt):createCoords(1),Mt=rt.clientWidth*St.x,Bt=rt.clientHeight*St.y,Ut=bt*St.x,Ht=mt*St.y;return{width:Mt,height:Bt,x:Ut,y:Ht}}function getClientRectFromClippingAncestor(rt,_,ut){let mt;if(_==="viewport")mt=getViewportRect(rt,ut);else if(_==="document")mt=getDocumentRect(getDocumentElement(rt));else if(isElement(_))mt=getInnerBoundingClientRect(_,ut);else{const bt=getVisualOffsets(rt);mt={..._,x:_.x-bt.x,y:_.y-bt.y}}return rectToClientRect(mt)}function hasFixedPositionAncestor(rt,_){const ut=getParentNode(rt);return ut===_||!isElement(ut)||isLastTraversableNode(ut)?!1:getComputedStyle$1(ut).position==="fixed"||hasFixedPositionAncestor(ut,_)}function getClippingElementAncestors(rt,_){const ut=_.get(rt);if(ut)return ut;let mt=getOverflowAncestors(rt,[],!1).filter(Bt=>isElement(Bt)&&getNodeName(Bt)!=="body"),bt=null;const St=getComputedStyle$1(rt).position==="fixed";let Mt=St?getParentNode(rt):rt;for(;isElement(Mt)&&!isLastTraversableNode(Mt);){const Bt=getComputedStyle$1(Mt),Ut=isContainingBlock(Mt);!Ut&&Bt.position==="fixed"&&(bt=null),(St?!Ut&&!bt:!Ut&&Bt.position==="static"&&!!bt&&["absolute","fixed"].includes(bt.position)||isOverflowElement(Mt)&&!Ut&&hasFixedPositionAncestor(rt,Mt))?mt=mt.filter(tr=>tr!==Mt):bt=Bt,Mt=getParentNode(Mt)}return _.set(rt,mt),mt}function getClippingRect(rt){let{element:_,boundary:ut,rootBoundary:mt,strategy:bt}=rt;const Mt=[...ut==="clippingAncestors"?isTopLayer(_)?[]:getClippingElementAncestors(_,this._c):[].concat(ut),mt],Bt=Mt[0],Ut=Mt.reduce((Ht,tr)=>{const rr=getClientRectFromClippingAncestor(_,tr,bt);return Ht.top=max(rr.top,Ht.top),Ht.right=min(rr.right,Ht.right),Ht.bottom=min(rr.bottom,Ht.bottom),Ht.left=max(rr.left,Ht.left),Ht},getClientRectFromClippingAncestor(_,Bt,bt));return{width:Ut.right-Ut.left,height:Ut.bottom-Ut.top,x:Ut.left,y:Ut.top}}function getDimensions(rt){const{width:_,height:ut}=getCssDimensions(rt);return{width:_,height:ut}}function getRectRelativeToOffsetParent(rt,_,ut){const mt=isHTMLElement(_),bt=getDocumentElement(_),St=ut==="fixed",Mt=getBoundingClientRect(rt,!0,St,_);let Bt={scrollLeft:0,scrollTop:0};const Ut=createCoords(0);if(mt||!mt&&!St)if((getNodeName(_)!=="body"||isOverflowElement(bt))&&(Bt=getNodeScroll(_)),mt){const rr=getBoundingClientRect(_,!0,St,_);Ut.x=rr.x+_.clientLeft,Ut.y=rr.y+_.clientTop}else bt&&(Ut.x=getWindowScrollBarX(bt));const Ht=Mt.left+Bt.scrollLeft-Ut.x,tr=Mt.top+Bt.scrollTop-Ut.y;return{x:Ht,y:tr,width:Mt.width,height:Mt.height}}function isStaticPositioned(rt){return getComputedStyle$1(rt).position==="static"}function getTrueOffsetParent(rt,_){return!isHTMLElement(rt)||getComputedStyle$1(rt).position==="fixed"?null:_?_(rt):rt.offsetParent}function getOffsetParent(rt,_){const ut=getWindow(rt);if(isTopLayer(rt))return ut;if(!isHTMLElement(rt)){let bt=getParentNode(rt);for(;bt&&!isLastTraversableNode(bt);){if(isElement(bt)&&!isStaticPositioned(bt))return bt;bt=getParentNode(bt)}return ut}let mt=getTrueOffsetParent(rt,_);for(;mt&&isTableElement(mt)&&isStaticPositioned(mt);)mt=getTrueOffsetParent(mt,_);return mt&&isLastTraversableNode(mt)&&isStaticPositioned(mt)&&!isContainingBlock(mt)?ut:mt||getContainingBlock(rt)||ut}const getElementRects=async function(rt){const _=this.getOffsetParent||getOffsetParent,ut=this.getDimensions,mt=await ut(rt.floating);return{reference:getRectRelativeToOffsetParent(rt.reference,await _(rt.floating),rt.strategy),floating:{x:0,y:0,width:mt.width,height:mt.height}}};function isRTL(rt){return getComputedStyle$1(rt).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function observeMove(rt,_){let ut=null,mt;const bt=getDocumentElement(rt);function St(){var Bt;clearTimeout(mt),(Bt=ut)==null||Bt.disconnect(),ut=null}function Mt(Bt,Ut){Bt===void 0&&(Bt=!1),Ut===void 0&&(Ut=1),St();const{left:Ht,top:tr,width:rr,height:sr}=rt.getBoundingClientRect();if(Bt||_(),!rr||!sr)return;const ar=floor(tr),cr=floor(bt.clientWidth-(Ht+rr)),Ar=floor(bt.clientHeight-(tr+sr)),_r=floor(Ht),$r={rootMargin:-ar+"px "+-cr+"px "+-Ar+"px "+-_r+"px",threshold:max(0,min(1,Ut))||1};let Br=!0;function Jr(mn){const Mn=mn[0].intersectionRatio;if(Mn!==Ut){if(!Br)return Mt();Mn?Mt(!1,Mn):mt=setTimeout(()=>{Mt(!1,1e-7)},1e3)}Br=!1}try{ut=new IntersectionObserver(Jr,{...$r,root:bt.ownerDocument})}catch{ut=new IntersectionObserver(Jr,$r)}ut.observe(rt)}return Mt(!0),St}function autoUpdate(rt,_,ut,mt){mt===void 0&&(mt={});const{ancestorScroll:bt=!0,ancestorResize:St=!0,elementResize:Mt=typeof ResizeObserver=="function",layoutShift:Bt=typeof IntersectionObserver=="function",animationFrame:Ut=!1}=mt,Ht=unwrapElement(rt),tr=bt||St?[...Ht?getOverflowAncestors(Ht):[],...getOverflowAncestors(_)]:[];tr.forEach(Dr=>{bt&&Dr.addEventListener("scroll",ut,{passive:!0}),St&&Dr.addEventListener("resize",ut)});const rr=Ht&&Bt?observeMove(Ht,ut):null;let sr=-1,ar=null;Mt&&(ar=new ResizeObserver(Dr=>{let[$r]=Dr;$r&&$r.target===Ht&&ar&&(ar.unobserve(_),cancelAnimationFrame(sr),sr=requestAnimationFrame(()=>{var Br;(Br=ar)==null||Br.observe(_)})),ut()}),Ht&&!Ut&&ar.observe(Ht),ar.observe(_));let cr,Ar=Ut?getBoundingClientRect(rt):null;Ut&&_r();function _r(){const Dr=getBoundingClientRect(rt);Ar&&(Dr.x!==Ar.x||Dr.y!==Ar.y||Dr.width!==Ar.width||Dr.height!==Ar.height)&&ut(),Ar=Dr,cr=requestAnimationFrame(_r)}return ut(),()=>{var Dr;tr.forEach($r=>{bt&&$r.removeEventListener("scroll",ut),St&&$r.removeEventListener("resize",ut)}),rr==null||rr(),(Dr=ar)==null||Dr.disconnect(),ar=null,Ut&&cancelAnimationFrame(cr)}}const offset=offset$1,shift=shift$1,flip=flip$1,size=size$1,hide=hide$1,arrow$1=arrow$2,limitShift=limitShift$1,computePosition=(rt,_,ut)=>{const mt=new Map,bt={platform,...ut},St={...bt.platform,_c:mt};return computePosition$1(rt,_,{...bt,platform:St})},arrow=rt=>{function _(ut){return{}.hasOwnProperty.call(ut,"current")}return{name:"arrow",options:rt,fn(ut){const{element:mt,padding:bt}=typeof rt=="function"?rt(ut):rt;return mt&&_(mt)?mt.current!=null?arrow$1({element:mt.current,padding:bt}).fn(ut):{}:mt?arrow$1({element:mt,padding:bt}).fn(ut):{}}}};var index=typeof document<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function deepEqual(rt,_){if(rt===_)return!0;if(typeof rt!=typeof _)return!1;if(typeof rt=="function"&&rt.toString()===_.toString())return!0;let ut,mt,bt;if(rt&&_&&typeof rt=="object"){if(Array.isArray(rt)){if(ut=rt.length,ut!==_.length)return!1;for(mt=ut;mt--!==0;)if(!deepEqual(rt[mt],_[mt]))return!1;return!0}if(bt=Object.keys(rt),ut=bt.length,ut!==Object.keys(_).length)return!1;for(mt=ut;mt--!==0;)if(!{}.hasOwnProperty.call(_,bt[mt]))return!1;for(mt=ut;mt--!==0;){const St=bt[mt];if(!(St==="_owner"&&rt.$$typeof)&&!deepEqual(rt[St],_[St]))return!1}return!0}return rt!==rt&&_!==_}function getDPR(rt){return typeof window>"u"?1:(rt.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(rt,_){const ut=getDPR(rt);return Math.round(_*ut)/ut}function useLatestRef(rt){const _=reactExports.useRef(rt);return index(()=>{_.current=rt}),_}function useFloating(rt){rt===void 0&&(rt={});const{placement:_="bottom",strategy:ut="absolute",middleware:mt=[],platform:bt,elements:{reference:St,floating:Mt}={},transform:Bt=!0,whileElementsMounted:Ut,open:Ht}=rt,[tr,rr]=reactExports.useState({x:0,y:0,strategy:ut,placement:_,middlewareData:{},isPositioned:!1}),[sr,ar]=reactExports.useState(mt);deepEqual(sr,mt)||ar(mt);const[cr,Ar]=reactExports.useState(null),[_r,Dr]=reactExports.useState(null),$r=reactExports.useCallback(qs=>{qs!==Mn.current&&(Mn.current=qs,Ar(qs))},[]),Br=reactExports.useCallback(qs=>{qs!==$n.current&&($n.current=qs,Dr(qs))},[]),Jr=St||cr,mn=Mt||_r,Mn=reactExports.useRef(null),$n=reactExports.useRef(null),en=reactExports.useRef(tr),In=Ut!=null,Rn=useLatestRef(Ut),qn=useLatestRef(bt),Qn=reactExports.useCallback(()=>{if(!Mn.current||!$n.current)return;const qs={placement:_,strategy:ut,middleware:sr};qn.current&&(qs.platform=qn.current),computePosition(Mn.current,$n.current,qs).then(Ss=>{const eo={...Ss,isPositioned:!0};xs.current&&!deepEqual(en.current,eo)&&(en.current=eo,reactDomExports.flushSync(()=>{rr(eo)}))})},[sr,_,ut,qn]);index(()=>{Ht===!1&&en.current.isPositioned&&(en.current.isPositioned=!1,rr(qs=>({...qs,isPositioned:!1})))},[Ht]);const xs=reactExports.useRef(!1);index(()=>(xs.current=!0,()=>{xs.current=!1}),[]),index(()=>{if(Jr&&(Mn.current=Jr),mn&&($n.current=mn),Jr&&mn){if(Rn.current)return Rn.current(Jr,mn,Qn);Qn()}},[Jr,mn,Qn,Rn,In]);const cs=reactExports.useMemo(()=>({reference:Mn,floating:$n,setReference:$r,setFloating:Br}),[$r,Br]),ks=reactExports.useMemo(()=>({reference:Jr,floating:mn}),[Jr,mn]),_o=reactExports.useMemo(()=>{const qs={position:ut,left:0,top:0};if(!ks.floating)return qs;const Ss=roundByDPR(ks.floating,tr.x),eo=roundByDPR(ks.floating,tr.y);return Bt?{...qs,transform:"translate("+Ss+"px, "+eo+"px)",...getDPR(ks.floating)>=1.5&&{willChange:"transform"}}:{position:ut,left:Ss,top:eo}},[ut,Bt,ks.floating,tr.x,tr.y]);return reactExports.useMemo(()=>({...tr,update:Qn,refs:cs,elements:ks,floatingStyles:_o}),[tr,Qn,cs,ks,_o])}const $7e8f5cd07187803e$export$21b07c8f274aebd5=reactExports.forwardRef((rt,_)=>{const{children:ut,width:mt=10,height:bt=5,...St}=rt;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.svg,_extends$4({},St,{ref:_,width:mt,height:bt,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),rt.asChild?ut:reactExports.createElement("polygon",{points:"0,0 30,0 15,10"}))}),$7e8f5cd07187803e$export$be92b6f5f03c0fe9=$7e8f5cd07187803e$export$21b07c8f274aebd5;function $db6c3485150b8e66$export$1ab7ae714698c4b8(rt){const[_,ut]=reactExports.useState(void 0);return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(rt){ut({width:rt.offsetWidth,height:rt.offsetHeight});const mt=new ResizeObserver(bt=>{if(!Array.isArray(bt)||!bt.length)return;const St=bt[0];let Mt,Bt;if("borderBoxSize"in St){const Ut=St.borderBoxSize,Ht=Array.isArray(Ut)?Ut[0]:Ut;Mt=Ht.inlineSize,Bt=Ht.blockSize}else Mt=rt.offsetWidth,Bt=rt.offsetHeight;ut({width:Mt,height:Bt})});return mt.observe(rt,{box:"border-box"}),()=>mt.unobserve(rt)}else ut(void 0)},[rt]),_}const $cf1ac5d9fe0e8206$var$POPPER_NAME="Popper",[$cf1ac5d9fe0e8206$var$createPopperContext,$cf1ac5d9fe0e8206$export$722aac194ae923]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($cf1ac5d9fe0e8206$var$POPPER_NAME),[$cf1ac5d9fe0e8206$var$PopperProvider,$cf1ac5d9fe0e8206$var$usePopperContext]=$cf1ac5d9fe0e8206$var$createPopperContext($cf1ac5d9fe0e8206$var$POPPER_NAME),$cf1ac5d9fe0e8206$export$badac9ada3a0bdf9=rt=>{const{__scopePopper:_,children:ut}=rt,[mt,bt]=reactExports.useState(null);return reactExports.createElement($cf1ac5d9fe0e8206$var$PopperProvider,{scope:_,anchor:mt,onAnchorChange:bt},ut)},$cf1ac5d9fe0e8206$var$ANCHOR_NAME="PopperAnchor",$cf1ac5d9fe0e8206$export$ecd4e1ccab6ed6d=reactExports.forwardRef((rt,_)=>{const{__scopePopper:ut,virtualRef:mt,...bt}=rt,St=$cf1ac5d9fe0e8206$var$usePopperContext($cf1ac5d9fe0e8206$var$ANCHOR_NAME,ut),Mt=reactExports.useRef(null),Bt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(_,Mt);return reactExports.useEffect(()=>{St.onAnchorChange((mt==null?void 0:mt.current)||Mt.current)}),mt?null:reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$4({},bt,{ref:Bt}))}),$cf1ac5d9fe0e8206$var$CONTENT_NAME="PopperContent",[$cf1ac5d9fe0e8206$var$PopperContentProvider,$cf1ac5d9fe0e8206$var$useContentContext]=$cf1ac5d9fe0e8206$var$createPopperContext($cf1ac5d9fe0e8206$var$CONTENT_NAME),$cf1ac5d9fe0e8206$export$bc4ae5855d3c4fc=reactExports.forwardRef((rt,_)=>{var ut,mt,bt,St,Mt,Bt,Ut,Ht;const{__scopePopper:tr,side:rr="bottom",sideOffset:sr=0,align:ar="center",alignOffset:cr=0,arrowPadding:Ar=0,avoidCollisions:_r=!0,collisionBoundary:Dr=[],collisionPadding:$r=0,sticky:Br="partial",hideWhenDetached:Jr=!1,updatePositionStrategy:mn="optimized",onPlaced:Mn,...$n}=rt,en=$cf1ac5d9fe0e8206$var$usePopperContext($cf1ac5d9fe0e8206$var$CONTENT_NAME,tr),[In,Rn]=reactExports.useState(null),qn=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(_,_g=>Rn(_g)),[Qn,xs]=reactExports.useState(null),cs=$db6c3485150b8e66$export$1ab7ae714698c4b8(Qn),ks=(ut=cs==null?void 0:cs.width)!==null&&ut!==void 0?ut:0,_o=(mt=cs==null?void 0:cs.height)!==null&&mt!==void 0?mt:0,qs=rr+(ar!=="center"?"-"+ar:""),Ss=typeof $r=="number"?$r:{top:0,right:0,bottom:0,left:0,...$r},eo=Array.isArray(Dr)?Dr:[Dr],Ao=eo.length>0,Oo={padding:Ss,boundary:eo.filter($cf1ac5d9fe0e8206$var$isNotNull),altBoundary:Ao},{refs:uo,floatingStyles:uu,placement:cu,isPositioned:Jl,middlewareData:mu}=useFloating({strategy:"fixed",placement:qs,whileElementsMounted:(..._g)=>autoUpdate(..._g,{animationFrame:mn==="always"}),elements:{reference:en.anchor},middleware:[offset({mainAxis:sr+_o,alignmentAxis:cr}),_r&&shift({mainAxis:!0,crossAxis:!1,limiter:Br==="partial"?limitShift():void 0,...Oo}),_r&&flip({...Oo}),size({...Oo,apply:({elements:_g,rects:m0,availableWidth:K0,availableHeight:Jp})=>{const{width:y0,height:z0}=m0.reference,jm=_g.floating.style;jm.setProperty("--radix-popper-available-width",`${K0}px`),jm.setProperty("--radix-popper-available-height",`${Jp}px`),jm.setProperty("--radix-popper-anchor-width",`${y0}px`),jm.setProperty("--radix-popper-anchor-height",`${z0}px`)}}),Qn&&arrow({element:Qn,padding:Ar}),$cf1ac5d9fe0e8206$var$transformOrigin({arrowWidth:ks,arrowHeight:_o}),Jr&&hide({strategy:"referenceHidden",...Oo})]}),[pu,Zu]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(cu),Mp=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Mn);$9f79659886946c16$export$e5c5a5f917a5871c(()=>{Jl&&(Mp==null||Mp())},[Jl,Mp]);const Up=(bt=mu.arrow)===null||bt===void 0?void 0:bt.x,Ep=(St=mu.arrow)===null||St===void 0?void 0:St.y,mp=((Mt=mu.arrow)===null||Mt===void 0?void 0:Mt.centerOffset)!==0,[Cp,t0]=reactExports.useState();return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{In&&t0(window.getComputedStyle(In).zIndex)},[In]),reactExports.createElement("div",{ref:uo.setFloating,"data-radix-popper-content-wrapper":"",style:{...uu,transform:Jl?uu.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Cp,"--radix-popper-transform-origin":[(Bt=mu.transformOrigin)===null||Bt===void 0?void 0:Bt.x,(Ut=mu.transformOrigin)===null||Ut===void 0?void 0:Ut.y].join(" ")},dir:rt.dir},reactExports.createElement($cf1ac5d9fe0e8206$var$PopperContentProvider,{scope:tr,placedSide:pu,onArrowChange:xs,arrowX:Up,arrowY:Ep,shouldHideArrow:mp},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$4({"data-side":pu,"data-align":Zu},$n,{ref:qn,style:{...$n.style,animation:Jl?void 0:"none",opacity:(Ht=mu.hide)!==null&&Ht!==void 0&&Ht.referenceHidden?0:void 0}}))))}),$cf1ac5d9fe0e8206$var$ARROW_NAME="PopperArrow",$cf1ac5d9fe0e8206$var$OPPOSITE_SIDE={top:"bottom",right:"left",bottom:"top",left:"right"},$cf1ac5d9fe0e8206$export$79d62cd4e10a3fd0=reactExports.forwardRef(function rt(_,ut){const{__scopePopper:mt,...bt}=_,St=$cf1ac5d9fe0e8206$var$useContentContext($cf1ac5d9fe0e8206$var$ARROW_NAME,mt),Mt=$cf1ac5d9fe0e8206$var$OPPOSITE_SIDE[St.placedSide];return reactExports.createElement("span",{ref:St.onArrowChange,style:{position:"absolute",left:St.arrowX,top:St.arrowY,[Mt]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[St.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[St.placedSide],visibility:St.shouldHideArrow?"hidden":void 0}},reactExports.createElement($7e8f5cd07187803e$export$be92b6f5f03c0fe9,_extends$4({},bt,{ref:ut,style:{...bt.style,display:"block"}})))});function $cf1ac5d9fe0e8206$var$isNotNull(rt){return rt!==null}const $cf1ac5d9fe0e8206$var$transformOrigin=rt=>({name:"transformOrigin",options:rt,fn(_){var ut,mt,bt,St,Mt;const{placement:Bt,rects:Ut,middlewareData:Ht}=_,rr=((ut=Ht.arrow)===null||ut===void 0?void 0:ut.centerOffset)!==0,sr=rr?0:rt.arrowWidth,ar=rr?0:rt.arrowHeight,[cr,Ar]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(Bt),_r={start:"0%",center:"50%",end:"100%"}[Ar],Dr=((mt=(bt=Ht.arrow)===null||bt===void 0?void 0:bt.x)!==null&&mt!==void 0?mt:0)+sr/2,$r=((St=(Mt=Ht.arrow)===null||Mt===void 0?void 0:Mt.y)!==null&&St!==void 0?St:0)+ar/2;let Br="",Jr="";return cr==="bottom"?(Br=rr?_r:`${Dr}px`,Jr=`${-ar}px`):cr==="top"?(Br=rr?_r:`${Dr}px`,Jr=`${Ut.floating.height+ar}px`):cr==="right"?(Br=`${-ar}px`,Jr=rr?_r:`${$r}px`):cr==="left"&&(Br=`${Ut.floating.width+ar}px`,Jr=rr?_r:`${$r}px`),{data:{x:Br,y:Jr}}}});function $cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(rt){const[_,ut="center"]=rt.split("-");return[_,ut]}const $cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9=$cf1ac5d9fe0e8206$export$badac9ada3a0bdf9,$cf1ac5d9fe0e8206$export$b688253958b8dfe7=$cf1ac5d9fe0e8206$export$ecd4e1ccab6ed6d,$cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2=$cf1ac5d9fe0e8206$export$bc4ae5855d3c4fc,$cf1ac5d9fe0e8206$export$21b07c8f274aebd5=$cf1ac5d9fe0e8206$export$79d62cd4e10a3fd0;function $fe963b355347cc68$export$3e6543de14f8614f(rt,_){return reactExports.useReducer((ut,mt)=>{const bt=_[ut][mt];return bt??ut},rt)}const $921a889cee6df7e8$export$99c2b779aa4e8b8b=rt=>{const{present:_,children:ut}=rt,mt=$921a889cee6df7e8$var$usePresence(_),bt=typeof ut=="function"?ut({present:mt.isPresent}):reactExports.Children.only(ut),St=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(mt.ref,bt.ref);return typeof ut=="function"||mt.isPresent?reactExports.cloneElement(bt,{ref:St}):null};$921a889cee6df7e8$export$99c2b779aa4e8b8b.displayName="Presence";function $921a889cee6df7e8$var$usePresence(rt){const[_,ut]=reactExports.useState(),mt=reactExports.useRef({}),bt=reactExports.useRef(rt),St=reactExports.useRef("none"),Mt=rt?"mounted":"unmounted",[Bt,Ut]=$fe963b355347cc68$export$3e6543de14f8614f(Mt,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const Ht=$921a889cee6df7e8$var$getAnimationName(mt.current);St.current=Bt==="mounted"?Ht:"none"},[Bt]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{const Ht=mt.current,tr=bt.current;if(tr!==rt){const sr=St.current,ar=$921a889cee6df7e8$var$getAnimationName(Ht);rt?Ut("MOUNT"):ar==="none"||(Ht==null?void 0:Ht.display)==="none"?Ut("UNMOUNT"):Ut(tr&&sr!==ar?"ANIMATION_OUT":"UNMOUNT"),bt.current=rt}},[rt,Ut]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(_){const Ht=rr=>{const ar=$921a889cee6df7e8$var$getAnimationName(mt.current).includes(rr.animationName);rr.target===_&&ar&&reactDomExports.flushSync(()=>Ut("ANIMATION_END"))},tr=rr=>{rr.target===_&&(St.current=$921a889cee6df7e8$var$getAnimationName(mt.current))};return _.addEventListener("animationstart",tr),_.addEventListener("animationcancel",Ht),_.addEventListener("animationend",Ht),()=>{_.removeEventListener("animationstart",tr),_.removeEventListener("animationcancel",Ht),_.removeEventListener("animationend",Ht)}}else Ut("ANIMATION_END")},[_,Ut]),{isPresent:["mounted","unmountSuspended"].includes(Bt),ref:reactExports.useCallback(Ht=>{Ht&&(mt.current=getComputedStyle(Ht)),ut(Ht)},[])}}function $921a889cee6df7e8$var$getAnimationName(rt){return(rt==null?void 0:rt.animationName)||"none"}function $71cd76cc60e0454e$export$6f32135080cb4c3({prop:rt,defaultProp:_,onChange:ut=()=>{}}){const[mt,bt]=$71cd76cc60e0454e$var$useUncontrolledState({defaultProp:_,onChange:ut}),St=rt!==void 0,Mt=St?rt:mt,Bt=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(ut),Ut=reactExports.useCallback(Ht=>{if(St){const rr=typeof Ht=="function"?Ht(rt):Ht;rr!==rt&&Bt(rr)}else bt(Ht)},[St,rt,bt,Bt]);return[Mt,Ut]}function $71cd76cc60e0454e$var$useUncontrolledState({defaultProp:rt,onChange:_}){const ut=reactExports.useState(rt),[mt]=ut,bt=reactExports.useRef(mt),St=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(_);return reactExports.useEffect(()=>{bt.current!==mt&&(St(mt),bt.current=mt)},[mt,bt,St]),ut}const $ea1ef594cf570d83$export$439d29a4e110a164=reactExports.forwardRef((rt,_)=>reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$4({},rt,{ref:_,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...rt.style}}))),$ea1ef594cf570d83$export$be92b6f5f03c0fe9=$ea1ef594cf570d83$export$439d29a4e110a164,[$a093c7e1ec25a057$var$createTooltipContext,$a093c7e1ec25a057$export$1c540a2224f0d865]=$c512c27ab02ef895$export$50c7b4e9d9f19c1("Tooltip",[$cf1ac5d9fe0e8206$export$722aac194ae923]),$a093c7e1ec25a057$var$usePopperScope=$cf1ac5d9fe0e8206$export$722aac194ae923(),$a093c7e1ec25a057$var$PROVIDER_NAME="TooltipProvider",$a093c7e1ec25a057$var$TOOLTIP_OPEN="tooltip.open",[$a093c7e1ec25a057$var$TooltipProviderContextProvider,$a093c7e1ec25a057$var$useTooltipProviderContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$PROVIDER_NAME),$a093c7e1ec25a057$var$TOOLTIP_NAME="Tooltip",[$a093c7e1ec25a057$var$TooltipContextProvider,$a093c7e1ec25a057$var$useTooltipContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$TOOLTIP_NAME),$a093c7e1ec25a057$export$28c660c63b792dea=rt=>{const{__scopeTooltip:_,children:ut,open:mt,defaultOpen:bt=!1,onOpenChange:St,disableHoverableContent:Mt,delayDuration:Bt}=rt,Ut=$a093c7e1ec25a057$var$useTooltipProviderContext($a093c7e1ec25a057$var$TOOLTIP_NAME,rt.__scopeTooltip),Ht=$a093c7e1ec25a057$var$usePopperScope(_),[tr,rr]=reactExports.useState(null),sr=$1746a345f3d73bb7$export$f680877a34711e37(),ar=reactExports.useRef(0),cr=Mt??Ut.disableHoverableContent,Ar=Bt??Ut.delayDuration,_r=reactExports.useRef(!1),[Dr=!1,$r]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:mt,defaultProp:bt,onChange:$n=>{$n?(Ut.onOpen(),document.dispatchEvent(new CustomEvent($a093c7e1ec25a057$var$TOOLTIP_OPEN))):Ut.onClose(),St==null||St($n)}}),Br=reactExports.useMemo(()=>Dr?_r.current?"delayed-open":"instant-open":"closed",[Dr]),Jr=reactExports.useCallback(()=>{window.clearTimeout(ar.current),_r.current=!1,$r(!0)},[$r]),mn=reactExports.useCallback(()=>{window.clearTimeout(ar.current),$r(!1)},[$r]),Mn=reactExports.useCallback(()=>{window.clearTimeout(ar.current),ar.current=window.setTimeout(()=>{_r.current=!0,$r(!0)},Ar)},[Ar,$r]);return reactExports.useEffect(()=>()=>window.clearTimeout(ar.current),[]),reactExports.createElement($cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,Ht,reactExports.createElement($a093c7e1ec25a057$var$TooltipContextProvider,{scope:_,contentId:sr,open:Dr,stateAttribute:Br,trigger:tr,onTriggerChange:rr,onTriggerEnter:reactExports.useCallback(()=>{Ut.isOpenDelayed?Mn():Jr()},[Ut.isOpenDelayed,Mn,Jr]),onTriggerLeave:reactExports.useCallback(()=>{cr?mn():window.clearTimeout(ar.current)},[mn,cr]),onOpen:Jr,onClose:mn,disableHoverableContent:cr},ut))},$a093c7e1ec25a057$var$TRIGGER_NAME="TooltipTrigger",$a093c7e1ec25a057$export$8c610744efcf8a1d=reactExports.forwardRef((rt,_)=>{const{__scopeTooltip:ut,...mt}=rt,bt=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$TRIGGER_NAME,ut),St=$a093c7e1ec25a057$var$useTooltipProviderContext($a093c7e1ec25a057$var$TRIGGER_NAME,ut),Mt=$a093c7e1ec25a057$var$usePopperScope(ut),Bt=reactExports.useRef(null),Ut=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(_,Bt,bt.onTriggerChange),Ht=reactExports.useRef(!1),tr=reactExports.useRef(!1),rr=reactExports.useCallback(()=>Ht.current=!1,[]);return reactExports.useEffect(()=>()=>document.removeEventListener("pointerup",rr),[rr]),reactExports.createElement($cf1ac5d9fe0e8206$export$b688253958b8dfe7,_extends$4({asChild:!0},Mt),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$4({"aria-describedby":bt.open?bt.contentId:void 0,"data-state":bt.stateAttribute},mt,{ref:Ut,onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(rt.onPointerMove,sr=>{sr.pointerType!=="touch"&&!tr.current&&!St.isPointerInTransitRef.current&&(bt.onTriggerEnter(),tr.current=!0)}),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(rt.onPointerLeave,()=>{bt.onTriggerLeave(),tr.current=!1}),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(rt.onPointerDown,()=>{Ht.current=!0,document.addEventListener("pointerup",rr,{once:!0})}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(rt.onFocus,()=>{Ht.current||bt.onOpen()}),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(rt.onBlur,bt.onClose),onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(rt.onClick,bt.onClose)})))}),$a093c7e1ec25a057$var$PORTAL_NAME="TooltipPortal",[$a093c7e1ec25a057$var$PortalProvider,$a093c7e1ec25a057$var$usePortalContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$PORTAL_NAME,{forceMount:void 0}),$a093c7e1ec25a057$var$CONTENT_NAME="TooltipContent",$a093c7e1ec25a057$export$e9003e2be37ec060=reactExports.forwardRef((rt,_)=>{const ut=$a093c7e1ec25a057$var$usePortalContext($a093c7e1ec25a057$var$CONTENT_NAME,rt.__scopeTooltip),{forceMount:mt=ut.forceMount,side:bt="top",...St}=rt,Mt=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$CONTENT_NAME,rt.__scopeTooltip);return reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:mt||Mt.open},Mt.disableHoverableContent?reactExports.createElement($a093c7e1ec25a057$var$TooltipContentImpl,_extends$4({side:bt},St,{ref:_})):reactExports.createElement($a093c7e1ec25a057$var$TooltipContentHoverable,_extends$4({side:bt},St,{ref:_})))}),$a093c7e1ec25a057$var$TooltipContentHoverable=reactExports.forwardRef((rt,_)=>{const ut=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$CONTENT_NAME,rt.__scopeTooltip),mt=$a093c7e1ec25a057$var$useTooltipProviderContext($a093c7e1ec25a057$var$CONTENT_NAME,rt.__scopeTooltip),bt=reactExports.useRef(null),St=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(_,bt),[Mt,Bt]=reactExports.useState(null),{trigger:Ut,onClose:Ht}=ut,tr=bt.current,{onPointerInTransitChange:rr}=mt,sr=reactExports.useCallback(()=>{Bt(null),rr(!1)},[rr]),ar=reactExports.useCallback((cr,Ar)=>{const _r=cr.currentTarget,Dr={x:cr.clientX,y:cr.clientY},$r=$a093c7e1ec25a057$var$getExitSideFromRect(Dr,_r.getBoundingClientRect()),Br=$a093c7e1ec25a057$var$getPaddedExitPoints(Dr,$r),Jr=$a093c7e1ec25a057$var$getPointsFromRect(Ar.getBoundingClientRect()),mn=$a093c7e1ec25a057$var$getHull([...Br,...Jr]);Bt(mn),rr(!0)},[rr]);return reactExports.useEffect(()=>()=>sr(),[sr]),reactExports.useEffect(()=>{if(Ut&&tr){const cr=_r=>ar(_r,tr),Ar=_r=>ar(_r,Ut);return Ut.addEventListener("pointerleave",cr),tr.addEventListener("pointerleave",Ar),()=>{Ut.removeEventListener("pointerleave",cr),tr.removeEventListener("pointerleave",Ar)}}},[Ut,tr,ar,sr]),reactExports.useEffect(()=>{if(Mt){const cr=Ar=>{const _r=Ar.target,Dr={x:Ar.clientX,y:Ar.clientY},$r=(Ut==null?void 0:Ut.contains(_r))||(tr==null?void 0:tr.contains(_r)),Br=!$a093c7e1ec25a057$var$isPointInPolygon(Dr,Mt);$r?sr():Br&&(sr(),Ht())};return document.addEventListener("pointermove",cr),()=>document.removeEventListener("pointermove",cr)}},[Ut,tr,Mt,Ht,sr]),reactExports.createElement($a093c7e1ec25a057$var$TooltipContentImpl,_extends$4({},rt,{ref:St}))}),[$a093c7e1ec25a057$var$VisuallyHiddenContentContextProvider,$a093c7e1ec25a057$var$useVisuallyHiddenContentContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$TOOLTIP_NAME,{isInside:!1}),$a093c7e1ec25a057$var$TooltipContentImpl=reactExports.forwardRef((rt,_)=>{const{__scopeTooltip:ut,children:mt,"aria-label":bt,onEscapeKeyDown:St,onPointerDownOutside:Mt,...Bt}=rt,Ut=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$CONTENT_NAME,ut),Ht=$a093c7e1ec25a057$var$usePopperScope(ut),{onClose:tr}=Ut;return reactExports.useEffect(()=>(document.addEventListener($a093c7e1ec25a057$var$TOOLTIP_OPEN,tr),()=>document.removeEventListener($a093c7e1ec25a057$var$TOOLTIP_OPEN,tr)),[tr]),reactExports.useEffect(()=>{if(Ut.trigger){const rr=sr=>{const ar=sr.target;ar!=null&&ar.contains(Ut.trigger)&&tr()};return window.addEventListener("scroll",rr,{capture:!0}),()=>window.removeEventListener("scroll",rr,{capture:!0})}},[Ut.trigger,tr]),reactExports.createElement($5cb92bef7577960e$export$177fb62ff3ec1f22,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:St,onPointerDownOutside:Mt,onFocusOutside:rr=>rr.preventDefault(),onDismiss:tr},reactExports.createElement($cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2,_extends$4({"data-state":Ut.stateAttribute},Ht,Bt,{ref:_,style:{...Bt.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}}),reactExports.createElement($5e63c961fc1ce211$export$d9f1ccf0bdb05d45,null,mt),reactExports.createElement($a093c7e1ec25a057$var$VisuallyHiddenContentContextProvider,{scope:ut,isInside:!0},reactExports.createElement($ea1ef594cf570d83$export$be92b6f5f03c0fe9,{id:Ut.contentId,role:"tooltip"},bt||mt))))}),$a093c7e1ec25a057$var$ARROW_NAME="TooltipArrow",$a093c7e1ec25a057$export$c27ee0ad710f7559=reactExports.forwardRef((rt,_)=>{const{__scopeTooltip:ut,...mt}=rt,bt=$a093c7e1ec25a057$var$usePopperScope(ut);return $a093c7e1ec25a057$var$useVisuallyHiddenContentContext($a093c7e1ec25a057$var$ARROW_NAME,ut).isInside?null:reactExports.createElement($cf1ac5d9fe0e8206$export$21b07c8f274aebd5,_extends$4({},bt,mt,{ref:_}))});function $a093c7e1ec25a057$var$getExitSideFromRect(rt,_){const ut=Math.abs(_.top-rt.y),mt=Math.abs(_.bottom-rt.y),bt=Math.abs(_.right-rt.x),St=Math.abs(_.left-rt.x);switch(Math.min(ut,mt,bt,St)){case St:return"left";case bt:return"right";case ut:return"top";case mt:return"bottom";default:throw new Error("unreachable")}}function $a093c7e1ec25a057$var$getPaddedExitPoints(rt,_,ut=5){const mt=[];switch(_){case"top":mt.push({x:rt.x-ut,y:rt.y+ut},{x:rt.x+ut,y:rt.y+ut});break;case"bottom":mt.push({x:rt.x-ut,y:rt.y-ut},{x:rt.x+ut,y:rt.y-ut});break;case"left":mt.push({x:rt.x+ut,y:rt.y-ut},{x:rt.x+ut,y:rt.y+ut});break;case"right":mt.push({x:rt.x-ut,y:rt.y-ut},{x:rt.x-ut,y:rt.y+ut});break}return mt}function $a093c7e1ec25a057$var$getPointsFromRect(rt){const{top:_,right:ut,bottom:mt,left:bt}=rt;return[{x:bt,y:_},{x:ut,y:_},{x:ut,y:mt},{x:bt,y:mt}]}function $a093c7e1ec25a057$var$isPointInPolygon(rt,_){const{x:ut,y:mt}=rt;let bt=!1;for(let St=0,Mt=_.length-1;St<_.length;Mt=St++){const Bt=_[St].x,Ut=_[St].y,Ht=_[Mt].x,tr=_[Mt].y;Ut>mt!=tr>mt&&ut<(Ht-Bt)*(mt-Ut)/(tr-Ut)+Bt&&(bt=!bt)}return bt}function $a093c7e1ec25a057$var$getHull(rt){const _=rt.slice();return _.sort((ut,mt)=>ut.x<mt.x?-1:ut.x>mt.x?1:ut.y<mt.y?-1:ut.y>mt.y?1:0),$a093c7e1ec25a057$var$getHullPresorted(_)}function $a093c7e1ec25a057$var$getHullPresorted(rt){if(rt.length<=1)return rt.slice();const _=[];for(let mt=0;mt<rt.length;mt++){const bt=rt[mt];for(;_.length>=2;){const St=_[_.length-1],Mt=_[_.length-2];if((St.x-Mt.x)*(bt.y-Mt.y)>=(St.y-Mt.y)*(bt.x-Mt.x))_.pop();else break}_.push(bt)}_.pop();const ut=[];for(let mt=rt.length-1;mt>=0;mt--){const bt=rt[mt];for(;ut.length>=2;){const St=ut[ut.length-1],Mt=ut[ut.length-2];if((St.x-Mt.x)*(bt.y-Mt.y)>=(St.y-Mt.y)*(bt.x-Mt.x))ut.pop();else break}ut.push(bt)}return ut.pop(),_.length===1&&ut.length===1&&_[0].x===ut[0].x&&_[0].y===ut[0].y?_:_.concat(ut)}const $a093c7e1ec25a057$export$be92b6f5f03c0fe9=$a093c7e1ec25a057$export$28c660c63b792dea,$a093c7e1ec25a057$export$41fb9f06171c75f4=$a093c7e1ec25a057$export$8c610744efcf8a1d,$a093c7e1ec25a057$export$7c6e2c02157bb7d2=$a093c7e1ec25a057$export$e9003e2be37ec060,$a093c7e1ec25a057$export$21b07c8f274aebd5=$a093c7e1ec25a057$export$c27ee0ad710f7559;function _objectWithoutPropertiesLoose$1(rt,_){if(rt==null)return{};var ut={},mt=Object.keys(rt),bt,St;for(St=0;St<mt.length;St++)bt=mt[St],!(_.indexOf(bt)>=0)&&(ut[bt]=rt[bt]);return ut}function _objectWithoutProperties$1(rt,_){if(rt==null)return{};var ut=_objectWithoutPropertiesLoose$1(rt,_),mt,bt;if(Object.getOwnPropertySymbols){var St=Object.getOwnPropertySymbols(rt);for(bt=0;bt<St.length;bt++)mt=St[bt],!(_.indexOf(mt)>=0)&&Object.prototype.propertyIsEnumerable.call(rt,mt)&&(ut[mt]=rt[mt])}return ut}let LevaErrors;(function(rt){rt[rt.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",rt[rt.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",rt[rt.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",rt[rt.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",rt[rt.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",rt[rt.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",rt[rt.THEME_ERROR=6]="THEME_ERROR",rt[rt.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",rt[rt.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",rt[rt.EMPTY_KEY=9]="EMPTY_KEY"})(LevaErrors||(LevaErrors={}));const ErrorList={[LevaErrors.UNSUPPORTED_INPUT]:(rt,_)=>[`An input with type \`${rt}\` input was found at path \`${_}\` but it's not supported yet.`],[LevaErrors.NO_COMPONENT_FOR_TYPE]:(rt,_)=>[`Type \`${rt}\` found at path \`${_}\` can't be displayed in panel because no component supports it yet.`],[LevaErrors.UNKNOWN_INPUT]:(rt,_)=>[`input at path \`${rt}\` is not recognized.`,_],[LevaErrors.DUPLICATE_KEYS]:(rt,_,ut)=>[`Key \`${rt}\` of path \`${_}\` already exists at path \`${ut}\`. Even nested keys need to be unique. Rename one of the keys.`],[LevaErrors.ALREADY_REGISTERED_TYPE]:rt=>[`Type ${rt} has already been registered. You can't register a component with the same type.`],[LevaErrors.CLIPBOARD_ERROR]:rt=>["Error copying the value",rt],[LevaErrors.THEME_ERROR]:(rt,_)=>[`Error accessing the theme \`${rt}.${_}\` value.`],[LevaErrors.PATH_DOESNT_EXIST]:rt=>[`Error getting the value at path \`${rt}\`. There is probably an error in your \`render\` function.`],[LevaErrors.PATH_DOESNT_EXIST]:rt=>[`Error accessing the value at path \`${rt}\``],[LevaErrors.INPUT_TYPE_OVERRIDE]:(rt,_,ut)=>[`Input at path \`${rt}\` already exists with type: \`${_}\`. Its type cannot be overridden with type \`${ut}\`.`],[LevaErrors.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function _log(rt,_,...ut){const[mt,...bt]=ErrorList[_](...ut);console[rt]("LEVA: "+mt,...bt)}const warn=_log.bind(null,"warn"),log=_log.bind(null,"log"),_excluded$a=["value"],_excluded2$4=["schema"],_excluded3$1=["value"],Schemas=[],Plugins={};function getValueType(rt){let{value:_}=rt,ut=_objectWithoutProperties$1(rt,_excluded$a);for(let mt of Schemas){const bt=mt(_,ut);if(bt)return bt}}function register(rt,_){let{schema:ut}=_,mt=_objectWithoutProperties$1(_,_excluded2$4);if(rt in Plugins){warn(LevaErrors.ALREADY_REGISTERED_TYPE,rt);return}Schemas.push((bt,St)=>ut(bt,St)&&rt),Plugins[rt]=mt}function createInternalPlugin(rt){return rt}function normalize$3$1(rt,_,ut,mt){const{normalize:bt}=Plugins[rt];if(bt)return bt(_,ut,mt);if(typeof _!="object"||!("value"in _))return{value:_};const{value:St}=_,Mt=_objectWithoutProperties$1(_,_excluded3$1);return{value:St,settings:Mt}}function sanitize$4(rt,_,ut,mt,bt,St){const{sanitize:Mt}=Plugins[rt];return Mt?Mt(_,ut,mt,bt,St):_}function format$2(rt,_,ut){const{format:mt}=Plugins[rt];return mt?mt(_,ut):_}function _defineProperty$2(rt,_,ut){return _ in rt?Object.defineProperty(rt,_,{value:ut,enumerable:!0,configurable:!0,writable:!0}):rt[_]=ut,rt}function ownKeys$2(rt,_){var ut=Object.keys(rt);if(Object.getOwnPropertySymbols){var mt=Object.getOwnPropertySymbols(rt);_&&(mt=mt.filter(function(bt){return Object.getOwnPropertyDescriptor(rt,bt).enumerable})),ut.push.apply(ut,mt)}return ut}function _objectSpread2(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_]!=null?arguments[_]:{};_%2?ownKeys$2(Object(ut),!0).forEach(function(mt){_defineProperty$2(rt,mt,ut[mt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(rt,Object.getOwnPropertyDescriptors(ut)):ownKeys$2(Object(ut)).forEach(function(mt){Object.defineProperty(rt,mt,Object.getOwnPropertyDescriptor(ut,mt))})}return rt}const clamp$1=(rt,_,ut)=>rt>ut?ut:rt<_?_:rt,parseNumber=rt=>{if(rt===""||typeof rt=="number")return rt;try{const _=evaluate(rt);if(!isNaN(_))return _}catch{}return parseFloat(rt)},log10=Math.log(10);function getStep(rt){let _=Math.abs(+String(rt).replace(".",""));if(_===0)return .01;for(;_!==0&&_%10===0;)_/=10;const ut=Math.floor(Math.log(_)/log10)+1,mt=Math.floor(Math.log10(Math.abs(rt))),bt=Math.pow(10,mt-ut);return Math.max(bt,.001)}const range=(rt,_,ut)=>ut===_?0:(clamp$1(rt,_,ut)-_)/(ut-_),invertedRange=(rt,_,ut)=>rt*(ut-_)+_,getUid=()=>"_"+Math.random().toString(36).substr(2,9),parens=/\(([0-9+\-*/^ .]+)\)/,exp=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,mul=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,div=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,add$1=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,sub=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function evaluate(rt){if(isNaN(Number(rt)))if(parens.test(rt)){const _=rt.replace(parens,(ut,mt)=>String(evaluate(mt)));return evaluate(_)}else if(exp.test(rt)){const _=rt.replace(exp,(ut,mt,bt)=>String(Math.pow(Number(mt),Number(bt))));return evaluate(_)}else if(mul.test(rt)){const _=rt.replace(mul,(ut,mt,bt)=>String(Number(mt)*Number(bt)));return evaluate(_)}else if(div.test(rt)){const _=rt.replace(div,(ut,mt,bt)=>{if(bt!=0)return String(Number(mt)/Number(bt));throw new Error("Division by zero")});return evaluate(_)}else if(add$1.test(rt)){const _=rt.replace(add$1,(ut,mt,bt)=>String(Number(mt)+Number(bt)));return evaluate(_)}else if(sub.test(rt)){const _=rt.replace(sub,(ut,mt,bt)=>String(Number(mt)-Number(bt)));return evaluate(_)}else return Number(rt);return Number(rt)}function pick(rt,_){return _.reduce((ut,mt)=>(rt&&rt.hasOwnProperty(mt)&&(ut[mt]=rt[mt]),ut),{})}function omit(rt,_){const ut=_objectSpread2({},rt);return _.forEach(mt=>mt in rt&&delete ut[mt]),ut}function mapArrayToKeys(rt,_){return rt.reduce((ut,mt,bt)=>Object.assign(ut,{[_[bt]]:mt}),{})}function isObject$8(rt){return Object.prototype.toString.call(rt)==="[object Object]"}const isEmptyObject=rt=>isObject$8(rt)&&Object.keys(rt).length===0;let SpecialInputs;(function(rt){rt.BUTTON="BUTTON",rt.BUTTON_GROUP="BUTTON_GROUP",rt.MONITOR="MONITOR",rt.FOLDER="FOLDER"})(SpecialInputs||(SpecialInputs={}));let LevaInputs;(function(rt){rt.SELECT="SELECT",rt.IMAGE="IMAGE",rt.NUMBER="NUMBER",rt.COLOR="COLOR",rt.STRING="STRING",rt.BOOLEAN="BOOLEAN",rt.INTERVAL="INTERVAL",rt.VECTOR3D="VECTOR3D",rt.VECTOR2D="VECTOR2D"})(LevaInputs||(LevaInputs={}));const _excluded$9=["type","__customInput"],_excluded2$3=["render","label","optional","order","disabled","hint","onChange","onEditStart","onEditEnd","transient"],_excluded3$2=["type"];function parseOptions(rt,_,ut={},mt){var bt,St;if(typeof rt!="object"||Array.isArray(rt))return{type:mt,input:rt,options:_objectSpread2({key:_,label:_,optional:!1,disabled:!1,order:0},ut)};if("__customInput"in rt){const{type:mn,__customInput:Mn}=rt,$n=_objectWithoutProperties$1(rt,_excluded$9);return parseOptions(Mn,_,$n,mn)}const{render:Mt,label:Bt,optional:Ut,order:Ht=0,disabled:tr,hint:rr,onChange:sr,onEditStart:ar,onEditEnd:cr,transient:Ar}=rt,_r=_objectWithoutProperties$1(rt,_excluded2$3),Dr=_objectSpread2({render:Mt,key:_,label:Bt??_,hint:rr,transient:Ar??!!sr,onEditStart:ar,onEditEnd:cr,disabled:tr,optional:Ut,order:Ht},ut);let{type:$r}=_r,Br=_objectWithoutProperties$1(_r,_excluded3$2);if($r=mt??$r,$r in SpecialInputs)return{type:$r,input:Br,options:Dr};let Jr;return mt&&isObject$8(Br)&&"value"in Br?Jr=Br.value:Jr=isEmptyObject(Br)?void 0:Br,{type:$r,input:Jr,options:_objectSpread2(_objectSpread2({},Dr),{},{onChange:sr,optional:(bt=Dr.optional)!==null&&bt!==void 0?bt:!1,disabled:(St=Dr.disabled)!==null&&St!==void 0?St:!1})}}function normalizeInput(rt,_,ut,mt){const bt=parseOptions(rt,_),{type:St,input:Mt,options:Bt}=bt;if(St)return St in SpecialInputs?bt:{type:St,input:normalize$3$1(St,Mt,ut,mt),options:Bt};let Ut=getValueType(Mt);return Ut?{type:Ut,input:normalize$3$1(Ut,Mt,ut,mt),options:Bt}:(Ut=getValueType({value:Mt}),Ut?{type:Ut,input:normalize$3$1(Ut,{value:Mt},ut,mt),options:Bt}:!1)}function updateInput(rt,_,ut,mt,bt){const{value:St,type:Mt,settings:Bt}=rt;rt.value=sanitizeValue({type:Mt,value:St,settings:Bt},_,ut,mt),rt.fromPanel=bt}const ValueError=function rt(_,ut,mt){this.type="LEVA_ERROR",this.message="LEVA: "+_,this.previousValue=ut,this.error=mt};function sanitizeValue({type:rt,value:_,settings:ut},mt,bt,St){const Mt=rt!=="SELECT"&&typeof mt=="function"?mt(_):mt;let Bt;try{Bt=sanitize$4(rt,Mt,ut,_,bt,St)}catch(Ut){throw new ValueError(`The value \`${mt}\` did not result in a correct value.`,_,Ut)}return dequal(Bt,_)?_:Bt}const debounce=(rt,_,ut=!1)=>{let mt=0;return function(){const bt=arguments,St=ut&&!mt,Mt=()=>rt.apply(this,bt);window.clearTimeout(mt),mt=window.setTimeout(Mt,_),St&&Mt()}},multiplyStep=rt=>rt.shiftKey?5:rt.altKey?1/5:1;function render(rt,_){const ut=console.error;console.error=()=>{},ReactDOM.render(rt,_),console.error=ut}const _excluded$8=["value"],_excluded2$2$1=["min","max"],schema$3=rt=>{if(typeof rt=="number")return!0;if(typeof rt=="string"){const _=parseFloat(rt);return isNaN(_)?!1:rt.substring((""+_).length).trim().length<4}return!1},sanitize$3=(rt,{min:_=-1/0,max:ut=1/0,suffix:mt})=>{const bt=parseFloat(rt);if(rt===""||isNaN(bt))throw Error("Invalid number");const St=clamp$1(bt,_,ut);return mt?St+mt:St},format$1$1=(rt,{pad:_=0,suffix:ut})=>{const mt=parseFloat(rt).toFixed(_);return ut?mt+ut:mt},normalize$2$1=rt=>{let{value:_}=rt,ut=_objectWithoutProperties$1(rt,_excluded$8);const{min:mt=-1/0,max:bt=1/0}=ut,St=_objectWithoutProperties$1(ut,_excluded2$2$1);let Mt=parseFloat(_);const Bt=typeof _=="string"?_.substring((""+Mt).length):void 0;Mt=clamp$1(Mt,mt,bt);let Ut=ut.step;Ut||(Number.isFinite(mt)?Number.isFinite(bt)?Ut=+(Math.abs(bt-mt)/100).toPrecision(1):Ut=+(Math.abs(Mt-mt)/100).toPrecision(1):Number.isFinite(bt)&&(Ut=+(Math.abs(bt-Mt)/100).toPrecision(1)));const Ht=Ut?getStep(Ut)*10:getStep(Mt);Ut=Ut||Ht/10;const tr=Math.round(clamp$1(Math.log10(1/Ht),0,2));return{value:Bt?Mt+Bt:Mt,settings:_objectSpread2({initialValue:Mt,step:Ut,pad:tr,min:mt,max:bt,suffix:Bt},St)}},sanitizeStep$1=(rt,{step:_,initialValue:ut})=>{const mt=Math.round((rt-ut)/_);return ut+mt*_};var props$3=Object.freeze({__proto__:null,schema:schema$3,sanitize:sanitize$3,format:format$1$1,normalize:normalize$2$1,sanitizeStep:sanitizeStep$1});function _extends(){return _extends=Object.assign?Object.assign.bind():function(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_];for(var mt in ut)Object.prototype.hasOwnProperty.call(ut,mt)&&(rt[mt]=ut[mt])}return rt},_extends.apply(this,arguments)}const InputContext=reactExports.createContext({});function useInputContext(){return reactExports.useContext(InputContext)}const ThemeContext=reactExports.createContext(null),StoreContext=reactExports.createContext(null),PanelSettingsContext=reactExports.createContext(null);function useStoreContext(){return reactExports.useContext(StoreContext)}function usePanelSettingsContext(){return reactExports.useContext(PanelSettingsContext)}const getDefaultTheme=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function createStateClass(rt,_){const[ut,mt]=rt.split(" "),bt={};return ut!=="none"&&(bt.boxShadow=`${_.inset?"inset ":""}0 0 0 $borderWidths${[_.key]} $colors${ut!=="default"&&ut||_.borderColor}`),mt&&(bt.backgroundColor=mt),bt}const utils={$inputStyle:()=>rt=>createStateClass(rt,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>rt=>createStateClass(rt,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>rt=>createStateClass(rt,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>rt=>createStateClass(rt,{key:"$active",borderColor:"$accent1",inset:!0})},{styled,css,createTheme,globalCss,keyframes}=q$1({prefix:"leva",theme:getDefaultTheme(),utils:_objectSpread2(_objectSpread2({},utils),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:rt=>({"&:focus":utils.$focusStyle()(rt)}),$focusWithin:rt=>({"&:focus-within":utils.$focusStyle()(rt)}),$hover:rt=>({"&:hover":utils.$hoverStyle()(rt)}),$active:rt=>({"&:active":utils.$activeStyle()(rt)})})}),globalStyles=globalCss({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function mergeTheme(rt){const _=getDefaultTheme();if(!rt)return{theme:_,className:""};Object.keys(rt).forEach(mt=>{Object.assign(_[mt],rt[mt])});const ut=createTheme(_);return{theme:_,className:ut.className}}function useTh(rt,_){const{theme:ut}=reactExports.useContext(ThemeContext);if(!(rt in ut)||!(_ in ut[rt]))return warn(LevaErrors.THEME_ERROR,rt,_),"";let mt=_;for(;;){let bt=ut[rt][mt];if(typeof bt=="string"&&bt.charAt(0)==="$")mt=bt.substr(1);else return bt}}const StyledInput=styled("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),InnerLabel=styled("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${StyledInput}`]:{paddingLeft:0}}),InnerNumberLabel=styled(InnerLabel,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),InputContainer=styled("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),_excluded$7$1=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],_excluded2$1$1=["onUpdate"];function ValueInput(rt){let{innerLabel:_,value:ut,onUpdate:mt,onChange:bt,onKeyDown:St,type:Mt,id:Bt,inputType:Ut="text",rows:Ht=0}=rt,tr=_objectWithoutProperties$1(rt,_excluded$7$1);const{id:rr,emitOnEditStart:sr,emitOnEditEnd:ar,disabled:cr}=useInputContext(),Ar=Bt||rr,_r=reactExports.useRef(null),Dr=Ht>0,$r=Dr?"textarea":"input",Br=reactExports.useCallback(Mn=>$n=>{const en=$n.currentTarget.value;Mn(en)},[]);React.useEffect(()=>{const Mn=_r.current,$n=Br(en=>{mt(en),ar()});return Mn==null||Mn.addEventListener("blur",$n),()=>Mn==null?void 0:Mn.removeEventListener("blur",$n)},[Br,mt,ar]);const Jr=reactExports.useCallback(Mn=>{Mn.key==="Enter"&&Br(mt)(Mn)},[Br,mt]),mn=Object.assign({as:$r},Dr?{rows:Ht}:{},tr);return React.createElement(InputContainer,{textArea:Dr},_&&typeof _=="string"?React.createElement(InnerLabel,null,_):_,React.createElement(StyledInput,_extends({levaType:Mt,ref:_r,id:Ar,type:Ut,autoComplete:"off",spellCheck:"false",value:ut,onChange:Br(bt),onFocus:()=>sr(),onKeyPress:Jr,onKeyDown:St,disabled:cr},mn)))}function NumberInput(rt){let{onUpdate:_}=rt,ut=_objectWithoutProperties$1(rt,_excluded2$1$1);const mt=reactExports.useCallback(St=>_(parseNumber(St)),[_]),bt=reactExports.useCallback(St=>{const Mt=St.key==="ArrowUp"?1:St.key==="ArrowDown"?-1:0;if(Mt){St.preventDefault();const Bt=St.altKey?.1:St.shiftKey?10:1;_(Ut=>parseFloat(Ut)+Mt*Bt)}},[_]);return React.createElement(ValueInput,_extends({},ut,{onUpdate:mt,onKeyDown:bt,type:"number"}))}const StyledFolder=styled("div",{}),StyledWrapper=styled("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]}),StyledTitle=styled("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${StyledWrapper}::after`]:{opacity:.6},[`${StyledFolder}:hover > & + ${StyledWrapper}::after`]:{opacity:.6},[`${StyledFolder}:hover > & > svg`]:{opacity:1}}),StyledContent=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${StyledFolder}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),StyledRow=styled("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${StyledContent} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),StyledInputRow=styled(StyledRow,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),CopyLabelContainer=styled("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),StyledOptionalToggle=styled("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),StyledLabel=styled("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}}),StyledInputWrapper$1=styled("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${StyledLabel}`]:{pointerEvents:"auto"}}}}}),Overlay=styled("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"}),StyledToolTipContent=styled("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),ToolTipArrow=styled($a093c7e1ec25a057$export$21b07c8f274aebd5,{fill:"$toolTipBackground"});function Portal({children:rt}){const{className:_}=reactExports.useContext(ThemeContext);return React.createElement($f1701beae083dbae$export$be92b6f5f03c0fe9,{className:_},rt)}const _excluded$6$1=["align"];function OptionalToggle(){const{id:rt,disable:_,disabled:ut}=useInputContext();return React.createElement(React.Fragment,null,React.createElement(StyledOptionalToggle,{id:rt+"__disable",type:"checkbox",checked:!ut,onChange:()=>_(!ut)}),React.createElement("label",{htmlFor:rt+"__disable"}))}function RawLabel(rt){const{id:_,optional:ut,hint:mt}=useInputContext(),bt=rt.htmlFor||(_?{htmlFor:_}:null),St=!mt&&typeof rt.children=="string"?{title:rt.children}:null;return React.createElement(React.Fragment,null,ut&&React.createElement(OptionalToggle,null),mt!==void 0?React.createElement($a093c7e1ec25a057$export$be92b6f5f03c0fe9,null,React.createElement($a093c7e1ec25a057$export$41fb9f06171c75f4,{asChild:!0},React.createElement(StyledLabel,_extends({},bt,rt))),React.createElement($a093c7e1ec25a057$export$7c6e2c02157bb7d2,{side:"top",sideOffset:2},React.createElement(StyledToolTipContent,null,mt,React.createElement(ToolTipArrow,null)))):React.createElement(StyledLabel,_extends({},bt,St,rt)))}function Label(rt){let{align:_}=rt,ut=_objectWithoutProperties$1(rt,_excluded$6$1);const{value:mt,label:bt,key:St,disabled:Mt}=useInputContext(),{hideCopyButton:Bt}=usePanelSettingsContext(),Ut=!Bt&&St!==void 0,[Ht,tr]=reactExports.useState(!1),rr=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[St]:mt??""})),tr(!0)}catch{warn(LevaErrors.CLIPBOARD_ERROR,{[St]:mt})}};return React.createElement(CopyLabelContainer,{align:_,onPointerLeave:()=>tr(!1)},React.createElement(RawLabel,ut),Ut&&!Mt&&React.createElement("div",{title:`Click to copy ${typeof bt=="string"?bt:St} value`},Ht?React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),React.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):React.createElement("svg",{onClick:rr,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),React.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}const _excluded$5$1=["toggled"],Svg=styled("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function Chevron(rt){let{toggled:_}=rt,ut=_objectWithoutProperties$1(rt,_excluded$5$1);return React.createElement(Svg,_extends({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${_?0:-90}deg)`}},ut),React.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}const _excluded$4$1=["input"];function Row(rt){let{input:_}=rt,ut=_objectWithoutProperties$1(rt,_excluded$4$1);return _?React.createElement(StyledInputRow,ut):React.createElement(StyledRow,ut)}function useInputSetters({value:rt,type:_,settings:ut,setValue:mt}){const[bt,St]=reactExports.useState(format$2(_,rt,ut)),Mt=reactExports.useRef(rt),Bt=reactExports.useRef(ut);Bt.current=ut;const Ut=reactExports.useCallback(tr=>St(format$2(_,tr,Bt.current)),[_]),Ht=reactExports.useCallback(tr=>{try{mt(tr)}catch(rr){const{type:sr,previousValue:ar}=rr;if(sr!=="LEVA_ERROR")throw rr;Ut(ar)}},[Ut,mt]);return reactExports.useEffect(()=>{dequal(rt,Mt.current)||Ut(rt),Mt.current=rt},[rt,Ut]),{displayValue:bt,onChange:St,onUpdate:Ht}}function useDrag(rt,_){const{emitOnEditStart:ut,emitOnEditEnd:mt}=useInputContext();return useDrag$1(bt=>{bt.first&&(document.body.classList.add("leva__panel__dragged"),ut==null||ut());const St=rt(bt);return bt.last&&(document.body.classList.remove("leva__panel__dragged"),mt==null||mt()),St},_)}function useCanvas2d(rt){const _=reactExports.useRef(null),ut=reactExports.useRef(null),mt=reactExports.useRef(!1);return reactExports.useEffect(()=>{const bt=debounce(()=>{_.current.width=_.current.offsetWidth*window.devicePixelRatio,_.current.height=_.current.offsetHeight*window.devicePixelRatio,rt(_.current,ut.current)},250);return window.addEventListener("resize",bt),mt.current||(bt(),mt.current=!0),()=>window.removeEventListener("resize",bt)},[rt]),reactExports.useEffect(()=>{ut.current=_.current.getContext("2d")},[]),[_,ut]}function useTransform(){const rt=reactExports.useRef(null),_=reactExports.useRef({x:0,y:0}),ut=reactExports.useCallback(mt=>{Object.assign(_.current,mt),rt.current&&(rt.current.style.transform=`translate3d(${_.current.x}px, ${_.current.y}px, 0)`)},[]);return[rt,ut]}const _excluded$3$1=["__refCount"],getInputAtPath=(rt,_)=>{if(!rt[_])return null;const ut=rt[_];return _objectWithoutProperties$1(ut,_excluded$3$1)};function useInput(rt){const _=useStoreContext(),[ut,mt]=reactExports.useState(getInputAtPath(_.getData(),rt)),bt=reactExports.useCallback(Ht=>_.setValueAtPath(rt,Ht,!0),[rt,_]),St=reactExports.useCallback(Ht=>_.setSettingsAtPath(rt,Ht),[rt,_]),Mt=reactExports.useCallback(Ht=>_.disableInputAtPath(rt,Ht),[rt,_]),Bt=reactExports.useCallback(()=>_.emitOnEditStart(rt),[rt,_]),Ut=reactExports.useCallback(()=>_.emitOnEditEnd(rt),[rt,_]);return reactExports.useEffect(()=>{mt(getInputAtPath(_.getData(),rt));const Ht=_.useStore.subscribe(tr=>getInputAtPath(tr.data,rt),mt,{equalityFn:shallow});return()=>Ht()},[_,rt]),[ut,{set:bt,setSettings:St,disable:Mt,storeId:_.storeId,emitOnEditStart:Bt,emitOnEditEnd:Ut}]}const RangeGrid=styled("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),Range=styled("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),Scrubber=styled("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),RangeWrapper=styled("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),Indicator=styled("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function RangeSlider({value:rt,min:_,max:ut,onDrag:mt,step:bt,initialValue:St}){const Mt=reactExports.useRef(null),Bt=reactExports.useRef(null),Ut=reactExports.useRef(0),Ht=useTh("sizes","scrubberWidth"),tr=useDrag(({event:sr,first:ar,xy:[cr],movement:[Ar],memo:_r})=>{if(ar){const{width:$r,left:Br}=Mt.current.getBoundingClientRect();Ut.current=$r-parseFloat(Ht),_r=(sr==null?void 0:sr.target)===Bt.current?rt:invertedRange((cr-Br)/$r,_,ut)}const Dr=_r+invertedRange(Ar/Ut.current,0,ut-_);return mt(sanitizeStep$1(Dr,{step:bt,initialValue:St})),_r}),rr=range(rt,_,ut);return React.createElement(RangeWrapper,_extends({ref:Mt},tr()),React.createElement(Range,null,React.createElement(Indicator,{style:{left:0,right:`${(1-rr)*100}%`}})),React.createElement(Scrubber,{ref:Bt,style:{left:`calc(${rr} * (100% - ${Ht}))`}}))}const DraggableLabel=React.memo(({label:rt,onUpdate:_,step:ut,innerLabelTrim:mt})=>{const[bt,St]=reactExports.useState(!1),Mt=useDrag(({active:Bt,delta:[Ut],event:Ht,memo:tr=0})=>(St(Bt),tr+=Ut/2,Math.abs(tr)>=1&&(_(rr=>parseFloat(rr)+Math.floor(tr)*ut*multiplyStep(Ht)),tr=0),tr));return React.createElement(InnerNumberLabel,_extends({dragging:bt,title:rt.length>1?rt:""},Mt()),rt.slice(0,mt))});function Number$1({label:rt,id:_,displayValue:ut,onUpdate:mt,onChange:bt,settings:St,innerLabelTrim:Mt=1}){const Bt=Mt>0&&React.createElement(DraggableLabel,{label:rt,step:St.step,onUpdate:mt,innerLabelTrim:Mt});return React.createElement(NumberInput,{id:_,value:String(ut),onUpdate:mt,onChange:bt,innerLabel:Bt})}function NumberComponent(){const rt=useInputContext(),{label:_,value:ut,onUpdate:mt,settings:bt,id:St}=rt,{min:Mt,max:Bt}=bt,Ut=Bt!==1/0&&Mt!==-1/0;return React.createElement(Row,{input:!0},React.createElement(Label,null,_),React.createElement(RangeGrid,{hasRange:Ut},Ut&&React.createElement(RangeSlider,_extends({value:parseFloat(ut),onDrag:mt},bt)),React.createElement(Number$1,_extends({},rt,{id:St,label:"value",innerLabelTrim:Ut?0:1}))))}const{sanitizeStep}=props$3,rest=_objectWithoutProperties$1(props$3,["sanitizeStep"]);var number$1=_objectSpread2({component:NumberComponent},rest);const schema$2$1=(rt,_)=>v8n().schema({options:v8n().passesAnyOf(v8n().object(),v8n().array())}).test(_),sanitize$2$1=(rt,{values:_})=>{if(_.indexOf(rt)<0)throw Error("Selected value doesn't match Select options");return rt},format$3=(rt,{values:_})=>_.indexOf(rt),normalize$1$1=rt=>{let{value:_,options:ut}=rt,mt,bt;return Array.isArray(ut)?(bt=ut,mt=ut.map(St=>String(St))):(bt=Object.values(ut),mt=Object.keys(ut)),"value"in rt?bt.includes(_)||(mt.unshift(String(_)),bt.unshift(_)):_=bt[0],Object.values(ut).includes(_)||(ut[String(_)]=_),{value:_,settings:{keys:mt,values:bt}}};var props$2$1=Object.freeze({__proto__:null,schema:schema$2$1,sanitize:sanitize$2$1,format:format$3,normalize:normalize$1$1});const SelectContainer=styled("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),NativeSelect=styled("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),PresentationalSelect=styled("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${NativeSelect}:focus + &`]:{$focusStyle:""},[`${NativeSelect}:hover + &`]:{$hoverStyle:""}});function Select({displayValue:rt,value:_,onUpdate:ut,id:mt,settings:bt,disabled:St}){const{keys:Mt,values:Bt}=bt,Ut=reactExports.useRef();return _===Bt[rt]&&(Ut.current=Mt[rt]),React.createElement(SelectContainer,null,React.createElement(NativeSelect,{id:mt,value:rt,onChange:Ht=>ut(Bt[Number(Ht.currentTarget.value)]),disabled:St},Mt.map((Ht,tr)=>React.createElement("option",{key:Ht,value:tr},Ht))),React.createElement(PresentationalSelect,null,Ut.current),React.createElement(Chevron,{toggled:!0}))}function SelectComponent(){const{label:rt,value:_,displayValue:ut,onUpdate:mt,id:bt,disabled:St,settings:Mt}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,rt),React.createElement(Select,{id:bt,value:_,displayValue:ut,onUpdate:mt,settings:Mt,disabled:St}))}var select=_objectSpread2({component:SelectComponent},props$2$1);const schema$1$1=rt=>v8n().string().test(rt),sanitize$1$1=rt=>{if(typeof rt!="string")throw Error("Invalid string");return rt},normalize$5=({value:rt,editable:_=!0,rows:ut=!1})=>({value:rt,settings:{editable:_,rows:typeof ut=="number"?ut:ut?5:0}});var props$1$1=Object.freeze({__proto__:null,schema:schema$1$1,sanitize:sanitize$1$1,normalize:normalize$5});const _excluded$2$1=["displayValue","onUpdate","onChange","editable"],NonEditableString=styled("div",{whiteSpace:"pre-wrap"});function String$1(rt){let{displayValue:_,onUpdate:ut,onChange:mt,editable:bt=!0}=rt,St=_objectWithoutProperties$1(rt,_excluded$2$1);return bt?React.createElement(ValueInput,_extends({value:_,onUpdate:ut,onChange:mt},St)):React.createElement(NonEditableString,null,_)}function StringComponent(){const{label:rt,settings:_,displayValue:ut,onUpdate:mt,onChange:bt}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,rt),React.createElement(String$1,_extends({displayValue:ut,onUpdate:mt,onChange:bt},_)))}var string=_objectSpread2({component:StringComponent},props$1$1);const schema$4=rt=>v8n().boolean().test(rt),sanitize$5=rt=>{if(typeof rt!="boolean")throw Error("Invalid boolean");return rt};var props$4=Object.freeze({__proto__:null,schema:schema$4,sanitize:sanitize$5});const StyledInputWrapper=styled("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function Boolean$1({value:rt,onUpdate:_,id:ut,disabled:mt}){return React.createElement(StyledInputWrapper,null,React.createElement("input",{id:ut,type:"checkbox",checked:rt,onChange:bt=>_(bt.currentTarget.checked),disabled:mt}),React.createElement("label",{htmlFor:ut},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function BooleanComponent(){const{label:rt,value:_,onUpdate:ut,disabled:mt,id:bt}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,rt),React.createElement(Boolean$1,{value:_,onUpdate:ut,id:bt,disabled:mt}))}var boolean=_objectSpread2({component:BooleanComponent},props$4);const _excluded$1$1=["locked"];function Coordinate({value:rt,id:_,valueKey:ut,settings:mt,onUpdate:bt,innerLabelTrim:St}){const Mt=reactExports.useRef(rt[ut]);Mt.current=rt[ut];const Bt=reactExports.useCallback(Ht=>bt({[ut]:sanitizeValue({type:"NUMBER",value:Mt.current,settings:mt},Ht)}),[bt,mt,ut]),Ut=useInputSetters({type:"NUMBER",value:rt[ut],settings:mt,setValue:Bt});return React.createElement(Number$1,{id:_,label:ut,value:rt[ut],displayValue:Ut.displayValue,onUpdate:Ut.onUpdate,onChange:Ut.onChange,settings:mt,innerLabelTrim:St})}const Container$2=styled("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});function Lock(rt){let{locked:_}=rt,ut=_objectWithoutProperties$1(rt,_excluded$1$1);return React.createElement("svg",_extends({width:"10",height:"10",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ut),_?React.createElement("path",{d:"M5 4.63601C5 3.76031 5.24219 3.1054 5.64323 2.67357C6.03934 2.24705 6.64582 1.9783 7.5014 1.9783C8.35745 1.9783 8.96306 2.24652 9.35823 2.67208C9.75838 3.10299 10 3.75708 10 4.63325V5.99999H5V4.63601ZM4 5.99999V4.63601C4 3.58148 4.29339 2.65754 4.91049 1.99307C5.53252 1.32329 6.42675 0.978302 7.5014 0.978302C8.57583 0.978302 9.46952 1.32233 10.091 1.99162C10.7076 2.65557 11 3.57896 11 4.63325V5.99999H12C12.5523 5.99999 13 6.44771 13 6.99999V13C13 13.5523 12.5523 14 12 14H3C2.44772 14 2 13.5523 2 13V6.99999C2 6.44771 2.44772 5.99999 3 5.99999H4ZM3 6.99999H12V13H3V6.99999Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}):React.createElement("path",{d:"M9 3.63601C9 2.76044 9.24207 2.11211 9.64154 1.68623C10.0366 1.26502 10.6432 1 11.5014 1C12.4485 1 13.0839 1.30552 13.4722 1.80636C13.8031 2.23312 14 2.84313 14 3.63325H15C15 2.68242 14.7626 1.83856 14.2625 1.19361C13.6389 0.38943 12.6743 0 11.5014 0C10.4294 0 9.53523 0.337871 8.91218 1.0021C8.29351 1.66167 8 2.58135 8 3.63601V6H1C0.447715 6 0 6.44772 0 7V13C0 13.5523 0.447715 14 1 14H10C10.5523 14 11 13.5523 11 13V7C11 6.44772 10.5523 6 10 6H9V3.63601ZM1 7H10V13H1V7Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}function Vector({value:rt,onUpdate:_,settings:ut,innerLabelTrim:mt}){const{id:bt,setSettings:St}=useInputContext(),{lock:Mt,locked:Bt}=ut;return React.createElement(Container$2,{withLock:Mt},Mt&&React.createElement(Lock,{locked:Bt,onClick:()=>St({locked:!Bt})}),Object.keys(rt).map((Ut,Ht)=>React.createElement(Coordinate,{id:Ht===0?bt:`${bt}.${Ut}`,key:Ut,valueKey:Ut,value:rt,settings:ut[Ut],onUpdate:_,innerLabelTrim:mt})))}const normalizeKeyedNumberSettings=(rt,_)=>{const ut={};let mt=0,bt=1/0;Object.entries(rt).forEach(([St,Mt])=>{ut[St]=normalize$2$1(_objectSpread2({value:Mt},_[St])).settings,mt=Math.max(mt,ut[St].step),bt=Math.min(bt,ut[St].pad)});for(let St in ut){const{step:Mt,min:Bt,max:Ut}=_[St]||{};!isFinite(Mt)&&(!isFinite(Bt)||!isFinite(Ut))&&(ut[St].step=mt,ut[St].pad=bt)}return ut},_excluded$b=["lock"],_excluded2$5=["value"];function getVectorSchema(rt){const _=v8n().array().length(rt).every.number(),ut=mt=>{if(!mt||typeof mt!="object")return!1;const bt=Object.values(mt);return bt.length===rt&&bt.every(St=>isFinite(St))};return mt=>_.test(mt)||ut(mt)}function getVectorType(rt){return Array.isArray(rt)?"array":"object"}function convert$1(rt,_,ut){return getVectorType(rt)===_?rt:_==="array"?Object.values(rt):mapArrayToKeys(rt,ut)}const sanitizeVector=(rt,_,ut)=>{const mt=convert$1(rt,"object",_.keys);for(let Mt in mt)mt[Mt]=sanitize$3(mt[Mt],_[Mt]);const bt=Object.keys(mt);let St={};if(bt.length===_.keys.length)St=mt;else{const Mt=convert$1(ut,"object",_.keys);if(bt.length===1&&_.locked){const Bt=bt[0],Ut=mt[Bt],Ht=Mt[Bt],tr=Ht!==0?Ut/Ht:1;for(let rr in Mt)rr===Bt?St[Bt]=Ut:St[rr]=Mt[rr]*tr}else St=_objectSpread2(_objectSpread2({},Mt),mt)}return convert$1(St,_.format,_.keys)},formatVector=(rt,_)=>convert$1(rt,"object",_.keys),isNumberSettings=rt=>!!rt&&("step"in rt||"min"in rt||"max"in rt);function normalizeVector(rt,_,ut=[]){const{lock:mt=!1}=_,bt=_objectWithoutProperties$1(_,_excluded$b),St=Array.isArray(rt)?"array":"object",Mt=St==="object"?Object.keys(rt):ut,Bt=convert$1(rt,"object",Mt),Ut=isNumberSettings(bt)?Mt.reduce((tr,rr)=>Object.assign(tr,{[rr]:bt}),{}):bt,Ht=normalizeKeyedNumberSettings(Bt,Ut);return{value:St==="array"?rt:Bt,settings:_objectSpread2(_objectSpread2({},Ht),{},{format:St,keys:Mt,lock:mt,locked:!1})}}function getVectorPlugin(rt){return{schema:getVectorSchema(rt.length),normalize:_=>{let{value:ut}=_,mt=_objectWithoutProperties$1(_,_excluded2$5);return normalizeVector(ut,mt,rt)},format:(_,ut)=>formatVector(_,ut),sanitize:(_,ut,mt)=>sanitizeVector(_,ut,mt)}}var r={grad:.9,turn:360,rad:360/(2*Math.PI)},t=function(rt){return typeof rt=="string"?rt.length>0:typeof rt=="number"},n=function(rt,_,ut){return _===void 0&&(_=0),ut===void 0&&(ut=Math.pow(10,_)),Math.round(ut*rt)/ut+0},e=function(rt,_,ut){return _===void 0&&(_=0),ut===void 0&&(ut=1),rt>ut?ut:rt>_?rt:_},u$1=function(rt){return(rt=isFinite(rt)?rt%360:0)>0?rt:rt+360},a=function(rt){return{r:e(rt.r,0,255),g:e(rt.g,0,255),b:e(rt.b,0,255),a:e(rt.a)}},o=function(rt){return{r:n(rt.r),g:n(rt.g),b:n(rt.b),a:n(rt.a,3)}},i$2=/^#([0-9a-f]{3,8})$/i,s$1=function(rt){var _=rt.toString(16);return _.length<2?"0"+_:_},h$1=function(rt){var _=rt.r,ut=rt.g,mt=rt.b,bt=rt.a,St=Math.max(_,ut,mt),Mt=St-Math.min(_,ut,mt),Bt=Mt?St===_?(ut-mt)/Mt:St===ut?2+(mt-_)/Mt:4+(_-ut)/Mt:0;return{h:60*(Bt<0?Bt+6:Bt),s:St?Mt/St*100:0,v:St/255*100,a:bt}},b$1=function(rt){var _=rt.h,ut=rt.s,mt=rt.v,bt=rt.a;_=_/360*6,ut/=100,mt/=100;var St=Math.floor(_),Mt=mt*(1-ut),Bt=mt*(1-(_-St)*ut),Ut=mt*(1-(1-_+St)*ut),Ht=St%6;return{r:255*[mt,Bt,Mt,Mt,Ut,mt][Ht],g:255*[Ut,mt,mt,Bt,Mt,Mt][Ht],b:255*[Mt,Mt,Ut,mt,mt,Bt][Ht],a:bt}},g$1=function(rt){return{h:u$1(rt.h),s:e(rt.s,0,100),l:e(rt.l,0,100),a:e(rt.a)}},d$1=function(rt){return{h:n(rt.h),s:n(rt.s),l:n(rt.l),a:n(rt.a,3)}},f$1=function(rt){return b$1((ut=(_=rt).s,{h:_.h,s:(ut*=((mt=_.l)<50?mt:100-mt)/100)>0?2*ut/(mt+ut)*100:0,v:mt+ut,a:_.a}));var _,ut,mt},c$1=function(rt){return{h:(_=h$1(rt)).h,s:(bt=(200-(ut=_.s))*(mt=_.v)/100)>0&&bt<200?ut*mt/100/(bt<=100?bt:200-bt)*100:0,l:bt/2,a:_.a};var _,ut,mt,bt},l=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,p$1=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,v$1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,m$1=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y$1={string:[[function(rt){var _=i$2.exec(rt);return _?(rt=_[1]).length<=4?{r:parseInt(rt[0]+rt[0],16),g:parseInt(rt[1]+rt[1],16),b:parseInt(rt[2]+rt[2],16),a:rt.length===4?n(parseInt(rt[3]+rt[3],16)/255,2):1}:rt.length===6||rt.length===8?{r:parseInt(rt.substr(0,2),16),g:parseInt(rt.substr(2,2),16),b:parseInt(rt.substr(4,2),16),a:rt.length===8?n(parseInt(rt.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(rt){var _=v$1.exec(rt)||m$1.exec(rt);return _?_[2]!==_[4]||_[4]!==_[6]?null:a({r:Number(_[1])/(_[2]?100/255:1),g:Number(_[3])/(_[4]?100/255:1),b:Number(_[5])/(_[6]?100/255:1),a:_[7]===void 0?1:Number(_[7])/(_[8]?100:1)}):null},"rgb"],[function(rt){var _=l.exec(rt)||p$1.exec(rt);if(!_)return null;var ut,mt,bt=g$1({h:(ut=_[1],mt=_[2],mt===void 0&&(mt="deg"),Number(ut)*(r[mt]||1)),s:Number(_[3]),l:Number(_[4]),a:_[5]===void 0?1:Number(_[5])/(_[6]?100:1)});return f$1(bt)},"hsl"]],object:[[function(rt){var _=rt.r,ut=rt.g,mt=rt.b,bt=rt.a,St=bt===void 0?1:bt;return t(_)&&t(ut)&&t(mt)?a({r:Number(_),g:Number(ut),b:Number(mt),a:Number(St)}):null},"rgb"],[function(rt){var _=rt.h,ut=rt.s,mt=rt.l,bt=rt.a,St=bt===void 0?1:bt;if(!t(_)||!t(ut)||!t(mt))return null;var Mt=g$1({h:Number(_),s:Number(ut),l:Number(mt),a:Number(St)});return f$1(Mt)},"hsl"],[function(rt){var _=rt.h,ut=rt.s,mt=rt.v,bt=rt.a,St=bt===void 0?1:bt;if(!t(_)||!t(ut)||!t(mt))return null;var Mt=function(Bt){return{h:u$1(Bt.h),s:e(Bt.s,0,100),v:e(Bt.v,0,100),a:e(Bt.a)}}({h:Number(_),s:Number(ut),v:Number(mt),a:Number(St)});return b$1(Mt)},"hsv"]]},N=function(rt,_){for(var ut=0;ut<_.length;ut++){var mt=_[ut][0](rt);if(mt)return[mt,_[ut][1]]}return[null,void 0]},x=function(rt){return typeof rt=="string"?N(rt.trim(),y$1.string):typeof rt=="object"&&rt!==null?N(rt,y$1.object):[null,void 0]},I$1=function(rt){return x(rt)[1]},M=function(rt,_){var ut=c$1(rt);return{h:ut.h,s:e(ut.s+100*_,0,100),l:ut.l,a:ut.a}},H=function(rt){return(299*rt.r+587*rt.g+114*rt.b)/1e3/255},$$1=function(rt,_){var ut=c$1(rt);return{h:ut.h,s:ut.s,l:e(ut.l+100*_,0,100),a:ut.a}},j=function(){function rt(_){this.parsed=x(_)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return rt.prototype.isValid=function(){return this.parsed!==null},rt.prototype.brightness=function(){return n(H(this.rgba),2)},rt.prototype.isDark=function(){return H(this.rgba)<.5},rt.prototype.isLight=function(){return H(this.rgba)>=.5},rt.prototype.toHex=function(){return _=o(this.rgba),ut=_.r,mt=_.g,bt=_.b,Mt=(St=_.a)<1?s$1(n(255*St)):"","#"+s$1(ut)+s$1(mt)+s$1(bt)+Mt;var _,ut,mt,bt,St,Mt},rt.prototype.toRgb=function(){return o(this.rgba)},rt.prototype.toRgbString=function(){return _=o(this.rgba),ut=_.r,mt=_.g,bt=_.b,(St=_.a)<1?"rgba("+ut+", "+mt+", "+bt+", "+St+")":"rgb("+ut+", "+mt+", "+bt+")";var _,ut,mt,bt,St},rt.prototype.toHsl=function(){return d$1(c$1(this.rgba))},rt.prototype.toHslString=function(){return _=d$1(c$1(this.rgba)),ut=_.h,mt=_.s,bt=_.l,(St=_.a)<1?"hsla("+ut+", "+mt+"%, "+bt+"%, "+St+")":"hsl("+ut+", "+mt+"%, "+bt+"%)";var _,ut,mt,bt,St},rt.prototype.toHsv=function(){return _=h$1(this.rgba),{h:n(_.h),s:n(_.s),v:n(_.v),a:n(_.a,3)};var _},rt.prototype.invert=function(){return w({r:255-(_=this.rgba).r,g:255-_.g,b:255-_.b,a:_.a});var _},rt.prototype.saturate=function(_){return _===void 0&&(_=.1),w(M(this.rgba,_))},rt.prototype.desaturate=function(_){return _===void 0&&(_=.1),w(M(this.rgba,-_))},rt.prototype.grayscale=function(){return w(M(this.rgba,-1))},rt.prototype.lighten=function(_){return _===void 0&&(_=.1),w($$1(this.rgba,_))},rt.prototype.darken=function(_){return _===void 0&&(_=.1),w($$1(this.rgba,-_))},rt.prototype.rotate=function(_){return _===void 0&&(_=15),this.hue(this.hue()+_)},rt.prototype.alpha=function(_){return typeof _=="number"?w({r:(ut=this.rgba).r,g:ut.g,b:ut.b,a:_}):n(this.rgba.a,3);var ut},rt.prototype.hue=function(_){var ut=c$1(this.rgba);return typeof _=="number"?w({h:_,s:ut.s,l:ut.l,a:ut.a}):n(ut.h)},rt.prototype.isEqual=function(_){return this.toHex()===w(_).toHex()},rt}(),w=function(rt){return rt instanceof j?rt:new j(rt)},S$1=[],k$1=function(rt){rt.forEach(function(_){S$1.indexOf(_)<0&&(_(j,y$1),S$1.push(_))})};function namesPlugin(rt,_){var ut={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},mt={};for(var bt in ut)mt[ut[bt]]=bt;var St={};rt.prototype.toName=function(Mt){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var Bt,Ut,Ht=mt[this.toHex()];if(Ht)return Ht;if(Mt!=null&&Mt.closest){var tr=this.toRgb(),rr=1/0,sr="black";if(!St.length)for(var ar in ut)St[ar]=new rt(ut[ar]).toRgb();for(var cr in ut){var Ar=(Bt=tr,Ut=St[cr],Math.pow(Bt.r-Ut.r,2)+Math.pow(Bt.g-Ut.g,2)+Math.pow(Bt.b-Ut.b,2));Ar<rr&&(rr=Ar,sr=cr)}return sr}},_.string.push([function(Mt){var Bt=Mt.toLowerCase(),Ut=Bt==="transparent"?"#0000":ut[Bt];return Ut?new rt(Ut).toRgb():null},"name"])}function u(){return(u=Object.assign||function(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_];for(var mt in ut)Object.prototype.hasOwnProperty.call(ut,mt)&&(rt[mt]=ut[mt])}return rt}).apply(this,arguments)}function c(rt,_){if(rt==null)return{};var ut,mt,bt={},St=Object.keys(rt);for(mt=0;mt<St.length;mt++)_.indexOf(ut=St[mt])>=0||(bt[ut]=rt[ut]);return bt}function i$1(rt){var _=reactExports.useRef(rt),ut=reactExports.useRef(function(mt){_.current&&_.current(mt)});return _.current=rt,ut.current}var s=function(rt,_,ut){return _===void 0&&(_=0),ut===void 0&&(ut=1),rt>ut?ut:rt<_?_:rt},f=function(rt){return"touches"in rt},v=function(rt){return rt&&rt.ownerDocument.defaultView||self},d=function(rt,_,ut){var mt=rt.getBoundingClientRect(),bt=f(_)?function(St,Mt){for(var Bt=0;Bt<St.length;Bt++)if(St[Bt].identifier===Mt)return St[Bt];return St[0]}(_.touches,ut):_;return{left:s((bt.pageX-(mt.left+v(rt).pageXOffset))/mt.width),top:s((bt.pageY-(mt.top+v(rt).pageYOffset))/mt.height)}},h=function(rt){!f(rt)&&rt.preventDefault()},m=React.memo(function(rt){var _=rt.onMove,ut=rt.onKey,mt=c(rt,["onMove","onKey"]),bt=reactExports.useRef(null),St=i$1(_),Mt=i$1(ut),Bt=reactExports.useRef(null),Ut=reactExports.useRef(!1),Ht=reactExports.useMemo(function(){var ar=function(_r){h(_r),(f(_r)?_r.touches.length>0:_r.buttons>0)&&bt.current?St(d(bt.current,_r,Bt.current)):Ar(!1)},cr=function(){return Ar(!1)};function Ar(_r){var Dr=Ut.current,$r=v(bt.current),Br=_r?$r.addEventListener:$r.removeEventListener;Br(Dr?"touchmove":"mousemove",ar),Br(Dr?"touchend":"mouseup",cr)}return[function(_r){var Dr=_r.nativeEvent,$r=bt.current;if($r&&(h(Dr),!function(Jr,mn){return mn&&!f(Jr)}(Dr,Ut.current)&&$r)){if(f(Dr)){Ut.current=!0;var Br=Dr.changedTouches||[];Br.length&&(Bt.current=Br[0].identifier)}$r.focus(),St(d($r,Dr,Bt.current)),Ar(!0)}},function(_r){var Dr=_r.which||_r.keyCode;Dr<37||Dr>40||(_r.preventDefault(),Mt({left:Dr===39?.05:Dr===37?-.05:0,top:Dr===40?.05:Dr===38?-.05:0}))},Ar]},[Mt,St]),tr=Ht[0],rr=Ht[1],sr=Ht[2];return reactExports.useEffect(function(){return sr},[sr]),React.createElement("div",u({},mt,{onTouchStart:tr,onMouseDown:tr,className:"react-colorful__interactive",ref:bt,onKeyDown:rr,tabIndex:0,role:"slider"}))}),g=function(rt){return rt.filter(Boolean).join(" ")},p=function(rt){var _=rt.color,ut=rt.left,mt=rt.top,bt=mt===void 0?.5:mt,St=g(["react-colorful__pointer",rt.className]);return React.createElement("div",{className:St,style:{top:100*bt+"%",left:100*ut+"%"}},React.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:_}}))},b=function(rt,_,ut){return _===void 0&&(_=0),ut===void 0&&(ut=Math.pow(10,_)),Math.round(ut*rt)/ut},y=function(rt){var _=rt.s,ut=rt.v,mt=rt.a,bt=(200-_)*ut/100;return{h:b(rt.h),s:b(bt>0&&bt<200?_*ut/100/(bt<=100?bt:200-bt)*100:0),l:b(bt/2),a:b(mt,2)}},q=function(rt){var _=y(rt);return"hsl("+_.h+", "+_.s+"%, "+_.l+"%)"},k=function(rt){var _=y(rt);return"hsla("+_.h+", "+_.s+"%, "+_.l+"%, "+_.a+")"},I=function(rt){var _=rt.h,ut=rt.s,mt=rt.v,bt=rt.a;_=_/360*6,ut/=100,mt/=100;var St=Math.floor(_),Mt=mt*(1-ut),Bt=mt*(1-(_-St)*ut),Ut=mt*(1-(1-_+St)*ut),Ht=St%6;return{r:b(255*[mt,Bt,Mt,Mt,Ut,mt][Ht]),g:b(255*[Ut,mt,mt,Bt,Mt,Mt][Ht]),b:b(255*[Mt,Mt,Ut,mt,mt,Bt][Ht]),a:b(bt,2)}},L=function(rt){var _=rt.r,ut=rt.g,mt=rt.b,bt=rt.a,St=Math.max(_,ut,mt),Mt=St-Math.min(_,ut,mt),Bt=Mt?St===_?(ut-mt)/Mt:St===ut?2+(mt-_)/Mt:4+(_-ut)/Mt:0;return{h:b(60*(Bt<0?Bt+6:Bt)),s:b(St?Mt/St*100:0),v:b(St/255*100),a:bt}},S=React.memo(function(rt){var _=rt.hue,ut=rt.onChange,mt=g(["react-colorful__hue",rt.className]);return React.createElement("div",{className:mt},React.createElement(m,{onMove:function(bt){ut({h:360*bt.left})},onKey:function(bt){ut({h:s(_+360*bt.left,0,360)})},"aria-label":"Hue","aria-valuenow":b(_),"aria-valuemax":"360","aria-valuemin":"0"},React.createElement(p,{className:"react-colorful__hue-pointer",left:_/360,color:q({h:_,s:100,v:100,a:1})})))}),T=React.memo(function(rt){var _=rt.hsva,ut=rt.onChange,mt={backgroundColor:q({h:_.h,s:100,v:100,a:1})};return React.createElement("div",{className:"react-colorful__saturation",style:mt},React.createElement(m,{onMove:function(bt){ut({s:100*bt.left,v:100-100*bt.top})},onKey:function(bt){ut({s:s(_.s+100*bt.left,0,100),v:s(_.v-100*bt.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+b(_.s)+"%, Brightness "+b(_.v)+"%"},React.createElement(p,{className:"react-colorful__saturation-pointer",top:1-_.v/100,left:_.s/100,color:q(_)})))}),F=function(rt,_){if(rt===_)return!0;for(var ut in rt)if(rt[ut]!==_[ut])return!1;return!0};function Y(rt,_,ut){var mt=i$1(ut),bt=reactExports.useState(function(){return rt.toHsva(_)}),St=bt[0],Mt=bt[1],Bt=reactExports.useRef({color:_,hsva:St});reactExports.useEffect(function(){if(!rt.equal(_,Bt.current.color)){var Ht=rt.toHsva(_);Bt.current={hsva:Ht,color:_},Mt(Ht)}},[_,rt]),reactExports.useEffect(function(){var Ht;F(St,Bt.current.hsva)||rt.equal(Ht=rt.fromHsva(St),Bt.current.color)||(Bt.current={hsva:St,color:Ht},mt(Ht))},[St,rt,mt]);var Ut=reactExports.useCallback(function(Ht){Mt(function(tr){return Object.assign({},tr,Ht)})},[]);return[St,Ut]}var V=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,$=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},J=new Map,Q=function(rt){V(function(){var _=rt.current?rt.current.ownerDocument:document;if(_!==void 0&&!J.has(_)){var ut=_.createElement("style");ut.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,J.set(_,ut);var mt=$();mt&&ut.setAttribute("nonce",mt),_.head.appendChild(ut)}},[])},U=function(rt){var _=rt.className,ut=rt.colorModel,mt=rt.color,bt=mt===void 0?ut.defaultColor:mt,St=rt.onChange,Mt=c(rt,["className","colorModel","color","onChange"]),Bt=reactExports.useRef(null);Q(Bt);var Ut=Y(ut,bt,St),Ht=Ut[0],tr=Ut[1],rr=g(["react-colorful",_]);return React.createElement("div",u({},Mt,{ref:Bt,className:rr}),React.createElement(T,{hsva:Ht,onChange:tr}),React.createElement(S,{hue:Ht.h,onChange:tr,className:"react-colorful__last-control"}))},ee=function(rt){var _=rt.className,ut=rt.hsva,mt=rt.onChange,bt={backgroundImage:"linear-gradient(90deg, "+k(Object.assign({},ut,{a:0}))+", "+k(Object.assign({},ut,{a:1}))+")"},St=g(["react-colorful__alpha",_]),Mt=b(100*ut.a);return React.createElement("div",{className:St},React.createElement("div",{className:"react-colorful__alpha-gradient",style:bt}),React.createElement(m,{onMove:function(Bt){mt({a:Bt.left})},onKey:function(Bt){mt({a:s(ut.a+Bt.left)})},"aria-label":"Alpha","aria-valuetext":Mt+"%","aria-valuenow":Mt,"aria-valuemin":"0","aria-valuemax":"100"},React.createElement(p,{className:"react-colorful__alpha-pointer",left:ut.a,color:k(ut)})))},re=function(rt){var _=rt.className,ut=rt.colorModel,mt=rt.color,bt=mt===void 0?ut.defaultColor:mt,St=rt.onChange,Mt=c(rt,["className","colorModel","color","onChange"]),Bt=reactExports.useRef(null);Q(Bt);var Ut=Y(ut,bt,St),Ht=Ut[0],tr=Ut[1],rr=g(["react-colorful",_]);return React.createElement("div",u({},Mt,{ref:Bt,className:rr}),React.createElement(T,{hsva:Ht,onChange:tr}),React.createElement(S,{hue:Ht.h,onChange:tr}),React.createElement(ee,{hsva:Ht,onChange:tr,className:"react-colorful__last-control"}))},xe={defaultColor:{r:0,g:0,b:0,a:1},toHsva:L,fromHsva:I,equal:F},Ce=function(rt){return React.createElement(re,u({},rt,{colorModel:xe}))},Me={defaultColor:{r:0,g:0,b:0},toHsva:function(rt){return L({r:rt.r,g:rt.g,b:rt.b,a:1})},fromHsva:function(rt){return{r:(_=I(rt)).r,g:_.g,b:_.b};var _},equal:F},Ne=function(rt){return React.createElement(U,u({},rt,{colorModel:Me}))},COMMON_MIME_TYPES=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function toFileWithPath(rt,_){var ut=withMimeType(rt);if(typeof ut.path!="string"){var mt=rt.webkitRelativePath;Object.defineProperty(ut,"path",{value:typeof _=="string"?_:typeof mt=="string"&&mt.length>0?mt:rt.name,writable:!1,configurable:!1,enumerable:!0})}return ut}function withMimeType(rt){var _=rt.name,ut=_&&_.lastIndexOf(".")!==-1;if(ut&&!rt.type){var mt=_.split(".").pop().toLowerCase(),bt=COMMON_MIME_TYPES.get(mt);bt&&Object.defineProperty(rt,"type",{value:bt,writable:!1,configurable:!1,enumerable:!0})}return rt}var FILES_TO_IGNORE=[".DS_Store","Thumbs.db"];function fromEvent(rt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_){return isObject$7(rt)&&isDataTransfer(rt)?[2,getDataTransferFiles(rt.dataTransfer,rt.type)]:isChangeEvt(rt)?[2,getInputFiles(rt)]:Array.isArray(rt)&&rt.every(function(ut){return"getFile"in ut&&typeof ut.getFile=="function"})?[2,getFsHandleFiles(rt)]:[2,[]]})})}function isDataTransfer(rt){return isObject$7(rt.dataTransfer)}function isChangeEvt(rt){return isObject$7(rt)&&isObject$7(rt.target)}function isObject$7(rt){return typeof rt=="object"&&rt!==null}function getInputFiles(rt){return fromList(rt.target.files).map(function(_){return toFileWithPath(_)})}function getFsHandleFiles(rt){return __awaiter(this,void 0,void 0,function(){var _;return __generator(this,function(ut){switch(ut.label){case 0:return[4,Promise.all(rt.map(function(mt){return mt.getFile()}))];case 1:return _=ut.sent(),[2,_.map(function(mt){return toFileWithPath(mt)})]}})})}function getDataTransferFiles(rt,_){return __awaiter(this,void 0,void 0,function(){var ut,mt;return __generator(this,function(bt){switch(bt.label){case 0:return rt===null?[2,[]]:rt.items?(ut=fromList(rt.items).filter(function(St){return St.kind==="file"}),_!=="drop"?[2,ut]:[4,Promise.all(ut.map(toFilePromises))]):[3,2];case 1:return mt=bt.sent(),[2,noIgnoredFiles(flatten(mt))];case 2:return[2,noIgnoredFiles(fromList(rt.files).map(function(St){return toFileWithPath(St)}))]}})})}function noIgnoredFiles(rt){return rt.filter(function(_){return FILES_TO_IGNORE.indexOf(_.name)===-1})}function fromList(rt){if(rt===null)return[];for(var _=[],ut=0;ut<rt.length;ut++){var mt=rt[ut];_.push(mt)}return _}function toFilePromises(rt){if(typeof rt.webkitGetAsEntry!="function")return fromDataTransferItem(rt);var _=rt.webkitGetAsEntry();return _&&_.isDirectory?fromDirEntry(_):fromDataTransferItem(rt)}function flatten(rt){return rt.reduce(function(_,ut){return __spread(_,Array.isArray(ut)?flatten(ut):[ut])},[])}function fromDataTransferItem(rt){var _=rt.getAsFile();if(!_)return Promise.reject(rt+" is not a File");var ut=toFileWithPath(_);return Promise.resolve(ut)}function fromEntry(rt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_){return[2,rt.isDirectory?fromDirEntry(rt):fromFileEntry(rt)]})})}function fromDirEntry(rt){var _=rt.createReader();return new Promise(function(ut,mt){var bt=[];function St(){var Mt=this;_.readEntries(function(Bt){return __awaiter(Mt,void 0,void 0,function(){var Ut,Ht,tr;return __generator(this,function(rr){switch(rr.label){case 0:if(Bt.length)return[3,5];rr.label=1;case 1:return rr.trys.push([1,3,,4]),[4,Promise.all(bt)];case 2:return Ut=rr.sent(),ut(Ut),[3,4];case 3:return Ht=rr.sent(),mt(Ht),[3,4];case 4:return[3,6];case 5:tr=Promise.all(Bt.map(fromEntry)),bt.push(tr),St(),rr.label=6;case 6:return[2]}})})},function(Bt){mt(Bt)})}St()})}function fromFileEntry(rt){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_){return[2,new Promise(function(ut,mt){rt.file(function(bt){var St=toFileWithPath(bt,rt.fullPath);ut(St)},function(bt){mt(bt)})})]})})}var _default=function(rt,_){if(rt&&_){var ut=Array.isArray(_)?_:_.split(","),mt=rt.name||"",bt=(rt.type||"").toLowerCase(),St=bt.replace(/\/.*$/,"");return ut.some(function(Mt){var Bt=Mt.trim().toLowerCase();return Bt.charAt(0)==="."?mt.toLowerCase().endsWith(Bt):Bt.endsWith("/*")?St===Bt.replace(/\/.*$/,""):bt===Bt})}return!0};function ownKeys$1(rt,_){var ut=Object.keys(rt);if(Object.getOwnPropertySymbols){var mt=Object.getOwnPropertySymbols(rt);_&&(mt=mt.filter(function(bt){return Object.getOwnPropertyDescriptor(rt,bt).enumerable})),ut.push.apply(ut,mt)}return ut}function _objectSpread$1(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_]!=null?arguments[_]:{};_%2?ownKeys$1(Object(ut),!0).forEach(function(mt){_defineProperty$1(rt,mt,ut[mt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(rt,Object.getOwnPropertyDescriptors(ut)):ownKeys$1(Object(ut)).forEach(function(mt){Object.defineProperty(rt,mt,Object.getOwnPropertyDescriptor(ut,mt))})}return rt}function _defineProperty$1(rt,_,ut){return _ in rt?Object.defineProperty(rt,_,{value:ut,enumerable:!0,configurable:!0,writable:!0}):rt[_]=ut,rt}function _slicedToArray$1(rt,_){return _arrayWithHoles$1(rt)||_iterableToArrayLimit$1(rt,_)||_unsupportedIterableToArray$1(rt,_)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1(rt,_){if(rt){if(typeof rt=="string")return _arrayLikeToArray$1(rt,_);var ut=Object.prototype.toString.call(rt).slice(8,-1);if(ut==="Object"&&rt.constructor&&(ut=rt.constructor.name),ut==="Map"||ut==="Set")return Array.from(rt);if(ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ut))return _arrayLikeToArray$1(rt,_)}}function _arrayLikeToArray$1(rt,_){(_==null||_>rt.length)&&(_=rt.length);for(var ut=0,mt=new Array(_);ut<_;ut++)mt[ut]=rt[ut];return mt}function _iterableToArrayLimit$1(rt,_){var ut=rt==null?null:typeof Symbol<"u"&&rt[Symbol.iterator]||rt["@@iterator"];if(ut!=null){var mt=[],bt=!0,St=!1,Mt,Bt;try{for(ut=ut.call(rt);!(bt=(Mt=ut.next()).done)&&(mt.push(Mt.value),!(_&&mt.length===_));bt=!0);}catch(Ut){St=!0,Bt=Ut}finally{try{!bt&&ut.return!=null&&ut.return()}finally{if(St)throw Bt}}return mt}}function _arrayWithHoles$1(rt){if(Array.isArray(rt))return rt}var FILE_INVALID_TYPE="file-invalid-type",FILE_TOO_LARGE="file-too-large",FILE_TOO_SMALL="file-too-small",TOO_MANY_FILES="too-many-files",getInvalidTypeRejectionErr=function rt(_){_=Array.isArray(_)&&_.length===1?_[0]:_;var ut=Array.isArray(_)?"one of ".concat(_.join(", ")):_;return{code:FILE_INVALID_TYPE,message:"File type must be ".concat(ut)}},getTooLargeRejectionErr=function rt(_){return{code:FILE_TOO_LARGE,message:"File is larger than ".concat(_," ").concat(_===1?"byte":"bytes")}},getTooSmallRejectionErr=function rt(_){return{code:FILE_TOO_SMALL,message:"File is smaller than ".concat(_," ").concat(_===1?"byte":"bytes")}},TOO_MANY_FILES_REJECTION={code:TOO_MANY_FILES,message:"Too many files"};function fileAccepted(rt,_){var ut=rt.type==="application/x-moz-file"||_default(rt,_);return[ut,ut?null:getInvalidTypeRejectionErr(_)]}function fileMatchSize(rt,_,ut){if(isDefined(rt.size))if(isDefined(_)&&isDefined(ut)){if(rt.size>ut)return[!1,getTooLargeRejectionErr(ut)];if(rt.size<_)return[!1,getTooSmallRejectionErr(_)]}else{if(isDefined(_)&&rt.size<_)return[!1,getTooSmallRejectionErr(_)];if(isDefined(ut)&&rt.size>ut)return[!1,getTooLargeRejectionErr(ut)]}return[!0,null]}function isDefined(rt){return rt!=null}function allFilesAccepted(rt){var _=rt.files,ut=rt.accept,mt=rt.minSize,bt=rt.maxSize,St=rt.multiple,Mt=rt.maxFiles;return!St&&_.length>1||St&&Mt>=1&&_.length>Mt?!1:_.every(function(Bt){var Ut=fileAccepted(Bt,ut),Ht=_slicedToArray$1(Ut,1),tr=Ht[0],rr=fileMatchSize(Bt,mt,bt),sr=_slicedToArray$1(rr,1),ar=sr[0];return tr&&ar})}function isPropagationStopped(rt){return typeof rt.isPropagationStopped=="function"?rt.isPropagationStopped():typeof rt.cancelBubble<"u"?rt.cancelBubble:!1}function isEvtWithFiles(rt){return rt.dataTransfer?Array.prototype.some.call(rt.dataTransfer.types,function(_){return _==="Files"||_==="application/x-moz-file"}):!!rt.target&&!!rt.target.files}function onDocumentDragOver(rt){rt.preventDefault()}function isIe(rt){return rt.indexOf("MSIE")!==-1||rt.indexOf("Trident/")!==-1}function isEdge(rt){return rt.indexOf("Edge/")!==-1}function isIeOrEdge(){var rt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return isIe(rt)||isEdge(rt)}function composeEventHandlers(){for(var rt=arguments.length,_=new Array(rt),ut=0;ut<rt;ut++)_[ut]=arguments[ut];return function(mt){for(var bt=arguments.length,St=new Array(bt>1?bt-1:0),Mt=1;Mt<bt;Mt++)St[Mt-1]=arguments[Mt];return _.some(function(Bt){return!isPropagationStopped(mt)&&Bt&&Bt.apply(void 0,[mt].concat(St)),isPropagationStopped(mt)})}}function canUseFileSystemAccessAPI(){return"showOpenFilePicker"in window}function filePickerOptionsTypes(rt){return rt=typeof rt=="string"?rt.split(","):rt,[{description:"everything",accept:Array.isArray(rt)?rt.filter(function(_){return _==="audio/*"||_==="video/*"||_==="image/*"||_==="text/*"||/\w+\/[-+.\w]+/g.test(_)}).reduce(function(_,ut){return _objectSpread$1(_objectSpread$1({},_),{},_defineProperty$1({},ut,[]))},{}):{}}]}function isAbort(rt){return rt instanceof DOMException&&(rt.name==="AbortError"||rt.code===rt.ABORT_ERR)}function isSecurityError(rt){return rt instanceof DOMException&&(rt.name==="SecurityError"||rt.code===rt.SECURITY_ERR)}var _excluded=["children"],_excluded2$2=["open"],_excluded3=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],_excluded4=["refKey","onChange","onClick"];function _toConsumableArray(rt){return _arrayWithoutHoles(rt)||_iterableToArray(rt)||_unsupportedIterableToArray(rt)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray(rt){if(typeof Symbol<"u"&&rt[Symbol.iterator]!=null||rt["@@iterator"]!=null)return Array.from(rt)}function _arrayWithoutHoles(rt){if(Array.isArray(rt))return _arrayLikeToArray(rt)}function _slicedToArray(rt,_){return _arrayWithHoles(rt)||_iterableToArrayLimit(rt,_)||_unsupportedIterableToArray(rt,_)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(rt,_){if(rt){if(typeof rt=="string")return _arrayLikeToArray(rt,_);var ut=Object.prototype.toString.call(rt).slice(8,-1);if(ut==="Object"&&rt.constructor&&(ut=rt.constructor.name),ut==="Map"||ut==="Set")return Array.from(rt);if(ut==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ut))return _arrayLikeToArray(rt,_)}}function _arrayLikeToArray(rt,_){(_==null||_>rt.length)&&(_=rt.length);for(var ut=0,mt=new Array(_);ut<_;ut++)mt[ut]=rt[ut];return mt}function _iterableToArrayLimit(rt,_){var ut=rt==null?null:typeof Symbol<"u"&&rt[Symbol.iterator]||rt["@@iterator"];if(ut!=null){var mt=[],bt=!0,St=!1,Mt,Bt;try{for(ut=ut.call(rt);!(bt=(Mt=ut.next()).done)&&(mt.push(Mt.value),!(_&&mt.length===_));bt=!0);}catch(Ut){St=!0,Bt=Ut}finally{try{!bt&&ut.return!=null&&ut.return()}finally{if(St)throw Bt}}return mt}}function _arrayWithHoles(rt){if(Array.isArray(rt))return rt}function ownKeys(rt,_){var ut=Object.keys(rt);if(Object.getOwnPropertySymbols){var mt=Object.getOwnPropertySymbols(rt);_&&(mt=mt.filter(function(bt){return Object.getOwnPropertyDescriptor(rt,bt).enumerable})),ut.push.apply(ut,mt)}return ut}function _objectSpread(rt){for(var _=1;_<arguments.length;_++){var ut=arguments[_]!=null?arguments[_]:{};_%2?ownKeys(Object(ut),!0).forEach(function(mt){_defineProperty(rt,mt,ut[mt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(rt,Object.getOwnPropertyDescriptors(ut)):ownKeys(Object(ut)).forEach(function(mt){Object.defineProperty(rt,mt,Object.getOwnPropertyDescriptor(ut,mt))})}return rt}function _defineProperty(rt,_,ut){return _ in rt?Object.defineProperty(rt,_,{value:ut,enumerable:!0,configurable:!0,writable:!0}):rt[_]=ut,rt}function _objectWithoutProperties(rt,_){if(rt==null)return{};var ut=_objectWithoutPropertiesLoose(rt,_),mt,bt;if(Object.getOwnPropertySymbols){var St=Object.getOwnPropertySymbols(rt);for(bt=0;bt<St.length;bt++)mt=St[bt],!(_.indexOf(mt)>=0)&&Object.prototype.propertyIsEnumerable.call(rt,mt)&&(ut[mt]=rt[mt])}return ut}function _objectWithoutPropertiesLoose(rt,_){if(rt==null)return{};var ut={},mt=Object.keys(rt),bt,St;for(St=0;St<mt.length;St++)bt=mt[St],!(_.indexOf(bt)>=0)&&(ut[bt]=rt[bt]);return ut}var Dropzone=reactExports.forwardRef(function(rt,_){var ut=rt.children,mt=_objectWithoutProperties(rt,_excluded),bt=useDropzone(mt),St=bt.open,Mt=_objectWithoutProperties(bt,_excluded2$2);return reactExports.useImperativeHandle(_,function(){return{open:St}},[St]),React.createElement(reactExports.Fragment,null,ut(_objectSpread(_objectSpread({},Mt),{},{open:St})))});Dropzone.displayName="Dropzone";var defaultProps={disabled:!1,getFilesFromEvent:fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0};Dropzone.defaultProps=defaultProps;Dropzone.propTypes={children:PropTypes.func,accept:PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),multiple:PropTypes.bool,preventDropOnDocument:PropTypes.bool,noClick:PropTypes.bool,noKeyboard:PropTypes.bool,noDrag:PropTypes.bool,noDragEventsBubbling:PropTypes.bool,minSize:PropTypes.number,maxSize:PropTypes.number,maxFiles:PropTypes.number,disabled:PropTypes.bool,getFilesFromEvent:PropTypes.func,onFileDialogCancel:PropTypes.func,onFileDialogOpen:PropTypes.func,useFsAccessApi:PropTypes.bool,onDragEnter:PropTypes.func,onDragLeave:PropTypes.func,onDragOver:PropTypes.func,onDrop:PropTypes.func,onDropAccepted:PropTypes.func,onDropRejected:PropTypes.func,validator:PropTypes.func};var initialState={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function useDropzone(){var rt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=_objectSpread(_objectSpread({},defaultProps),rt),ut=_.accept,mt=_.disabled,bt=_.getFilesFromEvent,St=_.maxSize,Mt=_.minSize,Bt=_.multiple,Ut=_.maxFiles,Ht=_.onDragEnter,tr=_.onDragLeave,rr=_.onDragOver,sr=_.onDrop,ar=_.onDropAccepted,cr=_.onDropRejected,Ar=_.onFileDialogCancel,_r=_.onFileDialogOpen,Dr=_.useFsAccessApi,$r=_.preventDropOnDocument,Br=_.noClick,Jr=_.noKeyboard,mn=_.noDrag,Mn=_.noDragEventsBubbling,$n=_.validator,en=reactExports.useMemo(function(){return typeof _r=="function"?_r:noop},[_r]),In=reactExports.useMemo(function(){return typeof Ar=="function"?Ar:noop},[Ar]),Rn=reactExports.useRef(null),qn=reactExports.useRef(null),Qn=reactExports.useReducer(reducer,initialState),xs=_slicedToArray(Qn,2),cs=xs[0],ks=xs[1],_o=cs.isFocused,qs=cs.isFileDialogActive,Ss=cs.draggedFiles,eo=reactExports.useRef(typeof window<"u"&&window.isSecureContext&&Dr&&canUseFileSystemAccessAPI()),Ao=function(){!eo.current&&qs&&setTimeout(function(){if(qn.current){var Bp=qn.current.files;Bp.length||(ks({type:"closeDialog"}),In())}},300)};reactExports.useEffect(function(){return window.addEventListener("focus",Ao,!1),function(){window.removeEventListener("focus",Ao,!1)}},[qn,qs,In,eo]);var Oo=reactExports.useRef([]),uo=function(Bp){Rn.current&&Rn.current.contains(Bp.target)||(Bp.preventDefault(),Oo.current=[])};reactExports.useEffect(function(){return $r&&(document.addEventListener("dragover",onDocumentDragOver,!1),document.addEventListener("drop",uo,!1)),function(){$r&&(document.removeEventListener("dragover",onDocumentDragOver),document.removeEventListener("drop",uo))}},[Rn,$r]);var uu=reactExports.useCallback(function(Co){Co.preventDefault(),Co.persist(),m0(Co),Oo.current=[].concat(_toConsumableArray(Oo.current),[Co.target]),isEvtWithFiles(Co)&&Promise.resolve(bt(Co)).then(function(Bp){isPropagationStopped(Co)&&!Mn||(ks({draggedFiles:Bp,isDragActive:!0,type:"setDraggedFiles"}),Ht&&Ht(Co))})},[bt,Ht,Mn]),cu=reactExports.useCallback(function(Co){Co.preventDefault(),Co.persist(),m0(Co);var Bp=isEvtWithFiles(Co);if(Bp&&Co.dataTransfer)try{Co.dataTransfer.dropEffect="copy"}catch{}return Bp&&rr&&rr(Co),!1},[rr,Mn]),Jl=reactExports.useCallback(function(Co){Co.preventDefault(),Co.persist(),m0(Co);var Bp=Oo.current.filter(function(Q0){return Rn.current&&Rn.current.contains(Q0)}),a0=Bp.indexOf(Co.target);a0!==-1&&Bp.splice(a0,1),Oo.current=Bp,!(Bp.length>0)&&(ks({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),isEvtWithFiles(Co)&&tr&&tr(Co))},[Rn,tr,Mn]),mu=reactExports.useCallback(function(Co,Bp){var a0=[],Q0=[];Co.forEach(function(T0){var av=fileAccepted(T0,ut),lv=_slicedToArray(av,2),N0=lv[0],zv=lv[1],Uv=fileMatchSize(T0,Mt,St),Gv=_slicedToArray(Uv,2),Dv=Gv[0],Cv=Gv[1],Kp=$n?$n(T0):null;if(N0&&Dv&&!Kp)a0.push(T0);else{var sv=[zv,Cv];Kp&&(sv=sv.concat(Kp)),Q0.push({file:T0,errors:sv.filter(function(Hv){return Hv})})}}),(!Bt&&a0.length>1||Bt&&Ut>=1&&a0.length>Ut)&&(a0.forEach(function(T0){Q0.push({file:T0,errors:[TOO_MANY_FILES_REJECTION]})}),a0.splice(0)),ks({acceptedFiles:a0,fileRejections:Q0,type:"setFiles"}),sr&&sr(a0,Q0,Bp),Q0.length>0&&cr&&cr(Q0,Bp),a0.length>0&&ar&&ar(a0,Bp)},[ks,Bt,ut,Mt,St,Ut,sr,ar,cr,$n]),pu=reactExports.useCallback(function(Co){Co.preventDefault(),Co.persist(),m0(Co),Oo.current=[],isEvtWithFiles(Co)&&Promise.resolve(bt(Co)).then(function(Bp){isPropagationStopped(Co)&&!Mn||mu(Bp,Co)}),ks({type:"reset"})},[bt,mu,Mn]),Zu=reactExports.useCallback(function(){if(eo.current){ks({type:"openDialog"}),en();var Co={multiple:Bt,types:filePickerOptionsTypes(ut)};window.showOpenFilePicker(Co).then(function(Bp){return bt(Bp)}).then(function(Bp){mu(Bp,null),ks({type:"closeDialog"})}).catch(function(Bp){isAbort(Bp)?(In(Bp),ks({type:"closeDialog"})):isSecurityError(Bp)&&(eo.current=!1,qn.current&&(qn.current.value=null,qn.current.click()))});return}qn.current&&(ks({type:"openDialog"}),en(),qn.current.value=null,qn.current.click())},[ks,en,In,Dr,mu,ut,Bt]),Mp=reactExports.useCallback(function(Co){!Rn.current||!Rn.current.isEqualNode(Co.target)||(Co.key===" "||Co.key==="Enter"||Co.keyCode===32||Co.keyCode===13)&&(Co.preventDefault(),Zu())},[Rn,Zu]),Up=reactExports.useCallback(function(){ks({type:"focus"})},[]),Ep=reactExports.useCallback(function(){ks({type:"blur"})},[]),mp=reactExports.useCallback(function(){Br||(isIeOrEdge()?setTimeout(Zu,0):Zu())},[Br,Zu]),Cp=function(Bp){return mt?null:Bp},t0=function(Bp){return Jr?null:Cp(Bp)},_g=function(Bp){return mn?null:Cp(Bp)},m0=function(Bp){Mn&&Bp.stopPropagation()},K0=reactExports.useMemo(function(){return function(){var Co=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Bp=Co.refKey,a0=Bp===void 0?"ref":Bp,Q0=Co.role,T0=Co.onKeyDown,av=Co.onFocus,lv=Co.onBlur,N0=Co.onClick,zv=Co.onDragEnter,Uv=Co.onDragOver,Gv=Co.onDragLeave,Dv=Co.onDrop,Cv=_objectWithoutProperties(Co,_excluded3);return _objectSpread(_objectSpread(_defineProperty({onKeyDown:t0(composeEventHandlers(T0,Mp)),onFocus:t0(composeEventHandlers(av,Up)),onBlur:t0(composeEventHandlers(lv,Ep)),onClick:Cp(composeEventHandlers(N0,mp)),onDragEnter:_g(composeEventHandlers(zv,uu)),onDragOver:_g(composeEventHandlers(Uv,cu)),onDragLeave:_g(composeEventHandlers(Gv,Jl)),onDrop:_g(composeEventHandlers(Dv,pu)),role:typeof Q0=="string"&&Q0!==""?Q0:"button"},a0,Rn),!mt&&!Jr?{tabIndex:0}:{}),Cv)}},[Rn,Mp,Up,Ep,mp,uu,cu,Jl,pu,Jr,mn,mt]),Jp=reactExports.useCallback(function(Co){Co.stopPropagation()},[]),y0=reactExports.useMemo(function(){return function(){var Co=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Bp=Co.refKey,a0=Bp===void 0?"ref":Bp,Q0=Co.onChange,T0=Co.onClick,av=_objectWithoutProperties(Co,_excluded4),lv=_defineProperty({accept:ut,multiple:Bt,type:"file",style:{display:"none"},onChange:Cp(composeEventHandlers(Q0,pu)),onClick:Cp(composeEventHandlers(T0,Jp)),tabIndex:-1},a0,qn);return _objectSpread(_objectSpread({},lv),av)}},[qn,ut,Bt,pu,mt]),z0=Ss.length,jm=z0>0&&allFilesAccepted({files:Ss,accept:ut,minSize:Mt,maxSize:St,multiple:Bt,maxFiles:Ut}),Nu=z0>0&&!jm;return _objectSpread(_objectSpread({},cs),{},{isDragAccept:jm,isDragReject:Nu,isFocused:_o&&!mt,getRootProps:K0,getInputProps:y0,rootRef:Rn,inputRef:qn,open:Cp(Zu)})}function reducer(rt,_){switch(_.type){case"focus":return _objectSpread(_objectSpread({},rt),{},{isFocused:!0});case"blur":return _objectSpread(_objectSpread({},rt),{},{isFocused:!1});case"openDialog":return _objectSpread(_objectSpread({},initialState),{},{isFileDialogActive:!0});case"closeDialog":return _objectSpread(_objectSpread({},rt),{},{isFileDialogActive:!1});case"setDraggedFiles":var ut=_.isDragActive,mt=_.draggedFiles;return _objectSpread(_objectSpread({},rt),{},{draggedFiles:mt,isDragActive:ut});case"setFiles":return _objectSpread(_objectSpread({},rt),{},{acceptedFiles:_.acceptedFiles,fileRejections:_.fileRejections});case"reset":return _objectSpread({},initialState);default:return rt}}function noop(){}/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isobject=function rt(_){return _!=null&&typeof _=="object"&&Array.isArray(_)===!1};/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isObject$6=isobject;function isObjectObject(rt){return isObject$6(rt)===!0&&Object.prototype.toString.call(rt)==="[object Object]"}var isPlainObject$2=function rt(_){var ut,mt;return!(isObjectObject(_)===!1||(ut=_.constructor,typeof ut!="function")||(mt=ut.prototype,isObjectObject(mt)===!1)||mt.hasOwnProperty("isPrototypeOf")===!1)};/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var isPlainObject$1=isPlainObject$2,isExtendable$4=function rt(_){return isPlainObject$1(_)||typeof _=="function"||Array.isArray(_)};/*!
 * for-in <https://github.com/jonschlinkert/for-in>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var forIn$1=function rt(_,ut,mt){for(var bt in _)if(ut.call(mt,_[bt],bt,_)===!1)break},isExtendable$3=isExtendable$4,forIn=forIn$1;function mixinDeep(rt,_){for(var ut=arguments.length,mt=0;++mt<ut;){var bt=arguments[mt];isObject$5(bt)&&forIn(bt,copy,rt)}return rt}function copy(rt,_){if(isValidKey$1(_)){var ut=this[_];isObject$5(rt)&&isObject$5(ut)?mixinDeep(ut,rt):this[_]=rt}}function isObject$5(rt){return isExtendable$3(rt)&&!Array.isArray(rt)}function isValidKey$1(rt){return rt!=="__proto__"&&rt!=="constructor"&&rt!=="prototype"}var mixinDeep_1=mixinDeep;/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var getValue$1=function(rt,_,ut,mt,bt){if(!isObject$4(rt)||!_)return rt;if(_=toString(_),ut&&(_+="."+toString(ut)),mt&&(_+="."+toString(mt)),bt&&(_+="."+toString(bt)),_ in rt)return rt[_];for(var St=_.split("."),Mt=St.length,Bt=-1;rt&&++Bt<Mt;){for(var Ut=St[Bt];Ut[Ut.length-1]==="\\";)Ut=Ut.slice(0,-1)+"."+St[++Bt];rt=rt[Ut]}return rt};function isObject$4(rt){return rt!==null&&(typeof rt=="object"||typeof rt=="function")}function toString(rt){return rt?Array.isArray(rt)?rt.join("."):rt:""}/*!
 * assign-symbols <https://github.com/jonschlinkert/assign-symbols>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var assignSymbols$1=function(rt,_){if(rt===null||typeof rt>"u")throw new TypeError("expected first argument to be an object.");if(typeof _>"u"||typeof Symbol>"u"||typeof Object.getOwnPropertySymbols!="function")return rt;for(var ut=Object.prototype.propertyIsEnumerable,mt=Object(rt),bt=arguments.length,St=0;++St<bt;)for(var Mt=Object(arguments[St]),Bt=Object.getOwnPropertySymbols(Mt),Ut=0;Ut<Bt.length;Ut++){var Ht=Bt[Ut];ut.call(Mt,Ht)&&(mt[Ht]=Mt[Ht])}return mt},isExtendable$2=isExtendable$4,assignSymbols=assignSymbols$1,extendShallow$1=Object.assign||function(rt){if(rt===null||typeof rt>"u")throw new TypeError("Cannot convert undefined or null to object");isObject$3(rt)||(rt={});for(var _=1;_<arguments.length;_++){var ut=arguments[_];isString(ut)&&(ut=toObject(ut)),isObject$3(ut)&&(assign$1(rt,ut),assignSymbols(rt,ut))}return rt};function assign$1(rt,_){for(var ut in _)hasOwn$1(_,ut)&&(rt[ut]=_[ut])}function isString(rt){return rt&&typeof rt=="string"}function toObject(rt){var _={};for(var ut in rt)_[ut]=rt[ut];return _}function isObject$3(rt){return rt&&typeof rt=="object"||isExtendable$2(rt)}function hasOwn$1(rt,_){return Object.prototype.hasOwnProperty.call(rt,_)}/*!
 * split-string <https://github.com/jonschlinkert/split-string>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var extend$1=extendShallow$1,splitString=function(rt,_,ut){if(typeof rt!="string")throw new TypeError("expected a string");typeof _=="function"&&(ut=_,_=null),typeof _=="string"&&(_={sep:_});var mt=extend$1({sep:"."},_),bt=mt.quotes||['"',"'","`"],St;mt.brackets===!0?St={"<":">","(":")","[":"]","{":"}"}:mt.brackets&&(St=mt.brackets);var Mt=[],Bt=[],Ut=[""],Ht=mt.sep,tr=rt.length,rr=-1,sr;function ar(){if(St&&Bt.length)return St[Bt[Bt.length-1]]}for(;++rr<tr;){var cr=rt[rr],Ar=rt[rr+1],_r={val:cr,idx:rr,arr:Ut,str:rt};if(Mt.push(_r),cr==="\\"){_r.val=keepEscaping(mt,rt,rr)===!0?cr+Ar:Ar,_r.escaped=!0,typeof ut=="function"&&ut(_r),Ut[Ut.length-1]+=_r.val,rr++;continue}if(St&&St[cr]){Bt.push(cr);var Dr=ar(),$r=rr+1;if(rt.indexOf(Dr,$r+1)!==-1)for(;Bt.length&&$r<tr;){var Br=rt[++$r];if(Br==="\\"){Br++;continue}if(bt.indexOf(Br)!==-1){$r=getClosingQuote(rt,Br,$r+1);continue}if(Dr=ar(),Bt.length&&rt.indexOf(Dr,$r+1)===-1)break;if(St[Br]){Bt.push(Br);continue}Dr===Br&&Bt.pop()}if(sr=$r,sr===-1){Ut[Ut.length-1]+=cr;continue}cr=rt.slice(rr,sr+1),_r.val=cr,_r.idx=rr=sr}if(bt.indexOf(cr)!==-1){if(sr=getClosingQuote(rt,cr,rr+1),sr===-1){Ut[Ut.length-1]+=cr;continue}keepQuotes(cr,mt)===!0?cr=rt.slice(rr,sr+1):cr=rt.slice(rr+1,sr),_r.val=cr,_r.idx=rr=sr}if(typeof ut=="function"&&(ut(_r,Mt),cr=_r.val,rr=_r.idx),_r.val===Ht&&_r.split!==!1){Ut.push("");continue}Ut[Ut.length-1]+=_r.val}return Ut};function getClosingQuote(rt,_,ut,mt){var bt=rt.indexOf(_,ut);return rt.charAt(bt-1)==="\\"?getClosingQuote(rt,_,bt+1):bt}function keepQuotes(rt,_){return _.keepDoubleQuotes===!0&&rt==='"'||_.keepSingleQuotes===!0&&rt==="'"?!0:_.keepQuotes}function keepEscaping(rt,_,ut){return typeof rt.keepEscaping=="function"?rt.keepEscaping(_,ut):rt.keepEscaping===!0||_[ut+1]==="\\"}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var isExtendable$1=function rt(_){return typeof _<"u"&&_!==null&&(typeof _=="object"||typeof _=="function")},isObject$2=isExtendable$1,extendShallow=function rt(_){isObject$2(_)||(_={});for(var ut=arguments.length,mt=1;mt<ut;mt++){var bt=arguments[mt];isObject$2(bt)&&assign(_,bt)}return _};function assign(rt,_){for(var ut in _)hasOwn(_,ut)&&(rt[ut]=_[ut])}function hasOwn(rt,_){return Object.prototype.hasOwnProperty.call(rt,_)}/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var isExtendable=function rt(_){return typeof _<"u"&&_!==null&&(typeof _=="object"||typeof _=="function")};/*!
 * set-value <https://github.com/jonschlinkert/set-value>
 *
 * Copyright (c) 2014-2015, 2017, Jon Schlinkert.
 * Released under the MIT License.
 */var split=splitString,extend=extendShallow,isPlainObject=isPlainObject$2,isObject$1=isExtendable,setValue=function(rt,_,ut){if(!isObject$1(rt)||(Array.isArray(_)&&(_=[].concat.apply([],_).join(".")),typeof _!="string"))return rt;for(var mt=split(_,{sep:".",brackets:!0}).filter(isValidKey),bt=mt.length,St=-1,Mt=rt;++St<bt;){var Bt=mt[St];if(St!==bt-1){isObject$1(Mt[Bt])||(Mt[Bt]={}),Mt=Mt[Bt];continue}isPlainObject(Mt[Bt])&&isPlainObject(ut)?Mt[Bt]=extend({},Mt[Bt],ut):Mt[Bt]=ut}return rt};function isValidKey(rt){return rt!=="__proto__"&&rt!=="constructor"&&rt!=="prototype"}var isObject=isExtendable$4,merge=mixinDeep_1,get=getValue$1,set=setValue,mergeValue=function rt(_,ut,mt){if(!isObject(_))throw new TypeError("expected an object");if(typeof ut!="string"||mt==null)return merge.apply(null,arguments);if(typeof mt=="string")return set(_,ut,mt),_;var bt=get(_,ut);return isObject(mt)&&isObject(bt)&&(mt=merge({},bt,mt)),set(_,ut,mt),_};const merge$1=getDefaultExportFromCjs(mergeValue),join=(...rt)=>rt.filter(Boolean).join(".");function getKeyPath(rt){const _=rt.split(".");return[_.pop(),_.join(".")||void 0]}function getValuesForPaths(rt,_){return Object.entries(pick(rt,_)).reduce((ut,[,{value:mt,disabled:bt,key:St}])=>(ut[St]=bt?void 0:mt,ut),{})}function useCompareMemoize(rt,_){const ut=reactExports.useRef();return dequal(rt,ut.current)||(ut.current=rt),ut.current}function useDeepMemo(rt,_){return reactExports.useMemo(rt,useCompareMemoize(_))}function useToggle(rt){const _=reactExports.useRef(null),ut=reactExports.useRef(null),mt=reactExports.useRef(!0);return reactExports.useLayoutEffect(()=>{rt||(_.current.style.height="0px",_.current.style.overflow="hidden")},[]),reactExports.useEffect(()=>{if(mt.current){mt.current=!1;return}let bt;const St=_.current,Mt=()=>{rt&&(St.style.removeProperty("height"),St.style.removeProperty("overflow"),ut.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};St.addEventListener("transitionend",Mt,{once:!0});const{height:Bt}=ut.current.getBoundingClientRect();return St.style.height=Bt+"px",rt||(St.style.overflow="hidden",bt=window.setTimeout(()=>St.style.height="0px",50)),()=>{St.removeEventListener("transitionend",Mt),clearTimeout(bt)}},[rt]),{wrapperRef:_,contentRef:ut}}const useVisiblePaths=rt=>{const[_,ut]=reactExports.useState(rt.getVisiblePaths());return reactExports.useEffect(()=>{ut(rt.getVisiblePaths());const mt=rt.useStore.subscribe(rt.getVisiblePaths,ut,{equalityFn:shallow});return()=>mt()},[rt]),_};function useValuesForPath(rt,_,ut){return rt.useStore(bt=>{const St=_objectSpread2(_objectSpread2({},ut),bt.data);return getValuesForPaths(St,_)},shallow)}function usePopin(rt=3){const _=reactExports.useRef(null),ut=reactExports.useRef(null),[mt,bt]=reactExports.useState(!1),St=reactExports.useCallback(()=>bt(!0),[]),Mt=reactExports.useCallback(()=>bt(!1),[]);return reactExports.useLayoutEffect(()=>{if(mt){const{bottom:Bt,top:Ut,left:Ht}=_.current.getBoundingClientRect(),{height:tr}=ut.current.getBoundingClientRect(),rr=Bt+tr>window.innerHeight-40?"up":"down";ut.current.style.position="fixed",ut.current.style.zIndex="10000",ut.current.style.left=Ht+"px",rr==="down"?ut.current.style.top=Bt+rt+"px":ut.current.style.bottom=window.innerHeight-Ut+rt+"px"}},[rt,mt]),{popinRef:_,wrapperRef:ut,shown:mt,show:St,hide:Mt}}k$1([namesPlugin]);const convertMap={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};v8n.extend({color:()=>rt=>w(rt).isValid()});const schema$2=rt=>v8n().color().test(rt);function convert(rt,{format:_,hasAlpha:ut,isString:mt}){const bt=convertMap[_]+(mt&&_!=="hex"?"String":""),St=rt[bt]();return typeof St=="object"&&!ut?omit(St,["a"]):St}const sanitize$2=(rt,_)=>{const ut=w(rt);if(!ut.isValid())throw Error("Invalid color");return convert(ut,_)},format$1=(rt,_)=>convert(w(rt),_objectSpread2(_objectSpread2({},_),{},{isString:!0,format:"hex"})),normalize$3=({value:rt})=>{const _=I$1(rt),ut=_==="name"?"hex":_,mt=typeof rt=="object"?"a"in rt:_==="hex"&&rt.length===8||/^(rgba)|(hsla)|(hsva)/.test(rt),bt={format:ut,hasAlpha:mt,isString:typeof rt=="string"};return{value:sanitize$2(rt,bt),settings:bt}};var props$2=Object.freeze({__proto__:null,schema:schema$2,sanitize:sanitize$2,format:format$1,normalize:normalize$3});const ColorPreview=styled("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),PickerContainer=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),PickerWrapper=styled("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function convertToRgb(rt,_){return _!=="rgb"?w(rt).toRgb():rt}function Color({value:rt,displayValue:_,settings:ut,onUpdate:mt}){const{emitOnEditStart:bt,emitOnEditEnd:St}=useInputContext(),{format:Mt,hasAlpha:Bt}=ut,{popinRef:Ut,wrapperRef:Ht,shown:tr,show:rr,hide:sr}=usePopin(),ar=reactExports.useRef(0),[cr,Ar]=reactExports.useState(()=>convertToRgb(rt,Mt)),_r=Bt?Ce:Ne,Dr=()=>{Ar(convertToRgb(rt,Mt)),rr(),bt()},$r=()=>{sr(),St(),window.clearTimeout(ar.current)},Br=()=>{ar.current=window.setTimeout($r,500)};return reactExports.useEffect(()=>()=>window.clearTimeout(ar.current),[]),React.createElement(React.Fragment,null,React.createElement(ColorPreview,{ref:Ut,active:tr,onClick:()=>Dr(),style:{color:_}}),tr&&React.createElement(Portal,null,React.createElement(Overlay,{onPointerUp:$r}),React.createElement(PickerWrapper,{ref:Ht,onMouseEnter:()=>window.clearTimeout(ar.current),onMouseLeave:Jr=>Jr.buttons===0&&Br()},React.createElement(_r,{color:cr,onChange:mt}))))}function ColorComponent(){const{value:rt,displayValue:_,label:ut,onChange:mt,onUpdate:bt,settings:St}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,ut),React.createElement(PickerContainer,null,React.createElement(Color,{value:rt,displayValue:_,onChange:mt,onUpdate:bt,settings:St}),React.createElement(ValueInput,{value:_,onChange:mt,onUpdate:bt})))}var color$1=_objectSpread2({component:ColorComponent},props$2);function Vector3dComponent(){const{label:rt,displayValue:_,onUpdate:ut,settings:mt}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,rt),React.createElement(Vector,{value:_,settings:mt,onUpdate:ut}))}var vector3d=_objectSpread2({component:Vector3dComponent},getVectorPlugin(["x","y","z"]));const JoystickTrigger=styled("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),JoystickPlayground=styled("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function Joystick({value:rt,settings:_,onUpdate:ut}){const mt=reactExports.useRef(),bt=reactExports.useRef(0),St=reactExports.useRef(0),Mt=reactExports.useRef(1),[Bt,Ut]=reactExports.useState(!1),[Ht,tr]=reactExports.useState(!1),[rr,sr]=useTransform(),ar=reactExports.useRef(null),cr=reactExports.useRef(null);reactExports.useLayoutEffect(()=>{if(Bt){const{top:Qn,left:xs,width:cs,height:ks}=ar.current.getBoundingClientRect();cr.current.style.left=xs+cs/2+"px",cr.current.style.top=Qn+ks/2+"px"}},[Bt]);const{keys:[Ar,_r],joystick:Dr}=_,$r=Dr==="invertY"?1:-1,{[Ar]:{step:Br},[_r]:{step:Jr}}=_,mn=useTh("sizes","joystickWidth"),Mn=useTh("sizes","joystickHeight"),$n=parseFloat(mn)*.8/2,en=parseFloat(Mn)*.8/2,In=reactExports.useCallback(()=>{mt.current||(tr(!0),bt.current&&sr({x:bt.current*$n}),St.current&&sr({y:St.current*-en}),mt.current=window.setInterval(()=>{ut(Qn=>{const xs=Br*bt.current*Mt.current,cs=$r*Jr*St.current*Mt.current;return Array.isArray(Qn)?{[Ar]:Qn[0]+xs,[_r]:Qn[1]+cs}:{[Ar]:Qn[Ar]+xs,[_r]:Qn[_r]+cs}})},16))},[$n,en,ut,sr,Br,Jr,Ar,_r,$r]),Rn=reactExports.useCallback(()=>{window.clearTimeout(mt.current),mt.current=void 0,tr(!1)},[]);reactExports.useEffect(()=>{function Qn(xs){Mt.current=multiplyStep(xs)}return window.addEventListener("keydown",Qn),window.addEventListener("keyup",Qn),()=>{window.clearTimeout(mt.current),window.removeEventListener("keydown",Qn),window.removeEventListener("keyup",Qn)}},[]);const qn=useDrag(({first:Qn,active:xs,delta:[cs,ks],movement:[_o,qs]})=>{Qn&&Ut(!0);const Ss=clamp$1(_o,-$n,$n),eo=clamp$1(qs,-en,en);bt.current=Math.abs(_o)>Math.abs(Ss)?Math.sign(_o-Ss):0,St.current=Math.abs(qs)>Math.abs(eo)?Math.sign(eo-qs):0;let Ao=rt[Ar],Oo=rt[_r];xs?(bt.current||(Ao+=cs*Br*Mt.current,sr({x:Ss})),St.current||(Oo-=$r*ks*Jr*Mt.current,sr({y:eo})),bt.current||St.current?In():Rn(),ut({[Ar]:Ao,[_r]:Oo})):(Ut(!1),bt.current=0,St.current=0,sr({x:0,y:0}),Rn())});return React.createElement(JoystickTrigger,_extends({ref:ar},qn()),Bt&&React.createElement(Portal,null,React.createElement(JoystickPlayground,{ref:cr,isOutOfBounds:Ht},React.createElement("div",null),React.createElement("span",{ref:rr}))))}const Container$1=styled("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function Vector2dComponent(){const{label:rt,displayValue:_,onUpdate:ut,settings:mt}=useInputContext();return React.createElement(Row,{input:!0},React.createElement(Label,null,rt),React.createElement(Container$1,{withJoystick:!!mt.joystick},mt.joystick&&React.createElement(Joystick,{value:_,settings:mt,onUpdate:ut}),React.createElement(Vector,{value:_,settings:mt,onUpdate:ut})))}const _excluded$7=["joystick"],plugin=getVectorPlugin(["x","y"]),normalize$2=rt=>{let{joystick:_=!0}=rt,ut=_objectWithoutProperties$1(rt,_excluded$7);const{value:mt,settings:bt}=plugin.normalize(ut);return{value:mt,settings:_objectSpread2(_objectSpread2({},bt),{},{joystick:_})}};var vector2d=_objectSpread2(_objectSpread2({component:Vector2dComponent},plugin),{},{normalize:normalize$2});const sanitize$1=rt=>{if(rt!==void 0){if(rt instanceof File)try{return URL.createObjectURL(rt)}catch{return}if(typeof rt=="string"&&rt.indexOf("blob:")===0)return rt;throw Error("Invalid image format [undefined | blob | File].")}},schema$1=(rt,_)=>typeof _=="object"&&"image"in _,normalize$1=({image:rt})=>({value:rt});var props$1=Object.freeze({__proto__:null,sanitize:sanitize$1,schema:schema$1,normalize:normalize$1});const ImageContainer=styled("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),DropZone=styled("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),ImagePreview=styled("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),ImageLargePreview=styled("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),Instructions=styled("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),Remove=styled("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function ImageComponent(){const{label:rt,value:_,onUpdate:ut,disabled:mt}=useInputContext(),{popinRef:bt,wrapperRef:St,shown:Mt,show:Bt,hide:Ut}=usePopin(),Ht=reactExports.useCallback(cr=>{cr.length&&ut(cr[0])},[ut]),tr=reactExports.useCallback(cr=>{cr.stopPropagation(),ut(void 0)},[ut]),{getRootProps:rr,getInputProps:sr,isDragAccept:ar}=useDropzone({maxFiles:1,accept:"image/*",onDrop:Ht,disabled:mt});return React.createElement(Row,{input:!0},React.createElement(Label,null,rt),React.createElement(ImageContainer,null,React.createElement(ImagePreview,{ref:bt,hasImage:!!_,onPointerDown:()=>!!_&&Bt(),onPointerUp:Ut,style:{backgroundImage:_?`url(${_})`:"none"}}),Mt&&!!_&&React.createElement(Portal,null,React.createElement(Overlay,{onPointerUp:Ut,style:{cursor:"pointer"}}),React.createElement(ImageLargePreview,{ref:St,style:{backgroundImage:`url(${_})`}})),React.createElement(DropZone,rr({isDragAccept:ar}),React.createElement("input",sr()),React.createElement(Instructions,null,ar?"drop image":"click or drop")),React.createElement(Remove,{onClick:tr,disabled:!_})))}var image=_objectSpread2({component:ImageComponent},props$1);const number=v8n().number(),schema=(rt,_)=>v8n().array().length(2).every.number().test(rt)&&v8n().schema({min:number,max:number}).test(_),format=rt=>({min:rt[0],max:rt[1]}),sanitize=(rt,{bounds:[_,ut]},mt)=>{const bt=Array.isArray(rt)?format(rt):rt,St={min:mt[0],max:mt[1]},{min:Mt,max:Bt}=_objectSpread2(_objectSpread2({},St),bt);return[clamp$1(Number(Mt),_,Math.max(_,Bt)),clamp$1(Number(Bt),Math.min(ut,Mt),ut)]},normalize$4=({value:rt,min:_,max:ut})=>{const mt={min:_,max:ut},bt=normalizeKeyedNumberSettings(format(rt),{min:mt,max:mt}),St=[_,ut],Mt=_objectSpread2(_objectSpread2({},bt),{},{bounds:St});return{value:sanitize(format(rt),Mt,rt),settings:Mt}};var props=Object.freeze({__proto__:null,schema,format,sanitize,normalize:normalize$4});const _excluded$6=["value","bounds","onDrag"],_excluded2$1=["bounds"],Container=styled("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function IntervalSlider(rt){let{value:_,bounds:[ut,mt],onDrag:bt}=rt,St=_objectWithoutProperties$1(rt,_excluded$6);const Mt=reactExports.useRef(null),Bt=reactExports.useRef(null),Ut=reactExports.useRef(null),Ht=reactExports.useRef(0),tr=useTh("sizes","scrubberWidth"),rr=useDrag(({event:cr,first:Ar,xy:[_r],movement:[Dr],memo:$r={}})=>{if(Ar){const{width:Jr,left:mn}=Mt.current.getBoundingClientRect();Ht.current=Jr-parseFloat(tr);const Mn=(cr==null?void 0:cr.target)===Bt.current||(cr==null?void 0:cr.target)===Ut.current;$r.pos=invertedRange((_r-mn)/Jr,ut,mt);const $n=Math.abs($r.pos-_.min)-Math.abs($r.pos-_.max);$r.key=$n<0||$n===0&&$r.pos<=_.min?"min":"max",Mn&&($r.pos=_[$r.key])}const Br=$r.pos+invertedRange(Dr/Ht.current,0,mt-ut);return bt({[$r.key]:sanitizeStep(Br,St[$r.key])}),$r}),sr=`calc(${range(_.min,ut,mt)} * (100% - ${tr} - 8px) + 4px)`,ar=`calc(${1-range(_.max,ut,mt)} * (100% - ${tr} - 8px) + 4px)`;return React.createElement(RangeWrapper,_extends({ref:Mt},rr()),React.createElement(Range,null,React.createElement(Indicator,{style:{left:sr,right:ar}})),React.createElement(Scrubber,{position:"left",ref:Bt,style:{left:sr}}),React.createElement(Scrubber,{position:"right",ref:Ut,style:{right:ar}}))}function IntervalComponent(){const{label:rt,displayValue:_,onUpdate:ut,settings:mt}=useInputContext(),bt=_objectWithoutProperties$1(mt,_excluded2$1);return React.createElement(React.Fragment,null,React.createElement(Row,{input:!0},React.createElement(Label,null,rt),React.createElement(Container,null,React.createElement(IntervalSlider,_extends({value:_},mt,{onDrag:ut})),React.createElement(Vector,{value:_,settings:bt,onUpdate:ut,innerLabelTrim:0}))))}var interval=_objectSpread2({component:IntervalComponent},props);const createEventEmitter=()=>{const rt=new Map;return{on:(_,ut)=>{let mt=rt.get(_);mt===void 0&&(mt=new Set,rt.set(_,mt)),mt.add(ut)},off:(_,ut)=>{const mt=rt.get(_);mt!==void 0&&(mt.delete(ut),mt.size===0&&rt.delete(_))},emit:(_,...ut)=>{const mt=rt.get(_);if(mt!==void 0)for(const bt of mt)bt(...ut)}}},_excluded$5=["type","value"],_excluded2=["onChange","transient","onEditStart","onEditEnd"],Store=function rt(){const _=create$1(subscribeWithSelector(()=>({data:{}}))),ut=createEventEmitter();this.storeId=getUid(),this.useStore=_;const mt={},bt=new Set;this.getVisiblePaths=()=>{const Mt=this.getData(),Bt=Object.keys(Mt),Ut=[];Object.entries(mt).forEach(([tr,rr])=>{rr.render&&Bt.some(sr=>sr.indexOf(tr)===0)&&!rr.render(this.get)&&Ut.push(tr+".")});const Ht=[];return bt.forEach(tr=>{tr in Mt&&Mt[tr].__refCount>0&&Ut.every(rr=>tr.indexOf(rr)===-1)&&(!Mt[tr].render||Mt[tr].render(this.get))&&Ht.push(tr)}),Ht},this.setOrderedPaths=Mt=>{Mt.forEach(Bt=>bt.add(Bt))},this.orderPaths=Mt=>(this.setOrderedPaths(Mt),Mt),this.disposePaths=Mt=>{_.setState(Bt=>{const Ut=Bt.data;return Mt.forEach(Ht=>{if(Ht in Ut){const tr=Ut[Ht];tr.__refCount--,tr.__refCount===0&&tr.type in SpecialInputs&&delete Ut[Ht]}}),{data:Ut}})},this.dispose=()=>{_.setState(()=>({data:{}}))},this.getFolderSettings=Mt=>mt[Mt]||{},this.getData=()=>_.getState().data,this.addData=(Mt,Bt)=>{_.setState(Ut=>{const Ht=Ut.data;return Object.entries(Mt).forEach(([tr,rr])=>{let sr=Ht[tr];if(sr){const{type:ar,value:cr}=rr,Ar=_objectWithoutProperties$1(rr,_excluded$5);ar!==sr.type?warn(LevaErrors.INPUT_TYPE_OVERRIDE,ar):((sr.__refCount===0||Bt)&&Object.assign(sr,Ar),sr.__refCount++)}else Ht[tr]=_objectSpread2(_objectSpread2({},rr),{},{__refCount:1})}),{data:Ht}})},this.setValueAtPath=(Mt,Bt,Ut)=>{_.setState(Ht=>{const tr=Ht.data;return updateInput(tr[Mt],Bt,Mt,this,Ut),{data:tr}})},this.setSettingsAtPath=(Mt,Bt)=>{_.setState(Ut=>{const Ht=Ut.data;return Ht[Mt].settings=_objectSpread2(_objectSpread2({},Ht[Mt].settings),Bt),{data:Ht}})},this.disableInputAtPath=(Mt,Bt)=>{_.setState(Ut=>{const Ht=Ut.data;return Ht[Mt].disabled=Bt,{data:Ht}})},this.set=(Mt,Bt)=>{_.setState(Ut=>{const Ht=Ut.data;return Object.entries(Mt).forEach(([tr,rr])=>{try{updateInput(Ht[tr],rr,void 0,void 0,Bt)}catch{}}),{data:Ht}})},this.getInput=Mt=>{try{return this.getData()[Mt]}catch{warn(LevaErrors.PATH_DOESNT_EXIST,Mt)}},this.get=Mt=>{var Bt;return(Bt=this.getInput(Mt))===null||Bt===void 0?void 0:Bt.value},this.emitOnEditStart=Mt=>{ut.emit(`onEditStart:${Mt}`,this.get(Mt),Mt,_objectSpread2(_objectSpread2({},this.getInput(Mt)),{},{get:this.get}))},this.emitOnEditEnd=Mt=>{ut.emit(`onEditEnd:${Mt}`,this.get(Mt),Mt,_objectSpread2(_objectSpread2({},this.getInput(Mt)),{},{get:this.get}))},this.subscribeToEditStart=(Mt,Bt)=>{const Ut=`onEditStart:${Mt}`;return ut.on(Ut,Bt),()=>ut.off(Ut,Bt)},this.subscribeToEditEnd=(Mt,Bt)=>{const Ut=`onEditEnd:${Mt}`;return ut.on(Ut,Bt),()=>ut.off(Ut,Bt)};const St=(Mt,Bt,Ut)=>{const Ht={};return Object.entries(Mt).forEach(([tr,rr])=>{if(tr==="")return warn(LevaErrors.EMPTY_KEY);let sr=join(Bt,tr);if(rr.type===SpecialInputs.FOLDER){const ar=St(rr.schema,sr,Ut);Object.assign(Ht,ar),sr in mt||(mt[sr]=rr.settings)}else if(tr in Ut)warn(LevaErrors.DUPLICATE_KEYS,tr,sr,Ut[tr].path);else{const ar=normalizeInput(rr,tr,sr,Ht);if(ar){const{type:cr,options:Ar,input:_r}=ar,{onChange:Dr,transient:$r,onEditStart:Br,onEditEnd:Jr}=Ar,mn=_objectWithoutProperties$1(Ar,_excluded2);Ht[sr]=_objectSpread2(_objectSpread2(_objectSpread2({type:cr},mn),_r),{},{fromPanel:!0}),Ut[tr]={path:sr,onChange:Dr,transient:$r,onEditStart:Br,onEditEnd:Jr}}else warn(LevaErrors.UNKNOWN_INPUT,sr,rr)}}),Ht};this.getDataFromSchema=Mt=>{const Bt={};return[St(Mt,"",Bt),Bt]}},levaStore=new Store,defaultSettings$2={collapsed:!1};function folder(rt,_){return{type:SpecialInputs.FOLDER,schema:rt,settings:_objectSpread2(_objectSpread2({},defaultSettings$2),_)}}const isInput=rt=>"__levaInput"in rt,buildTree=(rt,_)=>{const ut={},mt=_?_.toLowerCase():null;return rt.forEach(bt=>{const[St,Mt]=getKeyPath(bt);(!mt||St.toLowerCase().indexOf(mt)>-1)&&merge$1(ut,Mt,{[St]:{__levaInput:!0,path:bt}})}),ut},_excluded$4=["type","label","path","valueKey","value","settings","setValue","disabled"];function ControlInput(rt){let{type:_,label:ut,path:mt,valueKey:bt,value:St,settings:Mt,setValue:Bt,disabled:Ut}=rt,Ht=_objectWithoutProperties$1(rt,_excluded$4);const{displayValue:tr,onChange:rr,onUpdate:sr}=useInputSetters({type:_,value:St,settings:Mt,setValue:Bt}),ar=Plugins[_].component;return ar?React.createElement(InputContext.Provider,{value:_objectSpread2({key:bt,path:mt,id:""+mt,label:ut,displayValue:tr,value:St,onChange:rr,onUpdate:sr,settings:Mt,setValue:Bt,disabled:Ut},Ht)},React.createElement(StyledInputWrapper$1,{disabled:Ut},React.createElement(ar,null))):(warn(LevaErrors.NO_COMPONENT_FOR_TYPE,_,mt),null)}const StyledButton=styled("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function Button({onClick:rt,settings:_,label:ut}){const mt=useStoreContext();return React.createElement(Row,null,React.createElement(StyledButton,{disabled:_.disabled,onClick:()=>rt(mt.get)},ut))}const StyledButtonGroup=styled("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),StyledButtonGroupButton=styled("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),getOpts=({label:rt,opts:_})=>{let ut=typeof rt=="string"&&rt.trim()===""?null:rt,mt=_;return typeof _.opts=="object"&&(mt.label!==void 0&&(ut=_.label),mt=_.opts),{label:ut,opts:mt}};function ButtonGroup(rt){const{label:_,opts:ut}=getOpts(rt),mt=useStoreContext();return React.createElement(Row,{input:!!_},_&&React.createElement(Label,null,_),React.createElement(StyledButtonGroup,null,Object.entries(ut).map(([bt,St])=>React.createElement(StyledButtonGroupButton,{key:bt,onClick:()=>St(mt.get)},bt))))}const Canvas=styled("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),POINTS=100;function push(rt,_){rt.push(_),rt.length>POINTS&&rt.shift()}const MonitorCanvas=reactExports.forwardRef(function({initialValue:rt},_){const ut=useTh("colors","highlight3"),mt=useTh("colors","elevation2"),bt=useTh("colors","highlight1"),[St,Mt]=reactExports.useMemo(()=>[w(bt).alpha(.4).toRgbString(),w(bt).alpha(.1).toRgbString()],[bt]),Bt=reactExports.useRef([rt]),Ut=reactExports.useRef(rt),Ht=reactExports.useRef(rt),tr=reactExports.useRef(),rr=reactExports.useCallback((cr,Ar)=>{if(!cr)return;const{width:_r,height:Dr}=cr,$r=new Path2D,Br=_r/POINTS,Jr=Dr*.05;for(let $n=0;$n<Bt.current.length;$n++){const en=range(Bt.current[$n],Ut.current,Ht.current),In=Br*$n,Rn=Dr-en*(Dr-Jr*2)-Jr;$r.lineTo(In,Rn)}Ar.clearRect(0,0,_r,Dr);const mn=new Path2D($r);mn.lineTo(Br*(Bt.current.length+1),Dr),mn.lineTo(0,Dr),mn.lineTo(0,0);const Mn=Ar.createLinearGradient(0,0,0,Dr);Mn.addColorStop(0,St),Mn.addColorStop(1,Mt),Ar.fillStyle=Mn,Ar.fill(mn),Ar.strokeStyle=mt,Ar.lineJoin="round",Ar.lineWidth=14,Ar.stroke($r),Ar.strokeStyle=ut,Ar.lineWidth=2,Ar.stroke($r)},[ut,mt,St,Mt]),[sr,ar]=useCanvas2d(rr);return reactExports.useImperativeHandle(_,()=>({frame:cr=>{(Ut.current===void 0||cr<Ut.current)&&(Ut.current=cr),(Ht.current===void 0||cr>Ht.current)&&(Ht.current=cr),push(Bt.current,cr),tr.current=requestAnimationFrame(()=>rr(sr.current,ar.current))}}),[sr,ar,rr]),reactExports.useEffect(()=>()=>cancelAnimationFrame(tr.current),[]),React.createElement(Canvas,{ref:sr})}),parse=rt=>Number.isFinite(rt)?rt.toPrecision(2):rt.toString(),MonitorLog=reactExports.forwardRef(function({initialValue:rt},_){const[ut,mt]=reactExports.useState(parse(rt));return reactExports.useImperativeHandle(_,()=>({frame:bt=>mt(parse(bt))}),[]),React.createElement("div",null,ut)});function getValue(rt){return typeof rt=="function"?rt():rt.current}function Monitor({label:rt,objectOrFn:_,settings:ut}){const mt=reactExports.useRef(),bt=reactExports.useRef(getValue(_));return reactExports.useEffect(()=>{const St=window.setInterval(()=>{var Mt;document.hidden||(Mt=mt.current)===null||Mt===void 0||Mt.frame(getValue(_))},ut.interval);return()=>window.clearInterval(St)},[_,ut.interval]),React.createElement(Row,{input:!0},React.createElement(Label,{align:"top"},rt),ut.graph?React.createElement(MonitorCanvas,{ref:mt,initialValue:bt.current}):React.createElement(MonitorLog,{ref:mt,initialValue:bt.current}))}const _excluded$3=["type","label","key"],specialComponents={[SpecialInputs.BUTTON]:Button,[SpecialInputs.BUTTON_GROUP]:ButtonGroup,[SpecialInputs.MONITOR]:Monitor},Control=React.memo(({path:rt})=>{const[_,{set:ut,setSettings:mt,disable:bt,storeId:St,emitOnEditStart:Mt,emitOnEditEnd:Bt}]=useInput(rt);if(!_)return null;const{type:Ut,label:Ht,key:tr}=_,rr=_objectWithoutProperties$1(_,_excluded$3);if(Ut in SpecialInputs){const sr=specialComponents[Ut];return React.createElement(sr,_extends({label:Ht,path:rt},rr))}return Ut in Plugins?React.createElement(ControlInput,_extends({key:St+rt,type:Ut,label:Ht,storeId:St,path:rt,valueKey:tr,setValue:ut,setSettings:mt,disable:bt,emitOnEditStart:Mt,emitOnEditEnd:Bt},rr)):(log(LevaErrors.UNSUPPORTED_INPUT,Ut,rt),null)});function FolderTitle({toggle:rt,toggled:_,name:ut}){return React.createElement(StyledTitle,{onClick:()=>rt()},React.createElement(Chevron,{toggled:_}),React.createElement("div",null,ut))}const Folder=({name:rt,path:_,tree:ut})=>{const mt=useStoreContext(),bt=join(_,rt),{collapsed:St,color:Mt}=mt.getFolderSettings(bt),[Bt,Ut]=reactExports.useState(!St),Ht=reactExports.useRef(null),tr=useTh("colors","folderWidgetColor"),rr=useTh("colors","folderTextColor");return reactExports.useLayoutEffect(()=>{Ht.current.style.setProperty("--leva-colors-folderWidgetColor",Mt||tr),Ht.current.style.setProperty("--leva-colors-folderTextColor",Mt||rr)},[Mt,tr,rr]),React.createElement(StyledFolder,{ref:Ht},React.createElement(FolderTitle,{name:rt,toggled:Bt,toggle:()=>Ut(sr=>!sr)}),React.createElement(TreeWrapper,{parent:bt,tree:ut,toggled:Bt}))},TreeWrapper=React.memo(({isRoot:rt=!1,fill:_=!1,flat:ut=!1,parent:mt,tree:bt,toggled:St})=>{const{wrapperRef:Mt,contentRef:Bt}=useToggle(St),Ut=useStoreContext(),Ht=([rr,sr])=>{var ar;return(isInput(sr)?(ar=Ut.getInput(sr.path))===null||ar===void 0?void 0:ar.order:Ut.getFolderSettings(join(mt,rr)).order)||0},tr=Object.entries(bt).sort((rr,sr)=>Ht(rr)-Ht(sr));return React.createElement(StyledWrapper,{ref:Mt,isRoot:rt,fill:_,flat:ut},React.createElement(StyledContent,{ref:Bt,isRoot:rt,toggled:St},tr.map(([rr,sr])=>isInput(sr)?React.createElement(Control,{key:sr.path,valueKey:sr.valueKey,path:sr.path}):React.createElement(Folder,{key:rr,name:rr,path:mt,tree:sr}))))}),StyledRoot=styled("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${StyledInputRow}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),iconWidth=40,Icon=styled("i",{$flexCenter:"",width:iconWidth,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),StyledTitleWithFilter=styled("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),FilterWrapper=styled("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${Icon}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),StyledFilterInput=styled("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),TitleContainer=styled("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:iconWidth}}}}),FilterInput=React.forwardRef(({setFilter:rt,toggle:_},ut)=>{const[mt,bt]=reactExports.useState(""),St=reactExports.useMemo(()=>debounce(rt,250),[rt]),Mt=()=>{rt(""),bt("")},Bt=Ut=>{const Ht=Ut.currentTarget.value;_(!0),bt(Ht)};return reactExports.useEffect(()=>{St(mt)},[mt,St]),React.createElement(React.Fragment,null,React.createElement(StyledFilterInput,{ref:ut,value:mt,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:Ut=>Ut.stopPropagation(),onChange:Bt}),React.createElement(Icon,{onClick:()=>Mt(),style:{visibility:mt?"visible":"hidden"}},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function TitleWithFilter({setFilter:rt,onDrag:_,onDragStart:ut,onDragEnd:mt,toggle:bt,toggled:St,title:Mt,drag:Bt,filterEnabled:Ut,from:Ht}){const[tr,rr]=reactExports.useState(!1),sr=reactExports.useRef(null);reactExports.useEffect(()=>{var cr,Ar;tr?(cr=sr.current)===null||cr===void 0||cr.focus():(Ar=sr.current)===null||Ar===void 0||Ar.blur()},[tr]);const ar=useDrag(({offset:[cr,Ar],first:_r,last:Dr})=>{_({x:cr,y:Ar}),_r&&ut({x:cr,y:Ar}),Dr&&mt({x:cr,y:Ar})},{filterTaps:!0,from:({offset:[cr,Ar]})=>[(Ht==null?void 0:Ht.x)||cr,(Ht==null?void 0:Ht.y)||Ar]});return reactExports.useEffect(()=>{const cr=Ar=>{Ar.key==="L"&&Ar.shiftKey&&Ar.metaKey&&rr(_r=>!_r)};return window.addEventListener("keydown",cr),()=>window.removeEventListener("keydown",cr)},[]),React.createElement(React.Fragment,null,React.createElement(StyledTitleWithFilter,{mode:Bt?"drag":void 0},React.createElement(Icon,{active:!St,onClick:()=>bt()},React.createElement(Chevron,{toggled:St,width:12,height:8})),React.createElement(TitleContainer,_extends({},Bt?ar():{},{drag:Bt,filterEnabled:Ut}),Mt===void 0&&Bt?React.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},React.createElement("circle",{cx:"2",cy:"2",r:"2"}),React.createElement("circle",{cx:"14",cy:"2",r:"2"}),React.createElement("circle",{cx:"26",cy:"2",r:"2"}),React.createElement("circle",{cx:"2",cy:"12",r:"2"}),React.createElement("circle",{cx:"14",cy:"12",r:"2"}),React.createElement("circle",{cx:"26",cy:"12",r:"2"})):Mt),Ut&&React.createElement(Icon,{active:tr,onClick:()=>rr(cr=>!cr)},React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},React.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),React.createElement(FilterWrapper,{toggled:tr},React.createElement(FilterInput,{ref:sr,setFilter:rt,toggle:bt})))}const _excluded$2=["store","hidden","theme","collapsed"];function LevaRoot(rt){let{store:_,hidden:ut=!1,theme:mt,collapsed:bt=!1}=rt,St=_objectWithoutProperties$1(rt,_excluded$2);const Mt=useDeepMemo(()=>mergeTheme(mt),[mt]),[Bt,Ut]=reactExports.useState(!bt),Ht=typeof bt=="object"?!bt.collapsed:Bt,tr=reactExports.useMemo(()=>typeof bt=="object"?rr=>{typeof rr=="function"?bt.onChange(!rr(!bt.collapsed)):bt.onChange(!rr)}:Ut,[bt]);return!_||ut?null:React.createElement(ThemeContext.Provider,{value:Mt},React.createElement(LevaCore,_extends({store:_},St,{toggled:Ht,setToggle:tr,rootClass:Mt.className})))}const LevaCore=React.memo(({store:rt,rootClass:_,fill:ut=!1,flat:mt=!1,neverHide:bt=!1,oneLineLabels:St=!1,titleBar:Mt={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:Bt=!1,toggled:Ut,setToggle:Ht})=>{var tr,rr;const sr=useVisiblePaths(rt),[ar,cr]=reactExports.useState(""),Ar=reactExports.useMemo(()=>buildTree(sr,ar),[sr,ar]),[_r,Dr]=useTransform(),$r=bt||sr.length>0,Br=typeof Mt=="object"&&Mt.title||void 0,Jr=typeof Mt=="object"&&(tr=Mt.drag)!==null&&tr!==void 0?tr:!0,mn=typeof Mt=="object"&&(rr=Mt.filter)!==null&&rr!==void 0?rr:!0,Mn=typeof Mt=="object"&&Mt.position||void 0,$n=typeof Mt=="object"&&Mt.onDrag||void 0,en=typeof Mt=="object"&&Mt.onDragStart||void 0,In=typeof Mt=="object"&&Mt.onDragEnd||void 0;return React.useEffect(()=>{Dr({x:Mn==null?void 0:Mn.x,y:Mn==null?void 0:Mn.y})},[Mn,Dr]),globalStyles(),React.createElement(PanelSettingsContext.Provider,{value:{hideCopyButton:Bt}},React.createElement(StyledRoot,{ref:_r,className:_,fill:ut,flat:mt,oneLineLabels:St,hideTitleBar:!Mt,style:{display:$r?"block":"none"}},Mt&&React.createElement(TitleWithFilter,{onDrag:Rn=>{Dr(Rn),$n==null||$n(Rn)},onDragStart:Rn=>en==null?void 0:en(Rn),onDragEnd:Rn=>In==null?void 0:In(Rn),setFilter:cr,toggle:Rn=>Ht(qn=>Rn??!qn),toggled:Ut,title:Br,drag:Jr,filterEnabled:mn,from:Mn}),$r&&React.createElement(StoreContext.Provider,{value:rt},React.createElement(TreeWrapper,{isRoot:!0,fill:ut,flat:mt,tree:Ar,toggled:Ut}))))}),_excluded$1=["isRoot"];let rootInitialized=!1,rootEl=null;function Leva(rt){let{isRoot:_=!1}=rt,ut=_objectWithoutProperties$1(rt,_excluded$1);return reactExports.useEffect(()=>(rootInitialized=!0,!_&&rootEl&&(rootEl.remove(),rootEl=null),()=>{_||(rootInitialized=!1)}),[_]),React.createElement(LevaRoot,_extends({store:levaStore},ut))}function useRenderRoot(rt){reactExports.useEffect(()=>{rt&&!rootInitialized&&(rootEl||(rootEl=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(rootEl),render(React.createElement(Leva,{isRoot:!0}),rootEl))),rootInitialized=!0)},[rt])}function parseArgs(rt,_,ut,mt,bt){let St,Mt,Bt,Ut,Ht;return typeof rt=="string"?(Mt=rt,St=_,Array.isArray(ut)&&(Ht=ut)):(St=rt,Array.isArray(_)?Ht=_:(Ut=_,Ht=ut)),{schema:St,folderName:Mt,folderSettings:Bt,hookSettings:Ut,deps:Ht||[]}}function useControls(rt,_,ut,mt,bt){const{folderName:St,schema:Mt,folderSettings:Bt,hookSettings:Ut,deps:Ht}=parseArgs(rt,_,ut),tr=typeof Mt=="function",rr=reactExports.useRef(!1),sr=reactExports.useRef(!0),ar=useDeepMemo(()=>{rr.current=!0;const qn=typeof Mt=="function"?Mt():Mt;return St?{[St]:folder(qn,Bt)}:qn},Ht),cr=!(Ut!=null&&Ut.store);useRenderRoot(cr);const[Ar]=reactExports.useState(()=>(Ut==null?void 0:Ut.store)||levaStore),[_r,Dr]=reactExports.useMemo(()=>Ar.getDataFromSchema(ar),[Ar,ar]),[$r,Br,Jr,mn,Mn]=reactExports.useMemo(()=>{const qn=[],Qn=[],xs={},cs={},ks={};return Object.values(Dr).forEach(({path:_o,onChange:qs,onEditStart:Ss,onEditEnd:eo,transient:Ao})=>{qn.push(_o),qs?(xs[_o]=qs,Ao||Qn.push(_o)):Qn.push(_o),Ss&&(cs[_o]=Ss),eo&&(ks[_o]=eo)}),[qn,Qn,xs,cs,ks]},[Dr]),$n=reactExports.useMemo(()=>Ar.orderPaths($r),[$r,Ar]),en=useValuesForPath(Ar,Br,_r),In=reactExports.useCallback(qn=>{const Qn=Object.entries(qn).reduce((xs,[cs,ks])=>Object.assign(xs,{[Dr[cs].path]:ks}),{});Ar.set(Qn,!1)},[Ar,Dr]),Rn=reactExports.useCallback(qn=>Ar.get(Dr[qn].path),[Ar,Dr]);return reactExports.useEffect(()=>{const qn=!sr.current&&rr.current;return Ar.addData(_r,qn),sr.current=!1,rr.current=!1,()=>Ar.disposePaths($n)},[Ar,$n,_r]),reactExports.useEffect(()=>{const qn=[];return Object.entries(Jr).forEach(([Qn,xs])=>{xs(Ar.get(Qn),Qn,_objectSpread2({initial:!0,get:Ar.get},Ar.getInput(Qn)));const cs=Ar.useStore.subscribe(ks=>{const _o=ks.data[Qn];return[_o.disabled?void 0:_o.value,_o]},([ks,_o])=>xs(ks,Qn,_objectSpread2({initial:!1,get:Ar.get},_o)),{equalityFn:shallow});qn.push(cs)}),()=>qn.forEach(Qn=>Qn())},[Ar,Jr]),reactExports.useEffect(()=>{const qn=[];return Object.entries(mn).forEach(([Qn,xs])=>qn.push(Ar.subscribeToEditStart(Qn,xs))),Object.entries(Mn).forEach(([Qn,xs])=>qn.push(Ar.subscribeToEditEnd(Qn,xs))),()=>qn.forEach(Qn=>Qn())},[mn,Mn,Ar]),tr?[en,In,Rn]:en}register(LevaInputs.SELECT,select);register(LevaInputs.IMAGE,image);register(LevaInputs.NUMBER,number$1);register(LevaInputs.COLOR,color$1);register(LevaInputs.STRING,string);register(LevaInputs.BOOLEAN,boolean);register(LevaInputs.INTERVAL,interval);register(LevaInputs.VECTOR3D,vector3d);register(LevaInputs.VECTOR2D,vector2d);function XBot(rt){const{animation:_}=rt,ut=reactExports.useRef(null),{nodes:mt,materials:bt}=useGLTF("/threeDCharacter/models/XBot.glb"),{animations:St}=useFBX("/threeDCharacter/animations/Typing.fbx"),{animations:Mt}=useFBX("/threeDCharacter/animations/Praying.fbx"),{animations:Bt}=useFBX("/threeDCharacter/animations/Fall.fbx"),{animations:Ut}=useFBX("/threeDCharacter/animations/Standing.fbx");console.log(Mt,Bt),Mt[0].name="Praying",Bt[0].name="FallAnimation",Ut[0].name="Standing",St[0].name="Typing";const{actions:Ht}=useAnimations([St[0],Mt[0],Bt[0],Ut[0]],ut),{wireframe:tr}=useControls({headFollow:!1,cursorFollow:!1,wireframe:!1});reactExports.useEffect(()=>{var cr;(cr=Ht[_])==null||cr.reset().play()},[Ht]),reactExports.useEffect(()=>{ut.current&&ut.current.traverse(cr=>{console.log(cr.name)})},[ut.current]),reactExports.useEffect(()=>{Object.values(bt).forEach(cr=>{cr instanceof MeshBasicMaterial&&(cr.wireframe=tr)})},[tr,bt]);const rr=mt.Beta_Surface.geometry,sr=bt.Beta_HighLimbsGeoSG3,ar=mt.Beta_Surface.skeleton;return jsxRuntimeExports.jsx("group",{rotation:[0,0,0],children:jsxRuntimeExports.jsx("group",{ref:ut,...rt,dispose:null,children:jsxRuntimeExports.jsxs("group",{rotation:[0,0,0],scale:.01,children:[jsxRuntimeExports.jsx("primitive",{object:mt.mixamorigHips}),jsxRuntimeExports.jsx("skinnedMesh",{frustumCulled:!1,geometry:mt.Beta_Joints.geometry,material:bt.Beta_Joints_MAT1,skeleton:mt.Beta_Joints.skeleton}),jsxRuntimeExports.jsx("skinnedMesh",{frustumCulled:!1,geometry:rr,material:sr,skeleton:ar})]})})})}useGLTF.preload("/threeDCharacter/XBot.glb");const framerMotionConfig={type:"spring",mass:5,stiffness:500,damping:50,restDelta:1e-4};function _assertThisInitialized(rt){if(rt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return rt}function _inheritsLoose(rt,_){rt.prototype=Object.create(_.prototype),rt.prototype.constructor=rt,rt.__proto__=_}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _config={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},_defaults={duration:.5,overwrite:!1,delay:0},_suppressOverwrites,_reverting$1,_context,_bigNum$1=1e8,_tinyNum=1/_bigNum$1,_2PI=Math.PI*2,_HALF_PI=_2PI/4,_gsID=0,_sqrt=Math.sqrt,_cos=Math.cos,_sin=Math.sin,_isString=function rt(_){return typeof _=="string"},_isFunction=function rt(_){return typeof _=="function"},_isNumber=function rt(_){return typeof _=="number"},_isUndefined=function rt(_){return typeof _>"u"},_isObject=function rt(_){return typeof _=="object"},_isNotFalse=function rt(_){return _!==!1},_windowExists$1=function rt(){return typeof window<"u"},_isFuncOrString=function rt(_){return _isFunction(_)||_isString(_)},_isTypedArray=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},_isArray=Array.isArray,_strictNumExp=/(?:-?\.?\d|\.)+/gi,_numExp=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,_numWithUnitExp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,_complexStringNumExp=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,_relExp=/[+-]=-?[.\d]+/,_delimitedValueExp=/[^,'"\[\]\s]+/gi,_unitExp=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,_globalTimeline,_win$1,_coreInitted,_doc$1,_globals={},_installScope={},_coreReady,_install=function rt(_){return(_installScope=_merge(_,_globals))&&gsap},_missingPlugin=function rt(_,ut){return console.warn("Invalid property",_,"set to",ut,"Missing plugin? gsap.registerPlugin()")},_warn=function rt(_,ut){return!ut&&console.warn(_)},_addGlobal=function rt(_,ut){return _&&(_globals[_]=ut)&&_installScope&&(_installScope[_]=ut)||_globals},_emptyFunc=function rt(){return 0},_startAtRevertConfig={suppressEvents:!0,isStart:!0,kill:!1},_revertConfigNoKill={suppressEvents:!0,kill:!1},_revertConfig={suppressEvents:!0},_reservedProps={},_lazyTweens=[],_lazyLookup={},_lastRenderedFrame,_plugins={},_effects={},_nextGCFrame=30,_harnessPlugins=[],_callbackNames="",_harness=function rt(_){var ut=_[0],mt,bt;if(_isObject(ut)||_isFunction(ut)||(_=[_]),!(mt=(ut._gsap||{}).harness)){for(bt=_harnessPlugins.length;bt--&&!_harnessPlugins[bt].targetTest(ut););mt=_harnessPlugins[bt]}for(bt=_.length;bt--;)_[bt]&&(_[bt]._gsap||(_[bt]._gsap=new GSCache(_[bt],mt)))||_.splice(bt,1);return _},_getCache=function rt(_){return _._gsap||_harness(toArray(_))[0]._gsap},_getProperty=function rt(_,ut,mt){return(mt=_[ut])&&_isFunction(mt)?_[ut]():_isUndefined(mt)&&_.getAttribute&&_.getAttribute(ut)||mt},_forEachName=function rt(_,ut){return(_=_.split(",")).forEach(ut)||_},_round=function rt(_){return Math.round(_*1e5)/1e5||0},_roundPrecise=function rt(_){return Math.round(_*1e7)/1e7||0},_parseRelative=function rt(_,ut){var mt=ut.charAt(0),bt=parseFloat(ut.substr(2));return _=parseFloat(_),mt==="+"?_+bt:mt==="-"?_-bt:mt==="*"?_*bt:_/bt},_arrayContainsAny=function rt(_,ut){for(var mt=ut.length,bt=0;_.indexOf(ut[bt])<0&&++bt<mt;);return bt<mt},_lazyRender=function rt(){var _=_lazyTweens.length,ut=_lazyTweens.slice(0),mt,bt;for(_lazyLookup={},_lazyTweens.length=0,mt=0;mt<_;mt++)bt=ut[mt],bt&&bt._lazy&&(bt.render(bt._lazy[0],bt._lazy[1],!0)._lazy=0)},_lazySafeRender=function rt(_,ut,mt,bt){_lazyTweens.length&&!_reverting$1&&_lazyRender(),_.render(ut,mt,_reverting$1&&ut<0&&(_._initted||_._startAt)),_lazyTweens.length&&!_reverting$1&&_lazyRender()},_numericIfPossible=function rt(_){var ut=parseFloat(_);return(ut||ut===0)&&(_+"").match(_delimitedValueExp).length<2?ut:_isString(_)?_.trim():_},_passThrough=function rt(_){return _},_setDefaults=function rt(_,ut){for(var mt in ut)mt in _||(_[mt]=ut[mt]);return _},_setKeyframeDefaults=function rt(_){return function(ut,mt){for(var bt in mt)bt in ut||bt==="duration"&&_||bt==="ease"||(ut[bt]=mt[bt])}},_merge=function rt(_,ut){for(var mt in ut)_[mt]=ut[mt];return _},_mergeDeep=function rt(_,ut){for(var mt in ut)mt!=="__proto__"&&mt!=="constructor"&&mt!=="prototype"&&(_[mt]=_isObject(ut[mt])?rt(_[mt]||(_[mt]={}),ut[mt]):ut[mt]);return _},_copyExcluding=function rt(_,ut){var mt={},bt;for(bt in _)bt in ut||(mt[bt]=_[bt]);return mt},_inheritDefaults=function rt(_){var ut=_.parent||_globalTimeline,mt=_.keyframes?_setKeyframeDefaults(_isArray(_.keyframes)):_setDefaults;if(_isNotFalse(_.inherit))for(;ut;)mt(_,ut.vars.defaults),ut=ut.parent||ut._dp;return _},_arraysMatch=function rt(_,ut){for(var mt=_.length,bt=mt===ut.length;bt&&mt--&&_[mt]===ut[mt];);return mt<0},_addLinkedListItem=function rt(_,ut,mt,bt,St){var Mt=_[bt],Bt;if(St)for(Bt=ut[St];Mt&&Mt[St]>Bt;)Mt=Mt._prev;return Mt?(ut._next=Mt._next,Mt._next=ut):(ut._next=_[mt],_[mt]=ut),ut._next?ut._next._prev=ut:_[bt]=ut,ut._prev=Mt,ut.parent=ut._dp=_,ut},_removeLinkedListItem=function rt(_,ut,mt,bt){mt===void 0&&(mt="_first"),bt===void 0&&(bt="_last");var St=ut._prev,Mt=ut._next;St?St._next=Mt:_[mt]===ut&&(_[mt]=Mt),Mt?Mt._prev=St:_[bt]===ut&&(_[bt]=St),ut._next=ut._prev=ut.parent=null},_removeFromParent=function rt(_,ut){_.parent&&(!ut||_.parent.autoRemoveChildren)&&_.parent.remove&&_.parent.remove(_),_._act=0},_uncache=function rt(_,ut){if(_&&(!ut||ut._end>_._dur||ut._start<0))for(var mt=_;mt;)mt._dirty=1,mt=mt.parent;return _},_recacheAncestors=function rt(_){for(var ut=_.parent;ut&&ut.parent;)ut._dirty=1,ut.totalDuration(),ut=ut.parent;return _},_rewindStartAt=function rt(_,ut,mt,bt){return _._startAt&&(_reverting$1?_._startAt.revert(_revertConfigNoKill):_.vars.immediateRender&&!_.vars.autoRevert||_._startAt.render(ut,!0,bt))},_hasNoPausedAncestors=function rt(_){return!_||_._ts&&rt(_.parent)},_elapsedCycleDuration=function rt(_){return _._repeat?_animationCycle(_._tTime,_=_.duration()+_._rDelay)*_:0},_animationCycle=function rt(_,ut){var mt=Math.floor(_/=ut);return _&&mt===_?mt-1:mt},_parentToChildTotalTime=function rt(_,ut){return(_-ut._start)*ut._ts+(ut._ts>=0?0:ut._dirty?ut.totalDuration():ut._tDur)},_setEnd=function rt(_){return _._end=_roundPrecise(_._start+(_._tDur/Math.abs(_._ts||_._rts||_tinyNum)||0))},_alignPlayhead=function rt(_,ut){var mt=_._dp;return mt&&mt.smoothChildTiming&&_._ts&&(_._start=_roundPrecise(mt._time-(_._ts>0?ut/_._ts:((_._dirty?_.totalDuration():_._tDur)-ut)/-_._ts)),_setEnd(_),mt._dirty||_uncache(mt,_)),_},_postAddChecks=function rt(_,ut){var mt;if((ut._time||!ut._dur&&ut._initted||ut._start<_._time&&(ut._dur||!ut.add))&&(mt=_parentToChildTotalTime(_.rawTime(),ut),(!ut._dur||_clamp(0,ut.totalDuration(),mt)-ut._tTime>_tinyNum)&&ut.render(mt,!0)),_uncache(_,ut)._dp&&_._initted&&_._time>=_._dur&&_._ts){if(_._dur<_.duration())for(mt=_;mt._dp;)mt.rawTime()>=0&&mt.totalTime(mt._tTime),mt=mt._dp;_._zTime=-_tinyNum}},_addToTimeline=function rt(_,ut,mt,bt){return ut.parent&&_removeFromParent(ut),ut._start=_roundPrecise((_isNumber(mt)?mt:mt||_!==_globalTimeline?_parsePosition(_,mt,ut):_._time)+ut._delay),ut._end=_roundPrecise(ut._start+(ut.totalDuration()/Math.abs(ut.timeScale())||0)),_addLinkedListItem(_,ut,"_first","_last",_._sort?"_start":0),_isFromOrFromStart(ut)||(_._recent=ut),bt||_postAddChecks(_,ut),_._ts<0&&_alignPlayhead(_,_._tTime),_},_scrollTrigger=function rt(_,ut){return(_globals.ScrollTrigger||_missingPlugin("scrollTrigger",ut))&&_globals.ScrollTrigger.create(ut,_)},_attemptInitTween=function rt(_,ut,mt,bt,St){if(_initTween(_,ut,St),!_._initted)return 1;if(!mt&&_._pt&&!_reverting$1&&(_._dur&&_.vars.lazy!==!1||!_._dur&&_.vars.lazy)&&_lastRenderedFrame!==_ticker.frame)return _lazyTweens.push(_),_._lazy=[St,bt],1},_parentPlayheadIsBeforeStart=function rt(_){var ut=_.parent;return ut&&ut._ts&&ut._initted&&!ut._lock&&(ut.rawTime()<0||rt(ut))},_isFromOrFromStart=function rt(_){var ut=_.data;return ut==="isFromStart"||ut==="isStart"},_renderZeroDurationTween=function rt(_,ut,mt,bt){var St=_.ratio,Mt=ut<0||!ut&&(!_._start&&_parentPlayheadIsBeforeStart(_)&&!(!_._initted&&_isFromOrFromStart(_))||(_._ts<0||_._dp._ts<0)&&!_isFromOrFromStart(_))?0:1,Bt=_._rDelay,Ut=0,Ht,tr,rr;if(Bt&&_._repeat&&(Ut=_clamp(0,_._tDur,ut),tr=_animationCycle(Ut,Bt),_._yoyo&&tr&1&&(Mt=1-Mt),tr!==_animationCycle(_._tTime,Bt)&&(St=1-Mt,_.vars.repeatRefresh&&_._initted&&_.invalidate())),Mt!==St||_reverting$1||bt||_._zTime===_tinyNum||!ut&&_._zTime){if(!_._initted&&_attemptInitTween(_,ut,bt,mt,Ut))return;for(rr=_._zTime,_._zTime=ut||(mt?_tinyNum:0),mt||(mt=ut&&!rr),_.ratio=Mt,_._from&&(Mt=1-Mt),_._time=0,_._tTime=Ut,Ht=_._pt;Ht;)Ht.r(Mt,Ht.d),Ht=Ht._next;ut<0&&_rewindStartAt(_,ut,mt,!0),_._onUpdate&&!mt&&_callback(_,"onUpdate"),Ut&&_._repeat&&!mt&&_.parent&&_callback(_,"onRepeat"),(ut>=_._tDur||ut<0)&&_.ratio===Mt&&(Mt&&_removeFromParent(_,1),!mt&&!_reverting$1&&(_callback(_,Mt?"onComplete":"onReverseComplete",!0),_._prom&&_._prom()))}else _._zTime||(_._zTime=ut)},_findNextPauseTween=function rt(_,ut,mt){var bt;if(mt>ut)for(bt=_._first;bt&&bt._start<=mt;){if(bt.data==="isPause"&&bt._start>ut)return bt;bt=bt._next}else for(bt=_._last;bt&&bt._start>=mt;){if(bt.data==="isPause"&&bt._start<ut)return bt;bt=bt._prev}},_setDuration=function rt(_,ut,mt,bt){var St=_._repeat,Mt=_roundPrecise(ut)||0,Bt=_._tTime/_._tDur;return Bt&&!bt&&(_._time*=Mt/_._dur),_._dur=Mt,_._tDur=St?St<0?1e10:_roundPrecise(Mt*(St+1)+_._rDelay*St):Mt,Bt>0&&!bt&&_alignPlayhead(_,_._tTime=_._tDur*Bt),_.parent&&_setEnd(_),mt||_uncache(_.parent,_),_},_onUpdateTotalDuration=function rt(_){return _ instanceof Timeline?_uncache(_):_setDuration(_,_._dur)},_zeroPosition={_start:0,endTime:_emptyFunc,totalDuration:_emptyFunc},_parsePosition=function rt(_,ut,mt){var bt=_.labels,St=_._recent||_zeroPosition,Mt=_.duration()>=_bigNum$1?St.endTime(!1):_._dur,Bt,Ut,Ht;return _isString(ut)&&(isNaN(ut)||ut in bt)?(Ut=ut.charAt(0),Ht=ut.substr(-1)==="%",Bt=ut.indexOf("="),Ut==="<"||Ut===">"?(Bt>=0&&(ut=ut.replace(/=/,"")),(Ut==="<"?St._start:St.endTime(St._repeat>=0))+(parseFloat(ut.substr(1))||0)*(Ht?(Bt<0?St:mt).totalDuration()/100:1)):Bt<0?(ut in bt||(bt[ut]=Mt),bt[ut]):(Ut=parseFloat(ut.charAt(Bt-1)+ut.substr(Bt+1)),Ht&&mt&&(Ut=Ut/100*(_isArray(mt)?mt[0]:mt).totalDuration()),Bt>1?rt(_,ut.substr(0,Bt-1),mt)+Ut:Mt+Ut)):ut==null?Mt:+ut},_createTweenType=function rt(_,ut,mt){var bt=_isNumber(ut[1]),St=(bt?2:1)+(_<2?0:1),Mt=ut[St],Bt,Ut;if(bt&&(Mt.duration=ut[1]),Mt.parent=mt,_){for(Bt=Mt,Ut=mt;Ut&&!("immediateRender"in Bt);)Bt=Ut.vars.defaults||{},Ut=_isNotFalse(Ut.vars.inherit)&&Ut.parent;Mt.immediateRender=_isNotFalse(Bt.immediateRender),_<2?Mt.runBackwards=1:Mt.startAt=ut[St-1]}return new Tween$2(ut[0],Mt,ut[St+1])},_conditionalReturn=function rt(_,ut){return _||_===0?ut(_):ut},_clamp=function rt(_,ut,mt){return mt<_?_:mt>ut?ut:mt},getUnit=function rt(_,ut){return!_isString(_)||!(ut=_unitExp.exec(_))?"":ut[1]},clamp=function rt(_,ut,mt){return _conditionalReturn(mt,function(bt){return _clamp(_,ut,bt)})},_slice=[].slice,_isArrayLike=function rt(_,ut){return _&&_isObject(_)&&"length"in _&&(!ut&&!_.length||_.length-1 in _&&_isObject(_[0]))&&!_.nodeType&&_!==_win$1},_flatten=function rt(_,ut,mt){return mt===void 0&&(mt=[]),_.forEach(function(bt){var St;return _isString(bt)&&!ut||_isArrayLike(bt,1)?(St=mt).push.apply(St,toArray(bt)):mt.push(bt)})||mt},toArray=function rt(_,ut,mt){return _context&&!ut&&_context.selector?_context.selector(_):_isString(_)&&!mt&&(_coreInitted||!_wake())?_slice.call((ut||_doc$1).querySelectorAll(_),0):_isArray(_)?_flatten(_,mt):_isArrayLike(_)?_slice.call(_,0):_?[_]:[]},selector=function rt(_){return _=toArray(_)[0]||_warn("Invalid scope")||{},function(ut){var mt=_.current||_.nativeElement||_;return toArray(ut,mt.querySelectorAll?mt:mt===_?_warn("Invalid scope")||_doc$1.createElement("div"):_)}},shuffle=function rt(_){return _.sort(function(){return .5-Math.random()})},distribute=function rt(_){if(_isFunction(_))return _;var ut=_isObject(_)?_:{each:_},mt=_parseEase(ut.ease),bt=ut.from||0,St=parseFloat(ut.base)||0,Mt={},Bt=bt>0&&bt<1,Ut=isNaN(bt)||Bt,Ht=ut.axis,tr=bt,rr=bt;return _isString(bt)?tr=rr={center:.5,edges:.5,end:1}[bt]||0:!Bt&&Ut&&(tr=bt[0],rr=bt[1]),function(sr,ar,cr){var Ar=(cr||ut).length,_r=Mt[Ar],Dr,$r,Br,Jr,mn,Mn,$n,en,In;if(!_r){if(In=ut.grid==="auto"?0:(ut.grid||[1,_bigNum$1])[1],!In){for($n=-_bigNum$1;$n<($n=cr[In++].getBoundingClientRect().left)&&In<Ar;);In<Ar&&In--}for(_r=Mt[Ar]=[],Dr=Ut?Math.min(In,Ar)*tr-.5:bt%In,$r=In===_bigNum$1?0:Ut?Ar*rr/In-.5:bt/In|0,$n=0,en=_bigNum$1,Mn=0;Mn<Ar;Mn++)Br=Mn%In-Dr,Jr=$r-(Mn/In|0),_r[Mn]=mn=Ht?Math.abs(Ht==="y"?Jr:Br):_sqrt(Br*Br+Jr*Jr),mn>$n&&($n=mn),mn<en&&(en=mn);bt==="random"&&shuffle(_r),_r.max=$n-en,_r.min=en,_r.v=Ar=(parseFloat(ut.amount)||parseFloat(ut.each)*(In>Ar?Ar-1:Ht?Ht==="y"?Ar/In:In:Math.max(In,Ar/In))||0)*(bt==="edges"?-1:1),_r.b=Ar<0?St-Ar:St,_r.u=getUnit(ut.amount||ut.each)||0,mt=mt&&Ar<0?_invertEase(mt):mt}return Ar=(_r[sr]-_r.min)/_r.max||0,_roundPrecise(_r.b+(mt?mt(Ar):Ar)*_r.v)+_r.u}},_roundModifier=function rt(_){var ut=Math.pow(10,((_+"").split(".")[1]||"").length);return function(mt){var bt=_roundPrecise(Math.round(parseFloat(mt)/_)*_*ut);return(bt-bt%1)/ut+(_isNumber(mt)?0:getUnit(mt))}},snap=function rt(_,ut){var mt=_isArray(_),bt,St;return!mt&&_isObject(_)&&(bt=mt=_.radius||_bigNum$1,_.values?(_=toArray(_.values),(St=!_isNumber(_[0]))&&(bt*=bt)):_=_roundModifier(_.increment)),_conditionalReturn(ut,mt?_isFunction(_)?function(Mt){return St=_(Mt),Math.abs(St-Mt)<=bt?St:Mt}:function(Mt){for(var Bt=parseFloat(St?Mt.x:Mt),Ut=parseFloat(St?Mt.y:0),Ht=_bigNum$1,tr=0,rr=_.length,sr,ar;rr--;)St?(sr=_[rr].x-Bt,ar=_[rr].y-Ut,sr=sr*sr+ar*ar):sr=Math.abs(_[rr]-Bt),sr<Ht&&(Ht=sr,tr=rr);return tr=!bt||Ht<=bt?_[tr]:Mt,St||tr===Mt||_isNumber(Mt)?tr:tr+getUnit(Mt)}:_roundModifier(_))},random=function rt(_,ut,mt,bt){return _conditionalReturn(_isArray(_)?!ut:mt===!0?!!(mt=0):!bt,function(){return _isArray(_)?_[~~(Math.random()*_.length)]:(mt=mt||1e-5)&&(bt=mt<1?Math.pow(10,(mt+"").length-2):1)&&Math.floor(Math.round((_-mt/2+Math.random()*(ut-_+mt*.99))/mt)*mt*bt)/bt})},pipe=function rt(){for(var _=arguments.length,ut=new Array(_),mt=0;mt<_;mt++)ut[mt]=arguments[mt];return function(bt){return ut.reduce(function(St,Mt){return Mt(St)},bt)}},unitize=function rt(_,ut){return function(mt){return _(parseFloat(mt))+(ut||getUnit(mt))}},normalize=function rt(_,ut,mt){return mapRange(_,ut,0,1,mt)},_wrapArray=function rt(_,ut,mt){return _conditionalReturn(mt,function(bt){return _[~~ut(bt)]})},wrap=function rt(_,ut,mt){var bt=ut-_;return _isArray(_)?_wrapArray(_,rt(0,_.length),ut):_conditionalReturn(mt,function(St){return(bt+(St-_)%bt)%bt+_})},wrapYoyo=function rt(_,ut,mt){var bt=ut-_,St=bt*2;return _isArray(_)?_wrapArray(_,rt(0,_.length-1),ut):_conditionalReturn(mt,function(Mt){return Mt=(St+(Mt-_)%St)%St||0,_+(Mt>bt?St-Mt:Mt)})},_replaceRandom=function rt(_){for(var ut=0,mt="",bt,St,Mt,Bt;~(bt=_.indexOf("random(",ut));)Mt=_.indexOf(")",bt),Bt=_.charAt(bt+7)==="[",St=_.substr(bt+7,Mt-bt-7).match(Bt?_delimitedValueExp:_strictNumExp),mt+=_.substr(ut,bt-ut)+random(Bt?St:+St[0],Bt?0:+St[1],+St[2]||1e-5),ut=Mt+1;return mt+_.substr(ut,_.length-ut)},mapRange=function rt(_,ut,mt,bt,St){var Mt=ut-_,Bt=bt-mt;return _conditionalReturn(St,function(Ut){return mt+((Ut-_)/Mt*Bt||0)})},interpolate=function rt(_,ut,mt,bt){var St=isNaN(_+ut)?0:function(ar){return(1-ar)*_+ar*ut};if(!St){var Mt=_isString(_),Bt={},Ut,Ht,tr,rr,sr;if(mt===!0&&(bt=1)&&(mt=null),Mt)_={p:_},ut={p:ut};else if(_isArray(_)&&!_isArray(ut)){for(tr=[],rr=_.length,sr=rr-2,Ht=1;Ht<rr;Ht++)tr.push(rt(_[Ht-1],_[Ht]));rr--,St=function(cr){cr*=rr;var Ar=Math.min(sr,~~cr);return tr[Ar](cr-Ar)},mt=ut}else bt||(_=_merge(_isArray(_)?[]:{},_));if(!tr){for(Ut in ut)_addPropTween.call(Bt,_,Ut,"get",ut[Ut]);St=function(cr){return _renderPropTweens(cr,Bt)||(Mt?_.p:_)}}}return _conditionalReturn(mt,St)},_getLabelInDirection=function rt(_,ut,mt){var bt=_.labels,St=_bigNum$1,Mt,Bt,Ut;for(Mt in bt)Bt=bt[Mt]-ut,Bt<0==!!mt&&Bt&&St>(Bt=Math.abs(Bt))&&(Ut=Mt,St=Bt);return Ut},_callback=function rt(_,ut,mt){var bt=_.vars,St=bt[ut],Mt=_context,Bt=_._ctx,Ut,Ht,tr;if(St)return Ut=bt[ut+"Params"],Ht=bt.callbackScope||_,mt&&_lazyTweens.length&&_lazyRender(),Bt&&(_context=Bt),tr=Ut?St.apply(Ht,Ut):St.call(Ht),_context=Mt,tr},_interrupt=function rt(_){return _removeFromParent(_),_.scrollTrigger&&_.scrollTrigger.kill(!!_reverting$1),_.progress()<1&&_callback(_,"onInterrupt"),_},_quickTween,_registerPluginQueue=[],_createPlugin=function rt(_){if(_)if(_=!_.name&&_.default||_,_windowExists$1()||_.headless){var ut=_.name,mt=_isFunction(_),bt=ut&&!mt&&_.init?function(){this._props=[]}:_,St={init:_emptyFunc,render:_renderPropTweens,add:_addPropTween,kill:_killPropTweensOf,modifier:_addPluginModifier,rawVars:0},Mt={targetTest:0,get:0,getSetter:_getSetter,aliases:{},register:0};if(_wake(),_!==bt){if(_plugins[ut])return;_setDefaults(bt,_setDefaults(_copyExcluding(_,St),Mt)),_merge(bt.prototype,_merge(St,_copyExcluding(_,Mt))),_plugins[bt.prop=ut]=bt,_.targetTest&&(_harnessPlugins.push(bt),_reservedProps[ut]=1),ut=(ut==="css"?"CSS":ut.charAt(0).toUpperCase()+ut.substr(1))+"Plugin"}_addGlobal(ut,bt),_.register&&_.register(gsap,bt,PropTween)}else _registerPluginQueue.push(_)},_255=255,_colorLookup={aqua:[0,_255,_255],lime:[0,_255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,_255],navy:[0,0,128],white:[_255,_255,_255],olive:[128,128,0],yellow:[_255,_255,0],orange:[_255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[_255,0,0],pink:[_255,192,203],cyan:[0,_255,_255],transparent:[_255,_255,_255,0]},_hue=function rt(_,ut,mt){return _+=_<0?1:_>1?-1:0,(_*6<1?ut+(mt-ut)*_*6:_<.5?mt:_*3<2?ut+(mt-ut)*(2/3-_)*6:ut)*_255+.5|0},splitColor=function rt(_,ut,mt){var bt=_?_isNumber(_)?[_>>16,_>>8&_255,_&_255]:0:_colorLookup.black,St,Mt,Bt,Ut,Ht,tr,rr,sr,ar,cr;if(!bt){if(_.substr(-1)===","&&(_=_.substr(0,_.length-1)),_colorLookup[_])bt=_colorLookup[_];else if(_.charAt(0)==="#"){if(_.length<6&&(St=_.charAt(1),Mt=_.charAt(2),Bt=_.charAt(3),_="#"+St+St+Mt+Mt+Bt+Bt+(_.length===5?_.charAt(4)+_.charAt(4):"")),_.length===9)return bt=parseInt(_.substr(1,6),16),[bt>>16,bt>>8&_255,bt&_255,parseInt(_.substr(7),16)/255];_=parseInt(_.substr(1),16),bt=[_>>16,_>>8&_255,_&_255]}else if(_.substr(0,3)==="hsl"){if(bt=cr=_.match(_strictNumExp),!ut)Ut=+bt[0]%360/360,Ht=+bt[1]/100,tr=+bt[2]/100,Mt=tr<=.5?tr*(Ht+1):tr+Ht-tr*Ht,St=tr*2-Mt,bt.length>3&&(bt[3]*=1),bt[0]=_hue(Ut+1/3,St,Mt),bt[1]=_hue(Ut,St,Mt),bt[2]=_hue(Ut-1/3,St,Mt);else if(~_.indexOf("="))return bt=_.match(_numExp),mt&&bt.length<4&&(bt[3]=1),bt}else bt=_.match(_strictNumExp)||_colorLookup.transparent;bt=bt.map(Number)}return ut&&!cr&&(St=bt[0]/_255,Mt=bt[1]/_255,Bt=bt[2]/_255,rr=Math.max(St,Mt,Bt),sr=Math.min(St,Mt,Bt),tr=(rr+sr)/2,rr===sr?Ut=Ht=0:(ar=rr-sr,Ht=tr>.5?ar/(2-rr-sr):ar/(rr+sr),Ut=rr===St?(Mt-Bt)/ar+(Mt<Bt?6:0):rr===Mt?(Bt-St)/ar+2:(St-Mt)/ar+4,Ut*=60),bt[0]=~~(Ut+.5),bt[1]=~~(Ht*100+.5),bt[2]=~~(tr*100+.5)),mt&&bt.length<4&&(bt[3]=1),bt},_colorOrderData=function rt(_){var ut=[],mt=[],bt=-1;return _.split(_colorExp).forEach(function(St){var Mt=St.match(_numWithUnitExp)||[];ut.push.apply(ut,Mt),mt.push(bt+=Mt.length+1)}),ut.c=mt,ut},_formatColors=function rt(_,ut,mt){var bt="",St=(_+bt).match(_colorExp),Mt=ut?"hsla(":"rgba(",Bt=0,Ut,Ht,tr,rr;if(!St)return _;if(St=St.map(function(sr){return(sr=splitColor(sr,ut,1))&&Mt+(ut?sr[0]+","+sr[1]+"%,"+sr[2]+"%,"+sr[3]:sr.join(","))+")"}),mt&&(tr=_colorOrderData(_),Ut=mt.c,Ut.join(bt)!==tr.c.join(bt)))for(Ht=_.replace(_colorExp,"1").split(_numWithUnitExp),rr=Ht.length-1;Bt<rr;Bt++)bt+=Ht[Bt]+(~Ut.indexOf(Bt)?St.shift()||Mt+"0,0,0,0)":(tr.length?tr:St.length?St:mt).shift());if(!Ht)for(Ht=_.split(_colorExp),rr=Ht.length-1;Bt<rr;Bt++)bt+=Ht[Bt]+St[Bt];return bt+Ht[rr]},_colorExp=function(){var rt="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",_;for(_ in _colorLookup)rt+="|"+_+"\\b";return new RegExp(rt+")","gi")}(),_hslExp=/hsl[a]?\(/,_colorStringFilter=function rt(_){var ut=_.join(" "),mt;if(_colorExp.lastIndex=0,_colorExp.test(ut))return mt=_hslExp.test(ut),_[1]=_formatColors(_[1],mt),_[0]=_formatColors(_[0],mt,_colorOrderData(_[1])),!0},_tickerActive,_ticker=function(){var rt=Date.now,_=500,ut=33,mt=rt(),bt=mt,St=1e3/240,Mt=St,Bt=[],Ut,Ht,tr,rr,sr,ar,cr=function Ar(_r){var Dr=rt()-bt,$r=_r===!0,Br,Jr,mn,Mn;if((Dr>_||Dr<0)&&(mt+=Dr-ut),bt+=Dr,mn=bt-mt,Br=mn-Mt,(Br>0||$r)&&(Mn=++rr.frame,sr=mn-rr.time*1e3,rr.time=mn=mn/1e3,Mt+=Br+(Br>=St?4:St-Br),Jr=1),$r||(Ut=Ht(Ar)),Jr)for(ar=0;ar<Bt.length;ar++)Bt[ar](mn,sr,Mn,_r)};return rr={time:0,frame:0,tick:function(){cr(!0)},deltaRatio:function(_r){return sr/(1e3/(_r||60))},wake:function(){_coreReady&&(!_coreInitted&&_windowExists$1()&&(_win$1=_coreInitted=window,_doc$1=_win$1.document||{},_globals.gsap=gsap,(_win$1.gsapVersions||(_win$1.gsapVersions=[])).push(gsap.version),_install(_installScope||_win$1.GreenSockGlobals||!_win$1.gsap&&_win$1||{}),_registerPluginQueue.forEach(_createPlugin)),tr=typeof requestAnimationFrame<"u"&&requestAnimationFrame,Ut&&rr.sleep(),Ht=tr||function(_r){return setTimeout(_r,Mt-rr.time*1e3+1|0)},_tickerActive=1,cr(2))},sleep:function(){(tr?cancelAnimationFrame:clearTimeout)(Ut),_tickerActive=0,Ht=_emptyFunc},lagSmoothing:function(_r,Dr){_=_r||1/0,ut=Math.min(Dr||33,_)},fps:function(_r){St=1e3/(_r||240),Mt=rr.time*1e3+St},add:function(_r,Dr,$r){var Br=Dr?function(Jr,mn,Mn,$n){_r(Jr,mn,Mn,$n),rr.remove(Br)}:_r;return rr.remove(_r),Bt[$r?"unshift":"push"](Br),_wake(),Br},remove:function(_r,Dr){~(Dr=Bt.indexOf(_r))&&Bt.splice(Dr,1)&&ar>=Dr&&ar--},_listeners:Bt},rr}(),_wake=function rt(){return!_tickerActive&&_ticker.wake()},_easeMap={},_customEaseExp=/^[\d.\-M][\d.\-,\s]/,_quotesExp=/["']/g,_parseObjectInString=function rt(_){for(var ut={},mt=_.substr(1,_.length-3).split(":"),bt=mt[0],St=1,Mt=mt.length,Bt,Ut,Ht;St<Mt;St++)Ut=mt[St],Bt=St!==Mt-1?Ut.lastIndexOf(","):Ut.length,Ht=Ut.substr(0,Bt),ut[bt]=isNaN(Ht)?Ht.replace(_quotesExp,"").trim():+Ht,bt=Ut.substr(Bt+1).trim();return ut},_valueInParentheses=function rt(_){var ut=_.indexOf("(")+1,mt=_.indexOf(")"),bt=_.indexOf("(",ut);return _.substring(ut,~bt&&bt<mt?_.indexOf(")",mt+1):mt)},_configEaseFromString=function rt(_){var ut=(_+"").split("("),mt=_easeMap[ut[0]];return mt&&ut.length>1&&mt.config?mt.config.apply(null,~_.indexOf("{")?[_parseObjectInString(ut[1])]:_valueInParentheses(_).split(",").map(_numericIfPossible)):_easeMap._CE&&_customEaseExp.test(_)?_easeMap._CE("",_):mt},_invertEase=function rt(_){return function(ut){return 1-_(1-ut)}},_propagateYoyoEase=function rt(_,ut){for(var mt=_._first,bt;mt;)mt instanceof Timeline?rt(mt,ut):mt.vars.yoyoEase&&(!mt._yoyo||!mt._repeat)&&mt._yoyo!==ut&&(mt.timeline?rt(mt.timeline,ut):(bt=mt._ease,mt._ease=mt._yEase,mt._yEase=bt,mt._yoyo=ut)),mt=mt._next},_parseEase=function rt(_,ut){return _&&(_isFunction(_)?_:_easeMap[_]||_configEaseFromString(_))||ut},_insertEase=function rt(_,ut,mt,bt){mt===void 0&&(mt=function(Ut){return 1-ut(1-Ut)}),bt===void 0&&(bt=function(Ut){return Ut<.5?ut(Ut*2)/2:1-ut((1-Ut)*2)/2});var St={easeIn:ut,easeOut:mt,easeInOut:bt},Mt;return _forEachName(_,function(Bt){_easeMap[Bt]=_globals[Bt]=St,_easeMap[Mt=Bt.toLowerCase()]=mt;for(var Ut in St)_easeMap[Mt+(Ut==="easeIn"?".in":Ut==="easeOut"?".out":".inOut")]=_easeMap[Bt+"."+Ut]=St[Ut]}),St},_easeInOutFromOut=function rt(_){return function(ut){return ut<.5?(1-_(1-ut*2))/2:.5+_((ut-.5)*2)/2}},_configElastic=function rt(_,ut,mt){var bt=ut>=1?ut:1,St=(mt||(_?.3:.45))/(ut<1?ut:1),Mt=St/_2PI*(Math.asin(1/bt)||0),Bt=function(tr){return tr===1?1:bt*Math.pow(2,-10*tr)*_sin((tr-Mt)*St)+1},Ut=_==="out"?Bt:_==="in"?function(Ht){return 1-Bt(1-Ht)}:_easeInOutFromOut(Bt);return St=_2PI/St,Ut.config=function(Ht,tr){return rt(_,Ht,tr)},Ut},_configBack=function rt(_,ut){ut===void 0&&(ut=1.70158);var mt=function(Mt){return Mt?--Mt*Mt*((ut+1)*Mt+ut)+1:0},bt=_==="out"?mt:_==="in"?function(St){return 1-mt(1-St)}:_easeInOutFromOut(mt);return bt.config=function(St){return rt(_,St)},bt};_forEachName("Linear,Quad,Cubic,Quart,Quint,Strong",function(rt,_){var ut=_<5?_+1:_;_insertEase(rt+",Power"+(ut-1),_?function(mt){return Math.pow(mt,ut)}:function(mt){return mt},function(mt){return 1-Math.pow(1-mt,ut)},function(mt){return mt<.5?Math.pow(mt*2,ut)/2:1-Math.pow((1-mt)*2,ut)/2})});_easeMap.Linear.easeNone=_easeMap.none=_easeMap.Linear.easeIn;_insertEase("Elastic",_configElastic("in"),_configElastic("out"),_configElastic());(function(rt,_){var ut=1/_,mt=2*ut,bt=2.5*ut,St=function(Bt){return Bt<ut?rt*Bt*Bt:Bt<mt?rt*Math.pow(Bt-1.5/_,2)+.75:Bt<bt?rt*(Bt-=2.25/_)*Bt+.9375:rt*Math.pow(Bt-2.625/_,2)+.984375};_insertEase("Bounce",function(Mt){return 1-St(1-Mt)},St)})(7.5625,2.75);_insertEase("Expo",function(rt){return rt?Math.pow(2,10*(rt-1)):0});_insertEase("Circ",function(rt){return-(_sqrt(1-rt*rt)-1)});_insertEase("Sine",function(rt){return rt===1?1:-_cos(rt*_HALF_PI)+1});_insertEase("Back",_configBack("in"),_configBack("out"),_configBack());_easeMap.SteppedEase=_easeMap.steps=_globals.SteppedEase={config:function rt(_,ut){_===void 0&&(_=1);var mt=1/_,bt=_+(ut?0:1),St=ut?1:0,Mt=1-_tinyNum;return function(Bt){return((bt*_clamp(0,Mt,Bt)|0)+St)*mt}}};_defaults.ease=_easeMap["quad.out"];_forEachName("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(rt){return _callbackNames+=rt+","+rt+"Params,"});var GSCache=function rt(_,ut){this.id=_gsID++,_._gsap=this,this.target=_,this.harness=ut,this.get=ut?ut.get:_getProperty,this.set=ut?ut.getSetter:_getSetter},Animation=function(){function rt(ut){this.vars=ut,this._delay=+ut.delay||0,(this._repeat=ut.repeat===1/0?-2:ut.repeat||0)&&(this._rDelay=ut.repeatDelay||0,this._yoyo=!!ut.yoyo||!!ut.yoyoEase),this._ts=1,_setDuration(this,+ut.duration,1,1),this.data=ut.data,_context&&(this._ctx=_context,_context.data.push(this)),_tickerActive||_ticker.wake()}var _=rt.prototype;return _.delay=function(mt){return mt||mt===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+mt-this._delay),this._delay=mt,this):this._delay},_.duration=function(mt){return arguments.length?this.totalDuration(this._repeat>0?mt+(mt+this._rDelay)*this._repeat:mt):this.totalDuration()&&this._dur},_.totalDuration=function(mt){return arguments.length?(this._dirty=0,_setDuration(this,this._repeat<0?mt:(mt-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},_.totalTime=function(mt,bt){if(_wake(),!arguments.length)return this._tTime;var St=this._dp;if(St&&St.smoothChildTiming&&this._ts){for(_alignPlayhead(this,mt),!St._dp||St.parent||_postAddChecks(St,this);St&&St.parent;)St.parent._time!==St._start+(St._ts>=0?St._tTime/St._ts:(St.totalDuration()-St._tTime)/-St._ts)&&St.totalTime(St._tTime,!0),St=St.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&mt<this._tDur||this._ts<0&&mt>0||!this._tDur&&!mt)&&_addToTimeline(this._dp,this,this._start-this._delay)}return(this._tTime!==mt||!this._dur&&!bt||this._initted&&Math.abs(this._zTime)===_tinyNum||!mt&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=mt),_lazySafeRender(this,mt,bt)),this},_.time=function(mt,bt){return arguments.length?this.totalTime(Math.min(this.totalDuration(),mt+_elapsedCycleDuration(this))%(this._dur+this._rDelay)||(mt?this._dur:0),bt):this._time},_.totalProgress=function(mt,bt){return arguments.length?this.totalTime(this.totalDuration()*mt,bt):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},_.progress=function(mt,bt){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-mt:mt)+_elapsedCycleDuration(this),bt):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},_.iteration=function(mt,bt){var St=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(mt-1)*St,bt):this._repeat?_animationCycle(this._tTime,St)+1:1},_.timeScale=function(mt,bt){if(!arguments.length)return this._rts===-_tinyNum?0:this._rts;if(this._rts===mt)return this;var St=this.parent&&this._ts?_parentToChildTotalTime(this.parent._time,this):this._tTime;return this._rts=+mt||0,this._ts=this._ps||mt===-_tinyNum?0:this._rts,this.totalTime(_clamp(-Math.abs(this._delay),this._tDur,St),bt!==!1),_setEnd(this),_recacheAncestors(this)},_.paused=function(mt){return arguments.length?(this._ps!==mt&&(this._ps=mt,mt?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(_wake(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==_tinyNum&&(this._tTime-=_tinyNum)))),this):this._ps},_.startTime=function(mt){if(arguments.length){this._start=mt;var bt=this.parent||this._dp;return bt&&(bt._sort||!this.parent)&&_addToTimeline(bt,this,mt-this._delay),this}return this._start},_.endTime=function(mt){return this._start+(_isNotFalse(mt)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},_.rawTime=function(mt){var bt=this.parent||this._dp;return bt?mt&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?_parentToChildTotalTime(bt.rawTime(mt),this):this._tTime:this._tTime},_.revert=function(mt){mt===void 0&&(mt=_revertConfig);var bt=_reverting$1;return _reverting$1=mt,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(mt),this.totalTime(-.01,mt.suppressEvents)),this.data!=="nested"&&mt.kill!==!1&&this.kill(),_reverting$1=bt,this},_.globalTime=function(mt){for(var bt=this,St=arguments.length?mt:bt.rawTime();bt;)St=bt._start+St/(Math.abs(bt._ts)||1),bt=bt._dp;return!this.parent&&this._sat?this._sat.globalTime(mt):St},_.repeat=function(mt){return arguments.length?(this._repeat=mt===1/0?-2:mt,_onUpdateTotalDuration(this)):this._repeat===-2?1/0:this._repeat},_.repeatDelay=function(mt){if(arguments.length){var bt=this._time;return this._rDelay=mt,_onUpdateTotalDuration(this),bt?this.time(bt):this}return this._rDelay},_.yoyo=function(mt){return arguments.length?(this._yoyo=mt,this):this._yoyo},_.seek=function(mt,bt){return this.totalTime(_parsePosition(this,mt),_isNotFalse(bt))},_.restart=function(mt,bt){return this.play().totalTime(mt?-this._delay:0,_isNotFalse(bt))},_.play=function(mt,bt){return mt!=null&&this.seek(mt,bt),this.reversed(!1).paused(!1)},_.reverse=function(mt,bt){return mt!=null&&this.seek(mt||this.totalDuration(),bt),this.reversed(!0).paused(!1)},_.pause=function(mt,bt){return mt!=null&&this.seek(mt,bt),this.paused(!0)},_.resume=function(){return this.paused(!1)},_.reversed=function(mt){return arguments.length?(!!mt!==this.reversed()&&this.timeScale(-this._rts||(mt?-_tinyNum:0)),this):this._rts<0},_.invalidate=function(){return this._initted=this._act=0,this._zTime=-_tinyNum,this},_.isActive=function(){var mt=this.parent||this._dp,bt=this._start,St;return!!(!mt||this._ts&&this._initted&&mt.isActive()&&(St=mt.rawTime(!0))>=bt&&St<this.endTime(!0)-_tinyNum)},_.eventCallback=function(mt,bt,St){var Mt=this.vars;return arguments.length>1?(bt?(Mt[mt]=bt,St&&(Mt[mt+"Params"]=St),mt==="onUpdate"&&(this._onUpdate=bt)):delete Mt[mt],this):Mt[mt]},_.then=function(mt){var bt=this;return new Promise(function(St){var Mt=_isFunction(mt)?mt:_passThrough,Bt=function(){var Ht=bt.then;bt.then=null,_isFunction(Mt)&&(Mt=Mt(bt))&&(Mt.then||Mt===bt)&&(bt.then=Ht),St(Mt),bt.then=Ht};bt._initted&&bt.totalProgress()===1&&bt._ts>=0||!bt._tTime&&bt._ts<0?Bt():bt._prom=Bt})},_.kill=function(){_interrupt(this)},rt}();_setDefaults(Animation.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-_tinyNum,_prom:0,_ps:!1,_rts:1});var Timeline=function(rt){_inheritsLoose(_,rt);function _(mt,bt){var St;return mt===void 0&&(mt={}),St=rt.call(this,mt)||this,St.labels={},St.smoothChildTiming=!!mt.smoothChildTiming,St.autoRemoveChildren=!!mt.autoRemoveChildren,St._sort=_isNotFalse(mt.sortChildren),_globalTimeline&&_addToTimeline(mt.parent||_globalTimeline,_assertThisInitialized(St),bt),mt.reversed&&St.reverse(),mt.paused&&St.paused(!0),mt.scrollTrigger&&_scrollTrigger(_assertThisInitialized(St),mt.scrollTrigger),St}var ut=_.prototype;return ut.to=function(bt,St,Mt){return _createTweenType(0,arguments,this),this},ut.from=function(bt,St,Mt){return _createTweenType(1,arguments,this),this},ut.fromTo=function(bt,St,Mt,Bt){return _createTweenType(2,arguments,this),this},ut.set=function(bt,St,Mt){return St.duration=0,St.parent=this,_inheritDefaults(St).repeatDelay||(St.repeat=0),St.immediateRender=!!St.immediateRender,new Tween$2(bt,St,_parsePosition(this,Mt),1),this},ut.call=function(bt,St,Mt){return _addToTimeline(this,Tween$2.delayedCall(0,bt,St),Mt)},ut.staggerTo=function(bt,St,Mt,Bt,Ut,Ht,tr){return Mt.duration=St,Mt.stagger=Mt.stagger||Bt,Mt.onComplete=Ht,Mt.onCompleteParams=tr,Mt.parent=this,new Tween$2(bt,Mt,_parsePosition(this,Ut)),this},ut.staggerFrom=function(bt,St,Mt,Bt,Ut,Ht,tr){return Mt.runBackwards=1,_inheritDefaults(Mt).immediateRender=_isNotFalse(Mt.immediateRender),this.staggerTo(bt,St,Mt,Bt,Ut,Ht,tr)},ut.staggerFromTo=function(bt,St,Mt,Bt,Ut,Ht,tr,rr){return Bt.startAt=Mt,_inheritDefaults(Bt).immediateRender=_isNotFalse(Bt.immediateRender),this.staggerTo(bt,St,Bt,Ut,Ht,tr,rr)},ut.render=function(bt,St,Mt){var Bt=this._time,Ut=this._dirty?this.totalDuration():this._tDur,Ht=this._dur,tr=bt<=0?0:_roundPrecise(bt),rr=this._zTime<0!=bt<0&&(this._initted||!Ht),sr,ar,cr,Ar,_r,Dr,$r,Br,Jr,mn,Mn,$n;if(this!==_globalTimeline&&tr>Ut&&bt>=0&&(tr=Ut),tr!==this._tTime||Mt||rr){if(Bt!==this._time&&Ht&&(tr+=this._time-Bt,bt+=this._time-Bt),sr=tr,Jr=this._start,Br=this._ts,Dr=!Br,rr&&(Ht||(Bt=this._zTime),(bt||!St)&&(this._zTime=bt)),this._repeat){if(Mn=this._yoyo,_r=Ht+this._rDelay,this._repeat<-1&&bt<0)return this.totalTime(_r*100+bt,St,Mt);if(sr=_roundPrecise(tr%_r),tr===Ut?(Ar=this._repeat,sr=Ht):(Ar=~~(tr/_r),Ar&&Ar===tr/_r&&(sr=Ht,Ar--),sr>Ht&&(sr=Ht)),mn=_animationCycle(this._tTime,_r),!Bt&&this._tTime&&mn!==Ar&&this._tTime-mn*_r-this._dur<=0&&(mn=Ar),Mn&&Ar&1&&(sr=Ht-sr,$n=1),Ar!==mn&&!this._lock){var en=Mn&&mn&1,In=en===(Mn&&Ar&1);if(Ar<mn&&(en=!en),Bt=en?0:tr%Ht?Ht:tr,this._lock=1,this.render(Bt||($n?0:_roundPrecise(Ar*_r)),St,!Ht)._lock=0,this._tTime=tr,!St&&this.parent&&_callback(this,"onRepeat"),this.vars.repeatRefresh&&!$n&&(this.invalidate()._lock=1),Bt&&Bt!==this._time||Dr!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(Ht=this._dur,Ut=this._tDur,In&&(this._lock=2,Bt=en?Ht:-1e-4,this.render(Bt,!0),this.vars.repeatRefresh&&!$n&&this.invalidate()),this._lock=0,!this._ts&&!Dr)return this;_propagateYoyoEase(this,$n)}}if(this._hasPause&&!this._forcing&&this._lock<2&&($r=_findNextPauseTween(this,_roundPrecise(Bt),_roundPrecise(sr)),$r&&(tr-=sr-(sr=$r._start))),this._tTime=tr,this._time=sr,this._act=!Br,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=bt,Bt=0),!Bt&&sr&&!St&&!Ar&&(_callback(this,"onStart"),this._tTime!==tr))return this;if(sr>=Bt&&bt>=0)for(ar=this._first;ar;){if(cr=ar._next,(ar._act||sr>=ar._start)&&ar._ts&&$r!==ar){if(ar.parent!==this)return this.render(bt,St,Mt);if(ar.render(ar._ts>0?(sr-ar._start)*ar._ts:(ar._dirty?ar.totalDuration():ar._tDur)+(sr-ar._start)*ar._ts,St,Mt),sr!==this._time||!this._ts&&!Dr){$r=0,cr&&(tr+=this._zTime=-_tinyNum);break}}ar=cr}else{ar=this._last;for(var Rn=bt<0?bt:sr;ar;){if(cr=ar._prev,(ar._act||Rn<=ar._end)&&ar._ts&&$r!==ar){if(ar.parent!==this)return this.render(bt,St,Mt);if(ar.render(ar._ts>0?(Rn-ar._start)*ar._ts:(ar._dirty?ar.totalDuration():ar._tDur)+(Rn-ar._start)*ar._ts,St,Mt||_reverting$1&&(ar._initted||ar._startAt)),sr!==this._time||!this._ts&&!Dr){$r=0,cr&&(tr+=this._zTime=Rn?-_tinyNum:_tinyNum);break}}ar=cr}}if($r&&!St&&(this.pause(),$r.render(sr>=Bt?0:-_tinyNum)._zTime=sr>=Bt?1:-1,this._ts))return this._start=Jr,_setEnd(this),this.render(bt,St,Mt);this._onUpdate&&!St&&_callback(this,"onUpdate",!0),(tr===Ut&&this._tTime>=this.totalDuration()||!tr&&Bt)&&(Jr===this._start||Math.abs(Br)!==Math.abs(this._ts))&&(this._lock||((bt||!Ht)&&(tr===Ut&&this._ts>0||!tr&&this._ts<0)&&_removeFromParent(this,1),!St&&!(bt<0&&!Bt)&&(tr||Bt||!Ut)&&(_callback(this,tr===Ut&&bt>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(tr<Ut&&this.timeScale()>0)&&this._prom())))}return this},ut.add=function(bt,St){var Mt=this;if(_isNumber(St)||(St=_parsePosition(this,St,bt)),!(bt instanceof Animation)){if(_isArray(bt))return bt.forEach(function(Bt){return Mt.add(Bt,St)}),this;if(_isString(bt))return this.addLabel(bt,St);if(_isFunction(bt))bt=Tween$2.delayedCall(0,bt);else return this}return this!==bt?_addToTimeline(this,bt,St):this},ut.getChildren=function(bt,St,Mt,Bt){bt===void 0&&(bt=!0),St===void 0&&(St=!0),Mt===void 0&&(Mt=!0),Bt===void 0&&(Bt=-_bigNum$1);for(var Ut=[],Ht=this._first;Ht;)Ht._start>=Bt&&(Ht instanceof Tween$2?St&&Ut.push(Ht):(Mt&&Ut.push(Ht),bt&&Ut.push.apply(Ut,Ht.getChildren(!0,St,Mt)))),Ht=Ht._next;return Ut},ut.getById=function(bt){for(var St=this.getChildren(1,1,1),Mt=St.length;Mt--;)if(St[Mt].vars.id===bt)return St[Mt]},ut.remove=function(bt){return _isString(bt)?this.removeLabel(bt):_isFunction(bt)?this.killTweensOf(bt):(_removeLinkedListItem(this,bt),bt===this._recent&&(this._recent=this._last),_uncache(this))},ut.totalTime=function(bt,St){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=_roundPrecise(_ticker.time-(this._ts>0?bt/this._ts:(this.totalDuration()-bt)/-this._ts))),rt.prototype.totalTime.call(this,bt,St),this._forcing=0,this):this._tTime},ut.addLabel=function(bt,St){return this.labels[bt]=_parsePosition(this,St),this},ut.removeLabel=function(bt){return delete this.labels[bt],this},ut.addPause=function(bt,St,Mt){var Bt=Tween$2.delayedCall(0,St||_emptyFunc,Mt);return Bt.data="isPause",this._hasPause=1,_addToTimeline(this,Bt,_parsePosition(this,bt))},ut.removePause=function(bt){var St=this._first;for(bt=_parsePosition(this,bt);St;)St._start===bt&&St.data==="isPause"&&_removeFromParent(St),St=St._next},ut.killTweensOf=function(bt,St,Mt){for(var Bt=this.getTweensOf(bt,Mt),Ut=Bt.length;Ut--;)_overwritingTween!==Bt[Ut]&&Bt[Ut].kill(bt,St);return this},ut.getTweensOf=function(bt,St){for(var Mt=[],Bt=toArray(bt),Ut=this._first,Ht=_isNumber(St),tr;Ut;)Ut instanceof Tween$2?_arrayContainsAny(Ut._targets,Bt)&&(Ht?(!_overwritingTween||Ut._initted&&Ut._ts)&&Ut.globalTime(0)<=St&&Ut.globalTime(Ut.totalDuration())>St:!St||Ut.isActive())&&Mt.push(Ut):(tr=Ut.getTweensOf(Bt,St)).length&&Mt.push.apply(Mt,tr),Ut=Ut._next;return Mt},ut.tweenTo=function(bt,St){St=St||{};var Mt=this,Bt=_parsePosition(Mt,bt),Ut=St,Ht=Ut.startAt,tr=Ut.onStart,rr=Ut.onStartParams,sr=Ut.immediateRender,ar,cr=Tween$2.to(Mt,_setDefaults({ease:St.ease||"none",lazy:!1,immediateRender:!1,time:Bt,overwrite:"auto",duration:St.duration||Math.abs((Bt-(Ht&&"time"in Ht?Ht.time:Mt._time))/Mt.timeScale())||_tinyNum,onStart:function(){if(Mt.pause(),!ar){var _r=St.duration||Math.abs((Bt-(Ht&&"time"in Ht?Ht.time:Mt._time))/Mt.timeScale());cr._dur!==_r&&_setDuration(cr,_r,0,1).render(cr._time,!0,!0),ar=1}tr&&tr.apply(cr,rr||[])}},St));return sr?cr.render(0):cr},ut.tweenFromTo=function(bt,St,Mt){return this.tweenTo(St,_setDefaults({startAt:{time:_parsePosition(this,bt)}},Mt))},ut.recent=function(){return this._recent},ut.nextLabel=function(bt){return bt===void 0&&(bt=this._time),_getLabelInDirection(this,_parsePosition(this,bt))},ut.previousLabel=function(bt){return bt===void 0&&(bt=this._time),_getLabelInDirection(this,_parsePosition(this,bt),1)},ut.currentLabel=function(bt){return arguments.length?this.seek(bt,!0):this.previousLabel(this._time+_tinyNum)},ut.shiftChildren=function(bt,St,Mt){Mt===void 0&&(Mt=0);for(var Bt=this._first,Ut=this.labels,Ht;Bt;)Bt._start>=Mt&&(Bt._start+=bt,Bt._end+=bt),Bt=Bt._next;if(St)for(Ht in Ut)Ut[Ht]>=Mt&&(Ut[Ht]+=bt);return _uncache(this)},ut.invalidate=function(bt){var St=this._first;for(this._lock=0;St;)St.invalidate(bt),St=St._next;return rt.prototype.invalidate.call(this,bt)},ut.clear=function(bt){bt===void 0&&(bt=!0);for(var St=this._first,Mt;St;)Mt=St._next,this.remove(St),St=Mt;return this._dp&&(this._time=this._tTime=this._pTime=0),bt&&(this.labels={}),_uncache(this)},ut.totalDuration=function(bt){var St=0,Mt=this,Bt=Mt._last,Ut=_bigNum$1,Ht,tr,rr;if(arguments.length)return Mt.timeScale((Mt._repeat<0?Mt.duration():Mt.totalDuration())/(Mt.reversed()?-bt:bt));if(Mt._dirty){for(rr=Mt.parent;Bt;)Ht=Bt._prev,Bt._dirty&&Bt.totalDuration(),tr=Bt._start,tr>Ut&&Mt._sort&&Bt._ts&&!Mt._lock?(Mt._lock=1,_addToTimeline(Mt,Bt,tr-Bt._delay,1)._lock=0):Ut=tr,tr<0&&Bt._ts&&(St-=tr,(!rr&&!Mt._dp||rr&&rr.smoothChildTiming)&&(Mt._start+=tr/Mt._ts,Mt._time-=tr,Mt._tTime-=tr),Mt.shiftChildren(-tr,!1,-1/0),Ut=0),Bt._end>St&&Bt._ts&&(St=Bt._end),Bt=Ht;_setDuration(Mt,Mt===_globalTimeline&&Mt._time>St?Mt._time:St,1,1),Mt._dirty=0}return Mt._tDur},_.updateRoot=function(bt){if(_globalTimeline._ts&&(_lazySafeRender(_globalTimeline,_parentToChildTotalTime(bt,_globalTimeline)),_lastRenderedFrame=_ticker.frame),_ticker.frame>=_nextGCFrame){_nextGCFrame+=_config.autoSleep||120;var St=_globalTimeline._first;if((!St||!St._ts)&&_config.autoSleep&&_ticker._listeners.length<2){for(;St&&!St._ts;)St=St._next;St||_ticker.sleep()}}},_}(Animation);_setDefaults(Timeline.prototype,{_lock:0,_hasPause:0,_forcing:0});var _addComplexStringPropTween=function rt(_,ut,mt,bt,St,Mt,Bt){var Ut=new PropTween(this._pt,_,ut,0,1,_renderComplexString,null,St),Ht=0,tr=0,rr,sr,ar,cr,Ar,_r,Dr,$r;for(Ut.b=mt,Ut.e=bt,mt+="",bt+="",(Dr=~bt.indexOf("random("))&&(bt=_replaceRandom(bt)),Mt&&($r=[mt,bt],Mt($r,_,ut),mt=$r[0],bt=$r[1]),sr=mt.match(_complexStringNumExp)||[];rr=_complexStringNumExp.exec(bt);)cr=rr[0],Ar=bt.substring(Ht,rr.index),ar?ar=(ar+1)%5:Ar.substr(-5)==="rgba("&&(ar=1),cr!==sr[tr++]&&(_r=parseFloat(sr[tr-1])||0,Ut._pt={_next:Ut._pt,p:Ar||tr===1?Ar:",",s:_r,c:cr.charAt(1)==="="?_parseRelative(_r,cr)-_r:parseFloat(cr)-_r,m:ar&&ar<4?Math.round:0},Ht=_complexStringNumExp.lastIndex);return Ut.c=Ht<bt.length?bt.substring(Ht,bt.length):"",Ut.fp=Bt,(_relExp.test(bt)||Dr)&&(Ut.e=0),this._pt=Ut,Ut},_addPropTween=function rt(_,ut,mt,bt,St,Mt,Bt,Ut,Ht,tr){_isFunction(bt)&&(bt=bt(St||0,_,Mt));var rr=_[ut],sr=mt!=="get"?mt:_isFunction(rr)?Ht?_[ut.indexOf("set")||!_isFunction(_["get"+ut.substr(3)])?ut:"get"+ut.substr(3)](Ht):_[ut]():rr,ar=_isFunction(rr)?Ht?_setterFuncWithParam:_setterFunc:_setterPlain,cr;if(_isString(bt)&&(~bt.indexOf("random(")&&(bt=_replaceRandom(bt)),bt.charAt(1)==="="&&(cr=_parseRelative(sr,bt)+(getUnit(sr)||0),(cr||cr===0)&&(bt=cr))),!tr||sr!==bt||_forceAllPropTweens)return!isNaN(sr*bt)&&bt!==""?(cr=new PropTween(this._pt,_,ut,+sr||0,bt-(sr||0),typeof rr=="boolean"?_renderBoolean:_renderPlain,0,ar),Ht&&(cr.fp=Ht),Bt&&cr.modifier(Bt,this,_),this._pt=cr):(!rr&&!(ut in _)&&_missingPlugin(ut,bt),_addComplexStringPropTween.call(this,_,ut,sr,bt,ar,Ut||_config.stringFilter,Ht))},_processVars=function rt(_,ut,mt,bt,St){if(_isFunction(_)&&(_=_parseFuncOrString(_,St,ut,mt,bt)),!_isObject(_)||_.style&&_.nodeType||_isArray(_)||_isTypedArray(_))return _isString(_)?_parseFuncOrString(_,St,ut,mt,bt):_;var Mt={},Bt;for(Bt in _)Mt[Bt]=_parseFuncOrString(_[Bt],St,ut,mt,bt);return Mt},_checkPlugin=function rt(_,ut,mt,bt,St,Mt){var Bt,Ut,Ht,tr;if(_plugins[_]&&(Bt=new _plugins[_]).init(St,Bt.rawVars?ut[_]:_processVars(ut[_],bt,St,Mt,mt),mt,bt,Mt)!==!1&&(mt._pt=Ut=new PropTween(mt._pt,St,_,0,1,Bt.render,Bt,0,Bt.priority),mt!==_quickTween))for(Ht=mt._ptLookup[mt._targets.indexOf(St)],tr=Bt._props.length;tr--;)Ht[Bt._props[tr]]=Ut;return Bt},_overwritingTween,_forceAllPropTweens,_initTween=function rt(_,ut,mt){var bt=_.vars,St=bt.ease,Mt=bt.startAt,Bt=bt.immediateRender,Ut=bt.lazy,Ht=bt.onUpdate,tr=bt.runBackwards,rr=bt.yoyoEase,sr=bt.keyframes,ar=bt.autoRevert,cr=_._dur,Ar=_._startAt,_r=_._targets,Dr=_.parent,$r=Dr&&Dr.data==="nested"?Dr.vars.targets:_r,Br=_._overwrite==="auto"&&!_suppressOverwrites,Jr=_.timeline,mn,Mn,$n,en,In,Rn,qn,Qn,xs,cs,ks,_o,qs;if(Jr&&(!sr||!St)&&(St="none"),_._ease=_parseEase(St,_defaults.ease),_._yEase=rr?_invertEase(_parseEase(rr===!0?St:rr,_defaults.ease)):0,rr&&_._yoyo&&!_._repeat&&(rr=_._yEase,_._yEase=_._ease,_._ease=rr),_._from=!Jr&&!!bt.runBackwards,!Jr||sr&&!bt.stagger){if(Qn=_r[0]?_getCache(_r[0]).harness:0,_o=Qn&&bt[Qn.prop],mn=_copyExcluding(bt,_reservedProps),Ar&&(Ar._zTime<0&&Ar.progress(1),ut<0&&tr&&Bt&&!ar?Ar.render(-1,!0):Ar.revert(tr&&cr?_revertConfigNoKill:_startAtRevertConfig),Ar._lazy=0),Mt){if(_removeFromParent(_._startAt=Tween$2.set(_r,_setDefaults({data:"isStart",overwrite:!1,parent:Dr,immediateRender:!0,lazy:!Ar&&_isNotFalse(Ut),startAt:null,delay:0,onUpdate:Ht&&function(){return _callback(_,"onUpdate")},stagger:0},Mt))),_._startAt._dp=0,_._startAt._sat=_,ut<0&&(_reverting$1||!Bt&&!ar)&&_._startAt.revert(_revertConfigNoKill),Bt&&cr&&ut<=0&&mt<=0){ut&&(_._zTime=ut);return}}else if(tr&&cr&&!Ar){if(ut&&(Bt=!1),$n=_setDefaults({overwrite:!1,data:"isFromStart",lazy:Bt&&!Ar&&_isNotFalse(Ut),immediateRender:Bt,stagger:0,parent:Dr},mn),_o&&($n[Qn.prop]=_o),_removeFromParent(_._startAt=Tween$2.set(_r,$n)),_._startAt._dp=0,_._startAt._sat=_,ut<0&&(_reverting$1?_._startAt.revert(_revertConfigNoKill):_._startAt.render(-1,!0)),_._zTime=ut,!Bt)rt(_._startAt,_tinyNum,_tinyNum);else if(!ut)return}for(_._pt=_._ptCache=0,Ut=cr&&_isNotFalse(Ut)||Ut&&!cr,Mn=0;Mn<_r.length;Mn++){if(In=_r[Mn],qn=In._gsap||_harness(_r)[Mn]._gsap,_._ptLookup[Mn]=cs={},_lazyLookup[qn.id]&&_lazyTweens.length&&_lazyRender(),ks=$r===_r?Mn:$r.indexOf(In),Qn&&(xs=new Qn).init(In,_o||mn,_,ks,$r)!==!1&&(_._pt=en=new PropTween(_._pt,In,xs.name,0,1,xs.render,xs,0,xs.priority),xs._props.forEach(function(Ss){cs[Ss]=en}),xs.priority&&(Rn=1)),!Qn||_o)for($n in mn)_plugins[$n]&&(xs=_checkPlugin($n,mn,_,ks,In,$r))?xs.priority&&(Rn=1):cs[$n]=en=_addPropTween.call(_,In,$n,"get",mn[$n],ks,$r,0,bt.stringFilter);_._op&&_._op[Mn]&&_.kill(In,_._op[Mn]),Br&&_._pt&&(_overwritingTween=_,_globalTimeline.killTweensOf(In,cs,_.globalTime(ut)),qs=!_.parent,_overwritingTween=0),_._pt&&Ut&&(_lazyLookup[qn.id]=1)}Rn&&_sortPropTweensByPriority(_),_._onInit&&_._onInit(_)}_._onUpdate=Ht,_._initted=(!_._op||_._pt)&&!qs,sr&&ut<=0&&Jr.render(_bigNum$1,!0,!0)},_updatePropTweens=function rt(_,ut,mt,bt,St,Mt,Bt,Ut){var Ht=(_._pt&&_._ptCache||(_._ptCache={}))[ut],tr,rr,sr,ar;if(!Ht)for(Ht=_._ptCache[ut]=[],sr=_._ptLookup,ar=_._targets.length;ar--;){if(tr=sr[ar][ut],tr&&tr.d&&tr.d._pt)for(tr=tr.d._pt;tr&&tr.p!==ut&&tr.fp!==ut;)tr=tr._next;if(!tr)return _forceAllPropTweens=1,_.vars[ut]="+=0",_initTween(_,Bt),_forceAllPropTweens=0,Ut?_warn(ut+" not eligible for reset"):1;Ht.push(tr)}for(ar=Ht.length;ar--;)rr=Ht[ar],tr=rr._pt||rr,tr.s=(bt||bt===0)&&!St?bt:tr.s+(bt||0)+Mt*tr.c,tr.c=mt-tr.s,rr.e&&(rr.e=_round(mt)+getUnit(rr.e)),rr.b&&(rr.b=tr.s+getUnit(rr.b))},_addAliasesToVars=function rt(_,ut){var mt=_[0]?_getCache(_[0]).harness:0,bt=mt&&mt.aliases,St,Mt,Bt,Ut;if(!bt)return ut;St=_merge({},ut);for(Mt in bt)if(Mt in St)for(Ut=bt[Mt].split(","),Bt=Ut.length;Bt--;)St[Ut[Bt]]=St[Mt];return St},_parseKeyframe=function rt(_,ut,mt,bt){var St=ut.ease||bt||"power1.inOut",Mt,Bt;if(_isArray(ut))Bt=mt[_]||(mt[_]=[]),ut.forEach(function(Ut,Ht){return Bt.push({t:Ht/(ut.length-1)*100,v:Ut,e:St})});else for(Mt in ut)Bt=mt[Mt]||(mt[Mt]=[]),Mt==="ease"||Bt.push({t:parseFloat(_),v:ut[Mt],e:St})},_parseFuncOrString=function rt(_,ut,mt,bt,St){return _isFunction(_)?_.call(ut,mt,bt,St):_isString(_)&&~_.indexOf("random(")?_replaceRandom(_):_},_staggerTweenProps=_callbackNames+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",_staggerPropsToSkip={};_forEachName(_staggerTweenProps+",id,stagger,delay,duration,paused,scrollTrigger",function(rt){return _staggerPropsToSkip[rt]=1});var Tween$2=function(rt){_inheritsLoose(_,rt);function _(mt,bt,St,Mt){var Bt;typeof bt=="number"&&(St.duration=bt,bt=St,St=null),Bt=rt.call(this,Mt?bt:_inheritDefaults(bt))||this;var Ut=Bt.vars,Ht=Ut.duration,tr=Ut.delay,rr=Ut.immediateRender,sr=Ut.stagger,ar=Ut.overwrite,cr=Ut.keyframes,Ar=Ut.defaults,_r=Ut.scrollTrigger,Dr=Ut.yoyoEase,$r=bt.parent||_globalTimeline,Br=(_isArray(mt)||_isTypedArray(mt)?_isNumber(mt[0]):"length"in bt)?[mt]:toArray(mt),Jr,mn,Mn,$n,en,In,Rn,qn;if(Bt._targets=Br.length?_harness(Br):_warn("GSAP target "+mt+" not found. https://gsap.com",!_config.nullTargetWarn)||[],Bt._ptLookup=[],Bt._overwrite=ar,cr||sr||_isFuncOrString(Ht)||_isFuncOrString(tr)){if(bt=Bt.vars,Jr=Bt.timeline=new Timeline({data:"nested",defaults:Ar||{},targets:$r&&$r.data==="nested"?$r.vars.targets:Br}),Jr.kill(),Jr.parent=Jr._dp=_assertThisInitialized(Bt),Jr._start=0,sr||_isFuncOrString(Ht)||_isFuncOrString(tr)){if($n=Br.length,Rn=sr&&distribute(sr),_isObject(sr))for(en in sr)~_staggerTweenProps.indexOf(en)&&(qn||(qn={}),qn[en]=sr[en]);for(mn=0;mn<$n;mn++)Mn=_copyExcluding(bt,_staggerPropsToSkip),Mn.stagger=0,Dr&&(Mn.yoyoEase=Dr),qn&&_merge(Mn,qn),In=Br[mn],Mn.duration=+_parseFuncOrString(Ht,_assertThisInitialized(Bt),mn,In,Br),Mn.delay=(+_parseFuncOrString(tr,_assertThisInitialized(Bt),mn,In,Br)||0)-Bt._delay,!sr&&$n===1&&Mn.delay&&(Bt._delay=tr=Mn.delay,Bt._start+=tr,Mn.delay=0),Jr.to(In,Mn,Rn?Rn(mn,In,Br):0),Jr._ease=_easeMap.none;Jr.duration()?Ht=tr=0:Bt.timeline=0}else if(cr){_inheritDefaults(_setDefaults(Jr.vars.defaults,{ease:"none"})),Jr._ease=_parseEase(cr.ease||bt.ease||"none");var Qn=0,xs,cs,ks;if(_isArray(cr))cr.forEach(function(_o){return Jr.to(Br,_o,">")}),Jr.duration();else{Mn={};for(en in cr)en==="ease"||en==="easeEach"||_parseKeyframe(en,cr[en],Mn,cr.easeEach);for(en in Mn)for(xs=Mn[en].sort(function(_o,qs){return _o.t-qs.t}),Qn=0,mn=0;mn<xs.length;mn++)cs=xs[mn],ks={ease:cs.e,duration:(cs.t-(mn?xs[mn-1].t:0))/100*Ht},ks[en]=cs.v,Jr.to(Br,ks,Qn),Qn+=ks.duration;Jr.duration()<Ht&&Jr.to({},{duration:Ht-Jr.duration()})}}Ht||Bt.duration(Ht=Jr.duration())}else Bt.timeline=0;return ar===!0&&!_suppressOverwrites&&(_overwritingTween=_assertThisInitialized(Bt),_globalTimeline.killTweensOf(Br),_overwritingTween=0),_addToTimeline($r,_assertThisInitialized(Bt),St),bt.reversed&&Bt.reverse(),bt.paused&&Bt.paused(!0),(rr||!Ht&&!cr&&Bt._start===_roundPrecise($r._time)&&_isNotFalse(rr)&&_hasNoPausedAncestors(_assertThisInitialized(Bt))&&$r.data!=="nested")&&(Bt._tTime=-_tinyNum,Bt.render(Math.max(0,-tr)||0)),_r&&_scrollTrigger(_assertThisInitialized(Bt),_r),Bt}var ut=_.prototype;return ut.render=function(bt,St,Mt){var Bt=this._time,Ut=this._tDur,Ht=this._dur,tr=bt<0,rr=bt>Ut-_tinyNum&&!tr?Ut:bt<_tinyNum?0:bt,sr,ar,cr,Ar,_r,Dr,$r,Br,Jr;if(!Ht)_renderZeroDurationTween(this,bt,St,Mt);else if(rr!==this._tTime||!bt||Mt||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==tr){if(sr=rr,Br=this.timeline,this._repeat){if(Ar=Ht+this._rDelay,this._repeat<-1&&tr)return this.totalTime(Ar*100+bt,St,Mt);if(sr=_roundPrecise(rr%Ar),rr===Ut?(cr=this._repeat,sr=Ht):(cr=~~(rr/Ar),cr&&cr===_roundPrecise(rr/Ar)&&(sr=Ht,cr--),sr>Ht&&(sr=Ht)),Dr=this._yoyo&&cr&1,Dr&&(Jr=this._yEase,sr=Ht-sr),_r=_animationCycle(this._tTime,Ar),sr===Bt&&!Mt&&this._initted&&cr===_r)return this._tTime=rr,this;cr!==_r&&(Br&&this._yEase&&_propagateYoyoEase(Br,Dr),this.vars.repeatRefresh&&!Dr&&!this._lock&&this._time!==Ar&&this._initted&&(this._lock=Mt=1,this.render(_roundPrecise(Ar*cr),!0).invalidate()._lock=0))}if(!this._initted){if(_attemptInitTween(this,tr?bt:sr,Mt,St,rr))return this._tTime=0,this;if(Bt!==this._time&&!(Mt&&this.vars.repeatRefresh&&cr!==_r))return this;if(Ht!==this._dur)return this.render(bt,St,Mt)}if(this._tTime=rr,this._time=sr,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=$r=(Jr||this._ease)(sr/Ht),this._from&&(this.ratio=$r=1-$r),sr&&!Bt&&!St&&!cr&&(_callback(this,"onStart"),this._tTime!==rr))return this;for(ar=this._pt;ar;)ar.r($r,ar.d),ar=ar._next;Br&&Br.render(bt<0?bt:Br._dur*Br._ease(sr/this._dur),St,Mt)||this._startAt&&(this._zTime=bt),this._onUpdate&&!St&&(tr&&_rewindStartAt(this,bt,St,Mt),_callback(this,"onUpdate")),this._repeat&&cr!==_r&&this.vars.onRepeat&&!St&&this.parent&&_callback(this,"onRepeat"),(rr===this._tDur||!rr)&&this._tTime===rr&&(tr&&!this._onUpdate&&_rewindStartAt(this,bt,!0,!0),(bt||!Ht)&&(rr===this._tDur&&this._ts>0||!rr&&this._ts<0)&&_removeFromParent(this,1),!St&&!(tr&&!Bt)&&(rr||Bt||Dr)&&(_callback(this,rr===Ut?"onComplete":"onReverseComplete",!0),this._prom&&!(rr<Ut&&this.timeScale()>0)&&this._prom()))}return this},ut.targets=function(){return this._targets},ut.invalidate=function(bt){return(!bt||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(bt),rt.prototype.invalidate.call(this,bt)},ut.resetTo=function(bt,St,Mt,Bt,Ut){_tickerActive||_ticker.wake(),this._ts||this.play();var Ht=Math.min(this._dur,(this._dp._time-this._start)*this._ts),tr;return this._initted||_initTween(this,Ht),tr=this._ease(Ht/this._dur),_updatePropTweens(this,bt,St,Mt,Bt,tr,Ht,Ut)?this.resetTo(bt,St,Mt,Bt,1):(_alignPlayhead(this,0),this.parent||_addLinkedListItem(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},ut.kill=function(bt,St){if(St===void 0&&(St="all"),!bt&&(!St||St==="all"))return this._lazy=this._pt=0,this.parent?_interrupt(this):this;if(this.timeline){var Mt=this.timeline.totalDuration();return this.timeline.killTweensOf(bt,St,_overwritingTween&&_overwritingTween.vars.overwrite!==!0)._first||_interrupt(this),this.parent&&Mt!==this.timeline.totalDuration()&&_setDuration(this,this._dur*this.timeline._tDur/Mt,0,1),this}var Bt=this._targets,Ut=bt?toArray(bt):Bt,Ht=this._ptLookup,tr=this._pt,rr,sr,ar,cr,Ar,_r,Dr;if((!St||St==="all")&&_arraysMatch(Bt,Ut))return St==="all"&&(this._pt=0),_interrupt(this);for(rr=this._op=this._op||[],St!=="all"&&(_isString(St)&&(Ar={},_forEachName(St,function($r){return Ar[$r]=1}),St=Ar),St=_addAliasesToVars(Bt,St)),Dr=Bt.length;Dr--;)if(~Ut.indexOf(Bt[Dr])){sr=Ht[Dr],St==="all"?(rr[Dr]=St,cr=sr,ar={}):(ar=rr[Dr]=rr[Dr]||{},cr=St);for(Ar in cr)_r=sr&&sr[Ar],_r&&((!("kill"in _r.d)||_r.d.kill(Ar)===!0)&&_removeLinkedListItem(this,_r,"_pt"),delete sr[Ar]),ar!=="all"&&(ar[Ar]=1)}return this._initted&&!this._pt&&tr&&_interrupt(this),this},_.to=function(bt,St){return new _(bt,St,arguments[2])},_.from=function(bt,St){return _createTweenType(1,arguments)},_.delayedCall=function(bt,St,Mt,Bt){return new _(St,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:bt,onComplete:St,onReverseComplete:St,onCompleteParams:Mt,onReverseCompleteParams:Mt,callbackScope:Bt})},_.fromTo=function(bt,St,Mt){return _createTweenType(2,arguments)},_.set=function(bt,St){return St.duration=0,St.repeatDelay||(St.repeat=0),new _(bt,St)},_.killTweensOf=function(bt,St,Mt){return _globalTimeline.killTweensOf(bt,St,Mt)},_}(Animation);_setDefaults(Tween$2.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});_forEachName("staggerTo,staggerFrom,staggerFromTo",function(rt){Tween$2[rt]=function(){var _=new Timeline,ut=_slice.call(arguments,0);return ut.splice(rt==="staggerFromTo"?5:4,0,0),_[rt].apply(_,ut)}});var _setterPlain=function rt(_,ut,mt){return _[ut]=mt},_setterFunc=function rt(_,ut,mt){return _[ut](mt)},_setterFuncWithParam=function rt(_,ut,mt,bt){return _[ut](bt.fp,mt)},_setterAttribute=function rt(_,ut,mt){return _.setAttribute(ut,mt)},_getSetter=function rt(_,ut){return _isFunction(_[ut])?_setterFunc:_isUndefined(_[ut])&&_.setAttribute?_setterAttribute:_setterPlain},_renderPlain=function rt(_,ut){return ut.set(ut.t,ut.p,Math.round((ut.s+ut.c*_)*1e6)/1e6,ut)},_renderBoolean=function rt(_,ut){return ut.set(ut.t,ut.p,!!(ut.s+ut.c*_),ut)},_renderComplexString=function rt(_,ut){var mt=ut._pt,bt="";if(!_&&ut.b)bt=ut.b;else if(_===1&&ut.e)bt=ut.e;else{for(;mt;)bt=mt.p+(mt.m?mt.m(mt.s+mt.c*_):Math.round((mt.s+mt.c*_)*1e4)/1e4)+bt,mt=mt._next;bt+=ut.c}ut.set(ut.t,ut.p,bt,ut)},_renderPropTweens=function rt(_,ut){for(var mt=ut._pt;mt;)mt.r(_,mt.d),mt=mt._next},_addPluginModifier=function rt(_,ut,mt,bt){for(var St=this._pt,Mt;St;)Mt=St._next,St.p===bt&&St.modifier(_,ut,mt),St=Mt},_killPropTweensOf=function rt(_){for(var ut=this._pt,mt,bt;ut;)bt=ut._next,ut.p===_&&!ut.op||ut.op===_?_removeLinkedListItem(this,ut,"_pt"):ut.dep||(mt=1),ut=bt;return!mt},_setterWithModifier=function rt(_,ut,mt,bt){bt.mSet(_,ut,bt.m.call(bt.tween,mt,bt.mt),bt)},_sortPropTweensByPriority=function rt(_){for(var ut=_._pt,mt,bt,St,Mt;ut;){for(mt=ut._next,bt=St;bt&&bt.pr>ut.pr;)bt=bt._next;(ut._prev=bt?bt._prev:Mt)?ut._prev._next=ut:St=ut,(ut._next=bt)?bt._prev=ut:Mt=ut,ut=mt}_._pt=St},PropTween=function(){function rt(ut,mt,bt,St,Mt,Bt,Ut,Ht,tr){this.t=mt,this.s=St,this.c=Mt,this.p=bt,this.r=Bt||_renderPlain,this.d=Ut||this,this.set=Ht||_setterPlain,this.pr=tr||0,this._next=ut,ut&&(ut._prev=this)}var _=rt.prototype;return _.modifier=function(mt,bt,St){this.mSet=this.mSet||this.set,this.set=_setterWithModifier,this.m=mt,this.mt=St,this.tween=bt},rt}();_forEachName(_callbackNames+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(rt){return _reservedProps[rt]=1});_globals.TweenMax=_globals.TweenLite=Tween$2;_globals.TimelineLite=_globals.TimelineMax=Timeline;_globalTimeline=new Timeline({sortChildren:!1,defaults:_defaults,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});_config.stringFilter=_colorStringFilter;var _media=[],_listeners={},_emptyArray=[],_lastMediaTime=0,_contextID=0,_dispatch=function rt(_){return(_listeners[_]||_emptyArray).map(function(ut){return ut()})},_onMediaChange=function rt(){var _=Date.now(),ut=[];_-_lastMediaTime>2&&(_dispatch("matchMediaInit"),_media.forEach(function(mt){var bt=mt.queries,St=mt.conditions,Mt,Bt,Ut,Ht;for(Bt in bt)Mt=_win$1.matchMedia(bt[Bt]).matches,Mt&&(Ut=1),Mt!==St[Bt]&&(St[Bt]=Mt,Ht=1);Ht&&(mt.revert(),Ut&&ut.push(mt))}),_dispatch("matchMediaRevert"),ut.forEach(function(mt){return mt.onMatch(mt,function(bt){return mt.add(null,bt)})}),_lastMediaTime=_,_dispatch("matchMedia"))},Context=function(){function rt(ut,mt){this.selector=mt&&selector(mt),this.data=[],this._r=[],this.isReverted=!1,this.id=_contextID++,ut&&this.add(ut)}var _=rt.prototype;return _.add=function(mt,bt,St){_isFunction(mt)&&(St=bt,bt=mt,mt=_isFunction);var Mt=this,Bt=function(){var Ht=_context,tr=Mt.selector,rr;return Ht&&Ht!==Mt&&Ht.data.push(Mt),St&&(Mt.selector=selector(St)),_context=Mt,rr=bt.apply(Mt,arguments),_isFunction(rr)&&Mt._r.push(rr),_context=Ht,Mt.selector=tr,Mt.isReverted=!1,rr};return Mt.last=Bt,mt===_isFunction?Bt(Mt,function(Ut){return Mt.add(null,Ut)}):mt?Mt[mt]=Bt:Bt},_.ignore=function(mt){var bt=_context;_context=null,mt(this),_context=bt},_.getTweens=function(){var mt=[];return this.data.forEach(function(bt){return bt instanceof rt?mt.push.apply(mt,bt.getTweens()):bt instanceof Tween$2&&!(bt.parent&&bt.parent.data==="nested")&&mt.push(bt)}),mt},_.clear=function(){this._r.length=this.data.length=0},_.kill=function(mt,bt){var St=this;if(mt?function(){for(var Bt=St.getTweens(),Ut=St.data.length,Ht;Ut--;)Ht=St.data[Ut],Ht.data==="isFlip"&&(Ht.revert(),Ht.getChildren(!0,!0,!1).forEach(function(tr){return Bt.splice(Bt.indexOf(tr),1)}));for(Bt.map(function(tr){return{g:tr._dur||tr._delay||tr._sat&&!tr._sat.vars.immediateRender?tr.globalTime(0):-1/0,t:tr}}).sort(function(tr,rr){return rr.g-tr.g||-1/0}).forEach(function(tr){return tr.t.revert(mt)}),Ut=St.data.length;Ut--;)Ht=St.data[Ut],Ht instanceof Timeline?Ht.data!=="nested"&&(Ht.scrollTrigger&&Ht.scrollTrigger.revert(),Ht.kill()):!(Ht instanceof Tween$2)&&Ht.revert&&Ht.revert(mt);St._r.forEach(function(tr){return tr(mt,St)}),St.isReverted=!0}():this.data.forEach(function(Bt){return Bt.kill&&Bt.kill()}),this.clear(),bt)for(var Mt=_media.length;Mt--;)_media[Mt].id===this.id&&_media.splice(Mt,1)},_.revert=function(mt){this.kill(mt||{})},rt}(),MatchMedia=function(){function rt(ut){this.contexts=[],this.scope=ut,_context&&_context.data.push(this)}var _=rt.prototype;return _.add=function(mt,bt,St){_isObject(mt)||(mt={matches:mt});var Mt=new Context(0,St||this.scope),Bt=Mt.conditions={},Ut,Ht,tr;_context&&!Mt.selector&&(Mt.selector=_context.selector),this.contexts.push(Mt),bt=Mt.add("onMatch",bt),Mt.queries=mt;for(Ht in mt)Ht==="all"?tr=1:(Ut=_win$1.matchMedia(mt[Ht]),Ut&&(_media.indexOf(Mt)<0&&_media.push(Mt),(Bt[Ht]=Ut.matches)&&(tr=1),Ut.addListener?Ut.addListener(_onMediaChange):Ut.addEventListener("change",_onMediaChange)));return tr&&bt(Mt,function(rr){return Mt.add(null,rr)}),this},_.revert=function(mt){this.kill(mt||{})},_.kill=function(mt){this.contexts.forEach(function(bt){return bt.kill(mt,!0)})},rt}(),_gsap={registerPlugin:function rt(){for(var _=arguments.length,ut=new Array(_),mt=0;mt<_;mt++)ut[mt]=arguments[mt];ut.forEach(function(bt){return _createPlugin(bt)})},timeline:function rt(_){return new Timeline(_)},getTweensOf:function rt(_,ut){return _globalTimeline.getTweensOf(_,ut)},getProperty:function rt(_,ut,mt,bt){_isString(_)&&(_=toArray(_)[0]);var St=_getCache(_||{}).get,Mt=mt?_passThrough:_numericIfPossible;return mt==="native"&&(mt=""),_&&(ut?Mt((_plugins[ut]&&_plugins[ut].get||St)(_,ut,mt,bt)):function(Bt,Ut,Ht){return Mt((_plugins[Bt]&&_plugins[Bt].get||St)(_,Bt,Ut,Ht))})},quickSetter:function rt(_,ut,mt){if(_=toArray(_),_.length>1){var bt=_.map(function(tr){return gsap.quickSetter(tr,ut,mt)}),St=bt.length;return function(tr){for(var rr=St;rr--;)bt[rr](tr)}}_=_[0]||{};var Mt=_plugins[ut],Bt=_getCache(_),Ut=Bt.harness&&(Bt.harness.aliases||{})[ut]||ut,Ht=Mt?function(tr){var rr=new Mt;_quickTween._pt=0,rr.init(_,mt?tr+mt:tr,_quickTween,0,[_]),rr.render(1,rr),_quickTween._pt&&_renderPropTweens(1,_quickTween)}:Bt.set(_,Ut);return Mt?Ht:function(tr){return Ht(_,Ut,mt?tr+mt:tr,Bt,1)}},quickTo:function rt(_,ut,mt){var bt,St=gsap.to(_,_merge((bt={},bt[ut]="+=0.1",bt.paused=!0,bt),mt||{})),Mt=function(Ut,Ht,tr){return St.resetTo(ut,Ut,Ht,tr)};return Mt.tween=St,Mt},isTweening:function rt(_){return _globalTimeline.getTweensOf(_,!0).length>0},defaults:function rt(_){return _&&_.ease&&(_.ease=_parseEase(_.ease,_defaults.ease)),_mergeDeep(_defaults,_||{})},config:function rt(_){return _mergeDeep(_config,_||{})},registerEffect:function rt(_){var ut=_.name,mt=_.effect,bt=_.plugins,St=_.defaults,Mt=_.extendTimeline;(bt||"").split(",").forEach(function(Bt){return Bt&&!_plugins[Bt]&&!_globals[Bt]&&_warn(ut+" effect requires "+Bt+" plugin.")}),_effects[ut]=function(Bt,Ut,Ht){return mt(toArray(Bt),_setDefaults(Ut||{},St),Ht)},Mt&&(Timeline.prototype[ut]=function(Bt,Ut,Ht){return this.add(_effects[ut](Bt,_isObject(Ut)?Ut:(Ht=Ut)&&{},this),Ht)})},registerEase:function rt(_,ut){_easeMap[_]=_parseEase(ut)},parseEase:function rt(_,ut){return arguments.length?_parseEase(_,ut):_easeMap},getById:function rt(_){return _globalTimeline.getById(_)},exportRoot:function rt(_,ut){_===void 0&&(_={});var mt=new Timeline(_),bt,St;for(mt.smoothChildTiming=_isNotFalse(_.smoothChildTiming),_globalTimeline.remove(mt),mt._dp=0,mt._time=mt._tTime=_globalTimeline._time,bt=_globalTimeline._first;bt;)St=bt._next,(ut||!(!bt._dur&&bt instanceof Tween$2&&bt.vars.onComplete===bt._targets[0]))&&_addToTimeline(mt,bt,bt._start-bt._delay),bt=St;return _addToTimeline(_globalTimeline,mt,0),mt},context:function rt(_,ut){return _?new Context(_,ut):_context},matchMedia:function rt(_){return new MatchMedia(_)},matchMediaRefresh:function rt(){return _media.forEach(function(_){var ut=_.conditions,mt,bt;for(bt in ut)ut[bt]&&(ut[bt]=!1,mt=1);mt&&_.revert()})||_onMediaChange()},addEventListener:function rt(_,ut){var mt=_listeners[_]||(_listeners[_]=[]);~mt.indexOf(ut)||mt.push(ut)},removeEventListener:function rt(_,ut){var mt=_listeners[_],bt=mt&&mt.indexOf(ut);bt>=0&&mt.splice(bt,1)},utils:{wrap,wrapYoyo,distribute,random,snap,normalize,getUnit,clamp,splitColor,toArray,selector,mapRange,pipe,unitize,interpolate,shuffle},install:_install,effects:_effects,ticker:_ticker,updateRoot:Timeline.updateRoot,plugins:_plugins,globalTimeline:_globalTimeline,core:{PropTween,globals:_addGlobal,Tween:Tween$2,Timeline,Animation,getCache:_getCache,_removeLinkedListItem,reverting:function rt(){return _reverting$1},context:function rt(_){return _&&_context&&(_context.data.push(_),_._ctx=_context),_context},suppressOverwrites:function rt(_){return _suppressOverwrites=_}}};_forEachName("to,from,fromTo,delayedCall,set,killTweensOf",function(rt){return _gsap[rt]=Tween$2[rt]});_ticker.add(Timeline.updateRoot);_quickTween=_gsap.to({},{duration:0});var _getPluginPropTween=function rt(_,ut){for(var mt=_._pt;mt&&mt.p!==ut&&mt.op!==ut&&mt.fp!==ut;)mt=mt._next;return mt},_addModifiers=function rt(_,ut){var mt=_._targets,bt,St,Mt;for(bt in ut)for(St=mt.length;St--;)Mt=_._ptLookup[St][bt],Mt&&(Mt=Mt.d)&&(Mt._pt&&(Mt=_getPluginPropTween(Mt,bt)),Mt&&Mt.modifier&&Mt.modifier(ut[bt],_,mt[St],bt))},_buildModifierPlugin=function rt(_,ut){return{name:_,rawVars:1,init:function(bt,St,Mt){Mt._onInit=function(Bt){var Ut,Ht;if(_isString(St)&&(Ut={},_forEachName(St,function(tr){return Ut[tr]=1}),St=Ut),ut){Ut={};for(Ht in St)Ut[Ht]=ut(St[Ht]);St=Ut}_addModifiers(Bt,St)}}}},gsap=_gsap.registerPlugin({name:"attr",init:function rt(_,ut,mt,bt,St){var Mt,Bt,Ut;this.tween=mt;for(Mt in ut)Ut=_.getAttribute(Mt)||"",Bt=this.add(_,"setAttribute",(Ut||0)+"",ut[Mt],bt,St,0,0,Mt),Bt.op=Mt,Bt.b=Ut,this._props.push(Mt)},render:function rt(_,ut){for(var mt=ut._pt;mt;)_reverting$1?mt.set(mt.t,mt.p,mt.b,mt):mt.r(_,mt.d),mt=mt._next}},{name:"endArray",init:function rt(_,ut){for(var mt=ut.length;mt--;)this.add(_,mt,_[mt]||0,ut[mt],0,0,0,0,0,1)}},_buildModifierPlugin("roundProps",_roundModifier),_buildModifierPlugin("modifiers"),_buildModifierPlugin("snap",snap))||_gsap;Tween$2.version=Timeline.version=gsap.version="3.12.5";_coreReady=1;_windowExists$1()&&_wake();_easeMap.Power0;_easeMap.Power1;_easeMap.Power2;_easeMap.Power3;_easeMap.Power4;_easeMap.Linear;_easeMap.Quad;_easeMap.Cubic;_easeMap.Quart;_easeMap.Quint;_easeMap.Strong;_easeMap.Elastic;_easeMap.Back;_easeMap.SteppedEase;_easeMap.Bounce;_easeMap.Sine;_easeMap.Expo;_easeMap.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _win,_doc,_docElement,_pluginInitted,_tempDiv,_recentSetterPlugin,_reverting,_windowExists=function rt(){return typeof window<"u"},_transformProps={},_RAD2DEG=180/Math.PI,_DEG2RAD=Math.PI/180,_atan2=Math.atan2,_bigNum=1e8,_capsExp=/([A-Z])/g,_horizontalExp=/(left|right|width|margin|padding|x)/i,_complexExp=/[\s,\(]\S/,_propertyAliases={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},_renderCSSProp=function rt(_,ut){return ut.set(ut.t,ut.p,Math.round((ut.s+ut.c*_)*1e4)/1e4+ut.u,ut)},_renderPropWithEnd=function rt(_,ut){return ut.set(ut.t,ut.p,_===1?ut.e:Math.round((ut.s+ut.c*_)*1e4)/1e4+ut.u,ut)},_renderCSSPropWithBeginning=function rt(_,ut){return ut.set(ut.t,ut.p,_?Math.round((ut.s+ut.c*_)*1e4)/1e4+ut.u:ut.b,ut)},_renderRoundedCSSProp=function rt(_,ut){var mt=ut.s+ut.c*_;ut.set(ut.t,ut.p,~~(mt+(mt<0?-.5:.5))+ut.u,ut)},_renderNonTweeningValue=function rt(_,ut){return ut.set(ut.t,ut.p,_?ut.e:ut.b,ut)},_renderNonTweeningValueOnlyAtEnd=function rt(_,ut){return ut.set(ut.t,ut.p,_!==1?ut.b:ut.e,ut)},_setterCSSStyle=function rt(_,ut,mt){return _.style[ut]=mt},_setterCSSProp=function rt(_,ut,mt){return _.style.setProperty(ut,mt)},_setterTransform=function rt(_,ut,mt){return _._gsap[ut]=mt},_setterScale=function rt(_,ut,mt){return _._gsap.scaleX=_._gsap.scaleY=mt},_setterScaleWithRender=function rt(_,ut,mt,bt,St){var Mt=_._gsap;Mt.scaleX=Mt.scaleY=mt,Mt.renderTransform(St,Mt)},_setterTransformWithRender=function rt(_,ut,mt,bt,St){var Mt=_._gsap;Mt[ut]=mt,Mt.renderTransform(St,Mt)},_transformProp="transform",_transformOriginProp=_transformProp+"Origin",_saveStyle=function rt(_,ut){var mt=this,bt=this.target,St=bt.style,Mt=bt._gsap;if(_ in _transformProps&&St){if(this.tfm=this.tfm||{},_!=="transform")_=_propertyAliases[_]||_,~_.indexOf(",")?_.split(",").forEach(function(Bt){return mt.tfm[Bt]=_get(bt,Bt)}):this.tfm[_]=Mt.x?Mt[_]:_get(bt,_),_===_transformOriginProp&&(this.tfm.zOrigin=Mt.zOrigin);else return _propertyAliases.transform.split(",").forEach(function(Bt){return rt.call(mt,Bt,ut)});if(this.props.indexOf(_transformProp)>=0)return;Mt.svg&&(this.svgo=bt.getAttribute("data-svg-origin"),this.props.push(_transformOriginProp,ut,"")),_=_transformProp}(St||ut)&&this.props.push(_,ut,St[_])},_removeIndependentTransforms=function rt(_){_.translate&&(_.removeProperty("translate"),_.removeProperty("scale"),_.removeProperty("rotate"))},_revertStyle=function rt(){var _=this.props,ut=this.target,mt=ut.style,bt=ut._gsap,St,Mt;for(St=0;St<_.length;St+=3)_[St+1]?ut[_[St]]=_[St+2]:_[St+2]?mt[_[St]]=_[St+2]:mt.removeProperty(_[St].substr(0,2)==="--"?_[St]:_[St].replace(_capsExp,"-$1").toLowerCase());if(this.tfm){for(Mt in this.tfm)bt[Mt]=this.tfm[Mt];bt.svg&&(bt.renderTransform(),ut.setAttribute("data-svg-origin",this.svgo||"")),St=_reverting(),(!St||!St.isStart)&&!mt[_transformProp]&&(_removeIndependentTransforms(mt),bt.zOrigin&&mt[_transformOriginProp]&&(mt[_transformOriginProp]+=" "+bt.zOrigin+"px",bt.zOrigin=0,bt.renderTransform()),bt.uncache=1)}},_getStyleSaver=function rt(_,ut){var mt={target:_,props:[],revert:_revertStyle,save:_saveStyle};return _._gsap||gsap.core.getCache(_),ut&&ut.split(",").forEach(function(bt){return mt.save(bt)}),mt},_supports3D,_createElement=function rt(_,ut){var mt=_doc.createElementNS?_doc.createElementNS((ut||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),_):_doc.createElement(_);return mt&&mt.style?mt:_doc.createElement(_)},_getComputedProperty=function rt(_,ut,mt){var bt=getComputedStyle(_);return bt[ut]||bt.getPropertyValue(ut.replace(_capsExp,"-$1").toLowerCase())||bt.getPropertyValue(ut)||!mt&&rt(_,_checkPropPrefix(ut)||ut,1)||""},_prefixes="O,Moz,ms,Ms,Webkit".split(","),_checkPropPrefix=function rt(_,ut,mt){var bt=ut||_tempDiv,St=bt.style,Mt=5;if(_ in St&&!mt)return _;for(_=_.charAt(0).toUpperCase()+_.substr(1);Mt--&&!(_prefixes[Mt]+_ in St););return Mt<0?null:(Mt===3?"ms":Mt>=0?_prefixes[Mt]:"")+_},_initCore=function rt(){_windowExists()&&window.document&&(_win=window,_doc=_win.document,_docElement=_doc.documentElement,_tempDiv=_createElement("div")||{style:{}},_createElement("div"),_transformProp=_checkPropPrefix(_transformProp),_transformOriginProp=_transformProp+"Origin",_tempDiv.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",_supports3D=!!_checkPropPrefix("perspective"),_reverting=gsap.core.reverting,_pluginInitted=1)},_getBBoxHack=function rt(_){var ut=_createElement("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),mt=this.parentNode,bt=this.nextSibling,St=this.style.cssText,Mt;if(_docElement.appendChild(ut),ut.appendChild(this),this.style.display="block",_)try{Mt=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=rt}catch{}else this._gsapBBox&&(Mt=this._gsapBBox());return mt&&(bt?mt.insertBefore(this,bt):mt.appendChild(this)),_docElement.removeChild(ut),this.style.cssText=St,Mt},_getAttributeFallbacks=function rt(_,ut){for(var mt=ut.length;mt--;)if(_.hasAttribute(ut[mt]))return _.getAttribute(ut[mt])},_getBBox=function rt(_){var ut;try{ut=_.getBBox()}catch{ut=_getBBoxHack.call(_,!0)}return ut&&(ut.width||ut.height)||_.getBBox===_getBBoxHack||(ut=_getBBoxHack.call(_,!0)),ut&&!ut.width&&!ut.x&&!ut.y?{x:+_getAttributeFallbacks(_,["x","cx","x1"])||0,y:+_getAttributeFallbacks(_,["y","cy","y1"])||0,width:0,height:0}:ut},_isSVG=function rt(_){return!!(_.getCTM&&(!_.parentNode||_.ownerSVGElement)&&_getBBox(_))},_removeProperty=function rt(_,ut){if(ut){var mt=_.style,bt;ut in _transformProps&&ut!==_transformOriginProp&&(ut=_transformProp),mt.removeProperty?(bt=ut.substr(0,2),(bt==="ms"||ut.substr(0,6)==="webkit")&&(ut="-"+ut),mt.removeProperty(bt==="--"?ut:ut.replace(_capsExp,"-$1").toLowerCase())):mt.removeAttribute(ut)}},_addNonTweeningPT=function rt(_,ut,mt,bt,St,Mt){var Bt=new PropTween(_._pt,ut,mt,0,1,Mt?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue);return _._pt=Bt,Bt.b=bt,Bt.e=St,_._props.push(mt),Bt},_nonConvertibleUnits={deg:1,rad:1,turn:1},_nonStandardLayouts={grid:1,flex:1},_convertToUnit=function rt(_,ut,mt,bt){var St=parseFloat(mt)||0,Mt=(mt+"").trim().substr((St+"").length)||"px",Bt=_tempDiv.style,Ut=_horizontalExp.test(ut),Ht=_.tagName.toLowerCase()==="svg",tr=(Ht?"client":"offset")+(Ut?"Width":"Height"),rr=100,sr=bt==="px",ar=bt==="%",cr,Ar,_r,Dr;if(bt===Mt||!St||_nonConvertibleUnits[bt]||_nonConvertibleUnits[Mt])return St;if(Mt!=="px"&&!sr&&(St=rt(_,ut,mt,"px")),Dr=_.getCTM&&_isSVG(_),(ar||Mt==="%")&&(_transformProps[ut]||~ut.indexOf("adius")))return cr=Dr?_.getBBox()[Ut?"width":"height"]:_[tr],_round(ar?St/cr*rr:St/100*cr);if(Bt[Ut?"width":"height"]=rr+(sr?Mt:bt),Ar=~ut.indexOf("adius")||bt==="em"&&_.appendChild&&!Ht?_:_.parentNode,Dr&&(Ar=(_.ownerSVGElement||{}).parentNode),(!Ar||Ar===_doc||!Ar.appendChild)&&(Ar=_doc.body),_r=Ar._gsap,_r&&ar&&_r.width&&Ut&&_r.time===_ticker.time&&!_r.uncache)return _round(St/_r.width*rr);if(ar&&(ut==="height"||ut==="width")){var $r=_.style[ut];_.style[ut]=rr+bt,cr=_[tr],$r?_.style[ut]=$r:_removeProperty(_,ut)}else(ar||Mt==="%")&&!_nonStandardLayouts[_getComputedProperty(Ar,"display")]&&(Bt.position=_getComputedProperty(_,"position")),Ar===_&&(Bt.position="static"),Ar.appendChild(_tempDiv),cr=_tempDiv[tr],Ar.removeChild(_tempDiv),Bt.position="absolute";return Ut&&ar&&(_r=_getCache(Ar),_r.time=_ticker.time,_r.width=Ar[tr]),_round(sr?cr*St/rr:cr&&St?rr/cr*St:0)},_get=function rt(_,ut,mt,bt){var St;return _pluginInitted||_initCore(),ut in _propertyAliases&&ut!=="transform"&&(ut=_propertyAliases[ut],~ut.indexOf(",")&&(ut=ut.split(",")[0])),_transformProps[ut]&&ut!=="transform"?(St=_parseTransform(_,bt),St=ut!=="transformOrigin"?St[ut]:St.svg?St.origin:_firstTwoOnly(_getComputedProperty(_,_transformOriginProp))+" "+St.zOrigin+"px"):(St=_.style[ut],(!St||St==="auto"||bt||~(St+"").indexOf("calc("))&&(St=_specialProps[ut]&&_specialProps[ut](_,ut,mt)||_getComputedProperty(_,ut)||_getProperty(_,ut)||(ut==="opacity"?1:0))),mt&&!~(St+"").trim().indexOf(" ")?_convertToUnit(_,ut,St,mt)+mt:St},_tweenComplexCSSString=function rt(_,ut,mt,bt){if(!mt||mt==="none"){var St=_checkPropPrefix(ut,_,1),Mt=St&&_getComputedProperty(_,St,1);Mt&&Mt!==mt?(ut=St,mt=Mt):ut==="borderColor"&&(mt=_getComputedProperty(_,"borderTopColor"))}var Bt=new PropTween(this._pt,_.style,ut,0,1,_renderComplexString),Ut=0,Ht=0,tr,rr,sr,ar,cr,Ar,_r,Dr,$r,Br,Jr,mn;if(Bt.b=mt,Bt.e=bt,mt+="",bt+="",bt==="auto"&&(Ar=_.style[ut],_.style[ut]=bt,bt=_getComputedProperty(_,ut)||bt,Ar?_.style[ut]=Ar:_removeProperty(_,ut)),tr=[mt,bt],_colorStringFilter(tr),mt=tr[0],bt=tr[1],sr=mt.match(_numWithUnitExp)||[],mn=bt.match(_numWithUnitExp)||[],mn.length){for(;rr=_numWithUnitExp.exec(bt);)_r=rr[0],$r=bt.substring(Ut,rr.index),cr?cr=(cr+1)%5:($r.substr(-5)==="rgba("||$r.substr(-5)==="hsla(")&&(cr=1),_r!==(Ar=sr[Ht++]||"")&&(ar=parseFloat(Ar)||0,Jr=Ar.substr((ar+"").length),_r.charAt(1)==="="&&(_r=_parseRelative(ar,_r)+Jr),Dr=parseFloat(_r),Br=_r.substr((Dr+"").length),Ut=_numWithUnitExp.lastIndex-Br.length,Br||(Br=Br||_config.units[ut]||Jr,Ut===bt.length&&(bt+=Br,Bt.e+=Br)),Jr!==Br&&(ar=_convertToUnit(_,ut,Ar,Br)||0),Bt._pt={_next:Bt._pt,p:$r||Ht===1?$r:",",s:ar,c:Dr-ar,m:cr&&cr<4||ut==="zIndex"?Math.round:0});Bt.c=Ut<bt.length?bt.substring(Ut,bt.length):""}else Bt.r=ut==="display"&&bt==="none"?_renderNonTweeningValueOnlyAtEnd:_renderNonTweeningValue;return _relExp.test(bt)&&(Bt.e=0),this._pt=Bt,Bt},_keywordToPercent={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},_convertKeywordsToPercentages=function rt(_){var ut=_.split(" "),mt=ut[0],bt=ut[1]||"50%";return(mt==="top"||mt==="bottom"||bt==="left"||bt==="right")&&(_=mt,mt=bt,bt=_),ut[0]=_keywordToPercent[mt]||mt,ut[1]=_keywordToPercent[bt]||bt,ut.join(" ")},_renderClearProps=function rt(_,ut){if(ut.tween&&ut.tween._time===ut.tween._dur){var mt=ut.t,bt=mt.style,St=ut.u,Mt=mt._gsap,Bt,Ut,Ht;if(St==="all"||St===!0)bt.cssText="",Ut=1;else for(St=St.split(","),Ht=St.length;--Ht>-1;)Bt=St[Ht],_transformProps[Bt]&&(Ut=1,Bt=Bt==="transformOrigin"?_transformOriginProp:_transformProp),_removeProperty(mt,Bt);Ut&&(_removeProperty(mt,_transformProp),Mt&&(Mt.svg&&mt.removeAttribute("transform"),_parseTransform(mt,1),Mt.uncache=1,_removeIndependentTransforms(bt)))}},_specialProps={clearProps:function rt(_,ut,mt,bt,St){if(St.data!=="isFromStart"){var Mt=_._pt=new PropTween(_._pt,ut,mt,0,0,_renderClearProps);return Mt.u=bt,Mt.pr=-10,Mt.tween=St,_._props.push(mt),1}}},_identity2DMatrix=[1,0,0,1,0,0],_rotationalProperties={},_isNullTransform=function rt(_){return _==="matrix(1, 0, 0, 1, 0, 0)"||_==="none"||!_},_getComputedTransformMatrixAsArray=function rt(_){var ut=_getComputedProperty(_,_transformProp);return _isNullTransform(ut)?_identity2DMatrix:ut.substr(7).match(_numExp).map(_round)},_getMatrix=function rt(_,ut){var mt=_._gsap||_getCache(_),bt=_.style,St=_getComputedTransformMatrixAsArray(_),Mt,Bt,Ut,Ht;return mt.svg&&_.getAttribute("transform")?(Ut=_.transform.baseVal.consolidate().matrix,St=[Ut.a,Ut.b,Ut.c,Ut.d,Ut.e,Ut.f],St.join(",")==="1,0,0,1,0,0"?_identity2DMatrix:St):(St===_identity2DMatrix&&!_.offsetParent&&_!==_docElement&&!mt.svg&&(Ut=bt.display,bt.display="block",Mt=_.parentNode,(!Mt||!_.offsetParent)&&(Ht=1,Bt=_.nextElementSibling,_docElement.appendChild(_)),St=_getComputedTransformMatrixAsArray(_),Ut?bt.display=Ut:_removeProperty(_,"display"),Ht&&(Bt?Mt.insertBefore(_,Bt):Mt?Mt.appendChild(_):_docElement.removeChild(_))),ut&&St.length>6?[St[0],St[1],St[4],St[5],St[12],St[13]]:St)},_applySVGOrigin=function rt(_,ut,mt,bt,St,Mt){var Bt=_._gsap,Ut=St||_getMatrix(_,!0),Ht=Bt.xOrigin||0,tr=Bt.yOrigin||0,rr=Bt.xOffset||0,sr=Bt.yOffset||0,ar=Ut[0],cr=Ut[1],Ar=Ut[2],_r=Ut[3],Dr=Ut[4],$r=Ut[5],Br=ut.split(" "),Jr=parseFloat(Br[0])||0,mn=parseFloat(Br[1])||0,Mn,$n,en,In;mt?Ut!==_identity2DMatrix&&($n=ar*_r-cr*Ar)&&(en=Jr*(_r/$n)+mn*(-Ar/$n)+(Ar*$r-_r*Dr)/$n,In=Jr*(-cr/$n)+mn*(ar/$n)-(ar*$r-cr*Dr)/$n,Jr=en,mn=In):(Mn=_getBBox(_),Jr=Mn.x+(~Br[0].indexOf("%")?Jr/100*Mn.width:Jr),mn=Mn.y+(~(Br[1]||Br[0]).indexOf("%")?mn/100*Mn.height:mn)),bt||bt!==!1&&Bt.smooth?(Dr=Jr-Ht,$r=mn-tr,Bt.xOffset=rr+(Dr*ar+$r*Ar)-Dr,Bt.yOffset=sr+(Dr*cr+$r*_r)-$r):Bt.xOffset=Bt.yOffset=0,Bt.xOrigin=Jr,Bt.yOrigin=mn,Bt.smooth=!!bt,Bt.origin=ut,Bt.originIsAbsolute=!!mt,_.style[_transformOriginProp]="0px 0px",Mt&&(_addNonTweeningPT(Mt,Bt,"xOrigin",Ht,Jr),_addNonTweeningPT(Mt,Bt,"yOrigin",tr,mn),_addNonTweeningPT(Mt,Bt,"xOffset",rr,Bt.xOffset),_addNonTweeningPT(Mt,Bt,"yOffset",sr,Bt.yOffset)),_.setAttribute("data-svg-origin",Jr+" "+mn)},_parseTransform=function rt(_,ut){var mt=_._gsap||new GSCache(_);if("x"in mt&&!ut&&!mt.uncache)return mt;var bt=_.style,St=mt.scaleX<0,Mt="px",Bt="deg",Ut=getComputedStyle(_),Ht=_getComputedProperty(_,_transformOriginProp)||"0",tr,rr,sr,ar,cr,Ar,_r,Dr,$r,Br,Jr,mn,Mn,$n,en,In,Rn,qn,Qn,xs,cs,ks,_o,qs,Ss,eo,Ao,Oo,uo,uu,cu,Jl;return tr=rr=sr=Ar=_r=Dr=$r=Br=Jr=0,ar=cr=1,mt.svg=!!(_.getCTM&&_isSVG(_)),Ut.translate&&((Ut.translate!=="none"||Ut.scale!=="none"||Ut.rotate!=="none")&&(bt[_transformProp]=(Ut.translate!=="none"?"translate3d("+(Ut.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(Ut.rotate!=="none"?"rotate("+Ut.rotate+") ":"")+(Ut.scale!=="none"?"scale("+Ut.scale.split(" ").join(",")+") ":"")+(Ut[_transformProp]!=="none"?Ut[_transformProp]:"")),bt.scale=bt.rotate=bt.translate="none"),$n=_getMatrix(_,mt.svg),mt.svg&&(mt.uncache?(Ss=_.getBBox(),Ht=mt.xOrigin-Ss.x+"px "+(mt.yOrigin-Ss.y)+"px",qs=""):qs=!ut&&_.getAttribute("data-svg-origin"),_applySVGOrigin(_,qs||Ht,!!qs||mt.originIsAbsolute,mt.smooth!==!1,$n)),mn=mt.xOrigin||0,Mn=mt.yOrigin||0,$n!==_identity2DMatrix&&(qn=$n[0],Qn=$n[1],xs=$n[2],cs=$n[3],tr=ks=$n[4],rr=_o=$n[5],$n.length===6?(ar=Math.sqrt(qn*qn+Qn*Qn),cr=Math.sqrt(cs*cs+xs*xs),Ar=qn||Qn?_atan2(Qn,qn)*_RAD2DEG:0,$r=xs||cs?_atan2(xs,cs)*_RAD2DEG+Ar:0,$r&&(cr*=Math.abs(Math.cos($r*_DEG2RAD))),mt.svg&&(tr-=mn-(mn*qn+Mn*xs),rr-=Mn-(mn*Qn+Mn*cs))):(Jl=$n[6],uu=$n[7],Ao=$n[8],Oo=$n[9],uo=$n[10],cu=$n[11],tr=$n[12],rr=$n[13],sr=$n[14],en=_atan2(Jl,uo),_r=en*_RAD2DEG,en&&(In=Math.cos(-en),Rn=Math.sin(-en),qs=ks*In+Ao*Rn,Ss=_o*In+Oo*Rn,eo=Jl*In+uo*Rn,Ao=ks*-Rn+Ao*In,Oo=_o*-Rn+Oo*In,uo=Jl*-Rn+uo*In,cu=uu*-Rn+cu*In,ks=qs,_o=Ss,Jl=eo),en=_atan2(-xs,uo),Dr=en*_RAD2DEG,en&&(In=Math.cos(-en),Rn=Math.sin(-en),qs=qn*In-Ao*Rn,Ss=Qn*In-Oo*Rn,eo=xs*In-uo*Rn,cu=cs*Rn+cu*In,qn=qs,Qn=Ss,xs=eo),en=_atan2(Qn,qn),Ar=en*_RAD2DEG,en&&(In=Math.cos(en),Rn=Math.sin(en),qs=qn*In+Qn*Rn,Ss=ks*In+_o*Rn,Qn=Qn*In-qn*Rn,_o=_o*In-ks*Rn,qn=qs,ks=Ss),_r&&Math.abs(_r)+Math.abs(Ar)>359.9&&(_r=Ar=0,Dr=180-Dr),ar=_round(Math.sqrt(qn*qn+Qn*Qn+xs*xs)),cr=_round(Math.sqrt(_o*_o+Jl*Jl)),en=_atan2(ks,_o),$r=Math.abs(en)>2e-4?en*_RAD2DEG:0,Jr=cu?1/(cu<0?-cu:cu):0),mt.svg&&(qs=_.getAttribute("transform"),mt.forceCSS=_.setAttribute("transform","")||!_isNullTransform(_getComputedProperty(_,_transformProp)),qs&&_.setAttribute("transform",qs))),Math.abs($r)>90&&Math.abs($r)<270&&(St?(ar*=-1,$r+=Ar<=0?180:-180,Ar+=Ar<=0?180:-180):(cr*=-1,$r+=$r<=0?180:-180)),ut=ut||mt.uncache,mt.x=tr-((mt.xPercent=tr&&(!ut&&mt.xPercent||(Math.round(_.offsetWidth/2)===Math.round(-tr)?-50:0)))?_.offsetWidth*mt.xPercent/100:0)+Mt,mt.y=rr-((mt.yPercent=rr&&(!ut&&mt.yPercent||(Math.round(_.offsetHeight/2)===Math.round(-rr)?-50:0)))?_.offsetHeight*mt.yPercent/100:0)+Mt,mt.z=sr+Mt,mt.scaleX=_round(ar),mt.scaleY=_round(cr),mt.rotation=_round(Ar)+Bt,mt.rotationX=_round(_r)+Bt,mt.rotationY=_round(Dr)+Bt,mt.skewX=$r+Bt,mt.skewY=Br+Bt,mt.transformPerspective=Jr+Mt,(mt.zOrigin=parseFloat(Ht.split(" ")[2])||!ut&&mt.zOrigin||0)&&(bt[_transformOriginProp]=_firstTwoOnly(Ht)),mt.xOffset=mt.yOffset=0,mt.force3D=_config.force3D,mt.renderTransform=mt.svg?_renderSVGTransforms:_supports3D?_renderCSSTransforms:_renderNon3DTransforms,mt.uncache=0,mt},_firstTwoOnly=function rt(_){return(_=_.split(" "))[0]+" "+_[1]},_addPxTranslate=function rt(_,ut,mt){var bt=getUnit(ut);return _round(parseFloat(ut)+parseFloat(_convertToUnit(_,"x",mt+"px",bt)))+bt},_renderNon3DTransforms=function rt(_,ut){ut.z="0px",ut.rotationY=ut.rotationX="0deg",ut.force3D=0,_renderCSSTransforms(_,ut)},_zeroDeg="0deg",_zeroPx="0px",_endParenthesis=") ",_renderCSSTransforms=function rt(_,ut){var mt=ut||this,bt=mt.xPercent,St=mt.yPercent,Mt=mt.x,Bt=mt.y,Ut=mt.z,Ht=mt.rotation,tr=mt.rotationY,rr=mt.rotationX,sr=mt.skewX,ar=mt.skewY,cr=mt.scaleX,Ar=mt.scaleY,_r=mt.transformPerspective,Dr=mt.force3D,$r=mt.target,Br=mt.zOrigin,Jr="",mn=Dr==="auto"&&_&&_!==1||Dr===!0;if(Br&&(rr!==_zeroDeg||tr!==_zeroDeg)){var Mn=parseFloat(tr)*_DEG2RAD,$n=Math.sin(Mn),en=Math.cos(Mn),In;Mn=parseFloat(rr)*_DEG2RAD,In=Math.cos(Mn),Mt=_addPxTranslate($r,Mt,$n*In*-Br),Bt=_addPxTranslate($r,Bt,-Math.sin(Mn)*-Br),Ut=_addPxTranslate($r,Ut,en*In*-Br+Br)}_r!==_zeroPx&&(Jr+="perspective("+_r+_endParenthesis),(bt||St)&&(Jr+="translate("+bt+"%, "+St+"%) "),(mn||Mt!==_zeroPx||Bt!==_zeroPx||Ut!==_zeroPx)&&(Jr+=Ut!==_zeroPx||mn?"translate3d("+Mt+", "+Bt+", "+Ut+") ":"translate("+Mt+", "+Bt+_endParenthesis),Ht!==_zeroDeg&&(Jr+="rotate("+Ht+_endParenthesis),tr!==_zeroDeg&&(Jr+="rotateY("+tr+_endParenthesis),rr!==_zeroDeg&&(Jr+="rotateX("+rr+_endParenthesis),(sr!==_zeroDeg||ar!==_zeroDeg)&&(Jr+="skew("+sr+", "+ar+_endParenthesis),(cr!==1||Ar!==1)&&(Jr+="scale("+cr+", "+Ar+_endParenthesis),$r.style[_transformProp]=Jr||"translate(0, 0)"},_renderSVGTransforms=function rt(_,ut){var mt=ut||this,bt=mt.xPercent,St=mt.yPercent,Mt=mt.x,Bt=mt.y,Ut=mt.rotation,Ht=mt.skewX,tr=mt.skewY,rr=mt.scaleX,sr=mt.scaleY,ar=mt.target,cr=mt.xOrigin,Ar=mt.yOrigin,_r=mt.xOffset,Dr=mt.yOffset,$r=mt.forceCSS,Br=parseFloat(Mt),Jr=parseFloat(Bt),mn,Mn,$n,en,In;Ut=parseFloat(Ut),Ht=parseFloat(Ht),tr=parseFloat(tr),tr&&(tr=parseFloat(tr),Ht+=tr,Ut+=tr),Ut||Ht?(Ut*=_DEG2RAD,Ht*=_DEG2RAD,mn=Math.cos(Ut)*rr,Mn=Math.sin(Ut)*rr,$n=Math.sin(Ut-Ht)*-sr,en=Math.cos(Ut-Ht)*sr,Ht&&(tr*=_DEG2RAD,In=Math.tan(Ht-tr),In=Math.sqrt(1+In*In),$n*=In,en*=In,tr&&(In=Math.tan(tr),In=Math.sqrt(1+In*In),mn*=In,Mn*=In)),mn=_round(mn),Mn=_round(Mn),$n=_round($n),en=_round(en)):(mn=rr,en=sr,Mn=$n=0),(Br&&!~(Mt+"").indexOf("px")||Jr&&!~(Bt+"").indexOf("px"))&&(Br=_convertToUnit(ar,"x",Mt,"px"),Jr=_convertToUnit(ar,"y",Bt,"px")),(cr||Ar||_r||Dr)&&(Br=_round(Br+cr-(cr*mn+Ar*$n)+_r),Jr=_round(Jr+Ar-(cr*Mn+Ar*en)+Dr)),(bt||St)&&(In=ar.getBBox(),Br=_round(Br+bt/100*In.width),Jr=_round(Jr+St/100*In.height)),In="matrix("+mn+","+Mn+","+$n+","+en+","+Br+","+Jr+")",ar.setAttribute("transform",In),$r&&(ar.style[_transformProp]=In)},_addRotationalPropTween=function rt(_,ut,mt,bt,St){var Mt=360,Bt=_isString(St),Ut=parseFloat(St)*(Bt&&~St.indexOf("rad")?_RAD2DEG:1),Ht=Ut-bt,tr=bt+Ht+"deg",rr,sr;return Bt&&(rr=St.split("_")[1],rr==="short"&&(Ht%=Mt,Ht!==Ht%(Mt/2)&&(Ht+=Ht<0?Mt:-Mt)),rr==="cw"&&Ht<0?Ht=(Ht+Mt*_bigNum)%Mt-~~(Ht/Mt)*Mt:rr==="ccw"&&Ht>0&&(Ht=(Ht-Mt*_bigNum)%Mt-~~(Ht/Mt)*Mt)),_._pt=sr=new PropTween(_._pt,ut,mt,bt,Ht,_renderPropWithEnd),sr.e=tr,sr.u="deg",_._props.push(mt),sr},_assign=function rt(_,ut){for(var mt in ut)_[mt]=ut[mt];return _},_addRawTransformPTs=function rt(_,ut,mt){var bt=_assign({},mt._gsap),St="perspective,force3D,transformOrigin,svgOrigin",Mt=mt.style,Bt,Ut,Ht,tr,rr,sr,ar,cr;bt.svg?(Ht=mt.getAttribute("transform"),mt.setAttribute("transform",""),Mt[_transformProp]=ut,Bt=_parseTransform(mt,1),_removeProperty(mt,_transformProp),mt.setAttribute("transform",Ht)):(Ht=getComputedStyle(mt)[_transformProp],Mt[_transformProp]=ut,Bt=_parseTransform(mt,1),Mt[_transformProp]=Ht);for(Ut in _transformProps)Ht=bt[Ut],tr=Bt[Ut],Ht!==tr&&St.indexOf(Ut)<0&&(ar=getUnit(Ht),cr=getUnit(tr),rr=ar!==cr?_convertToUnit(mt,Ut,Ht,cr):parseFloat(Ht),sr=parseFloat(tr),_._pt=new PropTween(_._pt,Bt,Ut,rr,sr-rr,_renderCSSProp),_._pt.u=cr||0,_._props.push(Ut));_assign(Bt,bt)};_forEachName("padding,margin,Width,Radius",function(rt,_){var ut="Top",mt="Right",bt="Bottom",St="Left",Mt=(_<3?[ut,mt,bt,St]:[ut+St,ut+mt,bt+mt,bt+St]).map(function(Bt){return _<2?rt+Bt:"border"+Bt+rt});_specialProps[_>1?"border"+rt:rt]=function(Bt,Ut,Ht,tr,rr){var sr,ar;if(arguments.length<4)return sr=Mt.map(function(cr){return _get(Bt,cr,Ht)}),ar=sr.join(" "),ar.split(sr[0]).length===5?sr[0]:ar;sr=(tr+"").split(" "),ar={},Mt.forEach(function(cr,Ar){return ar[cr]=sr[Ar]=sr[Ar]||sr[(Ar-1)/2|0]}),Bt.init(Ut,ar,rr)}});var CSSPlugin={name:"css",register:_initCore,targetTest:function rt(_){return _.style&&_.nodeType},init:function rt(_,ut,mt,bt,St){var Mt=this._props,Bt=_.style,Ut=mt.vars.startAt,Ht,tr,rr,sr,ar,cr,Ar,_r,Dr,$r,Br,Jr,mn,Mn,$n,en;_pluginInitted||_initCore(),this.styles=this.styles||_getStyleSaver(_),en=this.styles.props,this.tween=mt;for(Ar in ut)if(Ar!=="autoRound"&&(tr=ut[Ar],!(_plugins[Ar]&&_checkPlugin(Ar,ut,mt,bt,_,St)))){if(ar=typeof tr,cr=_specialProps[Ar],ar==="function"&&(tr=tr.call(mt,bt,_,St),ar=typeof tr),ar==="string"&&~tr.indexOf("random(")&&(tr=_replaceRandom(tr)),cr)cr(this,_,Ar,tr,mt)&&($n=1);else if(Ar.substr(0,2)==="--")Ht=(getComputedStyle(_).getPropertyValue(Ar)+"").trim(),tr+="",_colorExp.lastIndex=0,_colorExp.test(Ht)||(_r=getUnit(Ht),Dr=getUnit(tr)),Dr?_r!==Dr&&(Ht=_convertToUnit(_,Ar,Ht,Dr)+Dr):_r&&(tr+=_r),this.add(Bt,"setProperty",Ht,tr,bt,St,0,0,Ar),Mt.push(Ar),en.push(Ar,0,Bt[Ar]);else if(ar!=="undefined"){if(Ut&&Ar in Ut?(Ht=typeof Ut[Ar]=="function"?Ut[Ar].call(mt,bt,_,St):Ut[Ar],_isString(Ht)&&~Ht.indexOf("random(")&&(Ht=_replaceRandom(Ht)),getUnit(Ht+"")||Ht==="auto"||(Ht+=_config.units[Ar]||getUnit(_get(_,Ar))||""),(Ht+"").charAt(1)==="="&&(Ht=_get(_,Ar))):Ht=_get(_,Ar),sr=parseFloat(Ht),$r=ar==="string"&&tr.charAt(1)==="="&&tr.substr(0,2),$r&&(tr=tr.substr(2)),rr=parseFloat(tr),Ar in _propertyAliases&&(Ar==="autoAlpha"&&(sr===1&&_get(_,"visibility")==="hidden"&&rr&&(sr=0),en.push("visibility",0,Bt.visibility),_addNonTweeningPT(this,Bt,"visibility",sr?"inherit":"hidden",rr?"inherit":"hidden",!rr)),Ar!=="scale"&&Ar!=="transform"&&(Ar=_propertyAliases[Ar],~Ar.indexOf(",")&&(Ar=Ar.split(",")[0]))),Br=Ar in _transformProps,Br){if(this.styles.save(Ar),Jr||(mn=_._gsap,mn.renderTransform&&!ut.parseTransform||_parseTransform(_,ut.parseTransform),Mn=ut.smoothOrigin!==!1&&mn.smooth,Jr=this._pt=new PropTween(this._pt,Bt,_transformProp,0,1,mn.renderTransform,mn,0,-1),Jr.dep=1),Ar==="scale")this._pt=new PropTween(this._pt,mn,"scaleY",mn.scaleY,($r?_parseRelative(mn.scaleY,$r+rr):rr)-mn.scaleY||0,_renderCSSProp),this._pt.u=0,Mt.push("scaleY",Ar),Ar+="X";else if(Ar==="transformOrigin"){en.push(_transformOriginProp,0,Bt[_transformOriginProp]),tr=_convertKeywordsToPercentages(tr),mn.svg?_applySVGOrigin(_,tr,0,Mn,0,this):(Dr=parseFloat(tr.split(" ")[2])||0,Dr!==mn.zOrigin&&_addNonTweeningPT(this,mn,"zOrigin",mn.zOrigin,Dr),_addNonTweeningPT(this,Bt,Ar,_firstTwoOnly(Ht),_firstTwoOnly(tr)));continue}else if(Ar==="svgOrigin"){_applySVGOrigin(_,tr,1,Mn,0,this);continue}else if(Ar in _rotationalProperties){_addRotationalPropTween(this,mn,Ar,sr,$r?_parseRelative(sr,$r+tr):tr);continue}else if(Ar==="smoothOrigin"){_addNonTweeningPT(this,mn,"smooth",mn.smooth,tr);continue}else if(Ar==="force3D"){mn[Ar]=tr;continue}else if(Ar==="transform"){_addRawTransformPTs(this,tr,_);continue}}else Ar in Bt||(Ar=_checkPropPrefix(Ar)||Ar);if(Br||(rr||rr===0)&&(sr||sr===0)&&!_complexExp.test(tr)&&Ar in Bt)_r=(Ht+"").substr((sr+"").length),rr||(rr=0),Dr=getUnit(tr)||(Ar in _config.units?_config.units[Ar]:_r),_r!==Dr&&(sr=_convertToUnit(_,Ar,Ht,Dr)),this._pt=new PropTween(this._pt,Br?mn:Bt,Ar,sr,($r?_parseRelative(sr,$r+rr):rr)-sr,!Br&&(Dr==="px"||Ar==="zIndex")&&ut.autoRound!==!1?_renderRoundedCSSProp:_renderCSSProp),this._pt.u=Dr||0,_r!==Dr&&Dr!=="%"&&(this._pt.b=Ht,this._pt.r=_renderCSSPropWithBeginning);else if(Ar in Bt)_tweenComplexCSSString.call(this,_,Ar,Ht,$r?$r+tr:tr);else if(Ar in _)this.add(_,Ar,Ht||_[Ar],$r?$r+tr:tr,bt,St);else if(Ar!=="parseTransform"){_missingPlugin(Ar,tr);continue}Br||(Ar in Bt?en.push(Ar,0,Bt[Ar]):en.push(Ar,1,Ht||_[Ar])),Mt.push(Ar)}}$n&&_sortPropTweensByPriority(this)},render:function rt(_,ut){if(ut.tween._time||!_reverting())for(var mt=ut._pt;mt;)mt.r(_,mt.d),mt=mt._next;else ut.styles.revert()},get:_get,aliases:_propertyAliases,getSetter:function rt(_,ut,mt){var bt=_propertyAliases[ut];return bt&&bt.indexOf(",")<0&&(ut=bt),ut in _transformProps&&ut!==_transformOriginProp&&(_._gsap.x||_get(_,"x"))?mt&&_recentSetterPlugin===mt?ut==="scale"?_setterScale:_setterTransform:(_recentSetterPlugin=mt||{})&&(ut==="scale"?_setterScaleWithRender:_setterTransformWithRender):_.style&&!_isUndefined(_.style[ut])?_setterCSSStyle:~ut.indexOf("-")?_setterCSSProp:_getSetter(_,ut)},core:{_removeProperty,_getMatrix}};gsap.utils.checkPrefix=_checkPropPrefix;gsap.core.getStyleSaver=_getStyleSaver;(function(rt,_,ut,mt){var bt=_forEachName(rt+","+_+","+ut,function(St){_transformProps[St]=1});_forEachName(_,function(St){_config.units[St]="deg",_rotationalProperties[St]=1}),_propertyAliases[bt[13]]=rt+","+_,_forEachName(mt,function(St){var Mt=St.split(":");_propertyAliases[Mt[1]]=bt[Mt[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");_forEachName("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(rt){_config.units[rt]="px"});gsap.registerPlugin(CSSPlugin);var gsapWithCSS=gsap.registerPlugin(CSSPlugin)||gsap;gsapWithCSS.core.Tween;const Background=()=>{const rt=reactExports.useRef(null),_=reactExports.useRef({color:"#b9bcff"}),ut=useScroll(),mt=reactExports.useRef(null);return useFrame(()=>{mt.current&&mt.current.progress(ut.offset),rt.current&&rt.current.color.set(_.current.color)}),reactExports.useEffect(()=>{mt.current=gsapWithCSS.timeline({paused:!0}),mt.current.to(_.current,{color:"#212121",duration:1}),mt.current.to(_.current,{color:"#7a7ca5",duration:1}),mt.current.to(_.current,{color:"#9b96dd",duration:1})},[]),jsxRuntimeExports.jsx("group",{children:jsxRuntimeExports.jsx(Sphere,{scale:30,children:jsxRuntimeExports.jsx("meshBasicMaterial",{ref:rt,side:BackSide,toneMapped:!1})})})},ThreeD$1=rt=>{const{section:_}=rt,[ut,mt]=reactExports.useState(0),{menuOpened:bt}=rt,{viewport:St}=useThree(),[Mt,Bt]=reactExports.useState("Typing"),Ut=useScroll(),Ht=useMotionValue(0),tr=useMotionValue(0);return reactExports.useEffect(()=>{Bt("FallAnimation"),setTimeout(()=>{Bt(_===0?"Typing":"Praying")},800)},[_]),reactExports.useEffect(()=>{animate(Ht,bt?-5:0),animate(tr,bt?1:0)},[bt]),useFrame(rr=>{let sr=Math.floor(Ut.offset*Ut.pages);sr>3&&(sr=3),sr!==ut&&mt(sr),rr.camera.position.x=Ht.get(),rr.camera.lookAt(tr.get(),0,0)}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Background,{}),jsxRuntimeExports.jsx("ambientLight",{intensity:3}),jsxRuntimeExports.jsx(motion.group,{rotation:[0,Math.PI/2+Math.PI/6,0],position:[.5,0-.5,0],scale:[1.1,1.1,1.1],children:jsxRuntimeExports.jsx(RoomScene,{section:_})}),jsxRuntimeExports.jsxs(motion.group,{animate:{z:_===1?8:-8,y:_===1?-St.height:-1.5},children:[jsxRuntimeExports.jsx(Float$1,{children:jsxRuntimeExports.jsxs("mesh",{position:[-1,0,-13],scale:[1,1,1],children:[jsxRuntimeExports.jsx("sphereGeometry",{}),jsxRuntimeExports.jsx(MeshDistortMaterial,{opacity:.7,transparent:!0,distort:.4,speed:4,color:"red"})]})}),jsxRuntimeExports.jsx(Float$1,{children:jsxRuntimeExports.jsxs("mesh",{position:[-1,0,-13],scale:[1,1,1],children:[jsxRuntimeExports.jsx("sphereGeometry",{}),jsxRuntimeExports.jsx(MeshDistortMaterial,{opacity:.8,transparent:!0,distort:1,speed:4,color:"yellow"})]})}),jsxRuntimeExports.jsx(motion.group,{position:[0+.9,0+1.01,0+7.7],animate:""+ut,transition:{duration:.6},variants:{0:{scaleX:1,scaleY:1,scaleZ:1,rotateX:0,rotateY:Math.PI/2+Math.PI/7,rotateZ:0},1:{y:.1,x:0,z:-6,rotateY:Math.PI/2+Math.PI/7+Math.PI},2:{y:-St.height*1.4,x:0,z:-8,rotateY:Math.PI/2+Math.PI/7},3:{y:-St.height*2,x:0,z:-6}},children:jsxRuntimeExports.jsx(XBot,{animation:Mt,menuOpened:bt})})]}),jsxRuntimeExports.jsx(Projects,{}),jsxRuntimeExports.jsx(Leva,{hidden:!0})]})},ScrollManager=rt=>{const{section:_,onSectionChange:ut}=rt,mt=useScroll(),bt=reactExports.useRef(0),St=reactExports.useRef(!1);return mt.fill.classList.add("top-0"),mt.fill.classList.add("absolute"),reactExports.useEffect(()=>{gsapWithCSS.to(mt.el,{duration:1,scrollTop:_*mt.el.clientHeight,onStart:()=>{St.current=!0},onComplete:()=>{St.current=!1}})},[_]),useFrame(()=>{if(St.current){bt.current=mt.offset;return}const Mt=Math.floor(mt.offset*mt.pages);mt.offset>bt.current&&Mt===0&&ut(1),mt.offset<bt.current&&mt.offset<1/(mt.pages-1)&&ut(0),bt.current=mt.offset}),null},Menu=rt=>{const{onSectionChange:_,menuOpened:ut,setMenuOpened:mt}=rt,bt=St=>{mt(!1),_(St),console.log("clicked0")};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{mt(!ut),console.log("clicked")},className:"z-20 fixed top-20 right-12 p-3 bg-indigo-600 w-11 h-11 rounded-md  ",children:[jsxRuntimeExports.jsx("div",{className:`bg-white h-0.5 rounded-md w-full transition-all ${ut?"rotate-45 translate-y-0.5":""}`}),jsxRuntimeExports.jsx("div",{className:`bg-white h-0.5 rounded-md w-full my-1 ${ut?" hidden":""}`}),jsxRuntimeExports.jsx("div",{className:`bg-white h-0.5 rounded-md w-full my-1 ${ut?" -rotate-45":""}`})]}),jsxRuntimeExports.jsx("div",{className:`z-10 fixed top-0 right-0 bottom-0  bg-white transition-all overflow-hidden flex flex-col
                ${ut?"w-80":"w-0"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex-1 flex items-start justify-center flex-col gap-6 p-8",children:[jsxRuntimeExports.jsx(MenuButton,{label:"Home",onClick:()=>bt(0)}),jsxRuntimeExports.jsx(MenuButton,{label:"Skills",onClick:()=>bt(1)}),jsxRuntimeExports.jsx(MenuButton,{label:"Project",onClick:()=>bt(2)}),jsxRuntimeExports.jsx(MenuButton,{label:"Contact me",onClick:()=>bt(3)})]})})]})},MenuButton=rt=>{const{label:_,onClick:ut}=rt;return jsxRuntimeExports.jsx("button",{onClick:ut,className:"text-2xl font-bold cursor-pointer hover:text-indigo-600 transition-colors font-tilt",children:_})},ThreeDCharacter=()=>{const[rt,_]=reactExports.useState(0),[ut,mt]=reactExports.useState(!1);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsxs(MotionConfig,{transition:{...framerMotionConfig},children:[jsxRuntimeExports.jsx(Canvas$1,{shadows:!0,camera:{position:[0,2,4],fov:50},children:jsxRuntimeExports.jsxs(ScrollControls,{pages:4,damping:.15,style:{zIndex:10},children:[jsxRuntimeExports.jsx(ScrollManager,{section:rt,onSectionChange:_}),jsxRuntimeExports.jsx(Scroll,{html:!0,children:jsxRuntimeExports.jsx(Interface,{})}),jsxRuntimeExports.jsx(Scroll,{children:jsxRuntimeExports.jsx(ThreeD$1,{section:rt,menuOpened:ut})})]})}),jsxRuntimeExports.jsx(Menu,{onSectionChange:_,menuOpened:ut,setMenuOpened:mt})]})})};var Easing=Object.freeze({Linear:Object.freeze({None:function(rt){return rt},In:function(rt){return rt},Out:function(rt){return rt},InOut:function(rt){return rt}}),Quadratic:Object.freeze({In:function(rt){return rt*rt},Out:function(rt){return rt*(2-rt)},InOut:function(rt){return(rt*=2)<1?.5*rt*rt:-.5*(--rt*(rt-2)-1)}}),Cubic:Object.freeze({In:function(rt){return rt*rt*rt},Out:function(rt){return--rt*rt*rt+1},InOut:function(rt){return(rt*=2)<1?.5*rt*rt*rt:.5*((rt-=2)*rt*rt+2)}}),Quartic:Object.freeze({In:function(rt){return rt*rt*rt*rt},Out:function(rt){return 1- --rt*rt*rt*rt},InOut:function(rt){return(rt*=2)<1?.5*rt*rt*rt*rt:-.5*((rt-=2)*rt*rt*rt-2)}}),Quintic:Object.freeze({In:function(rt){return rt*rt*rt*rt*rt},Out:function(rt){return--rt*rt*rt*rt*rt+1},InOut:function(rt){return(rt*=2)<1?.5*rt*rt*rt*rt*rt:.5*((rt-=2)*rt*rt*rt*rt+2)}}),Sinusoidal:Object.freeze({In:function(rt){return 1-Math.sin((1-rt)*Math.PI/2)},Out:function(rt){return Math.sin(rt*Math.PI/2)},InOut:function(rt){return .5*(1-Math.sin(Math.PI*(.5-rt)))}}),Exponential:Object.freeze({In:function(rt){return rt===0?0:Math.pow(1024,rt-1)},Out:function(rt){return rt===1?1:1-Math.pow(2,-10*rt)},InOut:function(rt){return rt===0?0:rt===1?1:(rt*=2)<1?.5*Math.pow(1024,rt-1):.5*(-Math.pow(2,-10*(rt-1))+2)}}),Circular:Object.freeze({In:function(rt){return 1-Math.sqrt(1-rt*rt)},Out:function(rt){return Math.sqrt(1- --rt*rt)},InOut:function(rt){return(rt*=2)<1?-.5*(Math.sqrt(1-rt*rt)-1):.5*(Math.sqrt(1-(rt-=2)*rt)+1)}}),Elastic:Object.freeze({In:function(rt){return rt===0?0:rt===1?1:-Math.pow(2,10*(rt-1))*Math.sin((rt-1.1)*5*Math.PI)},Out:function(rt){return rt===0?0:rt===1?1:Math.pow(2,-10*rt)*Math.sin((rt-.1)*5*Math.PI)+1},InOut:function(rt){return rt===0?0:rt===1?1:(rt*=2,rt<1?-.5*Math.pow(2,10*(rt-1))*Math.sin((rt-1.1)*5*Math.PI):.5*Math.pow(2,-10*(rt-1))*Math.sin((rt-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(rt){var _=1.70158;return rt===1?1:rt*rt*((_+1)*rt-_)},Out:function(rt){var _=1.70158;return rt===0?0:--rt*rt*((_+1)*rt+_)+1},InOut:function(rt){var _=2.5949095;return(rt*=2)<1?.5*(rt*rt*((_+1)*rt-_)):.5*((rt-=2)*rt*((_+1)*rt+_)+2)}}),Bounce:Object.freeze({In:function(rt){return 1-Easing.Bounce.Out(1-rt)},Out:function(rt){return rt<1/2.75?7.5625*rt*rt:rt<2/2.75?7.5625*(rt-=1.5/2.75)*rt+.75:rt<2.5/2.75?7.5625*(rt-=2.25/2.75)*rt+.9375:7.5625*(rt-=2.625/2.75)*rt+.984375},InOut:function(rt){return rt<.5?Easing.Bounce.In(rt*2)*.5:Easing.Bounce.Out(rt*2-1)*.5+.5}}),generatePow:function(rt){return rt===void 0&&(rt=4),rt=rt<Number.EPSILON?Number.EPSILON:rt,rt=rt>1e4?1e4:rt,{In:function(_){return Math.pow(_,rt)},Out:function(_){return 1-Math.pow(1-_,rt)},InOut:function(_){return _<.5?Math.pow(_*2,rt)/2:(1-Math.pow(2-_*2,rt))/2+.5}}}}),now=function(){return performance.now()},Group=function(){function rt(){this._tweens={},this._tweensAddedDuringUpdate={}}return rt.prototype.getAll=function(){var _=this;return Object.keys(this._tweens).map(function(ut){return _._tweens[ut]})},rt.prototype.removeAll=function(){this._tweens={}},rt.prototype.add=function(_){this._tweens[_.getId()]=_,this._tweensAddedDuringUpdate[_.getId()]=_},rt.prototype.remove=function(_){delete this._tweens[_.getId()],delete this._tweensAddedDuringUpdate[_.getId()]},rt.prototype.update=function(_,ut){_===void 0&&(_=now()),ut===void 0&&(ut=!1);var mt=Object.keys(this._tweens);if(mt.length===0)return!1;for(;mt.length>0;){this._tweensAddedDuringUpdate={};for(var bt=0;bt<mt.length;bt++){var St=this._tweens[mt[bt]],Mt=!ut;St&&St.update(_,Mt)===!1&&!ut&&delete this._tweens[mt[bt]]}mt=Object.keys(this._tweensAddedDuringUpdate)}return!0},rt}(),Interpolation={Linear:function(rt,_){var ut=rt.length-1,mt=ut*_,bt=Math.floor(mt),St=Interpolation.Utils.Linear;return _<0?St(rt[0],rt[1],mt):_>1?St(rt[ut],rt[ut-1],ut-mt):St(rt[bt],rt[bt+1>ut?ut:bt+1],mt-bt)},Bezier:function(rt,_){for(var ut=0,mt=rt.length-1,bt=Math.pow,St=Interpolation.Utils.Bernstein,Mt=0;Mt<=mt;Mt++)ut+=bt(1-_,mt-Mt)*bt(_,Mt)*rt[Mt]*St(mt,Mt);return ut},CatmullRom:function(rt,_){var ut=rt.length-1,mt=ut*_,bt=Math.floor(mt),St=Interpolation.Utils.CatmullRom;return rt[0]===rt[ut]?(_<0&&(bt=Math.floor(mt=ut*(1+_))),St(rt[(bt-1+ut)%ut],rt[bt],rt[(bt+1)%ut],rt[(bt+2)%ut],mt-bt)):_<0?rt[0]-(St(rt[0],rt[0],rt[1],rt[1],-mt)-rt[0]):_>1?rt[ut]-(St(rt[ut],rt[ut],rt[ut-1],rt[ut-1],mt-ut)-rt[ut]):St(rt[bt?bt-1:0],rt[bt],rt[ut<bt+1?ut:bt+1],rt[ut<bt+2?ut:bt+2],mt-bt)},Utils:{Linear:function(rt,_,ut){return(_-rt)*ut+rt},Bernstein:function(rt,_){var ut=Interpolation.Utils.Factorial;return ut(rt)/ut(_)/ut(rt-_)},Factorial:function(){var rt=[1];return function(_){var ut=1;if(rt[_])return rt[_];for(var mt=_;mt>1;mt--)ut*=mt;return rt[_]=ut,ut}}(),CatmullRom:function(rt,_,ut,mt,bt){var St=(ut-rt)*.5,Mt=(mt-_)*.5,Bt=bt*bt,Ut=bt*Bt;return(2*_-2*ut+St+Mt)*Ut+(-3*_+3*ut-2*St-Mt)*Bt+St*bt+_}}},Sequence=function(){function rt(){}return rt.nextId=function(){return rt._nextId++},rt._nextId=0,rt}(),mainGroup=new Group,Tween$1=function(){function rt(_,ut){ut===void 0&&(ut=mainGroup),this._object=_,this._group=ut,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Easing.Linear.None,this._interpolationFunction=Interpolation.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Sequence.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return rt.prototype.getId=function(){return this._id},rt.prototype.isPlaying=function(){return this._isPlaying},rt.prototype.isPaused=function(){return this._isPaused},rt.prototype.getDuration=function(){return this._duration},rt.prototype.to=function(_,ut){if(ut===void 0&&(ut=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=_,this._propertiesAreSetUp=!1,this._duration=ut<0?0:ut,this},rt.prototype.duration=function(_){return _===void 0&&(_=1e3),this._duration=_<0?0:_,this},rt.prototype.dynamic=function(_){return _===void 0&&(_=!1),this._isDynamic=_,this},rt.prototype.start=function(_,ut){if(_===void 0&&(_=now()),ut===void 0&&(ut=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var mt in this._valuesStartRepeat)this._swapEndStartRepeatValues(mt),this._valuesStart[mt]=this._valuesStartRepeat[mt]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=_,this._startTime+=this._delayTime,!this._propertiesAreSetUp||ut){if(this._propertiesAreSetUp=!0,!this._isDynamic){var bt={};for(var St in this._valuesEnd)bt[St]=this._valuesEnd[St];this._valuesEnd=bt}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,ut)}return this},rt.prototype.startFromCurrentValues=function(_){return this.start(_,!0)},rt.prototype._setupProperties=function(_,ut,mt,bt,St){for(var Mt in mt){var Bt=_[Mt],Ut=Array.isArray(Bt),Ht=Ut?"array":typeof Bt,tr=!Ut&&Array.isArray(mt[Mt]);if(!(Ht==="undefined"||Ht==="function")){if(tr){var rr=mt[Mt];if(rr.length===0)continue;for(var sr=[Bt],ar=0,cr=rr.length;ar<cr;ar+=1){var Ar=this._handleRelativeValue(Bt,rr[ar]);if(isNaN(Ar)){tr=!1,console.warn("Found invalid interpolation list. Skipping.");break}sr.push(Ar)}tr&&(mt[Mt]=sr)}if((Ht==="object"||Ut)&&Bt&&!tr){ut[Mt]=Ut?[]:{};var _r=Bt;for(var Dr in _r)ut[Mt][Dr]=_r[Dr];bt[Mt]=Ut?[]:{};var rr=mt[Mt];if(!this._isDynamic){var $r={};for(var Dr in rr)$r[Dr]=rr[Dr];mt[Mt]=rr=$r}this._setupProperties(_r,ut[Mt],rr,bt[Mt],St)}else(typeof ut[Mt]>"u"||St)&&(ut[Mt]=Bt),Ut||(ut[Mt]*=1),tr?bt[Mt]=mt[Mt].slice().reverse():bt[Mt]=ut[Mt]||0}}},rt.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},rt.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},rt.prototype.pause=function(_){return _===void 0&&(_=now()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=_,this._group&&this._group.remove(this),this)},rt.prototype.resume=function(_){return _===void 0&&(_=now()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=_-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},rt.prototype.stopChainedTweens=function(){for(var _=0,ut=this._chainedTweens.length;_<ut;_++)this._chainedTweens[_].stop();return this},rt.prototype.group=function(_){return _===void 0&&(_=mainGroup),this._group=_,this},rt.prototype.delay=function(_){return _===void 0&&(_=0),this._delayTime=_,this},rt.prototype.repeat=function(_){return _===void 0&&(_=0),this._initialRepeat=_,this._repeat=_,this},rt.prototype.repeatDelay=function(_){return this._repeatDelayTime=_,this},rt.prototype.yoyo=function(_){return _===void 0&&(_=!1),this._yoyo=_,this},rt.prototype.easing=function(_){return _===void 0&&(_=Easing.Linear.None),this._easingFunction=_,this},rt.prototype.interpolation=function(_){return _===void 0&&(_=Interpolation.Linear),this._interpolationFunction=_,this},rt.prototype.chain=function(){for(var _=[],ut=0;ut<arguments.length;ut++)_[ut]=arguments[ut];return this._chainedTweens=_,this},rt.prototype.onStart=function(_){return this._onStartCallback=_,this},rt.prototype.onEveryStart=function(_){return this._onEveryStartCallback=_,this},rt.prototype.onUpdate=function(_){return this._onUpdateCallback=_,this},rt.prototype.onRepeat=function(_){return this._onRepeatCallback=_,this},rt.prototype.onComplete=function(_){return this._onCompleteCallback=_,this},rt.prototype.onStop=function(_){return this._onStopCallback=_,this},rt.prototype.update=function(_,ut){var mt;if(_===void 0&&(_=now()),ut===void 0&&(ut=!0),this._isPaused)return!0;var bt=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(_>bt)return!1;ut&&this.start(_,!0)}if(this._goToEnd=!1,_<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var St=_-this._startTime,Mt=this._duration+((mt=this._repeatDelayTime)!==null&&mt!==void 0?mt:this._delayTime),Bt=this._duration+this._repeat*Mt,Ut=this._calculateElapsedPortion(St,Mt,Bt),Ht=this._easingFunction(Ut),tr=this._calculateCompletionStatus(St,Mt);if(tr==="repeat"&&this._processRepetition(St,Mt),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,Ht),tr==="about-to-repeat"&&this._processRepetition(St,Mt),this._onUpdateCallback&&this._onUpdateCallback(this._object,Ut),tr==="repeat"||tr==="about-to-repeat")this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1;else if(tr==="completed"){this._isPlaying=!1,this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var rr=0,sr=this._chainedTweens.length;rr<sr;rr++)this._chainedTweens[rr].start(this._startTime+this._duration,!1)}return tr!=="completed"},rt.prototype._calculateElapsedPortion=function(_,ut,mt){if(this._duration===0||_>mt)return 1;var bt=_%ut,St=Math.min(bt/this._duration,1);return St===0&&_!==0&&_%this._duration===0?1:St},rt.prototype._calculateCompletionStatus=function(_,ut){return this._duration!==0&&_<this._duration?"playing":this._repeat<=0?"completed":_===this._duration?"about-to-repeat":"repeat"},rt.prototype._processRepetition=function(_,ut){var mt=Math.min(Math.trunc((_-this._duration)/ut)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=mt);for(var bt in this._valuesStartRepeat){var St=this._valuesEnd[bt];!this._yoyo&&typeof St=="string"&&(this._valuesStartRepeat[bt]=this._valuesStartRepeat[bt]+parseFloat(St)),this._yoyo&&this._swapEndStartRepeatValues(bt),this._valuesStart[bt]=this._valuesStartRepeat[bt]}this._yoyo&&(this._reversed=!this._reversed),this._startTime+=ut*mt},rt.prototype._updateProperties=function(_,ut,mt,bt){for(var St in mt)if(ut[St]!==void 0){var Mt=ut[St]||0,Bt=mt[St],Ut=Array.isArray(_[St]),Ht=Array.isArray(Bt),tr=!Ut&&Ht;tr?_[St]=this._interpolationFunction(Bt,bt):typeof Bt=="object"&&Bt?this._updateProperties(_[St],Mt,Bt,bt):(Bt=this._handleRelativeValue(Mt,Bt),typeof Bt=="number"&&(_[St]=Mt+(Bt-Mt)*bt))}},rt.prototype._handleRelativeValue=function(_,ut){return typeof ut!="string"?ut:ut.charAt(0)==="+"||ut.charAt(0)==="-"?_+parseFloat(ut):parseFloat(ut)},rt.prototype._swapEndStartRepeatValues=function(_){var ut=this._valuesStartRepeat[_],mt=this._valuesEnd[_];typeof mt=="string"?this._valuesStartRepeat[_]=this._valuesStartRepeat[_]+parseFloat(mt):this._valuesStartRepeat[_]=this._valuesEnd[_],this._valuesEnd[_]=ut},rt}(),VERSION="23.1.2",nextId=Sequence.nextId,TWEEN=mainGroup,getAll=TWEEN.getAll.bind(TWEEN),removeAll=TWEEN.removeAll.bind(TWEEN),add=TWEEN.add.bind(TWEEN),remove=TWEEN.remove.bind(TWEEN),update=TWEEN.update.bind(TWEEN),exports$1={Easing,Group,Interpolation,now,Sequence,nextId,Tween:Tween$1,VERSION,getAll,removeAll,add,remove,update};function ETwo(){const{nodes:rt}=useGLTF("/carCar/white_round_exhibition_gallery.glb"),{materials:_}=useGLTF("/carCar/white_round_exhibition_gallery.glb");return jsxRuntimeExports.jsx("group",{dispose:null,children:jsxRuntimeExports.jsxs("group",{scale:.01,children:[jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder__0.geometry,material:_.Cylinder__0,rotation:[-Math.PI/2,0,0],scale:[1327.45,1327.45,501.949]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder003__0.geometry,material:_.Cylinder__0,position:[0,46.149,0],rotation:[-Math.PI/2,0,0],scale:[1327.45,1327.45,501.949]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder004__0.geometry,material:_.Cylinder__0,position:[0,343.929,0],rotation:[-Math.PI/2,0,0],scale:[1940.379,1940.379,733.716]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder005__0.geometry,material:_.Cylinder__0,position:[0,463.774,0],rotation:[-Math.PI/2,0,0],scale:[2630.109,2630.109,786.067]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder006__0.geometry,material:_.Cylinder__0,position:[0,417.743,0],rotation:[-Math.PI/2,0,0],scale:[3366.385,3366.385,676.562]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Torus011__0.geometry,material:_.Cylinder__0,position:[0,929.591,0],rotation:[Math.PI/2,0,0],scale:[-1351.922,1351.922,1351.922]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder014_Material001_0.geometry,material:_["Material.001"],position:[0,444.248,0],rotation:[Math.PI/2,0,-Math.PI],scale:[-2140.547,2140.547,41.441]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder015__0.geometry,material:_.Cylinder__0,rotation:[-Math.PI/2,0,0],scale:[1327.45,1327.45,501.949]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder007_Material002_0.geometry,material:_["Material.002"],position:[0,-491.111,0],rotation:[-Math.PI/2,0,0],scale:[1664.058,1664.058,181.851]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder008_Material002_0.geometry,material:_["Material.002"],position:[0,-430.178,0],rotation:[-Math.PI/2,0,0],scale:[2429.868,2429.868,103.57]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder009_Material002_0.geometry,material:_["Material.002"],position:[0,-365.182,0],rotation:[-Math.PI/2,0,0],scale:[3246.547,3246.547,103.57]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder010_Material002_0.geometry,material:_["Material.002"],position:[0,-296.993,0],rotation:[-Math.PI/2,0,0],scale:[4105.58,4105.58,103.57]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder001__0.geometry,material:_.Cylinder__0,position:[0,-213.755,0],rotation:[-Math.PI/2,0,0],scale:[2287.581,2287.581,661.655]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder012_Material004_0.geometry,material:_["Material.004"],position:[0,-213.755,0],rotation:[-Math.PI/2,0,0],scale:[2287.581,2287.581,661.655]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder013__0.geometry,material:_.Cylinder__0,position:[0,-213.755,0],rotation:[-Math.PI/2,0,0],scale:[2287.581,2287.581,661.655]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Cylinder016_Material009_0.geometry,material:_["Material.009"],position:[0,691.037,0],rotation:[Math.PI/2,0,0],scale:[-998.133,998.133,73.472]})]})})}useGLTF.preload("/carCar/white_round_exhibition_gallery.glb");const Environment=reactExports.memo(({direction:rt=[5,5,5]})=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("directionalLight",{position:rt,intensity:.5,"shadow-mapSize":1024,castShadow:!0}),jsxRuntimeExports.jsx("directionalLight",{position:[-5,5,5],intensity:.1,"shadow-mapSize":128,castShadow:!0}),jsxRuntimeExports.jsx("directionalLight",{position:[-5,5,-5],intensity:.1,"shadow-mapSize":128,castShadow:!0}),jsxRuntimeExports.jsx("directionalLight",{position:[0,5,0],intensity:.1,"shadow-mapSize":128,castShadow:!0}),jsxRuntimeExports.jsx(Environment$1,{preset:"city"})]}));function Env(){return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("directionalLight",{color:"red",position:[0,0,5],intensity:1}),jsxRuntimeExports.jsx(ETwo,{}),jsxRuntimeExports.jsx(Environment,{})]})}useGLTF.preload("/vr_exhibition_gallery_baked.glb");function Model(){const{nodes:rt,materials:_}=useGLTF("/carCar/sport_car/seperate.glb");return jsxRuntimeExports.jsx("group",{dispose:null,children:jsxRuntimeExports.jsxs("group",{scale:.01,children:[jsxRuntimeExports.jsxs("group",{rotation:[-Math.PI/2,0,0],scale:100,children:[jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_1_Car_Paint_2_0.geometry,material:_.Car_Paint_2}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_1_Car_Paint_0.geometry,material:_.Car_Paint}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_1_Car_Paint_0002.geometry,material:_.Car_Paint}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_1_Car_Paint_0005.geometry,material:_.Car_Paint})]}),jsxRuntimeExports.jsxs("group",{rotation:[-Math.PI/2,0,0],scale:100,children:[jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Blinker_Glass_Cover_0.geometry,material:_.Blinker_Glass_Cover}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Chrome_0.geometry,material:_.Chrome}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_CorvetteWingEmblem_0.geometry,material:_.CorvetteWingEmblem}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Daylight_Cover_0.geometry,material:_.Daylight_Cover}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Exhaust_Housing_0.geometry,material:_.Exhaust_Housing}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Exhaust_0.geometry,material:_.Exhaust}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Glossy_Plastic_0.geometry,material:_.Glossy_Plastic}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Headlight_Cover_0.geometry,material:_.Headlight_Cover}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Interior_0.geometry,material:_.Interior}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Main_Headlight_Lens_0.geometry,material:_.Main_Headlight_Lens}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Mesh_0.geometry,material:_.Mesh}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Plastic_0.geometry,material:_.Plastic}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Reflectors_0.geometry,material:_.Reflectors}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Rubber_0.geometry,material:_.Rubber}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Shadow_0.geometry,material:_.Shadow}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Side_Reflectors_Cover_0.geometry,material:_.Side_Reflectors_Cover}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Spoiler_Light_Cover_0.geometry,material:_.Spoiler_Light_Cover}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Tail_Lights_Red_Cover_2_0.geometry,material:_.Tail_Lights_Red_Cover_2}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Tail_Lights_Red_Cover_0.geometry,material:_.Tail_Lights_Red_Cover}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Tail_Lights_White_Cover_0.geometry,material:_.Tail_Lights_White_Cover}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_WindowBorder_0.geometry,material:_.WindowBorder}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Windows_0.geometry,material:_.Windows}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Wipers_0.geometry,material:_.Wipers})]}),jsxRuntimeExports.jsxs("group",{rotation:[-Math.PI/2,0,0],scale:100,children:[jsxRuntimeExports.jsx("mesh",{geometry:rt.License_Plate_License_Plate_0.geometry,material:_.License_Plate}),jsxRuntimeExports.jsx("mesh",{geometry:rt.License_Plate_LicensePlate_Frame_0.geometry,material:_.LicensePlate_Frame})]}),jsxRuntimeExports.jsxs("group",{position:[160.137,76.367,268.656],rotation:[2.199,Math.PI/2,0],scale:[100,100,101.808],children:[jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_FL_CorvetteWingEmblem_0.geometry,material:_.CorvetteWingEmblem}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_FL_Lug_Nuts_0.geometry,material:_.Lug_Nuts}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_FL_Rim_0.geometry,material:_.material}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Brake_Disc_FL_Brake_Disc_0.geometry,material:_.Brake_Disc,rotation:[0,0,2.513],scale:.402}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Tire_FL_TireMaterial_0.geometry,material:_.TireMaterial,rotation:[Math.PI/2,.942,Math.PI/2]})]}),jsxRuntimeExports.jsxs("group",{position:[-159.931,76.367,268.656],rotation:[-2.199,-Math.PI/2,0],scale:[100,100,101.808],children:[jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_FR_CorvetteWingEmblem_0.geometry,material:_.CorvetteWingEmblem}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_FR_Lug_Nuts_0.geometry,material:_.Lug_Nuts}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_FR_Rim_0.geometry,material:_.material}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Brake_Disc_FR_Brake_Disc_0.geometry,material:_.Brake_Disc,rotation:[0,0,2.513],scale:.402}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Tire_FR_TireMaterial_0.geometry,material:_.TireMaterial,rotation:[Math.PI/2,.942,Math.PI/2]})]}),jsxRuntimeExports.jsxs("group",{position:[160.137,76.367,-270.477],rotation:[2.199,Math.PI/2,0],scale:[100,100,101.808],children:[jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_RL_CorvetteWingEmblem_0.geometry,material:_.CorvetteWingEmblem}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_RL_Lug_Nuts_0.geometry,material:_.Lug_Nuts}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_RL_Rim_0.geometry,material:_.material}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Brake_Disc_RL_Brake_Disc_0.geometry,material:_.Brake_Disc,rotation:[0,0,2.513],scale:.402}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Tire_RL_TireMaterial_0.geometry,material:_.TireMaterial,rotation:[Math.PI/2,.942,Math.PI/2]})]}),jsxRuntimeExports.jsxs("group",{position:[-159.931,76.367,-270.477],rotation:[-2.199,-Math.PI/2,0],scale:[100,100,101.808],children:[jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_RR_CorvetteWingEmblem_0.geometry,material:_.CorvetteWingEmblem}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_RR_Lug_Nuts_0.geometry,material:_.Lug_Nuts}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Rim_RR_Rim_0.geometry,material:_.material}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Brake_Disc_RR_Brake_Disc_0.geometry,material:_.Brake_Disc,rotation:[0,0,2.513],scale:.402}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Tire_RR_TireMaterial_0.geometry,material:_.TireMaterial,rotation:[Math.PI/2,.942,Math.PI/2]})]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Brake_Caliper_FL_Brake_Caliper_0.geometry,material:_.Brake_Caliper,position:[-159.931,76.367,270.737],rotation:[-Math.PI/2,-Math.PI/2,0],scale:[106.859,106.859,108.79]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Brake_Caliper_FR_Brake_Caliper_0.geometry,material:_.Brake_Caliper,position:[-159.931,76.367,270.737],rotation:[-Math.PI/2,-1.571,0],scale:[106.859,106.859,108.79]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Brake_Caliper_RL_Brake_Caliper_0.geometry,material:_.Brake_Caliper,position:[-159.931,76.367,270.737],rotation:[-Math.PI/2,-1.571,0],scale:[106.859,106.859,108.79]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.Brake_Caliper_RR_Brake_Caliper_0.geometry,material:_.Brake_Caliper,position:[-159.931,76.367,270.737],rotation:[-Math.PI/2,-1.571,0],scale:[106.859,106.859,108.79]}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_3_Undercarriage_0.geometry,material:_.Undercarriage,rotation:[-Math.PI/2,0,0],scale:100})]})})}useGLTF.preload("/carCar/sport_car/seperate.glb");function CarLdoor(){const{nodes:rt,materials:_}=useGLTF("/carCar/sport_car/seperate.glb");return jsxRuntimeExports.jsx("group",{dispose:null,children:jsxRuntimeExports.jsxs("group",{scale:.01,children:[jsxRuntimeExports.jsxs("group",{rotation:[-Math.PI/2,0,0],scale:100,children:[jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_1_Car_Paint_0003_3.geometry,material:_.Windows}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_1_Car_Paint_0003_1.geometry,material:_.Car_Paint}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_1_Car_Paint_0003_4.geometry,material:_.Interior})]}),jsxRuntimeExports.jsx("group",{rotation:[-Math.PI/2,0,0],scale:100,children:jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_1_Car_Paint_0003_2.geometry,material:_.Side_Mirrors})})]})})}useGLTF.preload("/carCar/sport_car/seperate.glb");function CarRdoor(){const{nodes:rt,materials:_}=useGLTF("/carCar/sport_car/seperate.glb");return jsxRuntimeExports.jsx("group",{dispose:null,children:jsxRuntimeExports.jsxs("group",{scale:.01,children:[jsxRuntimeExports.jsxs("group",{rotation:[-Math.PI/2,0,0],scale:100,children:[jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Interior_0002_4.geometry,material:_.Windows}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Interior_0002_2.geometry,material:_.Car_Paint}),jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Interior_0002_1.geometry,material:_.Interior})]}),jsxRuntimeExports.jsx("group",{rotation:[-Math.PI/2,0,0],scale:100,children:jsxRuntimeExports.jsx("mesh",{geometry:rt.CarBody_2_Interior_0002_3.geometry,material:_.Side_Mirrors})})]})})}useGLTF.preload("/carCar/sport_car/seperate.glb");const Car=rt=>{const[_,ut]=reactExports.useState(!1),[mt,bt]=reactExports.useState(!1),St=1.6,Mt=0,Bt=-.8,Ut=1.6,Ht=0,tr=.8,{rotX:rr,rotY:sr,rotZ:ar}=useSpring({rotX:0,rotY:_?Math.PI/3:0,rotZ:0,config:{mass:1,tension:210,friction:20}}),{rotX:cr,rotY:Ar,rotZ:_r}=useSpring({rotX:0,rotY:mt?-Math.PI/3:0,rotZ:0,config:{mass:1,tension:210,friction:20}}),{onLight:Dr}=rt,$r=Dr?1e3:0,{onOneClick:Br}=rt;function Jr(){Br==null||Br()}return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(animated.group,{position:[0-St,0-Mt,0-Bt],"rotation-x":rr,"rotation-y":sr,"rotation-z":ar,onClick:()=>{ut(!_),Jr()},children:jsxRuntimeExports.jsx("group",{position:[0+St,0+Mt,0+Bt],children:jsxRuntimeExports.jsx(CarRdoor,{})})}),jsxRuntimeExports.jsx(animated.group,{position:[0+Ut,0+Ht,0+tr],"rotation-x":cr,"rotation-y":Ar,"rotation-z":_r,onClick:()=>{bt(!mt),Jr()},children:jsxRuntimeExports.jsx("group",{position:[0-Ut,0-Ht,0-tr],children:jsxRuntimeExports.jsx(CarLdoor,{})})}),jsxRuntimeExports.jsx(animated.group,{children:jsxRuntimeExports.jsx(Model,{})}),jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsx("pointLight",{color:"blue",position:[0,1.7,0],intensity:$r}),jsxRuntimeExports.jsx("pointLight",{color:"blue",position:[0+.8,1.7,0+.5],intensity:$r}),jsxRuntimeExports.jsx("pointLight",{color:"blue",position:[0-.8,1,0+.4],intensity:$r})]})]})};globals.assign({frameLoop:"always"});function Tween(){return useFrame(()=>{exports$1.update()}),null}const CarCar=()=>{const[rt,_]=reactExports.useState(!1),ut=reactExports.useRef(!0),mt=reactExports.useRef(),bt=()=>{new exports$1.Tween(ut.current.target).to({x:0,y:3,z:8},500).easing(exports$1.Easing.Cubic.Out).start(),new exports$1.Tween(mt.current.position).to({x:.75,y:1.8,z:-.8},500).easing(exports$1.Easing.Cubic.Out).start(),new exports$1.Tween(mt.current.fov).to({fov:80},500).easing(exports$1.Easing.Cubic.Out).start()},St=()=>{new exports$1.Tween(ut.current.target).to({x:0,y:1,z:0},500).easing(exports$1.Easing.Cubic.Out).start(),new exports$1.Tween(mt.current.position).to({x:5,y:5,z:8},500).easing(exports$1.Easing.Cubic.Out).start(),new exports$1.Tween(mt.current.fov).to({fov:60},500).easing(exports$1.Easing.Cubic.Out).start()},[Mt,Bt]=reactExports.useState(!1),Ut=()=>{_(!rt),rt?St():bt(),console.log("target",ut.current.target,"camera",mt.current.position,"active",rt),Bt(!Mt)},Ht=rt?"Look outCar":"Look inCar";return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"layout",onClick:()=>Ut(),children:jsxRuntimeExports.jsx("div",{children:Ht})}),jsxRuntimeExports.jsxs(Canvas$1,{shadows:!0,children:[jsxRuntimeExports.jsx("group",{position:[0,5,0],children:jsxRuntimeExports.jsx(Env,{})}),jsxRuntimeExports.jsx(PerspectiveCamera,{ref:mt,makeDefault:!0,position:[5,3,8],fov:60}),jsxRuntimeExports.jsx(OrbitControls,{ref:ut,target:[0,1,0],maxDistance:15,minDistance:0,maxPolarAngle:rt?Math.PI:Math.PI/3,enableDamping:!0,dampingFactor:.07,zoomSpeed:3,autoRotate:!rt,autoRotateSpeed:-2}),jsxRuntimeExports.jsx(Car,{onLight:Mt}),jsxRuntimeExports.jsx(Tween,{})]})]})},Scene=()=>{const{nodes:rt}=useGLTF("/aiGallery/model/aiGalleryExtend.glb");reactExports.useEffect(()=>{console.log(rt.Wall.children)},[]);const _=["/aiGallery/image/20240503-024740.jpg","/aiGallery/image/20240503-024805.jpg","/aiGallery/image/20240503-024817.jpg","/aiGallery/image/20240503-024829.jpg","/aiGallery/image/20240503-024857.jpg","/aiGallery/image/20240503-024907.jpg","/aiGallery/image/20240503-024925.jpg","/aiGallery/image/20240503-024938.jpg","/aiGallery/image/20240503-024952.jpg","/aiGallery/image/20240503-025135.jpg","/aiGallery/image/20240503-025010.jpg","/aiGallery/image/20240503-025027.jpg"],ut=["Emerald Genesis","Luminous Synthesis","Scholarly Sentinel","Serene Gaze","Buddy Beams","Divine Origami Grace","Forest Essence","Serenity in Bloom","Vortex of Style","Serenity in Bloom","Avian Elegance","Autumnal Enlightenment"];return jsxRuntimeExports.jsxs("group",{dispose:null,children:[jsxRuntimeExports.jsx(Clone,{object:rt.Cube007}),jsxRuntimeExports.jsx(Clone,{object:rt.Cube008}),jsxRuntimeExports.jsx(Clone,{object:rt.Cube009}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube010,imgUrl:null,description:"",intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube002,imgUrl:_[0],description:ut[0],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube011,imgUrl:_[1],description:ut[1],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube012,imgUrl:_[2],description:ut[2],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube006,imgUrl:_[3],description:ut[3],intensity:0,rotation:0}),jsxRuntimeExports.jsx(Clone,{object:rt.Cube005}),jsxRuntimeExports.jsx(Clone,{object:rt.Cube013}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube014,imgUrl:_[5],description:ut[5],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube015,imgUrl:_[6],description:ut[6],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube016,imgUrl:_[7],description:ut[7],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube001,imgUrl:_[4],description:ut[4],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube017,imgUrl:_[8],description:ut[8],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube018,imgUrl:_[9],description:ut[9],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube019,imgUrl:_[0],description:ut[0],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube020,imgUrl:_[11],description:ut[11],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube021,imgUrl:_[2],description:ut[2],intensity:0,rotation:0}),jsxRuntimeExports.jsx(ImageFrame,{object:rt.Cube022,imgUrl:_[3],description:ut[3],intensity:0,rotation:0}),jsxRuntimeExports.jsx(Clone,{object:rt.Wall}),jsxRuntimeExports.jsx(Image$1,{url:_[0],position:[-4.98,1.14,1.56],rotation:[0,Math.PI/2,0],scale:[6.8,2.08],castShadow:!0}),jsxRuntimeExports.jsx(Text,{scale:.05,position:[-4+.5,2,-2],rotation:[0,0,0],children:"二楼通道"}),jsxRuntimeExports.jsx(Text,{scale:.05,position:[-4+.5,1.9,-2],rotation:[0,0,0],children:"暂未开放"}),jsxRuntimeExports.jsx(Clone,{object:rt.showWall}),jsxRuntimeExports.jsx(Clone,{object:rt.ceiling_})]})};useGLTF.preload("/aiGallery/model/aiGalleryExtend.glb");const ImageFrame=({object:rt,imgUrl:_,description:ut,intensity:mt=300,rotation:bt=1,...St})=>jsxRuntimeExports.jsx(Clone,{object:rt,...St,children:_&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Image$1,{url:_,position:[0,0,.08]}),jsxRuntimeExports.jsx(Text,{scale:.1,position:[0,0-.68,.02],children:ut})]})});/**
 * postprocessing v6.35.4 build Fri Apr 26 2024
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2024 Raoul van Rüschen
 * @license Zlib
 */var MILLISECONDS_TO_SECONDS=1/1e3,SECONDS_TO_MILLISECONDS=1e3,Timer=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(rt){typeof document<"u"&&document.hidden!==void 0&&(rt?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=rt)}get delta(){return this._delta*MILLISECONDS_TO_SECONDS}get fixedDelta(){return this._fixedDelta*MILLISECONDS_TO_SECONDS}set fixedDelta(rt){this._fixedDelta=rt*SECONDS_TO_MILLISECONDS}get elapsed(){return this._elapsed*MILLISECONDS_TO_SECONDS}update(rt){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(rt!==void 0?rt:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(rt){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},dummyCamera=new Camera,geometry=null;function getFullscreenTriangle(){if(geometry===null){const rt=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),_=new Float32Array([0,0,2,0,0,2]);geometry=new BufferGeometry,geometry.setAttribute!==void 0?(geometry.setAttribute("position",new BufferAttribute(rt,3)),geometry.setAttribute("uv",new BufferAttribute(_,2))):(geometry.addAttribute("position",new BufferAttribute(rt,3)),geometry.addAttribute("uv",new BufferAttribute(_,2)))}return geometry}var Pass=class WD{constructor(_="Pass",ut=new Scene$3,mt=dummyCamera){this.name=_,this.renderer=null,this.scene=ut,this.camera=mt,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(_){if(this.rtt===_){const ut=this.fullscreenMaterial;ut!==null&&(ut.needsUpdate=!0),this.rtt=!_}}set mainScene(_){}set mainCamera(_){}setRenderer(_){this.renderer=_}isEnabled(){return this.enabled}setEnabled(_){this.enabled=_}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(_){let ut=this.screen;ut!==null?ut.material=_:(ut=new Mesh(getFullscreenTriangle(),_),ut.frustumCulled=!1,this.scene===null&&(this.scene=new Scene$3),this.scene.add(ut),this.screen=ut)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(_){this.fullscreenMaterial=_}getDepthTexture(){return null}setDepthTexture(_,ut=BasicDepthPacking){}render(_,ut,mt,bt,St){throw new Error("Render method not implemented!")}setSize(_,ut){}initialize(_,ut,mt){}dispose(){for(const _ of Object.keys(this)){const ut=this[_];(ut instanceof WebGLRenderTarget||ut instanceof Material||ut instanceof Texture||ut instanceof WD)&&this[_].dispose()}}},ClearMaskPass=class extends Pass{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(rt,_,ut,mt,bt){const St=rt.state.buffers.stencil;St.setLocked(!1),St.setTest(!1)}},revision=Number(REVISION.replace(/\D+/g,""));function updateFragmentShader(rt){return revision<154?rt.replace("colorspace_fragment","encodings_fragment"):rt}var copy_default=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,common_default="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",CopyMaterial=class extends ShaderMaterial{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Uniform(null),opacity:new Uniform(1)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:copy_default,vertexShader:common_default}),this.fragmentShader=updateFragmentShader(this.fragmentShader)}set inputBuffer(rt){this.uniforms.inputBuffer.value=rt}setInputBuffer(rt){this.uniforms.inputBuffer.value=rt}getOpacity(rt){return this.uniforms.opacity.value}setOpacity(rt){this.uniforms.opacity.value=rt}},CopyPass=class extends Pass{constructor(rt,_=!0){super("CopyPass"),this.fullscreenMaterial=new CopyMaterial,this.needsSwap=!1,this.renderTarget=rt,rt===void 0&&(this.renderTarget=new WebGLRenderTarget(1,1,{minFilter:LinearFilter,magFilter:LinearFilter,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=_}get resize(){return this.autoResize}set resize(rt){this.autoResize=rt}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(rt){this.autoResize=rt}render(rt,_,ut,mt,bt){this.fullscreenMaterial.inputBuffer=_.texture,rt.setRenderTarget(this.renderToScreen?null:this.renderTarget),rt.render(this.scene,this.camera)}setSize(rt,_){this.autoResize&&this.renderTarget.setSize(rt,_)}initialize(rt,_,ut){ut!==void 0&&(this.renderTarget.texture.type=ut,ut!==UnsignedByteType?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":rt!==null&&rt.outputColorSpace===SRGBColorSpace&&(this.renderTarget.texture.colorSpace=SRGBColorSpace))}},color=new Color$1,ClearPass=class extends Pass{constructor(rt=!0,_=!0,ut=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=rt,this.depth=_,this.stencil=ut,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(rt,_,ut){this.color=rt,this.depth=_,this.stencil=ut}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(rt){this.overrideClearColor=rt}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(rt){this.overrideClearAlpha=rt}render(rt,_,ut,mt,bt){const St=this.overrideClearColor,Mt=this.overrideClearAlpha,Bt=rt.getClearAlpha(),Ut=St!==null,Ht=Mt>=0;Ut?(rt.getClearColor(color),rt.setClearColor(St,Ht?Mt:Bt)):Ht&&rt.setClearAlpha(Mt),rt.setRenderTarget(this.renderToScreen?null:_),rt.clear(this.color,this.depth,this.stencil),Ut?rt.setClearColor(color,Bt):Ht&&rt.setClearAlpha(Bt)}},MaskPass=class extends Pass{constructor(rt,_){super("MaskPass",rt,_),this.needsSwap=!1,this.clearPass=new ClearPass(!1,!1,!0),this.inverse=!1}set mainScene(rt){this.scene=rt}set mainCamera(rt){this.camera=rt}get inverted(){return this.inverse}set inverted(rt){this.inverse=rt}get clear(){return this.clearPass.enabled}set clear(rt){this.clearPass.enabled=rt}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(rt){this.inverted=rt}render(rt,_,ut,mt,bt){const St=rt.getContext(),Mt=rt.state.buffers,Bt=this.scene,Ut=this.camera,Ht=this.clearPass,tr=this.inverted?0:1,rr=1-tr;Mt.color.setMask(!1),Mt.depth.setMask(!1),Mt.color.setLocked(!0),Mt.depth.setLocked(!0),Mt.stencil.setTest(!0),Mt.stencil.setOp(St.REPLACE,St.REPLACE,St.REPLACE),Mt.stencil.setFunc(St.ALWAYS,tr,4294967295),Mt.stencil.setClear(rr),Mt.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?Ht.render(rt,null):(Ht.render(rt,_),Ht.render(rt,ut))),this.renderToScreen?(rt.setRenderTarget(null),rt.render(Bt,Ut)):(rt.setRenderTarget(_),rt.render(Bt,Ut),rt.setRenderTarget(ut),rt.render(Bt,Ut)),Mt.color.setLocked(!1),Mt.depth.setLocked(!1),Mt.stencil.setLocked(!1),Mt.stencil.setFunc(St.EQUAL,1,4294967295),Mt.stencil.setOp(St.KEEP,St.KEEP,St.KEEP),Mt.stencil.setLocked(!0)}},EffectComposer$1=class{constructor(_=null,{depthBuffer:ut=!0,stencilBuffer:mt=!1,multisampling:bt=0,frameBufferType:St}={}){this.renderer=null,this.inputBuffer=this.createBuffer(ut,mt,St,bt),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new CopyPass,this.depthTexture=null,this.passes=[],this.timer=new Timer,this.autoRenderToScreen=!0,this.setRenderer(_)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(_){const ut=this.inputBuffer,mt=this.multisampling;mt>0&&_>0?(this.inputBuffer.samples=_,this.outputBuffer.samples=_,this.inputBuffer.dispose(),this.outputBuffer.dispose()):mt!==_&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(ut.depthBuffer,ut.stencilBuffer,ut.texture.type,_),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(_){if(this.renderer=_,_!==null){const ut=_.getSize(new Vector2),mt=_.getContext().getContextAttributes().alpha,bt=this.inputBuffer.texture.type;bt===UnsignedByteType&&_.outputColorSpace===SRGBColorSpace&&(this.inputBuffer.texture.colorSpace=SRGBColorSpace,this.outputBuffer.texture.colorSpace=SRGBColorSpace,this.inputBuffer.dispose(),this.outputBuffer.dispose()),_.autoClear=!1,this.setSize(ut.width,ut.height);for(const St of this.passes)St.initialize(_,mt,bt)}}replaceRenderer(_,ut=!0){const mt=this.renderer,bt=mt.domElement.parentNode;return this.setRenderer(_),ut&&bt!==null&&(bt.removeChild(mt.domElement),bt.appendChild(_.domElement)),mt}createDepthTexture(){const _=this.depthTexture=new DepthTexture;return this.inputBuffer.depthTexture=_,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(_.format=DepthStencilFormat,_.type=UnsignedInt248Type):_.type=UnsignedIntType,_}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const _ of this.passes)_.setDepthTexture(null)}}createBuffer(_,ut,mt,bt){const St=this.renderer,Mt=St===null?new Vector2:St.getDrawingBufferSize(new Vector2),Bt={minFilter:LinearFilter,magFilter:LinearFilter,stencilBuffer:ut,depthBuffer:_,type:mt},Ut=new WebGLRenderTarget(Mt.width,Mt.height,Bt);return bt>0&&(Ut.ignoreDepthForMultisampleCopy=!1,Ut.samples=bt),mt===UnsignedByteType&&St!==null&&St.outputColorSpace===SRGBColorSpace&&(Ut.texture.colorSpace=SRGBColorSpace),Ut.texture.name="EffectComposer.Buffer",Ut.texture.generateMipmaps=!1,Ut}setMainScene(_){for(const ut of this.passes)ut.mainScene=_}setMainCamera(_){for(const ut of this.passes)ut.mainCamera=_}addPass(_,ut){const mt=this.passes,bt=this.renderer,St=bt.getDrawingBufferSize(new Vector2),Mt=bt.getContext().getContextAttributes().alpha,Bt=this.inputBuffer.texture.type;if(_.setRenderer(bt),_.setSize(St.width,St.height),_.initialize(bt,Mt,Bt),this.autoRenderToScreen&&(mt.length>0&&(mt[mt.length-1].renderToScreen=!1),_.renderToScreen&&(this.autoRenderToScreen=!1)),ut!==void 0?mt.splice(ut,0,_):mt.push(_),this.autoRenderToScreen&&(mt[mt.length-1].renderToScreen=!0),_.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const Ut=this.createDepthTexture();for(_ of mt)_.setDepthTexture(Ut)}else _.setDepthTexture(this.depthTexture)}removePass(_){const ut=this.passes,mt=ut.indexOf(_);if(mt!==-1&&ut.splice(mt,1).length>0){if(this.depthTexture!==null){const Mt=(Ut,Ht)=>Ut||Ht.needsDepthTexture;ut.reduce(Mt,!1)||(_.getDepthTexture()===this.depthTexture&&_.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&mt===ut.length&&(_.renderToScreen=!1,ut.length>0&&(ut[ut.length-1].renderToScreen=!0))}}removeAllPasses(){const _=this.passes;this.deleteDepthTexture(),_.length>0&&(this.autoRenderToScreen&&(_[_.length-1].renderToScreen=!1),this.passes=[])}render(_){const ut=this.renderer,mt=this.copyPass;let bt=this.inputBuffer,St=this.outputBuffer,Mt=!1,Bt,Ut,Ht;_===void 0&&(this.timer.update(),_=this.timer.getDelta());for(const tr of this.passes)tr.enabled&&(tr.render(ut,bt,St,_,Mt),tr.needsSwap&&(Mt&&(mt.renderToScreen=tr.renderToScreen,Bt=ut.getContext(),Ut=ut.state.buffers.stencil,Ut.setFunc(Bt.NOTEQUAL,1,4294967295),mt.render(ut,bt,St,_,Mt),Ut.setFunc(Bt.EQUAL,1,4294967295)),Ht=bt,bt=St,St=Ht),tr instanceof MaskPass?Mt=!0:tr instanceof ClearMaskPass&&(Mt=!1))}setSize(_,ut,mt){const bt=this.renderer,St=bt.getSize(new Vector2);(_===void 0||ut===void 0)&&(_=St.width,ut=St.height),(St.width!==_||St.height!==ut)&&bt.setSize(_,ut,mt);const Mt=bt.getDrawingBufferSize(new Vector2);this.inputBuffer.setSize(Mt.width,Mt.height),this.outputBuffer.setSize(Mt.width,Mt.height);for(const Bt of this.passes)Bt.setSize(Mt.width,Mt.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const _ of this.passes)_.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},EffectAttribute={NONE:0,DEPTH:1,CONVOLUTION:2},EffectShaderSection={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},EffectShaderData=class{constructor(){this.shaderParts=new Map([[EffectShaderSection.FRAGMENT_HEAD,null],[EffectShaderSection.FRAGMENT_MAIN_UV,null],[EffectShaderSection.FRAGMENT_MAIN_IMAGE,null],[EffectShaderSection.VERTEX_HEAD,null],[EffectShaderSection.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=EffectAttribute.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=LinearSRGBColorSpace}},workaroundEnabled=!1,OverrideMaterialManager=class{constructor(rt=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(rt),this.meshCount=0,this.replaceMaterial=_=>{if(_.isMesh){let ut;if(_.material.flatShading)switch(_.material.side){case DoubleSide:ut=this.materialsFlatShadedDoubleSide;break;case BackSide:ut=this.materialsFlatShadedBackSide;break;default:ut=this.materialsFlatShaded;break}else switch(_.material.side){case DoubleSide:ut=this.materialsDoubleSide;break;case BackSide:ut=this.materialsBackSide;break;default:ut=this.materials;break}this.originalMaterials.set(_,_.material),_.isSkinnedMesh?_.material=ut[2]:_.isInstancedMesh?_.material=ut[1]:_.material=ut[0],++this.meshCount}}}cloneMaterial(rt){if(!(rt instanceof ShaderMaterial))return rt.clone();const _=rt.uniforms,ut=new Map;for(const bt in _){const St=_[bt].value;St.isRenderTargetTexture&&(_[bt].value=null,ut.set(bt,St))}const mt=rt.clone();for(const bt of ut)_[bt[0]].value=bt[1],mt.uniforms[bt[0]].value=bt[1];return mt}setMaterial(rt){if(this.disposeMaterials(),this.material=rt,rt!==null){const _=this.materials=[this.cloneMaterial(rt),this.cloneMaterial(rt),this.cloneMaterial(rt)];for(const ut of _)ut.uniforms=Object.assign({},rt.uniforms),ut.side=FrontSide;_[2].skinning=!0,this.materialsBackSide=_.map(ut=>{const mt=this.cloneMaterial(ut);return mt.uniforms=Object.assign({},rt.uniforms),mt.side=BackSide,mt}),this.materialsDoubleSide=_.map(ut=>{const mt=this.cloneMaterial(ut);return mt.uniforms=Object.assign({},rt.uniforms),mt.side=DoubleSide,mt}),this.materialsFlatShaded=_.map(ut=>{const mt=this.cloneMaterial(ut);return mt.uniforms=Object.assign({},rt.uniforms),mt.flatShading=!0,mt}),this.materialsFlatShadedBackSide=_.map(ut=>{const mt=this.cloneMaterial(ut);return mt.uniforms=Object.assign({},rt.uniforms),mt.flatShading=!0,mt.side=BackSide,mt}),this.materialsFlatShadedDoubleSide=_.map(ut=>{const mt=this.cloneMaterial(ut);return mt.uniforms=Object.assign({},rt.uniforms),mt.flatShading=!0,mt.side=DoubleSide,mt})}}render(rt,_,ut){const mt=rt.shadowMap.enabled;if(rt.shadowMap.enabled=!1,workaroundEnabled){const bt=this.originalMaterials;this.meshCount=0,_.traverse(this.replaceMaterial),rt.render(_,ut);for(const St of bt)St[0].material=St[1];this.meshCount!==bt.size&&bt.clear()}else{const bt=_.overrideMaterial;_.overrideMaterial=this.material,rt.render(_,ut),_.overrideMaterial=bt}rt.shadowMap.enabled=mt}disposeMaterials(){if(this.material!==null){const rt=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const _ of rt)_.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return workaroundEnabled}static set workaroundEnabled(rt){workaroundEnabled=rt}},AUTO_SIZE=-1,Resolution=class extends EventDispatcher{constructor(rt,_=AUTO_SIZE,ut=AUTO_SIZE,mt=1){super(),this.resizable=rt,this.baseSize=new Vector2(1,1),this.preferredSize=new Vector2(_,ut),this.target=this.preferredSize,this.s=mt,this.effectiveSize=new Vector2,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const rt=this.baseSize,_=this.preferredSize,ut=this.effectiveSize,mt=this.scale;_.width!==AUTO_SIZE?ut.width=_.width:_.height!==AUTO_SIZE?ut.width=Math.round(_.height*(rt.width/Math.max(rt.height,1))):ut.width=Math.round(rt.width*mt),_.height!==AUTO_SIZE?ut.height=_.height:_.width!==AUTO_SIZE?ut.height=Math.round(_.width/Math.max(rt.width/Math.max(rt.height,1),1)):ut.height=Math.round(rt.height*mt)}get width(){return this.effectiveSize.width}set width(rt){this.preferredWidth=rt}get height(){return this.effectiveSize.height}set height(rt){this.preferredHeight=rt}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(rt){this.s!==rt&&(this.s=rt,this.preferredSize.setScalar(AUTO_SIZE),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(rt){this.scale=rt}get baseWidth(){return this.baseSize.width}set baseWidth(rt){this.baseSize.width!==rt&&(this.baseSize.width=rt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(rt){this.baseWidth=rt}get baseHeight(){return this.baseSize.height}set baseHeight(rt){this.baseSize.height!==rt&&(this.baseSize.height=rt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(rt){this.baseHeight=rt}setBaseSize(rt,_){(this.baseSize.width!==rt||this.baseSize.height!==_)&&(this.baseSize.set(rt,_),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(rt){this.preferredSize.width!==rt&&(this.preferredSize.width=rt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(rt){this.preferredWidth=rt}get preferredHeight(){return this.preferredSize.height}set preferredHeight(rt){this.preferredSize.height!==rt&&(this.preferredSize.height=rt,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(rt){this.preferredHeight=rt}setPreferredSize(rt,_){(this.preferredSize.width!==rt||this.preferredSize.height!==_)&&(this.preferredSize.set(rt,_),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(rt){this.s=rt.scale,this.baseSize.set(rt.baseWidth,rt.baseHeight),this.preferredSize.set(rt.preferredWidth,rt.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return AUTO_SIZE}},BlendFunction={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},add_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",alpha_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",average_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",color_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",color_burn_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",color_dodge_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",darken_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",difference_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",divide_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",exclusion_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",hard_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",hard_mix_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",hue_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",invert_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",invert_rgb_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",lighten_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",linear_burn_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",linear_dodge_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",linear_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",luminosity_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",multiply_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",negation_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",normal_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",overlay_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",pin_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",reflect_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",saturation_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",screen_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",soft_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",src_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",subtract_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",vivid_light_default="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",blendFunctions=new Map([[BlendFunction.ADD,add_default],[BlendFunction.ALPHA,alpha_default],[BlendFunction.AVERAGE,average_default],[BlendFunction.COLOR,color_default],[BlendFunction.COLOR_BURN,color_burn_default],[BlendFunction.COLOR_DODGE,color_dodge_default],[BlendFunction.DARKEN,darken_default],[BlendFunction.DIFFERENCE,difference_default],[BlendFunction.DIVIDE,divide_default],[BlendFunction.DST,null],[BlendFunction.EXCLUSION,exclusion_default],[BlendFunction.HARD_LIGHT,hard_light_default],[BlendFunction.HARD_MIX,hard_mix_default],[BlendFunction.HUE,hue_default],[BlendFunction.INVERT,invert_default],[BlendFunction.INVERT_RGB,invert_rgb_default],[BlendFunction.LIGHTEN,lighten_default],[BlendFunction.LINEAR_BURN,linear_burn_default],[BlendFunction.LINEAR_DODGE,linear_dodge_default],[BlendFunction.LINEAR_LIGHT,linear_light_default],[BlendFunction.LUMINOSITY,luminosity_default],[BlendFunction.MULTIPLY,multiply_default],[BlendFunction.NEGATION,negation_default],[BlendFunction.NORMAL,normal_default],[BlendFunction.OVERLAY,overlay_default],[BlendFunction.PIN_LIGHT,pin_light_default],[BlendFunction.REFLECT,reflect_default],[BlendFunction.SATURATION,saturation_default],[BlendFunction.SCREEN,screen_default],[BlendFunction.SOFT_LIGHT,soft_light_default],[BlendFunction.SRC,src_default],[BlendFunction.SUBTRACT,subtract_default],[BlendFunction.VIVID_LIGHT,vivid_light_default]]),BlendMode=class extends EventDispatcher{constructor(rt,_=1){super(),this._blendFunction=rt,this.opacity=new Uniform(_)}getOpacity(){return this.opacity.value}setOpacity(rt){this.opacity.value=rt}get blendFunction(){return this._blendFunction}set blendFunction(rt){this._blendFunction=rt,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(rt){this.blendFunction=rt}getShaderCode(){return blendFunctions.get(this.blendFunction)}},KernelSize={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},convolution_kawase_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,convolution_kawase_default2="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",kernelPresets=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],KawaseBlurMaterial=class extends ShaderMaterial{constructor(rt=new Vector4){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Uniform(null),texelSize:new Uniform(new Vector4),scale:new Uniform(1),kernel:new Uniform(0)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_kawase_default,vertexShader:convolution_kawase_default2}),this.fragmentShader=updateFragmentShader(this.fragmentShader),this.setTexelSize(rt.x,rt.y),this.kernelSize=KernelSize.MEDIUM}set inputBuffer(rt){this.uniforms.inputBuffer.value=rt}setInputBuffer(rt){this.inputBuffer=rt}get kernelSequence(){return kernelPresets[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(rt){this.uniforms.scale.value=rt}getScale(){return this.uniforms.scale.value}setScale(rt){this.uniforms.scale.value=rt}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(rt){this.uniforms.kernel.value=rt}setKernel(rt){this.kernel=rt}setTexelSize(rt,_){this.uniforms.texelSize.value.set(rt,_,rt*.5,_*.5)}setSize(rt,_){const ut=1/rt,mt=1/_;this.uniforms.texelSize.value.set(ut,mt,ut*.5,mt*.5)}},KawaseBlurPass=class extends Pass{constructor({kernelSize:rt=KernelSize.MEDIUM,resolutionScale:_=.5,width:ut=Resolution.AUTO_SIZE,height:mt=Resolution.AUTO_SIZE,resolutionX:bt=ut,resolutionY:St=mt}={}){super("KawaseBlurPass"),this.renderTargetA=new WebGLRenderTarget(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const Mt=this.resolution=new Resolution(this,bt,St,_);Mt.addEventListener("change",Bt=>this.setSize(Mt.baseWidth,Mt.baseHeight)),this._blurMaterial=new KawaseBlurMaterial,this._blurMaterial.kernelSize=rt,this.copyMaterial=new CopyMaterial}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(rt){this._blurMaterial=rt}get dithering(){return this.copyMaterial.dithering}set dithering(rt){this.copyMaterial.dithering=rt}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(rt){this.blurMaterial.kernelSize=rt}get width(){return this.resolution.width}set width(rt){this.resolution.preferredWidth=rt}get height(){return this.resolution.height}set height(rt){this.resolution.preferredHeight=rt}get scale(){return this.blurMaterial.scale}set scale(rt){this.blurMaterial.scale=rt}getScale(){return this.blurMaterial.scale}setScale(rt){this.blurMaterial.scale=rt}getKernelSize(){return this.kernelSize}setKernelSize(rt){this.kernelSize=rt}getResolutionScale(){return this.resolution.scale}setResolutionScale(rt){this.resolution.scale=rt}render(rt,_,ut,mt,bt){const St=this.scene,Mt=this.camera,Bt=this.renderTargetA,Ut=this.renderTargetB,Ht=this.blurMaterial,tr=Ht.kernelSequence;let rr=_;this.fullscreenMaterial=Ht;for(let sr=0,ar=tr.length;sr<ar;++sr){const cr=sr&1?Ut:Bt;Ht.kernel=tr[sr],Ht.inputBuffer=rr.texture,rt.setRenderTarget(cr),rt.render(St,Mt),rr=cr}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=rr.texture,rt.setRenderTarget(this.renderToScreen?null:ut),rt.render(St,Mt)}setSize(rt,_){const ut=this.resolution;ut.setBaseSize(rt,_);const mt=ut.width,bt=ut.height;this.renderTargetA.setSize(mt,bt),this.renderTargetB.setSize(mt,bt),this.blurMaterial.setSize(rt,_)}initialize(rt,_,ut){ut!==void 0&&(this.renderTargetA.texture.type=ut,this.renderTargetB.texture.type=ut,ut!==UnsignedByteType?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):rt!==null&&rt.outputColorSpace===SRGBColorSpace&&(this.renderTargetA.texture.colorSpace=SRGBColorSpace,this.renderTargetB.texture.colorSpace=SRGBColorSpace))}static get AUTO_SIZE(){return Resolution.AUTO_SIZE}},luminance_default=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l)*l;
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*clamp(l,0.0,1.0),l);
#else
gl_FragColor=vec4(l);
#endif
}`,LuminanceMaterial=class extends ShaderMaterial{constructor(rt=!1,_=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:REVISION.replace(/\D+/g,"")},uniforms:{inputBuffer:new Uniform(null),threshold:new Uniform(0),smoothing:new Uniform(1),range:new Uniform(null)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:luminance_default,vertexShader:common_default}),this.colorOutput=rt,this.luminanceRange=_}set inputBuffer(rt){this.uniforms.inputBuffer.value=rt}setInputBuffer(rt){this.uniforms.inputBuffer.value=rt}get threshold(){return this.uniforms.threshold.value}set threshold(rt){this.smoothing>0||rt>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=rt}getThreshold(){return this.threshold}setThreshold(rt){this.threshold=rt}get smoothing(){return this.uniforms.smoothing.value}set smoothing(rt){this.threshold>0||rt>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=rt}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(rt){this.smoothing=rt}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(rt){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(rt){rt?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(rt){return this.colorOutput}setColorOutputEnabled(rt){this.colorOutput=rt}get useRange(){return this.luminanceRange!==null}set useRange(rt){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(rt){rt!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=rt,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(rt){this.luminanceRange=rt}},LuminancePass=class extends Pass{constructor({renderTarget:rt,luminanceRange:_,colorOutput:ut,resolutionScale:mt=1,width:bt=Resolution.AUTO_SIZE,height:St=Resolution.AUTO_SIZE,resolutionX:Mt=bt,resolutionY:Bt=St}={}){super("LuminancePass"),this.fullscreenMaterial=new LuminanceMaterial(ut,_),this.needsSwap=!1,this.renderTarget=rt,this.renderTarget===void 0&&(this.renderTarget=new WebGLRenderTarget(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const Ut=this.resolution=new Resolution(this,Mt,Bt,mt);Ut.addEventListener("change",Ht=>this.setSize(Ut.baseWidth,Ut.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(rt,_,ut,mt,bt){const St=this.fullscreenMaterial;St.inputBuffer=_.texture,rt.setRenderTarget(this.renderToScreen?null:this.renderTarget),rt.render(this.scene,this.camera)}setSize(rt,_){const ut=this.resolution;ut.setBaseSize(rt,_),this.renderTarget.setSize(ut.width,ut.height)}initialize(rt,_,ut){ut!==void 0&&ut!==UnsignedByteType&&(this.renderTarget.texture.type=ut,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},convolution_downsampling_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,convolution_downsampling_default2="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",DownsamplingMaterial=class extends ShaderMaterial{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new Uniform(null),texelSize:new Uniform(new Vector2)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_downsampling_default,vertexShader:convolution_downsampling_default2}),this.fragmentShader=updateFragmentShader(this.fragmentShader)}set inputBuffer(rt){this.uniforms.inputBuffer.value=rt}setSize(rt,_){this.uniforms.texelSize.value.set(1/rt,1/_)}},convolution_upsampling_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,convolution_upsampling_default2="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",UpsamplingMaterial=class extends ShaderMaterial{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new Uniform(null),supportBuffer:new Uniform(null),texelSize:new Uniform(new Vector2),radius:new Uniform(.85)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:convolution_upsampling_default,vertexShader:convolution_upsampling_default2}),this.fragmentShader=updateFragmentShader(this.fragmentShader)}set inputBuffer(rt){this.uniforms.inputBuffer.value=rt}set supportBuffer(rt){this.uniforms.supportBuffer.value=rt}get radius(){return this.uniforms.radius.value}set radius(rt){this.uniforms.radius.value=rt}setSize(rt,_){this.uniforms.texelSize.value.set(1/rt,1/_)}},MipmapBlurPass=class extends Pass{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new WebGLRenderTarget(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new DownsamplingMaterial,this.upsamplingMaterial=new UpsamplingMaterial,this.resolution=new Vector2}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(rt){if(this.levels!==rt){const _=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let ut=0;ut<rt;++ut){const mt=_.clone();mt.texture.name="Downsampling.Mipmap"+ut,this.downsamplingMipmaps.push(mt)}this.upsamplingMipmaps.push(_);for(let ut=1,mt=rt-1;ut<mt;++ut){const bt=_.clone();bt.texture.name="Upsampling.Mipmap"+ut,this.upsamplingMipmaps.push(bt)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(rt){this.upsamplingMaterial.radius=rt}render(rt,_,ut,mt,bt){const{scene:St,camera:Mt}=this,{downsamplingMaterial:Bt,upsamplingMaterial:Ut}=this,{downsamplingMipmaps:Ht,upsamplingMipmaps:tr}=this;let rr=_;this.fullscreenMaterial=Bt;for(let sr=0,ar=Ht.length;sr<ar;++sr){const cr=Ht[sr];Bt.setSize(rr.width,rr.height),Bt.inputBuffer=rr.texture,rt.setRenderTarget(cr),rt.render(St,Mt),rr=cr}this.fullscreenMaterial=Ut;for(let sr=tr.length-1;sr>=0;--sr){const ar=tr[sr];Ut.setSize(rr.width,rr.height),Ut.inputBuffer=rr.texture,Ut.supportBuffer=Ht[sr].texture,rt.setRenderTarget(ar),rt.render(St,Mt),rr=ar}}setSize(rt,_){const ut=this.resolution;ut.set(rt,_);let mt=ut.width,bt=ut.height;for(let St=0,Mt=this.downsamplingMipmaps.length;St<Mt;++St)mt=Math.round(mt*.5),bt=Math.round(bt*.5),this.downsamplingMipmaps[St].setSize(mt,bt),St<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[St].setSize(mt,bt)}initialize(rt,_,ut){if(ut!==void 0){const mt=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const bt of mt)bt.texture.type=ut;if(ut!==UnsignedByteType)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(rt!==null&&rt.outputColorSpace===SRGBColorSpace)for(const bt of mt)bt.texture.colorSpace=SRGBColorSpace}}dispose(){super.dispose();for(const rt of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))rt.dispose()}},Effect=class extends EventDispatcher{constructor(rt,_,{attributes:ut=EffectAttribute.NONE,blendFunction:mt=BlendFunction.NORMAL,defines:bt=new Map,uniforms:St=new Map,extensions:Mt=null,vertexShader:Bt=null}={}){super(),this.name=rt,this.renderer=null,this.attributes=ut,this.fragmentShader=_,this.vertexShader=Bt,this.defines=bt,this.uniforms=St,this.extensions=Mt,this.blendMode=new BlendMode(mt),this.blendMode.addEventListener("change",Ut=>this.setChanged()),this._inputColorSpace=LinearSRGBColorSpace,this._outputColorSpace=NoColorSpace}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(rt){this._inputColorSpace=rt,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(rt){this._outputColorSpace=rt,this.setChanged()}set mainScene(rt){}set mainCamera(rt){}getName(){return this.name}setRenderer(rt){this.renderer=rt}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(rt){this.attributes=rt,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(rt){this.fragmentShader=rt,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(rt){this.vertexShader=rt,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(rt,_=BasicDepthPacking){}update(rt,_,ut){}setSize(rt,_){}initialize(rt,_,ut){}dispose(){for(const rt of Object.keys(this)){const _=this[rt];(_ instanceof WebGLRenderTarget||_ instanceof Material||_ instanceof Texture||_ instanceof Pass)&&this[rt].dispose()}}},bloom_default=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,texel.a);}`,BloomEffect=class extends Effect{constructor({blendFunction:rt=BlendFunction.SCREEN,luminanceThreshold:_=.9,luminanceSmoothing:ut=.025,mipmapBlur:mt=!1,intensity:bt=1,radius:St=.85,levels:Mt=8,kernelSize:Bt=KernelSize.LARGE,resolutionScale:Ut=.5,width:Ht=Resolution.AUTO_SIZE,height:tr=Resolution.AUTO_SIZE,resolutionX:rr=Ht,resolutionY:sr=tr}={}){super("BloomEffect",bloom_default,{blendFunction:rt,uniforms:new Map([["map",new Uniform(null)],["intensity",new Uniform(bt)]])}),this.renderTarget=new WebGLRenderTarget(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new KawaseBlurPass({kernelSize:Bt}),this.luminancePass=new LuminancePass({colorOutput:!0}),this.luminanceMaterial.threshold=_,this.luminanceMaterial.smoothing=ut,this.mipmapBlurPass=new MipmapBlurPass,this.mipmapBlurPass.enabled=mt,this.mipmapBlurPass.radius=St,this.mipmapBlurPass.levels=Mt,this.uniforms.get("map").value=mt?this.mipmapBlurPass.texture:this.renderTarget.texture;const ar=this.resolution=new Resolution(this,rr,sr,Ut);ar.addEventListener("change",cr=>this.setSize(ar.baseWidth,ar.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(rt){this.resolution.preferredWidth=rt}get height(){return this.resolution.height}set height(rt){this.resolution.preferredHeight=rt}get dithering(){return this.blurPass.dithering}set dithering(rt){this.blurPass.dithering=rt}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(rt){this.blurPass.kernelSize=rt}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(rt){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(rt){this.uniforms.get("intensity").value=rt}getIntensity(){return this.intensity}setIntensity(rt){this.intensity=rt}getResolutionScale(){return this.resolution.scale}setResolutionScale(rt){this.resolution.scale=rt}update(rt,_,ut){const mt=this.renderTarget,bt=this.luminancePass;bt.enabled?(bt.render(rt,_),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(rt,bt.renderTarget):this.blurPass.render(rt,bt.renderTarget,mt)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(rt,_):this.blurPass.render(rt,_,mt)}setSize(rt,_){const ut=this.resolution;ut.setBaseSize(rt,_),this.renderTarget.setSize(ut.width,ut.height),this.blurPass.resolution.copy(ut),this.luminancePass.setSize(rt,_),this.mipmapBlurPass.setSize(rt,_)}initialize(rt,_,ut){this.blurPass.initialize(rt,_,ut),this.luminancePass.initialize(rt,_,ut),this.mipmapBlurPass.initialize(rt,_,ut),ut!==void 0&&(this.renderTarget.texture.type=ut,rt!==null&&rt.outputColorSpace===SRGBColorSpace&&(this.renderTarget.texture.colorSpace=SRGBColorSpace))}},RenderPass=class extends Pass{constructor(rt,_,ut=null){super("RenderPass",rt,_),this.needsSwap=!1,this.clearPass=new ClearPass,this.overrideMaterialManager=ut===null?null:new OverrideMaterialManager(ut),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(rt){this.scene=rt}set mainCamera(rt){this.camera=rt}get renderToScreen(){return super.renderToScreen}set renderToScreen(rt){super.renderToScreen=rt,this.clearPass.renderToScreen=rt}get overrideMaterial(){const rt=this.overrideMaterialManager;return rt!==null?rt.material:null}set overrideMaterial(rt){const _=this.overrideMaterialManager;rt!==null?_!==null?_.setMaterial(rt):this.overrideMaterialManager=new OverrideMaterialManager(rt):_!==null&&(_.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(rt){this.overrideMaterial=rt}get clear(){return this.clearPass.enabled}set clear(rt){this.clearPass.enabled=rt}getSelection(){return this.selection}setSelection(rt){this.selection=rt}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(rt){this.ignoreBackground=rt}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(rt){this.skipShadowMapUpdate=rt}getClearPass(){return this.clearPass}render(rt,_,ut,mt,bt){const St=this.scene,Mt=this.camera,Bt=this.selection,Ut=Mt.layers.mask,Ht=St.background,tr=rt.shadowMap.autoUpdate,rr=this.renderToScreen?null:_;Bt!==null&&Mt.layers.set(Bt.getLayer()),this.skipShadowMapUpdate&&(rt.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(St.background=null),this.clearPass.enabled&&this.clearPass.render(rt,_),rt.setRenderTarget(rr),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(rt,St,Mt):rt.render(St,Mt),Mt.layers.mask=Ut,St.background=Ht,rt.shadowMap.autoUpdate=tr}},depth_downsampling_default=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,depth_downsampling_default2="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",DepthDownsamplingMaterial=class extends ShaderMaterial{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Uniform(null),normalBuffer:new Uniform(null),texelSize:new Uniform(new Vector2)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:depth_downsampling_default,vertexShader:depth_downsampling_default2})}set depthBuffer(rt){this.uniforms.depthBuffer.value=rt}set depthPacking(rt){this.defines.DEPTH_PACKING=rt.toFixed(0),this.needsUpdate=!0}setDepthBuffer(rt,_=BasicDepthPacking){this.depthBuffer=rt,this.depthPacking=_}set normalBuffer(rt){this.uniforms.normalBuffer.value=rt,rt!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(rt){this.normalBuffer=rt}setTexelSize(rt,_){this.uniforms.texelSize.value.set(rt,_)}setSize(rt,_){this.uniforms.texelSize.value.set(1/rt,1/_)}},DepthDownsamplingPass=class extends Pass{constructor({normalBuffer:rt=null,resolutionScale:_=.5,width:ut=Resolution.AUTO_SIZE,height:mt=Resolution.AUTO_SIZE,resolutionX:bt=ut,resolutionY:St=mt}={}){super("DepthDownsamplingPass");const Mt=new DepthDownsamplingMaterial;Mt.normalBuffer=rt,this.fullscreenMaterial=Mt,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new WebGLRenderTarget(1,1,{minFilter:NearestFilter,magFilter:NearestFilter,depthBuffer:!1,type:FloatType}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const Bt=this.resolution=new Resolution(this,bt,St,_);Bt.addEventListener("change",Ut=>this.setSize(Bt.baseWidth,Bt.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(rt,_=BasicDepthPacking){this.fullscreenMaterial.depthBuffer=rt,this.fullscreenMaterial.depthPacking=_}render(rt,_,ut,mt,bt){rt.setRenderTarget(this.renderToScreen?null:this.renderTarget),rt.render(this.scene,this.camera)}setSize(rt,_){const ut=this.resolution;ut.setBaseSize(rt,_),this.renderTarget.setSize(ut.width,ut.height),this.fullscreenMaterial.setSize(rt,_)}initialize(rt,_,ut){const mt=rt.getContext();if(!(mt.getExtension("EXT_color_buffer_float")||mt.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},effect_default=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,effect_default2="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",EffectMaterial=class extends ShaderMaterial{constructor(rt,_,ut,mt,bt=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:REVISION.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Uniform(null),depthBuffer:new Uniform(null),resolution:new Uniform(new Vector2),texelSize:new Uniform(new Vector2),cameraNear:new Uniform(.3),cameraFar:new Uniform(1e3),aspect:new Uniform(1),time:new Uniform(0)},blending:NoBlending,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:bt}),rt&&this.setShaderParts(rt),_&&this.setDefines(_),ut&&this.setUniforms(ut),this.copyCameraSettings(mt)}set inputBuffer(rt){this.uniforms.inputBuffer.value=rt}setInputBuffer(rt){this.uniforms.inputBuffer.value=rt}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(rt){this.uniforms.depthBuffer.value=rt}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(rt){this.defines.DEPTH_PACKING=rt.toFixed(0),this.needsUpdate=!0}setDepthBuffer(rt,_=BasicDepthPacking){this.depthBuffer=rt,this.depthPacking=_}setShaderData(rt){this.setShaderParts(rt.shaderParts),this.setDefines(rt.defines),this.setUniforms(rt.uniforms),this.setExtensions(rt.extensions)}setShaderParts(rt){return this.fragmentShader=effect_default.replace(EffectShaderSection.FRAGMENT_HEAD,rt.get(EffectShaderSection.FRAGMENT_HEAD)||"").replace(EffectShaderSection.FRAGMENT_MAIN_UV,rt.get(EffectShaderSection.FRAGMENT_MAIN_UV)||"").replace(EffectShaderSection.FRAGMENT_MAIN_IMAGE,rt.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=effect_default2.replace(EffectShaderSection.VERTEX_HEAD,rt.get(EffectShaderSection.VERTEX_HEAD)||"").replace(EffectShaderSection.VERTEX_MAIN_SUPPORT,rt.get(EffectShaderSection.VERTEX_MAIN_SUPPORT)||""),this.fragmentShader=updateFragmentShader(this.fragmentShader),this.needsUpdate=!0,this}setDefines(rt){for(const _ of rt.entries())this.defines[_[0]]=_[1];return this.needsUpdate=!0,this}setUniforms(rt){for(const _ of rt.entries())this.uniforms[_[0]]=_[1];return this}setExtensions(rt){this.extensions={};for(const _ of rt)this.extensions[_]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(rt){this.encodeOutput!==rt&&(rt?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(rt){return this.encodeOutput}setOutputEncodingEnabled(rt){this.encodeOutput=rt}get time(){return this.uniforms.time.value}set time(rt){this.uniforms.time.value=rt}setDeltaTime(rt){this.uniforms.time.value+=rt}adoptCameraSettings(rt){this.copyCameraSettings(rt)}copyCameraSettings(rt){rt&&(this.uniforms.cameraNear.value=rt.near,this.uniforms.cameraFar.value=rt.far,rt instanceof PerspectiveCamera$1?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(rt,_){const ut=this.uniforms;ut.resolution.value.set(rt,_),ut.texelSize.value.set(1/rt,1/_),ut.aspect.value=rt/_}static get Section(){return EffectShaderSection}};function prefixSubstrings(rt,_,ut){for(const mt of _){const bt="$1"+rt+mt.charAt(0).toUpperCase()+mt.slice(1),St=new RegExp("([^\\.])(\\b"+mt+"\\b)","g");for(const Mt of ut.entries())Mt[1]!==null&&ut.set(Mt[0],Mt[1].replace(St,bt))}}function integrateEffect(rt,_,ut){let mt=_.getFragmentShader(),bt=_.getVertexShader();const St=mt!==void 0&&/mainImage/.test(mt),Mt=mt!==void 0&&/mainUv/.test(mt);if(ut.attributes|=_.getAttributes(),mt===void 0)throw new Error(`Missing fragment shader (${_.name})`);if(Mt&&ut.attributes&EffectAttribute.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${_.name})`);if(!St&&!Mt)throw new Error(`Could not find mainImage or mainUv function (${_.name})`);{const Bt=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,Ut=ut.shaderParts;let Ht=Ut.get(EffectShaderSection.FRAGMENT_HEAD)||"",tr=Ut.get(EffectShaderSection.FRAGMENT_MAIN_UV)||"",rr=Ut.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE)||"",sr=Ut.get(EffectShaderSection.VERTEX_HEAD)||"",ar=Ut.get(EffectShaderSection.VERTEX_MAIN_SUPPORT)||"";const cr=new Set,Ar=new Set;if(Mt&&(tr+=`	${rt}MainUv(UV);
`,ut.uvTransformation=!0),bt!==null&&/mainSupport/.test(bt)){const $r=/mainSupport *\([\w\s]*?uv\s*?\)/.test(bt);ar+=`	${rt}MainSupport(`,ar+=$r?`vUv);
`:`);
`;for(const Br of bt.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const Jr of Br[1].split(/\s*,\s*/))ut.varyings.add(Jr),cr.add(Jr),Ar.add(Jr);for(const Br of bt.matchAll(Bt))Ar.add(Br[1])}for(const $r of mt.matchAll(Bt))Ar.add($r[1]);for(const $r of _.defines.keys())Ar.add($r.replace(/\([\w\s,]*\)/g,""));for(const $r of _.uniforms.keys())Ar.add($r);Ar.delete("while"),Ar.delete("for"),Ar.delete("if"),_.uniforms.forEach(($r,Br)=>ut.uniforms.set(rt+Br.charAt(0).toUpperCase()+Br.slice(1),$r)),_.defines.forEach(($r,Br)=>ut.defines.set(rt+Br.charAt(0).toUpperCase()+Br.slice(1),$r));const _r=new Map([["fragment",mt],["vertex",bt]]);prefixSubstrings(rt,Ar,ut.defines),prefixSubstrings(rt,Ar,_r),mt=_r.get("fragment"),bt=_r.get("vertex");const Dr=_.blendMode;if(ut.blendModes.set(Dr.blendFunction,Dr),St){_.inputColorSpace!==null&&_.inputColorSpace!==ut.colorSpace&&(rr+=_.inputColorSpace===SRGBColorSpace?`color0 = LinearTosRGB(color0);
	`:`color0 = sRGBToLinear(color0);
	`),_.outputColorSpace!==NoColorSpace?ut.colorSpace=_.outputColorSpace:_.inputColorSpace!==null&&(ut.colorSpace=_.inputColorSpace);const $r=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;rr+=`${rt}MainImage(color0, UV, `,ut.attributes&EffectAttribute.DEPTH&&$r.test(mt)&&(rr+="depth, ",ut.readDepth=!0),rr+=`color1);
	`;const Br=rt+"BlendOpacity";ut.uniforms.set(Br,Dr.opacity),rr+=`color0 = blend${Dr.blendFunction}(color0, color1, ${Br});

	`,Ht+=`uniform float ${Br};

`}if(Ht+=mt+`
`,bt!==null&&(sr+=bt+`
`),Ut.set(EffectShaderSection.FRAGMENT_HEAD,Ht),Ut.set(EffectShaderSection.FRAGMENT_MAIN_UV,tr),Ut.set(EffectShaderSection.FRAGMENT_MAIN_IMAGE,rr),Ut.set(EffectShaderSection.VERTEX_HEAD,sr),Ut.set(EffectShaderSection.VERTEX_MAIN_SUPPORT,ar),_.extensions!==null)for(const $r of _.extensions)ut.extensions.add($r)}}var EffectPass=class extends Pass{constructor(rt,..._){super("EffectPass"),this.fullscreenMaterial=new EffectMaterial(null,null,null,rt),this.listener=ut=>this.handleEvent(ut),this.effects=[],this.setEffects(_),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(rt){for(const _ of this.effects)_.mainScene=rt}set mainCamera(rt){this.fullscreenMaterial.copyCameraSettings(rt);for(const _ of this.effects)_.mainCamera=rt}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(rt){this.fullscreenMaterial.encodeOutput=rt}get dithering(){return this.fullscreenMaterial.dithering}set dithering(rt){const _=this.fullscreenMaterial;_.dithering=rt,_.needsUpdate=!0}setEffects(rt){for(const _ of this.effects)_.removeEventListener("change",this.listener);this.effects=rt.sort((_,ut)=>ut.attributes-_.attributes);for(const _ of this.effects)_.addEventListener("change",this.listener)}updateMaterial(){const rt=new EffectShaderData;let _=0;for(const Mt of this.effects)if(Mt.blendMode.blendFunction===BlendFunction.DST)rt.attributes|=Mt.getAttributes()&EffectAttribute.DEPTH;else{if(rt.attributes&Mt.getAttributes()&EffectAttribute.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${Mt.name})`);integrateEffect("e"+_++,Mt,rt)}let ut=rt.shaderParts.get(EffectShaderSection.FRAGMENT_HEAD),mt=rt.shaderParts.get(EffectShaderSection.FRAGMENT_MAIN_IMAGE),bt=rt.shaderParts.get(EffectShaderSection.FRAGMENT_MAIN_UV);const St=/\bblend\b/g;for(const Mt of rt.blendModes.values())ut+=Mt.getShaderCode().replace(St,`blend${Mt.blendFunction}`)+`
`;rt.attributes&EffectAttribute.DEPTH?(rt.readDepth&&(mt=`float depth = readDepth(UV);

	`+mt),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,rt.colorSpace===SRGBColorSpace&&(mt+=`color0 = sRGBToLinear(color0);
	`),rt.uvTransformation?(bt=`vec2 transformedUv = vUv;
`+bt,rt.defines.set("UV","transformedUv")):rt.defines.set("UV","vUv"),rt.shaderParts.set(EffectShaderSection.FRAGMENT_HEAD,ut),rt.shaderParts.set(EffectShaderSection.FRAGMENT_MAIN_IMAGE,mt),rt.shaderParts.set(EffectShaderSection.FRAGMENT_MAIN_UV,bt);for(const[Mt,Bt]of rt.shaderParts)Bt!==null&&rt.shaderParts.set(Mt,Bt.trim().replace(/^#/,`
#`));this.skipRendering=_===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(rt)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(rt,_=BasicDepthPacking){this.fullscreenMaterial.depthBuffer=rt,this.fullscreenMaterial.depthPacking=_;for(const ut of this.effects)ut.setDepthTexture(rt,_)}render(rt,_,ut,mt,bt){for(const St of this.effects)St.update(rt,_,mt);if(!this.skipRendering||this.renderToScreen){const St=this.fullscreenMaterial;St.inputBuffer=_.texture,St.time+=mt*this.timeScale,rt.setRenderTarget(this.renderToScreen?null:ut),rt.render(this.scene,this.camera)}}setSize(rt,_){this.fullscreenMaterial.setSize(rt,_);for(const ut of this.effects)ut.setSize(rt,_)}initialize(rt,_,ut){this.renderer=rt;for(const mt of this.effects)mt.initialize(rt,_,ut);this.updateMaterial(),ut!==void 0&&ut!==UnsignedByteType&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const rt of this.effects)rt.removeEventListener("change",this.listener),rt.dispose()}handleEvent(rt){switch(rt.type){case"change":this.recompile();break}}},NormalPass=class extends Pass{constructor(rt,_,{renderTarget:ut,resolutionScale:mt=1,width:bt=Resolution.AUTO_SIZE,height:St=Resolution.AUTO_SIZE,resolutionX:Mt=bt,resolutionY:Bt=St}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new RenderPass(rt,_,new MeshNormalMaterial);const Ut=this.renderPass;Ut.ignoreBackground=!0,Ut.skipShadowMapUpdate=!0;const Ht=Ut.getClearPass();Ht.overrideClearColor=new Color$1(7829503),Ht.overrideClearAlpha=1,this.renderTarget=ut,this.renderTarget===void 0&&(this.renderTarget=new WebGLRenderTarget(1,1,{minFilter:NearestFilter,magFilter:NearestFilter}),this.renderTarget.texture.name="NormalPass.Target");const tr=this.resolution=new Resolution(this,Mt,Bt,mt);tr.addEventListener("change",rr=>this.setSize(tr.baseWidth,tr.baseHeight))}set mainScene(rt){this.renderPass.mainScene=rt}set mainCamera(rt){this.renderPass.mainCamera=rt}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(rt){this.resolution.scale=rt}render(rt,_,ut,mt,bt){const St=this.renderToScreen?null:this.renderTarget;this.renderPass.render(rt,St,St)}setSize(rt,_){const ut=this.resolution;ut.setBaseSize(rt,_),this.renderTarget.setSize(ut.width,ut.height)}};let webGL2Available;function isWebGL2Available(){var rt;if(webGL2Available!==void 0)return webGL2Available;try{let _;const ut=document.createElement("canvas");return webGL2Available=!!(window.WebGL2RenderingContext&&(_=ut.getContext("webgl2"))),_&&((rt=_.getExtension("WEBGL_lose_context"))==null||rt.loseContext()),webGL2Available}catch{return webGL2Available=!1}}const EffectComposerContext=reactExports.createContext(null),isConvolution=rt=>(rt.getAttributes()&EffectAttribute.CONVOLUTION)===EffectAttribute.CONVOLUTION,EffectComposer=React.memo(reactExports.forwardRef(({children:rt,camera:_,scene:ut,resolutionScale:mt,enabled:bt=!0,renderPriority:St=1,autoClear:Mt=!0,depthBuffer:Bt,enableNormalPass:Ut,stencilBuffer:Ht,multisampling:tr=8,frameBufferType:rr=HalfFloatType},sr)=>{const{gl:ar,scene:cr,camera:Ar,size:_r}=useThree(),Dr=ut||cr,$r=_||Ar,[Br,Jr,mn]=reactExports.useMemo(()=>{const In=isWebGL2Available(),Rn=new EffectComposer$1(ar,{depthBuffer:Bt,stencilBuffer:Ht,multisampling:tr>0&&In?tr:0,frameBufferType:rr});Rn.addPass(new RenderPass(Dr,$r));let qn=null,Qn=null;return Ut&&(Qn=new NormalPass(Dr,$r),Qn.enabled=!1,Rn.addPass(Qn),mt!==void 0&&In&&(qn=new DepthDownsamplingPass({normalBuffer:Qn.texture,resolutionScale:mt}),qn.enabled=!1,Rn.addPass(qn))),[Rn,Qn,qn]},[$r,ar,Bt,Ht,tr,rr,Dr,Ut,mt]);reactExports.useEffect(()=>Br==null?void 0:Br.setSize(_r.width,_r.height),[Br,_r]),useFrame((In,Rn)=>{if(bt){const qn=ar.autoClear;ar.autoClear=Mt,Ht&&!Mt&&ar.clearStencil(),Br.render(Rn),ar.autoClear=qn}},bt?St:0);const Mn=reactExports.useRef(null),$n=useInstanceHandle(Mn);reactExports.useLayoutEffect(()=>{const In=[];if(Mn.current&&$n.current&&Br){const Rn=$n.current.objects;for(let qn=0;qn<Rn.length;qn++){const Qn=Rn[qn];if(Qn instanceof Effect){const xs=[Qn];if(!isConvolution(Qn)){let ks=null;for(;(ks=Rn[qn+1])instanceof Effect&&!isConvolution(ks);)xs.push(ks),qn++}const cs=new EffectPass($r,...xs);In.push(cs)}else Qn instanceof Pass&&In.push(Qn)}for(const qn of In)Br==null||Br.addPass(qn);Jr&&(Jr.enabled=!0),mn&&(mn.enabled=!0)}return()=>{for(const Rn of In)Br==null||Br.removePass(Rn);Jr&&(Jr.enabled=!1),mn&&(mn.enabled=!1)}},[Br,rt,$r,Jr,mn,$n]),reactExports.useEffect(()=>{const In=ar.toneMapping;return ar.toneMapping=NoToneMapping,()=>{ar.toneMapping=In}},[]);const en=reactExports.useMemo(()=>({composer:Br,normalPass:Jr,downSamplingPass:mn,resolutionScale:mt,camera:$r,scene:Dr}),[Br,Jr,mn,mt,$r,Dr]);return reactExports.useImperativeHandle(sr,()=>Br,[Br]),jsxRuntimeExports.jsx(EffectComposerContext.Provider,{value:en,children:jsxRuntimeExports.jsx("group",{ref:Mn,children:rt})})}));let i=0;const components=new WeakMap,wrapEffect=(rt,_)=>React.forwardRef(function({blendFunction:mt=_==null?void 0:_.blendFunction,opacity:bt=_==null?void 0:_.opacity,...St},Mt){let Bt=components.get(rt);if(!Bt){const tr=`@react-three/postprocessing/${rt.name}-${i++}`;extend$3({[tr]:rt}),components.set(rt,Bt=tr)}const Ut=useThree(tr=>tr.camera),Ht=React.useMemo(()=>{var tr,rr;return[...(tr=_==null?void 0:_.args)!=null?tr:[],...(rr=St.args)!=null?rr:[{..._,...St}]]},[JSON.stringify(St)]);return jsxRuntimeExports.jsx(Bt,{camera:Ut,"blendMode-blendFunction":mt,"blendMode-opacity-value":bt,...St,ref:Mt,args:Ht})}),Bloom=wrapEffect(BloomEffect,{blendFunction:BlendFunction.ADD}),ThreeD=()=>jsxRuntimeExports.jsxs(Canvas$1,{shadows:!0,flat:!0,dpr:[1,1.5],gl:{antialias:!1},children:[jsxRuntimeExports.jsx(PerspectiveCamera,{makeDefault:!0,position:[4,1,2]}),jsxRuntimeExports.jsx("ambientLight",{intensity:1.5*Math.PI}),jsxRuntimeExports.jsx(Sky,{}),jsxRuntimeExports.jsx(Scene,{}),"ya",jsxRuntimeExports.jsx(InteractiveFloor,{}),jsxRuntimeExports.jsx(CameraControls,{})]});function CameraControls(){const{camera:rt}=useThree(),_=reactExports.useRef({forward:!1,backward:!1,left:!1,right:!1,rotateLeft:!1,rotateRight:!1}),ut=.05,mt=.01,bt={minX:-2.2,maxX:3.5,minZ:-3,maxZ:4};return reactExports.useEffect(()=>{rt.lookAt(new Vector3(0,1,2))},[rt]),reactExports.useEffect(()=>{const St=Bt=>{switch(Bt.key){case"w":_.current.forward=!0;break;case"s":_.current.backward=!0;break;case"a":_.current.right=!0;break;case"d":_.current.left=!0;break;case"q":_.current.rotateLeft=!0;break;case"e":_.current.rotateRight=!0;break}},Mt=Bt=>{switch(Bt.key){case"w":_.current.forward=!1;break;case"s":_.current.backward=!1;break;case"a":_.current.right=!1;break;case"d":_.current.left=!1;break;case"q":_.current.rotateLeft=!1;break;case"e":_.current.rotateRight=!1;break}};return document.addEventListener("keydown",St),document.addEventListener("keyup",Mt),()=>{document.removeEventListener("keydown",St),document.removeEventListener("keyup",Mt)}},[]),useFrame(()=>{const St=new Vector3;rt.getWorldDirection(St),_.current.forward&&rt.position.addScaledVector(St,ut),_.current.backward&&rt.position.addScaledVector(St,-ut);const Mt=new Vector3;Mt.crossVectors(rt.up,St).normalize(),_.current.left&&rt.position.addScaledVector(Mt,-ut),_.current.right&&rt.position.addScaledVector(Mt,ut),_.current.rotateLeft&&rt.rotateY(mt),_.current.rotateRight&&rt.rotateY(-mt),rt.position.x=Math.max(bt.minX,Math.min(bt.maxX,rt.position.x)),rt.position.z=Math.max(bt.minZ,Math.min(bt.maxZ,rt.position.z))}),null}function InteractiveFloor(){const{camera:rt}=useThree(),[_,ut]=reactExports.useState(!1),mt=new Vector3(0-1.8,1,2),bt=.5;return useFrame(()=>{rt.position.distanceTo(mt)<=bt?_||(ut(!0),console.log("摄像机现在在目标区域上方")):_&&(ut(!1),console.log("摄像机已离开目标区域"))}),reactExports.useEffect(()=>{const St=Mt=>{Mt.code==="Space"&&_&&(window.location.href="https://ai.cytelab.net/login")};return window.addEventListener("keydown",St),()=>{window.removeEventListener("keydown",St)}},[_]),jsxRuntimeExports.jsxs("group",{children:[jsxRuntimeExports.jsx(motion.group,{position:[-2.903-1.5,1,1.56],rotation:[0,Math.PI/2,0],animate:{scale:_?.6:0},children:jsxRuntimeExports.jsx(Text,{children:"<开始创作>",color:"greenyellow"})}),_&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("mesh",{position:[-4.8,1.14,1.56],rotation:[0,Math.PI/2,0],children:[jsxRuntimeExports.jsx("planeGeometry",{args:[6.8,2.08]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"black",transparent:!0,opacity:.1})]}),jsxRuntimeExports.jsxs("mesh",{position:[-2.903,0,1.56],rotation:[0,Math.PI/2,0],onClick:()=>console.log("Floor clicked!"),castShadow:!0,children:[jsxRuntimeExports.jsx("boxGeometry",{args:[6.8,.1,4.14]}),jsxRuntimeExports.jsx("meshStandardMaterial",{color:"greenyellow"})]}),jsxRuntimeExports.jsx(EffectComposer,{children:jsxRuntimeExports.jsx(Bloom,{luminanceThreshold:.3,luminanceSmoothing:.9,height:300})})]})]})}const AiGallery=()=>jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx(ThreeD,{})}),NotFound=()=>jsxRuntimeExports.jsx("h1",{children:"404"}),routes=[{path:"/",element:jsxRuntimeExports.jsx(Navigate,{to:"/home",replace:!0}),index:!0},{path:"/home",element:jsxRuntimeExports.jsx(Home,{})},{path:"/projects",element:jsxRuntimeExports.jsx(Projects$1,{}),children:[{path:"in3",element:jsxRuntimeExports.jsx(In3,{})},{path:"threedcharacter",element:jsxRuntimeExports.jsx(ThreeDCharacter,{})},{path:"car",element:jsxRuntimeExports.jsx(CarCar,{})},{path:"gallery",element:jsxRuntimeExports.jsx(AiGallery,{})}]},{path:"*",element:jsxRuntimeExports.jsx(NotFound,{})}];function WraperRoutes(){return useRoutes(routes)}function App(){return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{style:{height:"100%",width:"100%",padding:"0px",backgroundColor:"#fdfbfb"},children:jsxRuntimeExports.jsxs(BrowserRouter,{children:[jsxRuntimeExports.jsx(NavBar,{}),jsxRuntimeExports.jsx(WraperRoutes,{})]})})})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}))});export default E$();
